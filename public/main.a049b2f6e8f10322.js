(self.webpackChunksolf=self.webpackChunksolf||[]).push([[179],{1572:(Yn,kt,L)=>{"use strict";L.d(kt,{i:()=>$e});var w=L(4004),y=L(262),j=L(8505),a=L(9646),de=L(2340),Qe=L(655),it=L(4650),Ce=L(529),Fe=L(8996);let $e=(()=>{class at{constructor(Ve,tt,Re){this.http=Ve,this.router=tt,this.ngZone=Re,this.baseUrl=de.N.base_url}get token(){return localStorage.getItem("token")||""}get role(){return this.usuario.role}get uid(){return this.usuario.uid||""}get headers(){return{headers:{"x-token":this.token}}}guardarLocalStorage(Ve,tt,Re=""){localStorage.setItem("token",Ve),localStorage.setItem("menu",JSON.stringify(tt)),""!==Re&&localStorage.setItem("aud",Re)}logout(){this.usuario.google?google.accounts.id.revoke(this.usuario.email,()=>{this.ngZone.run(()=>{localStorage.removeItem("menu"),localStorage.removeItem("token"),localStorage.removeItem("aud"),this.router.navigateByUrl("auth/login")})}):(localStorage.removeItem("token"),localStorage.removeItem("menu"),localStorage.getItem("aud")&&localStorage.removeItem("aud"))}validarToken(){return google.accounts.id.initialize({client_id:localStorage.getItem("aud")}),this.http.get(`${this.baseUrl}/login/renew`,{headers:{"x-token":this.token}}).pipe((0,w.U)(Ve=>{const{apellidoM:tt,apellidoP:Re,email:ft,google:et,img:ht="",nombre:Gt,role:an,status:ot,uid:Te}=Ve.usuario;return this.usuario=new Qe.b(Gt,Re,tt,ft,"",ht,et,an,ot,Te),this.guardarLocalStorage(Ve.token,Ve.menu),!0}),(0,y.K)(Ve=>(0,a.of)(!1)))}crearUsuario(Ve){return this.http.post(`${this.baseUrl}/usuarios`,Ve).pipe((0,j.b)(tt=>{this.guardarLocalStorage(tt.token,tt.menu)}))}login(Ve){return this.http.post(`${this.baseUrl}/login`,Ve).pipe((0,j.b)(tt=>{this.guardarLocalStorage(tt.token,tt.menu)}))}loginGoogle(Ve){return this.http.post(`${this.baseUrl}/login/google`,{token:Ve}).pipe((0,j.b)(tt=>{this.guardarLocalStorage(tt.token,tt.menu,tt.aud)}))}actualizarPerfil(Ve){return Ve={...Ve,role:this.usuario.role||"USER_ROLE",status:this.usuario.status||!1},this.http.put(`${this.baseUrl}/usuarios/${this.uid}`,Ve,this.headers)}cargarUsuarios(Ve=0){return this.http.get(`${this.baseUrl}/usuarios?desde=${Ve}`,this.headers).pipe((0,w.U)(Re=>{const ft=Re.usuarios.map(et=>new Qe.b(et.nombre,et.apellidoP,et.apellidoM,et.email,"",et.img,et.google,et.role,et.status,et.uid));return{total:Re.total,usuarios:ft}}))}desactivarUsuario(Ve){return this.http.put(`${this.baseUrl}/usuarios/desactivar/${Ve.uid}`,{status:!1},this.headers)}activarUsuario(Ve){return this.http.put(`${this.baseUrl}/usuarios/desactivar/${Ve.uid}`,{status:!0},this.headers)}cambiarRolUsuario(Ve){return this.http.put(`${this.baseUrl}/usuarios/${Ve.uid}`,Ve,this.headers)}static#e=this.\u0275fac=function(tt){return new(tt||at)(it.LFG(Ce.eN),it.LFG(Fe.F0),it.LFG(it.R0b))};static#t=this.\u0275prov=it.Yz7({token:at,factory:at.\u0275fac,providedIn:"root"})}return at})()},2311:(Yn,kt,L)=>{"use strict";L.d(kt,{O:()=>de});var w=L(4004),y=L(2340),j=L(4650),a=L(529);let de=(()=>{class Qe{get categorias(){return[...this._categorias]}get juegos(){return[...this._juegos]}constructor(Ce){this.http=Ce,this.baseUrl=y.N.base_url,this._categorias=["libre","primaria","intersecundaria","prepa","veterano","relampago","femenil"],this._juegos=["fut7","futsalad","fut11"]}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}getLigas(){return this.http.get(`${this.baseUrl}/ligas`,this.headers).pipe((0,w.U)(Fe=>Fe.ligas))}getLigasStatusTrue(){return this.http.get(`${this.baseUrl}/ligas/statusTrue`,this.headers).pipe((0,w.U)(Fe=>Fe.ligas))}getLigasStatusFalse(){return this.http.get(`${this.baseUrl}/ligas/statusFalse`,this.headers).pipe((0,w.U)(Fe=>Fe.ligas))}smallgetLigas(){return this.http.get(`${this.baseUrl}/ligas?limite=3`,this.headers).pipe((0,w.U)(Fe=>Fe.ligas))}getLigaPorId(Ce){return this.http.get(`${this.baseUrl}/ligas/${Ce}`,this.headers).pipe((0,w.U)($e=>$e.liga))}getLigaPorBusqueda(Ce,Fe,$e){return this.http.get(""!==$e&&""!==Fe?`${this.baseUrl}/ligas/nombre/${Ce}?limite=6&tipocategoria=${Fe}&tipojuego=${$e}`:""!==$e&&""===Fe?`${this.baseUrl}/ligas/nombre/${Ce}?limite=6&tipojuego=${$e}`:""===$e&&""!==Fe?`${this.baseUrl}/ligas/nombre/${Ce}?limite=6&tipocategoria=${Fe}`:`${this.baseUrl}/ligas/nombre/${Ce}?limite=6`)}agregarLiga(Ce){return this.http.post(`${this.baseUrl}/ligas`,Ce,this.headers)}actualizarLiga(Ce){return this.http.put(`${this.baseUrl}/ligas/${Ce._id}`,Ce,this.headers)}desactivarLiga(Ce){return this.http.put(`${this.baseUrl}/ligas/desactivar/${Ce._id}`,{status:!1},this.headers)}activarLiga(Ce){return this.http.put(`${this.baseUrl}/ligas/desactivar/${Ce._id}`,{status:!0},this.headers)}getCategoriasJuegos(){return this.getLigas().pipe((0,w.U)(Ce=>{let Fe=Ce.map(({...at})=>at.tipoCategoria),$e=Ce.map(({...at})=>at.tipoJuego);return Fe=[...new Set(Fe)],$e=[...new Set($e)],{cat:Fe,jue:$e}}))}static#e=this.\u0275fac=function(Fe){return new(Fe||Qe)(j.LFG(a.eN))};static#t=this.\u0275prov=j.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"})}return Qe})()},8298:(Yn,kt,L)=>{"use strict";L.d(kt,{q:()=>xs});var w=L(3267),y=L(4650),j=L(3238);let $e=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({imports:[j.BQ,j.BQ]}),Pt})();var at=L(4859),qe=L(7392),Ve=L(4633);let fi=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({imports:[j.BQ,j.BQ]}),Pt})();var Ci=L(782),Bt=L(7717),Zt=L(7957),nn=L(9549),Ct=L(4144),Jt=L(8184),ze=L(6895),zt=L(8605),ve=L(7340);const ln={provide:new y.OlP("mat-select-scroll-strategy"),deps:[Jt.aV],useFactory:function Qt(Pt){return()=>Pt.scrollStrategies.reposition()}};let Ft=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({providers:[ln],imports:[ze.ez,Jt.U8,j.Ng,j.BQ,zt.ZD,nn.lN,j.Ng,j.BQ]}),Pt})();var _t=L(7009),bn=L(2687),Ut=L(3353),De=L(4080),oe=L(9521),be=L(7579),wt=L(9770),$t=L(9646),pe=L(445),Q=L(8675);function ae(Pt,bt){}class ye{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0}}let Ye=(()=>{class Pt extends De.en{constructor(ce,Ke,Nt,Bn,xi,si,pi,Vr){super(),this._elementRef=ce,this._focusTrapFactory=Ke,this._config=Bn,this._interactivityChecker=xi,this._ngZone=si,this._overlayRef=pi,this._focusMonitor=Vr,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=Ho=>{this._portalOutlet.hasAttached();const Mo=this._portalOutlet.attachDomPortal(Ho);return this._contentAttached(),Mo},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=Nt}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(ce){this._portalOutlet.hasAttached();const Ke=this._portalOutlet.attachComponentPortal(ce);return this._contentAttached(),Ke}attachTemplatePortal(ce){this._portalOutlet.hasAttached();const Ke=this._portalOutlet.attachTemplatePortal(ce);return this._contentAttached(),Ke}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(ce,Ke){this._interactivityChecker.isFocusable(ce)||(ce.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const Nt=()=>{ce.removeEventListener("blur",Nt),ce.removeEventListener("mousedown",Nt),ce.removeAttribute("tabindex")};ce.addEventListener("blur",Nt),ce.addEventListener("mousedown",Nt)})),ce.focus(Ke)}_focusByCssSelector(ce,Ke){let Nt=this._elementRef.nativeElement.querySelector(ce);Nt&&this._forceFocus(Nt,Ke)}_trapFocus(){const ce=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||ce.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(Ke=>{Ke||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const ce=this._config.restoreFocus;let Ke=null;if("string"==typeof ce?Ke=this._document.querySelector(ce):"boolean"==typeof ce?Ke=ce?this._elementFocusedBeforeDialogWasOpened:null:ce&&(Ke=ce),this._config.restoreFocus&&Ke&&"function"==typeof Ke.focus){const Nt=(0,Ut.ht)(),Bn=this._elementRef.nativeElement;(!Nt||Nt===this._document.body||Nt===Bn||Bn.contains(Nt))&&(this._focusMonitor?(this._focusMonitor.focusVia(Ke,this._closeInteractionType),this._closeInteractionType=null):Ke.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const ce=this._elementRef.nativeElement,Ke=(0,Ut.ht)();return ce===Ke||ce.contains(Ke)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=(0,Ut.ht)())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return Pt.\u0275fac=function(ce){return new(ce||Pt)(y.Y36(y.SBq),y.Y36(bn.qV),y.Y36(ze.K0,8),y.Y36(ye),y.Y36(bn.ic),y.Y36(y.R0b),y.Y36(Jt.Iu),y.Y36(bn.tE))},Pt.\u0275cmp=y.Xpm({type:Pt,selectors:[["cdk-dialog-container"]],viewQuery:function(ce,Ke){if(1&ce&&y.Gf(De.Pl,7),2&ce){let Nt;y.iGM(Nt=y.CRH())&&(Ke._portalOutlet=Nt.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(ce,Ke){2&ce&&y.uIk("id",Ke._config.id||null)("role",Ke._config.role)("aria-modal",Ke._config.ariaModal)("aria-labelledby",Ke._config.ariaLabel?null:Ke._ariaLabelledBy)("aria-label",Ke._config.ariaLabel)("aria-describedby",Ke._config.ariaDescribedBy||null)},features:[y.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(ce,Ke){1&ce&&y.YNc(0,ae,0,0,"ng-template",0)},dependencies:[De.Pl],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),Pt})();class xe{constructor(bt,ce){this.overlayRef=bt,this.config=ce,this.closed=new be.x,this.disableClose=ce.disableClose,this.backdropClick=bt.backdropClick(),this.keydownEvents=bt.keydownEvents(),this.outsidePointerEvents=bt.outsidePointerEvents(),this.id=ce.id,this.keydownEvents.subscribe(Ke=>{Ke.keyCode===oe.hY&&!this.disableClose&&!(0,oe.Vb)(Ke)&&(Ke.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})})}close(bt,ce){if(this.containerInstance){const Ke=this.closed;this.containerInstance._closeInteractionType=ce?.focusOrigin||"program",this.overlayRef.dispose(),Ke.next(bt),Ke.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(bt="",ce=""){return this.overlayRef.updateSize({width:bt,height:ce}),this}addPanelClass(bt){return this.overlayRef.addPanelClass(bt),this}removePanelClass(bt){return this.overlayRef.removePanelClass(bt),this}}const fe=new y.OlP("DialogScrollStrategy"),te=new y.OlP("DialogData"),ge=new y.OlP("DefaultDialogConfig"),en={provide:fe,deps:[Jt.aV],useFactory:function ut(Pt){return()=>Pt.scrollStrategies.block()}};let Xt=0,Qn=(()=>{class Pt{constructor(ce,Ke,Nt,Bn,xi,si){this._overlay=ce,this._injector=Ke,this._defaultOptions=Nt,this._parentDialog=Bn,this._overlayContainer=xi,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new be.x,this._afterOpenedAtThisLevel=new be.x,this._ariaHiddenElements=new Map,this.afterAllClosed=(0,wt.P)(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe((0,Q.O)(void 0))),this._scrollStrategy=si}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}open(ce,Ke){(Ke={...this._defaultOptions||new ye,...Ke}).id=Ke.id||"cdk-dialog-"+Xt++,Ke.id&&this.getDialogById(Ke.id);const Bn=this._getOverlayConfig(Ke),xi=this._overlay.create(Bn),si=new xe(xi,Ke),pi=this._attachContainer(xi,si,Ke);return si.containerInstance=pi,this._attachDialogContent(ce,si,pi,Ke),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(si),si.closed.subscribe(()=>this._removeOpenDialog(si,!0)),this.afterOpened.next(si),si}closeAll(){ei(this.openDialogs,ce=>ce.close())}getDialogById(ce){return this.openDialogs.find(Ke=>Ke.id===ce)}ngOnDestroy(){ei(this._openDialogsAtThisLevel,ce=>{!1===ce.config.closeOnDestroy&&this._removeOpenDialog(ce,!1)}),ei(this._openDialogsAtThisLevel,ce=>ce.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(ce){const Ke=new Jt.X_({positionStrategy:ce.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:ce.scrollStrategy||this._scrollStrategy(),panelClass:ce.panelClass,hasBackdrop:ce.hasBackdrop,direction:ce.direction,minWidth:ce.minWidth,minHeight:ce.minHeight,maxWidth:ce.maxWidth,maxHeight:ce.maxHeight,width:ce.width,height:ce.height,disposeOnNavigation:ce.closeOnNavigation});return ce.backdropClass&&(Ke.backdropClass=ce.backdropClass),Ke}_attachContainer(ce,Ke,Nt){const Bn=Nt.injector||Nt.viewContainerRef?.injector,xi=[{provide:ye,useValue:Nt},{provide:xe,useValue:Ke},{provide:Jt.Iu,useValue:ce}];let si;Nt.container?"function"==typeof Nt.container?si=Nt.container:(si=Nt.container.type,xi.push(...Nt.container.providers(Nt))):si=Ye;const pi=new De.C5(si,Nt.viewContainerRef,y.zs3.create({parent:Bn||this._injector,providers:xi}),Nt.componentFactoryResolver);return ce.attach(pi).instance}_attachDialogContent(ce,Ke,Nt,Bn){if(ce instanceof y.Rgc){const xi=this._createInjector(Bn,Ke,Nt,void 0);let si={$implicit:Bn.data,dialogRef:Ke};Bn.templateContext&&(si={...si,..."function"==typeof Bn.templateContext?Bn.templateContext():Bn.templateContext}),Nt.attachTemplatePortal(new De.UE(ce,null,si,xi))}else{const xi=this._createInjector(Bn,Ke,Nt,this._injector),si=Nt.attachComponentPortal(new De.C5(ce,Bn.viewContainerRef,xi,Bn.componentFactoryResolver));Ke.componentInstance=si.instance}}_createInjector(ce,Ke,Nt,Bn){const xi=ce.injector||ce.viewContainerRef?.injector,si=[{provide:te,useValue:ce.data},{provide:xe,useValue:Ke}];return ce.providers&&("function"==typeof ce.providers?si.push(...ce.providers(Ke,ce,Nt)):si.push(...ce.providers)),ce.direction&&(!xi||!xi.get(pe.Is,null,y.XFs.Optional))&&si.push({provide:pe.Is,useValue:{value:ce.direction,change:(0,$t.of)()}}),y.zs3.create({parent:xi||Bn,providers:si})}_removeOpenDialog(ce,Ke){const Nt=this.openDialogs.indexOf(ce);Nt>-1&&(this.openDialogs.splice(Nt,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((Bn,xi)=>{Bn?xi.setAttribute("aria-hidden",Bn):xi.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),Ke&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const ce=this._overlayContainer.getContainerElement();if(ce.parentElement){const Ke=ce.parentElement.children;for(let Nt=Ke.length-1;Nt>-1;Nt--){const Bn=Ke[Nt];Bn!==ce&&"SCRIPT"!==Bn.nodeName&&"STYLE"!==Bn.nodeName&&!Bn.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(Bn,Bn.getAttribute("aria-hidden")),Bn.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const ce=this._parentDialog;return ce?ce._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return Pt.\u0275fac=function(ce){return new(ce||Pt)(y.LFG(Jt.aV),y.LFG(y.zs3),y.LFG(ge,8),y.LFG(Pt,12),y.LFG(Jt.Xj),y.LFG(fe))},Pt.\u0275prov=y.Yz7({token:Pt,factory:Pt.\u0275fac}),Pt})();function ei(Pt,bt){let ce=Pt.length;for(;ce--;)bt(Pt[ce])}let ci=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({providers:[Qn,en],imports:[Jt.U8,De.eL,bn.rt,De.eL]}),Pt})();var gi=L(6451),Vi=L(9300),ji=L(5698);function hi(Pt,bt){}const Yi={params:{enterAnimationDuration:"150ms",exitAnimationDuration:"75ms"}},ir={dialogContainer:(0,ve.X$)("dialogContainer",[(0,ve.SB)("void, exit",(0,ve.oB)({opacity:0,transform:"scale(0.7)"})),(0,ve.SB)("enter",(0,ve.oB)({transform:"none"})),(0,ve.eR)("* => enter",(0,ve.ru)([(0,ve.jt)("{{enterAnimationDuration}} cubic-bezier(0, 0, 0.2, 1)",(0,ve.oB)({transform:"none",opacity:1})),(0,ve.IO)("@*",(0,ve.pV)(),{optional:!0})]),Yi),(0,ve.eR)("* => void, * => exit",(0,ve.ru)([(0,ve.jt)("{{exitAnimationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)",(0,ve.oB)({opacity:0})),(0,ve.IO)("@*",(0,ve.pV)(),{optional:!0})]),Yi)])};class Ki{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0,this.enterAnimationDuration=Yi.params.enterAnimationDuration,this.exitAnimationDuration=Yi.params.exitAnimationDuration}}let kr=(()=>{class Pt extends Ye{constructor(ce,Ke,Nt,Bn,xi,si,pi,Vr){super(ce,Ke,Nt,Bn,xi,si,pi,Vr),this._animationStateChanged=new y.vpe}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(ce){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:ce})}}return Pt.\u0275fac=function(ce){return new(ce||Pt)(y.Y36(y.SBq),y.Y36(bn.qV),y.Y36(ze.K0,8),y.Y36(Ki),y.Y36(bn.ic),y.Y36(y.R0b),y.Y36(Jt.Iu),y.Y36(bn.tE))},Pt.\u0275cmp=y.Xpm({type:Pt,selectors:[["ng-component"]],features:[y.qOj],decls:0,vars:0,template:function(ce,Ke){},encapsulation:2}),Pt})(),Cr=(()=>{class Pt extends kr{constructor(ce,Ke,Nt,Bn,xi,si,pi,Vr,Ho){super(ce,Ke,Nt,Bn,xi,si,pi,Ho),this._changeDetectorRef=Vr,this._state="enter"}_onAnimationDone({toState:ce,totalTime:Ke}){"enter"===ce?this._openAnimationDone(Ke):"exit"===ce&&this._animationStateChanged.next({state:"closed",totalTime:Ke})}_onAnimationStart({toState:ce,totalTime:Ke}){"enter"===ce?this._animationStateChanged.next({state:"opening",totalTime:Ke}):("exit"===ce||"void"===ce)&&this._animationStateChanged.next({state:"closing",totalTime:Ke})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_getAnimationState(){return{value:this._state,params:{enterAnimationDuration:this._config.enterAnimationDuration||Yi.params.enterAnimationDuration,exitAnimationDuration:this._config.exitAnimationDuration||Yi.params.exitAnimationDuration}}}}return Pt.\u0275fac=function(ce){return new(ce||Pt)(y.Y36(y.SBq),y.Y36(bn.qV),y.Y36(ze.K0,8),y.Y36(Ki),y.Y36(bn.ic),y.Y36(y.R0b),y.Y36(Jt.Iu),y.Y36(y.sBO),y.Y36(bn.tE))},Pt.\u0275cmp=y.Xpm({type:Pt,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-dialog-container"],hostVars:7,hostBindings:function(ce,Ke){1&ce&&y.WFA("@dialogContainer.start",function(Bn){return Ke._onAnimationStart(Bn)})("@dialogContainer.done",function(Bn){return Ke._onAnimationDone(Bn)}),2&ce&&(y.Ikx("id",Ke._config.id),y.uIk("aria-modal",Ke._config.ariaModal)("role",Ke._config.role)("aria-labelledby",Ke._config.ariaLabel?null:Ke._ariaLabelledBy)("aria-label",Ke._config.ariaLabel)("aria-describedby",Ke._config.ariaDescribedBy||null),y.d8E("@dialogContainer",Ke._getAnimationState()))},features:[y.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(ce,Ke){1&ce&&y.YNc(0,hi,0,0,"ng-template",0)},dependencies:[De.Pl],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions.mat-dialog-actions-align-center,.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions.mat-dialog-actions-align-end,.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,data:{animation:[ir.dialogContainer]}}),Pt})();class pn{constructor(bt,ce,Ke){this._ref=bt,this._containerInstance=Ke,this._afterOpened=new be.x,this._beforeClosed=new be.x,this._state=0,this.disableClose=ce.disableClose,this.id=bt.id,Ke._animationStateChanged.pipe((0,Vi.h)(Nt=>"opened"===Nt.state),(0,ji.q)(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),Ke._animationStateChanged.pipe((0,Vi.h)(Nt=>"closed"===Nt.state),(0,ji.q)(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),bt.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),(0,gi.T)(this.backdropClick(),this.keydownEvents().pipe((0,Vi.h)(Nt=>Nt.keyCode===oe.hY&&!this.disableClose&&!(0,oe.Vb)(Nt)))).subscribe(Nt=>{this.disableClose||(Nt.preventDefault(),function qr(Pt,bt,ce){Pt._closeInteractionType=bt,Pt.close(ce)}(this,"keydown"===Nt.type?"keyboard":"mouse"))})}close(bt){this._result=bt,this._containerInstance._animationStateChanged.pipe((0,Vi.h)(ce=>"closing"===ce.state),(0,ji.q)(1)).subscribe(ce=>{this._beforeClosed.next(bt),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),ce.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(bt){let ce=this._ref.config.positionStrategy;return bt&&(bt.left||bt.right)?bt.left?ce.left(bt.left):ce.right(bt.right):ce.centerHorizontally(),bt&&(bt.top||bt.bottom)?bt.top?ce.top(bt.top):ce.bottom(bt.bottom):ce.centerVertically(),this._ref.updatePosition(),this}updateSize(bt="",ce=""){return this._ref.updateSize(bt,ce),this}addPanelClass(bt){return this._ref.addPanelClass(bt),this}removePanelClass(bt){return this._ref.removePanelClass(bt),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const Lr=new y.OlP("MatDialogData"),Ro=new y.OlP("mat-dialog-default-options"),js=new y.OlP("mat-dialog-scroll-strategy"),Gi={provide:js,deps:[Jt.aV],useFactory:function ii(Pt){return()=>Pt.scrollStrategies.block()}};let rr=0,Kn=(()=>{class Pt{constructor(ce,Ke,Nt,Bn,xi,si,pi,Vr,Ho,Mo){this._overlay=ce,this._defaultOptions=Nt,this._parentDialog=Bn,this._dialogRefConstructor=pi,this._dialogContainerType=Vr,this._dialogDataToken=Ho,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new be.x,this._afterOpenedAtThisLevel=new be.x,this._idPrefix="mat-dialog-",this.afterAllClosed=(0,wt.P)(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe((0,Q.O)(void 0))),this._scrollStrategy=si,this._dialog=Ke.get(Qn)}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const ce=this._parentDialog;return ce?ce._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(ce,Ke){let Nt;(Ke={...this._defaultOptions||new Ki,...Ke}).id=Ke.id||`${this._idPrefix}${rr++}`,Ke.scrollStrategy=Ke.scrollStrategy||this._scrollStrategy();const Bn=this._dialog.open(ce,{...Ke,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:Ki,useValue:Ke},{provide:ye,useValue:Ke}]},templateContext:()=>({dialogRef:Nt}),providers:(xi,si,pi)=>(Nt=new this._dialogRefConstructor(xi,Ke,pi),Nt.updatePosition(Ke?.position),[{provide:this._dialogContainerType,useValue:pi},{provide:this._dialogDataToken,useValue:si.data},{provide:this._dialogRefConstructor,useValue:Nt}])});return Nt.componentInstance=Bn.componentInstance,this.openDialogs.push(Nt),this.afterOpened.next(Nt),Nt.afterClosed().subscribe(()=>{const xi=this.openDialogs.indexOf(Nt);xi>-1&&(this.openDialogs.splice(xi,1),this.openDialogs.length||this._getAfterAllClosed().next())}),Nt}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(ce){return this.openDialogs.find(Ke=>Ke.id===ce)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(ce){let Ke=ce.length;for(;Ke--;)ce[Ke].close()}}return Pt.\u0275fac=function(ce){y.$Z()},Pt.\u0275prov=y.Yz7({token:Pt,factory:Pt.\u0275fac}),Pt})(),Ri=(()=>{class Pt extends Kn{constructor(ce,Ke,Nt,Bn,xi,si,pi,Vr){super(ce,Ke,Bn,si,pi,xi,pn,Cr,Lr,Vr)}}return Pt.\u0275fac=function(ce){return new(ce||Pt)(y.LFG(Jt.aV),y.LFG(y.zs3),y.LFG(ze.Ye,8),y.LFG(Ro,8),y.LFG(js),y.LFG(Pt,12),y.LFG(Jt.Xj),y.LFG(y.QbO,8))},Pt.\u0275prov=y.Yz7({token:Pt,factory:Pt.\u0275fac}),Pt})(),Eo=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({providers:[Ri,Gi],imports:[ci,Jt.U8,De.eL,j.BQ,j.BQ]}),Pt})();var Br=L(7084),ur=L(9643);let $s=(()=>{class Pt{}return Pt.\u0275fac=function(ce){return new(ce||Pt)},Pt.\u0275mod=y.oAB({type:Pt}),Pt.\u0275inj=y.cJS({imports:[ze.ez,j.BQ,De.eL,j.si,ur.Q8,bn.rt,j.BQ]}),Pt})(),xs=(()=>{class Pt{static#e=this.\u0275fac=function(Ke){return new(Ke||Pt)};static#t=this.\u0275mod=y.oAB({type:Pt});static#n=this.\u0275inj=y.cJS({imports:[w.SJ,$e,at.ot,qe.Ps,Ve.ie,fi,Ci.N6,Bt.Cq,Zt.Bb,nn.lN,Ct.c,_t.ZX,Ft,Eo,Br.To,$s]})}return Pt})()},655:(Yn,kt,L)=>{"use strict";L.d(kt,{b:()=>j});const y=L(2340).N.base_url;class j{constructor(de,Qe,it,Ce,Fe,$e,at,qe,Ve,tt,Re,ft){this.nombre=de,this.apellidoP=Qe,this.apellidoM=it,this.email=Ce,this.password=Fe,this.img=$e,this.google=at,this.role=qe,this.status=Ve,this.respuesta=tt,this.pregunta=Re,this.uid=ft}get imagenUrl(){return this.img?this.img?.includes("https")?this.img:this.img?`${y}/upload/usuarios/${this.img}`:`${y}/upload/usuarios/no-img-usuario`:`${y}/upload/usuarios/no-img-usuario`}}},646:(Yn,kt,L)=>{"use strict";L.d(kt,{$:()=>a});var w=L(2340),y=L(4650);const j=w.N.base_url;let a=(()=>{class de{transform(it,Ce){return it?it?.includes("https")?it:it?`${j}/upload/${Ce}/${it}`:`${j}/upload/usuarios/no-image`:`${j}/upload/usuarios/no-image`}static#e=this.\u0275fac=function(Ce){return new(Ce||de)};static#t=this.\u0275pipe=y.Yjl({name:"imagen",type:de,pure:!0})}return de})()},5503:(Yn,kt,L)=>{"use strict";L.d(kt,{D:()=>j});var w=L(6895),y=L(4650);let j=(()=>{class a{static#e=this.\u0275fac=function(it){return new(it||a)};static#t=this.\u0275mod=y.oAB({type:a});static#n=this.\u0275inj=y.cJS({imports:[w.ez]})}return a})()},6814:(Yn,kt,L)=>{"use strict";L.d(kt,{z:()=>de});var w=L(4004),y=L(2340),j=L(4650),a=L(529);let de=(()=>{class Qe{constructor(Ce){this.http=Ce,this.baseUrl=y.N.base_url}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}getCarruseles(){return this.http.get(`${this.baseUrl}/carruseles`,this.headers).pipe((0,w.U)(Fe=>Fe.carruseles))}getCarruselPorId(Ce){return this.http.get(`${this.baseUrl}/carruseles/${Ce}`,this.headers).pipe((0,w.U)($e=>$e.carrusel))}agregarCarrusel(Ce){return this.http.post(`${this.baseUrl}/carruseles`,Ce,this.headers)}actualizarCarrusel(Ce){return this.http.put(`${this.baseUrl}/carruseles/${Ce._id}`,Ce,this.headers)}eliminarCarrusel(Ce){return this.http.delete(`${this.baseUrl}/carruseles/${Ce}`,this.headers)}static#e=this.\u0275fac=function(Fe){return new(Fe||Qe)(j.LFG(a.eN))};static#t=this.\u0275prov=j.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"})}return Qe})()},3576:(Yn,kt,L)=>{"use strict";L.d(kt,{k:()=>a});var w=L(2340),y=L(4650),j=L(529);let a=(()=>{class de{constructor(it){this.http=it,this.baseUrl=w.N.base_url}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}copiBD(){return this.http.get(`${this.baseUrl}/upload/copia`,this.headers)}respaldoBD(){return this.http.get(`${this.baseUrl}/upload/restaurar`,this.headers)}postDatosDR(it){return this.http.post("https://warasabia.pythonanywhere.com/",it)}static#e=this.\u0275fac=function(Ce){return new(Ce||de)(y.LFG(j.eN))};static#t=this.\u0275prov=y.Yz7({token:de,factory:de.\u0275fac,providedIn:"root"})}return de})()},2340:(Yn,kt,L)=>{"use strict";L.d(kt,{N:()=>w});const w={production:!0,mapboxToken:"pk.eyJ1Ijoic2VpbmVudGVuIiwiYSI6ImNsZGRiam42eTAyMG8zcHA1d3Fnd3Fob3YifQ.n-Kz1QaIGkAkRZ4TP6rNYg",base_url:"https://solf.onrender.com/api"}},816:(Yn,kt,L)=>{"use strict";var w=L(1481),y=L(4650),j=L(529),a=L(7340);function Qe(K){return new y.vHH(3e3,!1)}function ve(){return typeof window<"u"&&typeof window.document<"u"}function Lt(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Tt(K){switch(K.length){case 0:return new a.ZN;case 1:return K[0];default:return new a.ZE(K)}}function fn(K,S,T,V,ie=new Map,Oe=new Map){const Je=[],Ot=[];let hn=-1,On=null;if(V.forEach(ri=>{const ui=ri.get("offset"),ar=ui==hn,nr=ar&&On||new Map;ri.forEach((Ti,Zi)=>{let Wn=Zi,Xr=Ti;if("offset"!==Zi)switch(Wn=S.normalizePropertyName(Wn,Je),Xr){case a.k1:Xr=ie.get(Zi);break;case a.l3:Xr=Oe.get(Zi);break;default:Xr=S.normalizeStyleValue(Zi,Wn,Xr,Je)}nr.set(Wn,Xr)}),ar||Ot.push(nr),On=nr,hn=ui}),Je.length)throw function Et(K){return new y.vHH(3502,!1)}();return Ot}function me(K,S,T,V){switch(S){case"start":K.onStart(()=>V(T&&Rt(T,"start",K)));break;case"done":K.onDone(()=>V(T&&Rt(T,"done",K)));break;case"destroy":K.onDestroy(()=>V(T&&Rt(T,"destroy",K)))}}function Rt(K,S,T){const Oe=Se(K.element,K.triggerName,K.fromState,K.toState,S||K.phaseName,T.totalTime??K.totalTime,!!T.disabled),Je=K._data;return null!=Je&&(Oe._data=Je),Oe}function Se(K,S,T,V,ie="",Oe=0,Je){return{element:K,triggerName:S,fromState:T,toState:V,phaseName:ie,totalTime:Oe,disabled:!!Je}}function vt(K,S,T){let V=K.get(S);return V||K.set(S,V=T),V}function jn(K){const S=K.indexOf(":");return[K.substring(1,S),K.slice(S+1)]}let li=(K,S)=>!1,Bi=(K,S,T)=>[],dn=null;function ue(K){const S=K.parentNode||K.host;return S===dn?null:S}(Lt()||typeof Element<"u")&&(ve()?(dn=(()=>document.documentElement)(),li=(K,S)=>{for(;S;){if(S===K)return!0;S=ue(S)}return!1}):li=(K,S)=>K.contains(S),Bi=(K,S,T)=>{if(T)return Array.from(K.querySelectorAll(S));const V=K.querySelector(S);return V?[V]:[]});let lt=null,Vt=!1;const At=li,Ae=Bi;let Dn=(()=>{class K{validateStyleProperty(T){return function An(K){lt||(lt=function Mn(){return typeof document<"u"?document.body:null}()||{},Vt=!!lt.style&&"WebkitAppearance"in lt.style);let S=!0;return lt.style&&!function xt(K){return"ebkit"==K.substring(1,6)}(K)&&(S=K in lt.style,!S&&Vt&&(S="Webkit"+K.charAt(0).toUpperCase()+K.slice(1)in lt.style)),S}(T)}matchesElement(T,V){return!1}containsElement(T,V){return At(T,V)}getParentElement(T){return ue(T)}query(T,V,ie){return Ae(T,V,ie)}computeStyle(T,V,ie){return ie||""}animate(T,V,ie,Oe,Je,Ot=[],hn){return new a.ZN(ie,Oe)}}return K.\u0275fac=function(T){return new(T||K)},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})(),ln=(()=>{class K{}return K.NOOP=new Dn,K})();const mi=1e3,Ii="ng-enter",Ir="ng-leave",Kt="ng-trigger",Ft=".ng-trigger",_t="ng-animating",bn=".ng-animating";function Ut(K){if("number"==typeof K)return K;const S=K.match(/^(-?[\.\d]+)(m?s)/);return!S||S.length<2?0:De(parseFloat(S[1]),S[2])}function De(K,S){return"s"===S?K*mi:K}function oe(K,S,T){return K.hasOwnProperty("duration")?K:function be(K,S,T){let ie,Oe=0,Je="";if("string"==typeof K){const Ot=K.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===Ot)return S.push(Qe()),{duration:0,delay:0,easing:""};ie=De(parseFloat(Ot[1]),Ot[2]);const hn=Ot[3];null!=hn&&(Oe=De(parseFloat(hn),Ot[4]));const On=Ot[5];On&&(Je=On)}else ie=K;if(!T){let Ot=!1,hn=S.length;ie<0&&(S.push(function it(){return new y.vHH(3100,!1)}()),Ot=!0),Oe<0&&(S.push(function Ce(){return new y.vHH(3101,!1)}()),Ot=!0),Ot&&S.splice(hn,0,Qe())}return{duration:ie,delay:Oe,easing:Je}}(K,S,T)}function wt(K,S={}){return Object.keys(K).forEach(T=>{S[T]=K[T]}),S}function $t(K){const S=new Map;return Object.keys(K).forEach(T=>{S.set(T,K[T])}),S}function ae(K,S=new Map,T){if(T)for(let[V,ie]of T)S.set(V,ie);for(let[V,ie]of K)S.set(V,ie);return S}function ye(K,S,T){return T?S+":"+T+";":""}function Ge(K){let S="";for(let T=0;T<K.style.length;T++){const V=K.style.item(T);S+=ye(0,V,K.style.getPropertyValue(V))}for(const T in K.style)K.style.hasOwnProperty(T)&&!T.startsWith("_")&&(S+=ye(0,ci(T),K.style[T]));K.setAttribute("style",S)}function Ye(K,S,T){K.style&&(S.forEach((V,ie)=>{const Oe=ei(ie);T&&!T.has(ie)&&T.set(ie,K.style[Oe]),K.style[Oe]=V}),Lt()&&Ge(K))}function xe(K,S){K.style&&(S.forEach((T,V)=>{const ie=ei(V);K.style[ie]=""}),Lt()&&Ge(K))}function fe(K){return Array.isArray(K)?1==K.length?K[0]:(0,a.vP)(K):K}const ge=new RegExp("{{\\s*(.+?)\\s*}}","g");function ut(K){let S=[];if("string"==typeof K){let T;for(;T=ge.exec(K);)S.push(T[1]);ge.lastIndex=0}return S}function en(K,S,T){const V=K.toString(),ie=V.replace(ge,(Oe,Je)=>{let Ot=S[Je];return null==Ot&&(T.push(function $e(K){return new y.vHH(3003,!1)}()),Ot=""),Ot.toString()});return ie==V?K:ie}function Xt(K){const S=[];let T=K.next();for(;!T.done;)S.push(T.value),T=K.next();return S}const Qn=/-+([a-z0-9])/g;function ei(K){return K.replace(Qn,(...S)=>S[1].toUpperCase())}function ci(K){return K.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ji(K,S,T){switch(S.type){case 7:return K.visitTrigger(S,T);case 0:return K.visitState(S,T);case 1:return K.visitTransition(S,T);case 2:return K.visitSequence(S,T);case 3:return K.visitGroup(S,T);case 4:return K.visitAnimate(S,T);case 5:return K.visitKeyframes(S,T);case 6:return K.visitStyle(S,T);case 8:return K.visitReference(S,T);case 9:return K.visitAnimateChild(S,T);case 10:return K.visitAnimateRef(S,T);case 11:return K.visitQuery(S,T);case 12:return K.visitStagger(S,T);default:throw function at(K){return new y.vHH(3004,!1)}()}}function hi(K,S){return window.getComputedStyle(K)[S]}const Lr="*";function Ro(K,S){const T=[];return"string"==typeof K?K.split(/\s*,\s*/).forEach(V=>function js(K,S,T){if(":"==K[0]){const hn=function Pr(K,S){switch(K){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(T,V)=>parseFloat(V)>parseFloat(T);case":decrement":return(T,V)=>parseFloat(V)<parseFloat(T);default:return S.push(function sn(K){return new y.vHH(3016,!1)}()),"* => *"}}(K,T);if("function"==typeof hn)return void S.push(hn);K=hn}const V=K.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==V||V.length<4)return T.push(function It(K){return new y.vHH(3015,!1)}()),S;const ie=V[1],Oe=V[2],Je=V[3];S.push(rr(ie,Je));"<"==Oe[0]&&!(ie==Lr&&Je==Lr)&&S.push(rr(Je,ie))}(V,T,S)):T.push(K),T}const ii=new Set(["true","1"]),Gi=new Set(["false","0"]);function rr(K,S){const T=ii.has(K)||Gi.has(K),V=ii.has(S)||Gi.has(S);return(ie,Oe)=>{let Je=K==Lr||K==ie,Ot=S==Lr||S==Oe;return!Je&&T&&"boolean"==typeof ie&&(Je=ie?ii.has(K):Gi.has(K)),!Ot&&V&&"boolean"==typeof Oe&&(Ot=Oe?ii.has(S):Gi.has(S)),Je&&Ot}}const Ri=new RegExp("s*:selfs*,?","g");function bi(K,S,T,V){return new Ji(K).build(S,T,V)}class Ji{constructor(S){this._driver=S}build(S,T,V){const ie=new $i(T);return this._resetContextStyleTimingState(ie),ji(this,fe(S),ie)}_resetContextStyleTimingState(S){S.currentQuerySelector="",S.collectedStyles=new Map,S.collectedStyles.set("",new Map),S.currentTime=0}visitTrigger(S,T){let V=T.queryCount=0,ie=T.depCount=0;const Oe=[],Je=[];return"@"==S.name.charAt(0)&&T.errors.push(function Ve(){return new y.vHH(3006,!1)}()),S.definitions.forEach(Ot=>{if(this._resetContextStyleTimingState(T),0==Ot.type){const hn=Ot,On=hn.name;On.toString().split(/\s*,\s*/).forEach(ri=>{hn.name=ri,Oe.push(this.visitState(hn,T))}),hn.name=On}else if(1==Ot.type){const hn=this.visitTransition(Ot,T);V+=hn.queryCount,ie+=hn.depCount,Je.push(hn)}else T.errors.push(function tt(){return new y.vHH(3007,!1)}())}),{type:7,name:S.name,states:Oe,transitions:Je,queryCount:V,depCount:ie,options:null}}visitState(S,T){const V=this.visitStyle(S.styles,T),ie=S.options&&S.options.params||null;if(V.containsDynamicStyles){const Oe=new Set,Je=ie||{};V.styles.forEach(Ot=>{Ot instanceof Map&&Ot.forEach(hn=>{ut(hn).forEach(On=>{Je.hasOwnProperty(On)||Oe.add(On)})})}),Oe.size&&(Xt(Oe.values()),T.errors.push(function Re(K,S){return new y.vHH(3008,!1)}()))}return{type:0,name:S.name,style:V,options:ie?{params:ie}:null}}visitTransition(S,T){T.queryCount=0,T.depCount=0;const V=ji(this,fe(S.animation),T);return{type:1,matchers:Ro(S.expr,T.errors),animation:V,queryCount:T.queryCount,depCount:T.depCount,options:ur(S.options)}}visitSequence(S,T){return{type:2,steps:S.steps.map(V=>ji(this,V,T)),options:ur(S.options)}}visitGroup(S,T){const V=T.currentTime;let ie=0;const Oe=S.steps.map(Je=>{T.currentTime=V;const Ot=ji(this,Je,T);return ie=Math.max(ie,T.currentTime),Ot});return T.currentTime=ie,{type:3,steps:Oe,options:ur(S.options)}}visitAnimate(S,T){const V=function Br(K,S){if(K.hasOwnProperty("duration"))return K;if("number"==typeof K)return xo(oe(K,S).duration,0,"");const T=K;if(T.split(/\s+/).some(Oe=>"{"==Oe.charAt(0)&&"{"==Oe.charAt(1))){const Oe=xo(0,0,"");return Oe.dynamic=!0,Oe.strValue=T,Oe}const ie=oe(T,S);return xo(ie.duration,ie.delay,ie.easing)}(S.timings,T.errors);T.currentAnimateTimings=V;let ie,Oe=S.styles?S.styles:(0,a.oB)({});if(5==Oe.type)ie=this.visitKeyframes(Oe,T);else{let Je=S.styles,Ot=!1;if(!Je){Ot=!0;const On={};V.easing&&(On.easing=V.easing),Je=(0,a.oB)(On)}T.currentTime+=V.duration+V.delay;const hn=this.visitStyle(Je,T);hn.isEmptyStep=Ot,ie=hn}return T.currentAnimateTimings=null,{type:4,timings:V,style:ie,options:null}}visitStyle(S,T){const V=this._makeStyleAst(S,T);return this._validateStyleAst(V,T),V}_makeStyleAst(S,T){const V=[],ie=Array.isArray(S.styles)?S.styles:[S.styles];for(let Ot of ie)"string"==typeof Ot?Ot===a.l3?V.push(Ot):T.errors.push(new y.vHH(3002,!1)):V.push($t(Ot));let Oe=!1,Je=null;return V.forEach(Ot=>{if(Ot instanceof Map&&(Ot.has("easing")&&(Je=Ot.get("easing"),Ot.delete("easing")),!Oe))for(let hn of Ot.values())if(hn.toString().indexOf("{{")>=0){Oe=!0;break}}),{type:6,styles:V,easing:Je,offset:S.offset,containsDynamicStyles:Oe,options:null}}_validateStyleAst(S,T){const V=T.currentAnimateTimings;let ie=T.currentTime,Oe=T.currentTime;V&&Oe>0&&(Oe-=V.duration+V.delay),S.styles.forEach(Je=>{"string"!=typeof Je&&Je.forEach((Ot,hn)=>{const On=T.collectedStyles.get(T.currentQuerySelector),ri=On.get(hn);let ui=!0;ri&&(Oe!=ie&&Oe>=ri.startTime&&ie<=ri.endTime&&(T.errors.push(function ht(K,S,T,V,ie){return new y.vHH(3010,!1)}()),ui=!1),Oe=ri.startTime),ui&&On.set(hn,{startTime:Oe,endTime:ie}),T.options&&function te(K,S,T){const V=S.params||{},ie=ut(K);ie.length&&ie.forEach(Oe=>{V.hasOwnProperty(Oe)||T.push(function Fe(K){return new y.vHH(3001,!1)}())})}(Ot,T.options,T.errors)})})}visitKeyframes(S,T){const V={type:5,styles:[],options:null};if(!T.currentAnimateTimings)return T.errors.push(function Gt(){return new y.vHH(3011,!1)}()),V;let Oe=0;const Je=[];let Ot=!1,hn=!1,On=0;const ri=S.steps.map(Xr=>{const or=this._makeStyleAst(Xr,T);let To=null!=or.offset?or.offset:function Eo(K){if("string"==typeof K)return null;let S=null;if(Array.isArray(K))K.forEach(T=>{if(T instanceof Map&&T.has("offset")){const V=T;S=parseFloat(V.get("offset")),V.delete("offset")}});else if(K instanceof Map&&K.has("offset")){const T=K;S=parseFloat(T.get("offset")),T.delete("offset")}return S}(or.styles),Bo=0;return null!=To&&(Oe++,Bo=or.offset=To),hn=hn||Bo<0||Bo>1,Ot=Ot||Bo<On,On=Bo,Je.push(Bo),or});hn&&T.errors.push(function an(){return new y.vHH(3012,!1)}()),Ot&&T.errors.push(function ot(){return new y.vHH(3200,!1)}());const ui=S.steps.length;let ar=0;Oe>0&&Oe<ui?T.errors.push(function Te(){return new y.vHH(3202,!1)}()):0==Oe&&(ar=1/(ui-1));const nr=ui-1,Ti=T.currentTime,Zi=T.currentAnimateTimings,Wn=Zi.duration;return ri.forEach((Xr,or)=>{const To=ar>0?or==nr?1:ar*or:Je[or],Bo=To*Wn;T.currentTime=Ti+Zi.delay+Bo,Zi.duration=Bo,this._validateStyleAst(Xr,T),Xr.offset=To,V.styles.push(Xr)}),V}visitReference(S,T){return{type:8,animation:ji(this,fe(S.animation),T),options:ur(S.options)}}visitAnimateChild(S,T){return T.depCount++,{type:9,options:ur(S.options)}}visitAnimateRef(S,T){return{type:10,animation:this.visitReference(S.animation,T),options:ur(S.options)}}visitQuery(S,T){const V=T.currentQuerySelector,ie=S.options||{};T.queryCount++,T.currentQuery=S;const[Oe,Je]=function Pi(K){const S=!!K.split(/\s*,\s*/).find(T=>":self"==T);return S&&(K=K.replace(Ri,"")),K=K.replace(/@\*/g,Ft).replace(/@\w+/g,T=>Ft+"-"+T.slice(1)).replace(/:animating/g,bn),[K,S]}(S.selector);T.currentQuerySelector=V.length?V+" "+Oe:Oe,vt(T.collectedStyles,T.currentQuerySelector,new Map);const Ot=ji(this,fe(S.animation),T);return T.currentQuery=null,T.currentQuerySelector=V,{type:11,selector:Oe,limit:ie.limit||0,optional:!!ie.optional,includeSelf:Je,animation:Ot,originalSelector:S.selector,options:ur(S.options)}}visitStagger(S,T){T.currentQuery||T.errors.push(function Ne(){return new y.vHH(3013,!1)}());const V="full"===S.timings?{duration:0,delay:0,easing:"full"}:oe(S.timings,T.errors,!0);return{type:12,animation:ji(this,fe(S.animation),T),timings:V,options:null}}}class $i{constructor(S){this.errors=S,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function ur(K){return K?(K=wt(K)).params&&(K.params=function wo(K){return K?wt(K):null}(K.params)):K={},K}function xo(K,S,T){return{duration:K,delay:S,easing:T}}function to(K,S,T,V,ie,Oe,Je=null,Ot=!1){return{type:1,element:K,keyframes:S,preStyleProps:T,postStyleProps:V,duration:ie,delay:Oe,totalTime:ie+Oe,easing:Je,subTimeline:Ot}}class ts{constructor(){this._map=new Map}get(S){return this._map.get(S)||[]}append(S,T){let V=this._map.get(S);V||this._map.set(S,V=[]),V.push(...T)}has(S){return this._map.has(S)}clear(){this._map.clear()}}const Hs=new RegExp(":enter","g"),Dr=new RegExp(":leave","g");function Io(K,S,T,V,ie,Oe=new Map,Je=new Map,Ot,hn,On=[]){return(new Gs).buildKeyframes(K,S,T,V,ie,Oe,Je,Ot,hn,On)}class Gs{buildKeyframes(S,T,V,ie,Oe,Je,Ot,hn,On,ri=[]){On=On||new ts;const ui=new Or(S,T,On,ie,Oe,ri,[]);ui.options=hn;const ar=hn.delay?Ut(hn.delay):0;ui.currentTimeline.delayNextStep(ar),ui.currentTimeline.setStyles([Je],null,ui.errors,hn),ji(this,V,ui);const nr=ui.timelines.filter(Ti=>Ti.containsAnimation());if(nr.length&&Ot.size){let Ti;for(let Zi=nr.length-1;Zi>=0;Zi--){const Wn=nr[Zi];if(Wn.element===T){Ti=Wn;break}}Ti&&!Ti.allowOnlyTimelineStyles()&&Ti.setStyles([Ot],null,ui.errors,hn)}return nr.length?nr.map(Ti=>Ti.buildKeyframes()):[to(T,[],[],[],0,ar,"",!1)]}visitTrigger(S,T){}visitState(S,T){}visitTransition(S,T){}visitAnimateChild(S,T){const V=T.subInstructions.get(T.element);if(V){const ie=T.createSubContext(S.options),Oe=T.currentTimeline.currentTime,Je=this._visitSubInstructions(V,ie,ie.options);Oe!=Je&&T.transformIntoNewTimeline(Je)}T.previousNode=S}visitAnimateRef(S,T){const V=T.createSubContext(S.options);V.transformIntoNewTimeline(),this._applyAnimationRefDelays([S.options,S.animation.options],T,V),this.visitReference(S.animation,V),T.transformIntoNewTimeline(V.currentTimeline.currentTime),T.previousNode=S}_applyAnimationRefDelays(S,T,V){for(const ie of S){const Oe=ie?.delay;if(Oe){const Je="number"==typeof Oe?Oe:Ut(en(Oe,ie?.params??{},T.errors));V.delayNextStep(Je)}}}_visitSubInstructions(S,T,V){let Oe=T.currentTimeline.currentTime;const Je=null!=V.duration?Ut(V.duration):null,Ot=null!=V.delay?Ut(V.delay):null;return 0!==Je&&S.forEach(hn=>{const On=T.appendInstructionToTimeline(hn,Je,Ot);Oe=Math.max(Oe,On.duration+On.delay)}),Oe}visitReference(S,T){T.updateOptions(S.options,!0),ji(this,S.animation,T),T.previousNode=S}visitSequence(S,T){const V=T.subContextCount;let ie=T;const Oe=S.options;if(Oe&&(Oe.params||Oe.delay)&&(ie=T.createSubContext(Oe),ie.transformIntoNewTimeline(),null!=Oe.delay)){6==ie.previousNode.type&&(ie.currentTimeline.snapshotCurrentStyles(),ie.previousNode=po);const Je=Ut(Oe.delay);ie.delayNextStep(Je)}S.steps.length&&(S.steps.forEach(Je=>ji(this,Je,ie)),ie.currentTimeline.applyStylesToKeyframe(),ie.subContextCount>V&&ie.transformIntoNewTimeline()),T.previousNode=S}visitGroup(S,T){const V=[];let ie=T.currentTimeline.currentTime;const Oe=S.options&&S.options.delay?Ut(S.options.delay):0;S.steps.forEach(Je=>{const Ot=T.createSubContext(S.options);Oe&&Ot.delayNextStep(Oe),ji(this,Je,Ot),ie=Math.max(ie,Ot.currentTimeline.currentTime),V.push(Ot.currentTimeline)}),V.forEach(Je=>T.currentTimeline.mergeTimelineCollectedStyles(Je)),T.transformIntoNewTimeline(ie),T.previousNode=S}_visitTiming(S,T){if(S.dynamic){const V=S.strValue;return oe(T.params?en(V,T.params,T.errors):V,T.errors)}return{duration:S.duration,delay:S.delay,easing:S.easing}}visitAnimate(S,T){const V=T.currentAnimateTimings=this._visitTiming(S.timings,T),ie=T.currentTimeline;V.delay&&(T.incrementTime(V.delay),ie.snapshotCurrentStyles());const Oe=S.style;5==Oe.type?this.visitKeyframes(Oe,T):(T.incrementTime(V.duration),this.visitStyle(Oe,T),ie.applyStylesToKeyframe()),T.currentAnimateTimings=null,T.previousNode=S}visitStyle(S,T){const V=T.currentTimeline,ie=T.currentAnimateTimings;!ie&&V.hasCurrentStyleProperties()&&V.forwardFrame();const Oe=ie&&ie.easing||S.easing;S.isEmptyStep?V.applyEmptyStep(Oe):V.setStyles(S.styles,Oe,T.errors,T.options),T.previousNode=S}visitKeyframes(S,T){const V=T.currentAnimateTimings,ie=T.currentTimeline.duration,Oe=V.duration,Ot=T.createSubContext().currentTimeline;Ot.easing=V.easing,S.styles.forEach(hn=>{Ot.forwardTime((hn.offset||0)*Oe),Ot.setStyles(hn.styles,hn.easing,T.errors,T.options),Ot.applyStylesToKeyframe()}),T.currentTimeline.mergeTimelineCollectedStyles(Ot),T.transformIntoNewTimeline(ie+Oe),T.previousNode=S}visitQuery(S,T){const V=T.currentTimeline.currentTime,ie=S.options||{},Oe=ie.delay?Ut(ie.delay):0;Oe&&(6===T.previousNode.type||0==V&&T.currentTimeline.hasCurrentStyleProperties())&&(T.currentTimeline.snapshotCurrentStyles(),T.previousNode=po);let Je=V;const Ot=T.invokeQuery(S.selector,S.originalSelector,S.limit,S.includeSelf,!!ie.optional,T.errors);T.currentQueryTotal=Ot.length;let hn=null;Ot.forEach((On,ri)=>{T.currentQueryIndex=ri;const ui=T.createSubContext(S.options,On);Oe&&ui.delayNextStep(Oe),On===T.element&&(hn=ui.currentTimeline),ji(this,S.animation,ui),ui.currentTimeline.applyStylesToKeyframe(),Je=Math.max(Je,ui.currentTimeline.currentTime)}),T.currentQueryIndex=0,T.currentQueryTotal=0,T.transformIntoNewTimeline(Je),hn&&(T.currentTimeline.mergeTimelineCollectedStyles(hn),T.currentTimeline.snapshotCurrentStyles()),T.previousNode=S}visitStagger(S,T){const V=T.parentContext,ie=T.currentTimeline,Oe=S.timings,Je=Math.abs(Oe.duration),Ot=Je*(T.currentQueryTotal-1);let hn=Je*T.currentQueryIndex;switch(Oe.duration<0?"reverse":Oe.easing){case"reverse":hn=Ot-hn;break;case"full":hn=V.currentStaggerTime}const ri=T.currentTimeline;hn&&ri.delayNextStep(hn);const ui=ri.currentTime;ji(this,S.animation,T),T.previousNode=S,V.currentStaggerTime=ie.currentTime-ui+(ie.startTime-V.currentTimeline.startTime)}}const po={};class Or{constructor(S,T,V,ie,Oe,Je,Ot,hn){this._driver=S,this.element=T,this.subInstructions=V,this._enterClassName=ie,this._leaveClassName=Oe,this.errors=Je,this.timelines=Ot,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=po,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=hn||new jo(this._driver,T,0),Ot.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(S,T){if(!S)return;const V=S;let ie=this.options;null!=V.duration&&(ie.duration=Ut(V.duration)),null!=V.delay&&(ie.delay=Ut(V.delay));const Oe=V.params;if(Oe){let Je=ie.params;Je||(Je=this.options.params={}),Object.keys(Oe).forEach(Ot=>{(!T||!Je.hasOwnProperty(Ot))&&(Je[Ot]=en(Oe[Ot],Je,this.errors))})}}_copyOptions(){const S={};if(this.options){const T=this.options.params;if(T){const V=S.params={};Object.keys(T).forEach(ie=>{V[ie]=T[ie]})}}return S}createSubContext(S=null,T,V){const ie=T||this.element,Oe=new Or(this._driver,ie,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(ie,V||0));return Oe.previousNode=this.previousNode,Oe.currentAnimateTimings=this.currentAnimateTimings,Oe.options=this._copyOptions(),Oe.updateOptions(S),Oe.currentQueryIndex=this.currentQueryIndex,Oe.currentQueryTotal=this.currentQueryTotal,Oe.parentContext=this,this.subContextCount++,Oe}transformIntoNewTimeline(S){return this.previousNode=po,this.currentTimeline=this.currentTimeline.fork(this.element,S),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(S,T,V){const ie={duration:T??S.duration,delay:this.currentTimeline.currentTime+(V??0)+S.delay,easing:""},Oe=new ys(this._driver,S.element,S.keyframes,S.preStyleProps,S.postStyleProps,ie,S.stretchStartingKeyframe);return this.timelines.push(Oe),ie}incrementTime(S){this.currentTimeline.forwardTime(this.currentTimeline.duration+S)}delayNextStep(S){S>0&&this.currentTimeline.delayNextStep(S)}invokeQuery(S,T,V,ie,Oe,Je){let Ot=[];if(ie&&Ot.push(this.element),S.length>0){S=(S=S.replace(Hs,"."+this._enterClassName)).replace(Dr,"."+this._leaveClassName);let On=this._driver.query(this.element,S,1!=V);0!==V&&(On=V<0?On.slice(On.length+V,On.length):On.slice(0,V)),Ot.push(...On)}return!Oe&&0==Ot.length&&Je.push(function mt(K){return new y.vHH(3014,!1)}()),Ot}}class jo{constructor(S,T,V,ie){this._driver=S,this.element=T,this.startTime=V,this._elementTimelineStylesLookup=ie,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(T),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(T,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(S){const T=1===this._keyframes.size&&this._pendingStyles.size;this.duration||T?(this.forwardTime(this.currentTime+S),T&&this.snapshotCurrentStyles()):this.startTime+=S}fork(S,T){return this.applyStylesToKeyframe(),new jo(this._driver,S,T||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(S){this.applyStylesToKeyframe(),this.duration=S,this._loadKeyframe()}_updateStyle(S,T){this._localTimelineStyles.set(S,T),this._globalTimelineStyles.set(S,T),this._styleSummary.set(S,{time:this.currentTime,value:T})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(S){S&&this._previousKeyframe.set("easing",S);for(let[T,V]of this._globalTimelineStyles)this._backFill.set(T,V||a.l3),this._currentKeyframe.set(T,a.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(S,T,V,ie){T&&this._previousKeyframe.set("easing",T);const Oe=ie&&ie.params||{},Je=function ns(K,S){const T=new Map;let V;return K.forEach(ie=>{if("*"===ie){V=V||S.keys();for(let Oe of V)T.set(Oe,a.l3)}else ae(ie,T)}),T}(S,this._globalTimelineStyles);for(let[Ot,hn]of Je){const On=en(hn,Oe,V);this._pendingStyles.set(Ot,On),this._localTimelineStyles.has(Ot)||this._backFill.set(Ot,this._globalTimelineStyles.get(Ot)??a.l3),this._updateStyle(Ot,On)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((S,T)=>{this._currentKeyframe.set(T,S)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((S,T)=>{this._currentKeyframe.has(T)||this._currentKeyframe.set(T,S)}))}snapshotCurrentStyles(){for(let[S,T]of this._localTimelineStyles)this._pendingStyles.set(S,T),this._updateStyle(S,T)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const S=[];for(let T in this._currentKeyframe)S.push(T);return S}mergeTimelineCollectedStyles(S){S._styleSummary.forEach((T,V)=>{const ie=this._styleSummary.get(V);(!ie||T.time>ie.time)&&this._updateStyle(V,T.value)})}buildKeyframes(){this.applyStylesToKeyframe();const S=new Set,T=new Set,V=1===this._keyframes.size&&0===this.duration;let ie=[];this._keyframes.forEach((Ot,hn)=>{const On=ae(Ot,new Map,this._backFill);On.forEach((ri,ui)=>{ri===a.k1?S.add(ui):ri===a.l3&&T.add(ui)}),V||On.set("offset",hn/this.duration),ie.push(On)});const Oe=S.size?Xt(S.values()):[],Je=T.size?Xt(T.values()):[];if(V){const Ot=ie[0],hn=new Map(Ot);Ot.set("offset",0),hn.set("offset",1),ie=[Ot,hn]}return to(this.element,ie,Oe,Je,this.duration,this.startTime,this.easing,!1)}}class ys extends jo{constructor(S,T,V,ie,Oe,Je,Ot=!1){super(S,T,Je.delay),this.keyframes=V,this.preStyleProps=ie,this.postStyleProps=Oe,this._stretchStartingKeyframe=Ot,this.timings={duration:Je.duration,delay:Je.delay,easing:Je.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let S=this.keyframes,{delay:T,duration:V,easing:ie}=this.timings;if(this._stretchStartingKeyframe&&T){const Oe=[],Je=V+T,Ot=T/Je,hn=ae(S[0]);hn.set("offset",0),Oe.push(hn);const On=ae(S[0]);On.set("offset",dr(Ot)),Oe.push(On);const ri=S.length-1;for(let ui=1;ui<=ri;ui++){let ar=ae(S[ui]);const nr=ar.get("offset");ar.set("offset",dr((T+nr*V)/Je)),Oe.push(ar)}V=Je,T=0,ie="",S=Oe}return to(this.element,S,this.preStyleProps,this.postStyleProps,V,T,ie,!0)}}function dr(K,S=3){const T=Math.pow(10,S-1);return Math.round(K*T)/T}class lo{}const fo=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class is extends lo{normalizePropertyName(S,T){return ei(S)}normalizeStyleValue(S,T,V,ie){let Oe="";const Je=V.toString().trim();if(fo.has(T)&&0!==V&&"0"!==V)if("number"==typeof V)Oe="px";else{const Ot=V.match(/^[+-]?[\d\.]+([a-z]*)$/);Ot&&0==Ot[1].length&&ie.push(function qe(K,S){return new y.vHH(3005,!1)}())}return Je+Oe}}function no(K,S,T,V,ie,Oe,Je,Ot,hn,On,ri,ui,ar){return{type:0,element:K,triggerName:S,isRemovalTransition:ie,fromState:T,fromStyles:Oe,toState:V,toStyles:Je,timelines:Ot,queriedElements:hn,preStyleProps:On,postStyleProps:ri,totalTime:ui,errors:ar}}const io={};class Ss{constructor(S,T,V){this._triggerName=S,this.ast=T,this._stateStyles=V}match(S,T,V,ie){return function Wo(K,S,T,V,ie){return K.some(Oe=>Oe(S,T,V,ie))}(this.ast.matchers,S,T,V,ie)}buildStyles(S,T,V){let ie=this._stateStyles.get("*");return void 0!==S&&(ie=this._stateStyles.get(S?.toString())||ie),ie?ie.buildStyles(T,V):new Map}build(S,T,V,ie,Oe,Je,Ot,hn,On,ri){const ui=[],ar=this.ast.options&&this.ast.options.params||io,Ti=this.buildStyles(V,Ot&&Ot.params||io,ui),Zi=hn&&hn.params||io,Wn=this.buildStyles(ie,Zi,ui),Xr=new Set,or=new Map,To=new Map,Bo="void"===ie,Cl={params:pa(Zi,ar),delay:this.ast.options?.delay},Ra=ri?[]:Io(S,T,this.ast.animation,Oe,Je,Ti,Wn,Cl,On,ui);let Po=0;if(Ra.forEach(la=>{Po=Math.max(la.duration+la.delay,Po)}),ui.length)return no(T,this._triggerName,V,ie,Bo,Ti,Wn,[],[],or,To,Po,ui);Ra.forEach(la=>{const gs=la.element,Ml=vt(or,gs,new Set);la.preStyleProps.forEach(Hr=>Ml.add(Hr));const qa=vt(To,gs,new Set);la.postStyleProps.forEach(Hr=>qa.add(Hr)),gs!==T&&Xr.add(gs)});const ka=Xt(Xr.values());return no(T,this._triggerName,V,ie,Bo,Ti,Wn,Ra,ka,or,To,Po)}}function pa(K,S){const T=wt(S);for(const V in K)K.hasOwnProperty(V)&&null!=K[V]&&(T[V]=K[V]);return T}class Qs{constructor(S,T,V){this.styles=S,this.defaultParams=T,this.normalizer=V}buildStyles(S,T){const V=new Map,ie=wt(this.defaultParams);return Object.keys(S).forEach(Oe=>{const Je=S[Oe];null!==Je&&(ie[Oe]=Je)}),this.styles.styles.forEach(Oe=>{"string"!=typeof Oe&&Oe.forEach((Je,Ot)=>{Je&&(Je=en(Je,ie,T));const hn=this.normalizer.normalizePropertyName(Ot,T);Je=this.normalizer.normalizeStyleValue(Ot,hn,Je,T),V.set(Ot,Je)})}),V}}class Ma{constructor(S,T,V){this.name=S,this.ast=T,this._normalizer=V,this.transitionFactories=[],this.states=new Map,T.states.forEach(ie=>{this.states.set(ie.name,new Qs(ie.style,ie.options&&ie.options.params||{},V))}),Js(this.states,"true","1"),Js(this.states,"false","0"),T.transitions.forEach(ie=>{this.transitionFactories.push(new Ss(S,ie,this.states))}),this.fallbackTransition=function Is(K,S,T){return new Ss(K,{type:1,animation:{type:2,steps:[],options:null},matchers:[(Je,Ot)=>!0],options:null,queryCount:0,depCount:0},S)}(S,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(S,T,V,ie){return this.transitionFactories.find(Je=>Je.match(S,T,V,ie))||null}matchStyles(S,T,V){return this.fallbackTransition.buildStyles(S,T,V)}}function Js(K,S,T){K.has(S)?K.has(T)||K.set(T,K.get(S)):K.has(T)&&K.set(S,K.get(T))}const Ps=new ts;class Os{constructor(S,T,V){this.bodyNode=S,this._driver=T,this._normalizer=V,this._animations=new Map,this._playersById=new Map,this.players=[]}register(S,T){const V=[],ie=[],Oe=bi(this._driver,T,V,ie);if(V.length)throw function ct(K){return new y.vHH(3503,!1)}();this._animations.set(S,Oe)}_buildPlayer(S,T,V){const ie=S.element,Oe=fn(0,this._normalizer,0,S.keyframes,T,V);return this._driver.animate(ie,Oe,S.duration,S.delay,S.easing,[],!0)}create(S,T,V={}){const ie=[],Oe=this._animations.get(S);let Je;const Ot=new Map;if(Oe?(Je=Io(this._driver,T,Oe,Ii,Ir,new Map,new Map,V,Ps,ie),Je.forEach(ri=>{const ui=vt(Ot,ri.element,new Map);ri.postStyleProps.forEach(ar=>ui.set(ar,null))})):(ie.push(function Pn(){return new y.vHH(3300,!1)}()),Je=[]),ie.length)throw function Nn(K){return new y.vHH(3504,!1)}();Ot.forEach((ri,ui)=>{ri.forEach((ar,nr)=>{ri.set(nr,this._driver.computeStyle(ui,nr,a.l3))})});const On=Tt(Je.map(ri=>{const ui=Ot.get(ri.element);return this._buildPlayer(ri,new Map,ui)}));return this._playersById.set(S,On),On.onDestroy(()=>this.destroy(S)),this.players.push(On),On}destroy(S){const T=this._getPlayer(S);T.destroy(),this._playersById.delete(S);const V=this.players.indexOf(T);V>=0&&this.players.splice(V,1)}_getPlayer(S){const T=this._playersById.get(S);if(!T)throw function fi(K){return new y.vHH(3301,!1)}();return T}listen(S,T,V,ie){const Oe=Se(T,"","","");return me(this._getPlayer(S),V,Oe,ie),()=>{}}command(S,T,V,ie){if("register"==V)return void this.register(S,ie[0]);if("create"==V)return void this.create(S,T,ie[0]||{});const Oe=this._getPlayer(S);switch(V){case"play":Oe.play();break;case"pause":Oe.pause();break;case"reset":Oe.reset();break;case"restart":Oe.restart();break;case"finish":Oe.finish();break;case"init":Oe.init();break;case"setPosition":Oe.setPosition(parseFloat(ie[0]));break;case"destroy":this.destroy(S)}}}const rs="ng-animate-queued",yo="ng-animate-disabled",ja=[],ea={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ta={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ur="__ng_removed";class ps{get params(){return this.options.params}constructor(S,T=""){this.namespaceId=T;const V=S&&S.hasOwnProperty("value");if(this.value=function gl(K){return K??null}(V?S.value:S),V){const Oe=wt(S);delete Oe.value,this.options=Oe}else this.options={};this.options.params||(this.options.params={})}absorbOptions(S){const T=S.params;if(T){const V=this.options.params;Object.keys(T).forEach(ie=>{null==V[ie]&&(V[ie]=T[ie])})}}}const fs="void",na=new ps(fs);class ga{constructor(S,T,V){this.id=S,this.hostElement=T,this._engine=V,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+S,Pt(T,this._hostClassName)}listen(S,T,V,ie){if(!this._triggers.has(T))throw function Ci(K,S){return new y.vHH(3302,!1)}();if(null==V||0==V.length)throw function Bt(K){return new y.vHH(3303,!1)}();if(!function Da(K){return"start"==K||"done"==K}(V))throw function Zt(K,S){return new y.vHH(3400,!1)}();const Oe=vt(this._elementListeners,S,[]),Je={name:T,phase:V,callback:ie};Oe.push(Je);const Ot=vt(this._engine.statesByElement,S,new Map);return Ot.has(T)||(Pt(S,Kt),Pt(S,Kt+"-"+T),Ot.set(T,na)),()=>{this._engine.afterFlush(()=>{const hn=Oe.indexOf(Je);hn>=0&&Oe.splice(hn,1),this._triggers.has(T)||Ot.delete(T)})}}register(S,T){return!this._triggers.has(S)&&(this._triggers.set(S,T),!0)}_getTrigger(S){const T=this._triggers.get(S);if(!T)throw function nn(K){return new y.vHH(3401,!1)}();return T}trigger(S,T,V,ie=!0){const Oe=this._getTrigger(T),Je=new ko(this.id,T,S);let Ot=this._engine.statesByElement.get(S);Ot||(Pt(S,Kt),Pt(S,Kt+"-"+T),this._engine.statesByElement.set(S,Ot=new Map));let hn=Ot.get(T);const On=new ps(V,this.id);if(!(V&&V.hasOwnProperty("value"))&&hn&&On.absorbOptions(hn.options),Ot.set(T,On),hn||(hn=na),On.value!==fs&&hn.value===On.value){if(!function Bn(K,S){const T=Object.keys(K),V=Object.keys(S);if(T.length!=V.length)return!1;for(let ie=0;ie<T.length;ie++){const Oe=T[ie];if(!S.hasOwnProperty(Oe)||K[Oe]!==S[Oe])return!1}return!0}(hn.params,On.params)){const Zi=[],Wn=Oe.matchStyles(hn.value,hn.params,Zi),Xr=Oe.matchStyles(On.value,On.params,Zi);Zi.length?this._engine.reportError(Zi):this._engine.afterFlush(()=>{xe(S,Wn),Ye(S,Xr)})}return}const ar=vt(this._engine.playersByElement,S,[]);ar.forEach(Zi=>{Zi.namespaceId==this.id&&Zi.triggerName==T&&Zi.queued&&Zi.destroy()});let nr=Oe.matchTransition(hn.value,On.value,S,On.params),Ti=!1;if(!nr){if(!ie)return;nr=Oe.fallbackTransition,Ti=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:S,triggerName:T,transition:nr,fromState:hn,toState:On,player:Je,isFallbackTransition:Ti}),Ti||(Pt(S,rs),Je.onStart(()=>{bt(S,rs)})),Je.onDone(()=>{let Zi=this.players.indexOf(Je);Zi>=0&&this.players.splice(Zi,1);const Wn=this._engine.playersByElement.get(S);if(Wn){let Xr=Wn.indexOf(Je);Xr>=0&&Wn.splice(Xr,1)}}),this.players.push(Je),ar.push(Je),Je}deregister(S){this._triggers.delete(S),this._engine.statesByElement.forEach(T=>T.delete(S)),this._elementListeners.forEach((T,V)=>{this._elementListeners.set(V,T.filter(ie=>ie.name!=S))})}clearElementCache(S){this._engine.statesByElement.delete(S),this._elementListeners.delete(S);const T=this._engine.playersByElement.get(S);T&&(T.forEach(V=>V.destroy()),this._engine.playersByElement.delete(S))}_signalRemovalForInnerTriggers(S,T){const V=this._engine.driver.query(S,Ft,!0);V.forEach(ie=>{if(ie[Ur])return;const Oe=this._engine.fetchNamespacesByElement(ie);Oe.size?Oe.forEach(Je=>Je.triggerLeaveAnimation(ie,T,!1,!0)):this.clearElementCache(ie)}),this._engine.afterFlushAnimationsDone(()=>V.forEach(ie=>this.clearElementCache(ie)))}triggerLeaveAnimation(S,T,V,ie){const Oe=this._engine.statesByElement.get(S),Je=new Map;if(Oe){const Ot=[];if(Oe.forEach((hn,On)=>{if(Je.set(On,hn.value),this._triggers.has(On)){const ri=this.trigger(S,On,fs,ie);ri&&Ot.push(ri)}}),Ot.length)return this._engine.markElementAsRemoved(this.id,S,!0,T,Je),V&&Tt(Ot).onDone(()=>this._engine.processLeaveNode(S)),!0}return!1}prepareLeaveAnimationListeners(S){const T=this._elementListeners.get(S),V=this._engine.statesByElement.get(S);if(T&&V){const ie=new Set;T.forEach(Oe=>{const Je=Oe.name;if(ie.has(Je))return;ie.add(Je);const hn=this._triggers.get(Je).fallbackTransition,On=V.get(Je)||na,ri=new ps(fs),ui=new ko(this.id,Je,S);this._engine.totalQueuedPlayers++,this._queue.push({element:S,triggerName:Je,transition:hn,fromState:On,toState:ri,player:ui,isFallbackTransition:!0})})}}removeNode(S,T){const V=this._engine;if(S.childElementCount&&this._signalRemovalForInnerTriggers(S,T),this.triggerLeaveAnimation(S,T,!0))return;let ie=!1;if(V.totalAnimations){const Oe=V.players.length?V.playersByQueriedElement.get(S):[];if(Oe&&Oe.length)ie=!0;else{let Je=S;for(;Je=Je.parentNode;)if(V.statesByElement.get(Je)){ie=!0;break}}}if(this.prepareLeaveAnimationListeners(S),ie)V.markElementAsRemoved(this.id,S,!1,T);else{const Oe=S[Ur];(!Oe||Oe===ea)&&(V.afterFlush(()=>this.clearElementCache(S)),V.destroyInnerAnimations(S),V._onRemovalComplete(S,T))}}insertNode(S,T){Pt(S,this._hostClassName)}drainQueuedTransitions(S){const T=[];return this._queue.forEach(V=>{const ie=V.player;if(ie.destroyed)return;const Oe=V.element,Je=this._elementListeners.get(Oe);Je&&Je.forEach(Ot=>{if(Ot.name==V.triggerName){const hn=Se(Oe,V.triggerName,V.fromState.value,V.toState.value);hn._data=S,me(V.player,Ot.phase,hn,Ot.callback)}}),ie.markedForDestroy?this._engine.afterFlush(()=>{ie.destroy()}):T.push(V)}),this._queue=[],T.sort((V,ie)=>{const Oe=V.transition.ast.depCount,Je=ie.transition.ast.depCount;return 0==Oe||0==Je?Oe-Je:this._engine.driver.containsElement(V.element,ie.element)?1:-1})}destroy(S){this.players.forEach(T=>T.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,S)}elementContainsData(S){let T=!1;return this._elementListeners.has(S)&&(T=!0),T=!!this._queue.find(V=>V.element===S)||T,T}}class ia{_onRemovalComplete(S,T){this.onRemovalComplete(S,T)}constructor(S,T,V){this.bodyNode=S,this.driver=T,this._normalizer=V,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(ie,Oe)=>{}}get queuedPlayers(){const S=[];return this._namespaceList.forEach(T=>{T.players.forEach(V=>{V.queued&&S.push(V)})}),S}createNamespace(S,T){const V=new ga(S,T,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,T)?this._balanceNamespaceList(V,T):(this.newHostElements.set(T,V),this.collectEnterElement(T)),this._namespaceLookup[S]=V}_balanceNamespaceList(S,T){const V=this._namespaceList,ie=this.namespacesByHostElement;if(V.length-1>=0){let Je=!1,Ot=this.driver.getParentElement(T);for(;Ot;){const hn=ie.get(Ot);if(hn){const On=V.indexOf(hn);V.splice(On+1,0,S),Je=!0;break}Ot=this.driver.getParentElement(Ot)}Je||V.unshift(S)}else V.push(S);return ie.set(T,S),S}register(S,T){let V=this._namespaceLookup[S];return V||(V=this.createNamespace(S,T)),V}registerTrigger(S,T,V){let ie=this._namespaceLookup[S];ie&&ie.register(T,V)&&this.totalAnimations++}destroy(S,T){if(!S)return;const V=this._fetchNamespace(S);this.afterFlush(()=>{this.namespacesByHostElement.delete(V.hostElement),delete this._namespaceLookup[S];const ie=this._namespaceList.indexOf(V);ie>=0&&this._namespaceList.splice(ie,1)}),this.afterFlushAnimationsDone(()=>V.destroy(T))}_fetchNamespace(S){return this._namespaceLookup[S]}fetchNamespacesByElement(S){const T=new Set,V=this.statesByElement.get(S);if(V)for(let ie of V.values())if(ie.namespaceId){const Oe=this._fetchNamespace(ie.namespaceId);Oe&&T.add(Oe)}return T}trigger(S,T,V,ie){if(bs(T)){const Oe=this._fetchNamespace(S);if(Oe)return Oe.trigger(T,V,ie),!0}return!1}insertNode(S,T,V,ie){if(!bs(T))return;const Oe=T[Ur];if(Oe&&Oe.setForRemoval){Oe.setForRemoval=!1,Oe.setForMove=!0;const Je=this.collectedLeaveElements.indexOf(T);Je>=0&&this.collectedLeaveElements.splice(Je,1)}if(S){const Je=this._fetchNamespace(S);Je&&Je.insertNode(T,V)}ie&&this.collectEnterElement(T)}collectEnterElement(S){this.collectedEnterElements.push(S)}markElementAsDisabled(S,T){T?this.disabledNodes.has(S)||(this.disabledNodes.add(S),Pt(S,yo)):this.disabledNodes.has(S)&&(this.disabledNodes.delete(S),bt(S,yo))}removeNode(S,T,V,ie){if(bs(T)){const Oe=S?this._fetchNamespace(S):null;if(Oe?Oe.removeNode(T,ie):this.markElementAsRemoved(S,T,!1,ie),V){const Je=this.namespacesByHostElement.get(T);Je&&Je.id!==S&&Je.removeNode(T,ie)}}else this._onRemovalComplete(T,ie)}markElementAsRemoved(S,T,V,ie,Oe){this.collectedLeaveElements.push(T),T[Ur]={namespaceId:S,setForRemoval:ie,hasAnimation:V,removedBeforeQueried:!1,previousTriggersValues:Oe}}listen(S,T,V,ie,Oe){return bs(T)?this._fetchNamespace(S).listen(T,V,ie,Oe):()=>{}}_buildInstruction(S,T,V,ie,Oe){return S.transition.build(this.driver,S.element,S.fromState.value,S.toState.value,V,ie,S.fromState.options,S.toState.options,T,Oe)}destroyInnerAnimations(S){let T=this.driver.query(S,Ft,!0);T.forEach(V=>this.destroyActiveAnimationsForElement(V)),0!=this.playersByQueriedElement.size&&(T=this.driver.query(S,bn,!0),T.forEach(V=>this.finishActiveQueriedAnimationOnElement(V)))}destroyActiveAnimationsForElement(S){const T=this.playersByElement.get(S);T&&T.forEach(V=>{V.queued?V.markedForDestroy=!0:V.destroy()})}finishActiveQueriedAnimationOnElement(S){const T=this.playersByQueriedElement.get(S);T&&T.forEach(V=>V.finish())}whenRenderingDone(){return new Promise(S=>{if(this.players.length)return Tt(this.players).onDone(()=>S());S()})}processLeaveNode(S){const T=S[Ur];if(T&&T.setForRemoval){if(S[Ur]=ea,T.namespaceId){this.destroyInnerAnimations(S);const V=this._fetchNamespace(T.namespaceId);V&&V.clearElementCache(S)}this._onRemovalComplete(S,T.setForRemoval)}S.classList?.contains(yo)&&this.markElementAsDisabled(S,!1),this.driver.query(S,".ng-animate-disabled",!0).forEach(V=>{this.markElementAsDisabled(V,!1)})}flush(S=-1){let T=[];if(this.newHostElements.size&&(this.newHostElements.forEach((V,ie)=>this._balanceNamespaceList(V,ie)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let V=0;V<this.collectedEnterElements.length;V++)Pt(this.collectedEnterElements[V],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const V=[];try{T=this._flushAnimations(V,S)}finally{for(let ie=0;ie<V.length;ie++)V[ie]()}}else for(let V=0;V<this.collectedLeaveElements.length;V++)this.processLeaveNode(this.collectedLeaveElements[V]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(V=>V()),this._flushFns=[],this._whenQuietFns.length){const V=this._whenQuietFns;this._whenQuietFns=[],T.length?Tt(T).onDone(()=>{V.forEach(ie=>ie())}):V.forEach(ie=>ie())}}reportError(S){throw function Ct(K){return new y.vHH(3402,!1)}()}_flushAnimations(S,T){const V=new ts,ie=[],Oe=new Map,Je=[],Ot=new Map,hn=new Map,On=new Map,ri=new Set;this.disabledNodes.forEach(Si=>{ri.add(Si);const Di=this.driver.query(Si,".ng-animate-queued",!0);for(let Ni=0;Ni<Di.length;Ni++)ri.add(Di[Ni])});const ui=this.bodyNode,ar=Array.from(this.statesByElement.keys()),nr=xs(ar,this.collectedEnterElements),Ti=new Map;let Zi=0;nr.forEach((Si,Di)=>{const Ni=Ii+Zi++;Ti.set(Di,Ni),Si.forEach(Mr=>Pt(Mr,Ni))});const Wn=[],Xr=new Set,or=new Set;for(let Si=0;Si<this.collectedLeaveElements.length;Si++){const Di=this.collectedLeaveElements[Si],Ni=Di[Ur];Ni&&Ni.setForRemoval&&(Wn.push(Di),Xr.add(Di),Ni.hasAnimation?this.driver.query(Di,".ng-star-inserted",!0).forEach(Mr=>Xr.add(Mr)):or.add(Di))}const To=new Map,Bo=xs(ar,Array.from(Xr));Bo.forEach((Si,Di)=>{const Ni=Ir+Zi++;To.set(Di,Ni),Si.forEach(Mr=>Pt(Mr,Ni))}),S.push(()=>{nr.forEach((Si,Di)=>{const Ni=Ti.get(Di);Si.forEach(Mr=>bt(Mr,Ni))}),Bo.forEach((Si,Di)=>{const Ni=To.get(Di);Si.forEach(Mr=>bt(Mr,Ni))}),Wn.forEach(Si=>{this.processLeaveNode(Si)})});const Cl=[],Ra=[];for(let Si=this._namespaceList.length-1;Si>=0;Si--)this._namespaceList[Si].drainQueuedTransitions(T).forEach(Ni=>{const Mr=Ni.player,So=Ni.element;if(Cl.push(Mr),this.collectedEnterElements.length){const t=So[Ur];if(t&&t.setForMove){if(t.previousTriggersValues&&t.previousTriggersValues.has(Ni.triggerName)){const l=t.previousTriggersValues.get(Ni.triggerName),p=this.statesByElement.get(Ni.element);if(p&&p.has(Ni.triggerName)){const _=p.get(Ni.triggerName);_.value=l,p.set(Ni.triggerName,_)}}return void Mr.destroy()}}const P=!ui||!this.driver.containsElement(ui,So),k=To.get(So),D=Ti.get(So),z=this._buildInstruction(Ni,V,D,k,P);if(z.errors&&z.errors.length)return void Ra.push(z);if(P)return Mr.onStart(()=>xe(So,z.fromStyles)),Mr.onDestroy(()=>Ye(So,z.toStyles)),void ie.push(Mr);if(Ni.isFallbackTransition)return Mr.onStart(()=>xe(So,z.fromStyles)),Mr.onDestroy(()=>Ye(So,z.toStyles)),void ie.push(Mr);const ee=[];z.timelines.forEach(t=>{t.stretchStartingKeyframe=!0,this.disabledNodes.has(t.element)||ee.push(t)}),z.timelines=ee,V.append(So,z.timelines),Je.push({instruction:z,player:Mr,element:So}),z.queriedElements.forEach(t=>vt(Ot,t,[]).push(Mr)),z.preStyleProps.forEach((t,l)=>{if(t.size){let p=hn.get(l);p||hn.set(l,p=new Set),t.forEach((_,b)=>p.add(b))}}),z.postStyleProps.forEach((t,l)=>{let p=On.get(l);p||On.set(l,p=new Set),t.forEach((_,b)=>p.add(b))})});if(Ra.length){const Si=[];Ra.forEach(Di=>{Si.push(function ze(K,S){return new y.vHH(3505,!1)}())}),Cl.forEach(Di=>Di.destroy()),this.reportError(Si)}const Po=new Map,ka=new Map;Je.forEach(Si=>{const Di=Si.element;V.has(Di)&&(ka.set(Di,Di),this._beforeAnimationBuild(Si.player.namespaceId,Si.instruction,Po))}),ie.forEach(Si=>{const Di=Si.element;this._getPreviousPlayers(Di,!1,Si.namespaceId,Si.triggerName,null).forEach(Mr=>{vt(Po,Di,[]).push(Mr),Mr.destroy()})});const la=Wn.filter(Si=>xi(Si,hn,On)),gs=new Map;$s(gs,this.driver,or,On,a.l3).forEach(Si=>{xi(Si,hn,On)&&la.push(Si)});const qa=new Map;nr.forEach((Si,Di)=>{$s(qa,this.driver,new Set(Si),hn,a.k1)}),la.forEach(Si=>{const Di=gs.get(Si),Ni=qa.get(Si);gs.set(Si,new Map([...Array.from(Di?.entries()??[]),...Array.from(Ni?.entries()??[])]))});const Hr=[],Vl=[],Ya={};Je.forEach(Si=>{const{element:Di,player:Ni,instruction:Mr}=Si;if(V.has(Di)){if(ri.has(Di))return Ni.onDestroy(()=>Ye(Di,Mr.toStyles)),Ni.disabled=!0,Ni.overrideTotalTime(Mr.totalTime),void ie.push(Ni);let So=Ya;if(ka.size>1){let k=Di;const D=[];for(;k=k.parentNode;){const z=ka.get(k);if(z){So=z;break}D.push(k)}D.forEach(z=>ka.set(z,So))}const P=this._buildAnimation(Ni.namespaceId,Mr,Po,Oe,qa,gs);if(Ni.setRealPlayer(P),So===Ya)Hr.push(Ni);else{const k=this.playersByElement.get(So);k&&k.length&&(Ni.parentPlayer=Tt(k)),ie.push(Ni)}}else xe(Di,Mr.fromStyles),Ni.onDestroy(()=>Ye(Di,Mr.toStyles)),Vl.push(Ni),ri.has(Di)&&ie.push(Ni)}),Vl.forEach(Si=>{const Di=Oe.get(Si.element);if(Di&&Di.length){const Ni=Tt(Di);Si.setRealPlayer(Ni)}}),ie.forEach(Si=>{Si.parentPlayer?Si.syncPlayerEvents(Si.parentPlayer):Si.destroy()});for(let Si=0;Si<Wn.length;Si++){const Di=Wn[Si],Ni=Di[Ur];if(bt(Di,Ir),Ni&&Ni.hasAnimation)continue;let Mr=[];if(Ot.size){let P=Ot.get(Di);P&&P.length&&Mr.push(...P);let k=this.driver.query(Di,bn,!0);for(let D=0;D<k.length;D++){let z=Ot.get(k[D]);z&&z.length&&Mr.push(...z)}}const So=Mr.filter(P=>!P.destroyed);So.length?ce(this,Di,So):this.processLeaveNode(Di)}return Wn.length=0,Hr.forEach(Si=>{this.players.push(Si),Si.onDone(()=>{Si.destroy();const Di=this.players.indexOf(Si);this.players.splice(Di,1)}),Si.play()}),Hr}elementContainsData(S,T){let V=!1;const ie=T[Ur];return ie&&ie.setForRemoval&&(V=!0),this.playersByElement.has(T)&&(V=!0),this.playersByQueriedElement.has(T)&&(V=!0),this.statesByElement.has(T)&&(V=!0),this._fetchNamespace(S).elementContainsData(T)||V}afterFlush(S){this._flushFns.push(S)}afterFlushAnimationsDone(S){this._whenQuietFns.push(S)}_getPreviousPlayers(S,T,V,ie,Oe){let Je=[];if(T){const Ot=this.playersByQueriedElement.get(S);Ot&&(Je=Ot)}else{const Ot=this.playersByElement.get(S);if(Ot){const hn=!Oe||Oe==fs;Ot.forEach(On=>{On.queued||!hn&&On.triggerName!=ie||Je.push(On)})}}return(V||ie)&&(Je=Je.filter(Ot=>!(V&&V!=Ot.namespaceId||ie&&ie!=Ot.triggerName))),Je}_beforeAnimationBuild(S,T,V){const Oe=T.element,Je=T.isRemovalTransition?void 0:S,Ot=T.isRemovalTransition?void 0:T.triggerName;for(const hn of T.timelines){const On=hn.element,ri=On!==Oe,ui=vt(V,On,[]);this._getPreviousPlayers(On,ri,Je,Ot,T.toState).forEach(nr=>{const Ti=nr.getRealPlayer();Ti.beforeDestroy&&Ti.beforeDestroy(),nr.destroy(),ui.push(nr)})}xe(Oe,T.fromStyles)}_buildAnimation(S,T,V,ie,Oe,Je){const Ot=T.triggerName,hn=T.element,On=[],ri=new Set,ui=new Set,ar=T.timelines.map(Ti=>{const Zi=Ti.element;ri.add(Zi);const Wn=Zi[Ur];if(Wn&&Wn.removedBeforeQueried)return new a.ZN(Ti.duration,Ti.delay);const Xr=Zi!==hn,or=function Ke(K){const S=[];return Nt(K,S),S}((V.get(Zi)||ja).map(Po=>Po.getRealPlayer())).filter(Po=>!!Po.element&&Po.element===Zi),To=Oe.get(Zi),Bo=Je.get(Zi),Cl=fn(0,this._normalizer,0,Ti.keyframes,To,Bo),Ra=this._buildPlayer(Ti,Cl,or);if(Ti.subTimeline&&ie&&ui.add(Zi),Xr){const Po=new ko(S,Ot,Zi);Po.setRealPlayer(Ra),On.push(Po)}return Ra});On.forEach(Ti=>{vt(this.playersByQueriedElement,Ti.element,[]).push(Ti),Ti.onDone(()=>function fr(K,S,T){let V=K.get(S);if(V){if(V.length){const ie=V.indexOf(T);V.splice(ie,1)}0==V.length&&K.delete(S)}return V}(this.playersByQueriedElement,Ti.element,Ti))}),ri.forEach(Ti=>Pt(Ti,_t));const nr=Tt(ar);return nr.onDestroy(()=>{ri.forEach(Ti=>bt(Ti,_t)),Ye(hn,T.toStyles)}),ui.forEach(Ti=>{vt(ie,Ti,[]).push(nr)}),nr}_buildPlayer(S,T,V){return T.length>0?this.driver.animate(S.element,T,S.duration,S.delay,S.easing,V):new a.ZN(S.duration,S.delay)}}class ko{constructor(S,T,V){this.namespaceId=S,this.triggerName=T,this.element=V,this._player=new a.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(S){this._containsRealPlayer||(this._player=S,this._queuedCallbacks.forEach((T,V)=>{T.forEach(ie=>me(S,V,void 0,ie))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(S.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(S){this.totalTime=S}syncPlayerEvents(S){const T=this._player;T.triggerCallback&&S.onStart(()=>T.triggerCallback("start")),S.onDone(()=>this.finish()),S.onDestroy(()=>this.destroy())}_queueEvent(S,T){vt(this._queuedCallbacks,S,[]).push(T)}onDone(S){this.queued&&this._queueEvent("done",S),this._player.onDone(S)}onStart(S){this.queued&&this._queueEvent("start",S),this._player.onStart(S)}onDestroy(S){this.queued&&this._queueEvent("destroy",S),this._player.onDestroy(S)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(S){this.queued||this._player.setPosition(S)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(S){const T=this._player;T.triggerCallback&&T.triggerCallback(S)}}function bs(K){return K&&1===K.nodeType}function co(K,S){const T=K.style.display;return K.style.display=S??"none",T}function $s(K,S,T,V,ie){const Oe=[];T.forEach(hn=>Oe.push(co(hn)));const Je=[];V.forEach((hn,On)=>{const ri=new Map;hn.forEach(ui=>{const ar=S.computeStyle(On,ui,ie);ri.set(ui,ar),(!ar||0==ar.length)&&(On[Ur]=ta,Je.push(On))}),K.set(On,ri)});let Ot=0;return T.forEach(hn=>co(hn,Oe[Ot++])),Je}function xs(K,S){const T=new Map;if(K.forEach(Ot=>T.set(Ot,[])),0==S.length)return T;const V=1,ie=new Set(S),Oe=new Map;function Je(Ot){if(!Ot)return V;let hn=Oe.get(Ot);if(hn)return hn;const On=Ot.parentNode;return hn=T.has(On)?On:ie.has(On)?V:Je(On),Oe.set(Ot,hn),hn}return S.forEach(Ot=>{const hn=Je(Ot);hn!==V&&T.get(hn).push(Ot)}),T}function Pt(K,S){K.classList?.add(S)}function bt(K,S){K.classList?.remove(S)}function ce(K,S,T){Tt(T).onDone(()=>K.processLeaveNode(S))}function Nt(K,S){for(let T=0;T<K.length;T++){const V=K[T];V instanceof a.ZE?Nt(V.players,S):S.push(V)}}function xi(K,S,T){const V=T.get(K);if(!V)return!1;let ie=S.get(K);return ie?V.forEach(Oe=>ie.add(Oe)):S.set(K,V),T.delete(K),!0}class si{constructor(S,T,V){this.bodyNode=S,this._driver=T,this._normalizer=V,this._triggerCache={},this.onRemovalComplete=(ie,Oe)=>{},this._transitionEngine=new ia(S,T,V),this._timelineEngine=new Os(S,T,V),this._transitionEngine.onRemovalComplete=(ie,Oe)=>this.onRemovalComplete(ie,Oe)}registerTrigger(S,T,V,ie,Oe){const Je=S+"-"+ie;let Ot=this._triggerCache[Je];if(!Ot){const hn=[],On=[],ri=bi(this._driver,Oe,hn,On);if(hn.length)throw function nt(K,S){return new y.vHH(3404,!1)}();Ot=function Ca(K,S,T){return new Ma(K,S,T)}(ie,ri,this._normalizer),this._triggerCache[Je]=Ot}this._transitionEngine.registerTrigger(T,ie,Ot)}register(S,T){this._transitionEngine.register(S,T)}destroy(S,T){this._transitionEngine.destroy(S,T)}onInsert(S,T,V,ie){this._transitionEngine.insertNode(S,T,V,ie)}onRemove(S,T,V,ie){this._transitionEngine.removeNode(S,T,ie||!1,V)}disableAnimations(S,T){this._transitionEngine.markElementAsDisabled(S,T)}process(S,T,V,ie){if("@"==V.charAt(0)){const[Oe,Je]=jn(V);this._timelineEngine.command(Oe,T,Je,ie)}else this._transitionEngine.trigger(S,T,V,ie)}listen(S,T,V,ie,Oe){if("@"==V.charAt(0)){const[Je,Ot]=jn(V);return this._timelineEngine.listen(Je,T,Ot,Oe)}return this._transitionEngine.listen(S,T,V,ie,Oe)}flush(S=-1){this._transitionEngine.flush(S)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let Vr=(()=>{class K{constructor(T,V,ie){this._element=T,this._startStyles=V,this._endStyles=ie,this._state=0;let Oe=K.initialStylesByElement.get(T);Oe||K.initialStylesByElement.set(T,Oe=new Map),this._initialStyles=Oe}start(){this._state<1&&(this._startStyles&&Ye(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ye(this._element,this._initialStyles),this._endStyles&&(Ye(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(K.initialStylesByElement.delete(this._element),this._startStyles&&(xe(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(xe(this._element,this._endStyles),this._endStyles=null),Ye(this._element,this._initialStyles),this._state=3)}}return K.initialStylesByElement=new WeakMap,K})();function Ho(K){let S=null;return K.forEach((T,V)=>{(function Mo(K){return"display"===K||"position"===K})(V)&&(S=S||new Map,S.set(V,T))}),S}class Rs{constructor(S,T,V,ie){this.element=S,this.keyframes=T,this.options=V,this._specialStyles=ie,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=V.duration,this._delay=V.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(S=>S()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const S=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,S,this.options),this._finalKeyframe=S.length?S[S.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(S){const T=[];return S.forEach(V=>{T.push(Object.fromEntries(V))}),T}_triggerWebAnimation(S,T,V){return S.animate(this._convertKeyframesToObject(T),V)}onStart(S){this._originalOnStartFns.push(S),this._onStartFns.push(S)}onDone(S){this._originalOnDoneFns.push(S),this._onDoneFns.push(S)}onDestroy(S){this._onDestroyFns.push(S)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(S=>S()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(S=>S()),this._onDestroyFns=[])}setPosition(S){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=S*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const S=new Map;this.hasStarted()&&this._finalKeyframe.forEach((V,ie)=>{"offset"!==ie&&S.set(ie,this._finished?V:hi(this.element,ie))}),this.currentSnapshot=S}triggerCallback(S){const T="start"===S?this._onStartFns:this._onDoneFns;T.forEach(V=>V()),T.length=0}}class _a{validateStyleProperty(S){return!0}validateAnimatableStyleProperty(S){return!0}matchesElement(S,T){return!1}containsElement(S,T){return At(S,T)}getParentElement(S){return ue(S)}query(S,T,V){return Ae(S,T,V)}computeStyle(S,T,V){return window.getComputedStyle(S)[T]}animate(S,T,V,ie,Oe,Je=[]){const hn={duration:V,delay:ie,fill:0==ie?"both":"forwards"};Oe&&(hn.easing=Oe);const On=new Map,ri=Je.filter(nr=>nr instanceof Rs);(function gi(K,S){return 0===K||0===S})(V,ie)&&ri.forEach(nr=>{nr.currentSnapshot.forEach((Ti,Zi)=>On.set(Zi,Ti))});let ui=function pe(K){return K.length?K[0]instanceof Map?K:K.map(S=>$t(S)):[]}(T).map(nr=>ae(nr));ui=function Vi(K,S,T){if(T.size&&S.length){let V=S[0],ie=[];if(T.forEach((Oe,Je)=>{V.has(Je)||ie.push(Je),V.set(Je,Oe)}),ie.length)for(let Oe=1;Oe<S.length;Oe++){let Je=S[Oe];ie.forEach(Ot=>Je.set(Ot,hi(K,Ot)))}}return S}(S,ui,On);const ar=function pi(K,S){let T=null,V=null;return Array.isArray(S)&&S.length?(T=Ho(S[0]),S.length>1&&(V=Ho(S[S.length-1]))):S instanceof Map&&(T=Ho(S)),T||V?new Vr(K,T,V):null}(S,ui);return new Rs(S,ui,hn,ar)}}var Ai=L(6895);let Zs=(()=>{class K extends a._j{constructor(T,V){super(),this._nextAnimationId=0,this._renderer=T.createRenderer(V.body,{id:"0",encapsulation:y.ifc.None,styles:[],data:{animation:[]}})}build(T){const V=this._nextAnimationId.toString();this._nextAnimationId++;const ie=Array.isArray(T)?(0,a.vP)(T):T;return G(this._renderer,null,V,"register",[ie]),new J(V,this._renderer)}}return K.\u0275fac=function(T){return new(T||K)(y.LFG(y.FYo),y.LFG(Ai.K0))},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})();class J extends a.LC{constructor(S,T){super(),this._id=S,this._renderer=T}create(S,T){return new Y(this._id,S,T||{},this._renderer)}}class Y{constructor(S,T,V,ie){this.id=S,this.element=T,this._renderer=ie,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",V)}_listen(S,T){return this._renderer.listen(this.element,`@@${this.id}:${S}`,T)}_command(S,...T){return G(this._renderer,this.element,this.id,S,T)}onDone(S){this._listen("done",S)}onStart(S){this._listen("start",S)}onDestroy(S){this._listen("destroy",S)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(S){this._command("setPosition",S)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function G(K,S,T,V,ie){return K.setProperty(S,`@@${T}:${V}`,ie)}const wn="@.disabled";let Mi=(()=>{class K{constructor(T,V,ie){this.delegate=T,this.engine=V,this._zone=ie,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),V.onRemovalComplete=(Oe,Je)=>{const Ot=Je?.parentNode(Oe);Ot&&Je.removeChild(Ot,Oe)}}createRenderer(T,V){const Oe=this.delegate.createRenderer(T,V);if(!(T&&V&&V.data&&V.data.animation)){let ri=this._rendererCache.get(Oe);return ri||(ri=new uo("",Oe,this.engine,()=>this._rendererCache.delete(Oe)),this._rendererCache.set(Oe,ri)),ri}const Je=V.id,Ot=V.id+"-"+this._currentId;this._currentId++,this.engine.register(Ot,T);const hn=ri=>{Array.isArray(ri)?ri.forEach(hn):this.engine.registerTrigger(Je,Ot,T,ri.name,ri)};return V.data.animation.forEach(hn),new Tn(this,Ot,Oe,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(T,V,ie){T>=0&&T<this._microtaskId?this._zone.run(()=>V(ie)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(Oe=>{const[Je,Ot]=Oe;Je(Ot)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([V,ie]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return K.\u0275fac=function(T){return new(T||K)(y.LFG(y.FYo),y.LFG(si),y.LFG(y.R0b))},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})();class uo{constructor(S,T,V,ie){this.namespaceId=S,this.delegate=T,this.engine=V,this._onDestroy=ie,this.destroyNode=this.delegate.destroyNode?Oe=>T.destroyNode(Oe):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(S,T){return this.delegate.createElement(S,T)}createComment(S){return this.delegate.createComment(S)}createText(S){return this.delegate.createText(S)}appendChild(S,T){this.delegate.appendChild(S,T),this.engine.onInsert(this.namespaceId,T,S,!1)}insertBefore(S,T,V,ie=!0){this.delegate.insertBefore(S,T,V),this.engine.onInsert(this.namespaceId,T,S,ie)}removeChild(S,T,V){this.engine.onRemove(this.namespaceId,T,this.delegate,V)}selectRootElement(S,T){return this.delegate.selectRootElement(S,T)}parentNode(S){return this.delegate.parentNode(S)}nextSibling(S){return this.delegate.nextSibling(S)}setAttribute(S,T,V,ie){this.delegate.setAttribute(S,T,V,ie)}removeAttribute(S,T,V){this.delegate.removeAttribute(S,T,V)}addClass(S,T){this.delegate.addClass(S,T)}removeClass(S,T){this.delegate.removeClass(S,T)}setStyle(S,T,V,ie){this.delegate.setStyle(S,T,V,ie)}removeStyle(S,T,V){this.delegate.removeStyle(S,T,V)}setProperty(S,T,V){"@"==T.charAt(0)&&T==wn?this.disableAnimations(S,!!V):this.delegate.setProperty(S,T,V)}setValue(S,T){this.delegate.setValue(S,T)}listen(S,T,V){return this.delegate.listen(S,T,V)}disableAnimations(S,T){this.engine.disableAnimations(S,T)}}class Tn extends uo{constructor(S,T,V,ie,Oe){super(T,V,ie,Oe),this.factory=S,this.namespaceId=T}setProperty(S,T,V){"@"==T.charAt(0)?"."==T.charAt(1)&&T==wn?this.disableAnimations(S,V=void 0===V||!!V):this.engine.process(this.namespaceId,S,T.slice(1),V):this.delegate.setProperty(S,T,V)}listen(S,T,V){if("@"==T.charAt(0)){const ie=function sr(K){switch(K){case"body":return document.body;case"document":return document;case"window":return window;default:return K}}(S);let Oe=T.slice(1),Je="";return"@"!=Oe.charAt(0)&&([Oe,Je]=function ws(K){const S=K.indexOf(".");return[K.substring(0,S),K.slice(S+1)]}(Oe)),this.engine.listen(this.namespaceId,ie,Oe,Je,Ot=>{this.factory.scheduleListenerCallback(Ot._data||-1,V,Ot)})}return this.delegate.listen(S,T,V)}}const os=[{provide:a._j,useClass:Zs},{provide:lo,useFactory:function ro(){return new is}},{provide:si,useClass:(()=>{class K extends si{constructor(T,V,ie,Oe){super(T.body,V,ie)}ngOnDestroy(){this.flush()}}return K.\u0275fac=function(T){return new(T||K)(y.LFG(Ai.K0),y.LFG(ln),y.LFG(lo),y.LFG(y.z2F))},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})()},{provide:y.FYo,useFactory:function Fl(K,S,T){return new Mi(K,S,T)},deps:[w.se,si,y.R0b]}],qo=[{provide:ln,useFactory:()=>new _a},{provide:y.QbO,useValue:"BrowserAnimations"},...os],il=[{provide:ln,useClass:Dn},{provide:y.QbO,useValue:"NoopAnimations"},...os];let rl=(()=>{class K{static withConfig(T){return{ngModule:K,providers:T.disableAnimations?il:qo}}}return K.\u0275fac=function(T){return new(T||K)},K.\u0275mod=y.oAB({type:K}),K.\u0275inj=y.cJS({providers:qo,imports:[w.b2]}),K})();var Nr=L(8996),ss=L(1572);let ks=(()=>{class K{constructor(T,V){this.usuarioService=T,this.router=V}ngOnInit(){}logout(){this.usuarioService.logout(),this.router.navigateByUrl("/auth/login")}static#e=this.\u0275fac=function(V){return new(V||K)(y.Y36(ss.i),y.Y36(Nr.F0))};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-navbar"]],decls:39,vars:0,consts:[[1,"bgsec"],[1,"container-fluid"],[1,"text-center"],["title","Huejutla","target","_blank","href","https://huejutla.gob.mx/"],["src","../../../../assets/huejutla.png","alt","Huejutla"],["id","headerNav",1,"navbar","navbar-expand-lg","navbar-dark","p-3","bg"],["href","#",1,"navbar-brand","d-block","d-lg-none"],["src","../../../../assets/lgn.png","height","80"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown","aria-controls","navbarNavDropdown","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNavDropdown",1,"collapse","navbar-collapse"],[1,"navbar-nav","mx-auto"],[1,"nav-item"],["aria-current","page","routerLink","/inicio","routerLinkActive","active",1,"nav-link","mx-2"],["routerLink","/ligas/listadoLigas","routerLinkActive","active",1,"nav-link","mx-2"],[1,"nav-item","d-none","d-lg-block"],["href","/inicio",1,"nav-link","mx-2"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdownMenuLink1","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","mx-2","dropdown-toggle"],["aria-labelledby","navbarDropdownMenuLink1",1,"dropdown-menu","bgnav"],["routerLink","../aviso_privacidad","routerLinkActive","selec",1,"dropdown-item"],["href","#","id","navbarDropdownMenuLink","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","mx-2","dropdown-toggle"],["aria-labelledby","navbarDropdownMenuLink",1,"dropdown-menu","bgnav"],["routerLink","/auth/login","routerLinkActive","selec",1,"dropdown-item"],["routerLink","/auth/registro","routerLinkActive","selec",1,"dropdown-item"]],template:function(V,ie){1&V&&(y.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),y._UZ(4,"img",4),y.qZA()()()(),y.TgZ(5,"nav",5)(6,"div",1)(7,"a",6),y._UZ(8,"img",7),y.qZA(),y.TgZ(9,"button",8),y._UZ(10,"span",9),y.qZA(),y.TgZ(11,"div",10)(12,"ul",11)(13,"li",12)(14,"a",13),y._uU(15,"Inicio"),y.qZA()(),y.TgZ(16,"li",12)(17,"a",14),y._uU(18,"Ligas"),y.qZA()(),y.TgZ(19,"li",15)(20,"a",16),y._UZ(21,"img",7),y.qZA()(),y.TgZ(22,"li",17)(23,"a",18),y._uU(24," Acerca de "),y.qZA(),y.TgZ(25,"ul",19)(26,"li")(27,"a",20),y._uU(28,"Aviso de privacidad"),y.qZA()()()(),y.TgZ(29,"li",17)(30,"a",21),y._uU(31," Usuario "),y.qZA(),y.TgZ(32,"ul",22)(33,"li")(34,"a",23),y._uU(35,"Inicio de sesion"),y.qZA()(),y.TgZ(36,"li")(37,"a",24),y._uU(38,"Registro"),y.qZA()()()()()()()())},dependencies:[Nr.rH,Nr.Od],styles:["*[_ngcontent-%COMP%]{font-size:14pt}@media screen and (min-width:992px){.nav-item[_ngcontent-%COMP%]{line-height:80px}}.nav-link[_ngcontent-%COMP%]:hover{color:#0ff}"]})}return K})(),Ta=(()=>{class K{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-avisopriv"]],decls:327,vars:0,consts:[[1,"migas"],["routerLink","/inicio"],[1,"fa","fa-angle-right"],["routerLink","/aviso_privacidad"],[1,"container"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","normal","text-align","center"],[2,"font-size","20px","font-family",'"Actor",serif'],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","normal","text-align","justify"],[2,"font-family",'"Actor",serif',"color","#515151","background","white"],[2,"font-family",'"Actor",serif',"color","black","background","white"],[2,"font-family",'"Actor",serif',"color","#515151"],[2,"background","white"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","0cm","line-height","normal","text-align","justify"],[2,"list-style-type","undefined"],[2,"margin-top","0cm","margin-right","0cm","margin-bottom","8.0pt","margin-left","0cm","line-height","107%","font-size","15px","font-family",'"Calibri",sans-serif'],[2,"margin-bottom","0cm","list-style-type","undefined"],[2,"font-family",'"Actor",serif'],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","107%","text-align","justify","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#4472C4"],[2,"font-size","15px","font-family",'"Actor",serif',"color","black","background","white"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","6.75pt","line-height","107%","text-align","justify"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#525252"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#515151","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#4472C4","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#515151"],[2,"list-style-type","disc","margin-left","26px"],[2,"font-family",'"Actor",serif',"font-size","11.0pt","color","#515151"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","6.75pt","line-height","normal","text-align","justify","background","white"],[2,"font-family",'"Actor",serif',"color","#525252"],[2,"color","blue","text-decoration","underline"],[2,"font-family",'"Actor",serif',"color","black","text-decoration","none"],[2,"font-family",'"Actor",serif',"color","black"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","107%","margin","0cm","text-align","justify","background","white"],[2,"font-family",'"Actor",serif',"font-size","11.0pt","color","#525252"],[2,"margin-right","0cm","margin-left","36.0pt","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","5.0pt","line-height","107%","text-align","justify","vertical-align","baseline"]],template:function(V,ie){1&V&&(y._UZ(0,"app-navbar")(1,"br")(2,"br"),y.TgZ(3,"div",0)(4,"span")(5,"a",1),y._uU(6,"Inicio "),y.qZA(),y._UZ(7,"i",2),y.TgZ(8,"a",3),y._uU(9," Aviso de Privacidad "),y.qZA()()(),y.TgZ(10,"div",4)(11,"p",5)(12,"span",6),y._uU(13,"Aviso de privacidad:"),y.qZA()(),y.TgZ(14,"p",7)(15,"span",8),y._uU(16,"En El Sistema para el \xe1rea de futbol de la COMUDE, la informaci\xf3n y datos personales de los beneficiarios, colaboradores, asociados, empleados y proveedores, es tratada de forma estrictamente confidencial y con la secrec\xeda necesaria para lograr los fines de la organizaci\xf3n, por lo que hacemos un esfuerzo permanente para salvaguardarla, de conformidad con los art\xedculos 8, 15, 16 y 36 de la Ley Federal de Protecci\xf3n de Datos Personales en Posesi\xf3n de los Particulares."),y.qZA()(),y.TgZ(17,"p",7)(18,"strong")(19,"span",9),y._uU(20,"1._Responsable de Protecci\xf3n de Datos"),y.qZA()()(),y.TgZ(21,"p",7)(22,"span",8),y._uU(23,"En El Sistema para el \xe1rea de futbol de la COMUDE, es una aplicaci\xf3n civil sin fines de lucro, con el fin de optimizar el rendimiento de los encargados de las ligas de futbol de la mejorando sus recursos t\xe9cnicos a la hora de levantar las ligas y su conducta t\xe1ctica. en funci\xf3n del planteamiento t\xe1ctico del juego del equipo, el rol del jugador, las caracter\xedsticas de la competici\xf3n y las condiciones medioambientales, con el objetivo de estructurar adecuadamente los partidos."),y.qZA()(),y.TgZ(24,"p",7)(25,"span",10),y._UZ(26,"br"),y.TgZ(27,"span",11),y._uU(28,"En concordancia con el derecho a la protecci\xf3n de datos personales en posesi\xf3n de particulares consagrado en el art\xedculo 6\xb0 de la Constituci\xf3n Pol\xedtica de los Estados Unidos Mexicanos, as\xed como en cumplimiento a las disposiciones de la Ley Federal de Protecci\xf3n de Datos Personales en Posesi\xf3n de los Particulares, y en base a los principios de licitud, consentimiento, informaci\xf3n, calidad, finalidad, lealtad, proporcionalidad y responsabilidad; El Sistema para el \xe1rea de futbol de la COMUDE, con domicilio en Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo. Es responsable de recabar y proteger los datos personales, as\xed como del uso que se le d\xe9 a los mismos."),y._UZ(29,"br"),y._uU(30,"\xa0"),y.qZA(),y._UZ(31,"br"),y.TgZ(32,"span",11),y._uU(33,"Si el titular de los datos personales no acepta en forma absoluta y completa los t\xe9rminos y condiciones de este aviso, deber\xe1 abstenerse de compartir cualquier tipo de informaci\xf3n por cualquier medio f\xedsico, \xf3ptico y/o electr\xf3nico."),y.qZA()()(),y.TgZ(34,"p",12)(35,"strong")(36,"span",9),y._uU(37,"2._ Datos personales recabados"),y.qZA()()(),y.TgZ(38,"ol",13)(39,"li")(40,"span",10),y._uU(41,"Nombre"),y.qZA()(),y.TgZ(42,"li")(43,"span",10),y._uU(44,"Edad"),y.qZA()(),y.TgZ(45,"li")(46,"span",10),y._uU(47,"Correo electr\xf3nico\xa0"),y.qZA()(),y.TgZ(48,"li")(49,"span",10),y._uU(50,"N\xfamero de tel\xe9fono\xa0"),y.qZA()()(),y.TgZ(51,"p",12)(52,"span",10),y._uU(53,"\xa0"),y.qZA()(),y.TgZ(54,"p",12)(55,"span",10),y._uU(56,"El\xa0"),y.qZA(),y.TgZ(57,"span",8),y._uU(58,"Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(59,"span",10),y._uU(60,", recaba los siguientes datos personales sensibles, ya que forman parte del registro de los jugadores:\xa0"),y.qZA()(),y.TgZ(61,"p",12)(62,"span",10),y._uU(63,"\xa0"),y.qZA()(),y.TgZ(64,"div",14)(65,"ol",15)(66,"li",14)(67,"span",10),y._uU(68,"CURP."),y.qZA()()()(),y.TgZ(69,"p",12)(70,"span",10),y._uU(71,"\xa0"),y.qZA()(),y.TgZ(72,"p",12)(73,"strong")(74,"span",16),y._uU(75,"3._Finalidades:"),y.qZA()()(),y.TgZ(76,"p",7)(77,"span",10),y._uU(78,"Tratamos los datos personales que nos facilitan los interesados con la finalidad de mantener, desarrollar y controlar nuestra relaci\xf3n comercial para el uso de nuestra plataforma web de gesti\xf3n de competiciones y entidades deportivas, lo que incluye la atenci\xf3n a sus consultas o solicitudes de informaci\xf3n o documentaci\xf3n. Dentro de este tratamiento de datos puede incluirse datos relativos a la navegaci\xf3n en nuestra web cuando Ud. act\xfaa como usuario registrado, el uso de esta informaci\xf3n es necesario para poder darle un servicio de soporte adecuado, as\xed como para gestionar posibles incidencias en nuestra p\xe1gina web. Para ello obtenemos y conservamos datos relativos a las partes de la plataforma por la que Ud. navega, el tiempo de conexi\xf3n a la mismas, aquellos lugares donde puedan surgir errores o pueda requerir nuestro soporte. En ning\xfan caso, los datos de navegaci\xf3n se utilizan para generar perfiles, segmentaciones, estudios de mercado, ni para el env\xedo de comunicaciones comerciales ya sean propias o de terceros."),y.qZA()(),y.TgZ(79,"p",7)(80,"span",10),y._uU(81,"Igualmente, los datos facilitados tambi\xe9n ser\xe1n tratados para remitirle informaci\xf3n comercial sobre nuestros bienes y servicios, por correo electr\xf3nico, as\xed como para realizar segmentaciones y/o elaboraci\xf3n de perfiles con id\xe9ntica finalidad, distintos de mercadotecnia interna."),y.qZA()(),y.TgZ(82,"p",7)(83,"span",10),y._uU(84,"\xa0"),y.qZA()(),y.TgZ(85,"p",7)(86,"span",10),y._uU(87,"Igualmente, podemos tratar sus datos como persona de contacto dentro de una organizaci\xf3n o entidad que organiza/gestiona una competici\xf3n deportiva. Esta informaci\xf3n sobre su persona, \xfanicamente la utilizaremos para poder relacionarnos con Ud. como consecuencia de la relaci\xf3n jur\xeddica que nos une con la organizaci\xf3n o entidad cliente de la plataforma. No utilizaremos su informaci\xf3n para ning\xfan tipo de finalidad diferente."),y.qZA()(),y.TgZ(88,"p",7)(89,"span",10),y._uU(90,"\xa0"),y.qZA()(),y.TgZ(91,"p",7)(92,"span",10),y._uU(93,"Si Ud. Lo desea puede subir una imagen en su fotograf\xeda de perfil. Este tratamiento de datos es voluntario y \xfanicamente servir\xe1 para identificarle como usuario en la plataforma."),y.qZA()(),y.TgZ(94,"p",17)(95,"strong")(96,"span",18),y._uU(97,"\xa0"),y.qZA()()(),y.TgZ(98,"p",17)(99,"strong")(100,"span",19),y._uU(101,"4.-Datos personales:"),y.qZA()()(),y.TgZ(102,"p",20)(103,"span",21),y._uU(104,"La base legal para el tratamiento de sus datos es la ejecuci\xf3n de la relaci\xf3n comercial en la que Usted es parte, de manera que podamos gestionar, desarrollar y controlar la correspondiente relaci\xf3n contractual, incluido el tratamiento de su imagen de perfil."),y.qZA()(),y.TgZ(105,"p",20)(106,"span",21),y._uU(107,"En relaci\xf3n con el env\xedo de comunicaciones comerciales, la base legal es el consentimiento que se le solicita y Usted otorga libremente. En caso de no obtener el consentimiento"),y.qZA(),y.TgZ(108,"span",22),y._uU(109,"\xa0El Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(110,"span",21),y._uU(111,"\xa0se compromete a no realizarle env\xedos de comunicaciones comerciales fuera del \xe1mbito de la relaci\xf3n contractual."),y.qZA()(),y.TgZ(112,"p",20)(113,"span",21),y._uU(114,"Igualmente podremos tratar sus datos como persona de contacto de una organizaci\xf3n o entidad que organiza/gestiona competiciones deportivas con base al inter\xe9s leg\xedtimo de\xa0"),y.qZA(),y.TgZ(115,"span",22),y._uU(116,"El Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(117,"span",21),y._uU(118,"."),y.qZA()(),y.TgZ(119,"p",20)(120,"strong")(121,"span",23),y._UZ(122,"br"),y._uU(123,"\xa0"),y.qZA()(),y.TgZ(124,"span",22),y._uU(125,"El Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(126,"span",24),y._uU(127,"\xa0no suministrar\xe1 ning\xfan dato a terceros, excepto cuando exista obligaci\xf3n legal de hacerlo:"),y.qZA()(),y.TgZ(128,"ul",25)(129,"li")(130,"span",26),y._uU(131,"A Jueces y Tribunales, en cumplimiento de requerimientos, obligaciones legales o en el marco de un procedimiento judicial;"),y.qZA()(),y.TgZ(132,"li")(133,"span",26),y._uU(134,"A la Agencia Tributaria, para el cumplimiento de las obligaciones fiscales;"),y.qZA()(),y.TgZ(135,"li")(136,"span",26),y._uU(137,"A Auditores Financieros para el cumplimiento de las obligaciones financieras;"),y.qZA()()(),y.TgZ(138,"p",17)(139,"span",24),y._uU(140,"y a cualesquiera otros terceros a quienes, en virtud de la normativa vigente aplicable en cada caso, sea necesario llevar a cabo la cesi\xf3n, tal como \xf3rganos de la Administraci\xf3n competentes por motivos de control, registro e inspecci\xf3n."),y.qZA()(),y.TgZ(141,"p",17)(142,"span",24),y._uU(143,"No obstante, si en alg\xfan momento de la relaci\xf3n comercial fuera necesario comunicar sus datos a terceros, dicha comunicaci\xf3n se realizar\xe1 cuando\xa0"),y.qZA(),y.TgZ(144,"span",8),y._uU(145,"E"),y.qZA(),y.TgZ(146,"span",22),y._uU(147,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(148,"span",24),y._uU(149,"\xa0cuente con su consentimiento previo para ello y en la forma legalmente exigida."),y.qZA(),y.TgZ(150,"strong")(151,"span",23),y._UZ(152,"br"),y._uU(153,"\xa0"),y.qZA()(),y.TgZ(154,"span",21),y._UZ(155,"br"),y._uU(156,"\xa0"),y.qZA()(),y.TgZ(157,"p",7)(158,"strong")(159,"span",9),y._uU(160,"5._ Medios para ejercer los derechos de acceso, rectificaci\xf3n, cancelaci\xf3n y oposici\xf3n"),y.qZA()()(),y.TgZ(161,"p",27)(162,"span",28),y._uU(163,"Usted tendr\xe1 el derecho, en todo momento, de acceder a sus datos personales, rectificarlos en caso de que \xe9stos sean inexactos o est\xe9n incompletos; instruirnos a cancelarlos cuando considere que son excesivos o innecesarios para las finalidades que justificaron su obtenci\xf3n o haya finalizado la relaci\xf3n contractual; as\xed como a oponerse por causa leg\xedtima al tratamiento de sus datos personales."),y.qZA()(),y.TgZ(164,"p",27)(165,"span",28),y._uU(166,"A efecto de ejercer los derechos de acceso, rectificaci\xf3n, cancelaci\xf3n y oposici\xf3n (los \u201cDerechos"),y.qZA(),y.TgZ(167,"span",29)(168,"span",30),y._uU(169,"\xa0"),y.qZA()(),y.TgZ(170,"span",28),y._uU(171,"ARCO\u201d) antes referidos, se deber\xe1 enviar la solicitud respectiva a nuestra al responsable de Privacidad a la siguiente direcci\xf3n de correo electr\xf3nico:\xa0comude@gmail.com"),y.qZA()(),y.TgZ(172,"p",27)(173,"span",28),y._uU(174,"En este sentido, puede informarse sobre los procedimientos, requisitos y plazos para el ejercicio de sus Derechos ARCO y/o revocaci\xf3n del consentimiento en nuestra p\xe1gina de internet"),y.qZA(),y.TgZ(175,"span",31),y._uU(176,"\xa0"),y.qZA(),y.TgZ(177,"span",28),y._uU(178,"http://ecomude.com"),y.qZA()(),y.TgZ(179,"p",7)(180,"strong")(181,"span",9),y._uU(182,"6._ Procedimiento ARCO y revocaci\xf3n del consentimiento."),y.qZA()()(),y.TgZ(183,"p",17)(184,"span",21),y._uU(185,"Para el ejercicio de sus Derechos ARCO y/o la revocaci\xf3n de su consentimiento para el tratamiento de sus datos personales por\xa0"),y.qZA(),y.TgZ(186,"span",8),y._uU(187,"E"),y.qZA(),y.TgZ(188,"span",22),y._uU(189,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(190,"span",21),y._uU(191,", agradeceremos presente una solicitud (\u201cSolicitud de Ejercicio de Derechos ARCO\u201d), al correo electr\xf3nico comude@gmail.com, acompa\xf1ando la siguiente informaci\xf3n:"),y.qZA()(),y.TgZ(192,"p",7)(193,"span",28),y._uU(194,"1. Nombre y datos de contacto como domicilio completo (calle, n\xfamero interior y/o exterior, colonia, c\xf3digo postal, ciudad y estado) y/o correo electr\xf3nico;"),y._UZ(195,"br"),y._uU(196,"\xa02. Identificaci\xf3n con la que acredite su personalidad (credencial para votar, pasaporte vigente, c\xe9dula profesional o documento migratorio)."),y._UZ(197,"br"),y._uU(198,"\xa03. En caso de no ser el titular quien presente la solicitud, el documento que acredite la existencia de la representaci\xf3n, es decir, instrumento p\xfablico o carta poder firmada ante dos testigos, junto con identificaci\xf3n del titular, del representante y de los testigos (credencial para votar, pasaporte vigente, c\xe9dula profesional o documento migratorio)."),y.qZA(),y.TgZ(199,"span",10),y._UZ(200,"br"),y._uU(201,"\xa0"),y.qZA()(),y.TgZ(202,"p",32)(203,"span",21),y._uU(204,"El Comit\xe9 de privacidad\xa0"),y.qZA(),y.TgZ(205,"span",8),y._uU(206,"E"),y.qZA(),y.TgZ(207,"span",22),y._uU(208,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(209,"span",21),y._uU(210,"\xa0tiene a su disposici\xf3n los formatos que se recomiendan para el ejercicio de Derechos ARCO, por lo que el correspondiente a su petici\xf3n se le proporcionar\xe1 al momento en que Usted lo solicite al Comit\xe9, por cualquier medio. El Comit\xe9 responder\xe1 su Solicitud mediante el correo electr\xf3nico\xa0"),y.qZA(),y.TgZ(211,"span",21),y._uU(212,"comude@gmail.com o personalmente,"),y.qZA(),y.TgZ(213,"span",22),y._uU(214,"\xa0Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo.\xa0"),y.qZA(),y.TgZ(215,"span",21),y._uU(216,"Conforme a la Ley, se cuenta con un t\xe9rmino de 20 (veinte) d\xedas h\xe1biles contados a partir de su solicitud, para informarle si su solicitud es procedente y, en caso de serlo, se cuenta con 15 (quince) d\xedas h\xe1biles para hacer efectivo el Derecho ARCO. Las respuestas podr\xe1n enviarse v\xeda correo electr\xf3nico o entregarse de forma personal. El Comit\xe9 de privacidad del"),y.qZA(),y.TgZ(217,"span",22),y._uU(218,"\xa0Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(219,"span",21),y._uU(220,"\xa0podr\xe1 solicitarle informaci\xf3n o documentaci\xf3n adicional, as\xed como el cotejo de los documentos que sustentan su solicitud, dentro de los cinco (5) d\xedas h\xe1biles siguientes a que la haya recibido y, en caso de que no haya respuesta a dicha petici\xf3n dentro de los 10 (diez) d\xedas h\xe1biles siguientes a que se haya emitido, se tendr\xe1 por no presentada la solicitud."),y._UZ(221,"br"),y._uU(222,"\xa0Para hacer efectivo el Derecho ARCO, el plazo podr\xe1 prorrogarse una sola vez por un periodo igual en caso de ser necesario, lo cual se har\xe1 de su conocimiento."),y._UZ(223,"br"),y._uU(224,"\xa0"),y.qZA(),y.TgZ(225,"span",8),y._uU(226,"E"),y.qZA(),y.TgZ(227,"span",22),y._uU(228,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(229,"span",21),y._uU(230,"\xa0podr\xe1 negar el ejercicio de los Derechos ARCO, en los siguientes supuestos:"),y._UZ(231,"br"),y._uU(232,"\xa0\u2013 Cuando el solicitante no sea el titular de los datos personales, o no pueda acreditar la representaci\xf3n del titular;"),y._UZ(233,"br"),y._uU(234,"\xa0\u2013 Cuando sus datos personales no obren en la base de datos del"),y.qZA(),y.TgZ(235,"span",22),y._uU(236,"\xa0Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(237,"span",21),y._uU(238,";"),y._UZ(239,"br"),y._uU(240,"\xa0\u2013 Cuando se lesionen los derechos de un tercero;"),y._UZ(241,"br"),y._uU(242,"\xa0\u2013 Cuando exista un impedimento legal o la resoluci\xf3n de una autoridad competente, que restrinja sus Derechos ARCO;"),y._UZ(243,"br"),y._uU(244,"\xa0\u2013 En caso de cancelaci\xf3n, cuando los datos personales sean objeto de tratamiento para la prevenci\xf3n o para el diagn\xf3stico m\xe9dico o la gesti\xf3n de servicios de salud; y,"),y._UZ(245,"br"),y._uU(246,"\xa0\u2013 Cuando la rectificaci\xf3n, cancelaci\xf3n u oposici\xf3n haya sido previamente realizada."),y._UZ(247,"br"),y._uU(248,"\xa0La Negativa podr\xe1 ser parcial, en cuyo caso el\xa0"),y.qZA(),y.TgZ(249,"span",22),y._uU(250,"Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(251,"span",21),y._uU(252,"\xa0efectuara\u0301 el acceso, rectificaci\xf3n, cancelaci\xf3n u oposici\xf3n en la parte procedente."),y._UZ(253,"br"),y._uU(254,"\xa0El ejercicio de los \u201cDerechos ARCO\u201d ser\xe1 gratuito, pero en caso de que en un periodo menor a doce meses se presenten dos solicitudes o m\xe1s, el Centro M\xe9dico podr\xe1 realizar cobros por la emisi\xf3n de copias de documentos. En caso de que el Solicitante requiera de la certificaci\xf3n de documentos, deber\xe1 hacer previamente el pago correspondiente conforme a las indicaciones que al efecto se le den a conocer. El solicitante deber\xe1 cubrir los gastos justificados de env\xedo o el costo de reproducci\xf3n en copias u otros formatos."),y.qZA()(),y.TgZ(255,"p",7)(256,"span",28),y._uU(257,"\xa0"),y.qZA()(),y.TgZ(258,"p",7)(259,"strong")(260,"span",9),y._uU(261,"7._ Cookies y Beacons."),y.qZA()()(),y.TgZ(262,"p",17)(263,"span",8),y._uU(264,"E"),y.qZA(),y.TgZ(265,"span",22),y._uU(266,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(267,"span",21),y._uU(268,"\xa0le informa que sus aplicaciones y/o sitio web, utilizan cookies, web beacons y otras tecnolog\xedas a trav\xe9s de las cuales es posible monitorear el comportamiento del Titular como usuario de Internet, con la finalidad de brindar un mejor servicio y/o experiencia al Titular al navegar en las mismas."),y._UZ(269,"br"),y._uU(270,"\xa0Los Datos Personales que se podr\xe1n obtener de Usted, de manera enunciativa m\xe1s no limitativa, son los siguientes:"),y._UZ(271,"br"),y._uU(272,"\xa0"),y.qZA()(),y.TgZ(273,"ul",25)(274,"li")(275,"span",33),y._uU(276,"Datos Generales,"),y.qZA()(),y.TgZ(277,"li")(278,"span",33),y._uU(279,"Datos de Contacto,"),y.qZA()(),y.TgZ(280,"li")(281,"span",33),y._uU(282,"Horario y Tiempo de Navegaci\xf3n,"),y.qZA()(),y.TgZ(283,"li")(284,"span",33),y._uU(285,"Sitios web y Secciones consultadas, y;"),y.qZA()(),y.TgZ(286,"li")(287,"span",33),y._uU(288,"Ubicaci\xf3n."),y.qZA()()(),y.TgZ(289,"p",34)(290,"span",21),y._uU(291,"\xa0"),y.qZA()(),y.TgZ(292,"p",7)(293,"strong")(294,"span",9),y._uU(295,"8._ Cambios al aviso de privacidad para empleados."),y.qZA()()(),y.TgZ(296,"p",32)(297,"span",21),y._uU(298,"El presente Aviso de Privacidad podr\xe1 sufrir modificaciones para cumplir con requerimientos legales o con disposiciones internas de\xa0"),y.qZA(),y.TgZ(299,"span",8),y._uU(300,"E"),y.qZA(),y.TgZ(301,"span",22),y._uU(302,"l Sistema para el \xe1rea de futbol de la COMUDE"),y.qZA(),y.TgZ(303,"span",21),y._uU(304,", por lo que nos comprometemos a poner a su disposici\xf3n en nuestra app."),y.qZA()(),y.TgZ(305,"p",7)(306,"span",28),y._uU(307,"\xa0"),y.qZA()(),y.TgZ(308,"p",7)(309,"strong")(310,"span",9),y._uU(311,"9._ Consentimiento."),y.qZA()()(),y.TgZ(312,"p",32)(313,"span",21),y._uU(314,"En caso de que Usted desee revocar o negar su consentimiento para que sus datos personales sean usados para las finalidades secundarias, le solicitamos nos lo haga saber a trav\xe9s del correo electr\xf3nico\xa0"),y.qZA(),y.TgZ(315,"span",21),y._uU(316,"comude@gmail.com,"),y.qZA(),y.TgZ(317,"span",21),y._uU(318,"\xa0dentro de un plazo de cinco d\xedas h\xe1biles."),y._UZ(319,"br"),y._uU(320,"\xa0"),y.qZA()(),y.TgZ(321,"p",32)(322,"span",21),y._uU(323,"Fecha de actualizaci\xf3n: Octubre, 2022."),y.qZA()()(),y._UZ(324,"br")(325,"br")(326,"br"))},dependencies:[ks,Nr.rH],encapsulation:2})}return K})();var Ls=L(2311),_l=L(6814),Es=L(646);function Cc(K,S){if(1&K&&(y.TgZ(0,"div",7)(1,"div",8),y._UZ(2,"img",9),y.ALo(3,"imagen"),y.qZA()()),2&K){const T=S.$implicit;y.xp6(2),y.Q6J("src",y.xi3(3,2,T.img,"carruseles"),y.LSH)("alt",T.nombre)}}let yl=(()=>{class K{constructor(T){this.carruselService=T,this.carruseles=[]}ngOnInit(){this.carruselService.getCarruseles().subscribe({next:T=>{this.carruseles=T},error(T){console.log(T)}})}static#e=this.\u0275fac=function(V){return new(V||K)(y.Y36(_l.z))};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-carrusel"]],decls:10,vars:1,consts:[["id","carouselExampleControls","data-bs-ride","carousel",1,"carousel","slide"],["class","carousel-inner bgsec",4,"ngFor","ngForOf"],["type","button","data-bs-target","#carouselExampleControls","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleControls","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"],[1,"carousel-inner","bgsec"],[1,"carousel-item","active"],[1,"d-block","w-100",3,"src","alt"]],template:function(V,ie){1&V&&(y.TgZ(0,"div",0),y.YNc(1,Cc,4,5,"div",1),y.TgZ(2,"button",2),y._UZ(3,"span",3),y.TgZ(4,"span",4),y._uU(5,"Previous"),y.qZA()(),y.TgZ(6,"button",5),y._UZ(7,"span",6),y.TgZ(8,"span",4),y._uU(9,"Next"),y.qZA()()()),2&V&&(y.xp6(1),y.Q6J("ngForOf",ie.carruseles))},dependencies:[Ai.sg,Es.$],encapsulation:2})}return K})(),Bl=(()=>{class K{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-galeria"]],decls:26,vars:0,consts:[[1,"con"],[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"intento"],[1,"row"],[1,"col-lg-4","col-md-12","mb-4","mb-lg-0"],["data-ripple-color","light",1,"bg-image","hover-overlay","ripple","shadow-1-strong","rounded"],["src","../../../assets/gale1.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal1"],[1,"mask",2,"background-color","rgba(251, 251, 251, 0.2)"],[1,"col-lg-4","mb-4","mb-lg-0"],["src","../../../assets/gale2.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal2"],["src","../../../assets/gale3.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal3"]],template:function(V,ie){1&V&&(y.TgZ(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),y._uU(4,"Galeria"),y.qZA()()(),y.TgZ(5,"section",2),y._UZ(6,"br"),y.TgZ(7,"section",4)(8,"div",5)(9,"div",6)(10,"div",7),y._UZ(11,"img",8),y.TgZ(12,"a",9),y._UZ(13,"div",10),y.qZA()()(),y.TgZ(14,"div",11)(15,"div",7),y._UZ(16,"img",12),y.TgZ(17,"a",13),y._UZ(18,"div",10),y.qZA()()(),y.TgZ(19,"div",11)(20,"div",7),y._UZ(21,"img",14),y.TgZ(22,"a",15),y._UZ(23,"div",10),y.qZA()()()()()(),y._UZ(24,"br")(25,"br"),y.qZA())},styles:[".tigal[_ngcontent-%COMP%]{text-align:center}.con[_ngcontent-%COMP%]{background-color:#dfd2b0}.row[_ngcontent-%COMP%]{align-items:center}"]})}return K})();var ol=L(7392);let sl=(()=>{class K{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-correo"]],decls:39,vars:0,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"row","px-3"],[1,"col-lg-10","col-xl-9","card","flex-row","mx-auto","px-0"],[1,"card-body"],[1,"card-title"],["action",""],[1,"form-floating","mb-3"],["id","nombre","type","text","name","matricula","placeholder","nombre",1,"form-control"],["for","inputFirstName",1,"flex"],["id","correo","type","email","name","correo","placeholder","Correo",1,"form-control"],["id","asunto","type","text","name","asunto","placeholder","Asunto",1,"form-control"],["name","mensaje","id","mensaje","cols","30","rows","10","placeholder","Mensaje",1,"form-control"],[1,"envcor"],[1,"btn","btn-primary","flex"]],template:function(V,ie){1&V&&(y.TgZ(0,"header",0)(1,"div",1)(2,"h1",2),y._uU(3,"Dejanos una sugerencia"),y.qZA()()(),y.TgZ(4,"div",1)(5,"div",3)(6,"div",4)(7,"div",5),y._UZ(8,"h1",6),y.TgZ(9,"form",7)(10,"div",8),y._UZ(11,"input",9),y.TgZ(12,"label",10)(13,"mat-icon"),y._uU(14,"person"),y.qZA(),y._uU(15,"Nombre"),y.qZA()(),y.TgZ(16,"div",8),y._UZ(17,"input",11),y.TgZ(18,"label",10)(19,"mat-icon"),y._uU(20,"mail"),y.qZA(),y._uU(21,"Correo"),y.qZA()(),y.TgZ(22,"div",8),y._UZ(23,"input",12),y.TgZ(24,"label",10)(25,"mat-icon"),y._uU(26,"inbox"),y.qZA(),y._uU(27,"Asunto"),y.qZA()(),y.TgZ(28,"div",8),y._UZ(29,"textarea",13),y.TgZ(30,"label",10)(31,"mat-icon"),y._uU(32,"chat_bubble"),y.qZA(),y._uU(33,"Mensaje"),y.qZA()(),y.TgZ(34,"div",14)(35,"button",15),y._uU(36," Enviar "),y.TgZ(37,"mat-icon"),y._uU(38,"send"),y.qZA()()()()()()()())},dependencies:[ol.Hw],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%;font-size:18px}.envcor[_ngcontent-%COMP%]{display:flex;justify-content:space-around}mat-icon[_ngcontent-%COMP%]{font-size:20px}.card-title[_ngcontent-%COMP%]{text-align:center}.flex[_ngcontent-%COMP%]{display:flex}"]})}return K})();const ra=function(K){return["/ligas",K]};let oc=(()=>{class K{static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-liga-tarjetas"]],inputs:{liga:"liga"},decls:10,vars:11,consts:[[1,"card-deck","mt-3"],[1,"card","text-center","cartalig",3,"routerLink"],["width","100px",1,"logo-liga",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"]],template:function(V,ie){1&V&&(y.TgZ(0,"div",0)(1,"div",1),y._UZ(2,"img",2),y.ALo(3,"imagen"),y.TgZ(4,"div",3)(5,"h4",4),y._uU(6),y.ALo(7,"titlecase"),y.qZA(),y.TgZ(8,"p",5),y._uU(9),y.qZA()()()()),2&V&&(y.xp6(1),y.Q6J("routerLink",y.VKq(9,ra,ie.liga._id)),y.xp6(1),y.Q6J("src",y.xi3(3,4,ie.liga.img,"ligas"),y.LSH),y.xp6(4),y.Oqu(y.lcZ(7,7,ie.liga.nombre)),y.xp6(3),y.Oqu(ie.liga.descripcion))},dependencies:[Nr.rH,Ai.rS,Es.$],encapsulation:2})}return K})();function al(K,S){if(1&K&&(y.TgZ(0,"div",5)(1,"div",6),y._UZ(2,"img",7),y.TgZ(3,"div",8)(4,"h3",9),y._uU(5),y.qZA(),y.TgZ(6,"div",10),y._uU(7),y.qZA(),y.TgZ(8,"div",10),y._uU(9),y.qZA()()()()),2&K){const T=S.$implicit;y.xp6(2),y.s9C("src",T.image,y.LSH),y.xp6(3),y.Oqu(T.nombre),y.xp6(2),y.Oqu(T.roll),y.xp6(2),y.Oqu(T.roll2)}}let Sa=(()=>{class K{constructor(){this.equipo=[{nombre:"Fernando Vega",roll:"Dise\xf1ador",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/fer.jpg"},{nombre:"Denisse San Juan",roll:"Documentadora",roll2:"Analista de datos",image:"../../../assets/fotos EQUIPO/dennise.jpg"},{nombre:"Gustavo Trejo",roll:"Tester",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/trejo.jpg"},{nombre:"Jorge Flores ",roll:"Analista",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/jorge.jpg"}]}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-team"]],decls:7,vars:1,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"row"],["class","col-xl-3 col-md-6 mb-4",4,"ngFor","ngForOf"],[1,"col-xl-3","col-md-6","mb-4"],[1,"card","border-0","shadow"],["alt","...",1,"card-img-top",3,"src"],[1,"card-body","text-center"],[1,"card-title","mb-0"],[1,"card-text","text-black-50"]],template:function(V,ie){1&V&&(y.TgZ(0,"header",0)(1,"div",1)(2,"h1",2),y._uU(3,"Equipo de desarrollo"),y.qZA()()(),y.TgZ(4,"div",1)(5,"div",3),y.YNc(6,al,10,4,"div",4),y.qZA()()),2&V&&(y.xp6(6),y.Q6J("ngForOf",ie.equipo))},dependencies:[Ai.sg],encapsulation:2})}return K})();function sc(K,S){if(1&K&&(y.TgZ(0,"div"),y._UZ(1,"app-liga-tarjetas",5),y.qZA()),2&K){const T=S.$implicit;y.xp6(1),y.Q6J("liga",T)}}let ll=(()=>{class K{constructor(T,V){this.ligasService=T,this.usuarioService=V,this.ligas=[]}ngOnInit(){this.ligasService.smallgetLigas().subscribe(T=>this.ligas=T)}static#e=this.\u0275fac=function(V){return new(V||K)(y.Y36(Ls.O),y.Y36(ss.i))};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-inicio"]],decls:17,vars:1,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"grid"],[4,"ngFor","ngForOf"],[3,"liga"]],template:function(V,ie){1&V&&(y._UZ(0,"app-navbar")(1,"app-carrusel"),y.TgZ(2,"header",0)(3,"div",1)(4,"h1",2),y._uU(5,"Ligas"),y.qZA()()(),y.TgZ(6,"div",1)(7,"div",3),y.YNc(8,sc,2,1,"div",4),y.qZA()(),y._UZ(9,"br")(10,"app-galeria")(11,"app-team")(12,"br")(13,"app-correo")(14,"br")(15,"br")(16,"br")),2&V&&(y.xp6(8),y.Q6J("ngForOf",ie.ligas))},dependencies:[Ai.sg,yl,Bl,ks,sl,oc,Sa],styles:[".grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1rem}"]})}return K})(),ac=(()=>{class K{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-jugador"]],decls:2,vars:0,template:function(V,ie){1&V&&(y.TgZ(0,"p"),y._uU(1,"jugador works!"),y.qZA())}})}return K})(),Nl=(()=>{class K{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-error-page"]],decls:9,vars:0,consts:[[1,"bgsec"],["routerLink","/inicio","src","../../../assets/mensajeerror.png","alt","",1,"d-block",2,"display","block","margin-left","auto","margin-right","auto","width","750px"]],template:function(V,ie){1&V&&(y.TgZ(0,"body",0),y._UZ(1,"br")(2,"br")(3,"br"),y.TgZ(4,"a"),y._UZ(5,"img",1),y.qZA(),y._UZ(6,"br")(7,"br")(8,"br"),y.qZA())},dependencies:[Nr.rH],encapsulation:2})}return K})();var vl=L(3576),Ws=L(4006);function Mc(K,S){if(1&K&&(y.TgZ(0,"div")(1,"h3"),y._uU(2),y.qZA()()),2&K){const T=S.$implicit;y.xp6(2),y.hij("prediccion: ",T[0],"")}}function Lo(K,S){if(1&K&&(y.TgZ(0,"div"),y.YNc(1,Mc,3,1,"div",29),y.qZA()),2&K){const T=y.oxw();y.xp6(1),y.Q6J("ngForOf",T.predictions)}}const Sr=[{path:"",redirectTo:"inicio",pathMatch:"full"},{path:"inicio",component:ll},{path:"jugador",component:ac},{path:"aviso_privacidad",component:Ta},{path:"prediccion",component:(()=>{class K{constructor(T){this.restaurarbaseService=T,this.formData={pj:"",pg:"",pe:"",pp:"",puntos:"",gf:"",ge:"",dg:"",equipo:""},this.data=[1,2,3,4,5],this.predictions=[]}ngOnInit(){}onSubmit(){this.restaurarbaseService.postDatosDR(this.formData).subscribe(T=>{console.log(T),this.predictions=T},T=>{console.error(T)})}trans(){return this.predictions=Object.values(this.predictions),console.log(this.predictions),!0}static#e=this.\u0275fac=function(V){return new(V||K)(y.Y36(vl.k))};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-prediccion"]],decls:49,vars:10,consts:[[1,"container","d-flex","justify-content-center","align-items-center","mt-3"],[1,"card","text-center",2,"width","18rem"],[1,"card-body"],[1,"container",3,"submit"],[1,"form-group"],["for","Partidos Jugados"],["type","number","id","Partidos Jugados","name","pj","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","pg"],["type","number","id","pg","name","pg","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","pe"],["type","number","id","pe","name","pe","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","pp"],["type","number","id","pp","name","pp","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","puntos"],["type","number","id","puntos","name","puntos","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","gf"],["type","number","id","gf","name","gf","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","ge"],["type","number","id","ge","name","ge","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","dg"],["type","dg","id","dg","name","dg","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","equipo"],["type","equipo","id","equipo","name","equipo","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary"],[1,"container"],[1,"row"],[1,"col"],[1,"btn","btn-secondary","mt-5",3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(V,ie){1&V&&(y._UZ(0,"app-navbar"),y.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"form",3),y.NdJ("submit",function(){return ie.onSubmit()}),y.TgZ(5,"div",4)(6,"label",5),y._uU(7,"Partidos Jugados:"),y.qZA(),y.TgZ(8,"input",6),y.NdJ("ngModelChange",function(Je){return ie.formData.pj=Je}),y.qZA()(),y.TgZ(9,"div",4)(10,"label",7),y._uU(11,"Partidos ganados:"),y.qZA(),y.TgZ(12,"input",8),y.NdJ("ngModelChange",function(Je){return ie.formData.pg=Je}),y.qZA()(),y.TgZ(13,"div",4)(14,"label",9),y._uU(15,"Partidos empatados:"),y.qZA(),y.TgZ(16,"input",10),y.NdJ("ngModelChange",function(Je){return ie.formData.pe=Je}),y.qZA()(),y.TgZ(17,"div",4)(18,"label",11),y._uU(19,"Partidos perdidos:"),y.qZA(),y.TgZ(20,"input",12),y.NdJ("ngModelChange",function(Je){return ie.formData.pp=Je}),y.qZA()(),y.TgZ(21,"div",4)(22,"label",13),y._uU(23,"Puntos:"),y.qZA(),y.TgZ(24,"input",14),y.NdJ("ngModelChange",function(Je){return ie.formData.puntos=Je}),y.qZA()(),y.TgZ(25,"div",4)(26,"label",15),y._uU(27,"Goles a favor:"),y.qZA(),y.TgZ(28,"input",16),y.NdJ("ngModelChange",function(Je){return ie.formData.gf=Je}),y.qZA()(),y.TgZ(29,"div",4)(30,"label",17),y._uU(31,"Goles en contra:"),y.qZA(),y.TgZ(32,"input",18),y.NdJ("ngModelChange",function(Je){return ie.formData.ge=Je}),y.qZA()(),y.TgZ(33,"div",4)(34,"label",19),y._uU(35,"Diferencia de goles:"),y.qZA(),y.TgZ(36,"input",20),y.NdJ("ngModelChange",function(Je){return ie.formData.dg=Je}),y.qZA()(),y.TgZ(37,"div",4)(38,"label",21),y._uU(39,"Equipo:"),y.qZA(),y.TgZ(40,"input",22),y.NdJ("ngModelChange",function(Je){return ie.formData.equipo=Je}),y.qZA()(),y.TgZ(41,"button",23),y._uU(42,"Enviar"),y.qZA()()(),y.TgZ(43,"div",24)(44,"div",25)(45,"div",26)(46,"button",27),y.NdJ("click",function(){return ie.trans()}),y._uU(47," transformar "),y.qZA()()()(),y.YNc(48,Lo,2,1,"div",28),y.qZA()()),2&V&&(y.xp6(8),y.Q6J("ngModel",ie.formData.pj),y.xp6(4),y.Q6J("ngModel",ie.formData.pg),y.xp6(4),y.Q6J("ngModel",ie.formData.pe),y.xp6(4),y.Q6J("ngModel",ie.formData.pp),y.xp6(4),y.Q6J("ngModel",ie.formData.puntos),y.xp6(4),y.Q6J("ngModel",ie.formData.gf),y.xp6(4),y.Q6J("ngModel",ie.formData.ge),y.xp6(4),y.Q6J("ngModel",ie.formData.dg),y.xp6(4),y.Q6J("ngModel",ie.formData.equipo),y.xp6(8),y.Q6J("ngIf",ie.trans()))},dependencies:[Ai.sg,Ai.O5,ks,Ws._Y,Ws.Fj,Ws.wV,Ws.JJ,Ws.JL,Ws.Q7,Ws.On,Ws.F]})}return K})()},{path:"404",component:Nl},{path:"auth",loadChildren:()=>Promise.all([L.e(226),L.e(592),L.e(86)]).then(L.bind(L,6086)).then(K=>K.AuthModule)},{path:"gestor",loadChildren:()=>Promise.all([L.e(226),L.e(592),L.e(727)]).then(L.bind(L,8727)).then(K=>K.GestorModule)},{path:"ligas",loadChildren:()=>Promise.all([L.e(592),L.e(345)]).then(L.bind(L,6345)).then(K=>K.LigasModule)},{path:"base",loadChildren:()=>Promise.all([L.e(226),L.e(236)]).then(L.bind(L,8236)).then(K=>K.DatabaseModule)},{path:"**",redirectTo:"404"}];let Aa=(()=>{class K{static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275mod=y.oAB({type:K});static#n=this.\u0275inj=y.cJS({imports:[Nr.Bz.forRoot(Sr,{preloadingStrategy:Nr.wm}),Nr.Bz]})}return K})();var lc=L(2340),as=L(9898);const Ha=["mapa"];let Ga=(()=>{class K{constructor(){this.lngLat=[0,0]}ngAfterViewInit(){const T=new as.Map({container:this.divMapa.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:this.lngLat,zoom:15});(new as.Marker).setLngLat(this.lngLat).addTo(T)}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-mini-mapa"]],viewQuery:function(V,ie){if(1&V&&y.Gf(Ha,5),2&V){let Oe;y.iGM(Oe=y.CRH())&&(ie.divMapa=Oe.first)}},inputs:{lngLat:"lngLat"},decls:2,vars:0,consts:[["mapa",""]],template:function(V,ie){1&V&&y._UZ(0,"div",null,0)},styles:["div[_ngcontent-%COMP%]{width:100%;height:150px;margin:0}"]})}return K})();function cc(K,S){if(1&K&&(y.TgZ(0,"div",13),y._UZ(1,"app-mini-mapa",14),y.TgZ(2,"div",15)(3,"h5",16),y._uU(4),y.qZA(),y.TgZ(5,"p",17),y._uU(6),y.qZA()()()),2&K){const T=S.$implicit;y.xp6(1),y.Q6J("lngLat",T.lngLat),y.xp6(3),y.hij(" ",T.titulo,""),y.xp6(2),y.Oqu(T.descripcion)}}let mr=(()=>{class K{constructor(){this.propiedades=[{titulo:"Presidencia municipal, Huejutla",descripcion:"Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo.",lngLat:[-98.42047711680699,21.139670643115895]}]}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-footer"]],decls:31,vars:1,consts:[[1,"pie-pagina","bg"],[1,"grupo-1"],[1,"box"],["href","#"],["src","../../../assets/lgn.png","alt","Logo de SLee Dw"],[1,"red-social"],["href","https://www.facebook.com/presidenciahuejutla2024","target","_blank",1,"fa","fa-facebook"],["href","https://www.instagram.com/?hl=es-la","target","_blank",1,"fa","fa-instagram"],["href","https://www.facebook.com/presidenciahuejutla2024","target","_blank",1,"fa","fa-whatsapp"],["class","card mapita",4,"ngFor","ngForOf"],[1,"foo"],[1,"grupo-2"],[1,"letra"],[1,"card","mapita"],[1,"card-img-top",3,"lngLat"],[1,"card-body"],[1,"card-title"],[1,"card-text","direc"]],template:function(V,ie){1&V&&(y.TgZ(0,"footer",0)(1,"div",1)(2,"div",2)(3,"figure")(4,"a",3),y._UZ(5,"img",4),y.qZA()()(),y.TgZ(6,"div",2)(7,"h2"),y._uU(8,"SOBRE NOSOTROS"),y.qZA(),y.TgZ(9,"p"),y._uU(10,"SOLF es un sistema la cual funcionara para la organizacion de ligas de futbol"),y.qZA(),y.TgZ(11,"p"),y._uU(12,"Contamos con una gran experiencia y sabemos lo que necesita una organizacion"),y.qZA()(),y.TgZ(13,"div",2)(14,"h2"),y._uU(15,"Nuestras Redes Solciales"),y.qZA(),y.TgZ(16,"div",5),y._UZ(17,"a",6)(18,"a",7)(19,"a",8),y.qZA(),y.TgZ(20,"h2"),y._uU(21,"Ubicaciones de oficinas"),y.qZA(),y.TgZ(22,"div",5),y.YNc(23,cc,7,3,"div",9),y.qZA()()(),y.TgZ(24,"div",10)(25,"div",11)(26,"small",12),y._uU(27,"\xa9 2022 "),y.TgZ(28,"b"),y._uU(29,"SOLF"),y.qZA(),y._uU(30," - Todos los Derechos Reservados."),y.qZA()()()()),2&V&&(y.xp6(23),y.Q6J("ngForOf",ie.propiedades))},dependencies:[Ai.sg,Ga],styles:[".pie-pagina[_ngcontent-%COMP%]{width:100%}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:auto;display:grid;grid-template-columns:repeat(3,1fr);grid-gap:50px;padding:45px 0}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-decoration:none}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;margin-bottom:25px;font-size:20px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#efefef;margin-bottom:10px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .red-social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;text-decoration:none;width:45px;height:45px;line-height:45px;color:#000;margin-right:10px;background-color:#dfd2b0;text-align:center;transition:all .3s ease}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .red-social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#521a49}.pie-pagina[_ngcontent-%COMP%]   .grupo-2[_ngcontent-%COMP%]{background-color:#dfd2;padding:15px 10px;text-align:center;color:#fff}.pie-pagina[_ngcontent-%COMP%]   .grupo-2[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:15px}.direc[_ngcontent-%COMP%]{color:#000}.foo[_ngcontent-%COMP%]{background-color:#dfd2b0}.letra[_ngcontent-%COMP%]{color:#521a49}@media screen and (max-width:800px){.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]{width:90%;grid-template-columns:repeat(1,1fr);grid-gap:30px;padding:35px 0}}"]})}return K})(),Ia=(()=>{class K{constructor(){this.title="solf"}ngOnInit(){as.accessToken=lc.N.mapboxToken}static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275cmp=y.Xpm({type:K,selectors:[["app-root"]],decls:2,vars:0,template:function(V,ie){1&V&&y._UZ(0,"router-outlet")(1,"app-footer")},dependencies:[Nr.lC,mr]})}return K})();var cl=L(5503),U=L(8298);let se=(()=>{class K{static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275mod=y.oAB({type:K});static#n=this.\u0275inj=y.cJS({imports:[Ai.ez,Aa,Nr.Bz,U.q,cl.D]})}return K})(),Z=(()=>{class K{static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275mod=y.oAB({type:K});static#n=this.\u0275inj=y.cJS({imports:[Ai.ez,se,Aa,cl.D,Ws.u5]})}return K})();var _e=L(9770),pt=L(2843),En=L(4968),kn=L(9646),wi=L(7272),br=L(7579),xr=L(9751),Er=L(5032);const Xi=new xr.y(Er.Z);var hr=L(6451),Hn=L(4004),Kr=L(9300),vo=L(3900),Fs=L(4033),Fo=L(576),Go=L(8421),oa=L(4482);const $a={connector:()=>new br.x};function sa(K,S=$a){const{connector:T}=S;return(0,oa.e)((V,ie)=>{const Oe=T();(0,Go.Xf)(K(function Cs(K){return new xr.y(S=>K.subscribe(S))}(Oe))).subscribe(ie),ie.add(V.subscribe(Oe))})}var ms=L(5698),ru=L(8505),ya=L(1005);const Za="Service workers are disabled or not supported by this browser";class Wa{constructor(S){if(this.serviceWorker=S,S){const V=(0,En.R)(S,"controllerchange").pipe((0,Hn.U)(()=>S.controller)),ie=(0,_e.P)(()=>(0,kn.of)(S.controller)),Oe=(0,wi.z)(ie,V);this.worker=Oe.pipe((0,Kr.h)(ri=>!!ri)),this.registration=this.worker.pipe((0,vo.w)(()=>S.getRegistration()));const On=(0,En.R)(S,"message").pipe((0,Hn.U)(ri=>ri.data)).pipe((0,Kr.h)(ri=>ri&&ri.type)).pipe(function bl(K){return K?S=>sa(K)(S):S=>function Bs(K,S){const T=(0,Fo.m)(K)?K:()=>K;return(0,Fo.m)(S)?sa(S,{connector:T}):V=>new Fs.c(V,T)}(new br.x)(S)}());On.connect(),this.events=On}else this.worker=this.events=this.registration=function Pa(K){return(0,_e.P)(()=>(0,pt._)(new Error(K)))}(Za)}postMessage(S,T){return this.worker.pipe((0,ms.q)(1),(0,ru.b)(V=>{V.postMessage({action:S,...T})})).toPromise().then(()=>{})}postMessageWithOperation(S,T,V){const ie=this.waitForOperationCompleted(V),Oe=this.postMessage(S,T);return Promise.all([Oe,ie]).then(([,Je])=>Je)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(S){let T;return T="string"==typeof S?V=>V.type===S:V=>S.includes(V.type),this.events.pipe((0,Kr.h)(T))}nextEventOfType(S){return this.eventsOfType(S).pipe((0,ms.q)(1))}waitForOperationCompleted(S){return this.eventsOfType("OPERATION_COMPLETED").pipe((0,Kr.h)(T=>T.nonce===S),(0,ms.q)(1),(0,Hn.U)(T=>{if(void 0!==T.result)return T.result;throw new Error(T.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let zl=(()=>{class K{get isEnabled(){return this.sw.isEnabled}constructor(T){if(this.sw=T,this.pushManager=null,this.subscriptionChanges=new br.x,!T.isEnabled)return this.messages=Xi,this.notificationClicks=Xi,void(this.subscription=Xi);this.messages=this.sw.eventsOfType("PUSH").pipe((0,Hn.U)(ie=>ie.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe((0,Hn.U)(ie=>ie.data)),this.pushManager=this.sw.registration.pipe((0,Hn.U)(ie=>ie.pushManager));const V=this.pushManager.pipe((0,vo.w)(ie=>ie.getSubscription()));this.subscription=(0,hr.T)(V,this.subscriptionChanges)}requestSubscription(T){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(Za));const V={userVisibleOnly:!0};let ie=this.decodeBase64(T.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),Oe=new Uint8Array(new ArrayBuffer(ie.length));for(let Je=0;Je<ie.length;Je++)Oe[Je]=ie.charCodeAt(Je);return V.applicationServerKey=Oe,this.pushManager.pipe((0,vo.w)(Je=>Je.subscribe(V)),(0,ms.q)(1)).toPromise().then(Je=>(this.subscriptionChanges.next(Je),Je))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe((0,ms.q)(1),(0,vo.w)(V=>{if(null===V)throw new Error("Not subscribed to push notifications.");return V.unsubscribe().then(ie=>{if(!ie)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Za))}decodeBase64(T){return atob(T)}}return K.\u0275fac=function(T){return new(T||K)(y.LFG(Wa))},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})(),uc=(()=>{class K{get isEnabled(){return this.sw.isEnabled}constructor(T){if(this.sw=T,!T.isEnabled)return this.versionUpdates=Xi,this.available=Xi,this.activated=Xi,void(this.unrecoverable=Xi);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe((0,Kr.h)(V=>"VERSION_READY"===V.type),(0,Hn.U)(V=>({type:"UPDATE_AVAILABLE",current:V.currentVersion,available:V.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Za));const T=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:T},T)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Za));const T=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:T},T)}}return K.\u0275fac=function(T){return new(T||K)(y.LFG(Wa))},K.\u0275prov=y.Yz7({token:K,factory:K.\u0275fac}),K})();class Do{}const xl=new y.OlP("NGSW_REGISTER_SCRIPT");function wl(K,S,T,V){return()=>{if(!(0,Ai.NF)(V)||!("serviceWorker"in navigator)||!1===T.enabled)return;let ie;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof T.registrationStrategy)ie=T.registrationStrategy();else{const[Je,...Ot]=(T.registrationStrategy||"registerWhenStable:30000").split(":");switch(Je){case"registerImmediately":ie=(0,kn.of)(null);break;case"registerWithDelay":ie=El(+Ot[0]||0);break;case"registerWhenStable":ie=Ot[0]?(0,hr.T)(Ul(K),El(+Ot[0])):Ul(K);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${T.registrationStrategy}`)}}K.get(y.R0b).runOutsideAngular(()=>ie.pipe((0,ms.q)(1)).subscribe(()=>navigator.serviceWorker.register(S,{scope:T.scope}).catch(Je=>console.error("Service worker registration failed with:",Je))))}}function El(K){return(0,kn.of)(null).pipe((0,ya.g)(K))}function Ul(K){return K.get(y.z2F).isStable.pipe((0,Kr.h)(T=>T))}function dc(K,S){return new Wa((0,Ai.NF)(S)&&!1!==K.enabled?navigator.serviceWorker:void 0)}let hc=(()=>{class K{static register(T,V={}){return{ngModule:K,providers:[{provide:xl,useValue:T},{provide:Do,useValue:V},{provide:Wa,useFactory:dc,deps:[Do,y.Lbi]},{provide:y.ip1,useFactory:wl,deps:[y.zs3,xl,Do,y.Lbi],multi:!0}]}}}return K.\u0275fac=function(T){return new(T||K)},K.\u0275mod=y.oAB({type:K}),K.\u0275inj=y.cJS({providers:[zl,uc]}),K})();var aa=L(2965);let Oa=(()=>{class K{static#e=this.\u0275fac=function(V){return new(V||K)};static#t=this.\u0275mod=y.oAB({type:K,bootstrap:[Ia]});static#n=this.\u0275inj=y.cJS({imports:[j.JF,w.b2,Aa,se,Z,rl,aa.Tm,hc.register("ngsw-worker.js",{enabled:!(0,y.X6Q)(),registrationStrategy:"registerWhenStable:30000"})]})}return K})();lc.N.production&&(0,y.G48)(),w.q6().bootstrapModule(Oa).catch(K=>console.error(K))},9898:function(Yn){Yn.exports=function(){"use strict";var kt,L,w;function y(a,de){if(kt)if(L){var Qe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+kt+")(sharedChunk); ("+L+")(sharedChunk); self.onerror = null;",it={};kt(it),w=de(it),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(w.workerUrl=window.URL.createObjectURL(new Blob([Qe],{type:"text/javascript"})))}else L=de;else kt=de}return y(0,function(a){var de=typeof self<"u"?self:{},Qe="2.12.0";let it;const Ce={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==it){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{it=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{it=n}}return it},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Fe={supported:!1,testSupport:function(n){!qe&&at&&(Ve?tt(n):$e=n)}};let $e,at,qe=!1,Ve=!1;function tt(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,at),n.isContextLost())return;Fe.supported=!0}catch{}n.deleteTexture(e),qe=!0}de.document&&(at=de.document.createElement("img"),at.onload=function(){$e&&tt($e),$e=null,Ve=!0},at.onerror=function(){qe=!0,$e=null},at.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Re="01";var ft=et;function et(n,e,i,s){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=i,this.p2y=s}et.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(void 0===e&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,s=0;s<8;s++){var d=this.sampleCurveX(i)-n;if(Math.abs(d)<e)return i;var f=this.sampleCurveDerivativeX(i);if(Math.abs(f)<1e-6)break;i-=d/f}var m=0,v=1;for(i=n,s=0;s<20&&(d=this.sampleCurveX(i),!(Math.abs(d-n)<e));s++)n>d?m=i:v=i,i=.5*(v-m)+m;return i},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var ht=Gt;function Gt(n,e){this.x=n,this.y=e}Gt.prototype={clone:function(){return new Gt(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(n,e){var i=Math.cos(n),s=Math.sin(n),d=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Gt.convert=function(n){return n instanceof Gt?n:Array.isArray(n)?new Gt(n[0],n[1]):n};const an=Math.PI/180,ot=180/Math.PI;function Te(n){return n*an}function Ne(n){return n*ot}const mt=[[0,0],[1,0],[1,1],[0,1]];function It(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function sn(n,e,i,s){const d=new ft(n,e,i,s);return function(f){return d.solve(f)}}const Cn=sn(.25,.1,.25,1);function Yt(n,e,i){return Math.min(i,Math.max(e,n))}function nt(n,e,i){return(i=Yt((i-n)/(e-n),0,1))*i*(3-2*i)}function Et(n,e,i){const s=i-e,d=((n-e)%s+s)%s+e;return d===e?i:d}function ct(n,e,i){if(!n.length)return i(null,[]);let s=n.length;const d=new Array(n.length);let f=null;n.forEach((m,v)=>{e(m,(E,C)=>{E&&(f=E),d[v]=C,0==--s&&i(f,d)})})}function Pn(n){const e=[];for(const i in n)e.push(n[i]);return e}function Nn(n,...e){for(const i of e)for(const s in i)n[s]=i[s];return n}let fi=1;function Ci(){return fi++}function Bt(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function Zt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function nn(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function Ct(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Jt(n,e){return-1!==n.indexOf(e,n.length-e.length)}function ze(n,e,i){const s={};for(const d in n)s[d]=e.call(i||this,n[d],d,n);return s}function zt(n,e,i){const s={};for(const d in n)e.call(i||this,n[d],d,n)&&(s[d]=n[d]);return s}function ve(n){return Array.isArray(n)?n.map(ve):"object"==typeof n&&n?ze(n,ve):n}const Lt={};function Tt(n){Lt[n]||(typeof console<"u"&&console.warn(n),Lt[n]=!0)}function fn(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function me(n){let e=0;for(let i,s,d=0,f=n.length,m=f-1;d<f;m=d++)i=n[d],s=n[m],e+=(s.x-i.x)*(i.y+s.y);return e}function Rt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Se(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,d,f)=>{const m=d||f;return e[s]=!m||m.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let vt=null;function jn(n){if(null==vt){const e=n.navigator?n.navigator.userAgent:null;vt=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return vt}function li(n){try{const e=de[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Bi(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const dn="mapbox-tiles";let ue,ke,xt=500,lt=50;function Vt(){try{return de.caches}catch{}}function An(){Vt()&&!ue&&(ue=de.caches.open(dn))}function Fn(n){const e=n.indexOf("?");if(e<0)return n;const s=function(d){const f=d.indexOf("?");return f>0?d.slice(f+1).split("&"):[]}(n).filter(d=>{const f=d.split("=");return"language"===f[0]||"worldview"===f[0]});return s.length?`${n.slice(0,e)}?${s.join("&")}`:n.slice(0,e)}let Mn=1/0;const At={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(At);class Ae extends Error{constructor(e,i,s){401===i&&_t(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Qt=Rt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===de.location.protocol?de.parent:de).location.href,Dn=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(Qt())&&!/^\w+:/.test(i))){if(de.fetch&&de.Request&&de.AbortController&&de.Request.prototype.hasOwnProperty("signal"))return function(s,d){const f=new de.AbortController,m=new de.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Qt(),signal:f.signal});let v=!1,E=!1;const C=(R=m.url).indexOf("sku=")>0&&_t(R);var R;"json"===s.type&&m.headers.set("Accept","application/json");const N=(X,ne,he)=>{if(E)return;if(X&&"SecurityError"!==X.message&&Tt(X),ne&&he)return $(ne);const Pe=Date.now();de.fetch(m).then(Xe=>{if(Xe.ok){const gt=C?Xe.clone():null;return $(Xe,gt,Pe)}return d(new Ae(Xe.statusText,Xe.status,s.url))}).catch(Xe=>{20!==Xe.code&&d(new Error(Xe.message))})},$=(X,ne,he)=>{("arrayBuffer"===s.type?X.arrayBuffer():"json"===s.type?X.json():X.text()).then(Pe=>{E||(ne&&he&&function(Xe,gt,We){if(An(),!ue)return;const dt={status:gt.status,statusText:gt.statusText,headers:new de.Headers};gt.headers.forEach((cn,on)=>dt.headers.set(on,cn));const Dt=Se(gt.headers.get("Cache-Control")||"");if(Dt["no-store"])return;Dt["max-age"]&&dt.headers.set("Expires",new Date(We+1e3*Dt["max-age"]).toUTCString());const yt=dt.headers.get("Expires");yt&&(new Date(yt).getTime()-We<42e4||function(cn,on){if(void 0===ke)try{new Response(new ReadableStream),ke=!0}catch{ke=!1}ke?on(cn.body):cn.blob().then(on)}(gt,cn=>{const on=new de.Response(cn,dt);An(),ue&&ue.then(Sn=>Sn.put(Fn(Xe.url),on)).catch(Sn=>Tt(Sn.message))}))}(m,ne,he),v=!0,d(null,Pe,X.headers.get("Cache-Control"),X.headers.get("Expires")))}).catch(Pe=>{E||d(new Error(Pe.message))})};return C?function(X,ne){if(An(),!ue)return ne(null);const he=Fn(X.url);ue.then(Pe=>{Pe.match(he).then(Xe=>{const gt=function(We){if(!We)return!1;const dt=new Date(We.headers.get("Expires")||0),Dt=Se(We.headers.get("Cache-Control")||"");return dt>Date.now()&&!Dt["no-cache"]}(Xe);Pe.delete(he),gt&&Pe.put(he,Xe.clone()),ne(null,Xe,gt)}).catch(ne)}).catch(ne)}(m,N):N(null,null),{cancel:()=>{E=!0,v||f.abort()}}}(n,e);if(Rt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(s,d){const f=new de.XMLHttpRequest;f.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(f.responseType="arraybuffer");for(const m in s.headers)f.setRequestHeader(m,s.headers[m]);return"json"===s.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===s.credentials,f.onerror=()=>{d(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let m=f.response;if("json"===s.type)try{m=JSON.parse(f.response)}catch(v){return d(v)}d(null,m,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else d(new Ae(f.statusText,f.status,s.url))},f.send(s.body),{cancel:()=>f.abort()}}(n,e)},ln=function(n,e){return Dn(Nn(n,{type:"arrayBuffer"}),e)};function mi(n){const e=de.document.createElement("a");return e.href=n,e.protocol===de.document.location.protocol&&e.host===de.document.location.host}const Li="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Qi,Ii;Qi=[],Ii=0;const Ir=function(n,e){if(Fe.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),Ii>=Ce.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Qi.push(f),f}Ii++;let i=!1;const s=()=>{if(!i)for(i=!0,Ii--;Qi.length&&Ii<Ce.MAX_PARALLEL_IMAGE_REQUESTS;){const f=Qi.shift(),{requestParameters:m,callback:v,cancelled:E}=f;E||(f.cancel=Ir(m,v).cancel)}},d=ln(n,(f,m,v,E)=>{s(),f?e(f):m&&(de.createImageBitmap?function(C,R){const N=new de.Blob([new Uint8Array(C)],{type:"image/png"});de.createImageBitmap(N).then($=>{R(null,$)}).catch($=>{R(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(C,R)=>e(C,R,v,E)):function(C,R){const N=new de.Image,$=de.URL;N.onload=()=>{R(null,N),$.revokeObjectURL(N.src),N.onload=null,de.requestAnimationFrame(()=>{N.src=Li})},N.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const X=new de.Blob([new Uint8Array(C)],{type:"image/png"});N.src=C.byteLength?$.createObjectURL(X):Li}(m,(C,R)=>e(C,R,v,E)))});return{cancel:()=>{d.cancel(),s()}}},Kt="NO_ACCESS_TOKEN";function Ft(n){return 0===n.indexOf("mapbox:")}function _t(n){return Ce.API_URL_REGEX.test(n)}function bn(n){return Ce.API_CDN_URL_REGEX.test(n)}function Ut(n){return Ce.API_STYLE_REGEX.test(n)&&!De(n)}function De(n){return Ce.API_SPRITE_REGEX.test(n)}const oe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function be(n){const e=n.match(oe);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function wt(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function $t(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(de.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class pe{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=$t(Ce.ACCESS_TOKEN);let s="";return s=i&&i.u?de.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(d,f)=>String.fromCharCode(Number("0x"+f)))):Ce.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=li("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const d=de.localStorage.getItem(i);d&&(this.eventData=JSON.parse(d));const f=de.localStorage.getItem(s);f&&(this.anonId=f)}catch{Tt("Unable to read from LocalStorage")}}saveEventData(){const e=li("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{de.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&de.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Tt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,s,d){if(!Ce.EVENTS_URL)return;const f=be(Ce.EVENTS_URL);f.params.push(`access_token=${d||Ce.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString()},v=i?Nn(m,i):m,E={url:wt(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};var R;this.pendingRequest=(R=C=>{this.pendingRequest=null,s(C),this.saveEventData(),this.processRequests(d)},Dn(Nn(E,{method:"POST"}),R))}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const Q=new class extends pe{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){Ce.EVENTS_URL&&Ce.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>Ft(i)||_t(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=$t(Ce.ACCESS_TOKEN),i=e?e.u:Ce.ACCESS_TOKEN;let s=i!==this.eventData.tokenU;nn(this.anonId)||(this.anonId=Bt(),s=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),m=new Date(d),v=(d-this.eventData.lastSuccess)/864e5;s=s||v>=1||v<-1||f.getDate()!==m.getDate()}else s=!0;s?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Qe,skuId:Re,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=d,this.eventData.tokenU=i)},n):this.processRequests()}},ae=Q.postTurnstileEvent.bind(Q),ye=new class extends pe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,s){this.skuToken=e,this.errorCb=s,Ce.EVENTS_URL&&(i||Ce.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Kt)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),nn(this.anonId)||(this.anonId=Bt()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Qe,skuId:Re,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n))}},Ge=ye.postMapLoadEvent.bind(ye),Ye=new class extends pe{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){Ce.EVENTS_URL&&(n||Ce.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:i}=this.queue.shift(),s=function(d){const f=de.performance.getEntriesByType("resource"),m=de.performance.getEntriesByType("mark"),v=function($){const X={};if($)for(const ne in $)if("other"!==ne)for(const he of $[ne]){const Pe=`${ne}ResolveRangeMin`,Xe=`${ne}ResolveRangeMax`,gt=`${ne}RequestCount`,We=`${ne}RequestCachedCount`;X[Pe]=Math.min(X[Pe]||1/0,he.startTime),X[Xe]=Math.max(X[Xe]||-1/0,he.responseEnd);const dt=Dt=>{void 0===X[Dt]&&(X[Dt]=0),++X[Dt]};void 0!==he.transferSize&&0===he.transferSize&&dt(We),dt(gt)}return X}(function($,X){const ne={};if($)for(const he of $){const Pe=X(he);void 0===ne[Pe]&&(ne[Pe]=[]),ne[Pe].push(he)}return ne}(f,Xt)),E=de.devicePixelRatio,C=de.navigator.connection||de.navigator.mozConnection||de.navigator.webkitConnection,R={counters:[],metadata:[],attributes:[]},N=($,X,ne)=>{null!=ne&&$.push({name:X,value:ne.toString()})};for(const $ in v)N(R.counters,$,v[$]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(N(R.counters,"interactionRangeMin",d.interactionRange[0]),N(R.counters,"interactionRangeMax",d.interactionRange[1])),m)for(const $ of Object.keys(ut)){const X=ut[$],ne=m.find(he=>he.name===X);ne&&N(R.counters,X,ne.startTime)}return N(R.counters,"visibilityHidden",d.visibilityHidden),N(R.attributes,"style",function($){if($)for(const X of $){const ne=X.name.split("?")[0];if(Ut(ne)){const he=ne.split("/").slice(-2);if(2===he.length)return`mapbox://styles/${he[0]}/${he[1]}`}}}(f)),N(R.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),N(R.attributes,"fogEnabled",d.fogEnabled?"true":"false"),N(R.attributes,"projection",d.projection),N(R.attributes,"zoom",d.zoom),N(R.metadata,"devicePixelRatio",E),N(R.metadata,"connectionEffectiveType",C?C.effectiveType:void 0),N(R.metadata,"navigatorUserAgent",de.navigator.userAgent),N(R.metadata,"screenWidth",de.screen.width),N(R.metadata,"screenHeight",de.screen.height),N(R.metadata,"windowWidth",de.innerWidth),N(R.metadata,"windowHeight",de.innerHeight),N(R.metadata,"mapWidth",d.width/E),N(R.metadata,"mapHeight",d.height/E),N(R.metadata,"webglRenderer",d.renderer),N(R.metadata,"webglVendor",d.vendor),N(R.metadata,"sdkVersion",Qe),N(R.metadata,"sdkIdentifier","mapbox-gl-js"),R}(i);for(const d of s.metadata);for(const d of s.counters);for(const d of s.attributes);this.postEvent(e,s,()=>{},n)}},xe=Ye.postPerformanceEvent.bind(Ye),fe=new class extends pe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,s){if(!Ce.API_URL||!Ce.SESSION_PATH)return;const d=be(Ce.API_URL+Ce.SESSION_PATH);d.params.push(`sku=${e||""}`),d.params.push(`access_token=${s||Ce.ACCESS_TOKEN||""}`);const f={url:wt(d),headers:{"Content-Type":"text/plain"}};var v;this.pendingRequest=(v=m=>{this.pendingRequest=null,i(m),this.saveEventData(),this.processRequests(s)},Dn(Nn(f,{method:"GET"}),v))}getSessionAPI(n,e,i,s){this.skuToken=e,this.errorCb=s,Ce.SESSION_PATH&&Ce.API_URL&&(i||Ce.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Kt)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},n)}},te=fe.getSessionAPI.bind(fe),ge=new Set,ut={create:"create",load:"load",fullLoad:"fullLoad"},en={mark(n){de.performance.mark(n)},measure(n,e,i){de.performance.measure(n,e,i)}};function Xt(n){const e=n.name.split("?")[0];return bn(e)&&e.includes("mapbox-gl.js")?"javascript":bn(e)&&e.includes("mapbox-gl.css")?"css":Ce.API_FONTS_REGEX.test(e)?"fontRange":De(e)?"sprite":Ut(e)?"style":Ce.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Qn=de.performance;function ei(n){const e=n?n.url.toString():void 0;return Qn.getEntriesByName(e)}let ci,gi,Vi,ji;const hi={now:()=>void 0!==Vi?Vi:de.performance.now(),setNow(n){Vi=n},restoreNow(){Vi=void 0},frame(n){const e=de.requestAnimationFrame(n);return{cancel:()=>de.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:i,height:s}=n;ji||(ji=de.document.createElement("canvas"));const d=ji.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(i>ji.width||s>ji.height)&&(ji.width=i,ji.height=s),d.clearRect(-e,-e,i+2*e,s+2*e),d.drawImage(n,0,0,i,s),d.getImageData(-e,-e,i+2*e,s+2*e)},resolveURL:n=>(ci||(ci=de.document.createElement("a")),ci.href=n,ci.href),get devicePixelRatio(){return de.devicePixelRatio},get prefersReducedMotion(){return!!de.matchMedia&&(null==gi&&(gi=de.matchMedia("(prefers-reduced-motion: reduce)")),gi.matches)}};function Yi(n,e,i){i[n]&&-1!==i[n].indexOf(e)||(i[n]=i[n]||[],i[n].push(e))}function ir(n,e,i){if(i&&i[n]){const s=i[n].indexOf(e);-1!==s&&i[n].splice(s,1)}}class Ki{constructor(e,i={}){Nn(this,i),this.type=e}}class kr extends Ki{constructor(e,i={}){super("error",Nn({error:e},i))}}class Cr{on(e,i){return this._listeners=this._listeners||{},Yi(e,i,this._listeners),this}off(e,i){return ir(e,i,this._listeners),ir(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Yi(e,i,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,i){"string"==typeof e&&(e=new Ki(e,i||{}));const s=e.type;if(this.listens(s)){e.target=this;const d=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of d)v.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of f)ir(s,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(Nn(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof kr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var pn=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function qr(n,...e){for(const i of e)for(const s in i)n[s]=i[s];return n}function Lr(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Ro(n){if(Array.isArray(n))return n.map(Ro);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=Ro(n[i]);return e}return Lr(n)}class js extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var Pr=js;class ii{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[s,d]of i)this.bindings[s]=d}concat(e){return new ii(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Gi=ii;const rr={kind:"null"},Kn={kind:"number"},Ri={kind:"string"},bi={kind:"boolean"},Fr={kind:"color"},Ji={kind:"object"},Pi={kind:"value"},wo={kind:"collator"},$i={kind:"formatted"},Eo={kind:"resolvedImage"};function Br(n,e){return{kind:"array",itemType:n,N:e}}function ur(n){if("array"===n.kind){const e=ur(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const xo=[rr,Kn,Ri,bi,Fr,$i,Ji,Br(Pi),Eo];function to(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!to(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const i of xo)if(!to(i,e))return null}return`Expected ${ur(n)} but found ${ur(e)} instead.`}function ts(n,e){return e.some(i=>i.kind===n.kind)}function Zo(n,e){return e.some(i=>"null"===i?null===n:"array"===i?Array.isArray(n):"object"===i?n&&!Array.isArray(n)&&"object"==typeof n:i===typeof n)}var Vo,Hs={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function hs(n){return(n=Math.round(n))<0?0:n>255?255:n}function Dr(n){return hs("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function Io(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function Gs(n,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(e-n)*i*6:2*i<1?e:3*i<2?n+(e-n)*(2/3-i)*6:n}try{Vo={}.parseCSSColor=function(n){var e,i=n.replace(/ /g,"").toLowerCase();if(i in Hs)return Hs[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=i.indexOf("("),d=i.indexOf(")");if(-1!==s&&d+1===i.length){var f=i.substr(0,s),m=i.substr(s+1,d-(s+1)).split(","),v=1;switch(f){case"rgba":if(4!==m.length)return null;v=Io(m.pop());case"rgb":return 3!==m.length?null:[Dr(m[0]),Dr(m[1]),Dr(m[2]),v];case"hsla":if(4!==m.length)return null;v=Io(m.pop());case"hsl":if(3!==m.length)return null;var E=(parseFloat(m[0])%360+360)%360/360,C=Io(m[1]),R=Io(m[2]),N=R<=.5?R*(C+1):R+C-R*C,$=2*R-N;return[hs(255*Gs($,N,E+1/3)),hs(255*Gs($,N,E)),hs(255*Gs($,N,E-1/3)),v];default:return null}}return null}}catch{}class po{constructor(e,i,s,d=1){this.r=e,this.g=i,this.b=s,this.a=d}static parse(e){if(!e)return;if(e instanceof po)return e;if("string"!=typeof e)return;const i=Vo(e);return i?new po(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,s,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(s)},${d})`}toArray(){const{r:e,g:i,b:s,a:d}=this;return 0===d?[0,0,0,0]:[255*e/d,255*i/d,255*s/d,d]}toArray01(){const{r:e,g:i,b:s,a:d}=this;return 0===d?[0,0,0,0]:[e/d,i/d,s/d,d]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:s,a:d}=this;return[e,i,s,d]}}po.black=new po(0,0,0,1),po.white=new po(1,1,1,1),po.transparent=new po(0,0,0,0),po.red=new po(1,0,0,1),po.blue=new po(0,0,1,1);var Or=po;class jo{constructor(e,i,s){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ys{constructor(e,i,s,d,f){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=s,this.fontStack=d,this.textColor=f}}class dr{constructor(e){this.sections=e}static fromString(e){return new dr([new ys(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof dr?e:dr.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const s={};i.fontStack&&(s["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(s["font-scale"]=i.scale),i.textColor&&(s["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(s)}return e}}class ns{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ns({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Co(n,e,i,s){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[n,e,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[n,e,i,s]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function lo(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof Or||n instanceof jo||n instanceof dr||n instanceof ns)return!0;if(Array.isArray(n)){for(const e of n)if(!lo(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!lo(n[e]))return!1;return!0}return!1}function jr(n){if(null===n)return rr;if("string"==typeof n)return Ri;if("boolean"==typeof n)return bi;if("number"==typeof n)return Kn;if(n instanceof Or)return Fr;if(n instanceof jo)return wo;if(n instanceof dr)return $i;if(n instanceof ns)return Eo;if(Array.isArray(n)){const e=n.length;let i;for(const s of n){const d=jr(s);if(i){if(i===d)continue;i=Pi;break}i=d}return Br(i||Pi,e)}return Ji}function fo(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof Or||n instanceof dr||n instanceof ns?n.toString():JSON.stringify(n)}class is{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!lo(e[1]))return i.error("invalid value");const s=e[1];let d=jr(s);const f=i.expectedType;return"array"!==d.kind||0!==d.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(d=f),new is(d,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Or?["rgba"].concat(this.value.toArray()):this.value instanceof dr?this.value.serialize():this.value}}var no=is,io=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const Ss={string:Ri,number:Kn,boolean:bi,object:Ji};class As{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let s,d=1;const f=e[0];if("array"===f){let v,E;if(e.length>2){const C=e[1];if("string"!=typeof C||!(C in Ss)||"object"===C)return i.error('The item type argument of "array" must be one of string, number, boolean',1);v=Ss[C],d++}else v=Pi;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);E=e[2],d++}s=Br(v,E)}else s=Ss[f];const m=[];for(;d<e.length;d++){const v=i.parse(e[d],d,Pi);if(!v)return null;m.push(v)}return new As(s,m)}evaluate(e){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(e);if(!to(this.type,jr(s)))return s;if(i===this.args.length-1)throw new io(`Expected value to be of type ${ur(this.type)}, but found ${ur(jr(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){i.push(s.kind);const d=e.N;("number"==typeof d||this.args.length>1)&&i.push(d)}}return i.concat(this.args.map(s=>s.serialize()))}}var Wo=As;class pa{constructor(e){this.type=$i,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return i.error("First argument must be an image or text section.");const d=[];let f=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(f&&"object"==typeof v&&!Array.isArray(v)){f=!1;let E=null;if(v["font-scale"]&&(E=i.parse(v["font-scale"],1,Kn),!E))return null;let C=null;if(v["text-font"]&&(C=i.parse(v["text-font"],1,Br(Ri)),!C))return null;let R=null;if(v["text-color"]&&(R=i.parse(v["text-color"],1,Fr),!R))return null;const N=d[d.length-1];N.scale=E,N.font=C,N.textColor=R}else{const E=i.parse(e[m],1,Pi);if(!E)return null;const C=E.type.kind;if("string"!==C&&"value"!==C&&"null"!==C&&"resolvedImage"!==C)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,d.push({content:E,scale:null,font:null,textColor:null})}}return new pa(d)}evaluate(e){return new dr(this.sections.map(i=>{const s=i.content.evaluate(e);return jr(s)===Eo?new ys("",s,null,null,null):new ys(fo(s),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const s={};i.scale&&(s["font-scale"]=i.scale.serialize()),i.font&&(s["text-font"]=i.font.serialize()),i.textColor&&(s["text-color"]=i.textColor.serialize()),e.push(s)}return e}}class Qs{constructor(e){this.type=Eo,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Ri);return s?new Qs(s):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),s=ns.fromString(i);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(i)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ca={"to-boolean":bi,"to-color":Fr,"to-number":Kn,"to-string":Ri};class Ma{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return i.error("Expected one argument.");const d=Ca[s],f=[];for(let m=1;m<e.length;m++){const v=i.parse(e[m],m,Pi);if(!v)return null;f.push(v)}return new Ma(d,f)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let i,s;for(const d of this.args){if(i=d.evaluate(e),s=null,i instanceof Or)return i;if("string"==typeof i){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Co(i[0],i[1],i[2],i[3]),!s))return new Or(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new io(s||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const s of this.args){if(i=s.evaluate(e),null===i)return 0;const d=Number(i);if(!isNaN(d))return d}throw new io(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?dr.fromString(fo(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ns.fromString(fo(this.args[0].evaluate(e))):fo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new pa([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Qs(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Is=Ma;const Js=["Unknown","Point","LineString","Polygon"];var Ps=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Js[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-n[0])+this.featureDistanceData.bearing[1]*(s*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=Or.parse(n)),e}};class Os{constructor(e,i,s,d){this.name=e,this.type=i,this._evaluate=s,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const s=e[0],d=Os.definitions[s];if(!d)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(d)?d[0]:d.type,m=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,v=m.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let E=null;for(const[C,R]of v){E=new Ke(i.registry,i.path,null,i.scope);const N=[];let $=!1;for(let X=1;X<e.length;X++){const ne=e[X],he=Array.isArray(C)?C[X-1]:C.type,Pe=E.parse(ne,1+N.length,he);if(!Pe){$=!0;break}N.push(Pe)}if(!$)if(Array.isArray(C)&&C.length!==N.length)E.error(`Expected ${C.length} arguments, but found ${N.length} instead.`);else{for(let X=0;X<N.length;X++){const ne=Array.isArray(C)?C[X]:C.type,he=N[X];E.concat(X+1).checkSubtype(ne,he.type)}if(0===E.errors.length)return new Os(s,f,R,N)}}if(1===v.length)i.errors.push(...E.errors);else{const C=(v.length?v:m).map(([N])=>{return $=N,Array.isArray($)?`(${$.map(ur).join(", ")})`:`(${ur($.type)}...)`;var $}).join(" | "),R=[];for(let N=1;N<e.length;N++){const $=i.parse(e[N],1+R.length);if(!$)return null;R.push(ur($.type))}i.error(`Expected arguments of type ${C}, but found (${R.join(", ")}) instead.`)}return null}static register(e,i){Os.definitions=i;for(const s in i)e[s]=Os}}var rs=Os;class Va{constructor(e,i,s){this.type=wo,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return i.error("Collator options argument must be an object.");const d=i.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,bi);if(!d)return null;const f=i.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,bi);if(!f)return null;let m=null;return s.locale&&(m=i.parse(s.locale,1,Ri),!m)?null:new Va(d,f,m)}evaluate(e){return new jo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const yo=8192;function fa(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function vs(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function ma(n,e){const i=(180+n[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(i*d*yo),Math.round(s*d*yo)]}function ja(n,e,i){const s=n[0]-e[0],d=n[1]-e[1],f=n[0]-i[0],m=n[1]-i[1];return s*m-f*d==0&&s*f<=0&&d*m<=0}function ea(n,e){let i=!1;for(let m=0,v=e.length;m<v;m++){const E=e[m];for(let C=0,R=E.length;C<R-1;C++){if(ja(n,E[C],E[C+1]))return!1;(d=E[C])[1]>(s=n)[1]!=(f=E[C+1])[1]>s[1]&&s[0]<(f[0]-d[0])*(s[1]-d[1])/(f[1]-d[1])+d[0]&&(i=!i)}}var s,d,f;return i}function ta(n,e){for(let i=0;i<e.length;i++)if(ea(n,e[i]))return!0;return!1}function Ur(n,e,i,s){const d=s[0]-i[0],f=s[1]-i[1],m=(n[0]-i[0])*f-d*(n[1]-i[1]),v=(e[0]-i[0])*f-d*(e[1]-i[1]);return m>0&&v<0||m<0&&v>0}function ps(n,e,i){for(const C of i)for(let R=0;R<C.length-1;++R)if((v=[(m=C[R+1])[0]-(f=C[R])[0],m[1]-f[1]])[0]*(E=[(d=e)[0]-(s=n)[0],d[1]-s[1]])[1]-v[1]*E[0]!=0&&Ur(s,d,f,m)&&Ur(f,m,s,d))return!0;var s,d,f,m,v,E;return!1}function fs(n,e){for(let i=0;i<n.length;++i)if(!ea(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(ps(n[i],n[i+1],e))return!1;return!0}function na(n,e){for(let i=0;i<e.length;i++)if(fs(n,e[i]))return!0;return!1}function ga(n,e,i){const s=[];for(let d=0;d<n.length;d++){const f=[];for(let m=0;m<n[d].length;m++){const v=ma(n[d][m],i);fa(e,v),f.push(v)}s.push(f)}return s}function ia(n,e,i){const s=[];for(let d=0;d<n.length;d++){const f=ga(n[d],e,i);s.push(f)}return s}function ko(n,e,i,s){if(n[0]<i[0]||n[0]>i[2]){const d=.5*s;let f=n[0]-i[0]>d?-s:i[0]-n[0]>d?s:0;0===f&&(f=n[0]-i[2]>d?-s:i[2]-n[0]>d?s:0),n[0]+=f}fa(e,n)}function fr(n,e,i,s){const d=Math.pow(2,s.z)*yo,f=[s.x*yo,s.y*yo],m=[];if(!n)return m;for(const v of n)for(const E of v){const C=[E.x+f[0],E.y+f[1]];ko(C,e,i,d),m.push(C)}return m}function gl(n,e,i,s){const d=Math.pow(2,s.z)*yo,f=[s.x*yo,s.y*yo],m=[];if(!n)return m;for(const E of n){const C=[];for(const R of E){const N=[R.x+f[0],R.y+f[1]];fa(e,N),C.push(N)}m.push(C)}if(e[2]-e[0]<=d/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const E of m)for(const C of E)ko(C,e,i,d)}var v;return m}class bs{constructor(e,i){this.type=bi,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(lo(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let d=0;d<s.features.length;++d){const f=s.features[d].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new bs(s,s.features[d].geometry)}else if("Feature"===s.type){const d=s.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new bs(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new bs(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,s){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=i.canonicalID();if(!m)return!1;if("Polygon"===s.type){const v=ga(s.coordinates,f,m),E=fr(i.geometry(),d,f,m);if(!vs(d,f))return!1;for(const C of E)if(!ea(C,v))return!1}if("MultiPolygon"===s.type){const v=ia(s.coordinates,f,m),E=fr(i.geometry(),d,f,m);if(!vs(d,f))return!1;for(const C of E)if(!ta(C,v))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,s){const d=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],m=i.canonicalID();if(!m)return!1;if("Polygon"===s.type){const v=ga(s.coordinates,f,m),E=gl(i.geometry(),d,f,m);if(!vs(d,f))return!1;for(const C of E)if(!fs(C,v))return!1}if("MultiPolygon"===s.type){const v=ia(s.coordinates,f,m),E=gl(i.geometry(),d,f,m);if(!vs(d,f))return!1;for(const C of E)if(!na(C,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Da=bs;function co(n){if(n instanceof rs&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof Da)return!1;let e=!0;return n.eachChild(i=>{e&&!co(i)&&(e=!1)}),e}function $s(n){if(n instanceof rs&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(i=>{e&&!$s(i)&&(e=!1)}),e}function xs(n,e){if(n instanceof rs&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(s=>{i&&!xs(s,e)&&(i=!1)}),i}class Pt{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const s=e[1];return i.scope.has(s)?new Pt(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var bt=Pt;class ce{constructor(e,i=[],s,d=new Gi,f=[]){this.registry=e,this.path=i,this.key=i.map(m=>`[${m}]`).join(""),this.scope=d,this.errors=f,this.expectedType=s}parse(e,i,s,d,f={}){return i?this.concat(i,s,d)._parse(e,f):this._parse(e,f)}_parse(e,i){function s(d,f,m){return"assert"===m?new Wo(f,[d]):"coerce"===m?new Is(f,[d]):d}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if("string"!=typeof d)return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[d];if(f){let m=f.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,E=m.type;if("string"!==v.kind&&"number"!==v.kind&&"boolean"!==v.kind&&"object"!==v.kind&&"array"!==v.kind||"value"!==E.kind)if("color"!==v.kind&&"formatted"!==v.kind&&"resolvedImage"!==v.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(v,E))return null}else m=s(m,v,i.typeAnnotation||"coerce");else m=s(m,v,i.typeAnnotation||"assert")}if(!(m instanceof no)&&"resolvedImage"!==m.type.kind&&Nt(m)){const v=new Ps;try{m=new no(m.type,m.evaluate(v))}catch(E){return this.error(E.message),null}}return m}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,s){const d="number"==typeof e?this.path.concat(e):this.path,f=s?this.scope.concat(s):this.scope;return new ce(this.registry,d,i||null,f,this.errors)}error(e,...i){const s=`${this.key}${i.map(d=>`[${d}]`).join("")}`;this.errors.push(new Pr(s,e))}checkSubtype(e,i){const s=to(e,i);return s&&this.error(s),s}}var Ke=ce;function Nt(n){if(n instanceof bt)return Nt(n.boundExpression);if(n instanceof rs&&"error"===n.name||n instanceof Va||n instanceof Da)return!1;const e=n instanceof Is||n instanceof Wo;let i=!0;return n.eachChild(s=>{i=e?i&&Nt(s):i&&s instanceof no}),!!i&&co(n)&&xs(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Bn(n,e){const i=n.length-1;let s,d,f=0,m=i,v=0;for(;f<=m;)if(v=Math.floor((f+m)/2),s=n[v],d=n[v+1],s<=e){if(v===i||e<d)return v;f=v+1}else{if(!(s>e))throw new io("Input is not a number.");m=v-1}return 0}class xi{constructor(e,i,s){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[d,f]of s)this.labels.push(d),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(e[1],1,Kn);if(!s)return null;const d=[];let f=null;i.expectedType&&"value"!==i.expectedType.kind&&(f=i.expectedType);for(let m=1;m<e.length;m+=2){const v=1===m?-1/0:e[m],E=e[m+1],C=m,R=m+1;if("number"!=typeof v)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=v)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const N=i.parse(E,R,f);if(!N)return null;f=f||N.type,d.push([v,N])}return new xi(f,s,d)}evaluate(e){const i=this.labels,s=this.outputs;if(1===i.length)return s[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return s[0].evaluate(e);const f=i.length;return d>=i[f-1]?s[f-1].evaluate(e):s[Bn(i,d)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var si=xi;function pi(n,e,i){return n*(1-i)+e*i}var Vr=Object.freeze({__proto__:null,number:pi,color:function(n,e,i){return new Or(pi(n.r,e.r,i),pi(n.g,e.g,i),pi(n.b,e.b,i),pi(n.a,e.a,i))},array:function(n,e,i){return n.map((s,d)=>pi(s,e[d],i))}});const Ho=.95047,Mo=1.08883,Rs=4/29,_a=6/29,Ai=3*_a*_a,Zs=Math.PI/180,J=180/Math.PI;function Y(n){return n>.008856451679035631?Math.pow(n,1/3):n/Ai+Rs}function G(n){return n>_a?n*n*n:Ai*(n-Rs)}function Ee(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function wn(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Mi(n){const e=wn(n.r),i=wn(n.g),s=wn(n.b),d=Y((.4124564*e+.3575761*i+.1804375*s)/Ho),f=Y((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*f-16,a:500*(d-f),b:200*(f-Y((.0193339*e+.119192*i+.9503041*s)/Mo)),alpha:n.a}}function uo(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,s=isNaN(n.b)?e:e-n.b/200;return e=1*G(e),i=Ho*G(i),s=Mo*G(s),new Or(Ee(3.2404542*i-1.5371385*e-.4985314*s),Ee(-.969266*i+1.8760108*e+.041556*s),Ee(.0556434*i-.2040259*e+1.0572252*s),n.alpha)}function Tn(n,e,i){const s=e-n;return n+i*(s>180||s<-180?s-360*Math.round(s/360):s)}const sr={forward:Mi,reverse:uo,interpolate:function(n,e,i){return{l:pi(n.l,e.l,i),a:pi(n.a,e.a,i),b:pi(n.b,e.b,i),alpha:pi(n.alpha,e.alpha,i)}}},ws={forward:function(n){const{l:e,a:i,b:s}=Mi(n),d=Math.atan2(s,i)*J;return{h:d<0?d+360:d,c:Math.sqrt(i*i+s*s),l:e,alpha:n.a}},reverse:function(n){const e=n.h*Zs,i=n.c;return uo({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:Tn(n.h,e.h,i),c:pi(n.c,e.c,i),l:pi(n.l,e.l,i),alpha:pi(n.alpha,e.alpha,i)}}};var nl=Object.freeze({__proto__:null,lab:sr,hcl:ws});class ro{constructor(e,i,s,d,f){this.type=e,this.operator=i,this.interpolation=s,this.input=d,this.labels=[],this.outputs=[];for(const[m,v]of f)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,i,s,d){let f=0;if("exponential"===e.name)f=Fl(i,e.base,s,d);else if("linear"===e.name)f=Fl(i,1,s,d);else if("cubic-bezier"===e.name){const m=e.controlPoints;f=new ft(m[0],m[1],m[2],m[3]).solve(Fl(i,1,s,d))}return f}static parse(e,i){let[s,d,f,...m]=e;if(!Array.isArray(d)||0===d.length)return i.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const C=d[1];if("number"!=typeof C)return i.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if("cubic-bezier"!==d[0])return i.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(4!==C.length||C.some(R=>"number"!=typeof R||R<0||R>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,Kn),!f)return null;const v=[];let E=null;"interpolate-hcl"===s||"interpolate-lab"===s?E=Fr:i.expectedType&&"value"!==i.expectedType.kind&&(E=i.expectedType);for(let C=0;C<m.length;C+=2){const R=m[C],N=m[C+1],$=C+3,X=C+4;if("number"!=typeof R)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(v.length&&v[v.length-1][0]>=R)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const ne=i.parse(N,X,E);if(!ne)return null;E=E||ne.type,v.push([R,ne])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new ro(E,s,d,f,v):i.error(`Type ${ur(E)} is not interpolatable.`)}evaluate(e){const i=this.labels,s=this.outputs;if(1===i.length)return s[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return s[0].evaluate(e);const f=i.length;if(d>=i[f-1])return s[f-1].evaluate(e);const m=Bn(i,d),v=ro.interpolationFactor(this.interpolation,d,i[m],i[m+1]),E=s[m].evaluate(e),C=s[m+1].evaluate(e);return"interpolate"===this.operator?Vr[this.type.kind.toLowerCase()](E,C,v):"interpolate-hcl"===this.operator?ws.reverse(ws.interpolate(ws.forward(E),ws.forward(C),v)):sr.reverse(sr.interpolate(sr.forward(E),sr.forward(C),v))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)i.push(this.labels[s],this.outputs[s].serialize());return i}}function Fl(n,e,i,s){const d=s-i,f=n-i;return 0===d?0:1===e?f/d:(Math.pow(e,f)-1)/(Math.pow(e,d)-1)}var os=ro;class qo{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let s=null;const d=i.expectedType;d&&"value"!==d.kind&&(s=d);const f=[];for(const v of e.slice(1)){const E=i.parse(v,1+f.length,s,void 0,{typeAnnotation:"omit"});if(!E)return null;s=s||E.type,f.push(E)}const m=d&&f.some(v=>to(d,v.type));return new qo(m?Pi:s,f)}evaluate(e){let i,s=null,d=0;for(const f of this.args){if(d++,s=f.evaluate(e),s&&s instanceof ns&&!s.available&&(i||(i=s),s=null,d===this.args.length))return i;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var il=qo;class rl{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let f=1;f<e.length-1;f+=2){const m=e[f];if("string"!=typeof m)return i.error(`Expected string, but found ${typeof m} instead.`,f);if(/[^a-zA-Z0-9_]/.test(m))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const v=i.parse(e[f+1],f+1);if(!v)return null;s.push([m,v])}const d=i.parse(e[e.length-1],e.length-1,i.expectedType,s);return d?new rl(s,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,s]of this.bindings)e.push(i,s.serialize());return e.push(this.result.serialize()),e}}var Vc=rl;class ic{constructor(e,i,s){this.type=e,this.index=i,this.input=s}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Kn),d=i.parse(e[2],2,Br(i.expectedType||Pi));return s&&d?new ic(d.type.itemType,s,d):null}evaluate(e){const i=this.index.evaluate(e),s=this.input.evaluate(e);if(i<0)throw new io(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new io(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new io(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var rc=ic;class Nr{constructor(e,i){this.type=bi,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Pi),d=i.parse(e[2],2,Pi);return s&&d?ts(s.type,[bi,Ri,Kn,rr,Pi])?new Nr(s,d):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(s.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!Zo(i,["boolean","string","number","null"]))throw new io(`Expected first argument to be of type boolean, string, number or null, but found ${ur(jr(i))} instead.`);if(!Zo(s,["string","array"]))throw new io(`Expected second argument to be of type array or string, but found ${ur(jr(s))} instead.`);return s.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var ss=Nr;class ks{constructor(e,i,s){this.type=Kn,this.needle=e,this.haystack=i,this.fromIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Pi),d=i.parse(e[2],2,Pi);if(!s||!d)return null;if(!ts(s.type,[bi,Ri,Kn,rr,Pi]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(s.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,Kn);return f?new ks(s,d,f):null}return new ks(s,d)}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Zo(i,["boolean","string","number","null"]))throw new io(`Expected first argument to be of type boolean, string, number or null, but found ${ur(jr(i))} instead.`);if(!Zo(s,["string","array"]))throw new io(`Expected second argument to be of type array or string, but found ${ur(jr(s))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return s.indexOf(i,d)}return s.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ta=ks;class Ls{constructor(e,i,s,d,f,m){this.inputType=e,this.type=i,this.input=s,this.cases=d,this.outputs=f,this.otherwise=m}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let s,d;i.expectedType&&"value"!==i.expectedType.kind&&(d=i.expectedType);const f={},m=[];for(let C=2;C<e.length-1;C+=2){let R=e[C];const N=e[C+1];Array.isArray(R)||(R=[R]);const $=i.concat(C);if(0===R.length)return $.error("Expected at least one branch label.");for(const ne of R){if("number"!=typeof ne&&"string"!=typeof ne)return $.error("Branch labels must be numbers or strings.");if("number"==typeof ne&&Math.abs(ne)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ne&&Math.floor(ne)!==ne)return $.error("Numeric branch labels must be integer values.");if(s){if($.checkSubtype(s,jr(ne)))return null}else s=jr(ne);if(void 0!==f[String(ne)])return $.error("Branch labels must be unique.");f[String(ne)]=m.length}const X=i.parse(N,C,d);if(!X)return null;d=d||X.type,m.push(X)}const v=i.parse(e[1],1,Pi);if(!v)return null;const E=i.parse(e[e.length-1],e.length-1,d);return E?"value"!==v.type.kind&&i.concat(1).checkSubtype(s,v.type)?null:new Ls(s,d,v,f,m,E):null}evaluate(e){const i=this.input.evaluate(e);return(jr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),s=[],d={};for(const m of i){const v=d[this.cases[m]];void 0===v?(d[this.cases[m]]=s.length,s.push([this.cases[m],[m]])):s[v][1].push(m)}const f=m=>"number"===this.inputType.kind?Number(m):m;for(const[m,v]of s)e.push(1===v.length?f(v[0]):v.map(f)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}var _l=Ls;class Es{constructor(e,i,s){this.type=e,this.branches=i,this.otherwise=s}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&"value"!==i.expectedType.kind&&(s=i.expectedType);const d=[];for(let m=1;m<e.length-1;m+=2){const v=i.parse(e[m],m,bi);if(!v)return null;const E=i.parse(e[m+1],m+1,s);if(!E)return null;d.push([v,E]),s=s||E.type}const f=i.parse(e[e.length-1],e.length-1,s);return f?new Es(s,d,f):null}evaluate(e){for(const[i,s]of this.branches)if(i.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,s]of this.branches)e(i),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Cc=Es;class yl{constructor(e,i,s,d){this.type=e,this.input=i,this.beginIndex=s,this.endIndex=d}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,Pi),d=i.parse(e[2],2,Kn);if(!s||!d)return null;if(!ts(s.type,[Br(Pi),Ri,Pi]))return i.error(`Expected first argument to be of type array or string, but found ${ur(s.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,Kn);return f?new yl(s.type,s,d,f):null}return new yl(s.type,s,d)}evaluate(e){const i=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Zo(i,["string","array"]))throw new io(`Expected first argument to be of type array or string, but found ${ur(jr(i))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return i.slice(s,d)}return i.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Bl=yl;function ol(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function sl(n,e,i,s){return 0===s.compare(e,i)}function ra(n,e,i){const s="=="!==n&&"!="!==n;return class V0{constructor(f,m,v){this.type=bi,this.lhs=f,this.rhs=m,this.collator=v,this.hasUntypedArgument="value"===f.type.kind||"value"===m.type.kind}static parse(f,m){if(3!==f.length&&4!==f.length)return m.error("Expected two or three arguments.");const v=f[0];let E=m.parse(f[1],1,Pi);if(!E)return null;if(!ol(v,E.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${ur(E.type)}'.`);let C=m.parse(f[2],2,Pi);if(!C)return null;if(!ol(v,C.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${ur(C.type)}'.`);if(E.type.kind!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return m.error(`Cannot compare types '${ur(E.type)}' and '${ur(C.type)}'.`);s&&("value"===E.type.kind&&"value"!==C.type.kind?E=new Wo(C.type,[E]):"value"!==E.type.kind&&"value"===C.type.kind&&(C=new Wo(E.type,[C])));let R=null;if(4===f.length){if("string"!==E.type.kind&&"string"!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return m.error("Cannot use collator to compare non-string types.");if(R=m.parse(f[3],3,wo),!R)return null}return new V0(E,C,R)}evaluate(f){const m=this.lhs.evaluate(f),v=this.rhs.evaluate(f);if(s&&this.hasUntypedArgument){const E=jr(m),C=jr(v);if(E.kind!==C.kind||"string"!==E.kind&&"number"!==E.kind)throw new io(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${E.kind}, ${C.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const E=jr(m),C=jr(v);if("string"!==E.kind||"string"!==C.kind)return e(f,m,v)}return this.collator?i(f,m,v,this.collator.evaluate(f)):e(f,m,v)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[n];return this.eachChild(m=>{f.push(m.serialize())}),f}}}const oc=ra("==",function(n,e,i){return e===i},sl),al=ra("!=",function(n,e,i){return e!==i},function(n,e,i,s){return!sl(0,e,i,s)}),Sa=ra("<",function(n,e,i){return e<i},function(n,e,i,s){return s.compare(e,i)<0}),sc=ra(">",function(n,e,i){return e>i},function(n,e,i,s){return s.compare(e,i)>0}),ll=ra("<=",function(n,e,i){return e<=i},function(n,e,i,s){return s.compare(e,i)<=0}),ac=ra(">=",function(n,e,i){return e>=i},function(n,e,i,s){return s.compare(e,i)>=0});class Nl{constructor(e,i,s,d,f,m){this.type=Ri,this.number=e,this.locale=i,this.currency=s,this.unit=d,this.minFractionDigits=f,this.maxFractionDigits=m}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Kn);if(!s)return null;const d=e[2];if("object"!=typeof d||Array.isArray(d))return i.error("NumberFormat options argument must be an object.");let f=null;if(d.locale&&(f=i.parse(d.locale,1,Ri),!f))return null;let m=null;if(d.currency&&(m=i.parse(d.currency,1,Ri),!m))return null;let v=null;if(d.unit&&(v=i.parse(d.unit,1,Ri),!v))return null;let E=null;if(d["min-fraction-digits"]&&(E=i.parse(d["min-fraction-digits"],1,Kn),!E))return null;let C=null;return d["max-fraction-digits"]&&(C=i.parse(d["max-fraction-digits"],1,Kn),!C)?null:new Nl(s,f,m,v,E,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class vl{constructor(e){this.type=Kn,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=i.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?i.error(`Expected argument of type string or array, but found ${ur(s.type)} instead.`):new vl(s):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new io(`Expected value to be of type string or array, but found ${ur(jr(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Ws={"==":oc,"!=":al,">":sc,"<":Sa,">=":ac,"<=":ll,array:Wo,at:rc,boolean:Wo,case:Cc,coalesce:il,collator:Va,format:pa,image:Qs,in:ss,"index-of":Ta,interpolate:os,"interpolate-hcl":os,"interpolate-lab":os,length:vl,let:Vc,literal:no,match:_l,number:Wo,"number-format":Nl,object:Wo,slice:Bl,step:si,string:Wo,"to-boolean":Is,"to-color":Is,"to-number":Is,"to-string":Is,var:bt,within:Da};function Mc(n,[e,i,s,d]){e=e.evaluate(n),i=i.evaluate(n),s=s.evaluate(n);const f=d?d.evaluate(n):1,m=Co(e,i,s,f);if(m)throw new io(m);return new Or(e/255*f,i/255*f,s/255*f,f)}function Lo(n,e){return n in e}function qs(n,e){const i=e[n];return void 0===i?null:i}function Sr(n){return{type:n}}rs.register(Ws,{error:[{kind:"error"},[Ri],(n,[e])=>{throw new io(e.evaluate(n))}],typeof:[Ri,[Pi],(n,[e])=>ur(jr(e.evaluate(n)))],"to-rgba":[Br(Kn,4),[Fr],(n,[e])=>e.evaluate(n).toArray()],rgb:[Fr,[Kn,Kn,Kn],Mc],rgba:[Fr,[Kn,Kn,Kn,Kn],Mc],has:{type:bi,overloads:[[[Ri],(n,[e])=>Lo(e.evaluate(n),n.properties())],[[Ri,Ji],(n,[e,i])=>Lo(e.evaluate(n),i.evaluate(n))]]},get:{type:Pi,overloads:[[[Ri],(n,[e])=>qs(e.evaluate(n),n.properties())],[[Ri,Ji],(n,[e,i])=>qs(e.evaluate(n),i.evaluate(n))]]},"feature-state":[Pi,[Ri],(n,[e])=>qs(e.evaluate(n),n.featureState||{})],properties:[Ji,[],n=>n.properties()],"geometry-type":[Ri,[],n=>n.geometryType()],id:[Pi,[],n=>n.id()],zoom:[Kn,[],n=>n.globals.zoom],pitch:[Kn,[],n=>n.globals.pitch||0],"distance-from-center":[Kn,[],n=>n.distanceFromCenter()],"heatmap-density":[Kn,[],n=>n.globals.heatmapDensity||0],"line-progress":[Kn,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Kn,[],n=>n.globals.skyRadialProgress||0],accumulated:[Pi,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[Kn,Sr(Kn),(n,e)=>{let i=0;for(const s of e)i+=s.evaluate(n);return i}],"*":[Kn,Sr(Kn),(n,e)=>{let i=1;for(const s of e)i*=s.evaluate(n);return i}],"-":{type:Kn,overloads:[[[Kn,Kn],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[Kn],(n,[e])=>-e.evaluate(n)]]},"/":[Kn,[Kn,Kn],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[Kn,[Kn,Kn],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[Kn,[],()=>Math.LN2],pi:[Kn,[],()=>Math.PI],e:[Kn,[],()=>Math.E],"^":[Kn,[Kn,Kn],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[Kn,[Kn],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))],log2:[Kn,[Kn],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Kn,[Kn],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Kn,[Kn],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Kn,[Kn],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Kn,[Kn],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Kn,[Kn],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Kn,[Kn],(n,[e])=>Math.atan(e.evaluate(n))],min:[Kn,Sr(Kn),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[Kn,Sr(Kn),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[Kn,[Kn],(n,[e])=>Math.abs(e.evaluate(n))],round:[Kn,[Kn],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Kn,[Kn],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Kn,[Kn],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[bi,[Ri,Pi],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[bi,[Pi],(n,[e])=>n.id()===e.value],"filter-type-==":[bi,[Ri],(n,[e])=>n.geometryType()===e.value],"filter-<":[bi,[Ri,Pi],(n,[e,i])=>{const s=n.properties()[e.value],d=i.value;return typeof s==typeof d&&s<d}],"filter-id-<":[bi,[Pi],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i<s}],"filter->":[bi,[Ri,Pi],(n,[e,i])=>{const s=n.properties()[e.value],d=i.value;return typeof s==typeof d&&s>d}],"filter-id->":[bi,[Pi],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i>s}],"filter-<=":[bi,[Ri,Pi],(n,[e,i])=>{const s=n.properties()[e.value],d=i.value;return typeof s==typeof d&&s<=d}],"filter-id-<=":[bi,[Pi],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i<=s}],"filter->=":[bi,[Ri,Pi],(n,[e,i])=>{const s=n.properties()[e.value],d=i.value;return typeof s==typeof d&&s>=d}],"filter-id->=":[bi,[Pi],(n,[e])=>{const i=n.id(),s=e.value;return typeof i==typeof s&&i>=s}],"filter-has":[bi,[Pi],(n,[e])=>e.value in n.properties()],"filter-has-id":[bi,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[bi,[Br(Ri)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[bi,[Br(Pi)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[bi,[Ri,Br(Pi)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[bi,[Ri,Br(Pi)],(n,[e,i])=>function(s,d,f,m){for(;f<=m;){const v=f+m>>1;if(d[v]===s)return!0;d[v]>s?m=v-1:f=v+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:bi,overloads:[[[bi,bi],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[Sr(bi),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:bi,overloads:[[[bi,bi],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[Sr(bi),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[bi,[bi],(n,[e])=>!e.evaluate(n)],"is-supported-script":[bi,[Ri],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[Ri,[Ri],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Ri,[Ri],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Ri,Sr(Pi),(n,e)=>e.map(i=>fo(i.evaluate(n))).join("")],"resolved-locale":[Ri,[wo],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Aa=Ws;function lc(n){return{result:"success",value:n}}function as(n){return{result:"error",value:n}}function Ha(n){return"data-driven"===n["property-type"]}function Ga(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function cc(n){return!!n.expression&&n.expression.interpolated}function mr(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function Ia(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function cl(n){return n}function U(n,e){const i="color"===e.type,s=n.stops&&"object"==typeof n.stops[0][0],d=s||!(s||void 0!==n.property),f=n.type||(cc(e)?"exponential":"interval");if(i&&((n=qr({},n)).stops&&(n.stops=n.stops.map(C=>[C[0],Or.parse(C[1])])),n.default=Or.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!nl[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let m,v,E;if("exponential"===f)m=pt;else if("interval"===f)m=_e;else if("categorical"===f){m=Z,v=Object.create(null);for(const C of n.stops)v[C[0]]=C[1];E=typeof n.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);m=En}if(s){const C={},R=[];for(let X=0;X<n.stops.length;X++){const ne=n.stops[X],he=ne[0].zoom;void 0===C[he]&&(C[he]={zoom:he,type:n.type,property:n.property,default:n.default,stops:[]},R.push(he)),C[he].stops.push([ne[0].value,ne[1]])}const N=[];for(const X of R)N.push([C[X].zoom,U(C[X],e)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:os.interpolationFactor.bind(void 0,$),zoomStops:N.map(X=>X[0]),evaluate:({zoom:X},ne)=>pt({stops:N,base:n.base},e,X).evaluate(X,ne)}}if(d){const C="exponential"===f?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:os.interpolationFactor.bind(void 0,C),zoomStops:n.stops.map(R=>R[0]),evaluate:({zoom:R})=>m(n,e,R,v,E)}}return{kind:"source",evaluate(C,R){const N=R&&R.properties?R.properties[n.property]:void 0;return void 0===N?se(n.default,e.default):m(n,e,N,v,E)}}}function se(n,e,i){return void 0!==n?n:void 0!==e?e:void 0!==i?i:void 0}function Z(n,e,i,s,d){return se(typeof i===d?s[i]:void 0,n.default,e.default)}function _e(n,e,i){if("number"!==mr(i))return se(n.default,e.default);const s=n.stops.length;if(1===s||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[s-1][0])return n.stops[s-1][1];const d=Bn(n.stops.map(f=>f[0]),i);return n.stops[d][1]}function pt(n,e,i){const s=void 0!==n.base?n.base:1;if("number"!==mr(i))return se(n.default,e.default);const d=n.stops.length;if(1===d||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[d-1][0])return n.stops[d-1][1];const f=Bn(n.stops.map(R=>R[0]),i),m=function(R,N,$,X){const ne=X-$,he=R-$;return 0===ne?0:1===N?he/ne:(Math.pow(N,he)-1)/(Math.pow(N,ne)-1)}(i,s,n.stops[f][0],n.stops[f+1][0]),v=n.stops[f][1],E=n.stops[f+1][1];let C=Vr[e.type]||cl;if(n.colorSpace&&"rgb"!==n.colorSpace){const R=nl[n.colorSpace];C=(N,$)=>R.reverse(R.interpolate(R.forward(N),R.forward($),m))}return"function"==typeof v.evaluate?{evaluate(...R){const N=v.evaluate.apply(void 0,R),$=E.evaluate.apply(void 0,R);if(void 0!==N&&void 0!==$)return C(N,$,m)}}:C(v,E,m)}function En(n,e,i){return"color"===e.type?i=Or.parse(i):"formatted"===e.type?i=dr.fromString(i.toString()):"resolvedImage"===e.type?i=ns.fromString(i.toString()):mr(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),se(i,n.default,e.default)}class kn{constructor(e,i){var s;this.expression=e,this._warningHistory={},this._evaluator=new Ps,this._defaultValue=i?"color"===(s=i).type&&(Ia(s.default)||Array.isArray(s.default))?new Or(0,0,0,0):"color"===s.type?Or.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,s,d,f,m,v,E){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=d||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,s,d,f,m,v,E){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=E||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new io(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function wi(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in Aa}function br(n,e){const i=new Ke(Aa,[],e?function(d){const f={color:Fr,string:Ri,number:Kn,enum:Ri,boolean:bi,formatted:$i,resolvedImage:Eo};return"array"===d.type?Br(f[d.value]||Pi,d.length):f[d.type]}(e):void 0),s=i.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?lc(new kn(s,e)):as(i.errors)}class xr{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!$s(i.expression)}evaluateWithoutErrorHandling(e,i,s,d,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,d,f,m)}evaluate(e,i,s,d,f,m){return this._styleExpression.evaluate(e,i,s,d,f,m)}}class Er{constructor(e,i,s,d){this.kind=e,this.zoomStops=s,this._styleExpression=i,this.isStateDependent="camera"!==e&&!$s(i.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,i,s,d,f,m){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,d,f,m)}evaluate(e,i,s,d,f,m){return this._styleExpression.evaluate(e,i,s,d,f,m)}interpolationFactor(e,i,s){return this.interpolationType?os.interpolationFactor(this.interpolationType,e,i,s):0}}function Xi(n,e){if("error"===(n=br(n,e)).result)return n;const i=n.value.expression,s=co(i);if(!s&&!Ha(e))return as([new Pr("","data expressions not supported")]);const d=xs(i,["zoom","pitch","distance-from-center"]);if(!d&&!Ga(e))return as([new Pr("","zoom expressions not supported")]);const f=hr(i);return f||d?f instanceof Pr?as([f]):f instanceof os&&!cc(e)?as([new Pr("",'"interpolate" expressions cannot be used with this property')]):lc(f?new Er(s?"camera":"composite",n.value,f.labels,f instanceof os?f.interpolation:void 0):new xr(s?"constant":"source",n.value)):as([new Pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yr{constructor(e,i){this._parameters=e,this._specification=i,qr(this,U(this._parameters,this._specification))}static deserialize(e){return new Yr(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function hr(n){let e=null;if(n instanceof Vc)e=hr(n.result);else if(n instanceof il){for(const i of n.args)if(e=hr(i),e)break}else(n instanceof si||n instanceof os)&&n.input instanceof rs&&"zoom"===n.input.name&&(e=n);return e instanceof Pr||n.eachChild(i=>{const s=hr(i);s instanceof Pr?e=s:!e&&s?e=new Pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Hn{constructor(e,i,s,d){this.message=(e?`${e}: `:"")+s,d&&(this.identifier=d),null!=i&&i.__line__&&(this.line=i.__line__)}}function Kr(n){const e=n.key,i=n.value,s=n.valueSpec||{},d=n.objectElementValidators||{},f=n.style,m=n.styleSpec;let v=[];const E=mr(i);if("object"!==E)return[new Hn(e,i,`object expected, ${E} found`)];for(const C in i){const R=C.split(".")[0];let $;d[R]?$=d[R]:s[R]?$=Je:d["*"]?$=d["*"]:s["*"]&&($=Je),$?v=v.concat($({key:(e&&`${e}.`)+C,value:i[C],valueSpec:s[R]||s["*"],style:f,styleSpec:m,object:i,objectKey:C},i)):v.push(new Hn(e,i[C],`unknown property "${C}"`))}for(const C in s)d[C]||s[C].required&&void 0===s[C].default&&void 0===i[C]&&v.push(new Hn(e,i,`missing required property "${C}"`));return v}function vo(n){const e=n.value,i=n.valueSpec,s=n.style,d=n.styleSpec,f=n.key,m=n.arrayElementValidator||Je;if("array"!==mr(e))return[new Hn(f,e,`array expected, ${mr(e)} found`)];if(i.length&&e.length!==i.length)return[new Hn(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Hn(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let v={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};d.$version<7&&(v.function=i.function),"object"===mr(i.value)&&(v=i.value);let E=[];for(let C=0;C<e.length;C++)E=E.concat(m({array:e,arrayIndex:C,value:e[C],valueSpec:v,style:s,styleSpec:d,key:`${f}[${C}]`}));return E}function Fs(n){const e=n.key,i=n.value,s=n.valueSpec;let d=mr(i);if("number"===d&&i!=i&&(d="NaN"),"number"!==d)return[new Hn(e,i,`number expected, ${d} found`)];if("minimum"in s){let f=s.minimum;if("array"===mr(s.minimum)&&(f=s.minimum[n.arrayIndex]),i<f)return[new Hn(e,i,`${i} is less than the minimum value ${f}`)]}if("maximum"in s){let f=s.maximum;if("array"===mr(s.maximum)&&(f=s.maximum[n.arrayIndex]),i>f)return[new Hn(e,i,`${i} is greater than the maximum value ${f}`)]}return[]}function Fo(n){const e=n.valueSpec,i=Lr(n.value.type);let s,d,f,m={};const v="categorical"!==i&&void 0===n.value.property,E=!v,C="array"===mr(n.value.stops)&&"array"===mr(n.value.stops[0])&&"object"===mr(n.value.stops[0][0]),R=Kr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(X){if("identity"===i)return[new Hn(X.key,X.value,'identity function may not have a "stops" property')];let ne=[];const he=X.value;return ne=ne.concat(vo({key:X.key,value:he,valueSpec:X.valueSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:N})),"array"===mr(he)&&0===he.length&&ne.push(new Hn(X.key,he,"array must have at least one stop")),ne},default:function(X){return Je({key:X.key,value:X.value,valueSpec:e,style:X.style,styleSpec:X.styleSpec})}}});return"identity"===i&&v&&R.push(new Hn(n.key,n.value,'missing required property "property"')),"identity"===i||n.value.stops||R.push(new Hn(n.key,n.value,'missing required property "stops"')),"exponential"===i&&n.valueSpec.expression&&!cc(n.valueSpec)&&R.push(new Hn(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(E&&!Ha(n.valueSpec)?R.push(new Hn(n.key,n.value,"property functions not supported")):v&&!Ga(n.valueSpec)&&R.push(new Hn(n.key,n.value,"zoom functions not supported"))),"categorical"!==i&&!C||void 0!==n.value.property||R.push(new Hn(n.key,n.value,'"property" property is required')),R;function N(X){let ne=[];const he=X.value,Pe=X.key;if("array"!==mr(he))return[new Hn(Pe,he,`array expected, ${mr(he)} found`)];if(2!==he.length)return[new Hn(Pe,he,`array length 2 expected, length ${he.length} found`)];if(C){if("object"!==mr(he[0]))return[new Hn(Pe,he,`object expected, ${mr(he[0])} found`)];if(void 0===he[0].zoom)return[new Hn(Pe,he,"object stop key must have zoom")];if(void 0===he[0].value)return[new Hn(Pe,he,"object stop key must have value")];const Xe=Lr(he[0].zoom);if("number"!=typeof Xe)return[new Hn(Pe,he[0].zoom,"stop zoom values must be numbers")];if(f&&f>Xe)return[new Hn(Pe,he[0].zoom,"stop zoom values must appear in ascending order")];Xe!==f&&(f=Xe,d=void 0,m={}),ne=ne.concat(Kr({key:`${Pe}[0]`,value:he[0],valueSpec:{zoom:{}},style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Fs,value:$}}))}else ne=ne.concat($({key:`${Pe}[0]`,value:he[0],valueSpec:{},style:X.style,styleSpec:X.styleSpec},he));return wi(Ro(he[1]))?ne.concat([new Hn(`${Pe}[1]`,he[1],"expressions are not allowed in function stops.")]):ne.concat(Je({key:`${Pe}[1]`,value:he[1],valueSpec:e,style:X.style,styleSpec:X.styleSpec}))}function $(X,ne){const he=mr(X.value),Pe=Lr(X.value),Xe=null!==X.value?X.value:ne;if(s){if(he!==s)return[new Hn(X.key,Xe,`${he} stop domain type must match previous stop domain type ${s}`)]}else s=he;if("number"!==he&&"string"!==he&&"boolean"!==he&&"number"!=typeof Pe&&"string"!=typeof Pe&&"boolean"!=typeof Pe)return[new Hn(X.key,Xe,"stop domain value must be a number, string, or boolean")];if("number"!==he&&"categorical"!==i){let gt=`number expected, ${he} found`;return Ha(e)&&void 0===i&&(gt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Hn(X.key,Xe,gt)]}return"categorical"!==i||"number"!==he||"number"==typeof Pe&&isFinite(Pe)&&Math.floor(Pe)===Pe?"categorical"!==i&&"number"===he&&"number"==typeof Pe&&"number"==typeof d&&void 0!==d&&Pe<d?[new Hn(X.key,Xe,"stop domain values must appear in ascending order")]:(d=Pe,"categorical"===i&&Pe in m?[new Hn(X.key,Xe,"stop domain values must be unique")]:(m[Pe]=!0,[])):[new Hn(X.key,Xe,`integer expected, found ${String(Pe)}`)]}}function Go(n){const e=("property"===n.expressionContext?Xi:br)(Ro(n.value),n.valueSpec);if("error"===e.result)return e.value.map(s=>new Hn(`${n.key}${s.key}`,n.value,s.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!i.outputDefined())return[new Hn(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!$s(i))return[new Hn(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return oa(i,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!xs(i,["zoom","feature-state"]))return[new Hn(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!co(i))return[new Hn(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oa(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const d of e.valueSpec.expression.parameters)i.delete(d);if(0===i.size)return[];const s=[];return n instanceof rs&&i.has(n.name)?[new Hn(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(d=>{s.push(...oa(d,e))}),s)}function Cs(n){const e=n.key,i=n.value,s=n.valueSpec,d=[];return Array.isArray(s.values)?-1===s.values.indexOf(Lr(i))&&d.push(new Hn(e,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(s.values).indexOf(Lr(i))&&d.push(new Hn(e,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),d}function $a(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!$a(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function sa(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};$a(n)||(n=Pa(n));const i=n;let s=!0;try{s=function(C){if(!ms(C))return C;let R=Ro(C);return bl(R),R=Bs(R),R}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const d=pn[`filter_${e}`],f=br(s,d);let m=null;if("error"===f.result)throw new Error(f.value.map(C=>`${C.key}: ${C.message}`).join(", "));m=(C,R,N)=>f.value.evaluate(C,R,{},N);let v=null,E=null;if(s!==i){const C=br(i,d);if("error"===C.result)throw new Error(C.value.map(R=>`${R.key}: ${R.message}`).join(", "));v=(R,N,$,X,ne)=>C.value.evaluate(R,N,{},$,void 0,void 0,X,ne),E=!co(C.value.expression)}return{filter:m,dynamicFilter:v||void 0,needGeometry:Za(s),needFeature:!!E}}function Bs(n){if(!Array.isArray(n))return n;const e=function(i){if(ru.has(i[0]))for(let s=1;s<i.length;s++)if(ms(i[s]))return!0;return i}(n);return!0===e?e:e.map(i=>Bs(i))}function bl(n){let e=!1;const i=[];if("case"===n[0]){for(let s=1;s<n.length-1;s+=2)e=e||ms(n[s]),i.push(n[s+1]);i.push(n[n.length-1])}else if("match"===n[0]){e=e||ms(n[1]);for(let s=2;s<n.length-1;s+=2)i.push(n[s+1]);i.push(n[n.length-1])}else if("step"===n[0]){e=e||ms(n[1]);for(let s=1;s<n.length-1;s+=2)i.push(n[s+1])}e&&(n.length=0,n.push("any",...i));for(let s=1;s<n.length;s++)bl(n[s])}function ms(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<n.length;i++)if(ms(n[i]))return!0;return!1}const ru=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ya(n,e){return n<e?-1:n>e?1:0}function Za(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(Za(n[e]))return!0;return!1}function Pa(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?Wa(n[1],n[2],"=="):"!="===e?Do(Wa(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Wa(n[1],n[2],e):"any"===e?(i=n.slice(1),["any"].concat(i.map(Pa))):"all"===e?["all"].concat(n.slice(1).map(Pa)):"none"===e?["all"].concat(n.slice(1).map(Pa).map(Do)):"in"===e?zl(n[1],n.slice(2)):"!in"===e?Do(zl(n[1],n.slice(2))):"has"===e?uc(n[1]):"!has"===e?Do(uc(n[1])):"within"!==e||n;var i}function Wa(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function zl(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(ya)]]:["filter-in-small",n,["literal",e]]}}function uc(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Do(n){return["!",n]}function xl(n){return $a(Ro(n.value))?Go(qr({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):wl(n)}function wl(n){const e=n.value,i=n.key;if("array"!==mr(e))return[new Hn(i,e,`array expected, ${mr(e)} found`)];const s=n.styleSpec;let d,f=[];if(e.length<1)return[new Hn(i,e,"filter array must have at least 1 element")];switch(f=f.concat(Cs({key:`${i}[0]`,value:e[0],valueSpec:s.filter_operator,style:n.style,styleSpec:n.styleSpec})),Lr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===Lr(e[1])&&f.push(new Hn(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new Hn(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=mr(e[1]),"string"!==d&&f.push(new Hn(`${i}[1]`,e[1],`string expected, ${d} found`)));for(let m=2;m<e.length;m++)d=mr(e[m]),"$type"===Lr(e[1])?f=f.concat(Cs({key:`${i}[${m}]`,value:e[m],valueSpec:s.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&f.push(new Hn(`${i}[${m}]`,e[m],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)f=f.concat(wl({key:`${i}[${m}]`,value:e[m],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":d=mr(e[1]),2!==e.length?f.push(new Hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==d&&f.push(new Hn(`${i}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=mr(e[1]),2!==e.length?f.push(new Hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==d&&f.push(new Hn(`${i}[1]`,e[1],`object expected, ${d} found`))}return f}function El(n,e){const i=n.key,s=n.style,d=n.styleSpec,f=n.value,m=n.objectKey,v=d[`${e}_${n.layerType}`];if(!v)return[];const E=m.match(/^(.*)-transition$/);if("paint"===e&&E&&v[E[1]]&&v[E[1]].transition)return Je({key:i,value:f,valueSpec:d.transition,style:s,styleSpec:d});const C=n.valueSpec||v[m];if(!C)return[new Hn(i,f,`unknown property "${m}"`)];let R;if("string"===mr(f)&&Ha(C)&&!C.tokens&&(R=/^{([^}]+)}$/.exec(f)))return[new Hn(i,f,`"${m}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const N=[];return"symbol"===n.layerType&&("text-field"===m&&s&&!s.glyphs&&N.push(new Hn(i,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===m&&Ia(Ro(f))&&"identity"===Lr(f.type)&&N.push(new Hn(i,f,'"text-font" does not support identity functions'))),N.concat(Je({key:n.key,value:f,valueSpec:C,style:s,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:m}))}function Ul(n){return El(n,"paint")}function dc(n){return El(n,"layout")}function hc(n){let e=[];const i=n.value,s=n.key,d=n.style,f=n.styleSpec;i.type||i.ref||e.push(new Hn(s,i,'either "type" or "ref" is required'));let m=Lr(i.type);const v=Lr(i.ref);if(i.id){const E=Lr(i.id);for(let C=0;C<n.arrayIndex;C++){const R=d.layers[C];Lr(R.id)===E&&e.push(new Hn(s,i.id,`duplicate layer id "${i.id}", previously used at line ${R.id.__line__}`))}}if("ref"in i){let E;["type","source","source-layer","filter","layout"].forEach(C=>{C in i&&e.push(new Hn(s,i[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{Lr(C.id)===v&&(E=C)}),E?E.ref?e.push(new Hn(s,i.ref,"ref cannot reference another ref layer")):m=Lr(E.type):"string"==typeof v&&e.push(new Hn(s,i.ref,`ref layer "${v}" not found`))}else if("background"!==m&&"sky"!==m)if(i.source){const E=d.sources&&d.sources[i.source],C=E&&Lr(E.type);E?"vector"===C&&"raster"===m?e.push(new Hn(s,i.source,`layer "${i.id}" requires a raster source`)):"raster"===C&&"raster"!==m?e.push(new Hn(s,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==C||i["source-layer"]?"raster-dem"===C&&"hillshade"!==m?e.push(new Hn(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==m||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===C&&E.lineMetrics||e.push(new Hn(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Hn(s,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Hn(s,i.source,`source "${i.source}" not found`))}else e.push(new Hn(s,i,'missing required property "source"'));return e=e.concat(Kr({key:s,value:i,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Je({key:`${s}.type`,value:i.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:E=>xl(qr({layerType:m},E)),layout:E=>Kr({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>dc(qr({layerType:m},C))}}),paint:E=>Kr({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>Ul(qr({layerType:m},C))}})}})),e}function aa(n){const e=n.value,i=n.key,s=mr(e);return"string"!==s?[new Hn(i,e,`string expected, ${s} found`)]:[]}const Oa={promoteId:function({key:n,value:e}){if("string"===mr(e))return aa({key:n,value:e});{const i=[];for(const s in e)i.push(...aa({key:`${n}.${s}`,value:e[s]}));return i}}};function K(n){const e=n.value,i=n.key,s=n.styleSpec,d=n.style;if(!e.type)return[new Hn(i,e,'"type" is required')];const f=Lr(e.type);let m;switch(f){case"vector":case"raster":case"raster-dem":return m=Kr({key:i,value:e,valueSpec:s[`source_${f.replace("-","_")}`],style:n.style,styleSpec:s,objectElementValidators:Oa}),m;case"geojson":if(m=Kr({key:i,value:e,valueSpec:s.source_geojson,style:d,styleSpec:s,objectElementValidators:Oa}),e.cluster)for(const v in e.clusterProperties){const[E,C]=e.clusterProperties[v],R="string"==typeof E?[E,["accumulated"],["get",v]]:E;m.push(...Go({key:`${i}.${v}.map`,value:C,expressionContext:"cluster-map"})),m.push(...Go({key:`${i}.${v}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return m;case"video":return Kr({key:i,value:e,valueSpec:s.source_video,style:d,styleSpec:s});case"image":return Kr({key:i,value:e,valueSpec:s.source_image,style:d,styleSpec:s});case"canvas":return[new Hn(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Cs({key:`${i}.type`,value:e.type,valueSpec:{values:S(s)},style:d,styleSpec:s})}}function S(n){return n.source.reduce((e,i)=>{const s=n[i];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function T(n){const e=n.value,i=n.styleSpec,s=i.light,d=n.style;let f=[];const m=mr(e);if(void 0===e)return f;if("object"!==m)return f=f.concat([new Hn("light",e,`object expected, ${m} found`)]),f;for(const v in e){const E=v.match(/^(.*)-transition$/);f=f.concat(E&&s[E[1]]&&s[E[1]].transition?Je({key:v,value:e[v],valueSpec:i.transition,style:d,styleSpec:i}):s[v]?Je({key:v,value:e[v],valueSpec:s[v],style:d,styleSpec:i}):[new Hn(v,e[v],`unknown property "${v}"`)])}return f}function V(n){const e=n.value,i=n.key,s=n.style,d=n.styleSpec,f=d.terrain;let m=[];const v=mr(e);if(void 0===e)return m;if("object"!==v)return m=m.concat([new Hn("terrain",e,`object expected, ${v} found`)]),m;for(const E in e){const C=E.match(/^(.*)-transition$/);m=m.concat(C&&f[C[1]]&&f[C[1]].transition?Je({key:E,value:e[E],valueSpec:d.transition,style:s,styleSpec:d}):f[E]?Je({key:E,value:e[E],valueSpec:f[E],style:s,styleSpec:d}):[new Hn(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=s.sources&&s.sources[e.source],C=E&&Lr(E.type);E?"raster-dem"!==C&&m.push(new Hn(i,e.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):m.push(new Hn(i,e.source,`source "${e.source}" not found`))}else m.push(new Hn(i,e,'terrain is missing required property "source"'));return m}function ie(n){const e=n.value,i=n.style,s=n.styleSpec,d=s.fog;let f=[];const m=mr(e);if(void 0===e)return f;if("object"!==m)return f=f.concat([new Hn("fog",e,`object expected, ${m} found`)]),f;for(const v in e){const E=v.match(/^(.*)-transition$/);f=f.concat(E&&d[E[1]]&&d[E[1]].transition?Je({key:v,value:e[v],valueSpec:s.transition,style:i,styleSpec:s}):d[v]?Je({key:v,value:e[v],valueSpec:d[v],style:i,styleSpec:s}):[new Hn(v,e[v],`unknown property "${v}"`)])}return f}const Oe={"*":()=>[],array:vo,boolean:function(n){const e=n.value,i=n.key,s=mr(e);return"boolean"!==s?[new Hn(i,e,`boolean expected, ${s} found`)]:[]},number:Fs,color:function(n){const e=n.key,i=n.value,s=mr(i);return"string"!==s?[new Hn(e,i,`color expected, ${s} found`)]:null===Vo(i)?[new Hn(e,i,`color expected, "${i}" found`)]:[]},enum:Cs,filter:xl,function:Fo,layer:hc,object:Kr,source:K,light:T,terrain:V,fog:ie,string:aa,formatted:function(n){return 0===aa(n).length?[]:Go(n)},resolvedImage:function(n){return 0===aa(n).length?[]:Go(n)},projection:function(n){const e=n.value,i=n.styleSpec,s=i.projection,d=n.style;let f=[];const m=mr(e);if("object"===m)for(const v in e)f=f.concat(Je({key:v,value:e[v],valueSpec:s[v],style:d,styleSpec:i}));else"string"!==m&&(f=f.concat([new Hn("projection",e,`object or string expected, ${m} found`)]));return f}};function Je(n){const e=n.value,i=n.valueSpec,s=n.styleSpec;return i.expression&&Ia(Lr(e))?Fo(n):i.expression&&wi(Ro(e))?Go(n):i.type&&Oe[i.type]?Oe[i.type](n):Kr(qr({},n,{valueSpec:i.type?s[i.type]:i}))}function Ot(n){const e=n.value,i=n.key,s=aa(n);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new Hn(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new Hn(i,e,'"glyphs" url must include a "{range}" token'))),s}function hn(n,e=pn){return ui(Je({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Ot,"*":()=>[]}}))}const On=n=>ui(Ul(n)),ri=n=>ui(dc(n));function ui(n){return n.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function ar(n,e){let i=!1;if(e&&e.length)for(const s of e)n.fire(new kr(new Error(s.message))),i=!0;return i}var nr=Ti;function Ti(n,e,i){var s=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var d=new Int32Array(this.arrayBuffer);n=d[0],this.d=(e=d[1])+2*(i=d[2]);for(var f=0;f<this.d*this.d;f++){var m=d[3+f],v=d[3+f+1];s.push(m===v?null:d.subarray(m,v))}var E=d[3+s.length+1];this.keys=d.subarray(d[3+s.length],E),this.bboxes=d.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var C=0;C<this.d*this.d;C++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var R=i/e*n;this.min=-R,this.max=n+R}Ti.prototype.insert=function(n,e,i,s,d){this._forEachCell(e,i,s,d,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(d)},Ti.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ti.prototype._insertCell=function(n,e,i,s,d,f){this.cells[d].push(f)},Ti.prototype.query=function(n,e,i,s,d){var f=this.min,m=this.max;if(n<=f&&e<=f&&m<=i&&m<=s&&!d)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(n,e,i,s,this._queryCell,v,{},d),v},Ti.prototype._queryCell=function(n,e,i,s,d,f,m,v){var E=this.cells[d];if(null!==E)for(var C=this.keys,R=this.bboxes,N=0;N<E.length;N++){var $=E[N];if(void 0===m[$]){var X=4*$;(v?v(R[X+0],R[X+1],R[X+2],R[X+3]):n<=R[X+2]&&e<=R[X+3]&&i>=R[X+0]&&s>=R[X+1])?(m[$]=!0,f.push(C[$])):m[$]=!1}}},Ti.prototype._forEachCell=function(n,e,i,s,d,f,m,v){for(var E=this._convertToCellCoord(n),C=this._convertToCellCoord(e),R=this._convertToCellCoord(i),N=this._convertToCellCoord(s),$=E;$<=R;$++)for(var X=C;X<=N;X++){var ne=this.d*X+$;if((!v||v(this._convertFromCellCoord($),this._convertFromCellCoord(X),this._convertFromCellCoord($+1),this._convertFromCellCoord(X+1)))&&d.call(this,n,e,i,s,ne,f,m,v))return}},Ti.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},Ti.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},Ti.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var d=new Int32Array(e+i+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var f=e,m=0;m<n.length;m++){var v=n[m];d[3+m]=f,d.set(v,f),f+=v.length}return d[3+n.length]=f,d.set(this.keys,f),d[3+n.length+1]=f+=this.keys.length,d.set(this.bboxes,f),f+=this.bboxes.length,d.buffer};const Zi={};function Wn(n,e,i={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),Zi[e]={klass:n,omit:i.omit||[]}}Wn(Object,"Object"),nr.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},nr.deserialize=function(n){return new nr(n.buffer)},Object.defineProperty(nr,"name",{value:"Grid"}),Wn(nr,"Grid"),Wn(Or,"Color"),Wn(Error,"Error"),Wn(Ae,"AJAXError"),Wn(ns,"ResolvedImage"),Wn(Yr,"StylePropertyFunction"),Wn(kn,"StyleExpression",{omit:["_evaluator"]}),Wn(Er,"ZoomDependentExpression"),Wn(xr,"ZoomConstantExpression"),Wn(rs,"CompoundExpression",{omit:["_evaluate"]});for(const n in Aa)Zi[Aa[n]._classRegistryKey]||Wn(Aa[n],`Expression${n}`);function Xr(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function or(n){return de.ImageBitmap&&n instanceof de.ImageBitmap}function To(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Xr(n)||or(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof de.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const s of n)i.push(To(s,e));return i}if("object"==typeof n){const i=n.constructor,s=i._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const d=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const f in n)n.hasOwnProperty(f)&&(Zi[s].omit.indexOf(f)>=0||(d[f]=To(n[f],e)));n instanceof Error&&(d.message=n.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(d.$name=s),d}throw new Error("can't serialize object of type "+typeof n)}function Bo(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Xr(n)||or(n)||ArrayBuffer.isView(n)||n instanceof de.ImageData)return n;if(Array.isArray(n))return n.map(Bo);if("object"==typeof n){const e=n.$name||"Object",{klass:i}=Zi[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const s=Object.create(i.prototype);for(const d of Object.keys(n))"$name"!==d&&(s[d]=Bo(n[d]));return s}throw new Error("can't deserialize object of type "+typeof n)}const Cl=n=>n>=1536&&n<=1791,Ra=n=>n>=1872&&n<=1919,Po=n=>n>=2208&&n<=2303,ka=n=>n>=11904&&n<=12031,la=n=>n>=12032&&n<=12255,gs=n=>n>=12272&&n<=12287,Ml=n=>n>=12288&&n<=12351,qa=n=>n>=12352&&n<=12447,Hr=n=>n>=12448&&n<=12543,Vl=n=>n>=12544&&n<=12591,Ya=n=>n>=12704&&n<=12735,Si=n=>n>=12736&&n<=12783,Di=n=>n>=12784&&n<=12799,Ni=n=>n>=12800&&n<=13055,Mr=n=>n>=13056&&n<=13311,So=n=>n>=13312&&n<=19903,P=n=>n>=19968&&n<=40959,k=n=>n>=40960&&n<=42127,D=n=>n>=42128&&n<=42191,z=n=>n>=44032&&n<=55215,ee=n=>n>=63744&&n<=64255,u=n=>n>=64336&&n<=65023,t=n=>n>=65040&&n<=65055,l=n=>n>=65072&&n<=65103,p=n=>n>=65104&&n<=65135,_=n=>n>=65136&&n<=65279,b=n=>n>=65280&&n<=65519;function M(n){for(const e of n)if(q(e.charCodeAt(0)))return!0;return!1}function O(n){for(const e of n)if(!F(e.charCodeAt(0)))return!1;return!0}function F(n){return!(Cl(n)||Ra(n)||Po(n)||u(n)||_(n))}function q(n){return!(746!==n&&747!==n&&(n<4352||!(Ya(n)||Vl(n)||l(n)&&!(n>=65097&&n<=65103)||ee(n)||Mr(n)||ka(n)||Si(n)||!(!Ml(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||So(n)||P(n)||Ni(n)||(e=n,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||z(n)||qa(n)||gs(n)||(e=>e>=12688&&e<=12703)(n)||la(n)||Di(n)||Hr(n)&&12540!==n||!(!b(n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!p(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||t(n)||(e=>e>=19904&&e<=19967)(n)||k(n)||D(n))));var e}function W(n){return!(q(n)||(e=n,(i=e)>=128&&i<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(i=>i>=8192&&i<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&9251!==e||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ml(e)||Hr(e)||(i=>i>=57344&&i<=63743)(e)||l(e)||p(e)||b(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,i}function re(n){return n>=1424&&n<=2303||u(n)||_(n)}function we(n,e){return!(!e&&re(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=n,i>=6016&&i<=6143));var i}function Ue(n){for(const e of n)if(re(e.charCodeAt(0)))return!0;return!1}const Be="deferred",je="loading",Ie="loaded";let Le=null,Ze="unavailable",He=null;const st=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(Ze="error"),Le&&Le(n)};function St(){Mt.fire(new Ki("pluginStateChange",{pluginStatus:Ze,pluginURL:He}))}const Mt=new Cr,jt=function(){return Ze},un=function(){if(Ze!==Be||!He)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ze=je,St(),He&&ln({url:He},n=>{n?st(n):(Ze=Ie,St())})},rn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ze===Ie||null!=rn.applyArabicShaping,isLoading:()=>Ze===je,setState(n){Ze=n.pluginStatus,He=n.pluginURL},isParsed:()=>null!=rn.applyArabicShaping&&null!=rn.processBidirectionalText&&null!=rn.processStyledBidirectionalText,getPluginURL:()=>He};class Wt{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,s){for(const d of i)if(!we(d.charCodeAt(0),s))return!1;return!0}(e,rn.isLoaded())}}class Xn{constructor(e,i){this.property=e,this.value=i,this.expression=function(s,d){if(Ia(s))return new Yr(s,d);if(wi(s)){const f=Xi(s,d);if("error"===f.result)throw new Error(f.value.map(m=>`${m.key}: ${m.message}`).join(", "));return f.value}{let f=s;return"string"==typeof s&&"color"===d.type&&(f=Or.parse(s)),{kind:"constant",evaluate:()=>f}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,s){return this.property.possiblyEvaluate(this,e,i,s)}}class tn{constructor(e){this.property=e,this.value=new Xn(e,void 0)}transitioned(e,i){return new _n(this.property,this.value,i,Nn({},e.transition,this.transition),e.now)}untransitioned(){return new _n(this.property,this.value,null,{},0)}}class In{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ve(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new tn(this._values[e].property)),this._values[e].value=new Xn(this._values[e].property,null===i?void 0:ve(i))}getTransition(e){return ve(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new tn(this._values[e].property)),this._values[e].transition=ve(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);void 0!==s&&(e[i]=s);const d=this.getTransition(i);void 0!==d&&(e[`${i}-transition`]=d)}return e}transitioned(e,i){const s=new $n(this._properties);for(const d of Object.keys(this._values))s._values[d]=this._values[d].transitioned(e,i._values[d]);return s}untransitioned(){const e=new $n(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class _n{constructor(e,i,s,d,f){const m=d.delay||0,v=d.duration||0;f=f||0,this.property=e,this.value=i,this.begin=f+m,this.end=this.begin+v,e.specification.transition&&(d.delay||d.duration)&&(this.prior=s)}possiblyEvaluate(e,i,s){const d=e.now||0,f=this.value.possiblyEvaluate(e,i,s),m=this.prior;if(m){if(d>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(d<this.begin)return m.possiblyEvaluate(e,i,s);{const v=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,i,s),f,It(v))}}return f}}class $n{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,s){const d=new qn(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(e,i,s);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class xn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ve(this._values[e].value)}setValue(e,i){this._values[e]=new Xn(this._values[e].property,null===i?void 0:ve(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);void 0!==s&&(e[i]=s)}return e}possiblyEvaluate(e,i,s){const d=new qn(this._properties);for(const f of Object.keys(this._values))d._values[f]=this._values[f].possiblyEvaluate(e,i,s);return d}}class zn{constructor(e,i,s){this.property=e,this.value=i,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,s,d){return this.property.evaluate(this.value,this.parameters,e,i,s,d)}}class qn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class qt{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,s){const d=Vr[this.specification.type];return d?d(e,i,s):e}}class gn{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,s,d){return new zn(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},s,d)}:e.expression,i)}interpolate(e,i,s){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new zn(this,{kind:"constant",value:void 0},e.parameters);const d=Vr[this.specification.type];return d?new zn(this,{kind:"constant",value:d(e.value.value,i.value.value,s)},e.parameters):e}evaluate(e,i,s,d,f,m){return"constant"===e.kind?e.value:e.evaluate(i,s,d,f,m)}}class _i{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,d){return!!e.expression.evaluate(i,null,{},s,d)}interpolate(){return!1}}class ki{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new Wt(0,{});for(const s in e){const d=e[s];d.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new Xn(d,void 0),m=this.defaultTransitionablePropertyValues[s]=new tn(d);this.defaultTransitioningPropertyValues[s]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate(i)}}}function yi(n,e){return 256*(n=Yt(Math.floor(n),0,255))+Yt(Math.floor(e),0,255)}Wn(gn,"DataDrivenProperty"),Wn(qt,"DataConstantProperty"),Wn(_i,"ColorRampProperty");const Wi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cr{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Oi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function di(n,e=1){let i=0,s=0;return{members:n.map(d=>{const f=Wi[d.type].BYTES_PER_ELEMENT,m=i=Qr(i,Math.max(e,f)),v=d.components||1;return s=Math.max(s,f),i+=f*v,{name:d.name,type:d.type,components:v,offset:m}}),size:Qr(i,Math.max(s,e)),alignment:e}}function Qr(n,e){return Math.ceil(n/e)*e}class zr extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const d=2*e;return this.int16[d+0]=i,this.int16[d+1]=s,e}}zr.prototype.bytesPerElement=4,Wn(zr,"StructArrayLayout2i4");class Gr extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,s)}emplace(e,i,s,d){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=s,this.int16[f+2]=d,e}}Gr.prototype.bytesPerElement=6,Wn(Gr,"StructArrayLayout3i6");class oo extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,d)}emplace(e,i,s,d,f){const m=4*e;return this.int16[m+0]=i,this.int16[m+1]=s,this.int16[m+2]=d,this.int16[m+3]=f,e}}oo.prototype.bytesPerElement=8,Wn(oo,"StructArrayLayout4i8");class La extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,s,d,f,m,v)}emplace(e,i,s,d,f,m,v,E){const C=6*e,R=12*e,N=3*e;return this.int16[C+0]=i,this.int16[C+1]=s,this.uint8[R+4]=d,this.uint8[R+5]=f,this.uint8[R+6]=m,this.uint8[R+7]=v,this.float32[N+2]=E,e}}La.prototype.bytesPerElement=12,Wn(La,"StructArrayLayout2i4ub1f12");class Ka extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,d)}emplace(e,i,s,d,f){const m=4*e;return this.float32[m+0]=i,this.float32[m+1]=s,this.float32[m+2]=d,this.float32[m+3]=f,e}}Ka.prototype.bytesPerElement=16,Wn(Ka,"StructArrayLayout4f16");class va extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,d,f)}emplace(e,i,s,d,f,m){const v=6*e,E=3*e;return this.uint16[v+0]=i,this.uint16[v+1]=s,this.uint16[v+2]=d,this.uint16[v+3]=f,this.float32[E+2]=m,e}}va.prototype.bytesPerElement=12,Wn(va,"StructArrayLayout4ui1f12");class jl extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,d)}emplace(e,i,s,d,f){const m=4*e;return this.uint16[m+0]=i,this.uint16[m+1]=s,this.uint16[m+2]=d,this.uint16[m+3]=f,e}}jl.prototype.bytesPerElement=8,Wn(jl,"StructArrayLayout4ui8");class mo extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,s,d,f,m)}emplace(e,i,s,d,f,m,v){const E=6*e;return this.int16[E+0]=i,this.int16[E+1]=s,this.int16[E+2]=d,this.int16[E+3]=f,this.int16[E+4]=m,this.int16[E+5]=v,e}}mo.prototype.bytesPerElement=12,Wn(mo,"StructArrayLayout6i12");class Jr extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v,E,C,R,N,$){const X=this.length;return this.resize(X+1),this.emplace(X,e,i,s,d,f,m,v,E,C,R,N,$)}emplace(e,i,s,d,f,m,v,E,C,R,N,$,X){const ne=12*e;return this.int16[ne+0]=i,this.int16[ne+1]=s,this.int16[ne+2]=d,this.int16[ne+3]=f,this.uint16[ne+4]=m,this.uint16[ne+5]=v,this.uint16[ne+6]=E,this.uint16[ne+7]=C,this.int16[ne+8]=R,this.int16[ne+9]=N,this.int16[ne+10]=$,this.int16[ne+11]=X,e}}Jr.prototype.bytesPerElement=24,Wn(Jr,"StructArrayLayout4i4ui4i24");class Tr extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,i,s,d,f,m)}emplace(e,i,s,d,f,m,v){const E=10*e,C=5*e;return this.int16[E+0]=i,this.int16[E+1]=s,this.int16[E+2]=d,this.float32[C+2]=f,this.float32[C+3]=m,this.float32[C+4]=v,e}}Tr.prototype.bytesPerElement=20,Wn(Tr,"StructArrayLayout3i3f20");class No extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}No.prototype.bytesPerElement=4,Wn(No,"StructArrayLayout1ul4");class Ns extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v,E,C,R,N,$,X){const ne=this.length;return this.resize(ne+1),this.emplace(ne,e,i,s,d,f,m,v,E,C,R,N,$,X)}emplace(e,i,s,d,f,m,v,E,C,R,N,$,X,ne){const he=20*e,Pe=10*e;return this.int16[he+0]=i,this.int16[he+1]=s,this.int16[he+2]=d,this.int16[he+3]=f,this.int16[he+4]=m,this.float32[Pe+3]=v,this.float32[Pe+4]=E,this.float32[Pe+5]=C,this.float32[Pe+6]=R,this.int16[he+14]=N,this.uint32[Pe+8]=$,this.uint16[he+18]=X,this.uint16[he+19]=ne,e}}Ns.prototype.bytesPerElement=40,Wn(Ns,"StructArrayLayout5i4f1i1ul2ui40");class so extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,s,d,f,m,v)}emplace(e,i,s,d,f,m,v,E){const C=8*e;return this.int16[C+0]=i,this.int16[C+1]=s,this.int16[C+2]=d,this.int16[C+4]=f,this.int16[C+5]=m,this.int16[C+6]=v,this.int16[C+7]=E,e}}so.prototype.bytesPerElement=16,Wn(so,"StructArrayLayout3i2i2i16");class Oo extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,d,f)}emplace(e,i,s,d,f,m){const v=4*e,E=8*e;return this.float32[v+0]=i,this.float32[v+1]=s,this.float32[v+2]=d,this.int16[E+6]=f,this.int16[E+7]=m,e}}Oo.prototype.bytesPerElement=16,Wn(Oo,"StructArrayLayout2f1f2i16");class ou extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,d)}emplace(e,i,s,d,f){const m=12*e,v=3*e;return this.uint8[m+0]=i,this.uint8[m+1]=s,this.float32[v+1]=d,this.float32[v+2]=f,e}}ou.prototype.bytesPerElement=12,Wn(ou,"StructArrayLayout2ub2f12");class Hl extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,s)}emplace(e,i,s,d){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=s,this.float32[f+2]=d,e}}Hl.prototype.bytesPerElement=12,Wn(Hl,"StructArrayLayout3f12");class Ys extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,s)}emplace(e,i,s,d){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=s,this.uint16[f+2]=d,e}}Ys.prototype.bytesPerElement=6,Wn(Ys,"StructArrayLayout3ui6");class Fa extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt)}emplace(e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt,yt){const cn=30*e,on=15*e,Sn=60*e;return this.int16[cn+0]=i,this.int16[cn+1]=s,this.int16[cn+2]=d,this.float32[on+2]=f,this.float32[on+3]=m,this.uint16[cn+8]=v,this.uint16[cn+9]=E,this.uint32[on+5]=C,this.uint32[on+6]=R,this.uint32[on+7]=N,this.uint16[cn+16]=$,this.uint16[cn+17]=X,this.uint16[cn+18]=ne,this.float32[on+10]=he,this.float32[on+11]=Pe,this.uint8[Sn+48]=Xe,this.uint8[Sn+49]=gt,this.uint8[Sn+50]=We,this.uint32[on+13]=dt,this.int16[cn+28]=Dt,this.uint8[Sn+58]=yt,e}}Fa.prototype.bytesPerElement=60,Wn(Fa,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Xa extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln,Un){const Zn=this.length;return this.resize(Zn+1),this.emplace(Zn,e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln,Un)}emplace(e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe,Xe,gt,We,dt,Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln,Un,Zn){const vn=38*e,ti=19*e;return this.int16[vn+0]=i,this.int16[vn+1]=s,this.int16[vn+2]=d,this.float32[ti+2]=f,this.float32[ti+3]=m,this.int16[vn+8]=v,this.int16[vn+9]=E,this.int16[vn+10]=C,this.int16[vn+11]=R,this.int16[vn+12]=N,this.int16[vn+13]=$,this.uint16[vn+14]=X,this.uint16[vn+15]=ne,this.uint16[vn+16]=he,this.uint16[vn+17]=Pe,this.uint16[vn+18]=Xe,this.uint16[vn+19]=gt,this.uint16[vn+20]=We,this.uint16[vn+21]=dt,this.uint16[vn+22]=Dt,this.uint16[vn+23]=yt,this.uint16[vn+24]=cn,this.uint16[vn+25]=on,this.uint16[vn+26]=Sn,this.uint16[vn+27]=Gn,this.uint16[vn+28]=yn,this.uint32[ti+15]=Rn,this.float32[ti+16]=Ln,this.float32[ti+17]=Un,this.float32[ti+18]=Zn,e}}Xa.prototype.bytesPerElement=76,Wn(Xa,"StructArrayLayout3i2f6i15ui1ul3f76");class Dl extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}Dl.prototype.bytesPerElement=4,Wn(Dl,"StructArrayLayout1f4");class su extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,d,f){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,d,f)}emplace(e,i,s,d,f,m){const v=5*e;return this.float32[v+0]=i,this.float32[v+1]=s,this.float32[v+2]=d,this.float32[v+3]=f,this.float32[v+4]=m,e}}su.prototype.bytesPerElement=20,Wn(su,"StructArrayLayout5f20");class jc extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,d){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,s,d)}emplace(e,i,s,d,f){const m=6*e;return this.uint32[3*e+0]=i,this.uint16[m+2]=s,this.uint16[m+3]=d,this.uint16[m+4]=f,e}}jc.prototype.bytesPerElement=12,Wn(jc,"StructArrayLayout1ul3ui12");class ul extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const d=2*e;return this.uint16[d+0]=i,this.uint16[d+1]=s,e}}ul.prototype.bytesPerElement=4,Wn(ul,"StructArrayLayout2ui4");class wd extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}wd.prototype.bytesPerElement=2,Wn(wd,"StructArrayLayout1ui2");class uh extends Oi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const d=2*e;return this.float32[d+0]=i,this.float32[d+1]=s,e}}uh.prototype.bytesPerElement=8,Wn(uh,"StructArrayLayout2f8");class Ba extends cr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ba.prototype.size=40;class Ed extends Ns{get(e){return new Ba(this,e)}}Wn(Ed,"CollisionBoxArray");class dp extends cr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}dp.prototype.size=60;class dh extends Fa{get(e){return new dp(this,e)}}Wn(dh,"PlacedSymbolArray");class ca extends cr{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ca.prototype.size=76;class zu extends Xa{get(e){return new ca(this,e)}}Wn(zu,"SymbolInstanceArray");class hp extends Dl{getoffsetX(e){return this.float32[1*e+0]}}Wn(hp,"GlyphOffsetArray");class pp extends zr{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Wn(pp,"SymbolLineVertexArray");class Kf extends cr{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Kf.prototype.size=12;class fp extends jc{get(e){return new Kf(this,e)}}Wn(fp,"FeatureIndexArray");class Xf extends ul{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Wn(Xf,"FillExtrusionCentroidArray");const Qf=di([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Jg=di([{name:"a_dash",components:4,type:"Uint16"}]);var au={exports:{}},hh=function(n,e){var i,s,d,f,m,v,E,C;for(s=n.length-(i=3&n.length),d=e,m=3432918353,v=461845907,C=0;C<s;)E=255&n.charCodeAt(C)|(255&n.charCodeAt(++C))<<8|(255&n.charCodeAt(++C))<<16|(255&n.charCodeAt(++C))<<24,++C,d=27492+(65535&(f=5*(65535&(d=(d^=E=(65535&(E=(E=(65535&E)*m+(((E>>>16)*m&65535)<<16)&4294967295)<<15|E>>>17))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(E=0,i){case 3:E^=(255&n.charCodeAt(C+2))<<16;case 2:E^=(255&n.charCodeAt(C+1))<<8;case 1:d^=E=(65535&(E=(E=(65535&(E^=255&n.charCodeAt(C)))*m+(((E>>>16)*m&65535)<<16)&4294967295)<<15|E>>>17))*v+(((E>>>16)*v&65535)<<16)&4294967295}return d^=n.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0},mp=function(n,e){for(var i,s=n.length,d=e^s,f=0;s>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(f)|(255&n.charCodeAt(++f))<<8|(255&n.charCodeAt(++f))<<16|(255&n.charCodeAt(++f))<<24))+((1540483477*(i>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),s-=4,++f;switch(s){case 3:d^=(255&n.charCodeAt(f+2))<<16;case 2:d^=(255&n.charCodeAt(f+1))<<8;case 1:d=1540483477*(65535&(d^=255&n.charCodeAt(f)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};au.exports=hh,au.exports.murmur3=hh,au.exports.murmur2=mp;class ph{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,s,d){this.ids.push(Uu(e)),this.positions.push(i,s,d)}getPositions(e){const i=Uu(e);let s=0,d=this.ids.length-1;for(;s<d;){const m=s+d>>1;this.ids[m]>=i?d=m:s=m+1}const f=[];for(;this.ids[s]===i;)f.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return f}static serialize(e,i){const s=new Float64Array(e.ids),d=new Uint32Array(e.positions);return gp(s,d,0,s.length-1),i&&i.push(s.buffer,d.buffer),{ids:s,positions:d}}static deserialize(e){const i=new ph;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Uu(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:au.exports(String(n))}function gp(n,e,i,s){for(;i<s;){const d=n[i+s>>1];let f=i-1,m=s+1;for(;;){do{f++}while(n[f]<d);do{m--}while(n[m]>d);if(f>=m)break;fh(n,f,m),fh(e,3*f,3*m),fh(e,3*f+1,3*m+1),fh(e,3*f+2,3*m+2)}m-i<s-m?(gp(n,e,i,m),i=m+1):(gp(n,e,m+1,s),s=m)}}function fh(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}Wn(ph,"FeaturePositionMap");class Gl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Vu extends Gl{constructor(e){super(e),this.current=0}set(e,i,s){this.fetchUniformLocation(e,i)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class _p extends Gl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,s){this.fetchUniformLocation(e,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class lu extends Gl{constructor(e){super(e),this.current=Or.transparent}set(e,i,s){this.fetchUniformLocation(e,i)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const yp=new Float32Array(16),tm=new Float32Array(9),e_=new Float32Array(4);function Cd(n){return[yi(255*n.r,255*n.g),yi(255*n.b,255*n.a)]}class Md{constructor(e,i,s){this.value=e,this.uniformNames=i.map(d=>`u_${d}`),this.type=s}setUniform(e,i,s,d,f){i.set(e,f,d.constantOr(this.value))}getBinding(e,i){return"color"===this.type?new lu(e):new Vu(e)}}class ju{constructor(e,i){this.uniformNames=i.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,s,d,f){const m="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;m&&i.set(e,f,m)}getBinding(e,i){return"u_pattern"===i||"u_dash"===i?new _p(e):new Vu(e)}}class Dc{constructor(e,i,s,d){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,i,s,d,f,m){const v=this.paintVertexArray.length,E=this.expression.evaluate(new Wt(0),i,{},f,d,m);this.paintVertexArray.resize(e),this._setPaintValue(v,e,E)}updatePaintArray(e,i,s,d,f){const m=this.expression.evaluate({zoom:0},s,d,void 0,f);this._setPaintValue(e,i,m)}_setPaintValue(e,i,s){if("color"===this.type){const d=Cd(s);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,d[0],d[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $l{constructor(e,i,s,d,f,m){this.expression=e,this.uniformNames=i.map(v=>`u_${v}_t`),this.type=s,this.useIntegerZoom=d,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,i,s,d,f,m){const v=this.expression.evaluate(new Wt(this.zoom),i,{},f,d,m),E=this.expression.evaluate(new Wt(this.zoom+1),i,{},f,d,m),C=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(C,e,v,E)}updatePaintArray(e,i,s,d,f){const m=this.expression.evaluate({zoom:this.zoom},s,d,void 0,f),v=this.expression.evaluate({zoom:this.zoom+1},s,d,void 0,f);this._setPaintValue(e,i,m,v)}_setPaintValue(e,i,s,d){if("color"===this.type){const f=Cd(s),m=Cd(d);for(let v=e;v<i;v++)this.paintVertexArray.emplace(v,f[0],f[1],m[0],m[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,s,d);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,s,d,f){const m=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,v=Yt(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);i.set(e,f,v)}getBinding(e,i){return new Vu(e)}}class Hc{constructor(e,i,s,d,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===s?Jg:Qf).members;for(let m=0;m<i.length;++m);this.paintVertexArray=new d}populatePaintArray(e,i,s){const d=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(d,e,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(e,i,s,d,f,m){this._setPaintValues(e,i,s.patterns&&s.patterns[this.layerId],m)}_setPaintValues(e,i,s,d){if(!d||!s)return;const f=d[s];if(!f)return;const{tl:m,br:v,pixelRatio:E}=f;for(let C=e;C<i;C++)this.paintVertexArray.emplace(C,m[0],m[1],v[0],v[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gc{constructor(e,i,s=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const f in e.paint._values){if(!s(f))continue;const m=e.paint.get(f);if(!(m instanceof zn&&Ha(m.property.specification)))continue;const v=nm(f,e.type),E=m.value,C=m.property.specification.type,R=m.property.useIntegerZoom,N="line-dasharray"===f||f.endsWith("pattern"),$="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==E.kind||$)if("source"===E.kind||$||N){const X=im(f,C,"source");this.binders[f]=N?new Hc(E,v,C,X,e.id):new Dc(E,v,C,X),d.push(`/a_${f}`)}else{const X=im(f,C,"composite");this.binders[f]=new $l(E,v,C,R,i,X),d.push(`/z_${f}`)}else this.binders[f]=N?new ju(E.value,v):new Md(E.value,v,C),d.push(`/u_${f}`)}this.cacheKey=d.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Dc||i instanceof $l?i.maxValue:0}populatePaintArrays(e,i,s,d,f,m){for(const v in this.binders){const E=this.binders[v];(E instanceof Dc||E instanceof $l||E instanceof Hc)&&E.populatePaintArray(e,i,s,d,f,m)}}setConstantPatternPositions(e){for(const i in this.binders){const s=this.binders[i];s instanceof ju&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,i,s,d,f,m){let v=!1;for(const E in e){const C=i.getPositions(E);for(const R of C){const N=s.feature(R.index);for(const $ in this.binders){const X=this.binders[$];if((X instanceof Dc||X instanceof $l||X instanceof Hc)&&!0===X.expression.isStateDependent){const ne=d.paint.get($);X.expression=ne.value,X.updatePaintArray(R.start,R.end,N,e[E],f,m),v=!0}}}}return v}defines(){const e=[];for(const i in this.binders){const s=this.binders[i];(s instanceof Md||s instanceof ju)&&e.push(...s.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Dc||s instanceof $l||s instanceof Hc)for(let d=0;d<s.paintVertexAttributes.length;d++)e.push(s.paintVertexAttributes[d].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Md||s instanceof ju||s instanceof $l)for(const d of s.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof Md||d instanceof ju||d instanceof $l)for(const f of d.uniformNames)i.push({name:f,property:s,binding:d.getBinding(e,f)})}return i}setUniforms(e,i,s,d,f){for(const{name:m,property:v,binding:E}of s)this.binders[v].setUniform(e,E,f,d.get(v),m)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof Dc||i instanceof $l||i instanceof Hc)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const s=this.binders[i];(s instanceof Dc||s instanceof $l||s instanceof Hc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Dc||i instanceof $l||i instanceof Hc)&&i.destroy()}}}class $c{constructor(e,i,s=(()=>!0)){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new Gc(d,i,s);this.needsUpload=!1,this._featureMap=new ph,this._bufferOffset=0}populatePaintArrays(e,i,s,d,f,m,v){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,i,d,f,m,v);void 0!==i.id&&this._featureMap.add(i.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,s,d,f){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,i,m,d,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const vp={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function nm(n,e){return vp[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const bp={"line-pattern":{source:va,composite:va},"fill-pattern":{source:va,composite:va},"fill-extrusion-pattern":{source:va,composite:va},"line-dasharray":{source:jl,composite:jl}},t_={color:{source:uh,composite:Ka},number:{source:Dl,composite:uh}};function im(n,e,i){const s=bp[n];return s&&s[i]||t_[e][i]}Wn(Md,"ConstantBinder"),Wn(ju,"PatternConstantBinder"),Wn(Dc,"SourceExpressionBinder"),Wn(Hc,"PatternCompositeBinder"),Wn($l,"CompositeExpressionBinder"),Wn(Gc,"ProgramConfiguration",{omit:["_buffers"]}),Wn($c,"ProgramConfigurationSet");const Dd="-transition";class Tl extends Cr{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new xn(i.layout)),i.paint)){this._transitionablePaint=new In(i.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qn(i.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,s={}){null!=i&&this._validate(ri,`layers.${this.id}.layout.${e}`,e,i,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return Jt(e,Dd)?this._transitionablePaint.getTransition(e.slice(0,-Dd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,s={}){if(null!=i&&this._validate(On,`layers.${this.id}.paint.${e}`,e,i,s))return!1;if(Jt(e,Dd))return this._transitionablePaint.setTransition(e.slice(0,-Dd.length),i||void 0),!1;{const d=this._transitionablePaint._values[e],f=d.value.isDataDriven(),m=d.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const v=this._transitionablePaint._values[e].value,E=v.isDataDriven(),C=Jt(e,"pattern")||"line-dasharray"===e;return E||f||C||this._handleOverridablePaintPropertyUpdate(e,m,v)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),zt(e,(i,s)=>!(void 0===i||"layout"===s&&!Object.keys(i).length||"paint"===s&&!Object.keys(i).length))}_validate(e,i,s,d,f={}){return(!f||!1!==f.validate)&&ar(this,e.call(hn,{key:i,layerType:this.type,objectKey:s,value:d,styleSpec:pn,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof zn&&Ha(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=sa(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const cu=di([{name:"a_pos",components:2,type:"Int16"}],4),rm=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yo{constructor(e=[]){this.segments=e}prepareSegment(e,i,s,d){let f=this.segments[this.segments.length-1];return e>Yo.MAX_VERTEX_ARRAY_LENGTH&&Tt(`Max vertices per segment is ${Yo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Yo.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==d)&&(f={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==d&&(f.sortKey=d),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,s,d){return new Yo([{vertexOffset:e,primitiveOffset:i,vertexLength:s,primitiveLength:d,vaos:{},sortKey:0}])}}Yo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Wn(Yo,"SegmentVector");var qi=8192;class uu{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Ar?new Ar(e.lng,e.lat):Ar.convert(e),this}setSouthWest(e){return this._sw=e instanceof Ar?new Ar(e.lng,e.lat):Ar.convert(e),this}extend(e){const i=this._sw,s=this._ne;let d,f;if(e instanceof Ar)d=e,f=e;else{if(!(e instanceof uu))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(uu.convert(e)):this.extend(Ar.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(Ar.convert(e)):this;if(d=e._sw,f=e._ne,!d||!f)return this}return i||s?(i.lng=Math.min(d.lng,i.lng),i.lat=Math.min(d.lat,i.lat),s.lng=Math.max(f.lng,s.lng),s.lat=Math.max(f.lat,s.lat)):(this._sw=new Ar(d.lng,d.lat),this._ne=new Ar(f.lng,f.lat)),this}getCenter(){return new Ar((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ar(this.getWest(),this.getNorth())}getSouthEast(){return new Ar(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:s}=Ar.convert(e);let d=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&d}static convert(e){return!e||e instanceof uu?e:new uu(e)}}const du=6371008.8;class Ar{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ar(Et(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,s=this.lat*i,d=e.lat*i,f=Math.sin(s)*Math.sin(d)+Math.cos(s)*Math.cos(d)*Math.cos((e.lng-this.lng)*i);return du*Math.acos(Math.min(f,1))}toBounds(e=0){const i=360*e/40075017,s=i/Math.cos(Math.PI/180*this.lat);return new uu(new Ar(this.lng-s,this.lat-i),new Ar(this.lng+s,this.lat+i))}static convert(e){if(e instanceof Ar)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Ar(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Ar(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const xp=2*Math.PI*du;function mh(n){return xp*Math.cos(n*Math.PI/180)}function Zl(n){return(180+n)/360}function Sl(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function dl(n,e){return n/mh(e)}function ba(n){return 360*n-180}function _s(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function wp(n,e){return n*mh(_s(e))}const Al=85.051129;function gh(n){return 1/Math.cos(n*Math.PI/180)}class Zc{constructor(e,i,s=0){this.x=+e,this.y=+i,this.z=+s}static fromLngLat(e,i=0){const s=Ar.convert(e);return new Zc(Zl(s.lng),Sl(s.lat),dl(i,s.lat))}toLngLat(){return new Ar(ba(this.x),_s(this.y))}toAltitude(){return wp(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/xp*gh(_s(this.y))}}function hu(n,e,i,s,d,f,m,v,E){const C=(e+s)/2,R=(i+d)/2,N=new ht(C,R);v(N),function($,X,ne,he,Pe,Xe){const gt=ne-Pe,We=he-Xe;return Math.abs((he-X)*gt-(ne-$)*We)/Math.hypot(gt,We)}(N.x,N.y,f.x,f.y,m.x,m.y)>=E?(hu(n,e,i,C,R,f,N,v,E),hu(n,C,R,s,d,N,m,v,E)):n.push(m)}function om(n,e,i){let s=n[0],d=s.x,f=s.y;e(s);const m=[s];for(let v=1;v<n.length;v++){const E=n[v],{x:C,y:R}=E;e(E),hu(m,d,f,C,R,s,E,e,i),d=C,f=R,s=E}return m}function _h(n,e,i,s){if(s(e,i)){const d=e.add(i)._mult(.5);_h(n,e,d,s),_h(n,d,i,s)}else n.push(i)}function n_(n,e){let i=n[0];const s=[i];for(let d=1;d<n.length;d++){const f=n[d];_h(s,i,f,e),i=f}return s}const Ep=Math.pow(2,14)-1,sm=-Ep-1;function am(n,e){const i=Math.round(n.x*e),s=Math.round(n.y*e);return n.x=Yt(i,sm,Ep),n.y=Yt(s,sm,Ep),(i<n.x||i>n.x+1||s<n.y||s>n.y+1)&&Tt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function pc(n,e,i){const s=n.loadGeometry(),d=n.extent,f=qi/d;if(e&&i&&i.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:v,x:E,y:C,projection:R}=i,N=$=>{const X=ba((e.x+$.x/d)/m),ne=_s((e.y+$.y/d)/m),he=R.project(X,ne);$.x=(he.x*v-E)*d,$.y=(he.y*v-C)*d};for(let $=0;$<s.length;$++)if(1!==n.type)s[$]=om(s[$],N,1);else{const X=[];for(const ne of s[$])ne.x<0||ne.x>=d||ne.y<0||ne.y>=d||(N(ne),X.push(ne));s[$]=X}}for(const m of s)for(const v of m)am(v,f);return s}function fc(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?pc(n):[]}}function Hu(n,e,i,s,d){n.emplaceBack(2*e+(s+1)/2,2*i+(d+1)/2)}function Tc(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Cp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new zr,this.indexArray=new Ys,this.segments=new Yo,this.programConfigurations=new $c(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,d){const f=this.layers[0],m=[];let v=null;"circle"===f.type&&(v=f.layout.get("circle-sort-key"));for(const{feature:C,id:R,index:N,sourceLayerIndex:$}of e){const X=this.layers[0]._featureFilter.needGeometry,ne=fc(C,X);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),ne,s))continue;const he=v?v.evaluate(ne,{},s):void 0,Pe={id:R,properties:C.properties,type:C.type,sourceLayerIndex:$,index:N,geometry:X?ne.geometry:pc(C,s,d),patterns:{},sortKey:he};m.push(Pe)}v&&m.sort((C,R)=>C.sortKey-R.sortKey);let E=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new mo,E=d.projection);for(const C of m){const{geometry:R,index:N,sourceLayerIndex:$}=C,X=e[N].feature;this.addFeature(C,R,N,i.availableImages,s,E),i.featureIndex.insert(X,R,N,$,this.index)}}update(e,i,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cu.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,rm.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,s,d,f,m){for(const v of i)for(const E of v){const C=E.x,R=E.y;if(C<0||C>=qi||R<0||R>=qi)continue;if(m){const X=m.projectTilePoint(C,R,f),ne=m.upVector(f,C,R),he=this.globeExtVertexArray;Tc(he,X,ne),Tc(he,X,ne),Tc(he,X,ne),Tc(he,X,ne)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),$=N.vertexLength;Hu(this.layoutVertexArray,C,R,-1,-1),Hu(this.layoutVertexArray,C,R,1,-1),Hu(this.layoutVertexArray,C,R,1,1),Hu(this.layoutVertexArray,C,R,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},d,f)}}function lm(n,e){for(let i=0;i<n.length;i++)if(Wc(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Wc(n,e[i]))return!0;return!!Dp(n,e)}function Py(n,e,i){return!!Wc(n,e)||!!Gu(e,n,i)}function cm(n,e){if(1===n.length)return Tp(e,n[0]);for(let i=0;i<e.length;i++){const s=e[i];for(let d=0;d<s.length;d++)if(Wc(n,s[d]))return!0}for(let i=0;i<n.length;i++)if(Tp(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(Dp(n,e[i]))return!0;return!1}function Mp(n,e,i){if(n.length>1){if(Dp(n,e))return!0;for(let s=0;s<e.length;s++)if(Gu(e[s],n,i))return!0}for(let s=0;s<n.length;s++)if(Gu(n[s],e,i))return!0;return!1}function Dp(n,e){if(0===n.length||0===e.length)return!1;for(let i=0;i<n.length-1;i++){const s=n[i],d=n[i+1];for(let f=0;f<e.length-1;f++)if(um(s,d,e[f],e[f+1]))return!0}return!1}function um(n,e,i,s){return fn(n,i,s)!==fn(e,i,s)&&fn(n,e,i)!==fn(n,e,s)}function Gu(n,e,i){const s=i*i;if(1===e.length)return n.distSqr(e[0])<s;for(let d=1;d<e.length;d++)if(yh(n,e[d-1],e[d])<s)return!0;return!1}function yh(n,e,i){const s=e.distSqr(i);if(0===s)return n.distSqr(e);const d=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/s;return n.distSqr(d<0?e:d>1?i:i.sub(e)._mult(d)._add(e))}function Tp(n,e){let i,s,d,f=!1;for(let m=0;m<n.length;m++){i=n[m];for(let v=0,E=i.length-1;v<i.length;E=v++)s=i[v],d=i[E],s.y>e.y!=d.y>e.y&&e.x<(d.x-s.x)*(e.y-s.y)/(d.y-s.y)+s.x&&(f=!f)}return f}function Wc(n,e){let i=!1;for(let s=0,d=n.length-1;s<n.length;d=s++){const f=n[s],m=n[d];f.y>e.y!=m.y>e.y&&e.x<(m.x-f.x)*(e.y-f.y)/(m.y-f.y)+f.x&&(i=!i)}return i}function Sp(n,e,i,s,d){for(const m of n)if(e<=m.x&&i<=m.y&&s>=m.x&&d>=m.y)return!0;const f=[new ht(e,i),new ht(e,d),new ht(s,d),new ht(s,i)];if(n.length>2)for(const m of f)if(Wc(n,m))return!0;for(let m=0;m<n.length-1;m++)if(pu(n[m],n[m+1],f))return!0;return!1}function pu(n,e,i){const s=i[0],d=i[2];if(n.x<s.x&&e.x<s.x||n.x>d.x&&e.x>d.x||n.y<s.y&&e.y<s.y||n.y>d.y&&e.y>d.y)return!1;const f=fn(n,e,i[0]);return f!==fn(n,e,i[1])||f!==fn(n,e,i[2])||f!==fn(n,e,i[3])}function $u(n,e,i){const s=e.paint.get(n).value;return"constant"===s.kind?s.value:i.programConfigurations.get(e.id).getMaxValue(n)}function vh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function dm(n,e,i,s,d){if(!e[0]&&!e[1])return n;const f=ht.convert(e)._mult(d);"viewport"===i&&f._rotate(-s);const m=[];for(let v=0;v<n.length;v++)m.push(n[v].sub(f));return m}function hm(n,e,i,s){const d=ht.convert(n)._mult(s);return"viewport"===e&&d._rotate(-i),d}Wn(Cp,"CircleBucket",{omit:["layers"]});const i_=new ki({"circle-sort-key":new gn(pn.layout_circle["circle-sort-key"])});var Sc={paint:new ki({"circle-radius":new gn(pn.paint_circle["circle-radius"]),"circle-color":new gn(pn.paint_circle["circle-color"]),"circle-blur":new gn(pn.paint_circle["circle-blur"]),"circle-opacity":new gn(pn.paint_circle["circle-opacity"]),"circle-translate":new qt(pn.paint_circle["circle-translate"]),"circle-translate-anchor":new qt(pn.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qt(pn.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qt(pn.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gn(pn.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gn(pn.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gn(pn.paint_circle["circle-stroke-opacity"])}),layout:i_},Ac=1e-6,Qa=typeof Float32Array<"u"?Float32Array:Array;function pm(){var n=new Qa(9);return Qa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function fm(n,e,i){var s=e[0],d=e[1],f=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],$=i[0],X=i[1],ne=i[2],he=i[3],Pe=i[4],Xe=i[5],gt=i[6],We=i[7],dt=i[8];return n[0]=$*s+X*m+ne*C,n[1]=$*d+X*v+ne*R,n[2]=$*f+X*E+ne*N,n[3]=he*s+Pe*m+Xe*C,n[4]=he*d+Pe*v+Xe*R,n[5]=he*f+Pe*E+Xe*N,n[6]=gt*s+We*m+dt*C,n[7]=gt*d+We*v+dt*R,n[8]=gt*f+We*E+dt*N,n}function Wl(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ap(n,e){var i=e[0],s=e[1],d=e[2],f=e[3],m=e[4],v=e[5],E=e[6],C=e[7],R=e[8],N=e[9],$=e[10],X=e[11],ne=e[12],he=e[13],Pe=e[14],Xe=e[15],gt=i*v-s*m,We=i*E-d*m,dt=i*C-f*m,Dt=s*E-d*v,yt=s*C-f*v,cn=d*C-f*E,on=R*he-N*ne,Sn=R*Pe-$*ne,Gn=R*Xe-X*ne,yn=N*Pe-$*he,Rn=N*Xe-X*he,Ln=$*Xe-X*Pe,Un=gt*Ln-We*Rn+dt*yn+Dt*Gn-yt*Sn+cn*on;return Un?(n[0]=(v*Ln-E*Rn+C*yn)*(Un=1/Un),n[1]=(d*Rn-s*Ln-f*yn)*Un,n[2]=(he*cn-Pe*yt+Xe*Dt)*Un,n[3]=($*yt-N*cn-X*Dt)*Un,n[4]=(E*Gn-m*Ln-C*Sn)*Un,n[5]=(i*Ln-d*Gn+f*Sn)*Un,n[6]=(Pe*dt-ne*cn-Xe*We)*Un,n[7]=(R*cn-$*dt+X*We)*Un,n[8]=(m*Rn-v*Gn+C*on)*Un,n[9]=(s*Gn-i*Rn-f*on)*Un,n[10]=(ne*yt-he*dt+Xe*gt)*Un,n[11]=(N*dt-R*yt-X*gt)*Un,n[12]=(v*Sn-m*yn-E*on)*Un,n[13]=(i*yn-s*Sn+d*on)*Un,n[14]=(he*We-ne*Dt-Pe*gt)*Un,n[15]=(R*Dt-N*We+$*gt)*Un,n):null}function fu(n,e,i){var s=e[0],d=e[1],f=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],$=e[9],X=e[10],ne=e[11],he=e[12],Pe=e[13],Xe=e[14],gt=e[15],We=i[0],dt=i[1],Dt=i[2],yt=i[3];return n[0]=We*s+dt*v+Dt*N+yt*he,n[1]=We*d+dt*E+Dt*$+yt*Pe,n[2]=We*f+dt*C+Dt*X+yt*Xe,n[3]=We*m+dt*R+Dt*ne+yt*gt,n[4]=(We=i[4])*s+(dt=i[5])*v+(Dt=i[6])*N+(yt=i[7])*he,n[5]=We*d+dt*E+Dt*$+yt*Pe,n[6]=We*f+dt*C+Dt*X+yt*Xe,n[7]=We*m+dt*R+Dt*ne+yt*gt,n[8]=(We=i[8])*s+(dt=i[9])*v+(Dt=i[10])*N+(yt=i[11])*he,n[9]=We*d+dt*E+Dt*$+yt*Pe,n[10]=We*f+dt*C+Dt*X+yt*Xe,n[11]=We*m+dt*R+Dt*ne+yt*gt,n[12]=(We=i[12])*s+(dt=i[13])*v+(Dt=i[14])*N+(yt=i[15])*he,n[13]=We*d+dt*E+Dt*$+yt*Pe,n[14]=We*f+dt*C+Dt*X+yt*Xe,n[15]=We*m+dt*R+Dt*ne+yt*gt,n}function Zu(n,e,i){var s,d,f,m,v,E,C,R,N,$,X,ne,he=i[0],Pe=i[1],Xe=i[2];return e===n?(n[12]=e[0]*he+e[4]*Pe+e[8]*Xe+e[12],n[13]=e[1]*he+e[5]*Pe+e[9]*Xe+e[13],n[14]=e[2]*he+e[6]*Pe+e[10]*Xe+e[14],n[15]=e[3]*he+e[7]*Pe+e[11]*Xe+e[15]):(d=e[1],f=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],$=e[9],X=e[10],ne=e[11],n[0]=s=e[0],n[1]=d,n[2]=f,n[3]=m,n[4]=v,n[5]=E,n[6]=C,n[7]=R,n[8]=N,n[9]=$,n[10]=X,n[11]=ne,n[12]=s*he+v*Pe+N*Xe+e[12],n[13]=d*he+E*Pe+$*Xe+e[13],n[14]=f*he+C*Pe+X*Xe+e[14],n[15]=m*he+R*Pe+ne*Xe+e[15]),n}function mu(n,e,i){var s=i[0],d=i[1],f=i[2];return n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s,n[3]=e[3]*s,n[4]=e[4]*d,n[5]=e[5]*d,n[6]=e[6]*d,n[7]=e[7]*d,n[8]=e[8]*f,n[9]=e[9]*f,n[10]=e[10]*f,n[11]=e[11]*f,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Ip(n,e,i){var s=Math.sin(i),d=Math.cos(i),f=e[4],m=e[5],v=e[6],E=e[7],C=e[8],R=e[9],N=e[10],$=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=f*d+C*s,n[5]=m*d+R*s,n[6]=v*d+N*s,n[7]=E*d+$*s,n[8]=C*d-f*s,n[9]=R*d-m*s,n[10]=N*d-v*s,n[11]=$*d-E*s,n}function bh(n,e,i){var s=Math.sin(i),d=Math.cos(i),f=e[0],m=e[1],v=e[2],E=e[3],C=e[8],R=e[9],N=e[10],$=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*d-C*s,n[1]=m*d-R*s,n[2]=v*d-N*s,n[3]=E*d-$*s,n[8]=f*s+C*d,n[9]=m*s+R*d,n[10]=v*s+N*d,n[11]=E*s+$*d,n}function mm(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Td(n,e,i){var s,d,f,m=i[0],v=i[1],E=i[2],C=Math.hypot(m,v,E);return C<Ac?null:(m*=C=1/C,v*=C,E*=C,s=Math.sin(e),d=Math.cos(e),n[0]=m*m*(f=1-d)+d,n[1]=v*m*f+E*s,n[2]=E*m*f-v*s,n[3]=0,n[4]=m*v*f-E*s,n[5]=v*v*f+d,n[6]=E*v*f+m*s,n[7]=0,n[8]=m*E*f+v*s,n[9]=v*E*f-m*s,n[10]=E*E*f+d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Ic=fu;function gu(){var n=new Qa(3);return Qa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Pp(n){var e=new Qa(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Wu(n){return Math.hypot(n[0],n[1],n[2])}function _u(n,e,i){var s=new Qa(3);return s[0]=n,s[1]=e,s[2]=i,s}function qc(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function gm(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function r_(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function yu(n,e,i){return n[0]=Math.min(e[0],i[0]),n[1]=Math.min(e[1],i[1]),n[2]=Math.min(e[2],i[2]),n}function vu(n,e,i){return n[0]=Math.max(e[0],i[0]),n[1]=Math.max(e[1],i[1]),n[2]=Math.max(e[2],i[2]),n}function Il(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function xh(n,e,i,s){return n[0]=e[0]+i[0]*s,n[1]=e[1]+i[1]*s,n[2]=e[2]+i[2]*s,n}function ua(n,e){var i=e[0],s=e[1],d=e[2],f=i*i+s*s+d*d;return f>0&&(f=1/Math.sqrt(f)),n[0]=e[0]*f,n[1]=e[1]*f,n[2]=e[2]*f,n}function Pl(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Op(n,e,i){var s=e[0],d=e[1],f=e[2],m=i[0],v=i[1],E=i[2];return n[0]=d*E-f*v,n[1]=f*m-s*E,n[2]=s*v-d*m,n}function $o(n,e,i){var s=e[0],d=e[1],f=e[2],m=i[3]*s+i[7]*d+i[11]*f+i[15];return n[0]=(i[0]*s+i[4]*d+i[8]*f+i[12])/(m=m||1),n[1]=(i[1]*s+i[5]*d+i[9]*f+i[13])/m,n[2]=(i[2]*s+i[6]*d+i[10]*f+i[14])/m,n}function _m(n,e,i){var s=i[0],d=i[1],f=i[2],m=e[0],v=e[1],E=e[2],C=d*E-f*v,R=f*m-s*E,N=s*v-d*m,$=d*N-f*R,X=f*C-s*N,ne=s*R-d*C,he=2*i[3];return R*=he,N*=he,X*=2,ne*=2,n[0]=m+(C*=he)+($*=2),n[1]=v+R+X,n[2]=E+N+ne,n}var qu,Ja=gm,ym=r_,Rp=Wu;function vm(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n}function ls(n,e){var i=e[0],s=e[1],d=e[2],f=e[3],m=i*i+s*s+d*d+f*f;return m>0&&(m=1/Math.sqrt(m)),n[0]=i*m,n[1]=s*m,n[2]=d*m,n[3]=f*m,n}function bu(n,e,i){var s=e[0],d=e[1],f=e[2],m=e[3];return n[0]=i[0]*s+i[4]*d+i[8]*f+i[12]*m,n[1]=i[1]*s+i[5]*d+i[9]*f+i[13]*m,n[2]=i[2]*s+i[6]*d+i[10]*f+i[14]*m,n[3]=i[3]*s+i[7]*d+i[11]*f+i[15]*m,n}function bm(){var n=new Qa(4);return Qa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function wh(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function kp(n,e,i){i*=.5;var s=e[0],d=e[1],f=e[2],m=e[3],v=Math.sin(i),E=Math.cos(i);return n[0]=s*E+m*v,n[1]=d*E+f*v,n[2]=f*E-d*v,n[3]=m*E-s*v,n}function xm(n,e,i){i*=.5;var s=e[0],d=e[1],f=e[2],m=e[3],v=Math.sin(i),E=Math.cos(i);return n[0]=s*E-f*v,n[1]=d*E+m*v,n[2]=f*E+s*v,n[3]=m*E-d*v,n}gu(),qu=new Qa(4),Qa!=Float32Array&&(qu[0]=0,qu[1]=0,qu[2]=0,qu[3]=0);var o_=ls;gu(),_u(1,0,0),_u(0,1,0),bm(),bm(),pm();class Lp{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,s){const d=Pl(i,this.dir);if(Math.abs(d)<1e-6)return!1;const f=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/d;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,i,s){if(he=(X=this.pos)[0],Pe=X[1],Xe=X[2],gt=(ne=e)[0],We=ne[1],dt=ne[2],Math.abs(he-gt)<=Ac*Math.max(1,Math.abs(he),Math.abs(gt))&&Math.abs(Pe-We)<=Ac*Math.max(1,Math.abs(Pe),Math.abs(We))&&Math.abs(Xe-dt)<=Ac*Math.max(1,Math.abs(Xe),Math.abs(dt))||0===i)return s[0]=s[1]=s[2]=0,!1;var X,ne,he,Pe,Xe,gt,We,dt;const[d,f,m]=this.dir,v=this.pos[0]-e[0],E=this.pos[1]-e[1],C=this.pos[2]-e[2],R=d*d+f*f+m*m,N=2*(v*d+E*f+C*m),$=N*N-4*R*(v*v+E*E+C*C-i*i);if($<0){const X=Math.max(-N/2,0),ne=v+d*X,he=E+f*X,Pe=C+m*X,Xe=Math.hypot(ne,he,Pe);return s[0]=ne*i/Xe,s[1]=he*i/Xe,s[2]=Pe*i/Xe,!1}{const X=(-N-Math.sqrt($))/(2*R);if(X<0){const ne=Math.hypot(v,E,C);return s[0]=v*i/ne,s[1]=E*i/ne,s[2]=C*i/ne,!1}return s[0]=v+d*X,s[1]=E+f*X,s[2]=C+m*X,!0}}}class Fp{constructor(e,i,s,d,f){this.TL=e,this.TR=i,this.BR=s,this.BL=d,this.horizon=f}static fromInvProjectionMatrix(e,i,s){const d=[-1,1,1],f=[1,1,1],m=[1,-1,1],v=[-1,-1,1],E=$o(d,d,e),C=$o(f,f,e),R=$o(m,m,e),N=$o(v,v,e);return new Fp(E,C,R,N,i/s)}}class Eh{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,s,d){const f=Math.pow(2,s),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const C=bu([],E,e),R=1/C[3]/i*f;return(N=C)[0]=($=C)[0]*(X=[R,R,d?1/C[3]:R,R])[0],N[1]=$[1]*X[1],N[2]=$[2]*X[2],N[3]=$[3]*X[3],N;var N,$,X}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const C=ua([],Op([],Ja([],m[E[0]],m[E[1]]),Ja([],m[E[2]],m[E[1]]))),R=-Pl(C,m[E[1]]);return C.concat(R)});return new Eh(m,v)}}class Na{static fromPoints(e){const i=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const d of e)yu(i,i,d),vu(s,s,d);return new Na(i,s)}static applyTransform(e,i){const s=e.getCorners();for(let d=0;d<s.length;++d)$o(s[d],s[d],i);return Na.fromPoints(s)}constructor(e,i){this.min=e,this.max=i,this.center=Il([],qc([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],s=Pp(this.min),d=Pp(this.max);for(let f=0;f<i.length;f++)s[f]=i[f]?this.min[f]:this.center[f],d[f]=i[f]?this.center[f]:this.max[f];return d[2]=this.max[2],new Na(s,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let s=!0;for(let d=0;d<e.planes.length;d++){const f=e.planes[d];let m=0;for(let v=0;v<i.length;v++)m+=Pl(f,i[v])+f[3]>=0;if(0===m)return 0;m!==i.length&&(s=!1)}if(s)return 2;for(let d=0;d<3;d++){let f=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let v=0;v<e.points.length;v++){const E=e.points[v][d]-this.min[d];f=Math.min(f,E),m=Math.max(m,E)}if(m<0||f>this.max[d]-this.min[d])return 0}return 1}}function s_(n,e,i,s,d,f,m,v,E){if(f&&n.queryGeometry.isAboveHorizon)return!1;f&&(E*=n.pixelToTileUnitsFactor);const C=n.tileID.canonical,R=i.projection.upVectorScale(C,i.center.lat,i.worldSize).metersToTile;for(const N of e)for(const $ of N){const X=$.add(v),ne=d&&i.elevation?i.elevation.exaggeration()*d.getElevationAt(X.x,X.y,!0):0,he=i.projection.projectTilePoint(X.x,X.y,C);if(ne>0){const We=i.projection.upVector(C,X.x,X.y);he.x+=We[0]*R*ne,he.y+=We[1]*R*ne,he.z+=We[2]*R*ne}const Pe=f?X:Sd(he.x,he.y,he.z,s),Xe=f?n.tilespaceRays.map(We=>Em(We,ne)):n.queryGeometry.screenGeometry,gt=bu([],[he.x,he.y,he.z,1],s);if(!m&&f?E*=gt[3]/i.cameraToCenterDistance:m&&!f&&(E*=i.cameraToCenterDistance/gt[3]),f){const We=_s(($.y/qi+C.y)/(1<<C.z));E/=i.projection.pixelsPerMeter(We,1)/dl(1,We)}if(Py(Xe,Pe,E))return!0}return!1}function Sd(n,e,i,s){const d=bu([],[n,e,i,1],s);return new ht(d[0]/d[3],d[1]/d[3])}const Ch=_u(0,0,0),wm=_u(0,0,1);function Em(n,e){const i=gu();return Ch[2]=e,n.intersectsPlane(Ch,wm,i),new ht(i[0],i[1])}class Bp extends Cp{}function Cm(n,{width:e,height:i},s,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*i*s)throw new RangeError("mismatched image size")}else d=new Uint8Array(e*i*s);return n.width=e,n.height=i,n.data=d,n}function Mm(n,e,i){const{width:s,height:d}=e;s===n.width&&d===n.height||(Mh(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,s),height:Math.min(n.height,d)},i),n.width=s,n.height=d,n.data=e.data)}function Mh(n,e,i,s,d,f){if(0===d.width||0===d.height)return e;if(d.width>n.width||d.height>n.height||i.x>n.width-d.width||i.y>n.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||s.x>e.width-d.width||s.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const m=n.data,v=e.data;for(let E=0;E<d.height;E++){const C=((i.y+E)*n.width+i.x)*f,R=((s.y+E)*e.width+s.x)*f;for(let N=0;N<d.width*f;N++)v[R+N]=m[C+N]}return e}Wn(Bp,"HeatmapBucket",{omit:["layers"]});class mc{constructor(e,i){Cm(this,e,1,i)}resize(e){Mm(this,new mc(e),1)}clone(){return new mc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,d,f){Mh(e,i,s,d,f,1)}}class xa{constructor(e,i){Cm(this,e,4,i)}resize(e){Mm(this,new xa(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new xa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,d,f){Mh(e,i,s,d,f,4)}}Wn(mc,"AlphaImage"),Wn(xa,"RGBAImage");var Oy={paint:new ki({"heatmap-radius":new gn(pn.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gn(pn.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qt(pn.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _i(pn.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qt(pn.paint_heatmap["heatmap-opacity"])})};function Ad(n){const e={},i=n.resolution||256,s=n.clips?n.clips.length:1,d=n.image||new xa({width:i,height:s}),f=(m,v,E)=>{e[n.evaluationKey]=E;const C=n.expression.evaluate(e);d.data[m+v+0]=Math.floor(255*C.r/C.a),d.data[m+v+1]=Math.floor(255*C.g/C.a),d.data[m+v+2]=Math.floor(255*C.b/C.a),d.data[m+v+3]=Math.floor(255*C.a)};if(n.clips)for(let m=0,v=0;m<s;++m,v+=4*i)for(let E=0,C=0;E<i;E++,C+=4){const R=E/(i-1),{start:N,end:$}=n.clips[m];f(v,C,N*(1-R)+$*R)}else for(let m=0,v=0;m<i;m++,v+=4)f(0,v,m/(i-1));return d}var a_={paint:new ki({"hillshade-illumination-direction":new qt(pn.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qt(pn.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qt(pn.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qt(pn.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qt(pn.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qt(pn.paint_hillshade["hillshade-accent-color"])})};const Np=di([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dm}=Np;var Yu={exports:{}};function gc(n,e,i){i=i||2;var s,d,f,m,v,E,C,R=e&&e.length,N=R?e[0]*i:n.length,$=Tm(n,0,N,i,!0),X=[];if(!$||$.next===$.prev)return X;if(R&&($=function(he,Pe,Xe,gt){var We,dt,Dt,yt=[];for(We=0,dt=Pe.length;We<dt;We++)(Dt=Tm(he,Pe[We]*gt,We<dt-1?Pe[We+1]*gt:he.length,gt,!1))===Dt.next&&(Dt.steiner=!0),yt.push(Am(Dt));for(yt.sort(Sm),We=0;We<yt.length;We++)Xe=Up(yt[We],Xe);return Xe}(n,e,$,i)),n.length>80*i){s=f=n[0],d=m=n[1];for(var ne=i;ne<N;ne+=i)(v=n[ne])<s&&(s=v),(E=n[ne+1])<d&&(d=E),v>f&&(f=v),E>m&&(m=E);C=0!==(C=Math.max(f-s,m-d))?32767/C:0}return Yc($,X,i,s,d,C,0),X}function Tm(n,e,i,s,d){var f,m;if(d===Hp(n,e,i,s)>0)for(f=e;f<i;f+=s)m=d_(f,n[f],n[f+1],m);else for(f=i-s;f>=e;f-=s)m=d_(f,n[f],n[f+1],m);return m&&Th(m,m.next)&&(Od(m),m=m.next),m}function Pc(n,e){if(!n)return n;e||(e=n);var i,s=n;do{if(i=!1,s.steiner||!Th(s,s.next)&&0!==Ko(s.prev,s,s.next))s=s.next;else{if(Od(s),(s=e=s.prev)===s.next)break;i=!0}}while(i||s!==e);return e}function Yc(n,e,i,s,d,f,m){if(n){!m&&f&&function(R,N,$,X){var ne=R;do{0===ne.z&&(ne.z=Vp(ne.x,ne.y,N,$,X)),ne.prevZ=ne.prev,ne.nextZ=ne.next,ne=ne.next}while(ne!==R);ne.prevZ.nextZ=null,ne.prevZ=null,function(he){var Pe,Xe,gt,We,dt,Dt,yt,cn,on=1;do{for(Xe=he,he=null,dt=null,Dt=0;Xe;){for(Dt++,gt=Xe,yt=0,Pe=0;Pe<on&&(yt++,gt=gt.nextZ);Pe++);for(cn=on;yt>0||cn>0&&gt;)0!==yt&&(0===cn||!gt||Xe.z<=gt.z)?(We=Xe,Xe=Xe.nextZ,yt--):(We=gt,gt=gt.nextZ,cn--),dt?dt.nextZ=We:he=We,We.prevZ=dt,dt=We;Xe=gt}dt.nextZ=null,on*=2}while(Dt>1)}(ne)}(n,s,d,f);for(var v,E,C=n;n.prev!==n.next;)if(v=n.prev,E=n.next,f?zp(n,s,d,f):l_(n))e.push(v.i/i|0),e.push(n.i/i|0),e.push(E.i/i|0),Od(n),n=E.next,C=E.next;else if((n=E)===C){m?1===m?Yc(n=Dh(Pc(n),e,i),e,i,s,d,f,2):2===m&&xu(n,e,i,s,d,f):Yc(Pc(n),e,i,s,d,f,1);break}}}function l_(n){var e=n.prev,i=n,s=n.next;if(Ko(e,i,s)>=0)return!1;for(var d=e.x,f=i.x,m=s.x,v=e.y,E=i.y,C=s.y,R=d<f?d<m?d:m:f<m?f:m,N=v<E?v<C?v:C:E<C?E:C,$=d>f?d>m?d:m:f>m?f:m,X=v>E?v>C?v:C:E>C?E:C,ne=s.next;ne!==e;){if(ne.x>=R&&ne.x<=$&&ne.y>=N&&ne.y<=X&&ql(d,v,f,E,m,C,ne.x,ne.y)&&Ko(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function zp(n,e,i,s){var d=n.prev,f=n,m=n.next;if(Ko(d,f,m)>=0)return!1;for(var v=d.x,E=f.x,C=m.x,R=d.y,N=f.y,$=m.y,X=v<E?v<C?v:C:E<C?E:C,ne=R<N?R<$?R:$:N<$?N:$,he=v>E?v>C?v:C:E>C?E:C,Pe=R>N?R>$?R:$:N>$?N:$,Xe=Vp(X,ne,e,i,s),gt=Vp(he,Pe,e,i,s),We=n.prevZ,dt=n.nextZ;We&&We.z>=Xe&&dt&&dt.z<=gt;){if(We.x>=X&&We.x<=he&&We.y>=ne&&We.y<=Pe&&We!==d&&We!==m&&ql(v,R,E,N,C,$,We.x,We.y)&&Ko(We.prev,We,We.next)>=0||(We=We.prevZ,dt.x>=X&&dt.x<=he&&dt.y>=ne&&dt.y<=Pe&&dt!==d&&dt!==m&&ql(v,R,E,N,C,$,dt.x,dt.y)&&Ko(dt.prev,dt,dt.next)>=0))return!1;dt=dt.nextZ}for(;We&&We.z>=Xe;){if(We.x>=X&&We.x<=he&&We.y>=ne&&We.y<=Pe&&We!==d&&We!==m&&ql(v,R,E,N,C,$,We.x,We.y)&&Ko(We.prev,We,We.next)>=0)return!1;We=We.prevZ}for(;dt&&dt.z<=gt;){if(dt.x>=X&&dt.x<=he&&dt.y>=ne&&dt.y<=Pe&&dt!==d&&dt!==m&&ql(v,R,E,N,C,$,dt.x,dt.y)&&Ko(dt.prev,dt,dt.next)>=0)return!1;dt=dt.nextZ}return!0}function Dh(n,e,i){var s=n;do{var d=s.prev,f=s.next.next;!Th(d,f)&&Sh(d,s,s.next,f)&&Pd(d,f)&&Pd(f,d)&&(e.push(d.i/i|0),e.push(s.i/i|0),e.push(f.i/i|0),Od(s),Od(s.next),s=n=f),s=s.next}while(s!==n);return Pc(s)}function xu(n,e,i,s,d,f){var m=n;do{for(var v=m.next.next;v!==m.prev;){if(m.i!==v.i&&u_(m,v)){var E=jp(m,v);return m=Pc(m,m.next),E=Pc(E,E.next),Yc(m,e,i,s,d,f,0),void Yc(E,e,i,s,d,f,0)}v=v.next}m=m.next}while(m!==n)}function Sm(n,e){return n.x-e.x}function Up(n,e){var i=function(d,f){var m,v=f,E=d.x,C=d.y,R=-1/0;do{if(C<=v.y&&C>=v.next.y&&v.next.y!==v.y){var N=v.x+(C-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(N<=E&&N>R&&(R=N,m=v.x<v.next.x?v:v.next,N===E))return m}v=v.next}while(v!==f);if(!m)return null;var $,X=m,ne=m.x,he=m.y,Pe=1/0;v=m;do{E>=v.x&&v.x>=ne&&E!==v.x&&ql(C<he?E:R,C,ne,he,C<he?R:E,C,v.x,v.y)&&($=Math.abs(C-v.y)/(E-v.x),Pd(v,d)&&($<Pe||$===Pe&&(v.x>m.x||v.x===m.x&&c_(m,v)))&&(m=v,Pe=$)),v=v.next}while(v!==X);return m}(n,e);if(!i)return e;var s=jp(i,n);return Pc(s,s.next),Pc(i,i.next)}function c_(n,e){return Ko(n.prev,n,e.prev)<0&&Ko(e.next,n,n.next)<0}function Vp(n,e,i,s,d){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*d|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Am(n){var e=n,i=n;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==n);return i}function ql(n,e,i,s,d,f,m,v){return(d-m)*(e-v)>=(n-m)*(f-v)&&(n-m)*(s-v)>=(i-m)*(e-v)&&(i-m)*(f-v)>=(d-m)*(s-v)}function u_(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,s){var d=i;do{if(d.i!==i.i&&d.next.i!==i.i&&d.i!==s.i&&d.next.i!==s.i&&Sh(d,d.next,i,s))return!0;d=d.next}while(d!==i);return!1}(n,e)&&(Pd(n,e)&&Pd(e,n)&&function(i,s){var d=i,f=!1,m=(i.x+s.x)/2,v=(i.y+s.y)/2;do{d.y>v!=d.next.y>v&&d.next.y!==d.y&&m<(d.next.x-d.x)*(v-d.y)/(d.next.y-d.y)+d.x&&(f=!f),d=d.next}while(d!==i);return f}(n,e)&&(Ko(n.prev,n,e.prev)||Ko(n,e.prev,e))||Th(n,e)&&Ko(n.prev,n,n.next)>0&&Ko(e.prev,e,e.next)>0)}function Ko(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Th(n,e){return n.x===e.x&&n.y===e.y}function Sh(n,e,i,s){var d=Id(Ko(n,e,i)),f=Id(Ko(n,e,s)),m=Id(Ko(i,s,n)),v=Id(Ko(i,s,e));return d!==f&&m!==v||!(0!==d||!Ah(n,i,e))||!(0!==f||!Ah(n,s,e))||!(0!==m||!Ah(i,n,s))||!(0!==v||!Ah(i,e,s))}function Ah(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Id(n){return n>0?1:n<0?-1:0}function Pd(n,e){return Ko(n.prev,n,n.next)<0?Ko(n,e,n.next)>=0&&Ko(n,n.prev,e)>=0:Ko(n,e,n.prev)<0||Ko(n,n.next,e)<0}function jp(n,e){var i=new wu(n.i,n.x,n.y),s=new wu(e.i,e.x,e.y),d=n.next,f=e.prev;return n.next=e,e.prev=n,i.next=d,d.prev=i,s.next=i,i.prev=s,f.next=s,s.prev=f,s}function d_(n,e,i,s){var d=new wu(n,e,i);return s?(d.next=s.next,d.prev=s,s.next.prev=d,s.next=d):(d.prev=d,d.next=d),d}function Od(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function wu(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Hp(n,e,i,s){for(var d=0,f=e,m=i-s;f<i;f+=s)d+=(n[m]-n[f])*(n[f+1]+n[m+1]),m=f;return d}function Ku(n,e,i,s,d){Xu(n,e,i||0,s||n.length-1,d||Im)}function Xu(n,e,i,s,d){for(;s>i;){if(s-i>600){var f=s-i+1,m=e-i+1,v=Math.log(f),E=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*E*(f-E)/f)*(m-f/2<0?-1:1);Xu(n,e,Math.max(i,Math.floor(e-m*E/f+C)),Math.min(s,Math.floor(e+(f-m)*E/f+C)),d)}var R=n[e],N=i,$=s;for(Rd(n,i,e),d(n[s],R)>0&&Rd(n,i,s);N<$;){for(Rd(n,N,$),N++,$--;d(n[N],R)<0;)N++;for(;d(n[$],R)>0;)$--}0===d(n[i],R)?Rd(n,i,$):Rd(n,++$,s),$<=e&&(i=$+1),e<=$&&(s=$-1)}}function Rd(n,e,i){var s=n[e];n[e]=n[i],n[i]=s}function Im(n,e){return n<e?-1:n>e?1:0}function Gp(n,e){const i=n.length;if(i<=1)return[n];const s=[];let d,f;for(let m=0;m<i;m++){const v=me(n[m]);0!==v&&(n[m].area=Math.abs(v),void 0===f&&(f=v<0),f===v<0?(d&&s.push(d),d=[n[m]]):d.push(n[m]))}if(d&&s.push(d),e>1)for(let m=0;m<s.length;m++)s[m].length<=e||(Ku(s[m],e,1,s[m].length-1,h_),s[m]=s[m].slice(0,e));return s}function h_(n,e){return e.area-n.area}function $p(n,e,i){const s=i.patternDependencies;let d=!1;for(const f of e){const m=f.paint.get(`${n}-pattern`);m.isConstant()||(d=!0);const v=m.constantOr(null);v&&(d=!0,s[v]=!0)}return d}function Ih(n,e,i,s,d){const f=d.patternDependencies;for(const m of e){const v=m.paint.get(`${n}-pattern`).value;if("constant"!==v.kind){let E=v.evaluate({zoom:s},i,{},d.availableImages);E=E&&E.name?E.name:E,f[E]=!0,i.patterns[m.id]=E}}return i}Yu.exports=gc,Yu.exports.default=gc,gc.deviation=function(n,e,i,s){var d=e&&e.length,f=Math.abs(Hp(n,0,d?e[0]*i:n.length,i));if(d)for(var m=0,v=e.length;m<v;m++)f-=Math.abs(Hp(n,e[m]*i,m<v-1?e[m+1]*i:n.length,i));var E=0;for(m=0;m<s.length;m+=3){var C=s[m]*i,R=s[m+1]*i,N=s[m+2]*i;E+=Math.abs((n[C]-n[N])*(n[R+1]-n[C+1])-(n[C]-n[R])*(n[N+1]-n[C+1]))}return 0===f&&0===E?0:Math.abs((E-f)/f)},gc.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,d=0;d<n.length;d++){for(var f=0;f<n[d].length;f++)for(var m=0;m<e;m++)i.vertices.push(n[d][f][m]);d>0&&i.holes.push(s+=n[d-1].length)}return i};class Ph{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new zr,this.indexArray=new Ys,this.indexArray2=new ul,this.programConfigurations=new $c(e.layers,e.zoom),this.segments=new Yo,this.segments2=new Yo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,s,d){this.hasPattern=$p("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:v,id:E,index:C,sourceLayerIndex:R}of e){const N=this.layers[0]._featureFilter.needGeometry,$=fc(v,N);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),$,s))continue;const X=f?f.evaluate($,{},s,i.availableImages):void 0,ne={id:E,properties:v.properties,type:v.type,sourceLayerIndex:R,index:C,geometry:N?$.geometry:pc(v,s,d),patterns:{},sortKey:X};m.push(ne)}f&&m.sort((v,E)=>v.sortKey-E.sortKey);for(const v of m){const{geometry:E,index:C,sourceLayerIndex:R}=v;if(this.hasPattern){const N=Ih("fill",this.layers,v,this.zoom,i);this.patternFeatures.push(N)}else this.addFeature(v,E,C,s,{},i.availableImages);i.featureIndex.insert(e[C].feature,E,C,R,this.index)}}update(e,i,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,d)}addFeatures(e,i,s,d,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,s,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,s,d,f,m=[]){for(const v of Gp(i,500)){let E=0;for(const ne of v)E+=ne.length;const C=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),R=C.vertexLength,N=[],$=[];for(const ne of v){if(0===ne.length)continue;ne!==v[0]&&$.push(N.length/2);const he=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),Pe=he.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(Pe+ne.length-1,Pe),N.push(ne[0].x),N.push(ne[0].y);for(let Xe=1;Xe<ne.length;Xe++)this.layoutVertexArray.emplaceBack(ne[Xe].x,ne[Xe].y),this.indexArray2.emplaceBack(Pe+Xe-1,Pe+Xe),N.push(ne[Xe].x),N.push(ne[Xe].y);he.vertexLength+=ne.length,he.primitiveLength+=ne.length}const X=Yu.exports(N,$);for(let ne=0;ne<X.length;ne+=3)this.indexArray.emplaceBack(R+X[ne],R+X[ne+1],R+X[ne+2]);C.vertexLength+=E,C.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,m,d)}}Wn(Ph,"FillBucket",{omit:["layers","patternFeatures"]});const Zp=new ki({"fill-sort-key":new gn(pn.layout_fill["fill-sort-key"])});var Wp={paint:new ki({"fill-antialias":new qt(pn.paint_fill["fill-antialias"]),"fill-opacity":new gn(pn.paint_fill["fill-opacity"]),"fill-color":new gn(pn.paint_fill["fill-color"]),"fill-outline-color":new gn(pn.paint_fill["fill-outline-color"]),"fill-translate":new qt(pn.paint_fill["fill-translate"]),"fill-translate-anchor":new qt(pn.paint_fill["fill-translate-anchor"]),"fill-pattern":new gn(pn.paint_fill["fill-pattern"])}),layout:Zp};const p_=di([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),qp=di([{name:"a_centroid_pos",components:2,type:"Uint16"}]),kd=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:f_}=p_;var Oh={},m_=ht,Pm=Qu;function Qu(n,e,i,s,d){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=s,this._values=d,n.readFields(g_,this,e)}function g_(n,e,i){1==n?e.id=i.readVarint():2==n?function(s,d){for(var f=s.readVarint()+s.pos;s.pos<f;){var m=d._keys[s.readVarint()],v=d._values[s.readVarint()];d.properties[m]=v}}(i,e):3==n?e.type=i.readVarint():4==n&&(e._geometry=i.pos)}function __(n){for(var e,i,s=0,d=0,f=n.length,m=f-1;d<f;m=d++)s+=((i=n[m]).x-(e=n[d]).x)*(e.y+i.y);return s}Qu.types=["Unknown","Point","LineString","Polygon"],Qu.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,s=1,d=0,f=0,m=0,v=[];n.pos<i;){if(d<=0){var E=n.readVarint();s=7&E,d=E>>3}if(d--,1===s||2===s)f+=n.readSVarint(),m+=n.readSVarint(),1===s&&(e&&v.push(e),e=[]),e.push(new m_(f,m));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},Qu.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,s=0,d=0,f=0,m=1/0,v=-1/0,E=1/0,C=-1/0;n.pos<e;){if(s<=0){var R=n.readVarint();i=7&R,s=R>>3}if(s--,1===i||2===i)(d+=n.readSVarint())<m&&(m=d),d>v&&(v=d),(f+=n.readSVarint())<E&&(E=f),f>C&&(C=f);else if(7!==i)throw new Error("unknown command "+i)}return[m,E,v,C]},Qu.prototype.toGeoJSON=function(n,e,i){var s,d,f=this.extent*Math.pow(2,i),m=this.extent*n,v=this.extent*e,E=this.loadGeometry(),C=Qu.types[this.type];function R(X){for(var ne=0;ne<X.length;ne++){var he=X[ne];X[ne]=[360*(he.x+m)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+v)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(s=0;s<E.length;s++)N[s]=E[s][0];R(E=N);break;case 2:for(s=0;s<E.length;s++)R(E[s]);break;case 3:for(E=function(X){var ne=X.length;if(ne<=1)return[X];for(var he,Pe,Xe=[],gt=0;gt<ne;gt++){var We=__(X[gt]);0!==We&&(void 0===Pe&&(Pe=We<0),Pe===We<0?(he&&Xe.push(he),he=[X[gt]]):he.push(X[gt]))}return he&&Xe.push(he),Xe}(E),s=0;s<E.length;s++)for(d=0;d<E[s].length;d++)R(E[s][d])}1===E.length?E=E[0]:C="Multi"+C;var $={type:"Feature",geometry:{type:C,coordinates:E},properties:this.properties};return"id"in this&&($.id=this.id),$};var Ju=Pm,_c=Om;function Om(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(y_,this,e),this.length=this._features.length}function y_(n,e,i){15===n?e.version=i.readVarint():1===n?e.name=i.readString():5===n?e.extent=i.readVarint():2===n?e._features.push(i.pos):3===n?e._keys.push(i.readString()):4===n&&e._values.push(function(s){for(var d=null,f=s.readVarint()+s.pos;s.pos<f;){var m=s.readVarint()>>3;d=1===m?s.readString():2===m?s.readFloat():3===m?s.readDouble():4===m?s.readVarint64():5===m?s.readVarint():6===m?s.readSVarint():7===m?s.readBoolean():null}return d}(i))}Om.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new Ju(this._pbf,e,this.extent,this._keys,this._values)};var Ry=_c;function ky(n,e,i){if(3===n){var s=new Ry(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}var Rh=Oh.VectorTile=function(n,e){this.layers=n.readFields(ky,{},e)},Yp=Oh.VectorTileFeature=Pm;function Ld(n,e,i,s){const d=[],f=0===s?(m,v,E,C,R,N)=>{m.push(new ht(N,E+(N-v)/(C-v)*(R-E)))}:(m,v,E,C,R,N)=>{m.push(new ht(v+(N-E)/(R-E)*(C-v),N))};for(const m of n){const v=[];for(const E of m){if(E.length<=2)continue;const C=[];for(let $=0;$<E.length-1;$++){const X=E[$].x,ne=E[$].y,he=E[$+1].x,Pe=E[$+1].y,Xe=0===s?X:ne,gt=0===s?he:Pe;Xe<e?gt>e&&f(C,X,ne,he,Pe,e):Xe>i?gt<i&&f(C,X,ne,he,Pe,i):C.push(E[$]),gt<e&&Xe>=e&&f(C,X,ne,he,Pe,e),gt>i&&Xe<=i&&f(C,X,ne,he,Pe,i)}let R=E[E.length-1];const N=0===s?R.x:R.y;N>=e&&N<=i&&C.push(R),C.length&&(R=C[C.length-1],C[0].x===R.x&&C[0].y===R.y||C.push(C[0]),v.push(C))}v.length&&d.push(v)}return d}Oh.VectorTileLayer=_c;const Rm=Yp.types,v_=Math.pow(2,13);function ed(n,e,i,s,d,f,m,v){n.emplaceBack((e<<1)+m,(i<<1)+f,(Math.floor(s*v_)<<1)+d,Math.round(v))}function Fd(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class km{constructor(){this.acc=new ht(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ht(e.x,e.y),this.max=new ht(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,d=this.max;e.x<s.x?s.x=e.x:e.x>d.x&&(d.x=e.x),e.y<s.y?s.y=e.y:e.y>d.y&&(d.y=e.y),((0===e.x||e.x===qi)&&e.x===i.x)!=((0===e.y||e.y===qi)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,pi(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>qi!=e.x>qi&&this.addBorderIntersection(1,pi(i.y,e.y,(qi-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,pi(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>qi!=e.y>qi&&this.addBorderIntersection(3,pi(i.x,e.x,(qi-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];i<s[0]&&(s[0]=i),i>s[1]&&(s[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,i.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,i.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((i,s)=>i+s.edges,0);return 0!==e?this.acc.div(e)._round():new ht(0,0)}span(){return new ht(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class za{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new oo,this.centroidVertexArray=new Xf,this.indexArray=new Ys,this.programConfigurations=new $c(e.layers,e.zoom),this.segments=new Yo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,s,d){this.features=[],this.hasPattern=$p("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const m=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*m/(m*m+1)/qi/(1<<f.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:m,index:v,sourceLayerIndex:E}of e){const C=this.layers[0]._featureFilter.needGeometry,R=fc(f,C);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),R,s))continue;const N={id:m,sourceLayerIndex:E,index:v,geometry:C?R.geometry:pc(f,s,d),properties:f.properties,type:f.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(Ih("fill-extrusion",this.layers,N,this.zoom,i)):this.addFeature(N,N.geometry,v,s,{},i.availableImages,d),i.featureIndex.insert(f,N.geometry,v,E,this.index,$)}this.sortBorders()}addFeatures(e,i,s,d,f){for(const m of this.features){const{geometry:v}=m;this.addFeature(m,v,m.index,i,s,d,f)}this.sortBorders()}update(e,i,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,f_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,kd.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,qp.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,d,f,m,v){const E=[new ht(0,0),new ht(qi,qi)],C=v.projection,R="globe"===C.name,N=this.enableTerrain&&!R?new km:null,$="Polygon"===Rm[e.type];R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new mo);const X=Gp(i,500);for(let Xe=X.length-1;Xe>=0;Xe--){const gt=X[Xe];(0===gt.length||(ne=gt[0]).every(We=>We.x<=0)||ne.every(We=>We.x>=qi)||ne.every(We=>We.y<=0)||ne.every(We=>We.y>=qi))&&X.splice(Xe,1)}var ne;let he;if(R)he=Vm(X,E,d);else{he=[];for(const Xe of X)he.push({polygon:Xe,bounds:E})}const Pe=$?this.edgeRadius:0;for(const{polygon:Xe,bounds:gt}of he){let We=0,dt=0;for(const yt of Xe)$&&!yt[0].equals(yt[yt.length-1])&&yt.push(yt[0]),dt+=$?yt.length-1:yt.length;const Dt=this.segments.prepareSegment(($?5:4)*dt,this.layoutVertexArray,this.indexArray);if($){const yt=[],cn=[];We=Dt.vertexLength;for(const Sn of Xe){let Gn,yn;Sn.length&&Sn!==Xe[0]&&cn.push(yt.length/2),Gn=Sn[1].sub(Sn[0])._perp()._unit();for(let Rn=1;Rn<Sn.length;Rn++){const Ln=Sn[Rn],Un=Sn[Rn===Sn.length-1?1:Rn+1];let{x:Zn,y:vn}=Ln;if(Pe){yn=Un.sub(Ln)._perp()._unit();const ti=Gn.add(yn)._unit(),Fi=Pe*Math.min(4,1/(Gn.x*ti.x+Gn.y*ti.y));Zn+=Fi*ti.x,vn+=Fi*ti.y,Gn=yn}ed(this.layoutVertexArray,Zn,vn,0,0,1,1,0),Dt.vertexLength++,yt.push(Ln.x,Ln.y),R&&Fd(this.layoutVertexExtArray,C.projectTilePoint(Zn,vn,d),C.upVector(d,Zn,vn))}}const on=Yu.exports(yt,cn);for(let Sn=0;Sn<on.length;Sn+=3)this.indexArray.emplaceBack(We+on[Sn],We+on[Sn+2],We+on[Sn+1]),Dt.primitiveLength++}for(const yt of Xe){N&&yt.length&&N.startRing(yt[0]);let cn,on,Sn,Gn=yt.length>4&&zm(yt[yt.length-2],yt[0],yt[1]),yn=Pe?Fm(yt[yt.length-2],yt[0],yt[1],Pe):0;on=yt[1].sub(yt[0])._perp()._unit();let Rn=!0;for(let Ln=1,Un=0;Ln<yt.length;Ln++){let Zn=yt[Ln-1],vn=yt[Ln];const ti=yt[Ln===yt.length-1?1:Ln+1];if(N&&$&&N.currentPolyCount.top++,Nm(vn,Zn,gt)){Pe&&(on=ti.sub(vn)._perp()._unit(),Rn=!Rn);continue}N&&N.append(vn,Zn);const Fi=vn.sub(Zn)._perp(),oi=Fi.x/(Math.abs(Fi.x)+Math.abs(Fi.y)),vi=Fi.y>0?1:0,ni=Zn.dist(vn);if(Un+ni>32768&&(Un=0),Pe){Sn=ti.sub(vn)._perp()._unit();let pr=Bm(Zn,vn,ti,Lm(on,Sn),Pe);isNaN(pr)&&(pr=0);const Hi=vn.sub(Zn)._unit();Zn=Zn.add(Hi.mult(yn))._round(),vn=vn.add(Hi.mult(-pr))._round(),yn=pr,on=Sn}const Ui=Dt.vertexLength,_r=yt.length>4&&zm(Zn,vn,ti);let yr=Um(Un,Gn,Rn);if(ed(this.layoutVertexArray,Zn.x,Zn.y,oi,vi,0,0,yr),ed(this.layoutVertexArray,Zn.x,Zn.y,oi,vi,0,1,yr),Un+=ni,yr=Um(Un,_r,!Rn),Gn=_r,ed(this.layoutVertexArray,vn.x,vn.y,oi,vi,0,0,yr),ed(this.layoutVertexArray,vn.x,vn.y,oi,vi,0,1,yr),Dt.vertexLength+=4,this.indexArray.emplaceBack(Ui+0,Ui+1,Ui+2),this.indexArray.emplaceBack(Ui+1,Ui+3,Ui+2),Dt.primitiveLength+=2,Pe){const pr=We+(1===Ln?yt.length-2:Ln-2),Hi=1===Ln?We:pr+1;if(this.indexArray.emplaceBack(Ui+1,pr,Ui+3),this.indexArray.emplaceBack(pr,Hi,Ui+3),Dt.primitiveLength+=2,void 0===cn&&(cn=Ui),!Nm(ti,yt[Ln],gt)){const $r=Ln===yt.length-1?cn:Dt.vertexLength;this.indexArray.emplaceBack(Ui+2,Ui+3,$r),this.indexArray.emplaceBack(Ui+3,$r+1,$r),this.indexArray.emplaceBack(Ui+3,Hi,$r+1),Dt.primitiveLength+=3}Rn=!Rn}if(R){const pr=this.layoutVertexExtArray,Hi=C.projectTilePoint(Zn.x,Zn.y,d),$r=C.projectTilePoint(vn.x,vn.y,d),er=C.upVector(d,Zn.x,Zn.y),vr=C.upVector(d,vn.x,vn.y);Fd(pr,Hi,er),Fd(pr,Hi,er),Fd(pr,$r,vr),Fd(pr,$r,vr)}}$&&(We+=yt.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const Xe=N.borders,gt=this.featuresOnBorder.push(N)-1;for(let We=0;We<4;We++)Xe[We][0]!==Number.MAX_VALUE&&this.borders[We].push(gt)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,m,d)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,s)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,i,s=!0){let d,f;if(e)if(0!==e.y){const v=i.span()._mult(this.tileToMeter);d=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else d=Math.ceil(7*(e.x+450)),f=0;else d=0,f=+s;let m=s?this.centroidVertexArray.length:i.vertexArrayOffset;for(const v of i.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let E=0;E<v.top;E++)this.centroidVertexArray.emplace(m++,d,f);for(let E=0;E<2*v.edges;E++)this.centroidVertexArray.emplace(m++,0,f),this.centroidVertexArray.emplace(m++,d,f)}}}function Lm(n,e){const i=n.add(e)._unit();return n.x*i.x+n.y*i.y}function Fm(n,e,i,s){const d=e.sub(n)._perp()._unit(),f=i.sub(e)._perp()._unit();return Bm(n,e,i,Lm(d,f),s)}function Bm(n,e,i,s,d){const f=Math.sqrt(1-s*s);return Math.min(n.dist(e)/3,e.dist(i)/3,d*f/s)}function Nm(n,e,i){return n.x<i[0].x&&e.x<i[0].x||n.x>i[1].x&&e.x>i[1].x||n.y<i[0].y&&e.y<i[0].y||n.y>i[1].y&&e.y>i[1].y}function zm(n,e,i){if(n.x<0||n.x>=qi||e.x<0||e.x>=qi||i.x<0||i.x>=qi)return!1;const s=i.sub(e),d=s.perp(),f=n.sub(e);return(s.x*f.x+s.y*f.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(f.x*f.x+f.y*f.y))>-.866&&d.x*f.x+d.y*f.y<0}function Um(n,e,i){const s=e?2|n:-3&n;return i?1|s:-2&s}function Kp(){const n=Math.PI/32,e=Math.tan(n),i=du;return i*Math.sqrt(1+2*e*e)-i}function Vm(n,e,i){const s=1<<i.z,d=ba(i.x/s),f=ba((i.x+1)/s),m=_s(i.y/s),v=_s((i.y+1)/s);return function(E,C,R,N,$=0,X){const ne=[];if(!E.length||!R||!N)return ne;const he=(yt,cn)=>{for(const on of yt)ne.push({polygon:on,bounds:cn})},Pe=Math.ceil(Math.log2(R)),Xe=Math.ceil(Math.log2(N)),gt=Pe-Xe,We=[];for(let yt=0;yt<Math.abs(gt);yt++)We.push(gt>0?0:1);for(let yt=0;yt<Math.min(Pe,Xe);yt++)We.push(0),We.push(1);let dt=E;if(dt=Ld(dt,C[0].y-$,C[1].y+$,1),dt=Ld(dt,C[0].x-$,C[1].x+$,0),!dt.length)return ne;const Dt=[];for(We.length?Dt.push({polygons:dt,bounds:C,depth:0}):he(dt,C);Dt.length;){const yt=Dt.pop(),cn=yt.depth,on=We[cn],Sn=yt.bounds[0],Gn=yt.bounds[1],yn=0===on?Sn.x:Sn.y,Rn=0===on?Gn.x:Gn.y,Ln=X?X(on,yn,Rn):.5*(yn+Rn),Un=Ld(yt.polygons,yn-$,Ln+$,on),Zn=Ld(yt.polygons,Ln-$,Rn+$,on);if(Un.length){const vn=[Sn,new ht(0===on?Ln:Gn.x,1===on?Ln:Gn.y)];We.length>cn+1?Dt.push({polygons:Un,bounds:vn,depth:cn+1}):he(Un,vn)}if(Zn.length){const vn=[new ht(0===on?Ln:Sn.x,1===on?Ln:Sn.y),Gn];We.length>cn+1?Dt.push({polygons:Zn,bounds:vn,depth:cn+1}):he(Zn,vn)}}return ne}(n,e,Math.ceil((f-d)/11.25),Math.ceil((m-v)/11.25),1,(E,C,R)=>{if(0===E)return.5*(C+R);{const N=_s((i.y+C/qi)/s);return(Sl(.5*(_s((i.y+R/qi)/s)+N))*s-i.y)*qi}})}Wn(za,"FillExtrusionBucket",{omit:["layers","features"]}),Wn(km,"PartMetadata");const b_=new ki({"fill-extrusion-edge-radius":new qt(pn["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var x_={paint:new ki({"fill-extrusion-opacity":new qt(pn["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gn(pn["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qt(pn["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qt(pn["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new gn(pn["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gn(pn["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gn(pn["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qt(pn["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qt(pn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qt(pn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:b_};function gr(n,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[n*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class Bd{constructor(e,i,s){this.z=e,this.x=i,this.y=s,this.key=Nd(0,e,e,i,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const s=(m=this.y,v=this.z,E=gr(256*(f=this.x),256*(m=Math.pow(2,v)-m-1),v),C=gr(256*(f+1),256*(m+1),v),E[0]+","+E[1]+","+C[0]+","+C[1]),d=function(f,m,v){let E,C="";for(let R=f;R>0;R--)E=1<<R-1,C+=(m&E?1:0)+(v&E?2:0);return C}(this.z,this.x,this.y);var f,m,v,E,C;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Xp{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Nd(e,i.z,i.z,i.x,i.y)}}class da{constructor(e,i,s,d,f){this.overscaledZ=e,this.wrap=i,this.canonical=new Bd(s,+d,+f),this.key=0===i&&e===s?this.canonical.key:Nd(i,e,s,d,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new da(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new da(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Nd(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return Nd(this.wrap*+i,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new da(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,d=2*this.canonical.y;return[new da(i,this.wrap,i,s,d),new da(i,this.wrap,i,s+1,d),new da(i,this.wrap,i,s,d+1),new da(i,this.wrap,i,s+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new da(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new da(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Xp(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nd(n,e,i,s,d){const f=1<<Math.min(i,22);let m=f*(d%f)+s%f;return n&&i<22&&(m+=f*f*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*m+i)+(e-i)}Wn(Bd,"CanonicalTileID"),Wn(da,"OverscaledTileID",{omit:["projMatrix"]});class td extends ht{constructor(e,i,s){super(e,i),this.z=s}}function nd(n,e){return n.x*e.x+n.y*e.y}function jm(n,e){if(1===n.length){let i=0;const s=e[i++];let d;for(;!d||s.equals(d);)if(d=e[i++],!d)return 1/0;for(;i<e.length;i++){const f=e[i],m=n[0],v=d.sub(s),E=f.sub(s),C=m.sub(s),R=nd(v,v),N=nd(v,E),$=nd(E,E),X=nd(C,v),ne=nd(C,E),he=R*$-N*N,Pe=($*X-N*ne)/he,Xe=(R*ne-N*X)/he,gt=s.z*(1-Pe-Xe)+d.z*Pe+f.z*Xe;if(isFinite(gt))return gt}return 1/0}{let i=1/0;for(const s of e)i=Math.min(i,s.z);return i}}function Qp(n,e,i,s,d,f,m,v){const E=m*d.getElevationAt(n,e,!0,!0),C=0!==f[0],R=C?0===f[1]?m*(f[0]/7-450):m*function(N,$,X){const ne=Math.floor($[0]/8),he=Math.floor($[1]/8),Pe=10*($[0]-8*ne),Xe=10*($[1]-8*he),gt=N.getElevationAt(ne,he,!0,!0),We=N.getMeterToDEM(X),dt=Math.floor(.5*(Pe*We-1)),Dt=Math.floor(.5*(Xe*We-1)),yt=N.tileCoordToPixel(ne,he),cn=2*dt+1,on=2*Dt+1,Sn=(Fi=cn,oi=on,[(Zn=N).getElevationAtPixel(vn=yt.x-dt,ti=yt.y-Dt,!0),Zn.getElevationAtPixel(vn+oi,ti,!0),Zn.getElevationAtPixel(vn,ti+oi,!0),Zn.getElevationAtPixel(vn+Fi,ti+oi,!0)]),Gn=Math.abs(Sn[0]-Sn[1]),yn=Math.abs(Sn[2]-Sn[3]),Rn=Math.abs(Sn[0]-Sn[2])+Math.abs(Sn[1]-Sn[3]),Ln=Math.min(.25,.5*We*(Gn+yn)/cn),Un=Math.min(.25,.5*We*Rn/on);var Zn,vn,ti,Fi,oi;return gt+Math.max(Ln*Pe,Un*Xe)}(d,f,v):E;return{base:E+(0===i)?-1:i,top:C?Math.max(R+s,E+i+2):E+s}}const w_=di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:E_}=w_,Ly=di([{name:"a_packed",components:4,type:"Float32"}]),{members:Hm}=Ly,Gm=Yp.types,Eu=Math.cos(Math.PI/180*37.5);class kh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new La,this.layoutVertexArray2=new Ka,this.indexArray=new Ys,this.programConfigurations=new $c(e.layers,e.zoom),this.segments=new Yo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,d){this.hasPattern=$p("line",this.layers,i);const f=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:R,id:N,index:$,sourceLayerIndex:X}of e){const ne=this.layers[0]._featureFilter.needGeometry,he=fc(R,ne);if(!this.layers[0]._featureFilter.filter(new Wt(this.zoom),he,s))continue;const Pe=f?f.evaluate(he,{},s):void 0,Xe={id:N,properties:R.properties,type:R.type,sourceLayerIndex:X,index:$,geometry:ne?he.geometry:pc(R,s,d),patterns:{},sortKey:Pe};m.push(Xe)}f&&m.sort((R,N)=>R.sortKey-N.sortKey);const{lineAtlas:v,featureIndex:E}=i,C=this.addConstantDashes(v);for(const R of m){const{geometry:N,index:$,sourceLayerIndex:X}=R;if(C&&this.addFeatureDashes(R,v),this.hasPattern){const ne=Ih("line",this.layers,R,this.zoom,i);this.patternFeatures.push(ne)}else this.addFeature(R,N,$,s,v.positions,i.availableImages);E.insert(e[$].feature,N,$,X,this.index)}}addConstantDashes(e){let i=!1;for(const s of this.layers){const d=s.paint.get("line-dasharray").value,f=s.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==f.kind)i=!0;else{const m=f.value,v=d.value;if(!v)continue;e.addDash(v,m)}}return i}addFeatureDashes(e,i){const s=this.zoom;for(const d of this.layers){const f=d.paint.get("line-dasharray").value,m=d.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===m.kind)continue;let v,E;if("constant"===f.kind){if(v=f.value,!v)continue}else v=f.evaluate({zoom:s},e);E="constant"===m.kind?m.value:m.evaluate({zoom:s},e),i.addDash(v,E),e.patterns[d.id]=i.getKey(v,E)}}update(e,i,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,d)}addFeatures(e,i,s,d,f){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,s,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Hm)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,E_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,s,d,f,m){const v=this.layers[0].layout,E=v.get("line-join").evaluate(e,{}),C=v.get("line-cap").evaluate(e,{}),R=v.get("line-miter-limit"),N=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const $ of i)this.addLine($,e,E,C,R,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,f,m,d)}addLine(e,i,s,d,f,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Xe=0;Xe<e.length-1;Xe++)this.totalDistance+=e[Xe].dist(e[Xe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v="Polygon"===Gm[i.type];let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let C=0;for(;C<E-1&&e[C].equals(e[C+1]);)C++;if(E<(v?3:2))return;"bevel"===s&&(f=1.05);const R=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let $,X,ne,he,Pe;this.e1=this.e2=-1,v&&($=e[E-2],Pe=e[C].sub($)._unit()._perp());for(let Xe=C;Xe<E;Xe++){if(ne=Xe===E-1?v?e[C+1]:void 0:e[Xe+1],ne&&e[Xe].equals(ne))continue;Pe&&(he=Pe),$&&(X=$),$=e[Xe],Pe=ne?ne.sub($)._unit()._perp():he,he=he||Pe;let gt=he.add(Pe);0===gt.x&&0===gt.y||gt._unit();const We=he.x*Pe.x+he.y*Pe.y,dt=gt.x*Pe.x+gt.y*Pe.y,Dt=0!==dt?1/dt:1/0,yt=2*Math.sqrt(2-2*dt),cn=dt<Eu&&X&&ne,on=he.x*Pe.y-he.y*Pe.x>0;if(cn&&Xe>C){const yn=$.dist(X);if(yn>2*R){const Rn=$.sub($.sub(X)._mult(R/yn)._round());this.updateDistance(X,Rn),this.addCurrentVertex(Rn,he,0,0,N),X=Rn}}const Sn=X&&ne;let Gn=Sn?s:v?"butt":d;if(Sn&&"round"===Gn&&(Dt<m?Gn="miter":Dt<=2&&(Gn="fakeround")),"miter"===Gn&&Dt>f&&(Gn="bevel"),"bevel"===Gn&&(Dt>2&&(Gn="flipbevel"),Dt<f&&(Gn="miter")),X&&this.updateDistance(X,$),"miter"===Gn)gt._mult(Dt),this.addCurrentVertex($,gt,0,0,N);else if("flipbevel"===Gn){if(Dt>100)gt=Pe.mult(-1);else{const yn=Dt*he.add(Pe).mag()/he.sub(Pe).mag();gt._perp()._mult(yn*(on?-1:1))}this.addCurrentVertex($,gt,0,0,N),this.addCurrentVertex($,gt.mult(-1),0,0,N)}else if("bevel"===Gn||"fakeround"===Gn){const yn=-Math.sqrt(Dt*Dt-1),Rn=on?yn:0,Ln=on?0:yn;if(X&&this.addCurrentVertex($,he,Rn,Ln,N),"fakeround"===Gn){const Un=Math.round(180*yt/Math.PI/20);for(let Zn=1;Zn<Un;Zn++){let vn=Zn/Un;if(.5!==vn){const Fi=vn-.5;vn+=vn*Fi*(vn-1)*((1.0904+We*(We*(3.55645-1.43519*We)-3.2452))*Fi*Fi+(.848013+We*(.215638*We-1.06021)))}const ti=Pe.sub(he)._mult(vn)._add(he)._unit()._mult(on?-1:1);this.addHalfVertex($,ti.x,ti.y,!1,on,0,N)}}ne&&this.addCurrentVertex($,Pe,-Rn,-Ln,N)}else if("butt"===Gn)this.addCurrentVertex($,gt,0,0,N);else if("square"===Gn){const yn=X?1:-1;X||this.addCurrentVertex($,gt,yn,yn,N),this.addCurrentVertex($,gt,0,0,N),X&&this.addCurrentVertex($,gt,yn,yn,N)}else"round"===Gn&&(X&&(this.addCurrentVertex($,he,0,0,N),this.addCurrentVertex($,he,1,1,N,!0)),ne&&(this.addCurrentVertex($,Pe,-1,-1,N,!0),this.addCurrentVertex($,Pe,0,0,N)));if(cn&&Xe<E-1){const yn=$.dist(ne);if(yn>2*R){const Rn=$.add(ne.sub($)._mult(R/yn)._round());this.updateDistance($,Rn),this.addCurrentVertex(Rn,Pe,0,0,N),$=Rn}}}}addCurrentVertex(e,i,s,d,f,m=!1){const v=i.y*d-i.x,E=-i.y-i.x*d;this.addHalfVertex(e,i.x+i.y*s,i.y-i.x*s,m,!1,s,f),this.addHalfVertex(e,v,E,m,!0,-d,f)}addHalfVertex({x:e,y:i},s,d,f,m,v,E){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(m?1:0),Math.round(63*s)+128,Math.round(63*d)+128,1+(0===v?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),E.primitiveLength++),m?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}Wn(kh,"LineBucket",{omit:["layers","patternFeatures"]});const Jp=new ki({"line-cap":new gn(pn.layout_line["line-cap"]),"line-join":new gn(pn.layout_line["line-join"]),"line-miter-limit":new qt(pn.layout_line["line-miter-limit"]),"line-round-limit":new qt(pn.layout_line["line-round-limit"]),"line-sort-key":new gn(pn.layout_line["line-sort-key"])});var Lh={paint:new ki({"line-opacity":new gn(pn.paint_line["line-opacity"]),"line-color":new gn(pn.paint_line["line-color"]),"line-translate":new qt(pn.paint_line["line-translate"]),"line-translate-anchor":new qt(pn.paint_line["line-translate-anchor"]),"line-width":new gn(pn.paint_line["line-width"]),"line-gap-width":new gn(pn.paint_line["line-gap-width"]),"line-offset":new gn(pn.paint_line["line-offset"]),"line-blur":new gn(pn.paint_line["line-blur"]),"line-dasharray":new gn(pn.paint_line["line-dasharray"]),"line-pattern":new gn(pn.paint_line["line-pattern"]),"line-gradient":new _i(pn.paint_line["line-gradient"]),"line-trim-offset":new qt(pn.paint_line["line-trim-offset"])}),layout:Jp};const $m=new class extends gn{possiblyEvaluate(n,e){return e=new Wt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,s){return e=Nn({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,s)}}(Lh.paint.properties["line-width"].specification);function C_(n,e){return e>0?e+2*n:n}$m.useIntegerZoom=!0;const Fy=di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),By=di([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),M_=di([{name:"a_projected_pos",components:4,type:"Float32"}],4);di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Zm=di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ny=di([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wm=di([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),id=di([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);di([{name:"triangle",components:3,type:"Uint16"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),di([{type:"Float32",name:"offsetX"}]),di([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ks=24;const Yl=128;function rd(n,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new Wt(n+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:d}=i;let f=0;for(;f<s.length&&s[f]<=n;)f++;f=Math.max(0,f-1);let m=f;for(;m<s.length&&s[m]<n+1;)m++;m=Math.min(s.length-1,m);const v=s[f],E=s[m];return"composite"===i.kind?{kind:"composite",minZoom:v,maxZoom:E,interpolationType:d}:{kind:"camera",minZoom:v,maxZoom:E,minSize:i.evaluate(new Wt(v)),maxSize:i.evaluate(new Wt(E)),interpolationType:d}}}function Fh(n,{uSize:e,uSizeT:i},{lowerSize:s,upperSize:d}){return"source"===n.kind?s/Yl:"composite"===n.kind?pi(s/Yl,d/Yl,i):e}function Cu(n,e){let i=0,s=0;if("constant"===n.kind)s=n.layoutSize;else if("source"!==n.kind){const{interpolationType:d,minZoom:f,maxZoom:m}=n,v=d?Yt(os.interpolationFactor(d,e,f,m),0,1):0;"camera"===n.kind?s=pi(n.minSize,n.maxSize,v):i=v}return{uSizeT:i,uSize:s}}var D_=Object.freeze({__proto__:null,getSizeData:rd,evaluateSizeForFeature:Fh,evaluateSizeForZoom:Cu,SIZE_PACK_FACTOR:Yl});function T_(n,e,i){return n.sections.forEach(s=>{s.text=function(d,f,m){const v=f.layout.get("text-transform").evaluate(m,{});return"uppercase"===v?d=d.toLocaleUpperCase():"lowercase"===v&&(d=d.toLocaleLowerCase()),rn.applyArabicShaping&&(d=rn.applyArabicShaping(d)),d}(s.text,e,i)}),n}const zd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function S_(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function A_(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var od=ao,qm=function(n,e,i,s,d){var f,m,v=8*d-s-1,E=(1<<v)-1,C=E>>1,R=-7,N=i?d-1:0,$=i?-1:1,X=n[e+N];for(N+=$,f=X&(1<<-R)-1,X>>=-R,R+=v;R>0;f=256*f+n[e+N],N+=$,R-=8);for(m=f&(1<<-R)-1,f>>=-R,R+=s;R>0;m=256*m+n[e+N],N+=$,R-=8);if(0===f)f=1-C;else{if(f===E)return m?NaN:1/0*(X?-1:1);m+=Math.pow(2,s),f-=C}return(X?-1:1)*m*Math.pow(2,f-s)},ef=function(n,e,i,s,d,f){var m,v,E,C=8*f-d-1,R=(1<<C)-1,N=R>>1,$=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,X=s?0:f-1,ne=s?1:-1,he=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,m=R):(m=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-m))<1&&(m--,E*=2),(e+=m+N>=1?$/E:$*Math.pow(2,1-N))*E>=2&&(m++,E/=2),m+N>=R?(v=0,m=R):m+N>=1?(v=(e*E-1)*Math.pow(2,d),m+=N):(v=e*Math.pow(2,N-1)*Math.pow(2,d),m=0));d>=8;n[i+X]=255&v,X+=ne,v/=256,d-=8);for(m=m<<d|v,C+=d;C>0;n[i+X]=255&m,X+=ne,m/=256,C-=8);n[i+X-ne]|=128*he};function ao(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}ao.Varint=0,ao.Fixed64=1,ao.Bytes=2,ao.Fixed32=5;var Ud=4294967296,I_=1/Ud,Bh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Oc(n){return n.type===ao.Bytes?n.readVarint()+n.pos:n.pos+1}function Mu(n,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var d=i.pos-1;d>=n;d--)i.buf[d+s]=i.buf[d]}function Ym(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function P_(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function Km(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function O_(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function R_(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function Nh(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function sd(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function tf(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function jd(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function ad(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function Rc(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function nf(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function rf(n,e,i){e.glyphs=[],1===n&&i.readMessage(sf,e)}function sf(n,e,i){if(3===n){const{id:s,bitmap:d,width:f,height:m,left:v,top:E,advance:C}=i.readMessage(af,{});e.glyphs.push({id:s,bitmap:new mc({width:f+6,height:m+6},d),metrics:{width:f,height:m,left:v,top:E,advance:C}})}else 4===n?e.ascender=i.readSVarint():5===n&&(e.descender=i.readSVarint())}function af(n,e,i){1===n?e.id=i.readVarint():2===n?e.bitmap=i.readBytes():3===n?e.width=i.readVarint():4===n?e.height=i.readVarint():5===n?e.left=i.readSVarint():6===n?e.top=i.readSVarint():7===n&&(e.advance=i.readVarint())}function zh(n){let e=0,i=0;for(const m of n)e+=m.w*m.h,i=Math.max(i,m.w);n.sort((m,v)=>v.h-m.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let d=0,f=0;for(const m of n)for(let v=s.length-1;v>=0;v--){const E=s[v];if(!(m.w>E.w||m.h>E.h)){if(m.x=E.x,m.y=E.y,f=Math.max(f,m.y+m.h),d=Math.max(d,m.x+m.w),m.w===E.w&&m.h===E.h){const C=s.pop();v<s.length&&(s[v]=C)}else m.h===E.h?(E.x+=m.w,E.w-=m.w):m.w===E.w?(E.y+=m.h,E.h-=m.h):(s.push({x:E.x+m.w,y:E.y,w:E.w-m.w,h:m.h}),E.y+=m.h,E.h-=m.h);break}}return{w:d,h:f,fill:e/(d*f)||0}}ao.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),d=s>>3,f=this.pos;this.type=7&s,n(d,e,this),this.pos===f&&this.skip(s)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=ad(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=nf(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=ad(this.buf,this.pos)+ad(this.buf,this.pos+4)*Ud;return this.pos+=8,n},readSFixed64:function(){var n=ad(this.buf,this.pos)+nf(this.buf,this.pos+4)*Ud;return this.pos+=8,n},readFloat:function(){var n=qm(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=qm(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(d,f,m){var v,E,C=m.buf;if(v=(112&(E=C[m.pos++]))>>4,E<128||(v|=(127&(E=C[m.pos++]))<<3,E<128)||(v|=(127&(E=C[m.pos++]))<<10,E<128)||(v|=(127&(E=C[m.pos++]))<<17,E<128)||(v|=(127&(E=C[m.pos++]))<<24,E<128)||(v|=(1&(E=C[m.pos++]))<<31,E<128))return function Vd(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(d,v,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&Bh?Bh.decode(this.buf.subarray(e,n)):function(i,s,d){for(var f="",m=s;m<d;){var v,E,C,R=i[m],N=null,$=R>239?4:R>223?3:R>191?2:1;if(m+$>d)break;1===$?R<128&&(N=R):2===$?128==(192&(v=i[m+1]))&&(N=(31&R)<<6|63&v)<=127&&(N=null):3===$?(E=i[m+2],128==(192&(v=i[m+1]))&&128==(192&E)&&((N=(15&R)<<12|(63&v)<<6|63&E)<=2047||N>=55296&&N<=57343)&&(N=null)):4===$&&(E=i[m+2],C=i[m+3],128==(192&(v=i[m+1]))&&128==(192&E)&&128==(192&C)&&((N=(15&R)<<18|(63&v)<<12|(63&E)<<6|63&C)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,$=1):N>65535&&(N-=65536,f+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),f+=String.fromCharCode(N),m+=$}return f}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==ao.Bytes)return n.push(this.readVarint(e));var i=Oc(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==ao.Bytes)return n.push(this.readSVarint());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==ao.Bytes)return n.push(this.readBoolean());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==ao.Bytes)return n.push(this.readFloat());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==ao.Bytes)return n.push(this.readDouble());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==ao.Bytes)return n.push(this.readFixed32());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==ao.Bytes)return n.push(this.readSFixed32());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==ao.Bytes)return n.push(this.readFixed64());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==ao.Bytes)return n.push(this.readSFixed64());var e=Oc(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===ao.Varint)for(;this.buf[this.pos++]>127;);else if(e===ao.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ao.Fixed32)this.pos+=4;else{if(e!==ao.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),Rc(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),Rc(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),Rc(this.buf,-1&n,this.pos),Rc(this.buf,Math.floor(n*I_),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),Rc(this.buf,-1&n,this.pos),Rc(this.buf,Math.floor(n*I_),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var s,d,f,v;if(e>=0?(s=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,d=d+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),f=s,(v=i).buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,f>>>=7,v.buf[v.pos++]=127&f|128,v.buf[v.pos]=127&(f>>>=7),function(f,m){var v=(7&f)<<4;m.buf[m.pos++]|=v|((f>>>=3)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f|((f>>>=7)?128:0),f&&(m.buf[m.pos++]=127&f)))))}(d,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(s,d,f){for(var m,v,E=0;E<d.length;E++){if((m=d.charCodeAt(E))>55295&&m<57344){if(!v){m>56319||E+1===d.length?(s[f++]=239,s[f++]=191,s[f++]=189):v=m;continue}if(m<56320){s[f++]=239,s[f++]=191,s[f++]=189,v=m;continue}m=v-55296<<10|m-56320|65536,v=null}else v&&(s[f++]=239,s[f++]=191,s[f++]=189,v=null);m<128?s[f++]=m:(m<2048?s[f++]=m>>6|192:(m<65536?s[f++]=m>>12|224:(s[f++]=m>>18|240,s[f++]=m>>12&63|128),s[f++]=m>>6&63|128),s[f++]=63&m|128)}return f}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&Mu(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),ef(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),ef(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var s=this.pos-i;s>=128&&Mu(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(n,e,i){this.writeTag(n,ao.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,Ym,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,P_,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,R_,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,Km,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,O_,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,Nh,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,sd,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,tf,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,jd,e)},writeBytesField:function(n,e){this.writeTag(n,ao.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,ao.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,ao.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,ao.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,ao.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,ao.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,ao.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,ao.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,ao.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,ao.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};class Hd{constructor(e,{pixelRatio:i,version:s,stretchX:d,stretchY:f,content:m}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=d,this.stretchY=f,this.content=m,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Xm{constructor(e,i){const s={},d={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,s,f),this.addImages(i,d,f);const{w:m,h:v}=zh(f),E=new xa({width:m||1,height:v||1});for(const C in e){const R=e[C],N=s[C].paddedRect;xa.copy(R.data,E,{x:0,y:0},{x:N.x+1,y:N.y+1},R.data)}for(const C in i){const R=i[C],N=d[C].paddedRect,$=N.x+1,X=N.y+1,ne=R.data.width,he=R.data.height;xa.copy(R.data,E,{x:0,y:0},{x:$,y:X},R.data),xa.copy(R.data,E,{x:0,y:he-1},{x:$,y:X-1},{width:ne,height:1}),xa.copy(R.data,E,{x:0,y:0},{x:$,y:X+he},{width:ne,height:1}),xa.copy(R.data,E,{x:ne-1,y:0},{x:$-1,y:X},{width:1,height:he}),xa.copy(R.data,E,{x:0,y:0},{x:$+ne,y:X},{width:1,height:he})}this.image=E,this.iconPositions=s,this.patternPositions=d}addImages(e,i,s){for(const d in e){const f=e[d],m={x:0,y:0,w:f.data.width+2,h:f.data.height+2};s.push(m),i[d]=new Hd(m,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),i)}patchUpdatedImage(e,i,s){if(!e||!i||e.version===i.version)return;e.version=i.version;const[d,f]=e.tl;s.update(i.data,void 0,{x:d,y:f})}}Wn(Hd,"ImagePosition"),Wn(Xm,"ImageAtlas");const hl={horizontal:1,vertical:2,horizontalOnly:3};class ld{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const s=new ld;return s.scale=e||1,s.fontStack=i,s}static forImage(e){const i=new ld;return i.imageName=e,i}}class cd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const s=new cd;for(let d=0;d<e.sections.length;d++){const f=e.sections[d];f.image?s.addImageSection(f):s.addTextSection(f,i)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,s){let d="";for(let f=0;f<i.length;f++){const m=i.charCodeAt(f+1)||null,v=i.charCodeAt(f-1)||null;d+=!s&&(m&&W(m)&&!zd[i[f+1]]||v&&W(v)&&!zd[i[f-1]])||!zd[i[f]]?i[f]:zd[i[f]]}return d}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&Gd[this.text.charCodeAt(s)];s++)e++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&Gd[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const s=new cd;return s.text=this.text.substring(e,i),s.sectionIndex=this.sectionIndex.slice(e,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(ld.forText(e.scale,e.fontStack||i));const s=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(s)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void Tt("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(ld.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Tt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Uh(n,e,i,s,d,f,m,v,E,C,R,N,$,X,ne){const he=cd.fromFeature(n,d);N===hl.vertical&&he.verticalizePunctuation($);let Pe=[];const Xe=function(yt,cn,on,Sn,Gn,yn){if(!yt)return[];const Rn=[],Ln=function(ti,Fi,oi,vi,ni,Ui){let _r=0;for(let yr=0;yr<ti.length();yr++){const pr=ti.getSection(yr);_r+=Qm(ti.getCharCode(yr),pr,vi,ni,Fi,Ui)}return _r/Math.max(1,Math.ceil(_r/oi))}(yt,cn,on,Sn,Gn,yn),Un=yt.text.indexOf("\u200b")>=0;let Zn=0;for(let ti=0;ti<yt.length();ti++){const Fi=yt.getSection(ti),oi=yt.getCharCode(ti);if(Gd[oi]||(Zn+=Qm(oi,Fi,Sn,Gn,cn,yn)),ti<yt.length()-1){const vi=!((vn=oi)<11904||!(Ya(vn)||Vl(vn)||l(vn)||ee(vn)||Mr(vn)||ka(vn)||Si(vn)||Ml(vn)||So(vn)||P(vn)||Ni(vn)||b(vn)||qa(vn)||gs(vn)||la(vn)||Di(vn)||Hr(vn)||t(vn)||D(vn)||k(vn)));(k_[oi]||vi||Fi.imageName)&&Rn.push(Jm(ti+1,Zn,Ln,Rn,L_(oi,yt.getCharCode(ti+1),vi&&Un),!1))}}var vn;return F_(Jm(yt.length(),Zn,Ln,Rn,0,!0))}(he,C,f,e,s,X),{processBidirectionalText:gt,processStyledBidirectionalText:We}=rn;if(gt&&1===he.sections.length){const yt=gt(he.toString(),Xe);for(const cn of yt){const on=new cd;on.text=cn,on.sections=he.sections;for(let Sn=0;Sn<cn.length;Sn++)on.sectionIndex.push(0);Pe.push(on)}}else if(We){const yt=We(he.text,he.sectionIndex,Xe);for(const cn of yt){const on=new cd;on.text=cn[0],on.sectionIndex=cn[1],on.sections=he.sections,Pe.push(on)}}else Pe=function(yt,cn){const on=[],Sn=yt.text;let Gn=0;for(const yn of cn)on.push(yt.substring(Gn,yn)),Gn=yn;return Gn<Sn.length&&on.push(yt.substring(Gn,Sn.length)),on}(he,Xe);const dt=[],Dt={positionedLines:dt,text:he.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(yt,cn,on,Sn,Gn,yn,Rn,Ln,Un,Zn,vn,ti){let Fi=0,oi=0,vi=0;const ni="right"===Ln?1:"left"===Ln?0:.5;let Ui=!1;for(const er of Gn){const vr=er.getSections();for(const eo of vr){if(eo.imageName)continue;const go=cn[eo.fontStack];if(go&&(Ui=void 0!==go.ascender&&void 0!==go.descender,!Ui))break}if(!Ui)break}let _r=0;for(const er of Gn){er.trim();const vr=er.getMaxScale(),eo=(vr-1)*Ks,go={positionedGlyphs:[],lineOffset:0};yt.positionedLines[_r]=go;const ho=go.positionedGlyphs;let _o=0;if(!er.length()){oi+=yn,++_r;continue}let bo=0,zo=0;for(let Zr=0;Zr<er.length();Zr++){const cs=er.getSection(Zr),Jo=er.getSectionIndex(Zr),Rr=er.getCharCode(Zr);let Ao=cs.scale,us=null,Wr=null,Uo=null,Xs=Ks,Ms=0;const Ds=!(Un===hl.horizontal||!vn&&!q(Rr)||vn&&(Gd[Rr]||(yr=Rr,Cl(yr)||Ra(yr)||Po(yr)||u(yr)||_(yr))));if(cs.imageName){const ha=Sn[cs.imageName];if(!ha)continue;Uo=cs.imageName,yt.iconsInText=yt.iconsInText||!0,Wr=ha.paddedRect;const Ts=ha.displaySize;Ao=Ao*Ks/ti,us={width:Ts[0],height:Ts[1],left:1,top:-3,advance:Ds?Ts[1]:Ts[0],localGlyph:!1},Ms=Ui?-us.height*Ao:vr*Ks-17-Ts[1]*Ao,Xs=us.advance;const wc=(Ds?Ts[0]:Ts[1])*Ao-Ks*vr;wc>0&&wc>_o&&(_o=wc)}else{const ha=on[cs.fontStack];if(!ha)continue;ha[Rr]&&(Wr=ha[Rr]);const Ts=cn[cs.fontStack];if(!Ts)continue;const wc=Ts.glyphs[Rr];if(!wc)continue;if(us=wc.metrics,Xs=8203!==Rr?Ks:0,Ui){const Jc=void 0!==Ts.ascender?Math.abs(Ts.ascender):0,Fu=void 0!==Ts.descender?Math.abs(Ts.descender):0,nc=(Jc+Fu)*Ao;bo<nc&&(bo=nc,zo=(Jc-Fu)/2*Ao),Ms=-Jc*Ao}else Ms=(vr-Ao)*Ks-17}Ds?(yt.verticalizable=!0,ho.push({glyph:Rr,imageName:Uo,x:Fi,y:oi+Ms,vertical:Ds,scale:Ao,localGlyph:us.localGlyph,fontStack:cs.fontStack,sectionIndex:Jo,metrics:us,rect:Wr}),Fi+=Xs*Ao+Zn):(ho.push({glyph:Rr,imageName:Uo,x:Fi,y:oi+Ms,vertical:Ds,scale:Ao,localGlyph:us.localGlyph,fontStack:cs.fontStack,sectionIndex:Jo,metrics:us,rect:Wr}),Fi+=us.advance*Ao+Zn)}0!==ho.length&&(vi=Math.max(Fi-Zn,vi),Ui?lf(ho,ni,_o,zo,yn*vr/2):lf(ho,ni,_o,0,yn/2)),Fi=0;const zs=yn*vr+_o;go.lineOffset=Math.max(_o,eo),oi+=zs,++_r}var yr;const pr=oi,{horizontalAlign:Hi,verticalAlign:$r}=$d(Rn);(function(er,vr,eo,go,ho,_o){const bo=(vr-eo)*ho,zo=-_o*go;for(const zs of er)for(const Zr of zs.positionedGlyphs)Zr.x+=bo,Zr.y+=zo})(yt.positionedLines,ni,Hi,$r,vi,pr),yt.top+=-$r*pr,yt.bottom=yt.top+pr,yt.left+=-Hi*vi,yt.right=yt.left+vi,yt.hasBaseline=Ui}(Dt,e,i,s,Pe,m,v,E,N,C,$,ne),!function(yt){for(const cn of yt)if(0!==cn.positionedGlyphs.length)return!1;return!0}(dt)&&Dt}const Gd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},k_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Qm(n,e,i,s,d,f){if(e.imageName){const m=s[e.imageName];return m?m.displaySize[0]*e.scale*Ks/f+d:0}{const m=i[e.fontStack],v=m&&m.glyphs[n];return v?v.metrics.advance*e.scale+d:0}}function el(n,e,i,s){const d=Math.pow(n-e,2);return s?n<e?d/2:2*d:d+Math.abs(i)*i}function L_(n,e,i){let s=0;return 10===n&&(s-=1e4),i&&(s+=150),40!==n&&65288!==n||(s+=50),41!==e&&65289!==e||(s+=50),s}function Jm(n,e,i,s,d,f){let m=null,v=el(e,i,d,f);for(const E of s){const C=el(e-E.x,i,d,f)+E.badness;C<=v&&(m=E,v=C)}return{index:n,x:e,priorBreak:m,badness:v}}function F_(n){return n?F_(n.priorBreak).concat(n.index):[]}function $d(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function lf(n,e,i,s,d){if(!(e||i||s||d))return;const f=n.length-1,m=n[f],v=(m.x+m.metrics.advance*m.scale)*e;for(let E=0;E<=f;E++)n[E].x-=v,n[E].y+=i+s+d}function B_(n,e,i){const{horizontalAlign:s,verticalAlign:d}=$d(i),f=e[0]-n.displaySize[0]*s,m=e[1]-n.displaySize[1]*d;return{image:n,top:m,bottom:m+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function eg(n,e,i,s,d,f){const m=n.image;let v;if(m.content){const Pe=m.content,Xe=m.pixelRatio||1;v=[Pe[0]/Xe,Pe[1]/Xe,m.displaySize[0]-Pe[2]/Xe,m.displaySize[1]-Pe[3]/Xe]}const E=e.left*f,C=e.right*f;let R,N,$,X;"width"===i||"both"===i?(X=d[0]+E-s[3],N=d[0]+C+s[1]):(X=d[0]+(E+C-m.displaySize[0])/2,N=X+m.displaySize[0]);const ne=e.top*f,he=e.bottom*f;return"height"===i||"both"===i?(R=d[1]+ne-s[0],$=d[1]+he+s[2]):(R=d[1]+(ne+he-m.displaySize[1])/2,$=R+m.displaySize[1]),{image:m,top:R,right:N,bottom:$,left:X,collisionPadding:v}}class kc extends ht{constructor(e,i,s,d,f){super(e,i),this.angle=d,this.z=s,void 0!==f&&(this.segment=f)}clone(){return new kc(this.x,this.y,this.z,this.angle,this.segment)}}function cf(n,e,i,s,d){if(void 0===e.segment)return!0;let f=e,m=e.segment+1,v=0;for(;v>-i/2;){if(m--,m<0)return!1;v-=n[m].dist(f),f=n[m]}v+=n[m].dist(n[m+1]),m++;const E=[];let C=0;for(;v<i/2;){const R=n[m],N=n[m+1];if(!N)return!1;let $=n[m-1].angleTo(R)-R.angleTo(N);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:v,angleDelta:$}),C+=$;v-E[0].distance>s;)C-=E.shift().angleDelta;if(C>d)return!1;m++,v+=R.dist(N)}return!0}function tg(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function ng(n,e,i){return n?.6*e*i:0}function Vh(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function N_(n,e,i,s,d,f){const m=ng(i,d,f),v=Vh(i,s)*f;let E=0;const C=tg(n)/2;for(let R=0;R<n.length-1;R++){const N=n[R],$=n[R+1],X=N.dist($);if(E+X>C){const ne=(C-E)/X,he=pi(N.x,$.x,ne),Pe=pi(N.y,$.y,ne),Xe=new kc(he,Pe,0,$.angleTo(N),R);return!m||cf(n,Xe,v,m,e)?Xe:void 0}E+=X}}function z_(n,e,i,s,d,f,m,v,E){const C=ng(s,f,m),R=Vh(s,d),N=R*m,$=0===n[0].x||n[0].x===E||0===n[0].y||n[0].y===E;return e-N<e/4&&(e=N+e/4),ig(n,$?e/2*v%e:(R/2+2*f)*m*v%e,e,C,i,N,$,!1,E)}function ig(n,e,i,s,d,f,m,v,E){const C=f/2,R=tg(n);let N=0,$=e-i,X=[];for(let ne=0;ne<n.length-1;ne++){const he=n[ne],Pe=n[ne+1],Xe=he.dist(Pe),gt=Pe.angleTo(he);for(;$+i<N+Xe;){$+=i;const We=($-N)/Xe,dt=pi(he.x,Pe.x,We),Dt=pi(he.y,Pe.y,We);if(dt>=0&&dt<E&&Dt>=0&&Dt<E&&$-C>=0&&$+C<=R){const yt=new kc(dt,Dt,0,gt,ne);yt._round(),s&&!cf(n,yt,f,s,d)||X.push(yt)}}N+=Xe}return v||X.length||m||(X=ig(n,N/2,i,s,d,f,m,!0,E)),X}function rg(n,e,i,s,d){const f=[];for(let m=0;m<n.length;m++){const v=n[m];let E;for(let C=0;C<v.length-1;C++){let R=v[C],N=v[C+1];R.x<e&&N.x<e||(R.x<e?R=new ht(e,R.y+(e-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x<e&&(N=new ht(e,R.y+(e-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y<i&&N.y<i||(R.y<i?R=new ht(R.x+(i-R.y)/(N.y-R.y)*(N.x-R.x),i)._round():N.y<i&&(N=new ht(R.x+(i-R.y)/(N.y-R.y)*(N.x-R.x),i)._round()),R.x>=s&&N.x>=s||(R.x>=s?R=new ht(s,R.y+(s-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x>=s&&(N=new ht(s,R.y+(s-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y>=d&&N.y>=d||(R.y>=d?R=new ht(R.x+(d-R.y)/(N.y-R.y)*(N.x-R.x),d)._round():N.y>=d&&(N=new ht(R.x+(d-R.y)/(N.y-R.y)*(N.x-R.x),d)._round()),E&&R.equals(E[E.length-1])||(E=[R],f.push(E)),E.push(N)))))}}return f}Wn(kc,"Anchor");const Zd=1e20;function Kl(n,e,i,s,d,f,m,v,E){for(let C=e;C<e+s;C++)jh(n,i*f+C,f,d,m,v,E);for(let C=i;C<i+d;C++)jh(n,C*f+e,1,s,m,v,E)}function jh(n,e,i,s,d,f,m){f[0]=0,m[0]=-Zd,m[1]=Zd,d[0]=n[e];for(let v=1,E=0,C=0;v<s;v++){d[v]=n[e+v*i];const R=v*v;do{const N=f[E];C=(d[v]-d[N]+R-N*N)/(v-N)/2}while(C<=m[E]&&--E>-1);E++,f[E]=v,m[E]=C,m[E+1]=Zd}for(let v=0,E=0;v<s;v++){for(;m[E+1]<v;)E++;const C=f[E],R=v-C;n[e+v*i]=d[C]+R*R}}const uf={none:0,ideographs:1,all:2};class ud{constructor(e,i,s){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const s=[];for(const d in e)for(const f of e[d])s.push({stack:d,id:f});ct(s,({stack:d,id:f},m)=>{let v=this.entries[d];v||(v=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=v.glyphs[f];if(void 0!==E)return void m(null,{stack:d,id:f,glyph:E});if(E=this._tinySDF(v,d,f),E)return v.glyphs[f]=E,void m(null,{stack:d,id:f,glyph:E});const C=Math.floor(f/256);if(256*C>65535)return void m(new Error("glyphs > 65535 not supported"));if(v.ranges[C])return void m(null,{stack:d,id:f,glyph:E});let R=v.requests[C];R||(R=v.requests[C]=[],ud.loadGlyphRange(d,C,this.url,this.requestManager,(N,$)=>{if($){v.ascender=$.ascender,v.descender=$.descender;for(const X in $.glyphs)this._doesCharSupportLocalGlyph(+X)||(v.glyphs[+X]=$.glyphs[+X]);v.ranges[C]=!0}for(const X of R)X(N,$);delete v.requests[C]})),R.push((N,$)=>{N?m(N):$&&m(null,{stack:d,id:f,glyph:$.glyphs[f]||null})})},(d,f)=>{if(d)i(d);else if(f){const m={};for(const{stack:v,id:E,glyph:C}of f)void 0===m[v]&&(m[v]={}),void 0===m[v].glyphs&&(m[v].glyphs={}),m[v].glyphs[E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},m[v].ascender=this.entries[v].ascender,m[v].descender=this.entries[v].descender;i(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==uf.none&&(this.localGlyphMode===uf.all?!!this.localFontFamily:!!this.localFontFamily&&(P(e)||z(e)||qa(e)||Hr(e)||Ml(e)))}_tinySDF(e,i,s){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(s))return;let f=e.tinySDF;if(!f){let he="400";/bold/i.test(i)?he="900":/medium/i.test(i)?he="500":/light/i.test(i)&&(he="200"),f=e.tinySDF=new ud.TinySDF({fontFamily:d,fontWeight:he,fontSize:48,buffer:6,radius:16}),f.fontWeight=he}if(this.localGlyphs[f.fontWeight][s])return this.localGlyphs[f.fontWeight][s];const m=String.fromCharCode(s),{data:v,width:E,height:C,glyphWidth:R,glyphHeight:N,glyphLeft:$,glyphTop:X,glyphAdvance:ne}=f.draw(m);return this.localGlyphs[f.fontWeight][s]={id:s,bitmap:new mc({width:E,height:C},v),metrics:{width:R/2,height:N/2,left:$/2,top:X/2-27,advance:ne/2,localGlyph:!0}}}}function df(n,e,i,s){const d=[],f=n.image,m=f.pixelRatio,v=f.paddedRect.w-2,E=f.paddedRect.h-2,C=n.right-n.left,R=n.bottom-n.top,N=f.stretchX||[[0,v]],$=f.stretchY||[[0,E]],X=(yn,Rn)=>yn+Rn[1]-Rn[0],ne=N.reduce(X,0),he=$.reduce(X,0),Pe=v-ne,Xe=E-he;let gt=0,We=ne,dt=0,Dt=he,yt=0,cn=Pe,on=0,Sn=Xe;if(f.content&&s){const yn=f.content;gt=Hh(N,0,yn[0]),dt=Hh($,0,yn[1]),We=Hh(N,yn[0],yn[2]),Dt=Hh($,yn[1],yn[3]),yt=yn[0]-gt,on=yn[1]-dt,cn=yn[2]-yn[0]-We,Sn=yn[3]-yn[1]-Dt}const Gn=(yn,Rn,Ln,Un)=>{const Zn=Gh(yn.stretch-gt,We,C,n.left),vn=dd(yn.fixed-yt,cn,yn.stretch,ne),ti=Gh(Rn.stretch-dt,Dt,R,n.top),Fi=dd(Rn.fixed-on,Sn,Rn.stretch,he),oi=Gh(Ln.stretch-gt,We,C,n.left),vi=dd(Ln.fixed-yt,cn,Ln.stretch,ne),ni=Gh(Un.stretch-dt,Dt,R,n.top),Ui=dd(Un.fixed-on,Sn,Un.stretch,he),_r=new ht(Zn,ti),yr=new ht(oi,ti),pr=new ht(oi,ni),Hi=new ht(Zn,ni),$r=new ht(vn/m,Fi/m),er=new ht(vi/m,Ui/m),vr=e*Math.PI/180;if(vr){const ho=Math.sin(vr),_o=Math.cos(vr),bo=[_o,-ho,ho,_o];_r._matMult(bo),yr._matMult(bo),Hi._matMult(bo),pr._matMult(bo)}const eo=yn.stretch+yn.fixed,go=Rn.stretch+Rn.fixed;return{tl:_r,tr:yr,bl:Hi,br:pr,tex:{x:f.paddedRect.x+1+eo,y:f.paddedRect.y+1+go,w:Ln.stretch+Ln.fixed-eo,h:Un.stretch+Un.fixed-go},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:$r,pixelOffsetBR:er,minFontScaleX:cn/m/C,minFontScaleY:Sn/m/R,isSDF:i}};if(s&&(f.stretchX||f.stretchY)){const yn=og(N,Pe,ne),Rn=og($,Xe,he);for(let Ln=0;Ln<yn.length-1;Ln++){const Un=yn[Ln],Zn=yn[Ln+1];for(let vn=0;vn<Rn.length-1;vn++)d.push(Gn(Un,Rn[vn],Zn,Rn[vn+1]))}}else d.push(Gn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:E+1}));return d}function Hh(n,e,i){let s=0;for(const d of n)s+=Math.max(e,Math.min(i,d[1]))-Math.max(e,Math.min(i,d[0]));return s}function og(n,e,i){const s=[{fixed:-1,stretch:0}];for(const[d,f]of n){const m=s[s.length-1];s.push({fixed:d-m.stretch,stretch:m.stretch}),s.push({fixed:d-m.stretch,stretch:m.stretch+(f-d)})}return s.push({fixed:e+1,stretch:i}),s}function Gh(n,e,i,s){return n/e*i+s}function dd(n,e,i,s){return n-e*i/s}function U_(n,e,i,s){const d=e+n.positionedLines[s].lineOffset;return 0===s?i+d/2:i+(d+(e+n.positionedLines[s-1].lineOffset))/2}ud.loadGlyphRange=function(n,e,i,s,d){const f=256*e,m=f+255,v=s.transformRequest(s.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${f}-${m}`),At.Glyphs);ln(v,(E,C)=>{if(E)d(E);else if(C){const R={},N=new od(C).readFields(rf,{});for(const $ of N.glyphs)R[$.id]=$;d(null,{glyphs:R,ascender:N.ascender,descender:N.descender})}})},ud.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:s=.25,fontFamily:d="sans-serif",fontWeight:f="normal",fontStyle:m="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=i;const v=this.size=n+4*e,E=this._createCanvas(v),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${m} ${f} ${n}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:d,actualBoundingBoxRight:f}=this.ctx.measureText(n),m=Math.ceil(i),v=Math.min(this.size-this.buffer,Math.ceil(f-d)),E=Math.min(this.size-this.buffer,m+Math.ceil(s)),C=v+2*this.buffer,R=E+2*this.buffer,N=Math.max(C*R,0),$=new Uint8ClampedArray(N),X={data:$,width:C,height:R,glyphWidth:v,glyphHeight:E,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(0===v||0===E)return X;const{ctx:ne,buffer:he,gridInner:Pe,gridOuter:Xe}=this;ne.clearRect(he,he,v,E),ne.fillText(n,he,he+m);const gt=ne.getImageData(he,he,v,E);Xe.fill(Zd,0,N),Pe.fill(0,0,N);for(let We=0;We<E;We++)for(let dt=0;dt<v;dt++){const Dt=gt.data[4*(We*v+dt)+3]/255;if(0===Dt)continue;const yt=(We+he)*C+dt+he;if(1===Dt)Xe[yt]=0,Pe[yt]=Zd;else{const cn=.5-Dt;Xe[yt]=cn>0?cn*cn:0,Pe[yt]=cn<0?cn*cn:0}}Kl(Xe,0,0,C,R,C,this.f,this.v,this.z),Kl(Pe,he,he,v,E,C,this.f,this.v,this.z);for(let We=0;We<N;We++){const dt=Math.sqrt(Xe[We])-Math.sqrt(Pe[We]);$[We]=Math.round(255-255*(dt/this.radius+this.cutoff))}return X}};class V_{constructor(e=[],i=$h){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:s}=this,d=i[e];for(;e>0;){const f=e-1>>1,m=i[f];if(s(d,m)>=0)break;i[e]=m,e=f}i[e]=d}_down(e){const{data:i,compare:s}=this,d=this.length>>1,f=i[e];for(;e<d;){let m=1+(e<<1),v=i[m];const E=m+1;if(E<this.length&&s(i[E],v)<0&&(m=E,v=i[E]),s(v,f)>=0)break;i[e]=v,e=m}i[e]=f}}function $h(n,e){return n<e?-1:n>e?1:0}function Zh(n,e=1,i=!1){let s=1/0,d=1/0,f=-1/0,m=-1/0;const v=n[0];for(let X=0;X<v.length;X++){const ne=v[X];(!X||ne.x<s)&&(s=ne.x),(!X||ne.y<d)&&(d=ne.y),(!X||ne.x>f)&&(f=ne.x),(!X||ne.y>m)&&(m=ne.y)}const E=Math.min(f-s,m-d);let C=E/2;const R=new V_([],Wh);if(0===E)return new ht(s,d);for(let X=s;X<f;X+=E)for(let ne=d;ne<m;ne+=E)R.push(new Wd(X+C,ne+C,C,n));let N=function(X){let ne=0,he=0,Pe=0;const Xe=X[0];for(let gt=0,We=Xe.length,dt=We-1;gt<We;dt=gt++){const Dt=Xe[gt],yt=Xe[dt],cn=Dt.x*yt.y-yt.x*Dt.y;he+=(Dt.x+yt.x)*cn,Pe+=(Dt.y+yt.y)*cn,ne+=3*cn}return new Wd(he/ne,Pe/ne,0,X)}(n),$=R.length;for(;R.length;){const X=R.pop();(X.d>N.d||!N.d)&&(N=X,i&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,$)),X.max-N.d<=e||(C=X.h/2,R.push(new Wd(X.p.x-C,X.p.y-C,C,n)),R.push(new Wd(X.p.x+C,X.p.y-C,C,n)),R.push(new Wd(X.p.x-C,X.p.y+C,C,n)),R.push(new Wd(X.p.x+C,X.p.y+C,C,n)),$+=4)}return i&&(console.log(`num probes: ${$}`),console.log(`best distance: ${N.d}`)),N.p}function Wh(n,e){return e.max-n.max}function Wd(n,e,i,s){this.p=new ht(n,e),this.h=i,this.d=function(d,f){let m=!1,v=1/0;for(let E=0;E<f.length;E++){const C=f[E];for(let R=0,N=C.length,$=N-1;R<N;$=R++){const X=C[R],ne=C[$];X.y>d.y!=ne.y>d.y&&d.x<(ne.x-X.x)*(d.y-X.y)/(ne.y-X.y)+X.x&&(m=!m),v=Math.min(v,yh(d,X,ne))}}return(m?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const qd=Number.POSITIVE_INFINITY,zy=Math.sqrt(2);function hf(n,[e,i]){let s=0,d=0;if(i===qd){e<0&&(e=0);const f=e/zy;switch(n){case"top-right":case"top-left":d=f-7;break;case"bottom-right":case"bottom-left":d=7-f;break;case"bottom":d=7-e;break;case"top":d=e-7}switch(n){case"top-right":case"bottom-right":s=-f;break;case"top-left":case"bottom-left":s=f;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),n){case"top-right":case"top-left":case"top":d=i-7;break;case"bottom-right":case"bottom-left":case"bottom":d=7-i}switch(n){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,d]}function sg(n,e,i,s,d,f,m,v,E,C){n.createArrays(),n.tilePixelRatio=qi/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const R=n.layers[0].layout,N=n.layers[0]._unevaluatedLayout._values,$={};if("composite"===n.textSizeData.kind){const{minZoom:he,maxZoom:Pe}=n.textSizeData;$.compositeTextSizes=[N["text-size"].possiblyEvaluate(new Wt(he),v),N["text-size"].possiblyEvaluate(new Wt(Pe),v)]}if("composite"===n.iconSizeData.kind){const{minZoom:he,maxZoom:Pe}=n.iconSizeData;$.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new Wt(he),v),N["icon-size"].possiblyEvaluate(new Wt(Pe),v)]}$.layoutTextSize=N["text-size"].possiblyEvaluate(new Wt(E+1),v),$.layoutIconSize=N["icon-size"].possiblyEvaluate(new Wt(E+1),v),$.textMaxSize=N["text-size"].possiblyEvaluate(new Wt(18),v);const X="map"===R.get("text-rotation-alignment")&&"point"!==R.get("symbol-placement"),ne=R.get("text-size");for(const he of n.features){const Pe=R.get("text-font").evaluate(he,{},v).join(","),Xe=ne.evaluate(he,{},v),gt=$.layoutTextSize.evaluate(he,{},v),We=($.layoutIconSize.evaluate(he,{},v),{horizontal:{},vertical:void 0}),dt=he.text;let Dt,yt=[0,0];if(dt){const Sn=dt.toString(),Gn=R.get("text-letter-spacing").evaluate(he,{},v)*Ks,yn=R.get("text-line-height").evaluate(he,{},v)*Ks,Rn=O(Sn)?Gn:0,Ln=R.get("text-anchor").evaluate(he,{},v),Un=R.get("text-variable-anchor");if(!Un){const oi=R.get("text-radial-offset").evaluate(he,{},v);yt=oi?hf(Ln,[oi*Ks,qd]):R.get("text-offset").evaluate(he,{},v).map(vi=>vi*Ks)}let Zn=X?"center":R.get("text-justify").evaluate(he,{},v);const vn="point"===R.get("symbol-placement"),ti=vn?R.get("text-max-width").evaluate(he,{},v)*Ks:1/0,Fi=oi=>{n.allowVerticalPlacement&&M(Sn)&&(We.vertical=Uh(dt,e,i,d,Pe,ti,yn,Ln,oi,Rn,yt,hl.vertical,!0,gt,Xe))};if(!X&&Un){const oi="auto"===Zn?Un.map(ni=>qh(ni)):[Zn];let vi=!1;for(let ni=0;ni<oi.length;ni++){const Ui=oi[ni];if(!We.horizontal[Ui])if(vi)We.horizontal[Ui]=We.horizontal[0];else{const _r=Uh(dt,e,i,d,Pe,ti,yn,"center",Ui,Rn,yt,hl.horizontal,!1,gt,Xe);_r&&(We.horizontal[Ui]=_r,vi=1===_r.positionedLines.length)}}Fi("left")}else{if("auto"===Zn&&(Zn=qh(Ln)),vn||R.get("text-writing-mode").indexOf("horizontal")>=0||!M(Sn)){const oi=Uh(dt,e,i,d,Pe,ti,yn,Ln,Zn,Rn,yt,hl.horizontal,!1,gt,Xe);oi&&(We.horizontal[Zn]=oi)}Fi(vn?"left":Zn)}}let cn=!1;if(he.icon&&he.icon.name){const Sn=s[he.icon.name];Sn&&(Dt=B_(d[he.icon.name],R.get("icon-offset").evaluate(he,{},v),R.get("icon-anchor").evaluate(he,{},v)),cn=Sn.sdf,void 0===n.sdfIcons?n.sdfIcons=Sn.sdf:n.sdfIcons!==Sn.sdf&&Tt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Sn.pixelRatio!==n.pixelRatio||0!==R.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const on=Yd(We.horizontal)||We.vertical;n.iconsInText||(n.iconsInText=!!on&&on.iconsInText),(on||Dt)&&ag(n,he,We,Dt,s,$,gt,0,yt,cn,m,v,C)}f&&n.generateCollisionDebugBuffers(E,n.collisionBoxArray)}function qh(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ag(n,e,i,s,d,f,m,v,E,C,R,N,$){let X=f.textMaxSize.evaluate(e,{},N);void 0===X&&(X=m);const ne=n.layers[0].layout,he=ne.get("icon-offset").evaluate(e,{},N),Pe=Yd(i.horizontal)||i.vertical,Xe="globe"===$.name,gt=m/24,We=n.tilePixelRatio*X/24,dt=(Rn=n.overscaling,n.zoom>18&&Rn>2&&(Rn>>=1),Math.max(qi/(512*Rn),1)*ne.get("symbol-spacing")),Dt=ne.get("text-padding")*n.tilePixelRatio,yt=ne.get("icon-padding")*n.tilePixelRatio,cn=Te(ne.get("text-max-angle")),on="map"===ne.get("text-rotation-alignment")&&"point"!==ne.get("symbol-placement"),Sn="map"===ne.get("icon-rotation-alignment")&&"point"!==ne.get("symbol-placement"),Gn=ne.get("symbol-placement"),yn=dt/2;var Rn;const Ln=ne.get("icon-text-fit");let Un;s&&"none"!==Ln&&(n.allowVerticalPlacement&&i.vertical&&(Un=eg(s,i.vertical,Ln,ne.get("icon-text-fit-padding"),he,gt)),Pe&&(s=eg(s,Pe,Ln,ne.get("icon-text-fit-padding"),he,gt)));const Zn=(vn,ti,Fi)=>{if(ti.x<0||ti.x>=qi||ti.y<0||ti.y>=qi)return;let oi=null;if(Xe){const{x:vi,y:ni,z:Ui}=$.projectTilePoint(ti.x,ti.y,Fi);oi={anchor:new kc(vi,ni,Ui,0,void 0),up:$.upVector(Fi,ti.x,ti.y)}}!function(vi,ni,Ui,_r,yr,pr,Hi,$r,er,vr,eo,go,ho,_o,bo,zo,zs,Zr,cs,Jo,Rr,Ao,us,Wr,Uo){const Xs=vi.addToLineVertexArray(ni,_r);let Ms,Ds,ha,Ts,wc,Jc,Fu,nc=0,Fg=0,Bg=0,Bu=0,Ng=-1,lh=-1;const zc={};let zf=au.exports("");const eu=Ui?Ui.anchor:ni;let zg=0,tr=0;if(void 0===er._unevaluatedLayout.getValue("text-radial-offset")?[zg,tr]=er.layout.get("text-offset").evaluate(Rr,{},Uo).map(Us=>Us*Ks):(zg=er.layout.get("text-radial-offset").evaluate(Rr,{},Uo)*Ks,tr=qd),vi.allowVerticalPlacement&&yr.vertical){const Us=yr.vertical;if(bo)Jc=Tu(Us),$r&&(Fu=Tu($r));else{const tl=er.layout.get("text-rotate").evaluate(Rr,{},Uo)+90;ha=Du(vr,eu,ni,eo,go,ho,Us,_o,tl,zo),$r&&(Ts=Du(vr,eu,ni,eo,go,ho,$r,Zr,tl))}}if(pr){const Us=er.layout.get("icon-rotate").evaluate(Rr,{},Uo),tl="none"!==er.layout.get("icon-text-fit"),nu=df(pr,Us,us,tl),vd=$r?df($r,Us,us,tl):void 0;Ds=Du(vr,eu,ni,eo,go,ho,pr,Zr,Us),nc=4*nu.length;const es=vi.iconSizeData;let bd=null;"source"===es.kind?(bd=[Yl*er.layout.get("icon-size").evaluate(Rr,{},Uo)],bd[0]>yc&&Tt(`${vi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===es.kind&&(bd=[Yl*Ao.compositeIconSizes[0].evaluate(Rr,{},Uo),Yl*Ao.compositeIconSizes[1].evaluate(Rr,{},Uo)],(bd[0]>yc||bd[1]>yc)&&Tt(`${vi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),vi.addSymbols(vi.icon,nu,bd,Jo,cs,Rr,!1,Ui,ni,Xs.lineStartIndex,Xs.lineLength,-1,Wr,Uo),Ng=vi.icon.placedSymbolArray.length-1,vd&&(Fg=4*vd.length,vi.addSymbols(vi.icon,vd,bd,Jo,cs,Rr,hl.vertical,Ui,ni,Xs.lineStartIndex,Xs.lineLength,-1,Wr,Uo),lh=vi.icon.placedSymbolArray.length-1)}for(const Us in yr.horizontal){const tl=yr.horizontal[Us];Ms||(zf=au.exports(tl.text),bo?wc=Tu(tl):Ms=Du(vr,eu,ni,eo,go,ho,tl,_o,er.layout.get("text-rotate").evaluate(Rr,{},Uo),zo));const nu=1===tl.positionedLines.length;if(Bg+=vc(vi,Ui,ni,tl,Hi,er,bo,Rr,zo,Xs,yr.vertical?hl.horizontal:hl.horizontalOnly,nu?Object.keys(yr.horizontal):[Us],zc,Ng,Ao,Wr,Uo),nu)break}yr.vertical&&(Bu+=vc(vi,Ui,ni,yr.vertical,Hi,er,bo,Rr,zo,Xs,hl.vertical,["vertical"],zc,lh,Ao,Wr,Uo));let tu=-1;const Uf=(Us,tl)=>Us?Math.max(Us,tl):tl;tu=Uf(wc,tu),tu=Uf(Jc,tu),tu=Uf(Fu,tu);const K_=tu>-1?1:0;vi.glyphOffsetArray.length>=xc.MAX_GLYPHS&&Tt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Rr.sortKey&&vi.addToSortKeyRanges(vi.symbolInstances.length,Rr.sortKey),vi.symbolInstances.emplaceBack(eu.x,eu.y,eu.z,ni.x,ni.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical>=0?zc.vertical:-1,Ng,lh,zf,void 0!==Ms?Ms:vi.collisionBoxArray.length,void 0!==Ms?Ms+1:vi.collisionBoxArray.length,void 0!==ha?ha:vi.collisionBoxArray.length,void 0!==ha?ha+1:vi.collisionBoxArray.length,void 0!==Ds?Ds:vi.collisionBoxArray.length,void 0!==Ds?Ds+1:vi.collisionBoxArray.length,Ts||vi.collisionBoxArray.length,Ts?Ts+1:vi.collisionBoxArray.length,eo,Bg,Bu,nc,Fg,K_,0,zg,tr,tu)}(n,ti,oi,vn,i,s,d,Un,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,Dt,on,E,0,yt,Sn,he,e,f,C,R,N)};if("line"===Gn)for(const vn of rg(e.geometry,0,0,qi,qi)){const ti=z_(vn,dt,cn,i.vertical||Pe,s,24,We,n.overscaling,qi);for(const Fi of ti)Pe&&j_(n,Pe.text,yn,Fi)||Zn(vn,Fi,N)}else if("line-center"===Gn){for(const vn of e.geometry)if(vn.length>1){const ti=N_(vn,cn,i.vertical||Pe,s,24,We);ti&&Zn(vn,ti,N)}}else if("Polygon"===e.type)for(const vn of Gp(e.geometry,0)){const ti=Zh(vn,16);Zn(vn[0],new kc(ti.x,ti.y,0,0,void 0),N)}else if("LineString"===e.type)for(const vn of e.geometry)Zn(vn,new kc(vn[0].x,vn[0].y,0,0,void 0),N);else if("Point"===e.type)for(const vn of e.geometry)for(const ti of vn)Zn([ti],new kc(ti.x,ti.y,0,0,void 0),N)}const yc=32640;function vc(n,e,i,s,d,f,m,v,E,C,R,N,$,X,ne,he,Pe){const Xe=function(dt,Dt,yt,cn,on,Sn,Gn,yn){const Rn=[];if(0===Dt.positionedLines.length)return Rn;const Ln=cn.layout.get("text-rotate").evaluate(Sn,{})*Math.PI/180,Un=function(oi){const vi=oi[0],ni=oi[1],Ui=vi*ni;return Ui>0?[vi,-ni]:Ui<0?[-vi,ni]:0===vi?[ni,vi]:[ni,-vi]}(yt);let Zn=Math.abs(Dt.top-Dt.bottom);for(const oi of Dt.positionedLines)Zn-=oi.lineOffset;const vn=Dt.positionedLines.length,ti=Zn/vn;let Fi=Dt.top-yt[1];for(let oi=0;oi<vn;++oi){const vi=Dt.positionedLines[oi];Fi=U_(Dt,ti,Fi,oi);for(const ni of vi.positionedGlyphs){if(!ni.rect)continue;const Ui=ni.rect||{};let _r=4,yr=!0,pr=1,Hi=0;if(ni.imageName){const Wr=Gn[ni.imageName];if(!Wr)continue;if(Wr.sdf){Tt("SDF images are not supported in formatted text and will be ignored.");continue}yr=!1,pr=Wr.pixelRatio,_r=1/pr}const $r=(on||yn)&&ni.vertical,er=ni.metrics.advance*ni.scale/2,vr=ni.metrics,eo=ni.rect;if(null===eo)continue;yn&&Dt.verticalizable&&(Hi=ni.imageName?er-ni.metrics.width*ni.scale/2:0);const go=on?[ni.x+er,ni.y]:[0,0];let ho=[0,0],_o=[0,0],bo=!1;on||($r?(_o=[ni.x+er+Un[0],ni.y+Un[1]-Hi],bo=!0):ho=[ni.x+er+yt[0],ni.y+yt[1]-Hi]);const zo=eo.w*ni.scale/(pr*(ni.localGlyph?2:1)),zs=eo.h*ni.scale/(pr*(ni.localGlyph?2:1));let Zr,cs,Jo,Rr;if($r){const Wr=ni.y-Fi,Uo=new ht(-er,er-Wr),Xs=-Math.PI/2,Ms=new ht(..._o);Zr=new ht(-er+ho[0],ho[1]),Zr._rotateAround(Xs,Uo)._add(Ms),Zr.x+=-Wr+er,Zr.y-=(vr.left-_r)*ni.scale;const Ds=ni.imageName?vr.advance*ni.scale:Ks*ni.scale,ha=String.fromCharCode(ni.glyph);S_(ha)?Zr.x+=(1-_r)*ni.scale:A_(ha)?Zr.x+=Ds-vr.height*ni.scale+(-_r-1)*ni.scale:Zr.x+=ni.imageName||vr.width+2*_r===eo.w&&vr.height+2*_r===eo.h?(Ds-zs)/2:(Ds-(vr.height+2*_r)*ni.scale)/2,cs=new ht(Zr.x,Zr.y-zo),Jo=new ht(Zr.x+zs,Zr.y),Rr=new ht(Zr.x+zs,Zr.y-zo)}else{const Wr=(vr.left-_r)*ni.scale-er+ho[0],Uo=(-vr.top-_r)*ni.scale+ho[1],Xs=Wr+zo,Ms=Uo+zs;Zr=new ht(Wr,Uo),cs=new ht(Xs,Uo),Jo=new ht(Wr,Ms),Rr=new ht(Xs,Ms)}if(Ln){let Wr;Wr=on?new ht(0,0):bo?new ht(Un[0],Un[1]):new ht(yt[0],yt[1]),Zr._rotateAround(Ln,Wr),cs._rotateAround(Ln,Wr),Jo._rotateAround(Ln,Wr),Rr._rotateAround(Ln,Wr)}const Ao=new ht(0,0),us=new ht(0,0);Rn.push({tl:Zr,tr:cs,bl:Jo,br:Rr,tex:Ui,writingMode:Dt.writingMode,glyphOffset:go,sectionIndex:ni.sectionIndex,isSDF:yr,pixelOffsetTL:Ao,pixelOffsetBR:us,minFontScaleX:0,minFontScaleY:0})}}return Rn}(0,s,E,f,m,v,d,n.allowVerticalPlacement),gt=n.textSizeData;let We=null;"source"===gt.kind?(We=[Yl*f.layout.get("text-size").evaluate(v,{},Pe)],We[0]>yc&&Tt(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===gt.kind&&(We=[Yl*ne.compositeTextSizes[0].evaluate(v,{},Pe),Yl*ne.compositeTextSizes[1].evaluate(v,{},Pe)],(We[0]>yc||We[1]>yc)&&Tt(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,Xe,We,E,m,v,R,e,i,C.lineStartIndex,C.lineLength,X,he,Pe);for(const dt of N)$[dt]=n.text.placedSymbolArray.length-1;return 4*Xe.length}function Yd(n){for(const e in n)return n[e];return null}function Du(n,e,i,s,d,f,m,v,E,C){let R=m.top,N=m.bottom,$=m.left,X=m.right;const ne=m.collisionPadding;if(ne&&($-=ne[0],R-=ne[1],X+=ne[2],N+=ne[3]),E){const he=new ht($,R),Pe=new ht(X,R),Xe=new ht($,N),gt=new ht(X,N),We=Te(E);let dt=new ht(0,0);C&&(dt=new ht(C[0],C[1])),he._rotateAround(We,dt),Pe._rotateAround(We,dt),Xe._rotateAround(We,dt),gt._rotateAround(We,dt),$=Math.min(he.x,Pe.x,Xe.x,gt.x),X=Math.max(he.x,Pe.x,Xe.x,gt.x),R=Math.min(he.y,Pe.y,Xe.y,gt.y),N=Math.max(he.y,Pe.y,Xe.y,gt.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,$,R,X,N,v,s,d,f),n.length-1}function Tu(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function j_(n,e,i,s){const d=n.compareText;if(e in d){const f=d[e];for(let m=f.length-1;m>=0;m--)if(s.dist(f[m])<i)return!0}else d[e]=[];return d[e].push(s),!1}const lg=di([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:pf}=lg,cg=di([{name:"a_pos_3",components:3,type:"Int16"}]);var Kd=di([{name:"a_pos",type:"Int16",components:2}]);const pl=qi/Math.PI/2,ff=2*dl(1,0)*pl*Math.PI,hd=[64,32,16],Ol=-pl,Rl=pl,H_=[new Na([Ol,Ol,Ol],[Rl,Rl,Rl]),new Na([Ol,Ol,Ol],[0,0,Rl]),new Na([0,Ol,Ol],[Rl,0,Rl]),new Na([Ol,0,Ol],[0,Rl,Rl]),new Na([0,0,Ol],[Rl,Rl,Rl])];function ug(n,e,i,s=!0){const d=Il([],n._camera.position,n.worldSize),f=[e,i,1,1];bu(f,f,n.pixelMatrixInverse),vm(f,f,1/f[3]);const m=ua([],Ja([],f,d)),v=n.globeMatrix,E=[v[12],v[13],v[14]],C=Ja([],E,d),R=Wu(C),N=ua([],C),$=n.worldSize/(2*Math.PI),X=Pl(N,m),ne=Math.asin($/R);if(ne<Math.acos(X)){if(!s)return null;const Gn=[],yn=[];Il(Gn,m,R/X),ua(yn,Ja(yn,Gn,C)),ua(m,qc(m,C,Il(m,yn,Math.tan(ne)*R)))}const he=[];new Lp(d,m).closestPointOnSphere(E,$,he);const Pe=ua([],Bi(v,0)),Xe=ua([],Bi(v,1)),gt=ua([],Bi(v,2)),We=Pl(Pe,he),dt=Pl(Xe,he),Dt=Pl(gt,he),yt=Ne(Math.asin(-dt/$));let cn=Ne(Math.atan2(We,Dt));cn=n.center.lng+function(Gn,yn){const Rn=(yn-Gn+180)%360-180;return Rn<-180?Rn+360:Rn}(n.center.lng,cn);const on=Zl(cn),Sn=Yt(Sl(yt),0,1);return new Zc(on,Sn)}class G_{constructor(e,i,s){this.a=Ja([],e,s),this.b=Ja([],i,s),this.center=s;const d=ua([],this.a),f=ua([],this.b);this.angle=Math.acos(Pl(d,f))}}function mf(n,e){if(0===n.angle)return null;let i;return i=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(s,d,f,m){const v=Math.sin(f);return s*(Math.sin((1-m)*f)/v)+d*(Math.sin(m*f)/v)}(n.a[e],n.b[e],n.angle,Yt(i,0,1))+n.center[e]}function Xl(n){if(n.z<=1)return H_[n.z+2*n.y+n.x];const e=gf(Kh(n));return Na.fromPoints(e)}function Lc(n,e,i){return Il(n,n,1-i),xh(n,n,e,i)}function dg(n,e){const i=Su(e.zoom);if(0===i)return Xl(n);const s=Kh(n),d=gf(s),f=Zl(s.getWest())*e.worldSize,m=Zl(s.getEast())*e.worldSize,v=Sl(s.getNorth())*e.worldSize,E=Sl(s.getSouth())*e.worldSize,C=[f,v,0],R=[m,v,0],N=[f,E,0],$=[m,E,0],X=Ap([],e.globeMatrix);return $o(C,C,X),$o(R,R,X),$o(N,N,X),$o($,$,X),d[0]=Lc(d[0],N,i),d[1]=Lc(d[1],$,i),d[2]=Lc(d[2],R,i),d[3]=Lc(d[3],C,i),Na.fromPoints(d)}function Yh(n,e,i){for(const s of n)$o(s,s,e),Il(s,s,i)}function Kh({x:n,y:e,z:i}){const s=1/(1<<i),d=new Ar(ba(n*s),_s((e+1)*s)),f=new Ar(ba((n+1)*s),_s(e*s));return new uu(d,f)}function gf(n){const e=Te(n.getNorth()),i=Te(n.getSouth()),s=Math.cos(e),d=Math.cos(i),f=Math.sin(e),m=Math.sin(i),v=n.getWest(),E=n.getEast();return[pd(d,m,v),pd(d,m,E),pd(s,f,E),pd(s,f,v)]}function pd(n,e,i,s=pl){return i=Te(i),[n*Math.sin(i)*s,-e*s,n*Math.cos(i)*s]}function Qd(n,e,i){return pd(Math.cos(Te(n)),Math.sin(Te(n)),e,i)}function Jd(n,e,i,s){const d=1<<i.z,f=(n/qi+i.x)/d;return Qd(_s((e/qi+i.y)/d),ba(f),s)}function Xh({min:n,max:e}){return 16383/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const _f=new Float64Array(16);function fd(n){const e=Xh(n),i=mm(_f,[e,e,e]);return Zu(i,i,((s=[])[0]=-(d=n.min)[0],s[1]=-d[1],s[2]=-d[2],s));var s,d}function yf(n){const e=(s=n.min,(i=_f)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=s[0],i[13]=s[1],i[14]=s[2],i[15]=1,i);var i,s;const d=1/Xh(n);return mu(e,e,[d,d,d])}function Z_(n,e,i,s,d){const f=function(E){const C=qi/(2*Math.PI);return E/(2*Math.PI)/C}(i),m=[n,e,-i/(2*Math.PI)],v=Wl(new Float64Array(16));return Zu(v,v,m),mu(v,v,[f,f,f]),Ip(v,v,Te(-d)),bh(v,v,Te(-s)),v}function Su(n){return nt(5,6,n)}function W_(n,e){const i=Qd(e.lat,e.lng);return m=(d=gm([],function(ne){const he=Qd(ne._center.lat,ne._center.lng);let Pe=Op([],_u(0,1,0),he);const Xe=Td([],-ne.angle,he);Pe=$o(Pe,Pe,Xe),Td(Xe,-ne._pitch,Pe);const gt=ua([],he);return Il(gt,gt,ne.cameraToCenterDistance/ne.pixelsPerMeter*ff),$o(gt,gt,Xe),qc([],he,gt)}(n),i))[0],v=d[1],E=d[2],C=(f=i)[0],R=f[1],N=f[2],X=($=Math.sqrt(m*m+v*v+E*E)*Math.sqrt(C*C+R*R+N*N))&&Pl(d,f)/$,Math.acos(Math.min(Math.max(X,-1),1));var d,f,m,v,E,C,R,N,$,X}function md(n,e){return W_(n,e)>Math.PI/2*1.01}const hg=Te(85),q_=Math.cos(hg),vf=Math.sin(hg);function pg(n,e){const i=n.fovAboveCenter,s=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,d=(n._camera.position[2]*n.worldSize-s)/Math.cos(n._pitch),f=Math.sin(i)*d/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),m=Math.sin(n._pitch)*f+d;return Math.min(1.01*m,d*(1/n._horizonShift))}function wa(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const i=Math.pow(2,-n.z),s=n.x*i,d=(n.x+1)*i,f=n.y*i,m=(n.y+1)*i,v=ba(s),E=ba(d),C=_s(f),R=_s(m),N=e.project(v,C),$=e.project(E,C),X=e.project(E,R),ne=e.project(v,R);let he=Math.min(N.x,$.x,X.x,ne.x),Pe=Math.min(N.y,$.y,X.y,ne.y),Xe=Math.max(N.x,$.x,X.x,ne.x),gt=Math.max(N.y,$.y,X.y,ne.y);const We=i/16;function dt(yt,cn,on,Sn,Gn,yn){const Rn=(on+Gn)/2,Ln=(Sn+yn)/2,Un=e.project(ba(Rn),_s(Ln)),Zn=Math.max(0,he-Un.x,Pe-Un.y,Un.x-Xe,Un.y-gt);he=Math.min(he,Un.x),Xe=Math.max(Xe,Un.x),Pe=Math.min(Pe,Un.y),gt=Math.max(gt,Un.y),Zn>We&&(dt(yt,Un,on,Sn,Rn,Ln),dt(Un,cn,Rn,Ln,Gn,yn))}dt(N,$,s,f,d,f),dt($,X,d,f,d,m),dt(X,ne,d,m,s,m),dt(ne,N,s,m,s,f),he-=We,Pe-=We,Xe+=We,gt+=We;const Dt=1/Math.max(Xe-he,gt-Pe);return{scale:Dt,x:he*Dt,y:Pe*Dt,x2:Xe*Dt,y2:gt*Dt,projection:e}}const eh=Wl(new Float32Array(16));class Xo{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Ar(0,0)}projectTilePoint(e,i,s){return{x:e,y:i,z:0}}locationPoint(e,i,s=!0){return e._coordinatePoint(e.locationCoordinate(i),s)}pixelsPerMeter(e,i){return dl(1,e)*i}pixelSpaceConversion(e,i,s){return 1}farthestPixelDistance(e){return pg(e,e.pixelsPerMeter)}pointCoordinate(e,i,s,d){const f=e.horizonLineFromTop(!1),m=new ht(i,Math.max(f,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(m,d))}pointCoordinate3D(e,i,s){const d=new ht(i,s);if(e.elevation)return e.elevation.pointCoordinate(d);{const f=this.pointCoordinate(e,d.x,d.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const s=e.horizonLineFromTop();return i.y<s}createInversionMatrix(e,i){return eh}createTileMatrix(e,i,s){let d,f,m;const v=s.canonical,E=Wl(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=wa(v,this);d=1,f=C.x+s.wrap*C.scale,m=C.y,mu(E,E,[d/C.scale,d/C.scale,e.pixelsPerMeter/i])}else d=i/e.zoomScale(v.z),f=(v.x+Math.pow(2,v.z)*s.wrap)*d,m=v.y*d;return Zu(E,E,[f,m,0]),mu(E,E,[d/qi,d/qi,1]),E}upVector(e,i,s){return[0,0,1]}upVectorScale(e,i,s){return{metersToTile:1}}}class Au extends Xo{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,s]=this.parallels=e.parallels||[29.5,45.5],d=Math.sin(Te(i));this.n=(d+Math.sin(Te(s)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:s,c:d,r0:f}=this,m=Te(e-this.center[0]),v=Te(i),E=Math.sqrt(d-2*s*Math.sin(v))/s;return{x:E*Math.sin(m*s),y:E*Math.cos(m*s)-f,z:0}}unproject(e,i){const{n:s,c:d,r0:f}=this,m=f+i;let v=Math.atan2(e,Math.abs(m))*Math.sign(m);m*s<0&&(v-=Math.PI*Math.sign(e)*Math.sign(m));const E=Te(this.center[0])*s;v=Et(v,-Math.PI-E,Math.PI-E);const C=Yt(Ne(v/s)+this.center[0],-180,180),R=Math.asin(Yt((d-(e*e+m*m)*s*s)/(2*s),-1,1)),N=Yt(Ne(R),-85.051129,Al);return new Ar(C,N)}}const Kc=1.340264,Ea=-.081106,Iu=893e-6,bc=.003796,Fc=Math.sqrt(3)/2;class gd extends Xo{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(Fc*Math.sin(i)),d=s*s,f=d*d*d;return{x:.5*(e*Math.cos(s)/(Fc*(Kc+3*Ea*d+f*(7*Iu+9*bc*d)))/Math.PI+.5),y:1-.5*(s*(Kc+Ea*d+f*(Iu+bc*d))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,d=s*s,f=d*d*d;for(let R,N,$,X=0;X<12&&(N=s*(Kc+Ea*d+f*(Iu+bc*d))-i,$=Kc+3*Ea*d+f*(7*Iu+9*bc*d),R=N/$,s=Yt(s-R,-Math.PI/3,Math.PI/3),d=s*s,f=d*d*d,!(Math.abs(R)<1e-12));++X);const m=Fc*e*(Kc+3*Ea*d+f*(7*Iu+9*bc*d))/Math.cos(s),v=Math.asin(Math.sin(s)/Fc),E=Yt(180*m/Math.PI,-180,180),C=Yt(180*v/Math.PI,-85.051129,Al);return new Ar(E,C)}}class _d extends Xo{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const s=360*(e-.5),d=Yt(360*(.5-i),-85.051129,Al);return new Ar(s,d)}}const Ql=Math.PI/2;function Bc(n){return Math.tan((Ql+n)/2)}class yd extends Xo{constructor(e){super(e),this.center=e.center||[0,30];const[i,s]=this.parallels=e.parallels||[30,30];let d=Te(i),f=Te(s);this.southernCenter=d+f<0,this.southernCenter&&(d=-d,f=-f);const m=Math.cos(d),v=Bc(d);this.n=d===f?Math.sin(d):Math.log(m/Math.cos(f))/Math.log(Bc(f)/v),this.f=m*Math.pow(Bc(d),this.n)/this.n}project(e,i){i=Te(i),this.southernCenter&&(i=-i),e=Te(e-this.center[0]);const s=1e-6,{n:d,f}=this;f>0?i<-Ql+s&&(i=-Ql+s):i>Ql-s&&(i=Ql-s);const m=f/Math.pow(Bc(i),d);let v=m*Math.sin(d*e),E=f-m*Math.cos(d*e);return v=.5*(v/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:v,y:this.southernCenter?E:1-E,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:s,f:d}=this,f=d-i,m=Math.sign(f),v=Math.sign(s)*Math.sqrt(e*e+f*f);let E=Math.atan2(e,Math.abs(f))*m;f*s<0&&(E-=Math.PI*Math.sign(e)*m);const C=Yt(Ne(E/s)+this.center[0],-180,180),R=Yt(Ne(2*Math.atan(Math.pow(d/v,1/s))-Ql),-85.051129,Al);return new Ar(C,this.southernCenter?-R:R)}}class Pu extends Xo{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:Zl(e),y:Sl(i),z:0}}unproject(e,i){const s=ba(e),d=_s(i);return new Ar(s,d)}}const Ou=Te(Al);class fg extends Xo{project(e,i){const s=(i=Te(i))*i,d=s*s;return{x:.5*((e=Te(e))*(.8707-.131979*s+d*(d*(.003971*s-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+s*(.015085+d*(.028874*s-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let s=i=(2*(1-i)-1)*Math.PI,d=25,f=0,m=s*s;do{m=s*s;const C=m*m;f=(s*(1.007226+m*(.015085+C*(.028874*m-.044475-.005916*C)))-i)/(1.007226+m*(.045255+C*(.259866*m-.311325-.005916*11*C))),s=Yt(s-f,-Ou,Ou)}while(Math.abs(f)>1e-6&&--d>0);m=s*s;const v=Yt(Ne(e/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),E=Ne(s);return new Ar(v,E)}}const bf=Te(Al);class mg extends Xo{project(e,i){i=Te(i),e=Te(e);const s=Math.cos(i),d=2/Math.PI,f=Math.acos(s*Math.cos(e/2)),m=Math.sin(f)/f,v=.5*(e*d+2*s*Math.sin(e/2)/m)||0,E=.5*(i+Math.sin(i)/m)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,i){let s=e=(2*e-.5)*Math.PI,d=i=(2*(1-i)-1)*Math.PI,f=25;const m=1e-6;let v=0,E=0;do{const C=Math.cos(d),R=Math.sin(d),N=2*R*C,$=R*R,X=C*C,ne=Math.cos(s/2),he=Math.sin(s/2),Pe=2*ne*he,Xe=he*he,gt=1-X*ne*ne,We=gt?1/gt:0,dt=gt?Math.acos(C*ne)*Math.sqrt(1/gt):0,Dt=.5*(2*dt*C*he+2*s/Math.PI)-e,yt=.5*(dt*R+d)-i,cn=.5*We*(X*Xe+dt*C*ne*$)+1/Math.PI,on=We*(Pe*N/4-dt*R*he),Sn=.125*We*(N*he-dt*R*X*Pe),Gn=.5*We*($*ne+dt*Xe*C)+.5,yn=on*Sn-Gn*cn;v=(yt*on-Dt*Gn)/yn,E=(Dt*Sn-yt*cn)/yn,s=Yt(s-v,-Math.PI,Math.PI),d=Yt(d-E,-bf,bf)}while((Math.abs(v)>m||Math.abs(E)>m)&&--f>0);return new Ar(Ne(s),Ne(d))}}class xf extends Xo{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Te(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:s,cosPhi:d}=this;return{x:Te(e)*d*s+.5,y:-Math.sin(Te(i))/d*s+.5,z:0}}unproject(e,i){const{scale:s,cosPhi:d}=this,f=-(i-.5)/s,m=Yt(Ne((e-.5)/s)/d,-180,180),v=Math.asin(Yt(f*d,-1,1)),E=Yt(Ne(v),-85.051129,Al);return new Ar(m,E)}}class gg extends Pu{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,i,s){const d=Jd(e,i,s);return $o(d,d,fd(Xl(s))),{x:d[0],y:d[1],z:d[2]}}locationPoint(e,i){const s=Qd(i.lat,i.lng),d=ua([],s),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;xh(s,s,d,dl(1,0)*qi*f);const m=Wl(new Float64Array(16));return fu(m,e.pixelMatrix,e.globeMatrix),$o(s,s,m),new ht(s[0],s[1])}pixelsPerMeter(e,i){return dl(1,0)*i}pixelSpaceConversion(e,i,s){const d=dl(1,e)*i,f=pi(dl(1,45)*i,d,s);return this.pixelsPerMeter(e,i)/f}createTileMatrix(e,i,s){const d=yf(Xl(s.canonical));return fu(new Float64Array(16),e.globeMatrix,d)}createInversionMatrix(e,i){const{center:s}=e,d=fd(Xl(i));return bh(d,d,Te(s.lng)),Ip(d,d,Te(s.lat)),mu(d,d,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(e,i,s,d){return ug(e,i,s,!0)||new Zc(0,0)}pointCoordinate3D(e,i,s){const d=this.pointCoordinate(e,i,s,0);return[d.x,d.y,d.z]}isPointAboveHorizon(e,i){return!ug(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(d,f){const m=d.cameraToCenterDistance,v=d._centerAltitude*f,E=d._camera,C=d._camera.forward(),R=qc([],Il([],C,-m),[0,0,v]),N=d.worldSize/(2*Math.PI),$=[0,0,-N],X=d.width/d.height,ne=Math.tan(d.fovAboveCenter),he=Il([],E.up(),ne),Pe=Il([],E.right(),ne*X),Xe=ua([],qc([],qc([],C,he),Pe)),gt=[];let We;if(new Lp(R,Xe).closestPointOnSphere($,N,gt)){const dt=qc([],gt,$),Dt=Ja([],dt,R);We=Math.cos(d.fovAboveCenter)*Wu(Dt)}else{const dt=Ja([],R,$),Dt=Ja([],$,R);ua(Dt,Dt);const yt=Wu(dt)-N;We=Math.sqrt(yt*(yt+2*N));const cn=Math.acos(We/(N+yt))-Math.acos(Pl(C,Dt));We*=Math.cos(cn)}return 1.01*We}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=Su(e.zoom);if(s>0){const d=pg(e,dl(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),m=Math.max(e.width,e.height)/e.worldSize*Math.PI;return pi(i,d+f*(1-Math.cos(m)),Math.pow(s,10))}return i}upVector(e,i,s){return Jd(i,s,e,1)}upVectorScale(e){return{metersToTile:ff*Xh(Xl(e))}}}function wf(n){const e=n.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new Pu(n);case"equirectangular":return new _d(n);case"naturalEarth":return new fg(n);case"equalEarth":return new gd(n);case"winkelTripel":return new mg(n);case"albers":return i?new xf(n):new Au(n);case"lambertConformalConic":return i?new xf(n):new yd(n);case"globe":return new gg(n)}throw new Error(`Invalid projection name: ${n.name}`)}const _g=Yp.types,yg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function th(n,e,i,s,d,f,m,v,E,C,R,N,$){const X=v?Math.min(yc,Math.round(v[0])):0,ne=v?Math.min(yc,Math.round(v[1])):0;n.emplaceBack(e,i,Math.round(32*s),Math.round(32*d),f,m,(X<<1)+(E?1:0),ne,16*C,16*R,256*N,256*$)}function Qh(n,e,i,s,d,f,m){n.emplaceBack(e,i,s,d,f,m)}function Jh(n,e,i,s,d){n.emplaceBack(e,i,s,d),n.emplaceBack(e,i,s,d),n.emplaceBack(e,i,s,d),n.emplaceBack(e,i,s,d)}function vg(n){for(const e of n.sections)if(Ue(e.text))return!0;return!1}class Ef{constructor(e){this.layoutVertexArray=new Jr,this.indexArray=new Ys,this.programConfigurations=e,this.segments=new Yo,this.dynamicLayoutVertexArray=new Ka,this.opacityVertexArray=new No,this.placedSymbolArray=new dh,this.globeExtVertexArray=new Tr}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,s,d){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Fy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,M_.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,yg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,By.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Wn(Ef,"SymbolBuffers");class ep{constructor(e,i,s){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new s,this.segments=new Yo,this.collisionVertexArray=new ou,this.collisionVertexArrayExt=new Hl}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Zm.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Ny.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Wn(ep,"CollisionBuffers");class xc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Wl([]),this.placementViewportMatrix=Wl([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=rd(this.zoom,i["text-size"]),this.iconSizeData=rd(this.zoom,i["icon-size"]);const s=this.layers[0].layout,d=s.get("symbol-sort-key"),f=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(m=>hl[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Ef(new $c(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Ef(new $c(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new hp,this.lineVertexArray=new pp,this.symbolInstances=new zu}calculateGlyphDependencies(e,i,s,d,f){for(let m=0;m<e.length;m++)if(i[e.charCodeAt(m)]=!0,d&&f){const v=zd[e.charAt(m)];v&&(i[v.charCodeAt(0)]=!0)}}populate(e,i,s,d){const f=this.layers[0],m=f.layout,v="globe"===this.projection.name,E=m.get("text-font"),C=m.get("text-field"),R=m.get("icon-image"),N=("constant"!==C.value.kind||C.value.value instanceof dr&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),$="constant"!==R.value.kind||!!R.value.value||Object.keys(R.parameters).length>0,X=m.get("symbol-sort-key");if(this.features=[],!N&&!$)return;const ne=i.iconDependencies,he=i.glyphDependencies,Pe=i.availableImages,Xe=new Wt(this.zoom);for(const{feature:gt,id:We,index:dt,sourceLayerIndex:Dt}of e){const yt=f._featureFilter.needGeometry,cn=fc(gt,yt);if(!f._featureFilter.filter(Xe,cn,s))continue;if(yt||(cn.geometry=pc(gt,s,d)),v&&1!==gt.type&&s.z<=5){const yn=cn.geometry,Rn=.98078528056,Ln=(Un,Zn)=>Pl(Jd(Un.x,Un.y,s,1),Jd(Zn.x,Zn.y,s,1))<Rn;for(let Un=0;Un<yn.length;Un++)yn[Un]=n_(yn[Un],Ln)}let on,Sn;if(N){const yn=f.getValueAndResolveTokens("text-field",cn,s,Pe),Rn=dr.factory(yn);vg(Rn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===jt()||this.hasRTLText&&rn.isParsed())&&(on=T_(Rn,f,cn))}if($){const yn=f.getValueAndResolveTokens("icon-image",cn,s,Pe);Sn=yn instanceof ns?yn:ns.fromString(yn)}if(!on&&!Sn)continue;const Gn=this.sortFeaturesByKey?X.evaluate(cn,{},s):void 0;if(this.features.push({id:We,text:on,icon:Sn,index:dt,sourceLayerIndex:Dt,geometry:cn.geometry,properties:gt.properties,type:_g[gt.type],sortKey:Gn}),Sn&&(ne[Sn.name]=!0),on){const yn=E.evaluate(cn,{},s).join(","),Rn="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(hl.vertical)>=0;for(const Ln of on.sections)if(Ln.image)ne[Ln.image.name]=!0;else{const Un=M(on.toString()),Zn=Ln.fontStack||yn,vn=he[Zn]=he[Zn]||{};this.calculateGlyphDependencies(Ln.text,vn,Rn,this.allowVerticalPlacement,Un)}}}"line"===m.get("symbol-placement")&&(this.features=function(gt){const We={},dt={},Dt=[];let yt=0;function cn(yn){Dt.push(gt[yn]),yt++}function on(yn,Rn,Ln){const Un=dt[yn];return delete dt[yn],dt[Rn]=Un,Dt[Un].geometry[0].pop(),Dt[Un].geometry[0]=Dt[Un].geometry[0].concat(Ln[0]),Un}function Sn(yn,Rn,Ln){const Un=We[Rn];return delete We[Rn],We[yn]=Un,Dt[Un].geometry[0].shift(),Dt[Un].geometry[0]=Ln[0].concat(Dt[Un].geometry[0]),Un}function Gn(yn,Rn,Ln){const Un=Ln?Rn[0][Rn[0].length-1]:Rn[0][0];return`${yn}:${Un.x}:${Un.y}`}for(let yn=0;yn<gt.length;yn++){const Rn=gt[yn],Ln=Rn.geometry,Un=Rn.text?Rn.text.toString():null;if(!Un){cn(yn);continue}const Zn=Gn(Un,Ln),vn=Gn(Un,Ln,!0);if(Zn in dt&&vn in We&&dt[Zn]!==We[vn]){const ti=Sn(Zn,vn,Ln),Fi=on(Zn,vn,Dt[ti].geometry);delete We[Zn],delete dt[vn],dt[Gn(Un,Dt[Fi].geometry,!0)]=Fi,Dt[ti].geometry=null}else Zn in dt?on(Zn,vn,Ln):vn in We?Sn(Zn,vn,Ln):(cn(yn),We[Zn]=yt-1,dt[vn]=yt-1)}return Dt.filter(yn=>yn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((gt,We)=>gt.sortKey-We.sortKey)}update(e,i,s,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,s,d),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,s,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=wf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:d,y:f}of i)this.lineVertexArray.emplaceBack(d,f);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,i,s,d,f,m,v,E,C,R,N,$,X,ne){const he=e.indexArray,Pe=e.layoutVertexArray,Xe=e.globeExtVertexArray,gt=e.segments.prepareSegment(4*i.length,Pe,he,this.canOverlap?m.sortKey:void 0),We=this.glyphOffsetArray.length,dt=gt.vertexLength,Dt=this.allowVerticalPlacement&&v===hl.vertical?Math.PI/2:0,yt=m.text&&m.text.sections;for(let on=0;on<i.length;on++){const{tl:Sn,tr:Gn,bl:yn,br:Rn,tex:Ln,pixelOffsetTL:Un,pixelOffsetBR:Zn,minFontScaleX:vn,minFontScaleY:ti,glyphOffset:Fi,isSDF:oi,sectionIndex:vi}=i[on],ni=gt.vertexLength,Ui=Fi[1];if(th(Pe,C.x,C.y,Sn.x,Ui+Sn.y,Ln.x,Ln.y,s,oi,Un.x,Un.y,vn,ti),th(Pe,C.x,C.y,Gn.x,Ui+Gn.y,Ln.x+Ln.w,Ln.y,s,oi,Zn.x,Un.y,vn,ti),th(Pe,C.x,C.y,yn.x,Ui+yn.y,Ln.x,Ln.y+Ln.h,s,oi,Un.x,Zn.y,vn,ti),th(Pe,C.x,C.y,Rn.x,Ui+Rn.y,Ln.x+Ln.w,Ln.y+Ln.h,s,oi,Zn.x,Zn.y,vn,ti),E){const{x:_r,y:yr,z:pr}=E.anchor,[Hi,$r,er]=E.up;Qh(Xe,_r,yr,pr,Hi,$r,er),Qh(Xe,_r,yr,pr,Hi,$r,er),Qh(Xe,_r,yr,pr,Hi,$r,er),Qh(Xe,_r,yr,pr,Hi,$r,er),Jh(e.dynamicLayoutVertexArray,_r,yr,pr,Dt)}else Jh(e.dynamicLayoutVertexArray,C.x,C.y,C.z,Dt);he.emplaceBack(ni,ni+1,ni+2),he.emplaceBack(ni+1,ni+2,ni+3),gt.vertexLength+=4,gt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fi[0]),on!==i.length-1&&vi===i[on+1].sectionIndex||e.programConfigurations.populatePaintArrays(Pe.length,m,m.index,{},X,ne,yt&&yt[vi])}const cn=E?E.anchor:C;e.placedSymbolArray.emplaceBack(cn.x,cn.y,cn.z,C.x,C.y,We,this.glyphOffsetArray.length-We,dt,R,N,C.segment,s?s[0]:0,s?s[1]:0,d[0],d[1],v,0,!1,0,$,0)}_commitLayoutVertex(e,i,s,d,f,m,v){e.emplaceBack(i,s,d,f,m,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,i,s,d,f,m,v){const E=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),C=E.vertexLength,R=v.tileAnchorX,N=v.tileAnchorY;for(let X=0;X<4;X++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,d,f,m,R,N,new ht(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,d,f,m,R,N,new ht(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,d,f,m,R,N,new ht(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,d,f,m,R,N,new ht(e.x1,e.y2)),E.vertexLength+=4;const $=s.indexArray;$.emplaceBack(C,C+1),$.emplaceBack(C+1,C+2),$.emplaceBack(C+2,C+3),$.emplaceBack(C+3,C),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,s,d,f,m){for(let v=d;v<f;v++){const E=s.get(v),C=this.getSymbolInstanceTextSize(e,m,i,v);this._addCollisionDebugVertices(E,C,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,i,s,d,f,m){for(let v=d;v<f;v++){const E=s.get(v),C=this.getSymbolInstanceIconSize(e,i,m.placedIconSymbolIndex);this._addCollisionDebugVertices(E,C,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ep(so,Wm.members,ul),this.iconCollisionBox=new ep(so,Wm.members,ul);const s=Cu(this.iconSizeData,e),d=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(d,e,i,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(d,e,i,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(s,e,i,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(s,e,i,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,i,s,d){const f=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:d),m=Fh(this.textSizeData,e,f)/Ks;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,i,s){const d=this.icon.placedSymbolArray.get(s),f=Fh(this.iconSizeData,e,d);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,i,s){e.emplaceBack(i,-s,-s),e.emplaceBack(i,s,-s),e.emplaceBack(i,s,s),e.emplaceBack(i,-s,s)}_updateTextDebugCollisionBoxes(e,i,s,d,f,m){for(let v=d;v<f;v++){const E=s.get(v),C=this.getSymbolInstanceTextSize(e,m,i,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,E.padding)}}_updateIconDebugCollisionBoxes(e,i,s,d,f,m){for(let v=d;v<f;v++){const E=s.get(v),C=this.getSymbolInstanceIconSize(e,i,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,E.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Cu(this.iconSizeData,e),d=Cu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const m=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(d,e,i,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(d,e,i,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(s,e,i,m.iconBoxStartIndex,m.iconBoxEndIndex,m.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,i,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,s,d,f,m,v,E,C){const R={};if(i<s){const{x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt,featureIndex:Dt}=e.get(i);R.textBox={x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt},R.textFeatureIndex=Dt}if(d<f){const{x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt,featureIndex:Dt}=e.get(d);R.verticalTextBox={x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt},R.verticalTextFeatureIndex=Dt}if(m<v){const{x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt,featureIndex:Dt}=e.get(m);R.iconBox={x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt},R.iconFeatureIndex=Dt}if(E<C){const{x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt,featureIndex:Dt}=e.get(E);R.verticalIconBox={x1:N,y1:$,x2:X,y2:ne,padding:he,projectedAnchorX:Pe,projectedAnchorY:Xe,projectedAnchorZ:gt,tileAnchorX:We,tileAnchorY:dt},R.verticalIconFeatureIndex=Dt}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const s=e.placedSymbolArray.get(i),d=s.vertexStartIndex+4*s.numGlyphs;for(let f=s.vertexStartIndex;f<d;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),s=Math.cos(e),d=[],f=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const E=this.symbolInstances.get(v);d.push(0|Math.round(i*E.tileAnchorX+s*E.tileAnchorY)),f.push(E.featureIndex)}return m.sort((v,E)=>d[v]-d[E]||f[E]-f[v]),m}addToSortKeyRanges(e,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:C}=s;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),f>=0&&f!==d&&this.addIndicesForPlacedSymbol(this.text,f),m>=0&&m!==f&&m!==d&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Wn(xc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),xc.MAX_GLYPHS=65535,xc.addDynamicAttributes=Jh;const Cf=new ki({"symbol-placement":new qt(pn.layout_symbol["symbol-placement"]),"symbol-spacing":new qt(pn.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qt(pn.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gn(pn.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qt(pn.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qt(pn.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qt(pn.layout_symbol["icon-ignore-placement"]),"icon-optional":new qt(pn.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qt(pn.layout_symbol["icon-rotation-alignment"]),"icon-size":new gn(pn.layout_symbol["icon-size"]),"icon-text-fit":new qt(pn.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qt(pn.layout_symbol["icon-text-fit-padding"]),"icon-image":new gn(pn.layout_symbol["icon-image"]),"icon-rotate":new gn(pn.layout_symbol["icon-rotate"]),"icon-padding":new qt(pn.layout_symbol["icon-padding"]),"icon-keep-upright":new qt(pn.layout_symbol["icon-keep-upright"]),"icon-offset":new gn(pn.layout_symbol["icon-offset"]),"icon-anchor":new gn(pn.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qt(pn.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qt(pn.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qt(pn.layout_symbol["text-rotation-alignment"]),"text-field":new gn(pn.layout_symbol["text-field"]),"text-font":new gn(pn.layout_symbol["text-font"]),"text-size":new gn(pn.layout_symbol["text-size"]),"text-max-width":new gn(pn.layout_symbol["text-max-width"]),"text-line-height":new gn(pn.layout_symbol["text-line-height"]),"text-letter-spacing":new gn(pn.layout_symbol["text-letter-spacing"]),"text-justify":new gn(pn.layout_symbol["text-justify"]),"text-radial-offset":new gn(pn.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qt(pn.layout_symbol["text-variable-anchor"]),"text-anchor":new gn(pn.layout_symbol["text-anchor"]),"text-max-angle":new qt(pn.layout_symbol["text-max-angle"]),"text-writing-mode":new qt(pn.layout_symbol["text-writing-mode"]),"text-rotate":new gn(pn.layout_symbol["text-rotate"]),"text-padding":new qt(pn.layout_symbol["text-padding"]),"text-keep-upright":new qt(pn.layout_symbol["text-keep-upright"]),"text-transform":new gn(pn.layout_symbol["text-transform"]),"text-offset":new gn(pn.layout_symbol["text-offset"]),"text-allow-overlap":new qt(pn.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qt(pn.layout_symbol["text-ignore-placement"]),"text-optional":new qt(pn.layout_symbol["text-optional"])});var Mf={paint:new ki({"icon-opacity":new gn(pn.paint_symbol["icon-opacity"]),"icon-color":new gn(pn.paint_symbol["icon-color"]),"icon-halo-color":new gn(pn.paint_symbol["icon-halo-color"]),"icon-halo-width":new gn(pn.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gn(pn.paint_symbol["icon-halo-blur"]),"icon-translate":new qt(pn.paint_symbol["icon-translate"]),"icon-translate-anchor":new qt(pn.paint_symbol["icon-translate-anchor"]),"text-opacity":new gn(pn.paint_symbol["text-opacity"]),"text-color":new gn(pn.paint_symbol["text-color"],{runtimeType:Fr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new gn(pn.paint_symbol["text-halo-color"]),"text-halo-width":new gn(pn.paint_symbol["text-halo-width"]),"text-halo-blur":new gn(pn.paint_symbol["text-halo-blur"]),"text-translate":new qt(pn.paint_symbol["text-translate"]),"text-translate-anchor":new qt(pn.paint_symbol["text-translate-anchor"])}),layout:Cf};class nh{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:rr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Wn(nh,"FormatSectionOverride",{omit:["defaultValue"]});class Ru extends Tl{constructor(e){super(e,Mf)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const d=[];for(const f of s)d.indexOf(f)<0&&d.push(f);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,s,d){const f=this.layout.get(e).evaluate(i,{},s,d),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||wi(m.value)||!f?f:(v=i.properties,f.replace(/{([^{}]+)}/g,(C,R)=>R in v?String(v[R]):""));var v}createBucket(e){return new xc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Mf.paint.overridableProperties){if(!Ru.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),s=new nh(i),d=new kn(s,i.property.specification);let f=null;f="constant"===i.value.kind||"source"===i.value.kind?new xr("source",d):new Er("composite",d,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new zn(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&Ru.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const s=e.get("text-field"),d=Mf.paint.properties[i];let f=!1;const m=v=>{for(const E of v)if(d.overrides&&d.overrides.hasOverride(E))return void(f=!0)};if("constant"===s.value.kind&&s.value.value instanceof dr)m(s.value.value.sections);else if("source"===s.value.kind){const v=C=>{f||(C instanceof no&&jr(C.value)===$i?m(C.value.sections):C instanceof pa?m(C.sections):C.eachChild(v))},E=s.value;E._styleExpression&&v(E._styleExpression.expression)}return f}getProgramConfiguration(e){return new Gc(this,e)}}var Df={paint:new ki({"background-color":new qt(pn.paint_background["background-color"]),"background-pattern":new qt(pn.paint_background["background-pattern"]),"background-opacity":new qt(pn.paint_background["background-opacity"])})},Y_={paint:new ki({"raster-opacity":new qt(pn.paint_raster["raster-opacity"]),"raster-hue-rotate":new qt(pn.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qt(pn.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qt(pn.paint_raster["raster-brightness-max"]),"raster-saturation":new qt(pn.paint_raster["raster-saturation"]),"raster-contrast":new qt(pn.paint_raster["raster-contrast"]),"raster-resampling":new qt(pn.paint_raster["raster-resampling"]),"raster-fade-duration":new qt(pn.paint_raster["raster-fade-duration"])})};class tp extends Tl{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var np={paint:new ki({"sky-type":new qt(pn.paint_sky["sky-type"]),"sky-atmosphere-sun":new qt(pn.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qt(pn.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qt(pn.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qt(pn.paint_sky["sky-gradient-radius"]),"sky-gradient":new _i(pn.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qt(pn.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qt(pn.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qt(pn.paint_sky["sky-opacity"])})};function ip(n,e,i){const s=[0,0,1],d=wh([]);return xm(d,d,i?-Te(n)+Math.PI:Te(n)),kp(d,d,-Te(e)),_m(s,s,d),ua(s,s)}const bg={circle:class extends Tl{constructor(n){super(n,Sc)}createBucket(n){return new Cp(n)}queryRadius(n){const e=n;return $u("circle-radius",this,e)+$u("circle-stroke-width",this,e)+vh(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,s,d,f,m,v){const E=hm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return s_(n,s,f,m,v,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,C)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new Gc(this,n)}},heatmap:class extends Tl{createBucket(n){return new Bp(n)}constructor(n){super(n,Oy),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ad({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return $u("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,s,d,f,m,v){const E=this.paint.get("heatmap-radius").evaluate(e,i);return s_(n,s,f,m,v,!0,!0,new ht(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new Gc(this,n)}},hillshade:class extends Tl{constructor(n){super(n,a_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Tl{constructor(n){super(n,Wp)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new Gc(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Ph(n)}queryRadius(){return vh(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,s,d,f){return!n.queryGeometry.isAboveHorizon&&cm(dm(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Tl{constructor(n){super(n,x_)}createBucket(n){return new za(n)}queryRadius(){return vh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new Gc(this,n)}queryIntersectsFeature(n,e,i,s,d,f,m,v,E){const C=hm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(e,i),N=this.paint.get("fill-extrusion-base").evaluate(e,i),$=[0,0],X=v&&f.elevation,ne=f.elevation?f.elevation.exaggeration():1,he=n.tile.getBucket(this);if(X&&he instanceof za){const dt=he.centroidVertexArray,Dt=E+1;Dt<dt.length&&($[0]=dt.geta_centroid_pos0(Dt),$[1]=dt.geta_centroid_pos1(Dt))}if(0===$[0]&&1===$[1])return!1;"globe"===f.projection.name&&(s=Vm([s],[new ht(0,0),new ht(qi,qi)],n.tileID.canonical).map(dt=>dt.polygon).flat());const Pe=X?v:null,[Xe,gt]=(Dt=s,yt=N,cn=R,on=C,Sn=m,Gn=Pe,yn=$,Rn=ne,Ln=f.center.lat,"globe"===(dt=f).projection.name?function(Zn,vn,ti,Fi,oi,vi,ni,Ui,_r,yr,pr){const Hi=[],$r=[],er=Zn.projection.upVectorScale(pr,Zn.center.lat,Zn.worldSize).metersToTile,vr=[0,0,0,1],eo=[0,0,0,1],go=(_o,bo,zo,zs)=>{_o[0]=bo,_o[1]=zo,_o[2]=zs,_o[3]=1},ho=Kp();ti>0&&(ti+=ho),Fi+=ho;for(const _o of vn){const bo=[],zo=[];for(const zs of _o){const Zr=zs.x+oi.x,cs=zs.y+oi.y,Jo=Zn.projection.projectTilePoint(Zr,cs,pr),Rr=Zn.projection.upVector(pr,zs.x,zs.y);let Ao=ti,us=Fi;if(ni){const Wr=Qp(Zr,cs,ti,Fi,ni,Ui,_r,yr);Ao+=Wr.base,us+=Wr.top}0!==ti?go(vr,Jo.x+Rr[0]*er*Ao,Jo.y+Rr[1]*er*Ao,Jo.z+Rr[2]*er*Ao):go(vr,Jo.x,Jo.y,Jo.z),go(eo,Jo.x+Rr[0]*er*us,Jo.y+Rr[1]*er*us,Jo.z+Rr[2]*er*us),$o(vr,vr,vi),$o(eo,eo,vi),bo.push(new td(vr[0],vr[1],vr[2])),zo.push(new td(eo[0],eo[1],eo[2]))}Hi.push(bo),$r.push(zo)}return[Hi,$r]}(dt,Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln,n.tileID.canonical):Gn?function(Zn,vn,ti,Fi,oi,vi,ni,Ui,_r){const yr=[],pr=[],Hi=[0,0,0,1];for(const $r of Zn){const er=[],vr=[];for(const eo of $r){const go=eo.x+Fi.x,ho=eo.y+Fi.y,_o=Qp(go,ho,vn,ti,vi,ni,Ui,_r);Hi[0]=go,Hi[1]=ho,Hi[2]=_o.base,Hi[3]=1,bu(Hi,Hi,oi),Hi[3]=Math.max(Hi[3],1e-5);const bo=new td(Hi[0]/Hi[3],Hi[1]/Hi[3],Hi[2]/Hi[3]);Hi[0]=go,Hi[1]=ho,Hi[2]=_o.top,Hi[3]=1,bu(Hi,Hi,oi),Hi[3]=Math.max(Hi[3],1e-5);const zo=new td(Hi[0]/Hi[3],Hi[1]/Hi[3],Hi[2]/Hi[3]);er.push(bo),vr.push(zo)}yr.push(er),pr.push(vr)}return[yr,pr]}(Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln):function(Zn,vn,ti,Fi,oi){const vi=[],ni=[],Ui=oi[8]*vn,_r=oi[9]*vn,yr=oi[10]*vn,pr=oi[11]*vn,Hi=oi[8]*ti,$r=oi[9]*ti,er=oi[10]*ti,vr=oi[11]*ti;for(const eo of Zn){const go=[],ho=[];for(const _o of eo){const bo=_o.x+Fi.x,zo=_o.y+Fi.y,zs=oi[0]*bo+oi[4]*zo+oi[12],Zr=oi[1]*bo+oi[5]*zo+oi[13],cs=oi[2]*bo+oi[6]*zo+oi[14],Jo=oi[3]*bo+oi[7]*zo+oi[15],Rr=zs+Ui,Ao=Zr+_r,us=cs+yr,Wr=Math.max(Jo+pr,1e-5),Uo=zs+Hi,Xs=Zr+$r,Ms=cs+er,Ds=Math.max(Jo+vr,1e-5);go.push(new td(Rr/Wr,Ao/Wr,us/Wr)),ho.push(new td(Uo/Ds,Xs/Ds,Ms/Ds))}vi.push(go),ni.push(ho)}return[vi,ni]}(Dt,yt,cn,on,Sn)),We=n.queryGeometry;var dt,Dt,yt,cn,on,Sn,Gn,yn,Rn,Ln;return function(dt,Dt,yt){let cn=1/0;cm(yt,Dt)&&(cn=jm(yt,Dt[0]));for(let on=0;on<Dt.length;on++){const Sn=Dt[on],Gn=dt[on];for(let yn=0;yn<Sn.length-1;yn++){const Rn=Sn[yn],Ln=[Rn,Sn[yn+1],Gn[yn+1],Gn[yn],Rn];lm(yt,Ln)&&(cn=Math.min(cn,jm(yt,Ln)))}}return cn!==1/0&&cn}(Xe,gt,We.isPointQuery()?We.screenBounds:We.screenGeometry)}},line:class extends Tl{constructor(n){super(n,Lh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof si,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=$m.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new kh(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new Gc(this,n)}queryRadius(n){const e=n,i=C_($u("line-width",this,e),$u("line-gap-width",this,e)),s=$u("line-offset",this,e);return i/2+Math.abs(s)+vh(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,s,d,f){if(n.queryGeometry.isAboveHorizon)return!1;const m=dm(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,n.pixelToTileUnitsFactor),v=n.pixelToTileUnitsFactor/2*C_(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),E=this.paint.get("line-offset").evaluate(e,i);return E&&(s=function(C,R){const N=[],$=new ht(0,0);for(let X=0;X<C.length;X++){const ne=C[X],he=[];for(let Pe=0;Pe<ne.length;Pe++){const gt=ne[Pe],We=ne[Pe+1],dt=0===Pe?$:gt.sub(ne[Pe-1])._unit()._perp(),Dt=Pe===ne.length-1?$:We.sub(gt)._unit()._perp(),yt=dt._add(Dt)._unit();yt._mult(1/(yt.x*Dt.x+yt.y*Dt.y)),he.push(yt._mult(R)._add(gt))}N.push(he)}return N}(s,E*n.pixelToTileUnitsFactor)),function(C,R,N){for(let $=0;$<R.length;$++){const X=R[$];if(C.length>=3)for(let ne=0;ne<X.length;ne++)if(Wc(C,X[ne]))return!0;if(Mp(C,X,N))return!0}return!1}(m,s,v)}isTileClipped(){return!0}},symbol:Ru,background:class extends Tl{constructor(n){super(n,Df)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Tl{constructor(n){super(n,Y_)}getProgramIds(){return["raster"]}},sky:class extends Tl{constructor(n){super(n,np),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ad({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),d=!s,f=n.style.light,m=f.properties.get("position");return d&&"viewport"===f.properties.get("anchor")&&Tt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?ip(m.azimuthal,90-m.polar,e):ip(s[0],90-s[1],e)}const i=this.paint.get("sky-gradient-center");return ip(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class ku{constructor(e,i,s,d){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(i,d)}update(e,i,s){const{width:d,height:f}=e,{context:m}=this,{gl:v}=m,{HTMLImageElement:E,HTMLCanvasElement:C,HTMLVideoElement:R,ImageData:N,ImageBitmap:$}=de;if(v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!i||!1!==i.premultiply)),s||this.size&&this.size[0]===d&&this.size[1]===f){const{x:X,y:ne}=s||{x:0,y:0};e instanceof E||e instanceof C||e instanceof R||e instanceof N||$&&e instanceof $?v.texSubImage2D(v.TEXTURE_2D,0,X,ne,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,X,ne,d,f,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[d,f],e instanceof E||e instanceof C||e instanceof R||e instanceof N||$&&e instanceof $?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,d,f,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,i){const{context:s}=this,{gl:d}=s;d.bindTexture(d.TEXTURE_2D,this.texture),e!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class xg{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class wg{constructor(){this.tasks={},this.taskQueue=[],Ct(["process"],this),this.invoker=new xg(this.process),this.nextId=0}add(e,i){const s=this.nextId++,d=function({type:f,isSymbolTile:m,zoom:v}){return v=v||0,"message"===f?0:"maybePrepare"!==f||m?"parseTile"!==f||m?"parseTile"===f&&m?300-v:"maybePrepare"===f&&m?400-v:500:200-v:100-v}(i);if(0===d){Rt();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:i,priority:d,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){Rt();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let d=0;d<this.taskQueue.length;d++){const f=this.tasks[this.taskQueue[d]];f.priority<i&&(i=f.priority,e=d)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class rp{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const s=e[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Tf=["tile","layer","source","sourceLayer","state"];class Eg{constructor(e,i,s,d,f){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=s,this._y=d,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const i of Tf)void 0!==this[i]&&(e[i]=this[i]);return e}}const fl=32,Jl=33,Nc=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,s=0,d=0,f=0,m=0,v=0;for(1&e?d=f=m=fl:i=s=v=fl;(e>>=1)>1;){const C=i+d>>1,R=s+f>>1;1&e?(d=i,f=s,i=m,s=v):(i=d,s=f,d=m,f=v),m=C,v=R}const E=4*n;Nc[E+0]=i,Nc[E+1]=s,Nc[E+2]=d,Nc[E+3]=f}const ec=new Uint16Array(2178),Xc=new Uint8Array(1089),ih=new Uint16Array(1089);function Sf(n){return 0===n?-.03125:32===n?.03125:0}var op=di([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const rh={type:2,extent:qi,loadGeometry:()=>[[new ht(0,0),new ht(8193,0),new ht(8193,8193),new ht(0,8193),new ht(0,0)]]};class sp{constructor(e,i,s,d,f){this.tileID=e,this.uid=Ci(),this.uses=0,this.tileSize=i,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<hi.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=wa(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(d,f){const m={};if(!f)return m;for(const v of d){const E=v.layerIds.map(C=>f.getLayer(C)).filter(Boolean);if(0!==E.length){v.layers=E,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(C=>E.filter(R=>R.id===C)[0]));for(const C of E)m[C.id]=v}}return m}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const f=this.buckets[d];if(f instanceof xc){if(this.hasSymbolBuckets=!0,!s)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const f=this.buckets[d];if(f instanceof xc&&f.hasRTLText){this.hasRTLText=!0,rn.isLoading()||rn.isLoaded()||"deferred"!==jt()||un();break}}this.queryPadding=0;for(const d in this.buckets){const f=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(d).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Ed}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const d=this.buckets[s];d.uploadPending()&&d.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ku(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ku(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new ku(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,s,d,f,m,v,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:v,transform:m,params:f,tileTransform:this.tileTransform},e,i,s):{}}querySourceFeatures(e,i){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const d=s.loadVTLayers(),f=i?i.sourceLayer:"",m=d._geojsonTileLayer||d[f];if(!m)return;const v=sa(i&&i.filter),{z:E,x:C,y:R}=this.tileID.canonical,N={z:E,x:C,y:R};for(let $=0;$<m.length;$++){const X=m.feature($);if(v.needGeometry){const Pe=fc(X,!0);if(!v.filter(new Wt(this.tileID.overscaledZ),Pe,this.tileID.canonical))continue}else if(!v.filter(new Wt(this.tileID.overscaledZ),X))continue;const ne=s.getId(X,f),he=new Eg(X,E,C,R,ne);he.tile=N,e.push(he)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const s=Se(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let d=!1;if(this.expirationTime>s)d=!1;else if(i)if(this.expirationTime<i)d=!0;else{const f=this.expirationTime-i;f?this.expirationTime=s+Math.max(f,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const s=this.latestFeatureIndex.loadVTLayers(),d=i.style.listImages();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const m=this.buckets[f],v=m.layers[0].sourceLayer||"_geojsonTileLayer",E=s[v],C=e[v];if(!E||!C||0===Object.keys(C).length)continue;if(m.update(C,E,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof kh||m instanceof Ph){const N=i.style._getSourceCache(m.layers[0].source);i._terrain&&i._terrain.enabled&&N&&m.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(N.id,this.tileID)}const R=i&&i.style&&i.style.getLayer(f);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(m)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<hi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=hi.now()+e}setTexture(e,i){const s=i.context,d=s.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new ku(s,e,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),s.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax))}setDependencies(e,i){const s={};for(const d of i)s[d]=!0;this.dependencies[e]=s}hasDependency(e,i){for(const s of e){const d=this.dependencies[s];if(d)for(const f of i)if(d[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const s=pc(rh,this.tileID.canonical,this.tileTransform)[0],d=new zr,f=new wd;for(let m=0;m<s.length;m++){const{x:v,y:E}=s[m];d.emplaceBack(v,E),f.emplaceBack(m)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(d,Kd.members),this._tileDebugSegments=Yo.simpleSegment(0,0,d.length,f.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const s=pc(rh,this.tileID.canonical,this.tileTransform)[0];let d,f;if(this.isRaster){const m=function(v,E){const C=wa(v,E),R=Math.pow(2,v.z);for(let Pe=0;Pe<Jl;Pe++)for(let Xe=0;Xe<Jl;Xe++){const gt=ba((v.x+(Xe+Sf(Xe))/fl)/R),We=_s((v.y+(Pe+Sf(Pe))/fl)/R),dt=E.project(gt,We),Dt=Pe*Jl+Xe;ec[2*Dt+0]=Math.round((dt.x*C.scale-C.x)*qi),ec[2*Dt+1]=Math.round((dt.y*C.scale-C.y)*qi)}Xc.fill(0),ih.fill(0);for(let Pe=2045;Pe>=0;Pe--){const Xe=4*Pe,gt=Nc[Xe+0],We=Nc[Xe+1],dt=Nc[Xe+2],Dt=Nc[Xe+3],yt=gt+dt>>1,cn=We+Dt>>1,on=yt+cn-We,Sn=cn+gt-yt,Gn=We*Jl+gt,yn=Dt*Jl+dt,Rn=cn*Jl+yt,Ln=Math.hypot((ec[2*Gn+0]+ec[2*yn+0])/2-ec[2*Rn+0],(ec[2*Gn+1]+ec[2*yn+1])/2-ec[2*Rn+1])>=16;Xc[Rn]=Xc[Rn]||(Ln?1:0),Pe<1022&&(Xc[Rn]=Xc[Rn]||Xc[(We+Sn>>1)*Jl+(gt+on>>1)]||Xc[(Dt+Sn>>1)*Jl+(dt+on>>1)])}const N=new oo,$=new Ys;let X=0;function ne(Pe,Xe){const gt=Xe*Jl+Pe;return 0===ih[gt]&&(N.emplaceBack(ec[2*gt+0],ec[2*gt+1],Pe*qi/fl,Xe*qi/fl),ih[gt]=++X),ih[gt]-1}function he(Pe,Xe,gt,We,dt,Dt){const yt=Pe+gt>>1,cn=Xe+We>>1;if(Math.abs(Pe-dt)+Math.abs(Xe-Dt)>1&&Xc[cn*Jl+yt])he(dt,Dt,Pe,Xe,yt,cn),he(gt,We,dt,Dt,yt,cn);else{const on=ne(Pe,Xe),Sn=ne(gt,We),Gn=ne(dt,Dt);$.emplaceBack(on,Sn,Gn)}}return he(0,0,fl,fl,fl,0),he(fl,fl,0,0,0,fl),{vertices:N,indices:$}}(this.tileID.canonical,i);d=m.vertices,f=m.indices}else{d=new oo,f=new Ys;for(const{x:v,y:E}of s)d.emplaceBack(v,E,0,0);const m=Yu.exports(d.int16,void 0,4);for(let v=0;v<m.length;v+=3)f.emplaceBack(m[v],m[v+1],m[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(d,op.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=Yo.simpleSegment(0,0,d.length,f.length)}_makeGlobeTileDebugBuffers(e,i){const s=i.projection;if(!s||"globe"!==s.name||i.freezeTileCoverage)return;const d=this.tileID.canonical,f=fd(dg(d,i)),m=Su(i.zoom);let v;m>0&&(v=Ap(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,d,i,f,v,m),this._makeGlobeTileDebugTextBuffer(e,d,i,f,v,m)}_globePoint(e,i,s,d,f,m,v){let E=Jd(e,i,s);if(m){const C=1<<s.z,R=Zl(d.center.lng),N=Sl(d.center.lat),$=(s.x+.5)/C-R;let X=0;$>.5?X=-1:$<-.5&&(X=1);let ne=(e/qi+s.x)/C+X,he=(i/qi+s.y)/C;ne=(ne-R)*d._pixelsPerMercatorPixel+R,he=(he-N)*d._pixelsPerMercatorPixel+N;const Pe=[ne*d.worldSize,he*d.worldSize,0];$o(Pe,Pe,m),E=Lc(E,Pe,v)}return $o(E,E,f)}_makeGlobeTileDebugBorderBuffer(e,i,s,d,f,m){const v=new zr,E=new wd,C=new Gr,R=($,X,ne,he,Pe)=>{const Xe=(ne-$)/(Pe-1),gt=(he-X)/(Pe-1),We=v.length;for(let dt=0;dt<Pe;dt++){const Dt=$+dt*Xe,yt=X+dt*gt;v.emplaceBack(Dt,yt);const cn=this._globePoint(Dt,yt,i,s,d,f,m);C.emplaceBack(cn[0],cn[1],cn[2]),E.emplaceBack(We+dt)}},N=qi;R(0,0,N,0,16),R(N,0,N,N,16),R(N,N,0,N,16),R(0,N,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(v,Kd.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(C,cg.members),this._tileDebugSegments=Yo.simpleSegment(0,0,v.length,E.length)}_makeGlobeTileDebugTextBuffer(e,i,s,d,f,m){const v=new zr,E=new Ys,C=new Gr,R=25;E.reserve(32),v.reserve(R),C.reserve(R);const N=($,X)=>R*$+X;for(let $=0;$<R;$++){const X=2048*$;for(let ne=0;ne<R;ne++){const he=2048*ne;v.emplaceBack(he,X);const Pe=this._globePoint(he,X,i,s,d,f,m);C.emplaceBack(Pe[0],Pe[1],Pe[2])}}for(let $=0;$<4;$++)for(let X=0;X<4;X++){const ne=N($,X),he=N($,X+1),Pe=N($+1,X),Xe=N($+1,X+1);E.emplaceBack(ne,he,Pe),E.emplaceBack(Pe,he,Xe)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(E),this._tileDebugTextBuffer=e.createVertexBuffer(v,Kd.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(C,cg.members),this._tileDebugTextSegments=Yo.simpleSegment(0,0,R,32)}}class Cg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,s){const d=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},Nn(this.stateChanges[e][d],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==d&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][d]){this.deletedStates[e][d]={};for(const f in this.state[e][d])s[f]||(this.deletedStates[e][d][f]=null)}else for(const f in s)this.deletedStates[e]&&this.deletedStates[e][d]&&null===this.deletedStates[e][d][f]&&delete this.deletedStates[e][d][f]}removeFeatureState(e,i,s){if(null===this.deletedStates[e])return;const d=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==i)null!==this.deletedStates[e][d]&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][s]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][d])for(s in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][s]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,i){const s=String(i),d=Nn({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(null===f)return{};for(const m in f)delete d[m]}return d}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const s={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const f={};for(const m in this.stateChanges[d])this.state[d][m]||(this.state[d][m]={}),Nn(this.state[d][m],this.stateChanges[d][m]),f[m]=this.state[d][m];s[d]=f}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const f={};if(null===this.deletedStates[d])for(const m in this.state[d])f[m]={},this.state[d][m]={};else for(const m in this.deletedStates[d]){if(null===this.deletedStates[d][m])this.state[d][m]={};else for(const v of Object.keys(this.deletedStates[d][m]))delete this.state[d][m][v];f[m]=this.state[d][m]}s[d]=s[d]||{},Nn(s[d],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const d in e)e[d].setFeatureState(s,i)}}class Af{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const s=this.toIdx(e,i);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function If(n,e,i,s){let d=0,f=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(s[m])<1e-15){if(i[m]<n[m]||i[m]>e[m])return null}else{const v=1/s[m];let E=(n[m]-i[m])*v,C=(e[m]-i[m])*v;if(E>C){const R=E;E=C,C=R}if(E>d&&(d=E),C<f&&(f=C),d>f)return null}return d}function Pf(n,e,i,s,d,f,m,v,E,C,R){const N=s-n,$=d-e,X=f-i,ne=m-n,he=v-e,Pe=E-i,Xe=R[1]*Pe-R[2]*he,gt=R[2]*ne-R[0]*Pe,We=R[0]*he-R[1]*ne,dt=N*Xe+$*gt+X*We;if(Math.abs(dt)<1e-15)return null;const Dt=1/dt,yt=C[0]-n,cn=C[1]-e,on=C[2]-i,Sn=(yt*Xe+cn*gt+on*We)*Dt;if(Sn<0||Sn>1)return null;const Gn=cn*X-on*$,yn=on*N-yt*X,Rn=yt*$-cn*N,Ln=(R[0]*Gn+R[1]*yn+R[2]*Rn)*Dt;return Ln<0||Sn+Ln>1?null:(ne*Gn+he*yn+Pe*Rn)*Dt}function Of(n,e,i){return(n-e)/(i-e)}function Rf(n,e,i,s,d,f,m,v,E){const C=1<<i,R=f-s,N=m-d,$=(n+1)/C*R+s,X=(e+0)/C*N+d,ne=(e+1)/C*N+d;v[0]=(n+0)/C*R+s,v[1]=X,E[0]=$,E[1]=ne}class kf{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(f){const m=Math.ceil(Math.log2(f.dim/8)),v=[];let E=Math.ceil(Math.pow(2,m));const C=1/E,R=(X,ne,he,Pe,Xe)=>{const gt=Pe?1:0,We=(X+1)*he-gt,dt=ne*he,Dt=(ne+1)*he-gt;Xe[0]=X*he,Xe[1]=dt,Xe[2]=We,Xe[3]=Dt};let N=new Af(E);const $=[];for(let X=0;X<E*E;X++){R(X%E,Math.floor(X/E),C,!1,$);const ne=Ua($[0],$[1],f),he=Ua($[2],$[1],f),Pe=Ua($[2],$[3],f),Xe=Ua($[0],$[3],f);N.minimums.push(Math.min(ne,he,Pe,Xe)),N.maximums.push(Math.max(ne,he,Pe,Xe)),N.leaves.push(1)}for(v.push(N),E/=2;E>=1;E/=2){const X=v[v.length-1];N=new Af(E);for(let ne=0;ne<E*E;ne++){R(ne%E,Math.floor(ne/E),2,!0,$);const he=X.getElevation($[0],$[1]),Pe=X.getElevation($[2],$[1]),Xe=X.getElevation($[2],$[3]),gt=X.getElevation($[0],$[3]),We=X.isLeaf($[0],$[1]),dt=X.isLeaf($[2],$[1]),Dt=X.isLeaf($[2],$[3]),yt=X.isLeaf($[0],$[3]),cn=Math.min(he.min,Pe.min,Xe.min,gt.min),on=Math.max(he.max,Pe.max,Xe.max,gt.max),Sn=We&&dt&&Dt&&yt;N.maximums.push(on),N.minimums.push(cn),N.leaves.push(on-cn<=5&&Sn?1:0)}v.push(N)}return v}(this.dem),s=i.length-1,d=i[s];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(i,0,0,s,0)}raycastRoot(e,i,s,d,f,m,v=1){return If([e,i,-100],[s,d,this.maximums[0]*v],f,m)}raycast(e,i,s,d,f,m,v=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,i,s,d,f,m,v);if(null==E)return null;const C=[],R=[],N=[],$=[],X=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;X.length>0;){const{idx:ne,t:he,nodex:Pe,nodey:Xe,depth:gt}=X.pop();if(this.leaves[ne]){Rf(Pe,Xe,gt,e,i,s,d,N,$);const dt=1<<gt,Dt=(Pe+0)/dt,yt=(Pe+1)/dt,cn=(Xe+0)/dt,on=(Xe+1)/dt,Sn=Ua(Dt,cn,this.dem)*v,Gn=Ua(yt,cn,this.dem)*v,yn=Ua(yt,on,this.dem)*v,Rn=Ua(Dt,on,this.dem)*v,Ln=Pf(N[0],N[1],Sn,$[0],N[1],Gn,$[0],$[1],yn,f,m),Un=Pf($[0],$[1],yn,N[0],$[1],Rn,N[0],N[1],Sn,f,m),Zn=Math.min(null!==Ln?Ln:Number.MAX_VALUE,null!==Un?Un:Number.MAX_VALUE);if(Zn!==Number.MAX_VALUE)return Zn;{const vn=xh([],f,m,he);if(oh(Sn,Gn,Rn,yn,Of(vn[0],N[0],$[0]),Of(vn[1],N[1],$[1]))>=vn[2])return he}continue}let We=0;for(let dt=0;dt<this._siblingOffset.length;dt++){Rf((Pe<<1)+this._siblingOffset[dt][0],(Xe<<1)+this._siblingOffset[dt][1],gt+1,e,i,s,d,N,$),N[2]=-100,$[2]=this.maximums[this.childOffsets[ne]+dt]*v;const Dt=If(N,$,f,m);if(null!=Dt){const yt=Dt;C[dt]=yt;let cn=!1;for(let on=0;on<We&&!cn;on++)yt>=C[R[on]]&&(R.splice(on,0,dt),cn=!0);cn||(R[We]=dt),We++}}for(let dt=0;dt<We;dt++){const Dt=R[dt];X.push({idx:this.childOffsets[ne]+Dt,t:C[Dt],nodex:(Pe<<1)+this._siblingOffset[Dt][0],nodey:(Xe<<1)+this._siblingOffset[Dt][1],depth:gt+1})}}return null}_addNode(e,i,s){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,s,d,f){if(1===e[d].isLeaf(i,s))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const m=d-1,v=e[m];let E=0,C=0;for(let R=0;R<this._siblingOffset.length;R++){const N=2*i+this._siblingOffset[R][0],$=2*s+this._siblingOffset[R][1],X=v.getElevation(N,$),ne=v.isLeaf(N,$),he=this._addNode(X.min,X.max,ne);ne&&(E|=1<<R),C||(C=he)}for(let R=0;R<this._siblingOffset.length;R++)E&1<<R||this._construct(e,2*i+this._siblingOffset[R][0],2*s+this._siblingOffset[R][1],m,C+R)}}function oh(n,e,i,s,d,f){return pi(pi(n,i,f),pi(e,s,f),d)}function Ua(n,e,i){const s=i.dim,d=Yt(n*s-.5,0,s-1),f=Yt(e*s-.5,0,s-1),m=Math.floor(d),v=Math.floor(f),E=Math.min(m+1,s-1),C=Math.min(v+1,s-1);return oh(i.get(m,v),i.get(E,v),i.get(m,C),i.get(E,C),d-m,f-v)}const Mg={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class ap{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,s,d=!1,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return Tt(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const m=this.dim=i.height-2,v=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=s||"mapbox",this.borderReady=d,!d){for(let E=0;E<m;E++)v[this._idx(-1,E)]=v[this._idx(0,E)],v[this._idx(m,E)]=v[this._idx(m-1,E)],v[this._idx(E,-1)]=v[this._idx(E,0)],v[this._idx(E,m)]=v[this._idx(E,m-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(m,-1)]=v[this._idx(m-1,0)],v[this._idx(-1,m)]=v[this._idx(0,m-1)],v[this._idx(m,m)]=v[this._idx(m-1,m-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new kf(this)}get(e,i,s=!1){s&&(e=Yt(e,-1,this.dim),i=Yt(i,-1,this.dim));const d=4*this._idx(e,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(e){return Mg[e]}get unpackVector(){return Mg[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,s){return(256*e*256+256*i+s)/10-1e4}_unpackTerrarium(e,i,s){return 256*e+i+s/256-32768}static pack(e,i){const s=[0,0,0,0],d=ap.getUnpackVector(i);let f=Math.floor((e+d[3])/d[2]);return s[2]=f%256,f=Math.floor(f/256),s[1]=f%256,f=Math.floor(f/256),s[0]=f,s}getPixels(){return new xa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=i*this.dim,f=i*this.dim+this.dim,m=s*this.dim,v=s*this.dim+this.dim;switch(i){case-1:d=f-1;break;case 1:f=d+1}switch(s){case-1:m=v-1;break;case 1:v=m+1}const E=-i*this.dim,C=-s*this.dim;for(let R=m;R<v;R++)for(let N=d;N<f;N++){const $=4*this._idx(N,R),X=4*this._idx(N+E,R+C);this.pixels[$+0]=e.pixels[X+0],this.pixels[$+1]=e.pixels[X+1],this.pixels[$+2]=e.pixels[X+2],this.pixels[$+3]=e.pixels[X+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Wn(ap,"DEMData"),Wn(kf,"DemMinMaxQuadTree",{omit:["dem"]});class Lf{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,s){const d=e.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const f={value:i,timeout:void 0};if(void 0!==s&&(f.timeout=setTimeout(()=>{this.remove(e,f)},s)),this.data[d].push(f),this.order.push(d),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const s=e.wrapped().key,d=void 0===i?0:this.data[s].indexOf(i),f=this.data[s][d];return this.data[s].splice(d,1),f.timeout&&clearTimeout(f.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(f.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const s in this.data)for(const d of this.data[s])e(d.value)||i.push(d);for(const s of i)this.remove(s.value.tileID,s)}}class kl{constructor(e,i,s){this.func=e,this.mask=i,this.range=s}}kl.ReadOnly=!1,kl.ReadWrite=!0,kl.disabled=new kl(519,kl.ReadOnly,[0,1]);class Ff{constructor(e,i,s,d,f,m){this.test=e,this.ref=i,this.mask=s,this.fail=d,this.depthFail=f,this.pass=m}}Ff.disabled=new Ff({func:519,mask:0},0,0,7680,7680,7680);class Ll{constructor(e,i,s){this.blendFunction=e,this.blendColor=i,this.mask=s}}Ll.Replace=[1,0],Ll.disabled=new Ll(Ll.Replace,Or.transparent,[!1,!1,!1,!1]),Ll.unblended=new Ll(Ll.Replace,Or.transparent,[!0,!0,!0,!0]),Ll.alphaBlended=new Ll([1,771],Or.transparent,[!0,!0,!0,!0]);class tc{constructor(e,i,s){this.enable=e,this.mode=i,this.frontFace=s}}tc.disabled=new tc(!1,1029,2305),tc.backCCW=new tc(!0,1029,2305),tc.backCW=new tc(!0,1029,2304),tc.frontCW=new tc(!0,1028,2304),tc.frontCCW=new tc(!0,1028,2305);class Lu extends Cr{constructor(e,i,s){super(),this.id=e,this._onlySymbols=s,i.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Lf(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Cg,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const s=this._tiles[i];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return Pn(this._tiles).map(e=>e.tileID).sort(Bf).map(e=>e.key)}getRenderableIds(e){const i=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&i.push(this._tiles[s]);return e?i.sort((s,d)=>{const f=s.tileID,m=d.tileID,v=new ht(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),E=new ht(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-m.overscaledZ||E.y-v.y||E.x-v.x}).map(s=>s.tileID.key):i.map(s=>s.tileID).sort(Bf).map(s=>s.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=i),this._loadTile(s,this._tileLoaded.bind(this,s,e,i)))}_tileLoaded(e,i,s,d){if(d)if(e.state="errored",404!==d.status)this._source.fire(new kr(d,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=hi.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ki("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let d=0;d<i.length;d++){const f=i[d];if(e.neighboringTiles&&e.neighboringTiles[f]){const m=this.getTileByID(f);s(e,m),s(m,e)}}function s(d,f){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let m=f.tileID.canonical.x-d.tileID.canonical.x;const v=f.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),C=f.tileID.key;0===m&&0===v||Math.abs(v)>1||(Math.abs(m)>1&&(1===Math.abs(m+E)?m+=E:1===Math.abs(m-E)&&(m-=E)),f.dem&&d.dem&&(d.dem.backfillBorder(f.dem,m,v),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,s,d){for(const f in this._tiles){let m=this._tiles[f];if(d[f]||!m.hasData()||m.tileID.overscaledZ<=i||m.tileID.overscaledZ>s)continue;let v=m.tileID;for(;m&&m.tileID.overscaledZ>i+1;){const C=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[C.key],m&&m.hasData()&&(v=C)}let E=v;for(;E.overscaledZ>i;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){d[v.key]=v;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=i?s:null}for(let s=e.overscaledZ-1;s>=i;s--){const d=e.scaledTo(s),f=this._getLoadedTile(d);if(f)return f}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const s=Math.ceil(e.width/i)+1,d=Math.ceil(e.height/i)+1,f=Math.floor(s*d*5),m="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,v="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const s={};for(const d in this._tiles){const f=this._tiles[d];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),s[f.tileID.key]=f}this._tiles=s;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(e,i,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let d;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new da(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(d=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(v=>this._source.hasTile(v)))):d=[];const f=this._updateRetainedTiles(d);if(Sg(this._source.type)&&0!==d.length){const v={},E={},C=Object.keys(f);for(const N of C){const $=f[N],X=this._tiles[N];if(!X||X.fadeEndTime&&X.fadeEndTime<=hi.now())continue;const ne=this.findLoadedParent($,Math.max($.overscaledZ-Lu.maxOverzooming,this._source.minzoom));ne&&(this._addTile(ne.tileID),v[ne.tileID.key]=ne.tileID),E[N]=$}const R=d[d.length-1].overscaledZ;for(const N in this._tiles){const $=this._tiles[N];if(f[N]||!$.hasData())continue;let X=$.tileID;for(;X.overscaledZ>R;){X=X.scaledTo(X.overscaledZ-1);const ne=this._tiles[X.key];if(ne&&ne.hasData()&&E[X.key]){f[N]=$.tileID;break}}}for(const N in v)f[N]||(this._coveredTiles[N]=!0,f[N]=v[N])}for(const v in f)this._tiles[v].clearFadeHold();const m=function(v,E){const C=[];for(const R in v)R in E||C.push(R);return C}(this._tiles,f);for(const v of m){const E=this._tiles[v];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const s={},d=e.reduce((C,R)=>Math.min(C,R.overscaledZ),1/0),f=e[0].overscaledZ,m=Math.max(f-Lu.maxOverzooming,this._source.minzoom),v=Math.max(f+Lu.maxUnderzooming,this._source.minzoom),E={};for(const C of e){const R=this._addTile(C);i[C.key]=C,R.hasData()||d<this._source.maxzoom&&(E[C.key]=C)}this._retainLoadedChildren(E,d,v,i);for(const C of e){let R=this._tiles[C.key];if(R.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const $=C.children(this._source.maxzoom)[0],X=this.getTile($);if(X&&X.hasData()){i[$.key]=$;continue}}else{const $=C.children(this._source.maxzoom);if(i[$[0].key]&&i[$[1].key]&&i[$[2].key]&&i[$[3].key])continue}let N=R.wasRequested();for(let $=C.overscaledZ-1;$>=m;--$){const X=C.scaledTo($);if(s[X.key]||(s[X.key]=!0,R=this.getTile(X),!R&&N&&(R=this._addTile(X)),R&&(i[X.key]=X,N=R.wasRequested(),R.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let s,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){s=this._loadedParentTiles[d.key];break}i.push(d.key);const f=d.scaledTo(d.overscaledZ-1);if(s=this._getLoadedTile(f),s)break;d=f}for(const f of i)this._loadedParentTiles[f]=s}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const s=Boolean(i);if(!s){const d=this.map?this.map.painter:null;i=new sp(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,s||this._source.fire(new Ki("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=i.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,s){const d=[],f=this.transform;if(!f)return d;const m="globe"===f.projection.name,v=Zl(f.center.lng);for(const E in this._tiles){const C=this._tiles[E];if(s&&C.clearQueryDebugViz(),C.holdingForFade())continue;let R;if(m){const N=C.tileID.canonical;if(0===N.z){const $=[Math.abs(Yt(v,...Qo(N,-1))-v),Math.abs(Yt(v,...Qo(N,1))-v)];R=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(Yt(v,...Qo(N,-1))-v),Math.abs(Yt(v,...Qo(N,0))-v),Math.abs(Yt(v,...Qo(N,1))-v)];R=[$.indexOf(Math.min(...$))-1]}}else R=[0];for(const N of R){const $=e.containsTile(C,f,i,N);$&&d.push($)}}return d}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of i)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Sg(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=hi.now())return!0}return!1}setFeatureState(e,i,s){this._state.updateState(e=e||"_geojsonTileLayer",i,s)}removeFeatureState(e,i,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,s)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,s){const d=this._tiles[e];d&&d.setDependencies(i,s)}reloadTilesForDependencies(e,i){for(const s in this._tiles)this._tiles[s].hasDependency(e,i)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,i))}_preloadTiles(e,i){const s=new Map,d=Array.isArray(e)?e:[e],f=this.map.painter.terrain,m=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const v of d){const E=v.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of E)s.set(C.key,C);this.usedForTerrain&&v.updateElevation(!1)}ct(Array.from(s.values()),(v,E)=>{const C=new sp(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,R=>{"raster-dem"===this._source.type&&C.dem&&this._backfillDEM(C),E(R,C)})},i)}}function Bf(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||s-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function Sg(n){return"raster"===n||"image"===n||"video"===n||"custom"===n}function Qo(n,e){const i=1<<n.z;return[n.x/i+e,(n.x+1)/i+e]}Lu.maxOverzooming=10,Lu.maxUnderzooming=3;class ah{constructor(e,i,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=s}static create(e,i,s){const d=s||e.findDEMTileFor(i);if(!d||!d.dem)return;const f=d.dem,m=d.tileID,v=1<<i.canonical.z-m.canonical.z;return new ah(d,d.tileSize/qi/v,[(i.canonical.x/v-m.canonical.x)*f.dim,(i.canonical.y/v-m.canonical.y)*f.dim])}tileCoordToPixel(e,i){const s=i*this._scale+this._offset[1],d=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(s);return new ht(d,f)}getElevationAt(e,i,s,d){const f=e*this._scale+this._offset[0],m=i*this._scale+this._offset[1],v=Math.floor(f),E=Math.floor(m),C=this._dem;return d=!!d,s?pi(pi(C.get(v,E,d),C.get(v,E+1,d),m-E),pi(C.get(v+1,E,d),C.get(v+1,E+1,d),m-E),f-v):C.get(v,E,d)}getElevationAtPixel(e,i,s){return this._dem.get(e,i,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*dl(1,e)*this._dem.stride}}class Ag{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new nr(qi,16,0),this.featureIndexArray=new fp,this.promoteId=i}insert(e,i,s,d,f,m=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,d,f,m);const E=this.grid;for(let C=0;C<i.length;C++){const R=i[C],N=[1/0,1/0,-1/0,-1/0];for(let $=0;$<R.length;$++){const X=R[$];N[0]=Math.min(N[0],X.x),N[1]=Math.min(N[1],X.y),N[2]=Math.max(N[2],X.x),N[3]=Math.max(N[3],X.y)}N[0]<qi&&N[1]<qi&&N[2]>=0&&N[3]>=0&&E.insert(v,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Rh(new od(this.rawTileData)).layers,this.sourceLayerCoder=new rp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,s,d){this.loadVTLayers();const f=e.params||{},m=sa(f.filter),v=e.tileResult,E=e.transform,C=v.bufferedTilespaceBounds,R=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(ne,he,Pe,Xe)=>Sp(v.bufferedTilespaceGeometry,ne,he,Pe,Xe));R.sort(Pg);let N=null;E.elevation&&R.length>0&&(N=ah.create(E.elevation,this.tileID));const $={};let X;for(let ne=0;ne<R.length;ne++){const he=R[ne];if(he===X)continue;X=he;const Pe=this.featureIndexArray.get(he);let Xe=null;this.loadMatchingFeature($,Pe,m,f.layers,f.availableImages,i,s,d,(gt,We,dt,Dt=0)=>(Xe||(Xe=pc(gt,this.tileID.canonical,e.tileTransform)),We.queryIntersectsFeature(v,gt,dt,Xe,this.z,e.transform,e.pixelPosMatrix,N,Dt)))}return $}loadMatchingFeature(e,i,s,d,f,m,v,E,C){const{featureIndex:R,bucketIndex:N,sourceLayerIndex:$,layoutVertexArrayOffset:X}=i,ne=this.bucketLayerIDs[N];if(d&&!function(gt,We){for(let dt=0;dt<gt.length;dt++)if(We.indexOf(gt[dt])>=0)return!0;return!1}(d,ne))return;const he=this.sourceLayerCoder.decode($),Pe=this.vtLayers[he].feature(R);if(s.needGeometry){const gt=fc(Pe,!0);if(!s.filter(new Wt(this.tileID.overscaledZ),gt,this.tileID.canonical))return}else if(!s.filter(new Wt(this.tileID.overscaledZ),Pe))return;const Xe=this.getId(Pe,he);for(let gt=0;gt<ne.length;gt++){const We=ne[gt];if(d&&d.indexOf(We)<0)continue;const dt=m[We];if(!dt)continue;let Dt={};void 0!==Xe&&E&&(Dt=E.getState(dt.sourceLayer||"_geojsonTileLayer",Xe));const yt=Nn({},v[We]);yt.paint=Ig(yt.paint,dt.paint,Pe,Dt,f),yt.layout=Ig(yt.layout,dt.layout,Pe,Dt,f);const cn=!C||C(Pe,dt,Dt,X);if(!cn)continue;const on=new Eg(Pe,this.z,this.x,this.y,Xe);on.layer=yt;let Sn=e[We];void 0===Sn&&(Sn=e[We]=[]),Sn.push({featureIndex:R,feature:on,intersectionZ:cn})}}lookupSymbolFeatures(e,i,s,d,f,m,v,E){const C={};this.loadVTLayers();const R=sa(f);for(const N of e)this.loadMatchingFeature(C,{bucketIndex:s,sourceLayerIndex:d,featureIndex:N,layoutVertexArrayOffset:0},R,m,v,E,i);return C}loadFeature(e){const{featureIndex:i,sourceLayerIndex:s}=e;this.loadVTLayers();const d=this.sourceLayerCoder.decode(s),f=this.vtFeatures[d];if(f[i])return f[i];const m=this.vtLayers[d].feature(i);return f[i]=m,m}hasLayer(e){for(const i of this.bucketLayerIDs)for(const s of i)if(e===s)return!0;return!1}getId(e,i){let s=e.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[i];null!=d&&(s=e.properties[d]),"boolean"==typeof s&&(s=Number(s))}return s}}function Ig(n,e,i,s,d){return ze(n,(f,m)=>{const v=e instanceof qn?e.get(m):null;return v&&v.evaluate?v.evaluate(i,s,d):v})}function Pg(n,e){return e-n}Wn(Ag,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Og{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new mc({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const s=this.getKey(e,i);return this.positions[s]}trim(){const e=this.width,i=this.height=Zt(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,s){const d=[];let f=e.length%2==1?-e[e.length-1]*s:0,m=e[0]*s,v=!0;d.push({left:f,right:m,isDash:v,zeroLength:0===e[0]});let E=e[0];for(let C=1;C<e.length;C++){v=!v;const R=e[C];f=E*s,E+=R,m=E*s,d.push({left:f,right:m,isDash:v,zeroLength:0===R})}return d}addRoundDash(e,i,s){const d=i/2;for(let f=-s;f<=s;f++){const m=this.width*(this.nextRow+s+f);let v=0,E=e[v];for(let C=0;C<this.width;C++){C/E.right>1&&(E=e[++v]);const R=Math.abs(C-E.left),N=Math.abs(C-E.right),$=Math.min(R,N);let X;const ne=f/s*(d+1);if(E.isDash){const he=d-Math.abs(ne);X=Math.sqrt($*$+he*he)}else X=d-Math.sqrt($*$+ne*ne);this.image.data[m+C]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(e,i){for(let E=e.length-1;E>=0;--E){const C=e[E],R=e[E+1];C.zeroLength?e.splice(E,1):R&&R.isDash===C.isDash&&(R.left=C.left,e.splice(E,1))}const s=e[0],d=e[e.length-1];s.isDash===d.isDash&&(s.left=d.left-this.width,d.right=s.right+this.width);const f=this.width*this.nextRow;let m=0,v=e[m];for(let E=0;E<this.width;E++){E/v.right>1&&(v=e[++m]);const C=Math.abs(E-v.left),R=Math.abs(E-v.right),N=Math.min(C,R);this.image.data[f+E]=Math.max(0,Math.min(255,(v.isDash?N:-N)+i+128))}}addDash(e,i){const s=this.getKey(e,i);if(this.positions[s])return this.positions[s];const d="round"===i,f=d?7:0,m=2*f+1;if(this.nextRow+m>this.height)return Tt("LineAtlas out of space"),null;0===e.length&&e.push(1);let v=0;for(let R=0;R<e.length;R++)e[R]<0&&(Tt("Negative value is found in line dasharray, replacing values with 0"),e[R]=0),v+=e[R];if(0!==v){const R=this.width/v,N=this.getDashRanges(e,this.width,R);d?this.addRoundDash(N,R,f):this.addRegularDash(N,"square"===i?.5*R:0)}const E=this.nextRow+f;this.nextRow+=m;const C={tl:[E,f],br:[v,0]};return this.positions[s]=C,C}}Wn(Og,"LineAtlas");class Nf{constructor(e){const i={},s=[];for(const v in e){const E=e[v],C=i[v]={};for(const R in E.glyphs){const N=E.glyphs[+R];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const $=N.metrics.localGlyph?2:1,X={x:0,y:0,w:N.bitmap.width+2*$,h:N.bitmap.height+2*$};s.push(X),C[R]=X}}const{w:d,h:f}=zh(s),m=new mc({width:d||1,height:f||1});for(const v in e){const E=e[v];for(const C in E.glyphs){const R=E.glyphs[+C];if(!R||0===R.bitmap.width||0===R.bitmap.height)continue;const N=i[v][C],$=R.metrics.localGlyph?2:1;mc.copy(R.bitmap,m,{x:0,y:0},{x:N.x+$,y:N.y+$},R.bitmap)}}this.image=m,this.positions=i}}Wn(Nf,"GlyphAtlas");class Rg{constructor(e){this.tileID=new da(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=wa(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,s,d,f){this.status="parsing",this.data=e,this.collisionBoxArray=new Ed;const m=new rp(Object.keys(e.layers).sort()),v=new Ag(this.tileID,this.promoteId);v.bucketLayerIDs=[];const E={},C=new Og(256,256),R={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:s},N=i.familiesBySource[this.source];for(const Dt in N){const yt=e.layers[Dt];if(!yt)continue;let cn=!1,on=!1;for(const yn of N[Dt])"symbol"===yn[0].type?cn=!0:on=!0;if(!0===this.isSymbolTile&&!cn||!1===this.isSymbolTile&&!on)continue;1===yt.version&&Tt(`Vector tile source "${this.source}" layer "${Dt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Sn=m.encode(Dt),Gn=[];for(let yn=0;yn<yt.length;yn++){const Rn=yt.feature(yn),Ln=v.getId(Rn,Dt);Gn.push({feature:Rn,id:Ln,index:yn,sourceLayerIndex:Sn})}for(const yn of N[Dt]){const Rn=yn[0];void 0!==this.isSymbolTile&&"symbol"===Rn.type!==this.isSymbolTile||Rn.minzoom&&this.zoom<Math.floor(Rn.minzoom)||Rn.maxzoom&&this.zoom>=Rn.maxzoom||"none"!==Rn.visibility&&(Qc(yn,this.zoom,s),(E[Rn.id]=Rn.createBucket({index:v.bucketLayerIDs.length,layers:yn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Sn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(Gn,R,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(yn.map(Ln=>Ln.id)))}}let $,X,ne,he;C.trim();const Pe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Xe=ze(R.glyphDependencies,Dt=>Object.keys(Dt).map(Number));Object.keys(Xe).length?d.send("getGlyphs",{uid:this.uid,stacks:Xe},(Dt,yt)=>{$||($=Dt,X=yt,dt.call(this))},void 0,!1,Pe):X={};const gt=Object.keys(R.iconDependencies);gt.length?d.send("getImages",{icons:gt,source:this.source,tileID:this.tileID,type:"icons"},(Dt,yt)=>{$||($=Dt,ne=yt,dt.call(this))},void 0,!1,Pe):ne={};const We=Object.keys(R.patternDependencies);function dt(){if($)return f($);if(X&&ne&&he){const Dt=new Nf(X),yt=new Xm(ne,he);for(const cn in E){const on=E[cn];on instanceof xc?(Qc(on.layers,this.zoom,s),sg(on,X,Dt.positions,ne,yt.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):on.hasPattern&&(on instanceof kh||on instanceof Ph||on instanceof za)&&(Qc(on.layers,this.zoom,s),on.addFeatures(R,this.tileID.canonical,yt.patternPositions,s,this.tileTransform))}this.status="done",f(null,{buckets:Pn(E).filter(cn=>!cn.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Dt.image,lineAtlas:C,imageAtlas:yt,glyphMap:this.returnDependencies?X:null,iconMap:this.returnDependencies?ne:null,glyphPositions:this.returnDependencies?Dt.positions:null})}}We.length?d.send("getImages",{icons:We,source:this.source,tileID:this.tileID,type:"patterns"},(Dt,yt)=>{$||($=Dt,he=yt,dt.call(this))},void 0,!1,Pe):he={},dt.call(this)}}function Qc(n,e,i){const s=new Wt(e);for(const d of n)d.recalculate(s,i)}class kg{constructor(e){this.entries={},this.scheduler=e}request(e,i,s,d){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[m,v]=f.result;return this.scheduler?this.scheduler.add(()=>{d(m,v)},i):d(m,v),()=>{}}return f.callbacks.push(d),f.cancel||(f.cancel=s((m,v)=>{f.result=[m,v];for(const E of f.callbacks)this.scheduler?this.scheduler.add(()=>{E(m,v)},i):E(m,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(m=>m!==d),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function Lg(n,e,i){const s=JSON.stringify(n.request);return n.data&&(this.deduped.entries[s]={result:[null,n.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},d=>{const f=ln(n.request,(m,v,E,C)=>{m?d(m):v&&d(null,{vectorTile:i?void 0:new Rh(new od(v)),rawData:v,cacheControl:E,expires:C})});return()=>{f.cancel(),d()}},e)}a.ARRAY_TYPE=Qa,a.AUTH_ERR_MSG=Kt,a.Aabb=Na,a.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Ct(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Rt()?n:de,this.scheduler=new wg}send(n,e,i,s,d=!1,f){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=f,this.callbacks[m]=i);const v=jn(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:n,hasCallback:!!i,targetMapId:s,mustQueue:d,sourceMapId:this.mapId,data:To(e,v)},v),{cancel:()=>{i&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s.cancel()}else if(e.mustQueue||Rt()){const s=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),s&&s.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if("<response>"===e.type){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(Bo(e.error)):i(null,Bo(e.data)))}else{const i=jn(this.globalScope)?void 0:[],s=e.hasCallback?(f,m)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:f?To(f):null,data:To(m,i)},i)}:f=>{},d=Bo(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,d,s);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],d.source)[f[1]](d,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=Bd,a.Color=Or,a.ColorMode=Ll,a.CullFaceMode=tc,a.DEMData=ap,a.DataConstantProperty=qt,a.DedupedRequest=kg,a.DepthMode=kl,a.EXTENT=qi,a.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const i=e.getSource().maxzoom,s=1<<i,d=Math.floor(n.x),f=Math.floor((n.x-d)*s),m=Math.floor(n.y*s),v=this.findDEMTileFor(new da(i,d,i,f,m));return!(!v||!v.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||n.y<0||n.y>1)return e;const d=s.getSource().maxzoom,f=1<<d,m=Math.floor(n.x),v=n.x-m,E=new da(d,m,d,Math.floor(v*f),Math.floor(n.y*f)),C=this.findDEMTileFor(E);if(!C||!C.dem)return e;const R=C.dem,N=1<<C.tileID.canonical.z,$=(v*N-C.tileID.canonical.x)*R.dim,X=(n.y*N-C.tileID.canonical.y)*R.dim,ne=Math.floor($),he=Math.floor(X);return(i?this.exaggeration():1)*pi(pi(R.get(ne,he),R.get(ne,he+1),X-he),pi(R.get(ne+1,he),R.get(ne+1,he+1),X-he),$-ne)}getAtTileOffset(n,e,i){const s=1<<n.canonical.z;return this.getAtPointOrZero(new Zc(n.wrap+(n.canonical.x+e/qi)/s,(n.canonical.y+i/qi)/s))}getAtTileOffsetFunc(n,e,i,s){return d=>{const f=this.getAtTileOffset(n,d.x,d.y),m=s.upVector(n.canonical,d.x,d.y);return Il(m,m,f*s.upVectorScale(n.canonical,e,i).metersToTile),m}}getForTilePoints(n,e,i,s){if(this.isUsingMockSource())return!1;const d=ah.create(this,n,s);return!!d&&(e.forEach(f=>{f[2]=this.exaggeration()*d.getElevationAt(f[0],f[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,s=e.tileID,d=1<<n.canonical.z-s.canonical.z;let f=n.canonical.x/d-s.canonical.x,m=n.canonical.y/d-s.canonical.y,v=0;for(let E=0;E<n.canonical.z-s.canonical.z&&!i.leaves[v];E++){f*=2,m*=2;const C=2*Math.floor(m)+Math.floor(f);v=i.childOffsets[v]+C,f%=1,m%=1}return{min:this.exaggeration()*i.minimums[v],max:this.exaggeration()*i.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=kr,a.EvaluationParameters=Wt,a.Event=Ki,a.Evented=Cr,a.FillExtrusionBucket=za,a.Frustum=Eh,a.FrustumCorners=Fp,a.GLOBE_METERS_TO_ECEF=ff,a.GLOBE_RADIUS=pl,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_createGrid(n){const e=new zr,i=new Ys,s=65;for(let d=0;d<s;d++)for(let f=0;f<s;f++)e.emplaceBack(f,d);this._gridSegments=[];for(let d=0,f=0;d<hd.length;d++){const m=hd[d];for(let E=0;E<m;E++)for(let C=0;C<64;C++){const R=E*s+C;i.emplaceBack(R+1,R,R+s),i.emplaceBack(R+s,R+s+1,R+1)}const v=64*m*2;this._gridSegments.push(Yo.simpleSegment(0,f,(m+1)*s,v)),f+=v}this._gridBuffer=n.createVertexBuffer(e,Kd.members),this._gridIndexBuffer=n.createIndexBuffer(i,!0)}_createPoles(n){const e=new Ys;for(let d=0;d<=64;d++)e.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const i=new su,s=new su;this._poleSegments=[];for(let d=0,f=0;d<5;d++){const m=360/(1<<d);i.emplaceBack(0,-pl,0,.5,0),s.emplaceBack(0,-pl,0,.5,1);for(let v=0;v<=64;v++){const E=v/64,C=pi(0,m,E),[R,N,$]=pd(q_,vf,C,pl);i.emplaceBack(R,N,$,E,0),s.emplaceBack(R,N,$,E,1)}this._poleSegments.push(Yo.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,pf,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(s,pf,!1)}getGridBuffers(n){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[n]]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const i=new ul,s=64,d=s+1;this._wireframeSegments=[];for(let f=0,m=0;f<hd.length;f++){const v=hd[f];for(let C=0;C<v;C++)for(let R=0;R<s;R++){const N=C*d+R;i.emplaceBack(N,N+1),i.emplaceBack(N,N+d),i.emplaceBack(N,N+d+1)}const E=v*s*3;this._wireframeSegments.push(Yo.simpleSegment(0,m,(v+1)*d,E)),m+=E}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=ud,a.ImagePosition=Hd,a.LivePerformanceUtils=en,a.LngLat=Ar,a.LngLatBounds=uu,a.LocalGlyphMode=uf,a.MAX_MERCATOR_LATITUDE=Al,a.MercatorCoordinate=Zc,a.ONE_EM=Ks,a.OverscaledTileID=da,a.PerformanceMarkers=ut,a.Properties=ki,a.RGBAImage=xa,a.Ray=Lp,a.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Re,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!Ft(n))return n;const i=be(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!Ft(n))return n;const i=be(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e,i,s){if(!Ft(n))return n;const d=be(n);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),i&&d.params.push(`language=${i}`),s&&d.params.push(`worldview=${s}`),this._makeAPIURL(d,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,s){const d=be(n);return Ft(n)?(d.path=`/styles/v1${d.path}/sprite${e}${i}`,this._makeAPIURL(d,this._customAccessToken||s)):(d.path+=`${e}${i}`,wt(d))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!Ft(n))return n;const s=be(n);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==s.authority&&512===i?"@2x":""}${Fe.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${Ce.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${Ce.TILE_URL_VERSION}${s.path}`);const d=this._customAccessToken||function(f){for(const m of f){const v=m.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(s.params)||Ce.ACCESS_TOKEN;return Ce.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,d)}canonicalizeTileURL(n,e){const i=be(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${Ce.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${Ce.TILE_URL_VERSION}/`,"")}`;let d=i.params;return e&&(d=d.filter(f=>!f.match(/^access_token=/))),d.length&&(s+=`?${d.join("&")}`),s}canonicalizeTileset(n,e){const i=!!e&&Ft(e),s=[];for(const d of n.tiles||[])_t(d)?s.push(this.canonicalizeTileURL(d,i)):s.push(d);return s}_makeAPIURL(n,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=be(Ce.API_URL);if(n.protocol=s.protocol,n.authority=s.authority,"http"===n.protocol){const d=n.params.indexOf("secure");d>=0&&n.params.splice(d,1)}if("/"!==s.path&&(n.path=`${s.path}${n.path}`),!Ce.REQUIRE_ACCESS_TOKEN)return wt(n);if(e=e||Ce.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(d=>-1===d.indexOf("access_token")),n.params.push(`access_token=${e||""}`),wt(n)}},a.ResourceType=At,a.SegmentVector=Yo,a.SourceCache=Lu,a.StencilMode=Ff,a.StructArrayLayout1ui2=wd,a.StructArrayLayout2f1f2i16=Oo,a.StructArrayLayout2i4=zr,a.StructArrayLayout2ui4=ul,a.StructArrayLayout3f12=Hl,a.StructArrayLayout3ui6=Ys,a.StructArrayLayout4i8=oo,a.StructArrayLayout5f20=su,a.Texture=ku,a.Tile=sp,a.Transitionable=In,a.Uniform1f=Vu,a.Uniform1i=class extends Gl{constructor(n){super(n),this.current=0}set(n,e,i){this.fetchUniformLocation(n,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},a.Uniform2f=class extends Gl{constructor(n){super(n),this.current=[0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},a.Uniform3f=class extends Gl{constructor(n){super(n),this.current=[0,0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},a.Uniform4f=_p,a.UniformColor=lu,a.UniformMatrix2f=class extends Gl{constructor(n){super(n),this.current=e_}set(n,e,i){if(this.fetchUniformLocation(n,e))for(let s=0;s<4;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},a.UniformMatrix3f=class extends Gl{constructor(n){super(n),this.current=tm}set(n,e,i){if(this.fetchUniformLocation(n,e))for(let s=0;s<9;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},a.UniformMatrix4f=class extends Gl{constructor(n){super(n),this.current=yp}set(n,e,i){if(this.fetchUniformLocation(n,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},a.UnwrappedTileID=Xp,a.ValidationError=Hn,a.VectorTileFeature=Yp,a.VectorTileWorkerSource=class extends Cr{constructor(n,e,i,s,d){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=d||Lg,this.loading={},this.loaded={},this.deduped=new kg(n.scheduler),this.isSpriteLoaded=s,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,s=n&&n.request,d=s&&s.collectResourceTiming,f=this.loading[i]=new Rg(n);f.abort=this.loadVectorData(n,(m,v)=>{const E=!this.loading[i];if(delete this.loading[i],E||m||!v)return f.status="done",E||(this.loaded[i]=f),e(m);const C=v.rawData,R={};v.expires&&(R.expires=v.expires),v.cacheControl&&(R.cacheControl=v.cacheControl),f.vectorTile=v.vectorTile||new Rh(new od(C));const N=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,($,X)=>{if($||!X)return e($);const ne={};if(d){const he=ei(s);he.length>0&&(ne.resourceTiming=JSON.parse(JSON.stringify(he)))}e(null,Nn({rawTileData:C.slice(0)},X,R,ne))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[i]=f})}reloadTile(n,e){const i=this.loaded,s=n.uid,d=this;if(i&&i[s]){const f=i[s];f.showCollisionBoxes=n.showCollisionBoxes,f.enableTerrain=!!n.enableTerrain,f.projection=n.projection,f.tileTransform=wa(n.tileID.canonical,n.projection);const m=(v,E)=>{const C=f.reloadCallback;C&&(delete f.reloadCallback,f.parse(f.vectorTile,d.layerIndex,this.availableImages,d.actor,C)),e(v,E)};"parsing"===f.status?f.reloadCallback=m:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(n,e){const i=n.uid,s=this.loading[i];s&&(s.abort&&s.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,s=n.uid;i&&i[s]&&delete i[s],e()}},a.WritingMode=hl,a.add=qc,a.addDynamicAttributes=Jh,a.adjoint=function(n,e){var i=e[0],s=e[1],d=e[2],f=e[3],m=e[4],v=e[5],E=e[6],C=e[7],R=e[8];return n[0]=m*R-v*C,n[1]=d*C-s*R,n[2]=s*v-d*m,n[3]=v*E-f*R,n[4]=i*R-d*E,n[5]=d*f-i*v,n[6]=f*C-m*E,n[7]=s*E-i*C,n[8]=i*m-s*f,n},a.asyncAll=ct,a.bezier=sn,a.bindAll=Ct,a.boundsAttributes=op,a.bufferConvexPolygon=function(n,e){const i=[];for(let s=0;s<n.length;s++){const d=Et(s-1,-1,n.length-1),f=Et(s+1,-1,n.length-1),m=n[s],v=n[f],E=n[d].sub(m).unit(),C=v.sub(m).unit(),R=C.angleWithSep(E.x,E.y),N=E.add(C).unit().mult(-1*e/Math.sin(R/2));i.push(m.add(N))}return i},a.cacheEntryPossiblyAdded=function(n){Mn++,Mn>lt&&(n.getActor().send("enforceCacheSizeLimit",xt),Mn=0)},a.calculateGlobeLabelMatrix=function(n,e){const{x:i,y:s}=n.point,d=Z_(i,s,n.worldSize/n._pixelsPerMercatorPixel,0,0);return fu(d,d,yf(Xl(e)))},a.calculateGlobeMatrix=function(n){const{x:e,y:i}=n.point,{lng:s,lat:d}=n._center;return Z_(e,i,n.worldSize,s,d)},a.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,i=e/dl(1,n.center.lat),s=Wl(new Float64Array(16));return Zu(s,s,[n.point.x,n.point.y,0]),mu(s,s,[i,i,e]),Float32Array.from(s)},a.circumferenceAtLatitude=mh,a.clamp=Yt,a.clearTileCache=function(n){if(!Vt())return;const e=de.caches.delete(dn);n&&e.catch(n).then(()=>n())},a.clipLine=rg,a.clone=function(n){var e=new Qa(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},a.clone$1=ve,a.collisionCircleLayout=id,a.config=Ce,a.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},a.create=function(){var n=new Qa(16);return Qa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},a.create$1=pm,a.createExpression=br,a.createLayout=di,a.createStyleLayer=function(n){return"custom"===n.type?new tp(n):new bg[n.type](n)},a.cross=Op,a.degToRad=Te,a.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},a.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},a.dot=Pl,a.earthRadius=du,a.ease=Cn,a.easeCubicInOut=It,a.ecefToLatLng=function([n,e,i]){const s=Math.hypot(n,e,i),d=Math.atan2(n,i),f=.5*Math.PI-Math.acos(-e/s);return new Ar(Ne(d),Ne(f))},a.emitValidationErrors=ar,a.endsWith=Jt,a.enforceCacheSizeLimit=function(n){An(),ue&&ue.then(e=>{e.keys().then(i=>{for(let s=0;s<i.length-n;s++)e.delete(i[s])})})},a.evaluateSizeForFeature=Fh,a.evaluateSizeForZoom=Cu,a.evaluateVariableOffset=hf,a.evented=Mt,a.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},a.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},a.exported=hi,a.exported$1=Fe,a.extend=Nn,a.extend$1=qr,a.fillExtrusionHeightLift=Kp,a.filterObject=zt,a.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},a.fromQuat=function(n,e){var i=e[0],s=e[1],d=e[2],f=e[3],m=i+i,v=s+s,E=d+d,C=i*m,R=s*m,N=s*v,$=d*m,X=d*v,ne=d*E,he=f*m,Pe=f*v,Xe=f*E;return n[0]=1-N-ne,n[1]=R+Xe,n[2]=$-Pe,n[3]=0,n[4]=R-Xe,n[5]=1-C-ne,n[6]=X+he,n[7]=0,n[8]=$+Pe,n[9]=X-he,n[10]=1-C-N,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},a.fromRotation=function(n,e){var i=Math.sin(e),s=Math.cos(e);return n[0]=s,n[1]=i,n[2]=0,n[3]=-i,n[4]=s,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},a.fromScaling=mm,a.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return mt[e]},a.getAABBPointSquareDist=function(n,e,i){let s=0;for(let d=0;d<2;++d){const f=i?i[d]:0;n[d]>f&&(s+=(n[d]-f)*(n[d]-f)),e[d]<f&&(s+=(f-e[d])*(f-e[d]))}return s},a.getAnchorAlignment=$d,a.getAnchorJustification=qh,a.getBounds=function(n){let e=1/0,i=1/0,s=-1/0,d=-1/0;for(const f of n)e=Math.min(e,f.x),i=Math.min(i,f.y),s=Math.max(s,f.x),d=Math.max(d,f.y);return{min:new ht(e,i),max:new ht(s,d)}},a.getColumn=Bi,a.getGridMatrix=function(n,e,i,s){const d=e.getNorth(),f=e.getSouth(),m=e.getWest(),v=e.getEast(),E=1<<n.z,C=v-m,R=d-f,N=C/64,$=-R/hd[i],X=[0,N,0,$,0,0,d,m,0];if(n.z>0){const ne=180/s;fm(X,X,[ne/C+1,0,0,0,ne/R+1,0,-.5*ne/N,.5*ne/$,1])}return X[2]=E,X[5]=n.x,X[8]=n.y,X},a.getImage=Ir,a.getJSON=function(n,e){return Dn(Nn(n,{type:"json"}),e)},a.getLatitudinalLod=function(n){const e=80.051129;n=Yt(n,-80.051129,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Te(n))),3);return Math.round(i*(hd.length-1))},a.getMapSessionAPI=te,a.getPerformanceMeasurement=ei,a.getProjection=wf,a.getRTLTextPluginStatus=jt,a.getReferrer=Qt,a.getTilePoint=function(n,{x:e,y:i},s=0){return new ht(((e-s)*n.scale-n.x)*qi,(i*n.scale-n.y)*qi)},a.getTileVec3=function(n,e,i=0){return _u(((e.x-i)*n.scale-n.x)*qi,(e.y*n.scale-n.y)*qi,wp(e.z,e.y))},a.getVideo=function(n,e){const i=de.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let s=0;s<n.length;s++){const d=de.document.createElement("source");mi(n[s])||(i.crossOrigin="Anonymous"),d.src=n[s],i.appendChild(d)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(n){const e=[0,0,0],i=Wl(new Float64Array(16));return fu(i,n.pixelMatrix,n.globeMatrix),$o(e,e,i),new ht(e[0],e[1])},a.globeDenormalizeECEF=yf,a.globeECEFOrigin=function(n,e){const i=[0,0,0];return $o(i,i,fd(Xl(e.canonical))),$o(i,i,n),i},a.globeNormalizeECEF=fd,a.globePixelsToTileUnits=function(n,e){return qi/(512*Math.pow(2,n))*Xh(Xl(e))},a.globePoleMatrixForTile=function(n,e,i){const s=Wl(new Float64Array(16)),d=(e/(1<<n)-.5)*Math.PI*2;return bh(s,i.globeMatrix,d),Float32Array.from(s)},a.globeTileBounds=Xl,a.globeTiltAtLngLat=W_,a.globeToMercatorTransition=Su,a.globeUseCustomAntiAliasing=function(n,e,i){const s=Su(i.zoom),d=n.style.map._antialias,f=!!e.extStandardDerivatives,m=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===s&&!d&&!m&&f},a.identity=Wl,a.identity$1=wh,a.invert=Ap,a.isFullscreen=function(){return!!de.document.fullscreenElement||!!de.document.webkitFullscreenElement},a.isLngLatBehindGlobe=md,a.isMapAuthenticated=function(n){return ge.has(n)},a.isMapboxURL=Ft,a.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!jn(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=_s,a.latLngToECEF=Qd,a.len=Rp,a.length=Wu,a.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},a.lngFromMercatorX=ba,a.loadVectorTile=Lg,a.makeRequest=Dn,a.mapValue=function(n,e,i,s,d){return Yt((n-e)/(i-e)*(d-s)+s,s,d)},a.mercatorScale=gh,a.mercatorXfromLng=Zl,a.mercatorYfromLat=Sl,a.mercatorZfromAltitude=dl,a.mul=Ic,a.mul$1=ym,a.multiply=fu,a.multiply$1=fm,a.multiply$2=r_,a.nextPowerOfTwo=Zt,a.normalize=ua,a.normalize$1=o_,a.normalize$2=ls,a.number=pi,a.ortho=function(n,e,i,s,d,f,m){var v=1/(e-i),E=1/(s-d),C=1/(f-m);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*C,n[11]=0,n[12]=(e+i)*v,n[13]=(d+s)*E,n[14]=(m+f)*C,n[15]=1,n},a.pbf=od,a.perspective=function(n,e,i,s,d){var f,m=1/Math.tan(e/2);return n[0]=m/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=m,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=d&&d!==1/0?(n[10]=(d+s)*(f=1/(s-d)),n[14]=2*d*s*f):(n[10]=-1,n[14]=-2*s),n},a.pick=function(n,e){const i={};for(let s=0;s<e.length;s++){const d=e[s];d in n&&(i[d]=n[d])}return i},a.plugin=rn,a.pointGeometry=ht,a.polesInViewport=function(n){const e=Wl(new Float64Array(16));fu(e,n.pixelMatrix,n.globeMatrix);const i=[0,Ol,0],s=[0,Rl,0];return $o(i,i,e),$o(s,s,e),[i[0]>0&&i[0]<=n.width&&i[1]>0&&i[1]<=n.height&&!md(n,new Ar(n.center.lat,90)),s[0]>0&&s[0]<=n.width&&s[1]>0&&s[1]<=n.height&&!md(n,new Ar(n.center.lat,-90))]},a.polygonContainsPoint=Wc,a.polygonIntersectsBox=Sp,a.polygonIntersectsPolygon=lm,a.polygonizeBounds=function(n,e,i=0,s=!0){const d=new ht(i,i),f=n.sub(d),m=e.add(d),v=[f,new ht(m.x,f.y),m,new ht(f.x,m.y)];return s&&v.push(f.clone()),v},a.posAttributes=Kd,a.postMapLoadEvent=Ge,a.postPerformanceEvent=xe,a.postTurnstileEvent=ae,a.potpack=zh,a.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},a.radToDeg=Ne,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(n){return n({pluginStatus:Ze,pluginURL:He}),Mt.on("pluginStateChange",n),n},a.removeAuthState=function(n){ge.delete(n)},a.renderColorRamp=Ad,a.resample=om,a.rotateX=Ip,a.rotateX$1=kp,a.rotateY=bh,a.rotateY$1=xm,a.rotateZ=function(n,e,i){var s=Math.sin(i),d=Math.cos(i),f=e[0],m=e[1],v=e[2],E=e[3],C=e[4],R=e[5],N=e[6],$=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=f*d+C*s,n[1]=m*d+R*s,n[2]=v*d+N*s,n[3]=E*d+$*s,n[4]=C*d-f*s,n[5]=R*d-m*s,n[6]=N*d-v*s,n[7]=$*d-E*s,n},a.rotateZ$1=function(n,e,i){i*=.5;var s=e[0],d=e[1],f=e[2],m=e[3],v=Math.sin(i),E=Math.cos(i);return n[0]=s*E+d*v,n[1]=d*E-s*v,n[2]=f*E+m*v,n[3]=m*E-f*v,n},a.scale=mu,a.scale$1=vm,a.scale$2=Il,a.scaleAndAdd=xh,a.set=function(n,e,i,s){return n[0]=e,n[1]=i,n[2]=s,n},a.setCacheLimits=function(n,e){xt=n,lt=e},a.setColumn=function(n,e,i){n[4*e+0]=i[0],n[4*e+1]=i[1],n[4*e+2]=i[2],n[4*e+3]=i[3]},a.setRTLTextPlugin=function(n,e,i=!1){if(Ze===Be||Ze===je||Ze===Ie)throw new Error("setRTLTextPlugin cannot be called multiple times.");He=hi.resolveURL(n),Ze=Be,Le=e,St(),i||un()},a.smoothstep=nt,a.spec=pn,a.squaredLength=function(n){var e=n[0],i=n[1],s=n[2];return e*e+i*i+s*s},a.storeAuthState=function(n,e){e?ge.add(n):ge.delete(n)},a.sub=Ja,a.subtract=gm,a.symbolSize=D_,a.tileAABB=function(n,e,i,s,d,f,m,v,E){if("globe"===E.name)return function $_(n,e,i){const s=e/n.worldSize,d=n.globeMatrix;if(i.z<=1){const on=Xl(i).getCorners();return Yh(on,d,s),Na.fromPoints(on)}const f=Kh(i),m=gf(f);Yh(m,d,s);const v=Number.MAX_VALUE,E=[-v,-v,-v],C=[v,v,v];if(f.contains(n.center)){for(const Gn of m)yu(C,C,Gn),vu(E,E,Gn);E[2]=0;const on=n.point,Sn=[on.x*s,on.y*s,0];return yu(C,C,Sn),vu(E,E,Sn),new Na(C,E)}const R=[d[12]*s,d[13]*s,d[14]*s],N=f.getCenter(),$=Yt(n.center.lat,-85.051129,Al),X=Yt(N.lat,-85.051129,Al),ne=Zl(n.center.lng),he=Sl($);let Pe=ne-Zl(N.lng);const Xe=he-Sl(X);Pe>.5?Pe-=1:Pe<-.5&&(Pe+=1);let gt=0;Math.abs(Pe)>Math.abs(Xe)?gt=Pe>=0?1:3:(gt=Xe>=0?0:2,xh(R,R,[d[4]*s,d[5]*s,d[6]*s],-Math.sin(Te(Xe>=0?f.getSouth():f.getNorth()))*pl));const We=m[gt],dt=m[(gt+1)%4],Dt=new G_(We,dt,R),yt=[mf(Dt,0)||We[0],mf(Dt,1)||We[1],mf(Dt,2)||We[2]],cn=Su(n.zoom);if(cn>0){const on=function({x:Gn,y:yn,z:Rn},Ln,Un,Zn,vn){const ti=1/(1<<Rn);let Fi=Gn*ti,oi=Fi+ti,vi=yn*ti,ni=vi+ti,Ui=0;const _r=(Fi+oi)/2-Zn;return _r>.5?Ui=-1:_r<-.5&&(Ui=1),Fi=((Fi+Ui)*Ln-(Zn*=Ln))*Un+Zn,oi=((oi+Ui)*Ln-Zn)*Un+Zn,vi=(vi*Ln-(vn*=Ln))*Un+vn,ni=(ni*Ln-vn)*Un+vn,[[Fi,ni,0],[oi,ni,0],[oi,vi,0],[Fi,vi,0]]}(i,e,n._pixelsPerMercatorPixel,ne,he);for(let Gn=0;Gn<m.length;Gn++)Lc(m[Gn],on[Gn],cn);const Sn=qc([],on[gt],on[(gt+1)%4]);Il(Sn,Sn,.5),Lc(yt,Sn,cn)}for(const on of m)yu(C,C,on),vu(E,E,on);return C[2]=Math.min(We[2],dt[2]),yu(C,C,yt),vu(E,E,yt),new Na(C,E)}(n,e,new Bd(i,s,d));const C=wa({z:i,x:s,y:d},E);return new Na([(f+C.x/C.scale)*e,e*(C.y/C.scale),m],[(f+C.x2/C.scale)*e,e*(C.y2/C.scale),v])},a.tileCornersToBounds=Kh,a.tileTransform=wa,a.transformMat3=function(n,e,i){var s=e[0],d=e[1],f=e[2];return n[0]=s*i[0]+d*i[3]+f*i[6],n[1]=s*i[1]+d*i[4]+f*i[7],n[2]=s*i[2]+d*i[5]+f*i[8],n},a.transformMat4=$o,a.transformMat4$1=bu,a.transformQuat=_m,a.transitionTileAABBinECEF=dg,a.translate=Zu,a.transpose=function(n,e){if(n===e){var i=e[1],s=e[2],d=e[5];n[1]=e[3],n[2]=e[6],n[3]=i,n[5]=e[7],n[6]=s,n[7]=d}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},a.triggerPluginCompletionEvent=st,a.uniqueId=Ci,a.updateGlobeVertexNormal=function(n,e,i,s,d){const f=5*e+2;n.float32[f+0]=i,n.float32[f+1]=s,n.float32[f+2]=d},a.validateCustomStyleLayer=function(n){const e=[],i=n.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=n=>ui(xl(n)),a.validateFog=n=>ui(ie(n)),a.validateLayer=n=>ui(hc(n)),a.validateLight=n=>ui(T(n)),a.validateSource=n=>ui(K(n)),a.validateStyle=hn,a.validateTerrain=n=>ui(V(n)),a.values=Pn,a.vectorTile=Oh,a.version=Qe,a.warnOnce=Tt,a.window=de,a.wrap=Et}),y(0,function(a){function de(pe){if("number"==typeof pe||"boolean"==typeof pe||"string"==typeof pe||null==pe)return JSON.stringify(pe);if(Array.isArray(pe)){let ae="[";for(const ye of pe)ae+=`${de(ye)},`;return`${ae}]`}let Q="{";for(const ae of Object.keys(pe).sort())Q+=`${ae}:${de(pe[ae])},`;return`${Q}}`}function Qe(pe){let Q="";for(const ae of a.refProperties)Q+=`/${de(pe[ae])}`;return Q}class it{constructor(Q){this.keyCache={},Q&&this.replace(Q)}replace(Q){this._layerConfigs={},this._layers={},this.update(Q,[])}update(Q,ae){for(const Ge of Q)this._layerConfigs[Ge.id]=Ge,(this._layers[Ge.id]=a.createStyleLayer(Ge)).compileFilter(),this.keyCache[Ge.id]&&delete this.keyCache[Ge.id];for(const Ge of ae)delete this.keyCache[Ge],delete this._layerConfigs[Ge],delete this._layers[Ge];this.familiesBySource={};const ye=function(Ge,Ye){const xe={};for(let te=0;te<Ge.length;te++){const ge=Ye&&Ye[Ge[te].id]||Qe(Ge[te]);Ye&&(Ye[Ge[te].id]=ge);let ut=xe[ge];ut||(ut=xe[ge]=[]),ut.push(Ge[te])}const fe=[];for(const te in xe)fe.push(xe[te]);return fe}(a.values(this._layerConfigs),this.keyCache);for(const Ge of ye){const Ye=Ge.map(en=>this._layers[en.id]),xe=Ye[0];if("none"===xe.visibility)continue;const fe=xe.source||"";let te=this.familiesBySource[fe];te||(te=this.familiesBySource[fe]={});const ge=xe.sourceLayer||"_geojsonTileLayer";let ut=te[ge];ut||(ut=te[ge]=[]),ut.push(Ye)}}}class Ce{loadTile(Q,ae){const{uid:ye,encoding:Ge,rawImageData:Ye,padding:xe,buildQuadTree:fe}=Q,te=a.window.ImageBitmap&&Ye instanceof a.window.ImageBitmap?this.getImageData(Ye,xe):Ye;ae(null,new a.DEMData(ye,te,Ge,xe<1,fe))}getImageData(Q,ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);const ye=this.offscreenCanvasContext.getImageData(-ae,-ae,Q.width+2*ae,Q.height+2*ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ye}}var Fe=function pe(Q,ae){var ye,Ge=Q&&Q.type;if("FeatureCollection"===Ge)for(ye=0;ye<Q.features.length;ye++)pe(Q.features[ye],ae);else if("GeometryCollection"===Ge)for(ye=0;ye<Q.geometries.length;ye++)pe(Q.geometries[ye],ae);else if("Feature"===Ge)pe(Q.geometry,ae);else if("Polygon"===Ge)$e(Q.coordinates,ae);else if("MultiPolygon"===Ge)for(ye=0;ye<Q.coordinates.length;ye++)$e(Q.coordinates[ye],ae);return Q};function $e(pe,Q){if(0!==pe.length){at(pe[0],Q);for(var ae=1;ae<pe.length;ae++)at(pe[ae],!Q)}}function at(pe,Q){for(var ae=0,ye=0,Ge=0,Ye=pe.length,xe=Ye-1;Ge<Ye;xe=Ge++){var fe=(pe[Ge][0]-pe[xe][0])*(pe[xe][1]+pe[Ge][1]),te=ae+fe;ye+=Math.abs(ae)>=Math.abs(fe)?ae-te+fe:fe-te+ae,ae=te}ae+ye>=0!=!!Q&&pe.reverse()}const qe=a.VectorTileFeature.prototype.toGeoJSON;class Ve{constructor(Q){this._feature=Q,this.extent=a.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(1===this._feature.type){const Q=[];for(const ae of this._feature.geometry)Q.push([new a.pointGeometry(ae[0],ae[1])]);return Q}{const Q=[];for(const ae of this._feature.geometry){const ye=[];for(const Ge of ae)ye.push(new a.pointGeometry(Ge[0],Ge[1]));Q.push(ye)}return Q}}toGeoJSON(Q,ae,ye){return qe.call(this,Q,ae,ye)}}class tt{constructor(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Q.length,this._features=Q}feature(Q){return new Ve(this._features[Q])}}var Re={exports:{}},ft=a.pointGeometry,et=a.vectorTile.VectorTileFeature,ht=Gt;function Gt(pe,Q){this.options=Q||{},this.features=pe,this.length=pe.length}function an(pe,Q){this.id="number"==typeof pe.id?pe.id:void 0,this.type=pe.type,this.rawGeometry=1===pe.type?[pe.geometry]:pe.geometry,this.properties=pe.tags,this.extent=Q||4096}Gt.prototype.feature=function(pe){return new an(this.features[pe],this.options.extent)},an.prototype.loadGeometry=function(){var pe=this.rawGeometry;this.geometry=[];for(var Q=0;Q<pe.length;Q++){for(var ae=pe[Q],ye=[],Ge=0;Ge<ae.length;Ge++)ye.push(new ft(ae[Ge][0],ae[Ge][1]));this.geometry.push(ye)}return this.geometry},an.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var pe=this.geometry,Q=1/0,ae=-1/0,ye=1/0,Ge=-1/0,Ye=0;Ye<pe.length;Ye++)for(var xe=pe[Ye],fe=0;fe<xe.length;fe++){var te=xe[fe];Q=Math.min(Q,te.x),ae=Math.max(ae,te.x),ye=Math.min(ye,te.y),Ge=Math.max(Ge,te.y)}return[Q,ye,ae,Ge]},an.prototype.toGeoJSON=et.prototype.toGeoJSON;var ot=a.pbf,Te=ht;function Ne(pe){var Q=new ot;return function(ae,ye){for(var Ge in ae.layers)ye.writeMessage(3,mt,ae.layers[Ge])}(pe,Q),Q.finish()}function mt(pe,Q){var ae;Q.writeVarintField(15,pe.version||1),Q.writeStringField(1,pe.name||""),Q.writeVarintField(5,pe.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(ae=0;ae<pe.length;ae++)ye.feature=pe.feature(ae),Q.writeMessage(2,It,ye);var Ge=ye.keys;for(ae=0;ae<Ge.length;ae++)Q.writeStringField(3,Ge[ae]);var Ye=ye.values;for(ae=0;ae<Ye.length;ae++)Q.writeMessage(4,Et,Ye[ae])}function It(pe,Q){var ae=pe.feature;void 0!==ae.id&&Q.writeVarintField(1,ae.id),Q.writeMessage(2,sn,pe),Q.writeVarintField(3,ae.type),Q.writeMessage(4,nt,ae)}function sn(pe,Q){var ae=pe.feature,ye=pe.keys,Ge=pe.values,Ye=pe.keycache,xe=pe.valuecache;for(var fe in ae.properties){var te=ae.properties[fe],ge=Ye[fe];if(null!==te){void 0===ge&&(ye.push(fe),Ye[fe]=ge=ye.length-1),Q.writeVarint(ge);var ut=typeof te;"string"!==ut&&"boolean"!==ut&&"number"!==ut&&(te=JSON.stringify(te));var en=ut+":"+te,Xt=xe[en];void 0===Xt&&(Ge.push(te),xe[en]=Xt=Ge.length-1),Q.writeVarint(Xt)}}}function Cn(pe,Q){return(Q<<3)+(7&pe)}function Yt(pe){return pe<<1^pe>>31}function nt(pe,Q){for(var ae=pe.loadGeometry(),ye=pe.type,Ge=0,Ye=0,xe=ae.length,fe=0;fe<xe;fe++){var te=ae[fe],ge=1;1===ye&&(ge=te.length),Q.writeVarint(Cn(1,ge));for(var ut=3===ye?te.length-1:te.length,en=0;en<ut;en++){1===en&&1!==ye&&Q.writeVarint(Cn(2,ut-1));var Xt=te[en].x-Ge,Qn=te[en].y-Ye;Q.writeVarint(Yt(Xt)),Q.writeVarint(Yt(Qn)),Ge+=Xt,Ye+=Qn}3===ye&&Q.writeVarint(Cn(7,1))}}function Et(pe,Q){var ae=typeof pe;"string"===ae?Q.writeStringField(1,pe):"boolean"===ae?Q.writeBooleanField(7,pe):"number"===ae&&(pe%1!=0?Q.writeDoubleField(3,pe):pe<0?Q.writeSVarintField(6,pe):Q.writeVarintField(5,pe))}function ct(pe,Q,ae,ye,Ge,Ye){if(Ge-ye<=ae)return;const xe=ye+Ge>>1;Pn(pe,Q,xe,ye,Ge,Ye%2),ct(pe,Q,ae,ye,xe-1,Ye+1),ct(pe,Q,ae,xe+1,Ge,Ye+1)}function Pn(pe,Q,ae,ye,Ge,Ye){for(;Ge>ye;){if(Ge-ye>600){const ge=Ge-ye+1,ut=ae-ye+1,en=Math.log(ge),Xt=.5*Math.exp(2*en/3),Qn=.5*Math.sqrt(en*Xt*(ge-Xt)/ge)*(ut-ge/2<0?-1:1);Pn(pe,Q,ae,Math.max(ye,Math.floor(ae-ut*Xt/ge+Qn)),Math.min(Ge,Math.floor(ae+(ge-ut)*Xt/ge+Qn)),Ye)}const xe=Q[2*ae+Ye];let fe=ye,te=Ge;for(Nn(pe,Q,ye,ae),Q[2*Ge+Ye]>xe&&Nn(pe,Q,ye,Ge);fe<te;){for(Nn(pe,Q,fe,te),fe++,te--;Q[2*fe+Ye]<xe;)fe++;for(;Q[2*te+Ye]>xe;)te--}Q[2*ye+Ye]===xe?Nn(pe,Q,ye,te):(te++,Nn(pe,Q,te,Ge)),te<=ae&&(ye=te+1),ae<=te&&(Ge=te-1)}}function Nn(pe,Q,ae,ye){fi(pe,ae,ye),fi(Q,2*ae,2*ye),fi(Q,2*ae+1,2*ye+1)}function fi(pe,Q,ae){const ye=pe[Q];pe[Q]=pe[ae],pe[ae]=ye}function Ci(pe,Q,ae,ye){const Ge=pe-ae,Ye=Q-ye;return Ge*Ge+Ye*Ye}Re.exports=Ne,Re.exports.fromVectorTileJs=Ne,Re.exports.fromGeojsonVt=function(pe,Q){Q=Q||{};var ae={};for(var ye in pe)ae[ye]=new Te(pe[ye].features,Q),ae[ye].name=ye,ae[ye].version=Q.version,ae[ye].extent=Q.extent;return Ne({layers:ae})},Re.exports.GeoJSONWrapper=Te;const Bt=pe=>pe[0],Zt=pe=>pe[1];class nn{constructor(Q,ae=Bt,ye=Zt,Ge=64,Ye=Float64Array){this.nodeSize=Ge,this.points=Q;const xe=Q.length<65536?Uint16Array:Uint32Array,fe=this.ids=new xe(Q.length),te=this.coords=new Ye(2*Q.length);for(let ge=0;ge<Q.length;ge++)fe[ge]=ge,te[2*ge]=ae(Q[ge]),te[2*ge+1]=ye(Q[ge]);ct(fe,te,Ge,0,fe.length-1,0)}range(Q,ae,ye,Ge){return function(Ye,xe,fe,te,ge,ut,en){const Xt=[0,Ye.length-1,0],Qn=[];let ei,ci;for(;Xt.length;){const gi=Xt.pop(),Vi=Xt.pop(),ji=Xt.pop();if(Vi-ji<=en){for(let ir=ji;ir<=Vi;ir++)ei=xe[2*ir],ci=xe[2*ir+1],ei>=fe&&ei<=ge&&ci>=te&&ci<=ut&&Qn.push(Ye[ir]);continue}const hi=Math.floor((ji+Vi)/2);ei=xe[2*hi],ci=xe[2*hi+1],ei>=fe&&ei<=ge&&ci>=te&&ci<=ut&&Qn.push(Ye[hi]);const Yi=(gi+1)%2;(0===gi?fe<=ei:te<=ci)&&(Xt.push(ji),Xt.push(hi-1),Xt.push(Yi)),(0===gi?ge>=ei:ut>=ci)&&(Xt.push(hi+1),Xt.push(Vi),Xt.push(Yi))}return Qn}(this.ids,this.coords,Q,ae,ye,Ge,this.nodeSize)}within(Q,ae,ye){return function(Ge,Ye,xe,fe,te,ge){const ut=[0,Ge.length-1,0],en=[],Xt=te*te;for(;ut.length;){const Qn=ut.pop(),ei=ut.pop(),ci=ut.pop();if(ei-ci<=ge){for(let Yi=ci;Yi<=ei;Yi++)Ci(Ye[2*Yi],Ye[2*Yi+1],xe,fe)<=Xt&&en.push(Ge[Yi]);continue}const gi=Math.floor((ci+ei)/2),Vi=Ye[2*gi],ji=Ye[2*gi+1];Ci(Vi,ji,xe,fe)<=Xt&&en.push(Ge[gi]);const hi=(Qn+1)%2;(0===Qn?xe-te<=Vi:fe-te<=ji)&&(ut.push(ci),ut.push(gi-1),ut.push(hi)),(0===Qn?xe+te>=Vi:fe+te>=ji)&&(ut.push(gi+1),ut.push(ei),ut.push(hi))}return en}(this.ids,this.coords,Q,ae,ye,this.nodeSize)}}const Ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:pe=>pe},Jt=Math.fround||(ze=new Float32Array(1),pe=>(ze[0]=+pe,ze[0]));var ze;class zt{constructor(Q){this.options=vt(Object.create(Ct),Q),this.trees=new Array(this.options.maxZoom+1)}load(Q){const{log:ae,minZoom:ye,maxZoom:Ge,nodeSize:Ye}=this.options;ae&&console.time("total time");const xe=`prepare ${Q.length} points`;ae&&console.time(xe),this.points=Q;let fe=[];for(let te=0;te<Q.length;te++)Q[te].geometry&&fe.push(Lt(Q[te],te));this.trees[Ge+1]=new nn(fe,jn,li,Ye,Float32Array),ae&&console.timeEnd(xe);for(let te=Ge;te>=ye;te--){const ge=+Date.now();fe=this._cluster(fe,te),this.trees[te]=new nn(fe,jn,li,Ye,Float32Array),ae&&console.log("z%d: %d clusters in %dms",te,fe.length,+Date.now()-ge)}return ae&&console.timeEnd("total time"),this}getClusters(Q,ae){let ye=((Q[0]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,Q[1]));let Ye=180===Q[2]?180:((Q[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)ye=-180,Ye=180;else if(ye>Ye){const ut=this.getClusters([ye,Ge,180,xe],ae),en=this.getClusters([-180,Ge,Ye,xe],ae);return ut.concat(en)}const fe=this.trees[this._limitZoom(ae)],te=fe.range(me(ye),Rt(xe),me(Ye),Rt(Ge)),ge=[];for(const ut of te){const en=fe.points[ut];ge.push(en.numPoints?Tt(en):this.points[en.index])}return ge}getChildren(Q){const ae=this._getOriginId(Q),ye=this._getOriginZoom(Q),Ge="No cluster with the specified id.",Ye=this.trees[ye];if(!Ye)throw new Error(Ge);const xe=Ye.points[ae];if(!xe)throw new Error(Ge);const fe=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),te=Ye.within(xe.x,xe.y,fe),ge=[];for(const ut of te){const en=Ye.points[ut];en.parentId===Q&&ge.push(en.numPoints?Tt(en):this.points[en.index])}if(0===ge.length)throw new Error(Ge);return ge}getLeaves(Q,ae,ye){const Ge=[];return this._appendLeaves(Ge,Q,ae=ae||10,ye=ye||0,0),Ge}getTile(Q,ae,ye){const Ge=this.trees[this._limitZoom(Q)],Ye=Math.pow(2,Q),{extent:xe,radius:fe}=this.options,te=fe/xe,ge=(ye-te)/Ye,ut=(ye+1+te)/Ye,en={features:[]};return this._addTileFeatures(Ge.range((ae-te)/Ye,ge,(ae+1+te)/Ye,ut),Ge.points,ae,ye,Ye,en),0===ae&&this._addTileFeatures(Ge.range(1-te/Ye,ge,1,ut),Ge.points,Ye,ye,Ye,en),ae===Ye-1&&this._addTileFeatures(Ge.range(0,ge,te/Ye,ut),Ge.points,-1,ye,Ye,en),en.features.length?en:null}getClusterExpansionZoom(Q){let ae=this._getOriginZoom(Q)-1;for(;ae<=this.options.maxZoom;){const ye=this.getChildren(Q);if(ae++,1!==ye.length)break;Q=ye[0].properties.cluster_id}return ae}_appendLeaves(Q,ae,ye,Ge,Ye){const xe=this.getChildren(ae);for(const fe of xe){const te=fe.properties;if(te&&te.cluster?Ye+te.point_count<=Ge?Ye+=te.point_count:Ye=this._appendLeaves(Q,te.cluster_id,ye,Ge,Ye):Ye<Ge?Ye++:Q.push(fe),Q.length===ye)break}return Ye}_addTileFeatures(Q,ae,ye,Ge,Ye,xe){for(const fe of Q){const te=ae[fe],ge=te.numPoints;let ut,en,Xt;if(ge)ut=fn(te),en=te.x,Xt=te.y;else{const ci=this.points[te.index];ut=ci.properties,en=me(ci.geometry.coordinates[0]),Xt=Rt(ci.geometry.coordinates[1])}const Qn={type:1,geometry:[[Math.round(this.options.extent*(en*Ye-ye)),Math.round(this.options.extent*(Xt*Ye-Ge))]],tags:ut};let ei;ge?ei=te.id:this.options.generateId?ei=te.index:this.points[te.index].id&&(ei=this.points[te.index].id),void 0!==ei&&(Qn.id=ei),xe.features.push(Qn)}}_limitZoom(Q){return Math.max(this.options.minZoom,Math.min(Math.floor(+Q),this.options.maxZoom+1))}_cluster(Q,ae){const ye=[],{radius:Ge,extent:Ye,reduce:xe,minPoints:fe}=this.options,te=Ge/(Ye*Math.pow(2,ae));for(let ge=0;ge<Q.length;ge++){const ut=Q[ge];if(ut.zoom<=ae)continue;ut.zoom=ae;const en=this.trees[ae+1],Xt=en.within(ut.x,ut.y,te),Qn=ut.numPoints||1;let ei=Qn;for(const ci of Xt){const gi=en.points[ci];gi.zoom>ae&&(ei+=gi.numPoints||1)}if(ei>Qn&&ei>=fe){let ci=ut.x*Qn,gi=ut.y*Qn,Vi=xe&&Qn>1?this._map(ut,!0):null;const ji=(ge<<5)+(ae+1)+this.points.length;for(const hi of Xt){const Yi=en.points[hi];if(Yi.zoom<=ae)continue;Yi.zoom=ae;const ir=Yi.numPoints||1;ci+=Yi.x*ir,gi+=Yi.y*ir,Yi.parentId=ji,xe&&(Vi||(Vi=this._map(ut,!0)),xe(Vi,this._map(Yi)))}ut.parentId=ji,ye.push(ve(ci/ei,gi/ei,ji,ei,Vi))}else if(ye.push(ut),ei>1)for(const ci of Xt){const gi=en.points[ci];gi.zoom<=ae||(gi.zoom=ae,ye.push(gi))}}return ye}_getOriginId(Q){return Q-this.points.length>>5}_getOriginZoom(Q){return(Q-this.points.length)%32}_map(Q,ae){if(Q.numPoints)return ae?vt({},Q.properties):Q.properties;const ye=this.points[Q.index].properties,Ge=this.options.map(ye);return ae&&Ge===ye?vt({},Ge):Ge}}function ve(pe,Q,ae,ye,Ge){return{x:Jt(pe),y:Jt(Q),zoom:1/0,id:ae,parentId:-1,numPoints:ye,properties:Ge}}function Lt(pe,Q){const[ae,ye]=pe.geometry.coordinates;return{x:Jt(me(ae)),y:Jt(Rt(ye)),zoom:1/0,index:Q,parentId:-1}}function Tt(pe){return{type:"Feature",id:pe.id,properties:fn(pe),geometry:{type:"Point",coordinates:[(Q=pe.x,360*(Q-.5)),Se(pe.y)]}};var Q}function fn(pe){const Q=pe.numPoints,ae=Q>=1e4?`${Math.round(Q/1e3)}k`:Q>=1e3?Math.round(Q/100)/10+"k":Q;return vt(vt({},pe.properties),{cluster:!0,cluster_id:pe.id,point_count:Q,point_count_abbreviated:ae})}function me(pe){return pe/360+.5}function Rt(pe){const Q=Math.sin(pe*Math.PI/180),ae=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ae<0?0:ae>1?1:ae}function Se(pe){const Q=(180-360*pe)*Math.PI/180;return 360*Math.atan(Math.exp(Q))/Math.PI-90}function vt(pe,Q){for(const ae in Q)pe[ae]=Q[ae];return pe}function jn(pe){return pe.x}function li(pe){return pe.y}function Bi(pe,Q,ae,ye){for(var Ge,Ye=ye,xe=ae-Q>>1,fe=ae-Q,te=pe[Q],ge=pe[Q+1],ut=pe[ae],en=pe[ae+1],Xt=Q+3;Xt<ae;Xt+=3){var Qn=dn(pe[Xt],pe[Xt+1],te,ge,ut,en);if(Qn>Ye)Ge=Xt,Ye=Qn;else if(Qn===Ye){var ei=Math.abs(Xt-xe);ei<fe&&(Ge=Xt,fe=ei)}}Ye>ye&&(Ge-Q>3&&Bi(pe,Q,Ge,ye),pe[Ge+2]=Ye,ae-Ge>3&&Bi(pe,Ge,ae,ye))}function dn(pe,Q,ae,ye,Ge,Ye){var xe=Ge-ae,fe=Ye-ye;if(0!==xe||0!==fe){var te=((pe-ae)*xe+(Q-ye)*fe)/(xe*xe+fe*fe);te>1?(ae=Ge,ye=Ye):te>0&&(ae+=xe*te,ye+=fe*te)}return(xe=pe-ae)*xe+(fe=Q-ye)*fe}function ue(pe,Q,ae,ye){var Ge={id:void 0===pe?null:pe,type:Q,geometry:ae,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ye){var xe=Ye.geometry,fe=Ye.type;if("Point"===fe||"MultiPoint"===fe||"LineString"===fe)ke(Ye,xe);else if("Polygon"===fe||"MultiLineString"===fe)for(var te=0;te<xe.length;te++)ke(Ye,xe[te]);else if("MultiPolygon"===fe)for(te=0;te<xe.length;te++)for(var ge=0;ge<xe[te].length;ge++)ke(Ye,xe[te][ge])}(Ge),Ge}function ke(pe,Q){for(var ae=0;ae<Q.length;ae+=3)pe.minX=Math.min(pe.minX,Q[ae]),pe.minY=Math.min(pe.minY,Q[ae+1]),pe.maxX=Math.max(pe.maxX,Q[ae]),pe.maxY=Math.max(pe.maxY,Q[ae+1])}function xt(pe,Q,ae,ye){if(Q.geometry){var Ge=Q.geometry.coordinates,Ye=Q.geometry.type,xe=Math.pow(ae.tolerance/((1<<ae.maxZoom)*ae.extent),2),fe=[],te=Q.id;if(ae.promoteId?te=Q.properties[ae.promoteId]:ae.generateId&&(te=ye||0),"Point"===Ye)lt(Ge,fe);else if("MultiPoint"===Ye)for(var ge=0;ge<Ge.length;ge++)lt(Ge[ge],fe);else if("LineString"===Ye)Vt(Ge,fe,xe,!1);else if("MultiLineString"===Ye){if(ae.lineMetrics){for(ge=0;ge<Ge.length;ge++)Vt(Ge[ge],fe=[],xe,!1),pe.push(ue(te,"LineString",fe,Q.properties));return}An(Ge,fe,xe,!1)}else if("Polygon"===Ye)An(Ge,fe,xe,!0);else{if("MultiPolygon"!==Ye){if("GeometryCollection"===Ye){for(ge=0;ge<Q.geometry.geometries.length;ge++)xt(pe,{id:te,geometry:Q.geometry.geometries[ge],properties:Q.properties},ae,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<Ge.length;ge++){var ut=[];An(Ge[ge],ut,xe,!0),fe.push(ut)}}pe.push(ue(te,Ye,fe,Q.properties))}}function lt(pe,Q){Q.push(Fn(pe[0])),Q.push(Mn(pe[1])),Q.push(0)}function Vt(pe,Q,ae,ye){for(var Ge,Ye,xe=0,fe=0;fe<pe.length;fe++){var te=Fn(pe[fe][0]),ge=Mn(pe[fe][1]);Q.push(te),Q.push(ge),Q.push(0),fe>0&&(xe+=ye?(Ge*ge-te*Ye)/2:Math.sqrt(Math.pow(te-Ge,2)+Math.pow(ge-Ye,2))),Ge=te,Ye=ge}var ut=Q.length-3;Q[2]=1,Bi(Q,0,ut,ae),Q[ut+2]=1,Q.size=Math.abs(xe),Q.start=0,Q.end=Q.size}function An(pe,Q,ae,ye){for(var Ge=0;Ge<pe.length;Ge++){var Ye=[];Vt(pe[Ge],Ye,ae,ye),Q.push(Ye)}}function Fn(pe){return pe/360+.5}function Mn(pe){var Q=Math.sin(pe*Math.PI/180),ae=.5-.25*Math.log((1+Q)/(1-Q))/Math.PI;return ae<0?0:ae>1?1:ae}function At(pe,Q,ae,ye,Ge,Ye,xe,fe){if(ye/=Q,Ye>=(ae/=Q)&&xe<ye)return pe;if(xe<ae||Ye>=ye)return null;for(var te=[],ge=0;ge<pe.length;ge++){var ut=pe[ge],en=ut.geometry,Xt=ut.type,Qn=0===Ge?ut.minX:ut.minY,ei=0===Ge?ut.maxX:ut.maxY;if(Qn>=ae&&ei<ye)te.push(ut);else if(!(ei<ae||Qn>=ye)){var ci=[];if("Point"===Xt||"MultiPoint"===Xt)Ae(en,ci,ae,ye,Ge);else if("LineString"===Xt)Qt(en,ci,ae,ye,Ge,!1,fe.lineMetrics);else if("MultiLineString"===Xt)ln(en,ci,ae,ye,Ge,!1);else if("Polygon"===Xt)ln(en,ci,ae,ye,Ge,!0);else if("MultiPolygon"===Xt)for(var gi=0;gi<en.length;gi++){var Vi=[];ln(en[gi],Vi,ae,ye,Ge,!0),Vi.length&&ci.push(Vi)}if(ci.length){if(fe.lineMetrics&&"LineString"===Xt){for(gi=0;gi<ci.length;gi++)te.push(ue(ut.id,Xt,ci[gi],ut.tags));continue}"LineString"!==Xt&&"MultiLineString"!==Xt||(1===ci.length?(Xt="LineString",ci=ci[0]):Xt="MultiLineString"),"Point"!==Xt&&"MultiPoint"!==Xt||(Xt=3===ci.length?"Point":"MultiPoint"),te.push(ue(ut.id,Xt,ci,ut.tags))}}}return te.length?te:null}function Ae(pe,Q,ae,ye,Ge){for(var Ye=0;Ye<pe.length;Ye+=3){var xe=pe[Ye+Ge];xe>=ae&&xe<=ye&&(Q.push(pe[Ye]),Q.push(pe[Ye+1]),Q.push(pe[Ye+2]))}}function Qt(pe,Q,ae,ye,Ge,Ye,xe){for(var fe,te,ge=Dn(pe),ut=0===Ge?Li:Qi,en=pe.start,Xt=0;Xt<pe.length-3;Xt+=3){var Qn=pe[Xt],ei=pe[Xt+1],ci=pe[Xt+2],gi=pe[Xt+3],Vi=pe[Xt+4],ji=0===Ge?Qn:ei,hi=0===Ge?gi:Vi,Yi=!1;xe&&(fe=Math.sqrt(Math.pow(Qn-gi,2)+Math.pow(ei-Vi,2))),ji<ae?hi>ae&&(te=ut(ge,Qn,ei,gi,Vi,ae),xe&&(ge.start=en+fe*te)):ji>ye?hi<ye&&(te=ut(ge,Qn,ei,gi,Vi,ye),xe&&(ge.start=en+fe*te)):mi(ge,Qn,ei,ci),hi<ae&&ji>=ae&&(te=ut(ge,Qn,ei,gi,Vi,ae),Yi=!0),hi>ye&&ji<=ye&&(te=ut(ge,Qn,ei,gi,Vi,ye),Yi=!0),!Ye&&Yi&&(xe&&(ge.end=en+fe*te),Q.push(ge),ge=Dn(pe)),xe&&(en+=fe)}var ir=pe.length-3;Qn=pe[ir],ei=pe[ir+1],ci=pe[ir+2],(ji=0===Ge?Qn:ei)>=ae&&ji<=ye&&mi(ge,Qn,ei,ci),ir=ge.length-3,Ye&&ir>=3&&(ge[ir]!==ge[0]||ge[ir+1]!==ge[1])&&mi(ge,ge[0],ge[1],ge[2]),ge.length&&Q.push(ge)}function Dn(pe){var Q=[];return Q.size=pe.size,Q.start=pe.start,Q.end=pe.end,Q}function ln(pe,Q,ae,ye,Ge,Ye){for(var xe=0;xe<pe.length;xe++)Qt(pe[xe],Q,ae,ye,Ge,Ye,!1)}function mi(pe,Q,ae,ye){pe.push(Q),pe.push(ae),pe.push(ye)}function Li(pe,Q,ae,ye,Ge,Ye){var xe=(Ye-Q)/(ye-Q);return pe.push(Ye),pe.push(ae+(Ge-ae)*xe),pe.push(1),xe}function Qi(pe,Q,ae,ye,Ge,Ye){var xe=(Ye-ae)/(Ge-ae);return pe.push(Q+(ye-Q)*xe),pe.push(Ye),pe.push(1),xe}function Ii(pe,Q){for(var ae=[],ye=0;ye<pe.length;ye++){var Ge,Ye=pe[ye],xe=Ye.type;if("Point"===xe||"MultiPoint"===xe||"LineString"===xe)Ge=Ir(Ye.geometry,Q);else if("MultiLineString"===xe||"Polygon"===xe){Ge=[];for(var fe=0;fe<Ye.geometry.length;fe++)Ge.push(Ir(Ye.geometry[fe],Q))}else if("MultiPolygon"===xe)for(Ge=[],fe=0;fe<Ye.geometry.length;fe++){for(var te=[],ge=0;ge<Ye.geometry[fe].length;ge++)te.push(Ir(Ye.geometry[fe][ge],Q));Ge.push(te)}ae.push(ue(Ye.id,xe,Ge,Ye.tags))}return ae}function Ir(pe,Q){var ae=[];ae.size=pe.size,void 0!==pe.start&&(ae.start=pe.start,ae.end=pe.end);for(var ye=0;ye<pe.length;ye+=3)ae.push(pe[ye]+Q,pe[ye+1],pe[ye+2]);return ae}function Kt(pe,Q){if(pe.transformed)return pe;var ae,ye,Ge,Ye=1<<pe.z,xe=pe.x,fe=pe.y;for(ae=0;ae<pe.features.length;ae++){var te=pe.features[ae],ge=te.geometry,ut=te.type;if(te.geometry=[],1===ut)for(ye=0;ye<ge.length;ye+=2)te.geometry.push(Ft(ge[ye],ge[ye+1],Q,Ye,xe,fe));else for(ye=0;ye<ge.length;ye++){var en=[];for(Ge=0;Ge<ge[ye].length;Ge+=2)en.push(Ft(ge[ye][Ge],ge[ye][Ge+1],Q,Ye,xe,fe));te.geometry.push(en)}}return pe.transformed=!0,pe}function Ft(pe,Q,ae,ye,Ge,Ye){return[Math.round(ae*(pe*ye-Ge)),Math.round(ae*(Q*ye-Ye))]}function _t(pe,Q,ae,ye,Ge){for(var Ye=Q===Ge.maxZoom?0:Ge.tolerance/((1<<Q)*Ge.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ae,y:ye,z:Q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<pe.length;fe++){xe.numFeatures++,bn(xe,pe[fe],Ye,Ge);var te=pe[fe].minX,ge=pe[fe].minY,ut=pe[fe].maxX,en=pe[fe].maxY;te<xe.minX&&(xe.minX=te),ge<xe.minY&&(xe.minY=ge),ut>xe.maxX&&(xe.maxX=ut),en>xe.maxY&&(xe.maxY=en)}return xe}function bn(pe,Q,ae,ye){var Ge=Q.geometry,Ye=Q.type,xe=[];if("Point"===Ye||"MultiPoint"===Ye)for(var fe=0;fe<Ge.length;fe+=3)xe.push(Ge[fe]),xe.push(Ge[fe+1]),pe.numPoints++,pe.numSimplified++;else if("LineString"===Ye)Ut(xe,Ge,pe,ae,!1,!1);else if("MultiLineString"===Ye||"Polygon"===Ye)for(fe=0;fe<Ge.length;fe++)Ut(xe,Ge[fe],pe,ae,"Polygon"===Ye,0===fe);else if("MultiPolygon"===Ye)for(var te=0;te<Ge.length;te++){var ge=Ge[te];for(fe=0;fe<ge.length;fe++)Ut(xe,ge[fe],pe,ae,!0,0===fe)}if(xe.length){var ut=Q.tags||null;if("LineString"===Ye&&ye.lineMetrics){for(var en in ut={},Q.tags)ut[en]=Q.tags[en];ut.mapbox_clip_start=Ge.start/Ge.size,ut.mapbox_clip_end=Ge.end/Ge.size}var Xt={geometry:xe,type:"Polygon"===Ye||"MultiPolygon"===Ye?3:"LineString"===Ye||"MultiLineString"===Ye?2:1,tags:ut};null!==Q.id&&(Xt.id=Q.id),pe.features.push(Xt)}}function Ut(pe,Q,ae,ye,Ge,Ye){var xe=ye*ye;if(ye>0&&Q.size<(Ge?xe:ye))ae.numPoints+=Q.length/3;else{for(var fe=[],te=0;te<Q.length;te+=3)(0===ye||Q[te+2]>xe)&&(ae.numSimplified++,fe.push(Q[te]),fe.push(Q[te+1])),ae.numPoints++;Ge&&function(ge,ut){for(var en=0,Xt=0,Qn=ge.length,ei=Qn-2;Xt<Qn;ei=Xt,Xt+=2)en+=(ge[Xt]-ge[ei])*(ge[Xt+1]+ge[ei+1]);if(en>0===ut)for(Xt=0,Qn=ge.length;Xt<Qn/2;Xt+=2){var ci=ge[Xt],gi=ge[Xt+1];ge[Xt]=ge[Qn-2-Xt],ge[Xt+1]=ge[Qn-1-Xt],ge[Qn-2-Xt]=ci,ge[Qn-1-Xt]=gi}}(fe,Ye),pe.push(fe)}}function De(pe,Q){var ae=(Q=this.options=function(Ge,Ye){for(var xe in Ye)Ge[xe]=Ye[xe];return Ge}(Object.create(this.options),Q)).debug;if(ae&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ge,Ye,xe,fe,te,ge,ye=function(Ge,Ye){var xe=[];if("FeatureCollection"===Ge.type)for(var fe=0;fe<Ge.features.length;fe++)xt(xe,Ge.features[fe],Ye,fe);else xt(xe,"Feature"===Ge.type?Ge:{geometry:Ge},Ye);return xe}(pe,Q);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=Ge=ye,te=At(Ge,1,-1-(xe=(Ye=Q).buffer/Ye.extent),xe,0,-1,2,Ye),ge=At(Ge,1,1-xe,2+xe,0,-1,2,Ye),(te||ge)&&(fe=At(Ge,1,-xe,1+xe,0,-1,2,Ye)||[],te&&(fe=Ii(te,1).concat(fe)),ge&&(fe=fe.concat(Ii(ge,-1)))),(ye=fe).length&&this.splitTile(ye,0,0,0),ae&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function oe(pe,Q,ae){return 32*((1<<pe)*ae+Q)+pe}function be(pe,Q){const ae=pe.tileID.canonical;if(!this._geoJSONIndex)return Q(null,null);const ye=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!ye)return Q(null,null);const Ge=new tt(ye.features);let Ye=Re.exports(Ge);0===Ye.byteOffset&&Ye.byteLength===Ye.buffer.byteLength||(Ye=new Uint8Array(Ye)),Q(null,{vectorTile:Ge,rawData:Ye.buffer})}De.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},De.prototype.splitTile=function(pe,Q,ae,ye,Ge,Ye,xe){for(var fe=[pe,Q,ae,ye],te=this.options,ge=te.debug;fe.length;){ye=fe.pop(),ae=fe.pop(),Q=fe.pop(),pe=fe.pop();var ut=1<<Q,en=oe(Q,ae,ye),Xt=this.tiles[en];if(!Xt&&(ge>1&&console.time("creation"),Xt=this.tiles[en]=_t(pe,Q,ae,ye,te),this.tileCoords.push({z:Q,x:ae,y:ye}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ae,ye,Xt.numFeatures,Xt.numPoints,Xt.numSimplified),console.timeEnd("creation"));var Qn="z"+Q;this.stats[Qn]=(this.stats[Qn]||0)+1,this.total++}if(Xt.source=pe,Ge){if(Q===te.maxZoom||Q===Ge)continue;var ei=1<<Ge-Q;if(ae!==Math.floor(Ye/ei)||ye!==Math.floor(xe/ei))continue}else if(Q===te.indexMaxZoom||Xt.numPoints<=te.indexMaxPoints)continue;if(Xt.source=null,0!==pe.length){ge>1&&console.time("clipping");var ci,gi,Vi,ji,hi,Yi,ir=.5*te.buffer/te.extent,Ki=.5-ir,kr=.5+ir,Cr=1+ir;ci=gi=Vi=ji=null,hi=At(pe,ut,ae-ir,ae+kr,0,Xt.minX,Xt.maxX,te),Yi=At(pe,ut,ae+Ki,ae+Cr,0,Xt.minX,Xt.maxX,te),pe=null,hi&&(ci=At(hi,ut,ye-ir,ye+kr,1,Xt.minY,Xt.maxY,te),gi=At(hi,ut,ye+Ki,ye+Cr,1,Xt.minY,Xt.maxY,te),hi=null),Yi&&(Vi=At(Yi,ut,ye-ir,ye+kr,1,Xt.minY,Xt.maxY,te),ji=At(Yi,ut,ye+Ki,ye+Cr,1,Xt.minY,Xt.maxY,te),Yi=null),ge>1&&console.timeEnd("clipping"),fe.push(ci||[],Q+1,2*ae,2*ye),fe.push(gi||[],Q+1,2*ae,2*ye+1),fe.push(Vi||[],Q+1,2*ae+1,2*ye),fe.push(ji||[],Q+1,2*ae+1,2*ye+1)}}},De.prototype.getTile=function(pe,Q,ae){var ye=this.options,Ge=ye.extent,Ye=ye.debug;if(pe<0||pe>24)return null;var xe=1<<pe,fe=oe(pe,Q=(Q%xe+xe)%xe,ae);if(this.tiles[fe])return Kt(this.tiles[fe],Ge);Ye>1&&console.log("drilling down to z%d-%d-%d",pe,Q,ae);for(var te,ge=pe,ut=Q,en=ae;!te&&ge>0;)ge--,ut=Math.floor(ut/2),en=Math.floor(en/2),te=this.tiles[oe(ge,ut,en)];return te&&te.source?(Ye>1&&console.log("found parent tile z%d-%d-%d",ge,ut,en),Ye>1&&console.time("drilling down"),this.splitTile(te.source,ge,ut,en,pe,Q,ae),Ye>1&&console.timeEnd("drilling down"),this.tiles[fe]?Kt(this.tiles[fe],Ge):null):null};class wt extends a.VectorTileWorkerSource{constructor(Q,ae,ye,Ge,Ye){super(Q,ae,ye,Ge,be),Ye&&(this.loadGeoJSON=Ye)}loadData(Q,ae){const ye=Q&&Q.request,Ge=ye&&ye.collectResourceTiming;this.loadGeoJSON(Q,(Ye,xe)=>{if(Ye||!xe)return ae(Ye);if("object"!=typeof xe)return ae(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));{Fe(xe,!0);try{if(Q.filter){const te=a.createExpression(Q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===te.result)throw new Error(te.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));xe={type:"FeatureCollection",features:xe.features.filter(ut=>te.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=Q.cluster?new zt(function({superclusterOptions:te,clusterProperties:ge}){if(!ge||!te)return te;const ut={},en={},Xt={accumulated:null,zoom:0},Qn={properties:null},ei=Object.keys(ge);for(const ci of ei){const[gi,Vi]=ge[ci],ji=a.createExpression(Vi),hi=a.createExpression("string"==typeof gi?[gi,["accumulated"],["get",ci]]:gi);ut[ci]=ji.value,en[ci]=hi.value}return te.map=ci=>{Qn.properties=ci;const gi={};for(const Vi of ei)gi[Vi]=ut[Vi].evaluate(Xt,Qn);return gi},te.reduce=(ci,gi)=>{Qn.properties=gi;for(const Vi of ei)Xt.accumulated=ci[Vi],ci[Vi]=en[Vi].evaluate(Xt,Qn)},te}(Q)).load(xe.features):new De(te=xe,Q.geojsonVtOptions)}catch(te){return ae(te)}this.loaded={};const fe={};if(Ge){const te=a.getPerformanceMeasurement(ye);te&&(fe.resourceTiming={},fe.resourceTiming[Q.source]=JSON.parse(JSON.stringify(te)))}ae(null,fe)}var te})}reloadTile(Q,ae){const ye=this.loaded;return ye&&ye[Q.uid]?super.reloadTile(Q,ae):this.loadTile(Q,ae)}loadGeoJSON(Q,ae){if(Q.request)a.getJSON(Q.request,ae);else{if("string"!=typeof Q.data)return ae(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`));try{return ae(null,JSON.parse(Q.data))}catch{return ae(new Error(`Input data given to '${Q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Q,ae){try{ae(null,this._geoJSONIndex.getClusterExpansionZoom(Q.clusterId))}catch(ye){ae(ye)}}getClusterChildren(Q,ae){try{ae(null,this._geoJSONIndex.getChildren(Q.clusterId))}catch(ye){ae(ye)}}getClusterLeaves(Q,ae){try{ae(null,this._geoJSONIndex.getLeaves(Q.clusterId,Q.limit,Q.offset))}catch(ye){ae(ye)}}}class $t{constructor(Q){this.self=Q,this.actor=new a.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:wt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ae,ye)=>{if(this.workerSourceTypes[ae])throw new Error(`Worker source with name "${ae}" already registered.`);this.workerSourceTypes[ae]=ye},this.self.registerRTLTextPlugin=ae=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=ae.applyArabicShaping,a.plugin.processBidirectionalText=ae.processBidirectionalText,a.plugin.processStyledBidirectionalText=ae.processStyledBidirectionalText}}clearCaches(Q,ae,ye){delete this.layerIndexes[Q],delete this.availableImages[Q],delete this.workerSources[Q],delete this.demWorkerSources[Q],ye()}checkIfReady(Q,ae,ye){ye()}setReferrer(Q,ae){this.referrer=ae}spriteLoaded(Q,ae){this.isSpriteLoaded[Q]=ae;for(const ye in this.workerSources[Q]){const Ge=this.workerSources[Q][ye];for(const Ye in Ge)Ge[Ye]instanceof a.VectorTileWorkerSource&&(Ge[Ye].isSpriteLoaded=ae,Ge[Ye].fire(new a.Event("isSpriteLoaded")))}}setImages(Q,ae,ye){this.availableImages[Q]=ae;for(const Ge in this.workerSources[Q]){const Ye=this.workerSources[Q][Ge];for(const xe in Ye)Ye[xe].availableImages=ae}ye()}enableTerrain(Q,ae,ye){this.terrain=ae,ye()}setProjection(Q,ae){this.projections[Q]=a.getProjection(ae)}setLayers(Q,ae,ye){this.getLayerIndex(Q).replace(ae),ye()}updateLayers(Q,ae,ye){this.getLayerIndex(Q).update(ae.layers,ae.removedIds),ye()}loadTile(Q,ae,ye){const Ge=this.enableTerrain?a.extend({enableTerrain:this.terrain},ae):ae;Ge.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ae.type,ae.source).loadTile(Ge,ye)}loadDEMTile(Q,ae,ye){const Ge=this.enableTerrain?a.extend({buildQuadTree:this.terrain},ae):ae;this.getDEMWorkerSource(Q,ae.source).loadTile(Ge,ye)}reloadTile(Q,ae,ye){const Ge=this.enableTerrain?a.extend({enableTerrain:this.terrain},ae):ae;Ge.projection=this.projections[Q]||this.defaultProjection,this.getWorkerSource(Q,ae.type,ae.source).reloadTile(Ge,ye)}abortTile(Q,ae,ye){this.getWorkerSource(Q,ae.type,ae.source).abortTile(ae,ye)}removeTile(Q,ae,ye){this.getWorkerSource(Q,ae.type,ae.source).removeTile(ae,ye)}removeSource(Q,ae,ye){if(!this.workerSources[Q]||!this.workerSources[Q][ae.type]||!this.workerSources[Q][ae.type][ae.source])return;const Ge=this.workerSources[Q][ae.type][ae.source];delete this.workerSources[Q][ae.type][ae.source],void 0!==Ge.removeSource?Ge.removeSource(ae,ye):ye()}loadWorkerSource(Q,ae,ye){try{this.self.importScripts(ae.url),ye()}catch(Ge){ye(Ge.toString())}}syncRTLPluginState(Q,ae,ye){try{a.plugin.setState(ae);const Ge=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&null!=Ge){this.self.importScripts(Ge);const Ye=a.plugin.isParsed();ye(Ye?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ge}`),Ye)}}catch(Ge){ye(Ge.toString())}}getAvailableImages(Q){let ae=this.availableImages[Q];return ae||(ae=[]),ae}getLayerIndex(Q){let ae=this.layerIndexes[Q];return ae||(ae=this.layerIndexes[Q]=new it),ae}getWorkerSource(Q,ae,ye){return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][ae]||(this.workerSources[Q][ae]={}),this.workerSources[Q][ae][ye]||(this.workerSources[Q][ae][ye]=new this.workerSourceTypes[ae]({send:(Ye,xe,fe,te,ge,ut)=>{this.actor.send(Ye,xe,fe,Q,ge,ut)},scheduler:this.actor.scheduler},this.getLayerIndex(Q),this.getAvailableImages(Q),this.isSpriteLoaded[Q])),this.workerSources[Q][ae][ye]}getDEMWorkerSource(Q,ae){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][ae]||(this.demWorkerSources[Q][ae]=new Ce),this.demWorkerSources[Q][ae]}enforceCacheSizeLimit(Q,ae){a.enforceCacheSizeLimit(ae)}getWorkerPerformanceMetrics(Q,ae,ye){ye(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new $t(self)),$t}),y(0,function(a){function de(u,t){if(Array.isArray(u)){if(!Array.isArray(t)||u.length!==t.length)return!1;for(let l=0;l<u.length;l++)if(!de(u[l],t[l]))return!1;return!0}if("object"==typeof u&&null!==u&&null!==t){if("object"!=typeof t||Object.keys(u).length!==Object.keys(t).length)return!1;for(const l in u)if(!de(u[l],t[l]))return!1;return!0}return u===t}var Qe=it;function it(u){return t=u,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,_,b=new Blob([""],{type:"text/javascript"}),M=URL.createObjectURL(b);try{_=new Worker(M),p=!0}catch{p=!1}return _&&_.terminate(),URL.revokeObjectURL(M),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var _=p.getContext("2d");if(!_)return!1;var b=_.getImageData(0,0,1,1);return b&&b.width===p.width}()||(void 0===Ce[l=t&&t.failIfMajorPerformanceCaveat]&&(Ce[l]=function(p){var _,M,O,F,b=(M=p,O=document.createElement("canvas"),(F=Object.create(it.webGLContextAttributes)).failIfMajorPerformanceCaveat=M,O.getContext("webgl",F)||O.getContext("experimental-webgl",F));if(!b)return!1;try{_=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!_||b.isContextLost())&&(b.shaderSource(_,"void main() {}"),b.compileShader(_),!0===b.getShaderParameter(_,b.COMPILE_STATUS))}(l)),!Ce[l]||document.documentMode));var t,l}var Ce={};function Fe(u,t,l){const p=a.window.document.createElement(u);return void 0!==t&&(p.className=t),l&&l.appendChild(p),p}function $e(u,t,l){const p=a.window.document.createElementNS("http://www.w3.org/2000/svg",u);for(const _ of Object.keys(t))p.setAttributeNS(null,_,t[_]);return l&&l.appendChild(p),p}it.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const at=a.window.document&&a.window.document.documentElement.style,qe=at&&void 0!==at.userSelect?"userSelect":"WebkitUserSelect";let Ve;function tt(){at&&qe&&(Ve=at[qe],at[qe]="none")}function Re(){at&&qe&&(at[qe]=Ve)}function ft(u){u.preventDefault(),u.stopPropagation(),a.window.removeEventListener("click",ft,!0)}function et(){a.window.addEventListener("click",ft,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",ft,!0)},0)}function ht(u,t){const l=u.getBoundingClientRect();return ot(u,l,t)}function Gt(u,t){const l=u.getBoundingClientRect(),p=[];for(let _=0;_<t.length;_++)p.push(ot(u,l,t[_]));return p}function an(u){return void 0!==a.window.InstallTrigger&&2===u.button&&u.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button}function ot(u,t,l){const p=u.offsetWidth===t.width?1:u.offsetWidth/t.width;return new a.pointGeometry((l.clientX-t.left)*p,(l.clientY-t.top)*p)}function Te(u,t){var l=t[0],p=t[1],_=t[2],b=t[3],M=l*b-_*p;return M?(u[0]=b*(M=1/M),u[1]=-p*M,u[2]=-_*M,u[3]=l*M,u):null}function Ne(u){const{userImage:t}=u;return!!(t&&t.render&&t.render())&&(u.data.replace(new Uint8Array(t.data.buffer)),!0)}class mt extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:l,callback:p}of this.requestors)this._notify(l,p);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,l){this._validate(t,l)&&(this.images[t]=l)}_validate(t,l){let p=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(l.content,l)||(this.fire(new a.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,l){if(!t)return!0;let p=0;for(const _ of t){if(_[0]<p||_[1]<_[0]||l<_[1])return!1;p=_[1]}return!0}_validateContent(t,l){return!(t&&(4!==t.length||t[0]<0||l.data.width<t[0]||t[1]<0||l.data.height<t[1]||t[2]<0||l.data.width<t[2]||t[3]<0||l.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,l){l.version=this.images[t].version+1,this.images[t]=l,this.updatedImages[t]=!0}removeImage(t){const l=this.images[t];delete this.images[t],delete this.patterns[t],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,l){let p=!0;if(!this.isLoaded())for(const _ of t)this.images[_]||(p=!1);this.isLoaded()||p?this._notify(t,l):this.requestors.push({ids:t,callback:l})}_notify(t,l){const p={};for(const _ of t){this.images[_]||this.fire(new a.Event("styleimagemissing",{id:_}));const b=this.images[_];b?p[_]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:a.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,p)}getPixelSize(){const{width:t,height:l}=this.atlasImage;return{width:t,height:l}}getPattern(t){const l=this.patterns[t],p=this.getImage(t);if(!p)return null;if(l&&l.position.version===p.version)return l.position;if(l)l.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new a.ImagePosition(_,p);this.patterns[t]={bin:_,position:b}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const l=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(t,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const b in this.patterns)t.push(this.patterns[b].bin);const{w:l,h:p}=a.potpack(t),_=this.atlasImage;_.resize({width:l||1,height:p||1});for(const b in this.patterns){const{bin:M}=this.patterns[b],O=M.x+1,F=M.y+1,q=this.images[b].data,W=q.width,re=q.height;a.RGBAImage.copy(q,_,{x:0,y:0},{x:O,y:F},{width:W,height:re}),a.RGBAImage.copy(q,_,{x:0,y:re-1},{x:O,y:F-1},{width:W,height:1}),a.RGBAImage.copy(q,_,{x:0,y:0},{x:O,y:F+re},{width:W,height:1}),a.RGBAImage.copy(q,_,{x:W-1,y:0},{x:O-1,y:F},{width:1,height:re}),a.RGBAImage.copy(q,_,{x:0,y:0},{x:O+W,y:F},{width:1,height:re})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const l of t){if(this.callbackDispatchedThisFrame[l])continue;this.callbackDispatchedThisFrame[l]=!0;const p=this.images[l];Ne(p)&&this.updateImage(l,p)}}}const It=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(u,t){return function([l,p,_]){const b=a.degToRad(p+90),M=a.degToRad(_);return{x:l*Math.cos(b)*Math.sin(M),y:l*Math.sin(b)*Math.sin(M),z:l*Math.cos(M),azimuthal:p,polar:_}}(u.expression.evaluate(t))}interpolate(u,t,l){return{x:a.number(u.x,t.x,l),y:a.number(u.y,t.y,l),z:a.number(u.z,t.z,l),azimuthal:a.number(u.azimuthal,t.azimuthal,l),polar:a.number(u.polar,t.polar,l)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),sn="-transition";class Cn extends a.Evented{constructor(t){super(),this._transitionable=new a.Transitionable(It),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,l={}){if(!this._validate(a.validateLight,t,l))for(const p in t){const _=t[p];a.endsWith(p,sn)?this._transitionable.setTransition(p.slice(0,-sn.length),_):this._transitionable.setValue(p,_)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,l,p){return(!p||!1!==p.validate)&&a.emitValidationErrors(this,t.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Yt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),nt="-transition";class Et extends a.Evented{constructor(t,l){super(),this._transitionable=new a.Transitionable(Yt),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(t){for(const l in t){const p=t[l];a.endsWith(l,nt)?this._transitionable.setTransition(l.slice(0,-nt.length),p):this._transitionable.setValue(l,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function ct(u,t,l,p){const _=a.smoothstep(45,65,l),[b,M]=Pn(u,p),O=a.length(t);let F=1-Math.min(1,Math.exp((O-b)/(M-b)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*_*u.alpha}function Pn(u,t){const l=.5/Math.tan(.5*t);return[u.range[0]+l,u.range[1]+l]}const Nn=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),fi="-transition";class Ci extends a.Evented{constructor(t,l){super(),this._transitionable=new a.Transitionable(Nn),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=l}get state(){const t=this._transform,l="globe"===t.projection.name,p=a.globeToMercatorTransition(t.zoom),_=this.properties.get("range"),b=[.5,3];return{range:l?[a.number(b[0],_[0],p),a.number(b[1],_[1],p)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,l={}){if(!this._validate(a.validateFog,t,l)){for(const p of Object.keys(a.spec.fog))t&&void 0===t[p]&&(t[p]=a.spec.fog[p].default);for(const p in t){const _=t[p];a.endsWith(p,fi)?this._transitionable.setTransition(p.slice(0,-fi.length),_):this._transitionable.setValue(p,_)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:a.smoothstep(45,65,t))*l.a}getOpacityAtLatLng(t,l){return this._transform.projection.supportsFog?function(p,_,b){const M=a.MercatorCoordinate.fromLngLat(_),O=b.elevation?b.elevation.getAtPointOrZero(M):0,F=[M.x,M.y,O];return a.transformMat4(F,F,b.mercatorFogMatrix),ct(p,F,b.pitch,b._fov)}(this.state,t,l):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?Pn(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,l,p){return(!p||!1!==p.validate)&&a.emitValidationErrors(this,t.call(a.validateStyle,a.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Bt{constructor(t,l){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const p=this.workerPool.acquire(this.id);for(let _=0;_<p.length;_++){const b=new Bt.Actor(p[_],l,this.id);b.name=`Worker ${_}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,l,p){a.asyncAll(this.actors,(_,b)=>{_.send(t,l,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Zt(u,t,l){return t*(a.EXTENT/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}Bt.Actor=a.Actor;class nn{constructor(t,l,p,_){this.screenBounds=t,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(t,l){let p,_;if(t instanceof a.pointGeometry||"number"==typeof t[0]){const b=a.pointGeometry.convert(t);p=[b],_=l.isPointAboveHorizon(b)}else{const b=a.pointGeometry.convert(t[0]),M=a.pointGeometry.convert(t[1]);p=[b,M],_=a.polygonizeBounds(b,M).every(O=>l.isPointAboveHorizon(O))}return new nn(p,l.getCameraPoint(),_,l)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return a.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const l=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],_=a.polygonizeBounds(l,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<p.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?_[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(_[3]=this.cameraPoint)),a.bufferConvexPolygon(_,t)}bufferedCameraGeometryGlobe(t){const l=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],_=a.polygonizeBounds(l,p,t),b=this.cameraPoint.clone();switch(3*((b.y>l.y)+(b.y>p.y))+((b.x>l.x)+(b.x>p.x))){case 0:_[0]=b,_[4]=b.clone();break;case 1:_.splice(1,0,b);break;case 2:_[1]=b;break;case 3:_.splice(4,0,b);break;case 5:_.splice(2,0,b);break;case 6:_[3]=b;break;case 7:_.splice(3,0,b);break;case 8:_[2]=b}return _}containsTile(t,l,p,_=0){const b=t.queryPadding/l._pixelsPerMercatorPixel+1,M=p?this._bufferedCameraMercator(b,l):this._bufferedScreenMercator(b,l);let O=t.tileID.wrap+(M.unwrapped?_:0);const F=M.polygon.map(Ie=>a.getTilePoint(t.tileTransform,Ie,O));if(!a.polygonIntersectsBox(F,0,0,a.EXTENT,a.EXTENT))return;O=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const q=this.screenGeometryMercator.polygon.map(Ie=>a.getTileVec3(t.tileTransform,Ie,O)),W=q.map(Ie=>new a.pointGeometry(Ie[0],Ie[1])),re=l.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),we=a.getTileVec3(t.tileTransform,re,O),Ue=q.map(Ie=>{const Le=a.sub(Ie,Ie,we);return a.normalize(Le,Le),new a.Ray(we,Le)}),Be=Zt(t,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:Ue,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(je=a.getBounds(F),je.min.x=a.clamp(je.min.x,0,a.EXTENT),je.min.y=a.clamp(je.min.y,0,a.EXTENT),je.max.x=a.clamp(je.max.x,0,a.EXTENT),je.max.y=a.clamp(je.max.y,0,a.EXTENT),je),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:Be};var je}_bufferedScreenMercator(t,l){const p=ze(t);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let _;return _="globe"===l.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),l):{polygon:this.bufferedScreenGeometry(t).map(b=>l.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[p]=_,_}}_bufferedCameraMercator(t,l){const p=ze(t);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let _;return _="globe"===l.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),l):{polygon:this.bufferedCameraGeometry(t).map(b=>l.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[p]=_,_}}_projectAndResample(t,l){const p=function(b,M){const O=a.multiply([],M.pixelMatrix,M.globeMatrix),F=[0,-a.GLOBE_RADIUS,0,1],q=[0,a.GLOBE_RADIUS,0,1],W=[0,0,0,1];a.transformMat4$1(F,F,O),a.transformMat4$1(q,q,O),a.transformMat4$1(W,W,O);const re=new a.pointGeometry(F[0]/F[3],F[1]/F[3]),we=new a.pointGeometry(q[0]/q[3],q[1]/q[3]),Ue=a.polygonContainsPoint(b,re)&&F[3]<W[3],Be=a.polygonContainsPoint(b,we)&&q[3]<W[3];if(!Ue&&!Be)return null;const je=function(jt,un,rn){for(let Wt=1;Wt<jt.length;Wt++){const Xn=Jt(un.pointCoordinate3D(jt[Wt-1]).x),tn=Jt(un.pointCoordinate3D(jt[Wt]).x);if(rn<0){if(Xn<tn)return{idx:Wt,t:-Xn/(tn-1-Xn)}}else if(tn<Xn)return{idx:Wt,t:(1-Xn)/(tn+1-Xn)}}return null}(b,M,Ue?-1:1);if(!je)return null;const{idx:Ie,t:Le}=je;let Ze=Ie>1?Ct(b.slice(0,Ie),M):[],He=Ie<b.length?Ct(b.slice(Ie),M):[];Ze=Ze.map(jt=>new a.pointGeometry(Jt(jt.x),jt.y)),He=He.map(jt=>new a.pointGeometry(Jt(jt.x),jt.y));const st=[...Ze];0===st.length&&st.push(He[He.length-1]);const St=a.number(st[st.length-1].y,(0===He.length?Ze[0]:He[0]).y,Le);let Mt;return Mt=Ue?[new a.pointGeometry(0,St),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,St)]:[new a.pointGeometry(1,St),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,St)],st.push(...Mt),0===He.length?st.push(Ze[0]):st.push(...He),{polygon:st.map(jt=>new a.MercatorCoordinate(jt.x,jt.y)),unwrapped:!1}}(t,l);if(p)return p;const _=function(b,M){let O=!1,F=-1/0,q=0;for(let re=0;re<b.length-1;re++)b[re].x>F&&(F=b[re].x,q=re);for(let re=0;re<b.length-1;re++){const we=(q+re)%(b.length-1),Ue=b[we],Be=b[we+1];Math.abs(Ue.x-Be.x)>.5&&(Ue.x<Be.x?(Ue.x+=1,0===we&&(b[b.length-1].x+=1)):(Be.x+=1,we+1===b.length-1&&(b[0].x+=1)),O=!0)}const W=a.mercatorXfromLng(M.center.lng);return O&&W<Math.abs(W-1)&&b.forEach(re=>{re.x-=1}),{polygon:b,unwrapped:O}}(Ct(t,l).map(b=>new a.pointGeometry(Jt(b.x),b.y)),l);return{polygon:_.polygon.map(b=>new a.MercatorCoordinate(b.x,b.y)),unwrapped:_.unwrapped}}}function Ct(u,t){return a.resample(u,l=>{const p=t.pointCoordinate3D(l);l.x=p.x,l.y=p.y},1/256)}function Jt(u){return u<0?1+u%1:u%1}function ze(u){return 100*u|0}function zt(u,t,l,p,_){const b=function(M,O){if(M)return _(M);if(O){u.url&&O.tiles&&u.tiles&&delete u.tiles;const F=a.pick(a.extend(O,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(F.vectorLayers=O.vector_layers,F.vectorLayerIds=F.vectorLayers.map(q=>q.id)),F.tiles=t.canonicalizeTileset(F,u.url),_(null,F)}};return u.url?a.getJSON(t.transformRequest(t.normalizeSourceURL(u.url,null,l,p),a.ResourceType.Source),b):a.exported.frame(()=>b(null,u))}class ve{constructor(t,l,p){this.bounds=a.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=l||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const l=Math.pow(2,t.z),p=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*l),_=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*l),b=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*l),M=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*l);return t.x>=p&&t.x<b&&t.y>=_&&t.y<M}}class Lt{constructor(t,l,p){this.context=t;const _=t.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Tt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fn{constructor(t,l,p,_){this.length=l.length,this.attributes=p,this.itemSize=l.bytesPerElement,this.dynamicDraw=_,this.context=t;const b=t.gl;this.buffer=b.createBuffer(),t.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,l){for(let p=0;p<this.attributes.length;p++){const _=l.attributes[this.attributes[p].name];void 0!==_&&t.enableVertexAttribArray(_)}}setVertexAttribPointers(t,l,p){for(let _=0;_<this.attributes.length;_++){const b=this.attributes[_],M=l.attributes[b.name];void 0!==M&&t.vertexAttribPointer(M,b.components,t[Tt[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class me{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Rt extends me{getDefault(){return a.Color.transparent}set(t){const l=this.current;(t.r!==l.r||t.g!==l.g||t.b!==l.b||t.a!==l.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Se extends me{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class vt extends me{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class jn extends me{getDefault(){return[!0,!0,!0,!0]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||t[3]!==l[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class li extends me{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Bi extends me{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class dn extends me{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const l=this.current;(t.func!==l.func||t.ref!==l.ref||t.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ue extends me{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class ke extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=t,this.dirty=!1}}class xt extends me{getDefault(){return[0,1]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class lt extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=t,this.dirty=!1}}class Vt extends me{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class An extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.BLEND):l.disable(l.BLEND),this.current=t,this.dirty=!1}}class Fn extends me{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Mn extends me{getDefault(){return a.Color.transparent}set(t){const l=this.current;(t.r!==l.r||t.g!==l.g||t.b!==l.b||t.a!==l.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class At extends me{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Ae extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;t?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=t,this.dirty=!1}}class Qt extends me{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Dn extends me{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class ln extends me{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class mi extends me{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Li extends me{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const l=this.current;(t[0]!==l[0]||t[1]!==l[1]||t[2]!==l[2]||t[3]!==l[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Qi extends me{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Ii extends me{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ir extends me{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Kt extends me{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ft extends me{getDefault(){return null}set(t){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class _t extends me{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class bn extends me{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ut extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class De extends me{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class oe extends me{constructor(t,l){super(t),this.context=t,this.parent=l}getDefault(){return null}}class be extends oe{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class wt extends oe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class $t extends wt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class pe{constructor(t,l,p,_){this.context=t,this.width=l,this.height=p;const b=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new be(t,b),_&&(this.depthAttachment=new wt(t,b))}destroy(){const t=this.context.gl,l=this.colorAttachment.get();if(l&&t.deleteTexture(l),this.depthAttachment){const p=this.depthAttachment.get();p&&t.deleteRenderbuffer(p)}t.deleteFramebuffer(this.framebuffer)}}class Q{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Rt(this),this.clearDepth=new Se(this),this.clearStencil=new vt(this),this.colorMask=new jn(this),this.depthMask=new li(this),this.stencilMask=new Bi(this),this.stencilFunc=new dn(this),this.stencilOp=new ue(this),this.stencilTest=new ke(this),this.depthRange=new xt(this),this.depthTest=new lt(this),this.depthFunc=new Vt(this),this.blend=new An(this),this.blendFunc=new Fn(this),this.blendColor=new Mn(this),this.blendEquation=new At(this),this.cullFace=new Ae(this),this.cullFaceSide=new Qt(this),this.frontFace=new Dn(this),this.program=new ln(this),this.activeTexture=new mi(this),this.viewport=new Li(this),this.bindFramebuffer=new Qi(this),this.bindRenderbuffer=new Ii(this),this.bindTexture=new Ir(this),this.bindVertexBuffer=new Kt(this),this.bindElementBuffer=new Ft(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new _t(this),this.pixelStoreUnpack=new bn(this),this.pixelStoreUnpackPremultiplyAlpha=new Ut(this),this.pixelStoreUnpackFlipY=new De(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,l){return new Lt(this,t,l)}createVertexBuffer(t,l,p){return new fn(this,t,l,p)}createRenderbuffer(t,l,p){const _=this.gl,b=_.createRenderbuffer();return this.bindRenderbuffer.set(b),_.renderbufferStorage(_.RENDERBUFFER,t,l,p),this.bindRenderbuffer.set(null),b}createFramebuffer(t,l,p){return new pe(this,t,l,p)}clear({color:t,depth:l,stencil:p}){const _=this.gl;let b=0;t&&(b|=_.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==l&&(b|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),void 0!==p&&(b|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(b)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){de(t.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ae extends a.Evented{constructor(t,l,p,_){super(),this.id=t,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},l),a.extend(this,a.pick(l,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=zt(this._options,this.map._requestManager,null,null,(t,l)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new a.ErrorEvent(t)):l&&(a.extend(this,l),l.bounds&&(this.tileBounds=new ve(l.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(l.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,l){const p=a.exported.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);t.request=a.getImage(this.map._requestManager.transformRequest(_,a.ResourceType.Tile),(b,M,O,F)=>(delete t.request,t.aborted?(t.state="unloaded",l(null)):b?(t.state="errored",l(b)):M?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:O,expires:F}),t.setTexture(M,this.map.painter),t.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void l(null)):l(null)))}static loadTileData(t,l,p){t.setTexture(l,p)}static unloadTileData(t,l){t.texture&&l.saveTileTexture(t.texture)}abortTile(t,l){t.request&&(t.request.cancel(),delete t.request),l()}unloadTile(t,l){t.texture&&this.map.painter.saveTileTexture(t.texture),l()}hasTransition(){return!1}}let ye;function Ge(u,t,l,p,_,b,M,O){const F=[u,l,_,t,p,b,1,1,1],q=[M,O,1],W=a.adjoint([],F),[re,we,Ue]=a.transformMat3(q,q,a.transpose(W,W));return a.multiply$1(F,[re,0,0,0,we,0,0,0,Ue],F)}class Ye extends a.Evented{constructor(t,l,p,_){super(),this.id=t,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=l,this._dirty=!1}load(t,l){this._loaded=l||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(p,_)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new a.ErrorEvent(p));else if(_){const{HTMLImageElement:b}=a.window;this.image=_ instanceof b?a.exported.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const l=t.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let _=1/0,b=1/0,M=-1/0,O=-1/0;for(const re of p)_=Math.min(_,re.x),b=Math.min(b,re.y),M=Math.max(M,re.x),O=Math.max(O,re.y);const F=Math.max(M-_,O-b),q=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),W=Math.pow(2,q);return new a.CanonicalTileID(q,Math.floor((_+M)/2*W),Math.floor((b+O)/2*W))}(l),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const F in this.tiles){const q=this.tiles[F];"loaded"!==q.state&&(q.state="loaded",q.texture=this.texture)}if(this._boundsArray)return;const l=a.tileTransform(this.tileID,this.map.transform.projection),[p,_,b,M]=this.coordinates.map(F=>{const q=l.projection.project(F[0],F[1]);return a.getTilePoint(l,q)._round()});this.perspectiveTransform=function(F,q,W,re,we,Ue,Be,je,Ie,Le){const Ze=Ge(0,0,F,0,0,q,F,q),He=Ge(W,re,we,Ue,Be,je,Ie,Le);return a.multiply$1(He,a.adjoint(Ze,Ze),He),[He[6]/He[8]*F/a.EXTENT,He[7]/He[8]*q/a.EXTENT]}(this.width,this.height,p.x,p.y,_.x,_.y,M.x,M.y,b.x,b.y);const O=this._boundsArray=new a.StructArrayLayout4i8;O.emplaceBack(p.x,p.y,0,0),O.emplaceBack(_.x,_.y,a.EXTENT,0),O.emplaceBack(M.x,M.y,0,a.EXTENT),O.emplaceBack(b.x,b.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(O,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,l=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(t,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(t,l){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},l(null)):(t.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const xe={vector:class extends a.Evented{constructor(u,t,l,p){if(super(),this.id=u,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(t,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(u){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=zt(this._options,this.map._requestManager,t,l,(p,_)=>{this._tileJSONRequest=null,this._loaded=!0,p?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),l&&2!==l.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new a.ErrorEvent(p))):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new ve(_.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(_.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),u&&u(p)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const u=this.map.style._getSourceCaches(this.id);for(const t of u)t.clearTiles()})}setSourceProperty(u){u(),this.reload()}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(u,t){const l=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(l,a.ResourceType.Tile),data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,u.actor&&"expired"!==u.state)"loading"===u.state?u.reloadCallback=t:u.request=u.actor.send("reloadTile",p,_.bind(this));else if(u.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",p,_.bind(this),void 0,!0);else{const b=a.loadVectorTile.call({deduped:this._deduped},p,(M,O)=>{M||!O?_.call(this,M):(p.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},u.actor&&u.actor.send("loadTile",p,_.bind(this),void 0,!0))},!0);u.request={cancel:b}}function _(b,M){return delete u.request,u.aborted?t(null):b&&404!==b.status?t(b):(M&&M.resourceTiming&&(u.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&u.setExpiryData(M),u.loadVectorData(M,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id})}unloadTile(u){u.unloadVectorData(),u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:ae,"raster-dem":class extends ae{constructor(u,t,l,p){super(u,t,l,p),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(u,t){const l=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(_,b){_&&(u.state="errored",t(_)),b&&(u.dem=b,u.dem.onDeserialize(),u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0,u.state="loaded",t(null))}u.request=a.getImage(this.map._requestManager.transformRequest(l,a.ResourceType.Tile),function(_,b,M,O){if(delete u.request,u.aborted)u.state="unloaded",t(null);else if(_)u.state="errored",t(_);else if(b){this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:M,expires:O});const F=a.window.ImageBitmap&&b instanceof a.window.ImageBitmap&&(null==ye&&(ye=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.window.createImageBitmap),ye),q=1-(b.width-a.prevPowerOfTwo(b.width))/2;q<1||u.neighboringTiles||(u.neighboringTiles=this._getNeighboringTiles(u.tileID));const W=F?b:a.exported.getImageData(b,q),re={uid:u.uid,coord:u.tileID,source:this.id,rawImageData:W,encoding:this.encoding,padding:q};u.actor&&"expired"!==u.state||(u.actor=this.dispatcher.getActor(),u.actor.send("loadDEMTile",re,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(u){const t=u.canonical,l=Math.pow(2,t.z),p=(t.x-1+l)%l,_=0===t.x?u.wrap-1:u.wrap,b=(t.x+1+l)%l,M=t.x+1===l?u.wrap+1:u.wrap,O={};return O[new a.OverscaledTileID(u.overscaledZ,_,t.z,p,t.y).key]={backfilled:!1},O[new a.OverscaledTileID(u.overscaledZ,M,t.z,b,t.y).key]={backfilled:!1},t.y>0&&(O[new a.OverscaledTileID(u.overscaledZ,_,t.z,p,t.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(u.overscaledZ,u.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},O[new a.OverscaledTileID(u.overscaledZ,M,t.z,b,t.y-1).key]={backfilled:!1}),t.y+1<l&&(O[new a.OverscaledTileID(u.overscaledZ,_,t.z,p,t.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(u.overscaledZ,u.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},O[new a.OverscaledTileID(u.overscaledZ,M,t.z,b,t.y+1).key]={backfilled:!1}),O}unloadTile(u){u.demTexture&&this.map.painter.saveTileTexture(u.demTexture),u.fbo&&(u.fbo.destroy(),delete u.fbo),u.dem&&delete u.dem,delete u.neighboringTiles,u.state="unloaded"}},geojson:class extends a.Evented{constructor(u,t,l,p){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(p),this._data=t.data,this._options=a.extend({},t),this._collectResourceTiming=t.collectResourceTiming,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const _=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(void 0!==t.buffer?t.buffer:128)*_,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*_,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:void 0!==t.clusterMaxZoom?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:a.EXTENT,radius:(void 0!==t.clusterRadius?t.clusterRadius:50)*_,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(u){this.map=u,this.setData(this._data)}setData(u){return this._data=u,this._updateWorkerData(),this}getClusterExpansionZoom(u,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:u,source:this.id},t),this}getClusterChildren(u,t){return this.actor.send("geojson.getClusterChildren",{clusterId:u,source:this.id},t),this}getClusterLeaves(u,t,l,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:u,limit:t,offset:l},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const u=a.extend({},this.workerOptions),t=this._data;"string"==typeof t?(u.request=this.map._requestManager.transformRequest(a.exported.resolveURL(t),a.ResourceType.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,u,(l,p)=>{if(this._loaded=!0,this._pendingLoad=null,l)this.fire(new a.ErrorEvent(l));else{const _={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(_.resourceTiming=p.resourceTiming[this.id]),this.fire(new a.Event("data",_)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(u,t){const l=u.actor?"reloadTile":"loadTile";u.actor=this.actor,u.request=this.actor.send(l,{type:this.type,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,_)=>(delete u.request,u.unloadVectorData(),u.aborted?t(null):p?t(p):(u.loadVectorData(_,this.map.painter,"reloadTile"===l),t(null))),void 0,"loadTile"===l)}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.aborted=!0}unloadTile(u){u.unloadVectorData(),this.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ye{constructor(u,t,l,p){super(u,t,l,p),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const u=this.options;this.urls=[];for(const t of u.urls)this.urls.push(this.map._requestManager.transformRequest(t,a.ResourceType.Source).url);a.getVideo(this.urls,(t,l)=>{this._loaded=!0,t?this.fire(new a.ErrorEvent(t)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const t=this.video.seekable;u<t.start(0)||u>t.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const u=this.map.painter.context,t=u.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(u,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(u)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ye,canvas:class extends Ye{constructor(u,t,l,p){super(u,t,l,p),t.coordinates?Array.isArray(t.coordinates)&&4===t.coordinates.length&&!t.coordinates.some(_=>!Array.isArray(_)||2!==_.length||_.some(b=>"number"!=typeof b))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${u}`,null,'missing required property "coordinates"'))),t.animate&&"boolean"!=typeof t.animate&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),t.canvas?"string"==typeof t.canvas||t.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${u}`,null,'missing required property "canvas"'))),this.options=t,this.animate=void 0===t.animate||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const t=this.map.painter.context;this.texture?(u||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}},custom:class extends a.Evented{constructor(u,t,l,p){super(),this.id=u,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=t,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ve(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(u){this._map=u,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(u),this.load()}onRemove(u){this._implementation.onRemove&&this._implementation.onRemove(u)}hasTile(u){if(this._implementation.hasTile){const{x:t,y:l,z:p}=u.canonical;return this._implementation.hasTile({x:t,y:l,z:p})}return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,t){const{x:l,y:p,z:_}=u.tileID.canonical,b=new a.window.AbortController;u.request=Promise.resolve(this._implementation.loadTile({x:l,y:p,z:_},{signal:b.signal})).then(function(M){return delete u.request,u.aborted?(u.state="unloaded",t(null)):void 0===M?(u.state="errored",t(null)):null===M?(this.loadTileData(u,{width:this.tileSize,height:this.tileSize,data:null}),u.state="loaded",t(null)):(O=M)instanceof a.window.ImageData||O instanceof a.window.HTMLCanvasElement||O instanceof a.window.ImageBitmap||O instanceof a.window.HTMLImageElement?(this.loadTileData(u,M),u.state="loaded",void t(null)):(u.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(M=>{20!==M.code&&(u.state="errored",t(M))}),u.request.cancel=()=>b.abort()}loadTileData(u,t){ae.loadTileData(u,t,this._map.painter)}unloadTileData(u){ae.unloadTileData(u,this._map.painter)}unloadTile(u,t){if(this.unloadTileData(u),this._implementation.unloadTile){const{x:l,y:p,z:_}=u.tileID.canonical;this._implementation.unloadTile({x:l,y:p,z:_})}t()}abortTile(u,t){u.request&&u.request.cancel&&(u.request.cancel(),delete u.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(u=>({x:u.canonical.x,y:u.canonical.y,z:u.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},fe=function(u,t,l,p){const _=new xe[t.type](u,t,l,p);if(_.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${_.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],_),_};function te(u,t){const l=a.identity([]);return a.scale(l,l,[.5*u.width,.5*-u.height,1]),a.translate(l,l,[1,-1,0]),a.multiply(l,l,u.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(l)}function ge(u,t,l,p,_,b,M,O=!1){const F=u.tilesIn(p,M,O);F.sort(en);const q=[];for(const re of F)q.push({wrappedTileID:re.tile.tileID.wrapped().key,queryResults:re.tile.queryRenderedFeatures(t,l,u._state,re,_,b,te(u.transform,re.tile.tileID),O)});const W=function(re){const we={},Ue={};for(const Be of re){const je=Be.queryResults,Ie=Be.wrappedTileID,Le=Ue[Ie]=Ue[Ie]||{};for(const Ze in je){const He=je[Ze],st=Le[Ze]=Le[Ze]||{},St=we[Ze]=we[Ze]||[];for(const Mt of He)st[Mt.featureIndex]||(st[Mt.featureIndex]=!0,St.push(Mt))}}return we}(q);for(const re in W)W[re].forEach(we=>{const Ue=we.feature,Be=Ue.layer;Be&&"background"!==Be.type&&"sky"!==Be.type&&(Ue.source=Be.source,Be["source-layer"]&&(Ue.sourceLayer=Be["source-layer"]),Ue.state=void 0!==Ue.id?u.getFeatureState(Be["source-layer"],Ue.id):{})});return W}function ut(u,t){const l=u.getRenderableIds().map(b=>u.getTileByID(b)),p=[],_={};for(let b=0;b<l.length;b++){const M=l[b],O=M.tileID.canonical.key;_[O]||(_[O]=!0,M.querySourceFeatures(p,t))}return p}function en(u,t){const l=u.tileID,p=t.tileID;return l.overscaledZ-p.overscaledZ||l.canonical.y-p.canonical.y||l.wrap-p.wrap||l.canonical.x-p.canonical.x}function Xt(){return null!=ee.workerClass?new ee.workerClass:new a.window.Worker(ee.workerUrl)}const Qn="mapboxgl_preloaded_worker_pool";class ei{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<ei.workerCount;)this.workers.push(new Xt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qn]}numActive(){return Object.keys(this.active).length}}let ci;function gi(){return ci||(ci=new ei),ci}function Vi(u,t){const l={};for(const p in u)"ref"!==p&&(l[p]=u[p]);return a.refProperties.forEach(p=>{p in t&&(l[p]=t[p])}),l}function ji(u){u=u.slice();const t=Object.create(null);for(let l=0;l<u.length;l++)t[u[l].id]=u[l];for(let l=0;l<u.length;l++)"ref"in u[l]&&(u[l]=Vi(u[l],t[u[l].ref]));return u}ei.workerCount=2;const hi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Yi(u,t,l){l.push({command:hi.addSource,args:[u,t[u]]})}function ir(u,t,l){t.push({command:hi.removeSource,args:[u]}),l[u]=!0}function Ki(u,t,l,p){ir(u,l,p),Yi(u,t,l)}function kr(u,t,l){let p;for(p in u[l])if(u[l].hasOwnProperty(p)&&"data"!==p&&!de(u[l][p],t[l][p]))return!1;for(p in t[l])if(t[l].hasOwnProperty(p)&&"data"!==p&&!de(u[l][p],t[l][p]))return!1;return!0}function Cr(u,t,l,p,_,b){let M;for(M in t=t||{},u=u||{})u.hasOwnProperty(M)&&(de(u[M],t[M])||l.push({command:b,args:[p,M,t[M],_]}));for(M in t)t.hasOwnProperty(M)&&!u.hasOwnProperty(M)&&(de(u[M],t[M])||l.push({command:b,args:[p,M,t[M],_]}))}function pn(u){return u.id}function qr(u,t){return u[t.id]=t,u}class Lr{constructor(t,l){this.reset(t,l)}reset(t,l){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=a.clamp(t,0,1);let l=1,p=this._distances[l];const _=t*this.paddedLength+this.padding;for(;p<_&&l<this._distances.length;)p=this._distances[++l];const b=l-1,M=this._distances[b],O=p-M,F=O>0?(_-M)/O:0;return this.points[b].mult(1-F).add(this.points[l].mult(F))}}class Ro{constructor(t,l,p){const _=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(l/p);for(let M=0;M<this.xCellCount*this.yCellCount;M++)_.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=l,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,l,p,_,b){this._forEachCell(l,p,_,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(b)}insertCircle(t,l,p,_){this._forEachCell(l-_,p-_,l+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(l),this.circles.push(p),this.circles.push(_)}_insertBoxCell(t,l,p,_,b,M){this.boxCells[b].push(M)}_insertCircleCell(t,l,p,_,b,M){this.circleCells[b].push(M)}_query(t,l,p,_,b,M){if(p<0||t>this.width||_<0||l>this.height)return!b&&[];const O=[];if(t<=0&&l<=0&&this.width<=p&&this.height<=_){if(b)return!0;for(let F=0;F<this.boxKeys.length;F++)O.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const q=this.circles[3*F],W=this.circles[3*F+1],re=this.circles[3*F+2];O.push({key:this.circleKeys[F],x1:q-re,y1:W-re,x2:q+re,y2:W+re})}return M?O.filter(M):O}return this._forEachCell(t,l,p,_,this._queryCell,O,{hitTest:b,seenUids:{box:{},circle:{}}},M),b?O.length>0:O}_queryCircle(t,l,p,_,b){const M=t-p,O=t+p,F=l-p,q=l+p;if(O<0||M>this.width||q<0||F>this.height)return!_&&[];const W=[];return this._forEachCell(M,F,O,q,this._queryCellCircle,W,{hitTest:_,circle:{x:t,y:l,radius:p},seenUids:{box:{},circle:{}}},b),_?W.length>0:W}query(t,l,p,_,b){return this._query(t,l,p,_,!1,b)}hitTest(t,l,p,_,b){return this._query(t,l,p,_,!0,b)}hitTestCircle(t,l,p,_){return this._queryCircle(t,l,p,!0,_)}_queryCell(t,l,p,_,b,M,O,F){const q=O.seenUids,W=this.boxCells[b];if(null!==W){const we=this.bboxes;for(const Ue of W)if(!q.box[Ue]){q.box[Ue]=!0;const Be=4*Ue;if(t<=we[Be+2]&&l<=we[Be+3]&&p>=we[Be+0]&&_>=we[Be+1]&&(!F||F(this.boxKeys[Ue]))){if(O.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[Ue],x1:we[Be],y1:we[Be+1],x2:we[Be+2],y2:we[Be+3]})}}}const re=this.circleCells[b];if(null!==re){const we=this.circles;for(const Ue of re)if(!q.circle[Ue]){q.circle[Ue]=!0;const Be=3*Ue;if(this._circleAndRectCollide(we[Be],we[Be+1],we[Be+2],t,l,p,_)&&(!F||F(this.circleKeys[Ue]))){if(O.hitTest)return M.push(!0),!0;{const je=we[Be],Ie=we[Be+1],Le=we[Be+2];M.push({key:this.circleKeys[Ue],x1:je-Le,y1:Ie-Le,x2:je+Le,y2:Ie+Le})}}}}}_queryCellCircle(t,l,p,_,b,M,O,F){const q=O.circle,W=O.seenUids,re=this.boxCells[b];if(null!==re){const Ue=this.bboxes;for(const Be of re)if(!W.box[Be]){W.box[Be]=!0;const je=4*Be;if(this._circleAndRectCollide(q.x,q.y,q.radius,Ue[je+0],Ue[je+1],Ue[je+2],Ue[je+3])&&(!F||F(this.boxKeys[Be])))return M.push(!0),!0}}const we=this.circleCells[b];if(null!==we){const Ue=this.circles;for(const Be of we)if(!W.circle[Be]){W.circle[Be]=!0;const je=3*Be;if(this._circlesCollide(Ue[je],Ue[je+1],Ue[je+2],q.x,q.y,q.radius)&&(!F||F(this.circleKeys[Be])))return M.push(!0),!0}}}_forEachCell(t,l,p,_,b,M,O,F){const q=this._convertToXCellCoord(t),W=this._convertToYCellCoord(l),re=this._convertToXCellCoord(p),we=this._convertToYCellCoord(_);for(let Ue=q;Ue<=re;Ue++)for(let Be=W;Be<=we;Be++)if(b.call(this,t,l,p,_,this.xCellCount*Be+Ue,M,O,F))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,l,p,_,b,M){const O=_-t,F=b-l,q=p+M;return q*q>O*O+F*F}_circleAndRectCollide(t,l,p,_,b,M,O){const F=(M-_)/2,q=Math.abs(t-(_+F));if(q>F+p)return!1;const W=(O-b)/2,re=Math.abs(l-(b+W));if(re>W+p)return!1;if(q<=F||re<=W)return!0;const we=q-F,Ue=re-W;return we*we+Ue*Ue<=p*p}}const js=Math.tan(85*Math.PI/180);function Pr(u,t,l,p,_,b,M){const O=a.create();if(l)if("globe"===b.name){const F=a.calculateGlobeLabelMatrix(_,t);a.multiply(O,O,F)}else{const F=Te([],M);O[0]=F[0],O[1]=F[1],O[4]=F[2],O[5]=F[3],p||a.rotateZ(O,O,_.angle)}else a.multiply(O,_.labelPlaneMatrix,u);return O}function ii(u,t,l,p,_,b,M){const O=Pr(u,t,l,p,_,b,M);return"globe"===b.name&&l||(O[2]=O[6]=O[10]=O[14]=0),O}function Gi(u,t,l,p,_,b,M){if(l){if("globe"===b.name){const O=Pr(u,t,l,p,_,b,M);return a.invert(O,O),a.multiply(O,u,O),O}{const O=a.clone(u),F=a.identity([]);return F[0]=M[0],F[1]=M[1],F[4]=M[2],F[5]=M[3],a.multiply(O,O,F),p||a.rotateZ(O,O,-_.angle),O}}return _.glCoordMatrix}function rr(u,t,l,p){const _=[u,t,l,1];l?a.transformMat4$1(_,_,p):ur(_,_,p);const b=_[3];return _[0]/=b,_[1]/=b,_[2]/=b,_}function Kn(u,t){return Math.min(.5+u/t*.5,1.5)}function Ri(u,t){const l=u[0]/u[3],p=u[1]/u[3];return l>=-t[0]&&l<=t[0]&&p>=-t[1]&&p<=t[1]}function bi(u,t,l,p,_,b,M,O,F,q){const W=l.transform,re=p?u.textSizeData:u.iconSizeData,we=a.evaluateSizeForZoom(re,l.transform.zoom),Ue="globe"===W.projection.name,Be=[256/l.width*2+1,256/l.height*2+1],je=p?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;je.clear();let Ie=null;Ue&&(Ie=p?u.text.globeExtVertexArray:u.icon.globeExtVertexArray);const Le=u.lineVertexArray,Ze=p?u.text.placedSymbolArray:u.icon.placedSymbolArray,He=l.transform.width/l.transform.height;let st,St=!1;for(let Mt=0;Mt<Ze.length;Mt++){const jt=Ze.get(Mt),{numGlyphs:un,writingMode:rn}=jt;if(rn!==a.WritingMode.vertical||St||st===a.WritingMode.horizontal||(St=!0),st=rn,(jt.hidden||rn===a.WritingMode.vertical)&&!St){Br(un,je);continue}St=!1;const Wt=new a.pointGeometry(jt.tileAnchorX,jt.tileAnchorY);let{x:Xn,y:tn,z:In}=W.projection.projectTilePoint(Wt.x,Wt.y,q.canonical);if(F){const[ki,yi,Wi]=F(Wt);Xn+=ki,tn+=yi,In+=Wi}const _n=[Xn,tn,In,1];if(a.transformMat4$1(_n,_n,t),!Ri(_n,Be)){Br(un,je);continue}const $n=Kn(l.transform.cameraToCenterDistance,_n[3]),xn=a.evaluateSizeForFeature(re,we,jt),zn=M?xn/$n:xn*$n,qn=rr(Xn,tn,In,_);if(qn[3]<=0){Br(un,je);continue}let qt={};const gn=M?null:F,_i=Pi(jt,zn,!1,O,t,_,b,u.glyphOffsetArray,Le,je,Ie,qn,Wt,qt,He,gn,W.projection,q,M);St=_i.useVertical,gn&&_i.needsFlipping&&(qt={}),(_i.notEnoughRoom||St||_i.needsFlipping&&Pi(jt,zn,!0,O,t,_,b,u.glyphOffsetArray,Le,je,Ie,qn,Wt,qt,He,gn,W.projection,q,M).notEnoughRoom)&&Br(un,je)}p?(u.text.dynamicLayoutVertexBuffer.updateData(je),Ie&&u.text.globeExtVertexBuffer.updateData(Ie)):(u.icon.dynamicLayoutVertexBuffer.updateData(je),Ie&&u.icon.globeExtVertexBuffer.updateData(Ie))}function Fr(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je){const{lineStartIndex:Ie,glyphStartIndex:Le,segment:Ze}=O,He=Le+O.numGlyphs,st=Ie+O.lineLength,St=t.getoffsetX(Le),Mt=t.getoffsetX(He-1),jt=Eo(u*St,l,p,_,b,M,Ze,Ie,st,F,q,W,re,we,!0,Ue,Be,je);if(!jt)return null;const un=Eo(u*Mt,l,p,_,b,M,Ze,Ie,st,F,q,W,re,we,!0,Ue,Be,je);return un?{first:jt,last:un}:null}function Ji(u,t,l,p){return u===a.WritingMode.horizontal&&Math.abs(p)>Math.abs(l)?{useVertical:!0}:u===a.WritingMode.vertical?p>0?{needsFlipping:!0}:null:0!==t&&(0===(_=l)||Math.abs(p/_)>js)?1===t?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null;var _}function Pi(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je,Ie,Le,Ze){const He=t/24,st=u.lineOffsetX*He,St=u.lineOffsetY*He,{lineStartIndex:Mt,glyphStartIndex:jt,numGlyphs:un,segment:rn,writingMode:Wt,flipState:Xn}=u,tn=Mt+u.lineLength,In=_n=>{if(W){const[qn,qt,gn]=_n.up,_i=q.length;a.updateGlobeVertexNormal(W,_i+0,qn,qt,gn),a.updateGlobeVertexNormal(W,_i+1,qn,qt,gn),a.updateGlobeVertexNormal(W,_i+2,qn,qt,gn),a.updateGlobeVertexNormal(W,_i+3,qn,qt,gn)}const[$n,xn,zn]=_n.point;a.addDynamicAttributes(q,$n,xn,zn,_n.angle)};if(un>1){const _n=Fr(He,O,st,St,l,re,we,u,F,b,Ue,je,!1,Ie,Le,Ze);if(!_n)return{notEnoughRoom:!0};if(p&&!l){let[$n,xn,zn]=_n.first.point,[qn,qt,gn]=_n.last.point;[$n,xn]=rr($n,xn,zn,M),[qn,qt]=rr(qn,qt,gn,M);const _i=Ji(Wt,Xn,(qn-$n)*Be,qt-xn);if(u.flipState=_i&&_i.needsFlipping?1:2,_i)return _i}In(_n.first);for(let $n=jt+1;$n<jt+un-1;$n++){const xn=Eo(He*O.getoffsetX($n),st,St,l,re,we,rn,Mt,tn,F,b,Ue,je,!1,!1,Ie,Le,Ze);if(!xn)return q.length-=4*($n-jt),{notEnoughRoom:!0};In(xn)}In(_n.last)}else{if(p&&!l){const $n=rr(we.x,we.y,0,_),xn=Mt+rn+1,zn=new a.pointGeometry(F.getx(xn),F.gety(xn)),qn=rr(zn.x,zn.y,0,_),qt=qn[3]>0?qn:$i(we,zn,$n,1,_,void 0,Ie,Le.canonical),gn=Ji(Wt,Xn,(qt[0]-$n[0])*Be,qt[1]-$n[1]);if(u.flipState=gn&&gn.needsFlipping?1:2,gn)return gn}const _n=Eo(He*O.getoffsetX(jt),st,St,l,re,we,rn,Mt,tn,F,b,Ue,je,!1,!1,Ie,Le,Ze);if(!_n)return{notEnoughRoom:!0};In(_n)}return{}}function wo(u,t,l,p,_){const{x:b,y:M,z:O}=p.projectTilePoint(u.x,u.y,t);if(!_)return rr(b,M,O,l);const[F,q,W]=_(u);return rr(b+F,M+q,O+W,l)}function $i(u,t,l,p,_,b,M,O){const F=wo(u.sub(t)._unit()._add(u),O,_,M,b);return a.sub(F,l,F),a.normalize(F,F),a.scaleAndAdd(F,l,F,p)}function Eo(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je,Ie,Le){const Ze=p?u-t:u+t;let He=Ze>0?1:-1,st=0;p&&(He*=-1,st=Math.PI),He<0&&(st+=Math.PI);let St=O+M+(He>0?0:1)|0,Mt=_,jt=_,un=0,rn=0;const Wt=Math.abs(Ze),Xn=[],tn=[];let In=b,_n=In;const $n=()=>$i(_n,In,jt,Wt-un+1,W,we,je,Ie.canonical);for(;un+rn<=Wt;){if(St+=He,St<O||St>=F)return null;if(jt=Mt,_n=In,Xn.push(jt),Ue&&tn.push(_n),In=new a.pointGeometry(q.getx(St),q.gety(St)),Mt=re[St],!Mt){const Wi=wo(In,Ie.canonical,W,je,we);Mt=Wi[3]>0?re[St]=Wi:$n()}un+=rn,rn=a.distance(jt,Mt)}Be&&we&&(re[St]&&(Mt=$n(),rn=a.distance(jt,Mt)),re[St]=Mt);const xn=(Wt-un)/rn,zn=In.sub(_n)._mult(xn)._add(_n),qn=a.sub([],Mt,jt),qt=a.scaleAndAdd([],jt,qn,xn);let gn=[0,0,1],_i=qn[0],ki=qn[1];if(Le&&(gn=je.upVector(Ie.canonical,zn.x,zn.y),0!==gn[0]||0!==gn[1]||1!==gn[2])){const Wi=[gn[2],0,-gn[0]],cr=a.cross([],gn,Wi);a.normalize(Wi,Wi),a.normalize(cr,cr),_i=a.dot(qn,Wi),ki=a.dot(qn,cr)}if(l){const Wi=a.cross([],gn,qn);a.normalize(Wi,Wi),a.scaleAndAdd(qt,qt,Wi,l*He)}const yi=st+Math.atan2(ki,_i);return Xn.push(qt),Ue&&tn.push(zn),{point:qt,angle:yi,path:Xn,tilePath:tn,up:gn}}function Br(u,t){const l=t.length,p=l+4*u;t.resize(p),t.float32.fill(-1/0,4*l,4*p)}function ur(u,t,l){const p=t[0],_=t[1];return u[0]=l[0]*p+l[4]*_+l[12],u[1]=l[1]*p+l[5]*_+l[13],u[3]=l[3]*p+l[7]*_+l[15],u}const xo=100;class to{constructor(t,l,p=new Ro(t.width+200,t.height+200,25),_=new Ro(t.width+200,t.height+200,25)){this.transform=t,this.grid=p,this.ignoredGrid=_,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+xo,this.screenBottomBoundary=t.height+xo,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=l}placeCollisionBox(t,l,p,_,b,M,O,F){let q=p.projectedAnchorX,W=p.projectedAnchorY,re=p.projectedAnchorZ;const we=p.elevation,Ue=p.tileID,Be=t.getProjection();if(we&&Ue){const[Mt,jt,un]=Be.upVector(Ue.canonical,p.tileAnchorX,p.tileAnchorY),rn=Be.upVectorScale(Ue.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;q+=Mt*we*rn,W+=jt*we*rn,re+=un*we*rn}const je=this.projectAndGetPerspectiveRatio(O,q,W,re,p.tileID,"globe"===Be.name||!!we||this.transform.pitch>0,Be),Ie=M*je.perspectiveRatio,Le=(p.x1*l+_.x-p.padding)*Ie+je.point.x,Ze=(p.y1*l+_.y-p.padding)*Ie+je.point.y,He=(p.x2*l+_.x+p.padding)*Ie+je.point.x,st=(p.y2*l+_.y+p.padding)*Ie+je.point.y,St=je.perspectiveRatio<=.55||je.occluded;return!this.isInsideGrid(Le,Ze,He,st)||!b&&this.grid.hitTest(Le,Ze,He,st,F)||St?{box:[],offscreen:!1,occluded:je.occluded}:{box:[Le,Ze,He,st],offscreen:this.isOffscreen(Le,Ze,He,st),occluded:!1}}placeCollisionCircles(t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je){const Ie=[],Le=this.transform.elevation,Ze=t.getProjection(),He=Le?Le.getAtTileOffsetFunc(je,this.transform.center.lat,this.transform.worldSize,Ze):null,st=new a.pointGeometry(p.tileAnchorX,p.tileAnchorY);let{x:St,y:Mt,z:jt}=Ze.projectTilePoint(st.x,st.y,je.canonical);if(He){const[zn,qn,qt]=He(st);St+=zn,Mt+=qn,jt+=qt}const un="globe"===Ze.name,rn=this.projectAndGetPerspectiveRatio(O,St,Mt,jt,je,un||!!Le||this.transform.pitch>0,Ze),{perspectiveRatio:Wt}=rn,Xn=(re?M/Wt:M*Wt)/a.ONE_EM,tn=rr(St,Mt,jt,F),In=rn.signedDistanceFromCamera>0?Fr(Xn,b,p.lineOffsetX*Xn,p.lineOffsetY*Xn,!1,tn,st,p,_,F,{},Le&&!re?He:null,re&&!!Le,Ze,je,re):null;let _n=!1,$n=!1,xn=!0;if(In&&!rn.occluded){const zn=.5*Ue*Wt+Be,qn=new a.pointGeometry(-100,-100),qt=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),gn=new Lr,{first:_i,last:ki}=In,yi=_i.path.length;let Wi=[];for(let di=yi-1;di>=1;di--)Wi.push(_i.path[di]);for(let di=1;di<ki.path.length;di++)Wi.push(ki.path[di]);const cr=2.5*zn;q&&(Wi=Wi.map(([di,Qr,zr],Gr)=>(He&&!un&&(zr=He(Gr<yi-1?_i.tilePath[yi-1-Gr]:ki.tilePath[Gr-yi+2])[2]),rr(di,Qr,zr,q))),Wi.some(di=>di[3]<=0)&&(Wi=[]));let Oi=[];if(Wi.length>0){let di=1/0,Qr=-1/0,zr=1/0,Gr=-1/0;for(const oo of Wi)di=Math.min(di,oo[0]),zr=Math.min(zr,oo[1]),Qr=Math.max(Qr,oo[0]),Gr=Math.max(Gr,oo[1]);Qr>=qn.x&&di<=qt.x&&Gr>=qn.y&&zr<=qt.y&&(Oi=[Wi.map(oo=>new a.pointGeometry(oo[0],oo[1]))],(di<qn.x||Qr>qt.x||zr<qn.y||Gr>qt.y)&&(Oi=a.clipLine(Oi,qn.x,qn.y,qt.x,qt.y)))}for(const di of Oi){gn.reset(di,.25*zn);let Qr=0;Qr=gn.length<=.5*zn?1:Math.ceil(gn.paddedLength/cr)+1;for(let zr=0;zr<Qr;zr++){const Gr=zr/Math.max(Qr-1,1),oo=gn.lerp(Gr),La=oo.x+xo,Ka=oo.y+xo;Ie.push(La,Ka,zn,0);const va=La-zn,jl=Ka-zn,mo=La+zn,Jr=Ka+zn;if(xn=xn&&this.isOffscreen(va,jl,mo,Jr),$n=$n||this.isInsideGrid(va,jl,mo,Jr),!l&&this.grid.hitTestCircle(La,Ka,zn,we)&&(_n=!0,!W))return{circles:[],offscreen:!1,collisionDetected:_n,occluded:!1}}}}return{circles:!W&&_n||!$n?[]:Ie,offscreen:xn,collisionDetected:_n,occluded:rn.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const l=[];let p=1/0,_=1/0,b=-1/0,M=-1/0;for(const W of t){const re=new a.pointGeometry(W.x+xo,W.y+xo);p=Math.min(p,re.x),_=Math.min(_,re.y),b=Math.max(b,re.x),M=Math.max(M,re.y),l.push(re)}const O=this.grid.query(p,_,b,M).concat(this.ignoredGrid.query(p,_,b,M)),F={},q={};for(const W of O){const re=W.key;if(void 0===F[re.bucketInstanceId]&&(F[re.bucketInstanceId]={}),F[re.bucketInstanceId][re.featureIndex])continue;const we=[new a.pointGeometry(W.x1,W.y1),new a.pointGeometry(W.x2,W.y1),new a.pointGeometry(W.x2,W.y2),new a.pointGeometry(W.x1,W.y2)];a.polygonIntersectsPolygon(l,we)&&(F[re.bucketInstanceId][re.featureIndex]=!0,void 0===q[re.bucketInstanceId]&&(q[re.bucketInstanceId]=[]),q[re.bucketInstanceId].push(re.featureIndex))}return q}insertCollisionBox(t,l,p,_,b){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:b},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,l,p,_,b){const M=l?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:_,collisionGroupID:b};for(let F=0;F<t.length;F+=4)M.insertCircle(O,t[F],t[F+1],t[F+2])}projectAndGetPerspectiveRatio(t,l,p,_,b,M,O){const F=[l,p,_,1];let q=!1;_||this.transform.pitch>0?(a.transformMat4$1(F,F,t),this.fogState&&b&&"globe"!==O.name&&(q=function(Ue,Be,je,Ie,Le,Ze){const He=Ze.calculateFogTileMatrix(Le),st=[Be,je,Ie];return a.transformMat4(st,st,He),ct(Ue,st,Ze.pitch,Ze._fov)}(this.fogState,l,p,_,b.toUnwrapped(),this.transform)>.9)):ur(F,F,t);const W=F[3];return{point:new a.pointGeometry((F[0]/W+1)/2*this.transform.width+xo,(-F[1]/W+1)/2*this.transform.height+xo),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/W*.5,1.5),signedDistanceFromCamera:W,occluded:M&&F[2]>W||q}}isOffscreen(t,l,p,_){return p<xo||t>=this.screenRightBoundary||_<xo||l>this.screenBottomBoundary}isInsideGrid(t,l,p,_){return p>=0&&t<this.gridRightBoundary&&_>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const t=a.identity([]);return a.translate(t,t,[-100,-100,0]),t}}function ts(u,t,l){const p=t.createTileMatrix(u,u.worldSize,l.toUnwrapped());return a.multiply(new Float32Array(16),u.projMatrix,p)}function Zo(u,t,l){if(t.projection.name===l.projection.name)return u.projMatrix;const p=l.clone();return p.setProjection(t.projection),ts(p,t.getProjection(),u)}function Vo(u,t,l){return t.name===l.projection.name?u.projMatrix:ts(l,t,u)}class Hs{constructor(t,l,p,_){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?l:-l))):_&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class hs{constructor(t,l,p,_,b,M=!1){this.text=new Hs(t?t.text:null,l,p,b),this.icon=new Hs(t?t.icon:null,l,_,b),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Dr{constructor(t,l,p,_=!1){this.text=t,this.icon=l,this.skipFade=p,this.clipped=_}}class Io{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class Gs{constructor(t,l,p,_,b){this.bucketInstanceId=t,this.featureIndex=l,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=b}}class po{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const l=++this.maxGroupID;this.collisionGroups[t]={ID:l,predicate:p=>p.collisionGroupID===l}}return this.collisionGroups[t]}}function Or(u,t,l,p,_){const{horizontalAlign:b,verticalAlign:M}=a.getAnchorAlignment(u),O=-(b-.5)*t,F=-(M-.5)*l,q=a.evaluateVariableOffset(u,p);return new a.pointGeometry(O+q[0]*_,F+q[1]*_)}function jo(u,t,l,p,_){const b=new a.pointGeometry(u,t);return l&&b._rotate(p?_:-_),b}class ys{constructor(t,l,p,_,b){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new to(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new po(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,l,p,_){const b=p.getBucket(l),M=p.latestFeatureIndex;if(!b||!M||l.id!==b.layerIds[0])return;const O=b.layers[0].layout,F=p.collisionBoxArray,q=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),W=p.tileSize/a.EXTENT,re=p.tileID.toUnwrapped();this.transform.setProjection(b.projection);const we=(Ue=p.tileID,Be=b.getProjection(),je=this.transform,Be.name===this.projection?je.calculateProjMatrix(Ue.toUnwrapped()):ts(je,Be,Ue));var Ue,Be,je;const Ie="map"===O.get("text-pitch-alignment"),Le="map"===O.get("text-rotation-alignment");l.compileFilter();const Ze=l.dynamicFilter(),He=l.dynamicFilterNeedsFeature(),st=this.transform.calculatePixelsToTileUnitsMatrix(p),St=ii(we,p.tileID.canonical,Ie,Le,this.transform,b.getProjection(),st);let Mt=null;if(Ie){const rn=Gi(we,p.tileID.canonical,Ie,Le,this.transform,b.getProjection(),st);Mt=a.multiply([],this.transform.labelPlaneMatrix,rn)}let jt=null;Ze&&p.latestFeatureIndex&&(jt={unwrappedTileID:re,dynamicFilter:Ze,dynamicFilterNeedsFeature:He,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Gs(b.bucketInstanceId,M,b.sourceLayerIndex,b.index,p.tileID);const un={bucket:b,layout:O,posMatrix:we,textLabelPlaneMatrix:St,labelToScreenMatrix:Mt,clippingData:jt,scale:q,textPixelRatio:W,holdingForFade:p.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(_)for(const rn of b.sortKeyRanges){const{sortKey:Wt,symbolInstanceStart:Xn,symbolInstanceEnd:tn}=rn;t.push({sortKey:Wt,symbolInstanceStart:Xn,symbolInstanceEnd:tn,parameters:un})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:un})}attemptAnchorPlacement(t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je,Ie,Le,Ze){const{textOffset0:He,textOffset1:st,crossTileID:St}=we,Mt=[He,st],jt=Or(t,p,_,Mt,b),un=this.collisionIndex.placeCollisionBox(Be,b,l,jo(jt.x,jt.y,M,O,this.transform.angle),re,F,q,W.predicate);if(Ie){const rn=Be.getSymbolInstanceIconSize(Ze,this.transform.zoom,we.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Be,rn,Ie,jo(jt.x,jt.y,M,O,this.transform.angle),re,F,q,W.predicate).box.length)return}if(un.box.length>0){let rn;return this.prevPlacement&&this.prevPlacement.variableOffsets[St]&&this.prevPlacement.placements[St]&&this.prevPlacement.placements[St].text&&(rn=this.prevPlacement.variableOffsets[St].anchor),this.variableOffsets[St]={textOffset:Mt,width:p,height:_,anchor:t,textScale:b,prevAnchor:rn},this.markUsedJustification(Be,t,we,je),Be.allowVerticalPlacement&&(this.markUsedOrientation(Be,je,we),this.placedOrientations[St]=je),{shift:jt,placedGlyphBoxes:un}}}placeLayerBucketPart(t,l,p,_){const{bucket:b,layout:M,posMatrix:O,textLabelPlaneMatrix:F,labelToScreenMatrix:q,clippingData:W,textPixelRatio:re,holdingForFade:we,collisionBoxArray:Ue,partiallyEvaluatedTextSize:Be,partiallyEvaluatedIconSize:je,collisionGroup:Ie}=t.parameters,Le=M.get("text-optional"),Ze=M.get("icon-optional"),He=M.get("text-allow-overlap"),st=M.get("icon-allow-overlap"),St="map"===M.get("text-rotation-alignment"),Mt="map"===M.get("text-pitch-alignment"),jt="none"!==M.get("icon-text-fit"),un="viewport-y"===M.get("symbol-z-order");this.transform.setProjection(b.projection);let rn=He&&(st||!b.hasIconData()||Ze),Wt=st&&(He||!b.hasTextData()||Le);!b.collisionArrays&&Ue&&b.deserializeCollisionBoxes(Ue),p&&_&&b.updateCollisionDebugBuffers(this.transform.zoom,Ue);const Xn=(tn,In,_n)=>{const{crossTileID:$n,numVerticalGlyphVertices:xn}=tn;if(W){const mo={zoom:this.transform.zoom,pitch:this.transform.pitch};let Jr=null;if(W.dynamicFilterNeedsFeature){const Tr=this.retainedQueryData[b.bucketInstanceId];Jr=W.featureIndex.loadFeature({featureIndex:tn.featureIndex,bucketIndex:Tr.bucketIndex,sourceLayerIndex:Tr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,W.dynamicFilter)(mo,Jr,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new a.pointGeometry(tn.tileAnchorX,tn.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[$n]=new Dr(!1,!1,!1,!0),void(l[$n]=!0)}if(l[$n])return;if(we)return void(this.placements[$n]=new Dr(!1,!1,!1));let zn=!1,qn=!1,qt=!0,gn=!1,_i=!1,ki=null,yi={box:null,offscreen:null,occluded:null},Wi={box:null,offscreen:null,occluded:null},cr=null,Oi=null,di=null,Qr=0,zr=0,Gr=0;_n.textFeatureIndex?Qr=_n.textFeatureIndex:tn.useRuntimeCollisionCircles&&(Qr=tn.featureIndex),_n.verticalTextFeatureIndex&&(zr=_n.verticalTextFeatureIndex);const oo=mo=>{mo.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const Jr=this.transform.elevation;(Jr||mo.elevation)&&(mo.elevation=Jr?Jr.getAtTileOffset(mo.tileID,mo.tileAnchorX,mo.tileAnchorY):0)},La=_n.textBox;if(La){oo(La);const mo=Tr=>{let No=a.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Tr&&this.prevPlacement){const Ns=this.prevPlacement.placedOrientations[$n];Ns&&(this.placedOrientations[$n]=Ns,No=Ns,this.markUsedOrientation(b,No,tn))}return No},Jr=(Tr,No)=>{if(b.allowVerticalPlacement&&xn>0&&_n.verticalTextBox){for(const Ns of b.writingModes)if(Ns===a.WritingMode.vertical?(yi=No(),Wi=yi):yi=Tr(),yi&&yi.box&&yi.box.length)break}else yi=Tr()};if(M.get("text-variable-anchor")){let Tr=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[$n]){const so=this.prevPlacement.variableOffsets[$n];Tr.indexOf(so.anchor)>0&&(Tr=Tr.filter(Oo=>Oo!==so.anchor),Tr.unshift(so.anchor))}const No=(so,Oo,ou)=>{const Hl=b.getSymbolInstanceTextSize(Be,tn,this.transform.zoom,In),Ys=(so.x2-so.x1)*Hl+2*so.padding,Fa=(so.y2-so.y1)*Hl+2*so.padding,Xa=jt&&!st?Oo:null;Xa&&oo(Xa);let Dl={box:[],offscreen:!1,occluded:!1};const su=He?2*Tr.length:Tr.length;for(let jc=0;jc<su;++jc){const ul=this.attemptAnchorPlacement(Tr[jc%Tr.length],so,Ys,Fa,Hl,St,Mt,re,O,Ie,jc>=Tr.length,tn,In,b,ou,Xa,Be,je);if(ul&&(Dl=ul.placedGlyphBoxes,Dl&&Dl.box&&Dl.box.length)){zn=!0,ki=ul.shift;break}}return Dl};Jr(()=>No(La,_n.iconBox,a.WritingMode.horizontal),()=>{const so=_n.verticalTextBox;return so&&oo(so),b.allowVerticalPlacement&&!(yi&&yi.box&&yi.box.length)&&xn>0&&so?No(so,_n.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),yi&&(zn=yi.box,qt=yi.offscreen,gn=yi.occluded);const Ns=mo(yi&&yi.box);if(!zn&&this.prevPlacement){const so=this.prevPlacement.variableOffsets[$n];so&&(this.variableOffsets[$n]=so,this.markUsedJustification(b,so.anchor,tn,Ns))}}else{const Tr=(No,Ns)=>{const so=b.getSymbolInstanceTextSize(Be,tn,this.transform.zoom,In),Oo=this.collisionIndex.placeCollisionBox(b,so,No,new a.pointGeometry(0,0),He,re,O,Ie.predicate);return Oo&&Oo.box&&Oo.box.length&&(this.markUsedOrientation(b,Ns,tn),this.placedOrientations[$n]=Ns),Oo};Jr(()=>Tr(La,a.WritingMode.horizontal),()=>{const No=_n.verticalTextBox;return b.allowVerticalPlacement&&xn>0&&No?(oo(No),Tr(No,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),mo(yi&&yi.box&&yi.box.length)}}if(cr=yi,zn=cr&&cr.box&&cr.box.length>0,qt=cr&&cr.offscreen,gn=cr&&cr.occluded,tn.useRuntimeCollisionCircles){const mo=b.text.placedSymbolArray.get(tn.centerJustifiedTextSymbolIndex>=0?tn.centerJustifiedTextSymbolIndex:tn.verticalPlacedTextSymbolIndex),Jr=a.evaluateSizeForFeature(b.textSizeData,Be,mo),Tr=M.get("text-padding");Oi=this.collisionIndex.placeCollisionCircles(b,He,mo,b.lineVertexArray,b.glyphOffsetArray,Jr,O,F,q,p,Mt,Ie.predicate,tn.collisionCircleDiameter*Jr/a.ONE_EM,Tr,this.retainedQueryData[b.bucketInstanceId].tileID),zn=He||Oi.circles.length>0&&!Oi.collisionDetected,qt=qt&&Oi.offscreen,gn=Oi.occluded}if(_n.iconFeatureIndex&&(Gr=_n.iconFeatureIndex),_n.iconBox){const mo=Jr=>{oo(Jr);const Tr=jt&&ki?jo(ki.x,ki.y,St,Mt,this.transform.angle):new a.pointGeometry(0,0),No=b.getSymbolInstanceIconSize(je,this.transform.zoom,tn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,No,Jr,Tr,st,re,O,Ie.predicate)};Wi&&Wi.box&&Wi.box.length&&_n.verticalIconBox?(di=mo(_n.verticalIconBox),qn=di.box.length>0):(di=mo(_n.iconBox),qn=di.box.length>0),qt=qt&&di.offscreen,_i=di.occluded}const Ka=Le||0===tn.numHorizontalGlyphVertices&&0===xn,va=Ze||0===tn.numIconVertices;if(Ka||va?va?Ka||(qn=qn&&zn):zn=qn&&zn:qn=zn=qn&&zn,zn&&cr&&cr.box&&this.collisionIndex.insertCollisionBox(cr.box,M.get("text-ignore-placement"),b.bucketInstanceId,Wi&&Wi.box&&zr?zr:Qr,Ie.ID),qn&&di&&this.collisionIndex.insertCollisionBox(di.box,M.get("icon-ignore-placement"),b.bucketInstanceId,Gr,Ie.ID),Oi&&(zn&&this.collisionIndex.insertCollisionCircles(Oi.circles,M.get("text-ignore-placement"),b.bucketInstanceId,Qr,Ie.ID),p)){const mo=b.bucketInstanceId;let Jr=this.collisionCircleArrays[mo];void 0===Jr&&(Jr=this.collisionCircleArrays[mo]=new Io);for(let Tr=0;Tr<Oi.circles.length;Tr+=4)Jr.circles.push(Oi.circles[Tr+0]),Jr.circles.push(Oi.circles[Tr+1]),Jr.circles.push(Oi.circles[Tr+2]),Jr.circles.push(Oi.collisionDetected?1:0)}const jl="globe"!==b.projection.name;rn=rn&&(jl||!gn),Wt=Wt&&(jl||!_i),this.placements[$n]=new Dr(zn||rn,qn||Wt,qt||b.justReloaded),l[$n]=!0};if(un){const tn=b.getSortedSymbolIndexes(this.transform.angle);for(let In=tn.length-1;In>=0;--In){const _n=tn[In];Xn(b.symbolInstances.get(_n),_n,b.collisionArrays[_n])}}else for(let tn=t.symbolInstanceStart;tn<t.symbolInstanceEnd;tn++)Xn(b.symbolInstances.get(tn),tn,b.collisionArrays[tn]);if(p&&b.bucketInstanceId in this.collisionCircleArrays){const tn=this.collisionCircleArrays[b.bucketInstanceId];a.invert(tn.invProjMatrix,O),tn.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(t,l,p,_){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:F,crossTileID:q}=p,W=a.getAnchorJustification(l),re=_===a.WritingMode.vertical?F:"left"===W?b:"center"===W?M:"right"===W?O:-1;b>=0&&(t.text.placedSymbolArray.get(b).crossTileID=re>=0&&b!==re?0:q),M>=0&&(t.text.placedSymbolArray.get(M).crossTileID=re>=0&&M!==re?0:q),O>=0&&(t.text.placedSymbolArray.get(O).crossTileID=re>=0&&O!==re?0:q),F>=0&&(t.text.placedSymbolArray.get(F).crossTileID=re>=0&&F!==re?0:q)}markUsedOrientation(t,l,p){const _=l===a.WritingMode.horizontal||l===a.WritingMode.horizontalOnly?l:0,b=l===a.WritingMode.vertical?l:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:q}=p,W=t.text.placedSymbolArray;M>=0&&(W.get(M).placedOrientation=_),O>=0&&(W.get(O).placedOrientation=_),F>=0&&(W.get(F).placedOrientation=_),q>=0&&(W.get(q).placedOrientation=b)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let p=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const _=l?l.symbolFadeChange(t):1,b=l?l.opacities:{},M=l?l.variableOffsets:{},O=l?l.placedOrientations:{};for(const F in this.placements){const q=this.placements[F],W=b[F];W?(this.opacities[F]=new hs(W,_,q.text,q.icon,null,q.clipped),p=p||q.text!==W.text.placed||q.icon!==W.icon.placed):(this.opacities[F]=new hs(null,_,q.text,q.icon,q.skipFade,q.clipped),p=p||q.text||q.icon)}for(const F in b){const q=b[F];if(!this.opacities[F]){const W=new hs(q,_,!1,!1);W.isHidden()||(this.opacities[F]=W,p=p||q.text.placed||q.icon.placed)}}for(const F in M)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=M[F]);for(const F in O)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=O[F]);p?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:t)}updateLayerOpacities(t,l){const p={};for(const _ of l){const b=_.getBucket(t);b&&_.latestFeatureIndex&&t.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,_.collisionBoxArray)}}updateBucketOpacities(t,l,p){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const _=t.layers[0].layout,b=!!t.layers[0].dynamicFilter(),M=new hs(null,0,!1,!1,!0),O=_.get("text-allow-overlap"),F=_.get("icon-allow-overlap"),q=_.get("text-variable-anchor"),W="map"===_.get("text-rotation-alignment"),re="map"===_.get("text-pitch-alignment"),we="none"!==_.get("icon-text-fit"),Ue=new hs(null,0,O&&(F||!t.hasIconData()||_.get("icon-optional")),F&&(O||!t.hasTextData()||_.get("text-optional")),!0);!t.collisionArrays&&p&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(p);const Be=(Ie,Le,Ze)=>{for(let He=0;He<Le/4;He++)Ie.opacityVertexArray.emplaceBack(Ze)};let je=0;for(let Ie=0;Ie<t.symbolInstances.length;Ie++){const Le=t.symbolInstances.get(Ie),{numHorizontalGlyphVertices:Ze,numVerticalGlyphVertices:He,crossTileID:st,numIconVertices:St}=Le;let Mt=this.opacities[st];l[st]?Mt=M:Mt||(Mt=Ue,this.opacities[st]=Mt),l[st]=!0;const jt=Ze>0||He>0,un=St>0,rn=this.placedOrientations[st],Wt=rn===a.WritingMode.vertical,Xn=rn===a.WritingMode.horizontal||rn===a.WritingMode.horizontalOnly;if(!jt&&!un||Mt.isHidden()||je++,jt){const tn=io(Mt.text);Be(t.text,Ze,Wt?Ss:tn),Be(t.text,He,Xn?Ss:tn);const In=Mt.text.isHidden(),{leftJustifiedTextSymbolIndex:_n,centerJustifiedTextSymbolIndex:$n,rightJustifiedTextSymbolIndex:xn,verticalPlacedTextSymbolIndex:zn}=Le,qn=t.text.placedSymbolArray,qt=In||Wt?1:0;_n>=0&&(qn.get(_n).hidden=qt),$n>=0&&(qn.get($n).hidden=qt),xn>=0&&(qn.get(xn).hidden=qt),zn>=0&&(qn.get(zn).hidden=In||Xn?1:0);const gn=this.variableOffsets[st];gn&&this.markUsedJustification(t,gn.anchor,Le,rn);const _i=this.placedOrientations[st];_i&&(this.markUsedJustification(t,"left",Le,_i),this.markUsedOrientation(t,_i,Le))}if(un){const tn=io(Mt.icon),{placedIconSymbolIndex:In,verticalPlacedIconSymbolIndex:_n}=Le,$n=t.icon.placedSymbolArray,xn=Mt.icon.isHidden()?1:0;In>=0&&(Be(t.icon,St,Wt?Ss:tn),$n.get(In).hidden=xn),_n>=0&&(Be(t.icon,Le.numVerticalIconVertices,Xn?Ss:tn),$n.get(_n).hidden=xn)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const tn=t.collisionArrays[Ie];if(tn){let In=new a.pointGeometry(0,0),_n=!0;if(tn.textBox||tn.verticalTextBox){if(q){const xn=this.variableOffsets[st];xn?(In=Or(xn.anchor,xn.width,xn.height,xn.textOffset,xn.textScale),W&&In._rotate(re?this.transform.angle:-this.transform.angle)):_n=!1}b&&(_n=!Mt.clipped),tn.textBox&&dr(t.textCollisionBox.collisionVertexArray,Mt.text.placed,!_n||Wt,In.x,In.y),tn.verticalTextBox&&dr(t.textCollisionBox.collisionVertexArray,Mt.text.placed,!_n||Xn,In.x,In.y)}const $n=_n&&Boolean(!Xn&&tn.verticalIconBox);tn.iconBox&&dr(t.iconCollisionBox.collisionVertexArray,Mt.icon.placed,$n,we?In.x:0,we?In.y:0),tn.verticalIconBox&&dr(t.iconCollisionBox.collisionVertexArray,Mt.icon.placed,!$n,we?In.x:0,we?In.y:0)}}}if(t.fullyClipped=0===je,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=Ie.invProjMatrix,t.placementViewportMatrix=Ie.viewportMatrix,t.collisionCircleArray=Ie.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,l){const p=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function dr(u,t,l,p,_){u.emplaceBack(t?1:0,l?1:0,p||0,_||0),u.emplaceBack(t?1:0,l?1:0,p||0,_||0),u.emplaceBack(t?1:0,l?1:0,p||0,_||0),u.emplaceBack(t?1:0,l?1:0,p||0,_||0)}const ns=Math.pow(2,25),Co=Math.pow(2,24),lo=Math.pow(2,17),jr=Math.pow(2,16),fo=Math.pow(2,9),is=Math.pow(2,8),no=Math.pow(2,1);function io(u){if(0===u.opacity&&!u.placed)return 0;if(1===u.opacity&&u.placed)return 4294967295;const t=u.placed?1:0,l=Math.floor(127*u.opacity);return l*ns+t*Co+l*lo+t*jr+l*fo+t*is+l*no+t}const Ss=0;class As{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,l,p,_,b){const M=this._bucketParts;for(;this._currentTileIndex<t.length;)if(l.getBucketParts(M,_,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((O,F)=>O.sortKey-F.sortKey));this._currentPartIndex<M.length;){const O=M[this._currentPartIndex];if(l.placeLayerBucketPart(O,this._seenCrossTileIDs,p,0===O.symbolInstanceStart),this._currentPartIndex++,b())return!0}return!1}}class Wo{constructor(t,l,p,_,b,M,O,F){this.placement=new ys(t,b,M,O,F),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(t,l,p){const _=a.exported.now(),b=()=>{const M=a.exported.now()-_;return!this._forceFullPlacement&&M>2};for(;this._currentPlacementIndex>=0;){const M=l[t[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===M.type&&(!M.minzoom||M.minzoom<=O)&&(!M.maxzoom||M.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new As(M)),this._inProgressLayer.continuePlacement(p[M.source],this.placement,this._showCollisionBoxes,M,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const pa=512/a.EXTENT/2;class Qs{constructor(t,l,p){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let _=0;_<l.length;_++){const b=l.get(_),M=b.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,t)})}}getScaledCoordinates(t,l){const p=pa/Math.pow(2,l.canonical.z-this.tileID.canonical.z);return{x:Math.floor((l.canonical.x*a.EXTENT+t.tileAnchorX)*p),y:Math.floor((l.canonical.y*a.EXTENT+t.tileAnchorY)*p)}}findMatches(t,l,p){const _=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z);for(let b=0;b<t.length;b++){const M=t.get(b);if(M.crossTileID)continue;const O=this.indexedSymbolInstances[M.key];if(!O)continue;const F=this.getScaledCoordinates(M,l);for(const q of O)if(Math.abs(q.coord.x-F.x)<=_&&Math.abs(q.coord.y-F.y)<=_&&!p[q.crossTileID]){p[q.crossTileID]=!0,M.crossTileID=q.crossTileID;break}}}}class Ca{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ma{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const l=Math.round((t-this.lng)/360);if(0!==l)for(const p in this.indexes){const _=this.indexes[p],b={};for(const M in _){const O=_[M];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+l),b[O.tileID.key]=O}this.indexes[p]=b}this.lng=t}addBucket(t,l,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let b=0;b<l.symbolInstances.length;b++)l.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const _=this.usedCrossTileIDs[t.overscaledZ];for(const b in this.indexes){const M=this.indexes[b];if(Number(b)>t.overscaledZ)for(const O in M){const F=M[O];F.tileID.isChildOf(t)&&F.findMatches(l.symbolInstances,t,_)}else{const O=M[t.scaledTo(Number(b)).key];O&&O.findMatches(l.symbolInstances,t,_)}}for(let b=0;b<l.symbolInstances.length;b++){const M=l.symbolInstances.get(b);M.crossTileID||(M.crossTileID=p.generate(),_[M.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Qs(t,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(t,l){for(const p in l.indexedSymbolInstances)for(const _ of l.indexedSymbolInstances[p])delete this.usedCrossTileIDs[t][_.crossTileID]}removeStaleBuckets(t){let l=!1;for(const p in this.indexes){const _=this.indexes[p];for(const b in _)t[_[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[b]),delete _[b],l=!0)}return l}}class Is{constructor(){this.layerIndexes={},this.crossTileIDs=new Ca,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,l,p,_){let b=this.layerIndexes[t.id];void 0===b&&(b=this.layerIndexes[t.id]=new Ma);let M=!1;const O={};"globe"!==_.name&&b.handleWrapJump(p);for(const F of l){const q=F.getBucket(t);q&&t.id===q.layerIds[0]&&(q.bucketInstanceId||(q.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(F.tileID,q,this.crossTileIDs)&&(M=!0),O[q.bucketInstanceId]=!0)}return b.removeStaleBuckets(O)&&(M=!0),M}pruneUnusedLayers(t){const l={};t.forEach(p=>{l[p]=!0});for(const p in this.layerIndexes)l[p]||delete this.layerIndexes[p]}}const Js=(u,t)=>a.emitValidationErrors(u,t&&t.filter(l=>"source.canvas"!==l.identifier)),Ps=a.pick(hi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Os=a.pick(hi,["setCenter","setZoom","setBearing","setPitch"]),rs={version:8,layers:[],sources:{}},Va={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class yo extends a.Evented{constructor(t,l={}){super(),this.map=t,this.dispatcher=new Bt(gi(),this),this.imageManager=new mt,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(t._requestManager,l.localFontFamily?a.LocalGlyphMode.all:l.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,l.localFontFamily||l.localIdeographFontFamily),this.crossTileSymbolIndex=new Is,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const p=this;this._rtlTextPluginCallback=yo.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(b,M)=>{if(a.triggerPluginCompletionEvent(b),M&&M.every(O=>O))for(const O in p._sourceCaches){const F=p._sourceCaches[O],q=F.getSource().type;"vector"!==q&&"geojson"!==q||F.reload()}})}),this.on("data",_=>{if("source"!==_.dataType||"metadata"!==_.sourceDataType)return;const b=this.getSource(_.sourceId);if(b&&b.vectorLayerIds)for(const M in this._layers){const O=this._layers[M];O.source===b.id&&this._validateLayer(O)}})}loadURL(t,l={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof l.validate?l.validate:!a.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,l.accessToken);const _=this.map._requestManager.transformRequest(t,a.ResourceType.Style);this._request=a.getJSON(_,(b,M)=>{this._request=null,b?this.fire(new a.ErrorEvent(b)):M&&this._load(M,p)})}loadJSON(t,l={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(t,!1!==l.validate)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(rs,!1)}_updateLayerCount(t,l){const p=l?1:-1;t.is3D()&&(this._num3DLayers+=p),"circle"===t.type&&(this._numCircleLayers+=p),"symbol"===t.type&&(this._numSymbolLayers+=p)}_load(t,l){if(l&&Js(this,a.validateStyle(t)))return;this._loaded=!0,this.stylesheet=a.clone$1(t),this._updateMapProjection();for(const _ in t.sources)this.addSource(_,t.sources[_],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const p=ji(this.stylesheet.layers);this._order=p.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of p)_=a.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize(),this._updateLayerCount(_,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Cn(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(l,p,_){let b,M,O;const F=a.exported.devicePixelRatio>1?"@2x":"";let q=a.getJSON(p.transformRequest(p.normalizeSpriteURL(l,F,".json"),a.ResourceType.SpriteJSON),(we,Ue)=>{q=null,O||(O=we,b=Ue,re())}),W=a.getImage(p.transformRequest(p.normalizeSpriteURL(l,F,".png"),a.ResourceType.SpriteImage),(we,Ue)=>{W=null,O||(O=we,M=Ue,re())});function re(){if(O)_(O);else if(b&&M){const we=a.exported.getImageData(M),Ue={};for(const Be in b){const{width:je,height:Ie,x:Le,y:Ze,sdf:He,pixelRatio:st,stretchX:St,stretchY:Mt,content:jt}=b[Be],un=new a.RGBAImage({width:je,height:Ie});a.RGBAImage.copy(we,un,{x:Le,y:Ze},{x:0,y:0},{width:je,height:Ie}),Ue[Be]={data:un,pixelRatio:st,sdf:He,stretchX:St,stretchY:Mt,content:jt}}_(null,Ue)}}return{cancel(){q&&(q.cancel(),q=null),W&&(W.cancel(),W=null)}}}(t,this.map._requestManager,(l,p)=>{if(this._spriteRequest=null,l)this.fire(new a.ErrorEvent(l));else if(p)for(const _ in p)this.imageManager.addImage(_,p[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(t){const l=this.getSource(t.source);if(!l)return;const p=t.sourceLayer;p&&("geojson"===l.type||l.vectorLayerIds&&-1===l.vectorLayerIds.indexOf(p))&&this.fire(new a.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${l.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const l=[];for(const p of t){const _=this._layers[p];"custom"!==_.type&&l.push(_.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&Va[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const l=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(_.length||b.length)&&this._updateWorkerLayers(_,b);for(const M in this._updatedSources){const O=this._updatedSources[M];"reload"===O?this._reloadSource(M):"clear"===O&&this._clearSource(M)}this._updateTilesForChangedImages();for(const M in this._updatedPaintProps)this._layers[M].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const p={};for(const _ in this._sourceCaches){const b=this._sourceCaches[_];p[_]=b.used,b.used=!1}for(const _ of this._order){const b=this._layers[_];if(b.recalculate(t,this._availableImages),!b.isHidden(t.zoom)){const O=this._getLayerSourceCache(b);O&&(O.used=!0)}const M=this.map.painter;if(M){const O=b.getProgramIds();if(!O)continue;const F=b.getProgramConfiguration(t.zoom);for(const q of O)M.useProgram(q,F)}}for(const _ in p){const b=this._sourceCaches[_];p[_]!==b.used&&b.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:l})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),Js(this,a.validateStyle(t)))return!1;(t=a.clone$1(t)).layers=ji(t.layers);const l=function(_,b){if(!_)return[{command:hi.setStyle,args:[b]}];let M=[];try{if(!de(_.version,b.version))return[{command:hi.setStyle,args:[b]}];de(_.center,b.center)||M.push({command:hi.setCenter,args:[b.center]}),de(_.zoom,b.zoom)||M.push({command:hi.setZoom,args:[b.zoom]}),de(_.bearing,b.bearing)||M.push({command:hi.setBearing,args:[b.bearing]}),de(_.pitch,b.pitch)||M.push({command:hi.setPitch,args:[b.pitch]}),de(_.sprite,b.sprite)||M.push({command:hi.setSprite,args:[b.sprite]}),de(_.glyphs,b.glyphs)||M.push({command:hi.setGlyphs,args:[b.glyphs]}),de(_.transition,b.transition)||M.push({command:hi.setTransition,args:[b.transition]}),de(_.light,b.light)||M.push({command:hi.setLight,args:[b.light]}),de(_.fog,b.fog)||M.push({command:hi.setFog,args:[b.fog]}),de(_.projection,b.projection)||M.push({command:hi.setProjection,args:[b.projection]});const O={},F=[];!function(re,we,Ue,Be){let je;for(je in we=we||{},re=re||{})re.hasOwnProperty(je)&&(we.hasOwnProperty(je)||ir(je,Ue,Be));for(je in we)we.hasOwnProperty(je)&&(re.hasOwnProperty(je)?de(re[je],we[je])||("geojson"===re[je].type&&"geojson"===we[je].type&&kr(re,we,je)?Ue.push({command:hi.setGeoJSONSourceData,args:[je,we[je].data]}):Ki(je,we,Ue,Be)):Yi(je,we,Ue))}(_.sources,b.sources,F,O);const q=[];_.layers&&_.layers.forEach(re=>{re.source&&O[re.source]?M.push({command:hi.removeLayer,args:[re.id]}):q.push(re)});let W=_.terrain;W&&O[W.source]&&(M.push({command:hi.setTerrain,args:[void 0]}),W=void 0),M=M.concat(F),de(W,b.terrain)||M.push({command:hi.setTerrain,args:[b.terrain]}),function(re,we,Ue){we=we||[];const Be=(re=re||[]).map(pn),je=we.map(pn),Ie=re.reduce(qr,{}),Le=we.reduce(qr,{}),Ze=Be.slice(),He=Object.create(null);let st,St,Mt,jt,un,rn,Wt;for(st=0,St=0;st<Be.length;st++)Mt=Be[st],Le.hasOwnProperty(Mt)?St++:(Ue.push({command:hi.removeLayer,args:[Mt]}),Ze.splice(Ze.indexOf(Mt,St),1));for(st=0,St=0;st<je.length;st++)Mt=je[je.length-1-st],Ze[Ze.length-1-st]!==Mt&&(Ie.hasOwnProperty(Mt)?(Ue.push({command:hi.removeLayer,args:[Mt]}),Ze.splice(Ze.lastIndexOf(Mt,Ze.length-St),1)):St++,rn=Ze[Ze.length-st],Ue.push({command:hi.addLayer,args:[Le[Mt],rn]}),Ze.splice(Ze.length-st,0,Mt),He[Mt]=!0);for(st=0;st<je.length;st++)if(Mt=je[st],jt=Ie[Mt],un=Le[Mt],!He[Mt]&&!de(jt,un))if(de(jt.source,un.source)&&de(jt["source-layer"],un["source-layer"])&&de(jt.type,un.type)){for(Wt in Cr(jt.layout,un.layout,Ue,Mt,null,hi.setLayoutProperty),Cr(jt.paint,un.paint,Ue,Mt,null,hi.setPaintProperty),de(jt.filter,un.filter)||Ue.push({command:hi.setFilter,args:[Mt,un.filter]}),de(jt.minzoom,un.minzoom)&&de(jt.maxzoom,un.maxzoom)||Ue.push({command:hi.setLayerZoomRange,args:[Mt,un.minzoom,un.maxzoom]}),jt)jt.hasOwnProperty(Wt)&&"layout"!==Wt&&"paint"!==Wt&&"filter"!==Wt&&"metadata"!==Wt&&"minzoom"!==Wt&&"maxzoom"!==Wt&&(0===Wt.indexOf("paint.")?Cr(jt[Wt],un[Wt],Ue,Mt,Wt.slice(6),hi.setPaintProperty):de(jt[Wt],un[Wt])||Ue.push({command:hi.setLayerProperty,args:[Mt,Wt,un[Wt]]}));for(Wt in un)un.hasOwnProperty(Wt)&&!jt.hasOwnProperty(Wt)&&"layout"!==Wt&&"paint"!==Wt&&"filter"!==Wt&&"metadata"!==Wt&&"minzoom"!==Wt&&"maxzoom"!==Wt&&(0===Wt.indexOf("paint.")?Cr(jt[Wt],un[Wt],Ue,Mt,Wt.slice(6),hi.setPaintProperty):de(jt[Wt],un[Wt])||Ue.push({command:hi.setLayerProperty,args:[Mt,Wt,un[Wt]]}))}else Ue.push({command:hi.removeLayer,args:[Mt]}),rn=Ze[Ze.lastIndexOf(Mt)+1],Ue.push({command:hi.addLayer,args:[un,rn]})}(q,b.layers,M)}catch(O){console.warn("Unable to compute style diff:",O),M=[{command:hi.setStyle,args:[b]}]}return M}(this.serialize(),t).filter(_=>!(_.command in Os));if(0===l.length)return!1;const p=l.filter(_=>!(_.command in Ps));if(p.length>0)throw new Error(`Unimplemented: ${p.map(_=>_.command).join(", ")}.`);return l.forEach(_=>{"setTransition"!==_.command&&"setProjection"!==_.command&&this[_.command].apply(this,_.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,l){return this.getImage(t)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,l),this._afterImageUpdated(t),this)}updateImage(t,l){this.imageManager.updateImage(t,l)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,l,p={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(a.validateSource,`sources.${t}`,l,null,p))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const _=fe(t,l,this.dispatcher,this);_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:_.serialize(),sourceId:t}));const b=M=>{const O=(M?"symbol:":"other:")+t,F=this._sourceCaches[O]=new a.SourceCache(O,_,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[t]=F,F.style=this,F.onAdd(this.map)};b(!1),"vector"!==l.type&&"geojson"!==l.type||b(!0),_.onAdd&&_.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const l=this.getSource(t);if(!l)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===t)return this.fire(new a.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new a.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(t);for(const _ of p)delete this._sourceCaches[_.id],delete this._updatedSources[_.id],_.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,l){this._checkLoaded(),this.getSource(t).setData(l),this._changed=!0}getSource(t){const l=this._getSourceCache(t);return l&&l.getSource()}_getSources(){const t=[];for(const l in this._otherSourceCaches){const p=this._getSourceCache(l);p&&t.push(p.getSource())}return t}addLayer(t,l,p={}){this._checkLoaded();const _=t.id;if(this.getLayer(_))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${_}" already exists on this map`)));let b;if("custom"===t.type){if(Js(this,a.validateCustomStyleLayer(t)))return;b=a.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(_,t.source),t=a.clone$1(t),t=a.extend(t,{source:_})),this._validate(a.validateLayer,`layers.${_}`,t,{arrayIndex:-1},p))return;b=a.createStyleLayer(t),this._validateLayer(b),b.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const M=l?this._order.indexOf(l):this._order.length;if(l&&-1===M)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`)));this._order.splice(M,0,_),this._layerOrderChanged=!0,this._layers[_]=b;const O=this._getLayerSourceCache(b);if(this._removedLayers[_]&&b.source&&O&&"custom"!==b.type){const F=this._removedLayers[_];delete this._removedLayers[_],F.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",O.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,l){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===l)return;const p=this._order.indexOf(t);this._order.splice(p,1);const _=l?this._order.indexOf(l):this._order.length;l&&-1===_?this.fire(new a.ErrorEvent(new Error(`Layer with id "${l}" does not exist on this map.`))):(this._order.splice(_,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const l=this._layers[t];if(!l)return void this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));l.setEventedParent(null),this._updateLayerCount(l,!1);const p=this._order.indexOf(t);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=l,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],l.onRemove&&l.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const l in this._layers)if(this._layers[l].type===t)return!0;return!1}setLayerZoomRange(t,l,p){this._checkLoaded();const _=this.getLayer(t);_?_.minzoom===l&&_.maxzoom===p||(null!=l&&(_.minzoom=l),null!=p&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,l,p={}){this._checkLoaded();const _=this.getLayer(t);if(_){if(!de(_.filter,l))return null==l?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(a.validateFilter,`layers.${_.id}.filter`,l,{layerType:_.type},p)||(_.filter=a.clone$1(l),this._updateLayer(_)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const l=this.getLayer(t);return l&&a.clone$1(l.filter)}setLayoutProperty(t,l,p,_={}){this._checkLoaded();const b=this.getLayer(t);b?de(b.getLayoutProperty(l),p)||(b.setLayoutProperty(l,p,_),this._updateLayer(b)):this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,l){const p=this.getLayer(t);if(p)return p.getLayoutProperty(l);this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,l,p,_={}){this._checkLoaded();const b=this.getLayer(t);b?de(b.getPaintProperty(l),p)||(b.setPaintProperty(l,p,_)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,l){const p=this.getLayer(t);return p&&p.getPaintProperty(l)}setFeatureState(t,l){this._checkLoaded();const p=t.source,_=t.sourceLayer,b=this.getSource(p);if(!b)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const M=b.type;if("geojson"===M&&_)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!_)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(p);for(const F of O)F.setFeatureState(_,t.id,l)}removeFeatureState(t,l){this._checkLoaded();const p=t.source,_=this.getSource(p);if(!_)return void this.fire(new a.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=_.type,M="vector"===b?t.sourceLayer:void 0;if("vector"===b&&!M)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(p);for(const F of O)F.removeFeatureState(M,t.id,l)}getFeatureState(t){this._checkLoaded();const l=t.source,p=t.sourceLayer,_=this.getSource(l);if(_){if("vector"!==_.type||p)return void 0===t.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(l)[0].getFeatureState(p,t.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${l}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const l in this._sourceCaches){const p=this._sourceCaches[l].getSource();t[p.id]||(t[p.id]=p.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},l=>void 0!==l)}_updateLayer(t){this._updatedLayers[t.id]=!0;const l=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&l&&"raster"!==l.getSource().type&&(this._updatedSources[t.source]="reload",l.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const l=M=>"fill-extrusion"===this._layers[M].type,p={},_=[];for(let M=this._order.length-1;M>=0;M--){const O=this._order[M];if(l(O)){p[O]=M;for(const F of t){const q=F[O];if(q)for(const W of q)_.push(W)}}}_.sort((M,O)=>O.intersectionZ-M.intersectionZ);const b=[];for(let M=this._order.length-1;M>=0;M--){const O=this._order[M];if(l(O))for(let F=_.length-1;F>=0;F--){const q=_[F].feature;if(p[q.layer.id]<M)break;b.push(q),_.pop()}else for(const F of t){const q=F[O];if(q)for(const W of q)b.push(W.feature)}}return b}queryRenderedFeatures(t,l,p){l&&l.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",l.filter,null,l);const _={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of l.layers){const q=this._layers[F];if(!q)return this.fire(new a.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];_[q.source]=!0}}const b=[];l.availableImages=this._availableImages;const M=l&&l.layers?l.layers.some(F=>{const q=this.getLayer(F);return q&&q.is3D()}):this.has3DLayers(),O=nn.createFromScreenPoints(t,p);for(const F in this._sourceCaches){const q=this._sourceCaches[F].getSource().id;l.layers&&!_[q]||b.push(ge(this._sourceCaches[F],this._layers,this._serializedLayers,O,l,p,M,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(F,q,W,re,we,Ue,Be){const je={},Ie=Ue.queryRenderedSymbols(re),Le=[];for(const Ze of Object.keys(Ie).map(Number))Le.push(Be[Ze]);Le.sort(en);for(const Ze of Le){const He=Ze.featureIndex.lookupSymbolFeatures(Ie[Ze.bucketInstanceId],q,Ze.bucketIndex,Ze.sourceLayerIndex,we.filter,we.layers,we.availableImages,F);for(const st in He){const St=je[st]=je[st]||[],Mt=He[st];Mt.sort((jt,un)=>{const rn=Ze.featureSortOrder;if(rn){const Wt=rn.indexOf(jt.featureIndex);return rn.indexOf(un.featureIndex)-Wt}return un.featureIndex-jt.featureIndex});for(const jt of Mt)St.push(jt)}}for(const Ze in je)je[Ze].forEach(He=>{const st=He.feature,St=W(F[Ze]).getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=St});return je}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(t,l){l&&l.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",l.filter,null,l);const p=this._getSourceCaches(t);let _=[];for(const b of p)_=_.concat(ut(b,l));return _}addSourceType(t,l,p){return yo.getSourceType(t)?p(new Error(`A source type called "${t}" already exists.`)):(yo.setSourceType(t,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:l.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(t,l={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const M in t)if(!de(t[M],p[M])){_=!0;break}if(!_)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,l),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,l=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===l){if("object"==typeof t.source){const p="terrain-dem-src";this.addSource(p,t.source),t=a.clone$1(t),t=a.extend(t,{source:p})}if(this._validate(a.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&l!==this.terrain.drapeRenderMode)this._createTerrain(t,l);else{const p=this.terrain,_=p.get();for(const b of Object.keys(a.spec.terrain))!t.hasOwnProperty(b)&&a.spec.terrain[b].default&&(t[b]=a.spec.terrain[b].default);for(const b in t)if(!de(t[b],_[b])){p.set(t),this.stylesheet.terrain=t;const M=this._setTransitionParameters({duration:0});p.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const l=this.fog=new Ci(t,this.map.transform);this.stylesheet.fog=t;const p=this._setTransitionParameters({duration:0});l.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog,p=l.get();0===Object.keys(t).length&&l.set(t);for(const _ in t)if(!de(t[_],p[_])){l.set(t),this.stylesheet.fog=t;const b=this._setTransitionParameters({duration:0});l.updateTransitions(b);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:a.exported.now(),transition:a.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(p=>this.isLayerDraped(this._layers[p])),l=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...l)}_createTerrain(t,l){const p=this.terrain=new Et(t,l);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const _=this._setTransitionParameters({duration:0});p.updateTransitions(_)}_force3DLayerUpdate(){for(const t in this._layers){const l=this._layers[t];"fill-extrusion"===l.type&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const l=this._layers[t];"symbol"===l.type&&this._updateLayer(l)}}_validate(t,l,p,_,b={}){return(!b||!1!==b.validate)&&Js(this,t.call(a.validateStyle,a.extend({key:l,style:this.serialize(),value:p,styleSpec:a.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const l=this._getSourceCaches(t);for(const p of l)p.clearTiles()}_reloadSource(t){const l=this._getSourceCaches(t);for(const p of l)p.resume(),p.reload()}_reloadSources(){for(const t of this._getSources())t.reload&&t.reload()}_updateSources(t){for(const l in this._sourceCaches)this._sourceCaches[l].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const l=this._sourceCaches[t];l.resume(),l.reload()}}_updatePlacement(t,l,p,_,b=!1){let M=!1,O=!1;const F={};for(const q of this._order){const W=this._layers[q];if("symbol"!==W.type)continue;if(!F[W.source]){const we=this._getLayerSourceCache(W);if(!we)continue;F[W.source]=we.getRenderableIds(!0).map(Ue=>we.getTileByID(Ue)).sort((Ue,Be)=>Be.tileID.overscaledZ-Ue.tileID.overscaledZ||(Ue.tileID.isLessThan(Be.tileID)?-1:1))}const re=this.crossTileSymbolIndex.addLayer(W,F[W.source],t.center.lng,t.projection);M=M||re}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),t.zoom))&&(this.pauseablePlacement=new Wo(t,this._order,b,l,p,_,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),O=!0),M&&this.pauseablePlacement.placement.setStale()),O||M)for(const q of this._order){const W=this._layers[q];"symbol"===W.type&&this.placement.updateLayerOpacities(W,F[W.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,l,p){this.imageManager.getImages(l.icons,p),this._updateTilesForChangedImages();const _=b=>{b&&b.setDependencies(l.tileID.key,l.type,l.icons)};_(this._otherSourceCaches[l.source]),_(this._symbolSourceCaches[l.source])}getGlyphs(t,l,p){this.glyphManager.getGlyphs(l.stacks,p)}getResource(t,l,p){return a.makeRequest(l,p)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const l=[];return this._otherSourceCaches[t]&&l.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&l.push(this._symbolSourceCaches[t]),l}_isSourceCacheLoaded(t){const l=this._getSourceCaches(t);return 0===l.length?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):l.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}yo.getSourceType=function(u){return xe[u]},yo.setSourceType=function(u,t){xe[u]=t},yo.registerForPluginStateChange=a.registerForPluginStateChange;var fa="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",vs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ma="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",ja="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ea="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let ta={},Ur={};const ps=[];ko(fa,ps),ko(ma,ps),ko(ja,ps),ko(ea,ps),ta=fr("",ma),Ur=fr(ea,ja);const fs=fr("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),na=fa,ga="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ia={background:fr("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:fr("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:fr("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:fr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:fr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:fr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:fr("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:fr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:fr("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:fr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:fr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:fr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:fr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:fr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:fr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:fr("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:fr("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vs),skyboxGradient:fr("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vs),skyboxCapture:fr("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:fr("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function ko(u,t){const l=u.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of l)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=p.split(" ");for(const b of _)t.includes(b)||t.push(b)}}function fr(u,t){const l=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),_={},b=[...ps];return ko(u,b),ko(t,b),{fragmentSource:u=u.replace(l,(M,O,F,q,W)=>(_[W]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nvarying ${F} ${q} ${W};\n#else\nuniform ${F} ${q} u_${W};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${W}\n    ${F} ${q} ${W} = u_${W};\n#endif\n`)),vertexSource:t=t.replace(l,(M,O,F,q,W)=>{const re="float"===q?"vec2":"vec4",we=W.match(/color/)?"color":re;return _[W]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${F} ${re} a_${W};\nvarying ${F} ${q} ${W};\n#else\nuniform ${F} ${q} u_${W};\n#endif\n`:"vec4"===we?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = a_${W};\n#else\n    ${F} ${q} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${W} = unpack_mix_${we}(a_${W}, u_${W}_t);\n#else\n    ${F} ${q} ${W} = u_${W};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${W}\nuniform lowp float u_${W}_t;\nattribute ${F} ${re} a_${W};\n#else\nuniform ${F} ${q} u_${W};\n#endif\n`:"vec4"===we?`\n#ifndef HAS_UNIFORM_u_${W}\n    ${F} ${q} ${W} = a_${W};\n#else\n    ${F} ${q} ${W} = u_${W};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${W}\n    ${F} ${q} ${W} = unpack_mix_${we}(a_${W}, u_${W}_t);\n#else\n    ${F} ${q} ${W} = u_${W};\n#endif\n`}),staticAttributes:p,usedDefines:b}}class gl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,l,p,_,b,M,O){this.context=t;let F=this.boundPaintVertexBuffers.length!==_.length;for(let W=0;!F&&W<_.length;W++)this.boundPaintVertexBuffers[W]!==_[W]&&(F=!0);let q=this.boundDynamicVertexBuffers.length!==O.length;for(let W=0;!q&&W<O.length;W++)this.boundDynamicVertexBuffers[W]!==O[W]&&(q=!0);if(!t.extVertexArrayObject||!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==p||F||q||this.boundIndexBuffer!==b||this.boundVertexOffset!==M)this.freshBind(l,p,_,b,M,O);else{t.bindVertexArrayOES.set(this.vao);for(const W of O)W&&W.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(t,l,p,_,b,M){let O;const F=t.numAttributes,q=this.context,W=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=t,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=M;else{O=q.currentNumAttributes||0;for(let re=F;re<O;re++)W.disableVertexAttribArray(re)}l.enableAttributes(W,t),l.bind(),l.setVertexAttribPointers(W,t,b);for(const re of p)re.enableAttributes(W,t),re.bind(),re.setVertexAttribPointers(W,t,b);for(const re of M)re&&(re.enableAttributes(W,t),re.bind(),re.setVertexAttribPointers(W,t,b));_&&_.bind(),q.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function bs(u,t){const l=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new a.MercatorCoordinate(0,p/l).toLngLat().lat,new a.MercatorCoordinate(0,(p+1)/l).toLngLat().lat]}function Da(u,t,l,p,_,b,M){const O=u.context,F=O.gl,q=l.fbo;if(!q)return;u.prepareDrawTile();const W=u.useProgram("hillshade");O.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,q.colorAttachment.get());const re=((je,Ie,Le,Ze)=>{const He=Le.paint.get("hillshade-shadow-color"),st=Le.paint.get("hillshade-highlight-color"),St=Le.paint.get("hillshade-accent-color");let Mt=Le.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Le.paint.get("hillshade-illumination-anchor")&&(Mt-=je.transform.angle);const jt=!je.options.moving;return{u_matrix:Ze||je.transform.calculateProjMatrix(Ie.tileID.toUnwrapped(),jt),u_image:0,u_latrange:bs(0,Ie.tileID),u_light:[Le.paint.get("hillshade-exaggeration"),Mt],u_shadow:He,u_highlight:st,u_accent:St}})(u,l,p,u.terrain?t.projMatrix:null);u.prepareDrawProgram(O,W,t.toUnwrapped());const{tileBoundsBuffer:we,tileBoundsIndexBuffer:Ue,tileBoundsSegments:Be}=u.getTileBoundsBuffers(l);W.draw(O,F.TRIANGLES,_,b,M,a.CullFaceMode.disabled,re,p.id,we,Ue,Be)}function co(u,t,l){if(!t.needsDEMTextureUpload)return;const p=u.context,_=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||u.getTileTexture(l.stride);const b=l.getPixels();t.demTexture?t.demTexture.update(b,{premultiply:!1}):t.demTexture=new a.Texture(p,b,_.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function $s(u,t,l,p,_,b){const M=u.context,O=M.gl;if(!t.dem)return;const F=t.dem;if(M.activeTexture.set(O.TEXTURE1),co(u,t,F),!t.demTexture)return;t.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const q=F.dim;M.activeTexture.set(O.TEXTURE0);let W=t.fbo;if(!W){const Be=new a.Texture(M,{width:q,height:q,data:null},O.RGBA);Be.bind(O.LINEAR,O.CLAMP_TO_EDGE),W=t.fbo=M.createFramebuffer(q,q,!0),W.colorAttachment.set(Be.texture)}M.bindFramebuffer.set(W.framebuffer),M.viewport.set([0,0,q,q]);const{tileBoundsBuffer:re,tileBoundsIndexBuffer:we,tileBoundsSegments:Ue}=u.getMercatorTileBoundsBuffers();u.useProgram("hillshadePrepare").draw(M,O.TRIANGLES,p,_,b,a.CullFaceMode.disabled,((Be,je)=>{const Ie=je.stride,Le=a.create();return a.ortho(Le,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Le,Le,[0,-a.EXTENT,0]),{u_matrix:Le,u_image:1,u_dimension:[Ie,Ie],u_zoom:Be.overscaledZ,u_unpack:je.unpackVector}})(t.tileID,F),l.id,re,we,Ue),t.needsHillshadePrepare=!1}const xs=u=>({u_matrix:new a.UniformMatrix4f(u),u_image0:new a.Uniform1i(u),u_skirt_height:new a.Uniform1f(u)}),Pt=(u,t)=>({u_matrix:u,u_image0:0,u_skirt_height:t}),bt=(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue)=>({u_proj_matrix:Float32Array.from(u),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:l,u_zoom_transition:_,u_merc_center:b,u_image0:0,u_frustum_tl:M,u_frustum_tr:O,u_frustum_br:F,u_frustum_bl:q,u_globe_pos:W,u_globe_radius:re,u_viewport:we,u_grid_matrix:Ue?Float32Array.from(Ue):new Float32Array(9)});function ce(u,t){return null!=u&&null!=t&&!(!u.hasData()||!t.hasData())&&null!=u.demTexture&&null!=t.demTexture&&u.tileID.key!==t.tileID.key}const Ke=new class{constructor(){this.operations={}}newMorphing(u,t,l,p,_){if(u in this.operations){const b=this.operations[u];b.to.tileID.key!==l.tileID.key&&(b.queued=l)}else this.operations[u]={startTime:p,phase:0,duration:_,from:t,to:l,queued:null}}getMorphValuesForProxy(u){if(!(u in this.operations))return null;const t=this.operations[u];return{from:t.from,to:t.to,phase:t.phase}}update(u){for(const t in this.operations){const l=this.operations[t];for(l.phase=(u-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,u)){delete this.operations[t];break}}}_nextOp(u,t){return!!u.queued&&(u.from=u.to,u.to=u.queued,u.queued=null,u.phase=0,u.startTime=t,!0)}_validOp(u){return u.from.hasData()&&u.to.hasData()}},Nt={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Bn(u,t){const l=1<<u.z;return!t&&(0===u.x||u.x===l-1)||0===u.y||u.y===l-1}const xi=u=>({u_matrix:u});function si(u,t,l,p,_){if(_>0){const b=a.exported.now(),M=(b-u.timeAdded)/_,O=t?(b-t.timeAdded)/_:-1,F=l.getSource(),q=p.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),W=!t||Math.abs(t.tileID.overscaledZ-q)>Math.abs(u.tileID.overscaledZ-q),re=W&&u.refreshedUponExpiration?1:a.clamp(W?M:1-O,0,1);return u.refreshedUponExpiration&&M>=1&&(u.refreshedUponExpiration=!1),t?{opacity:1,mix:1-re}:{opacity:re,mix:0}}return{opacity:1,mix:0}}class pi extends a.SourceCache{constructor(t){const l={type:"raster-dem",maxzoom:t.transform.maxZoom},p=new Bt(gi(),null),_=fe("mock-dem",l,p,t.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,l){t.state="loaded",l(null)}}class Vr extends a.SourceCache{constructor(t){const l=fe("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Bt(gi(),null),t.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,l,p){if(t.freezeTileCoverage)return;this.transform=t;const _=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,M)=>{if(b[M.key]="",!this._tiles[M.key]){const O=new a.Tile(M,this._source.tileSize*M.overscaleFactor(),t.tileZoom);O.state="loaded",this._tiles[M.key]=O}return b},{});for(const b in this._tiles)b in _||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(t){const l=this.proxyCachedFBO[t];if(void 0!==l){const p=Object.values(l);this.renderCachePool.push(...p),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ho extends a.OverscaledTileID{constructor(t,l,p){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=l,this.projMatrix=p}}class Mo extends a.Elevation{constructor(t,l){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,_,b]=function(F){const q=new a.StructArrayLayout4i8,W=new a.StructArrayLayout3ui6;q.reserve(17161),W.reserve(33800);const we=a.EXTENT/128,Ue=a.EXTENT+we/2,Be=Ue+we;for(let Ie=-we;Ie<Be;Ie+=we)for(let Le=-we;Le<Be;Le+=we){const Ze=Le<0||Le>Ue||Ie<0||Ie>Ue?24575:0,He=a.clamp(Math.round(Le),0,a.EXTENT),st=a.clamp(Math.round(Ie),0,a.EXTENT);q.emplaceBack(He+Ze,st,He,st)}const je=(Ie,Le)=>{const Ze=131*Le+Ie;W.emplaceBack(Ze+1,Ze,Ze+131),W.emplaceBack(Ze+131,Ze+131+1,Ze+1)};for(let Ie=1;Ie<129;Ie++)for(let Le=1;Le<129;Le++)je(Le,Ie);return[0,129].forEach(Ie=>{for(let Le=0;Le<130;Le++)je(Le,Ie),je(Ie,Le)}),[q,W,32768]}(),M=t.context;this.gridBuffer=M.createVertexBuffer(p,a.boundsAttributes.members),this.gridIndexBuffer=M.createIndexBuffer(_),this.gridSegments=a.SegmentVector.simpleSegment(0,0,p.length,_.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,p.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Vr(l.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,a.EXTENT,0,a.EXTENT,0,1);const O=M.gl;this._overlapStencilMode=new a.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new pi(l.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,l,p){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const _=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(_.get("source")),this._exaggeration=_.get("exaggeration");const b=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const M=this.getScaledDemTileSize();this.sourceCache.update(l,M,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),l.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&a.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=l.getIds().map(F=>{const q=l.getTileByID(F).tileID;return q.projMatrix=p.calculateProjMatrix(q.toUnwrapped()),q});(function(F,q){const W=q.transform.pointCoordinate(q.transform.getCameraPoint()),re=new a.pointGeometry(W.x,W.y);F.sort((we,Ue)=>{if(Ue.overscaledZ-we.overscaledZ)return Ue.overscaledZ-we.overscaledZ;const Be=new a.pointGeometry(we.canonical.x+(1<<we.canonical.z)*we.wrap,we.canonical.y),je=new a.pointGeometry(Ue.canonical.x+(1<<Ue.canonical.z)*Ue.wrap,Ue.canonical.y),Ie=re.mult(1<<we.canonical.z);return Ie.x-=.5,Ie.y-=.5,Ie.distSqr(Be)-Ie.distSqr(je)})})(_,this.painter),this._previousZoom=p.zoom;const b=this.proxyToSource||{};this.proxyToSource={},_.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const M=this._style._sourceCaches;for(const F in M){const q=M[F];if(!q.used||(q!==this.sourceCache&&this.resetTileLookupCache(q.id),this._setupProxiedCoordsForOrtho(q,t[F],b),q.usedForTerrain))continue;const W=t[F];q.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[l.id]=_.map(F=>new Ho(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const O={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const q=this.terrainTileForTile[F.key];if(!q)continue;const W=q.tileID.key;W in O||(this._visibleDemTiles.push(q),O[W]=W)}}_assignTerrainTiles(t){this._initializing||t.forEach(l=>{if(this.terrainTileForTile[l.key])return;const p=this._findTileCoveringTileID(l,this.sourceCache);p&&(this.terrainTileForTile[l.key]=p)})}_prepareDEMTextures(){const t=this.painter.context,l=t.gl;for(const p in this.terrainTileForTile){const _=this.terrainTileForTile[p],b=_.dem;!b||_.demTexture&&!_.needsDEMTextureUpload||(t.activeTexture.set(l.TEXTURE1),co(this.painter,_,b))}}_prepareDemTileUniforms(t,l,p,_){if(!l||null==l.demTexture)return!1;const b=t.tileID.canonical,M=Math.pow(2,l.tileID.canonical.z-b.z),O=_||"";return p[`u_dem_tl${O}`]=[b.x*M%1,b.y*M%1],p[`u_dem_scale${O}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,l=t.gl;if(!this._emptyDepthBufferTexture){const p=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(t,p,l.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const l=this._visibleDemTiles.reduce((p,_)=>{if(!_.dem)return p;const b=_.dem.tree.minimums[0];return b>0&&t++,p+b},0);return t?l/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,l=t.gl;t.activeTexture.set(l.TEXTURE2);const p=this._getLoadedAreaMinimum(),_=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(_,{premultiply:!1}):b=this._emptyDEMTexture=new a.Texture(t,_,l.RGBA,{premultiply:!1}),b}setupElevationDraw(t,l,p){const _=this.painter.context,b=_.gl,M=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;M.u_dem_size=this.sourceCache.getSource().tileSize,M.u_exaggeration=this.exaggeration();let F=null,q=null,W=1;if(p&&p.morphing&&this._useVertexMorphing){const re=p.morphing.srcDemTile,we=p.morphing.dstDemTile;W=p.morphing.phase,re&&we&&(this._prepareDemTileUniforms(t,re,M,"_prev")&&(q=re),this._prepareDemTileUniforms(t,we,M)&&(F=we))}if(q&&F?(_.activeTexture.set(b.TEXTURE2),F.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),_.activeTexture.set(b.TEXTURE4),q.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),M.u_dem_lerp=W):(F=this.terrainTileForTile[t.tileID.key],_.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(t,F,M)?F.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),_.activeTexture.set(b.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(M.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),M.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&F){const re=(1<<F.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=re}if(p&&p.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),l.setTerrainUniformValues(_,M),"globe"===this.painter.transform.projection.name){const re=this.globeUniformValues(this.painter.transform,t.tileID.canonical,p&&p.useDenormalizedUpVectorScale);l.setGlobeUniformValues(_,re)}}globeUniformValues(t,l,p){const _=t.projection;return{u_tile_tl_up:_.upVector(l,0,0),u_tile_tr_up:_.upVector(l,a.EXTENT,0),u_tile_br_up:_.upVector(l,a.EXTENT,a.EXTENT),u_tile_bl_up:_.upVector(l,0,a.EXTENT),u_tile_up_scale:p?a.GLOBE_METERS_TO_ECEF:_.upVectorScale(l,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const l=this.painter,p=this.painter.context;0!==t.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,b,M,O,F){if("globe"===_.transform.projection.name)!function(q,W,re,we,Ue){const Be=q.context,je=Be.gl;let Ie,Le;const Ze=q.options.showTerrainWireframe?2:0,He=q.transform,st=a.globeUseCustomAntiAliasing(q,Be,He),St=($n,xn)=>{if(Le===$n)return;const zn=[Nt[$n],"PROJECTION_GLOBE_VIEW"];st&&zn.push("CUSTOM_ANTIALIASING"),xn&&zn.push(Nt[Ze]),Ie=q.useProgram("globeRaster",null,zn),Le=$n},Mt=q.colorModeForRenderPass(),jt=new a.DepthMode(je.LEQUAL,a.DepthMode.ReadWrite,q.depthRangeFor3D);Ke.update(Ue);const un=a.calculateGlobeMercatorMatrix(He),rn=[a.mercatorXfromLng(He.center.lng),a.mercatorYfromLat(He.center.lat)],Wt=Ze?[!1,!0]:[!1],Xn=q.globeSharedBuffers,tn=[He.width*a.exported.devicePixelRatio,He.height*a.exported.devicePixelRatio],In=Float32Array.from(He.globeMatrix),_n={useDenormalizedUpVectorScale:!0};if(Wt.forEach($n=>{Le=-1;const xn=$n?je.LINES:je.TRIANGLES;for(const zn of we){const qn=re.getTile(zn),qt=a.StencilMode.disabled,gn=W.prevTerrainTileForTile[zn.key],_i=W.terrainTileForTile[zn.key];ce(gn,_i)&&Ke.newMorphing(zn.key,gn,_i,Ue,250),Be.activeTexture.set(je.TEXTURE0),qn.texture.bind(je.LINEAR,je.CLAMP_TO_EDGE);const ki=Ke.getMorphValuesForProxy(zn.key),yi=ki?1:0;ki&&a.extend$1(_n,{morphing:{srcDemTile:ki.from,dstDemTile:ki.to,phase:a.easeCubicInOut(ki.phase)}});const Wi=a.tileCornersToBounds(zn.canonical),cr=a.getLatitudinalLod(Wi.getCenter().lat),Oi=a.getGridMatrix(zn.canonical,Wi,cr,He.worldSize/He._pixelsPerMercatorPixel),di=a.globeNormalizeECEF(a.globeTileBounds(zn.canonical)),Qr=bt(He.projMatrix,In,un,di,a.globeToMercatorTransition(He.zoom),rn,He.frustumCorners.TL,He.frustumCorners.TR,He.frustumCorners.BR,He.frustumCorners.BL,He.globeCenterInViewSpace,He.globeRadius,tn,Oi);if(St(yi,$n),W.setupElevationDraw(qn,Ie,_n),q.prepareDrawProgram(Be,Ie,zn.toUnwrapped()),Xn){const[zr,Gr,oo]=$n?Xn.getWirefameBuffers(q.context,cr):Xn.getGridBuffers(cr);Ie.draw(Be,xn,jt,qt,Mt,a.CullFaceMode.backCCW,Qr,"globe_raster",zr,Gr,oo)}}}),Xn){const $n=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];st&&$n.push("CUSTOM_ANTIALIASING"),Ie=q.useProgram("globeRaster",null,$n);for(const xn of we){const{x:zn,y:qn,z:qt}=xn.canonical,gn=0===qn,_i=qn===(1<<qt)-1,[ki,yi,Wi,cr]=Xn.getPoleBuffers(qt);if(cr&&(gn||_i)){const Oi=re.getTile(xn);Be.activeTexture.set(je.TEXTURE0),Oi.texture.bind(je.LINEAR,je.CLAMP_TO_EDGE);let di=a.globePoleMatrixForTile(qt,zn,He);const Qr=a.globeNormalizeECEF(a.globeTileBounds(xn.canonical)),zr=(Gr,oo)=>Gr.draw(Be,je.TRIANGLES,jt,a.StencilMode.disabled,Mt,a.CullFaceMode.disabled,bt(He.projMatrix,di,di,Qr,0,rn,He.frustumCorners.TL,He.frustumCorners.TR,He.frustumCorners.BR,He.frustumCorners.BL,He.globeCenterInViewSpace,He.globeRadius,tn),"globe_pole_raster",oo,Wi,cr);W.setupElevationDraw(Oi,Ie,_n),q.prepareDrawProgram(Be,Ie,xn.toUnwrapped()),gn&&zr(Ie,ki),_i&&(di=a.scale(a.create(),di,[1,-1,1]),zr(Ie,yi))}}}}(_,b,M,O,F);else{const q=_.context,W=q.gl;let re,we;const Ue=_.options.showTerrainWireframe?2:0,Be=(He,st)=>{if(we===He)return;const St=[Nt[He]];st&&St.push(Nt[Ue]),re=_.useProgram("terrainRaster",null,St),we=He},je=_.colorModeForRenderPass(),Ie=new a.DepthMode(W.LEQUAL,a.DepthMode.ReadWrite,_.depthRangeFor3D);Ke.update(F);const Le=_.transform,Ze=6*Math.pow(1.5,22-Le.zoom)*b.exaggeration();(Ue?[!1,!0]:[!1]).forEach(He=>{we=-1;const st=He?W.LINES:W.TRIANGLES,[St,Mt]=He?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const jt of O){const un=M.getTile(jt),rn=a.StencilMode.disabled,Wt=b.prevTerrainTileForTile[jt.key],Xn=b.terrainTileForTile[jt.key];ce(Wt,Xn)&&Ke.newMorphing(jt.key,Wt,Xn,F,250),q.activeTexture.set(W.TEXTURE0),un.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE,W.LINEAR_MIPMAP_NEAREST);const tn=Ke.getMorphValuesForProxy(jt.key),In=tn?1:0;let _n;tn&&(_n={morphing:{srcDemTile:tn.from,dstDemTile:tn.to,phase:a.easeCubicInOut(tn.phase)}});const $n=Pt(jt.projMatrix,Bn(jt.canonical,Le.renderWorldCopies)?Ze/10:Ze);Be(In,He),b.setupElevationDraw(un,re,_n),_.prepareDrawProgram(q,re,jt.toUnwrapped()),re.draw(q,st,Ie,rn,je,a.CullFaceMode.backCCW,$n,"terrain_raster",b.gridBuffer,St,Mt)}})}}(l,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const l=this.painter,p=this.painter.context,_=this.proxySourceCache,b=this.proxiedCoords[_.id],M=this._drapedRenderBatches.shift(),O=[],F=l.style.order;let q=0;for(const W of b){const re=_.getTileByID(W.proxyTileKey),we=_.proxyCachedFBO[W.key]?_.proxyCachedFBO[W.key][t]:void 0,Ue=void 0!==we?_.renderCache[we]:this.pool[q++],Be=void 0!==we;if(re.texture=Ue.tex,Be&&!Ue.dirty){O.push(re.tileID);continue}let je;p.bindFramebuffer.set(Ue.fb.framebuffer),this.renderedToTile=!1,Ue.dirty&&(p.clear({color:a.Color.transparent,stencil:0}),Ue.dirty=!1);for(let Ie=M.start;Ie<=M.end;++Ie){const Le=l.style._layers[F[Ie]];if(Le.isHidden(l.transform.zoom))continue;const Ze=l.style._getLayerSourceCache(Le),He=Ze?this.proxyToSource[W.key][Ze.id]:[W];if(!He)continue;const st=He;p.viewport.set([0,0,Ue.fb.width,Ue.fb.height]),je!==(Ze?Ze.id:null)&&(this._setupStencil(Ue,He,Le,Ze),je=Ze?Ze.id:null),l.renderLayer(l,Ze,Le,st)}this.renderedToTile?(Ue.dirty=!0,O.push(re.tileID)):Be||--q,5===q&&(q=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,l.width,l.height]),M.end+1}postRender(){}renderCacheEfficiency(t){const l=t.order.length;if(0===l)return{efficiency:100};let p,_=0,b=0,M=!1;for(let O=0;O<l;++O){const F=t._layers[t.order[O]];this._style.isLayerDraped(F)?(M&&++_,++b):M||(M=!0,p=F.id)}return 0===b?{efficiency:100}:{efficiency:100*(1-_/b),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{t=Math.min(t,l.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,l,p){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const M=b.tileID,O=1<<M.overscaledZ,{x:F,y:q}=M.canonical,W=F/O,re=(F+1)/O,we=q/O,Ue=(q+1)/O;return{minx:W,miny:we,maxx:re,maxy:Ue,t:b.dem.tree.raycastRoot(W,we,re,Ue,t,l,p),tile:b}});_.sort((b,M)=>(null!==b.t?b.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const b of _){if(null==b.t)return null;const M=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,t,l,p);if(null!=M)return M}return null}_createFBO(){const t=this.painter.context,l=t.gl,p=this.drapeBufferSize;t.activeTexture.set(l.TEXTURE0);const _=new a.Texture(t,{width:p[0],height:p[1],data:null},l.RGBA);_.bind(l.LINEAR,l.CLAMP_TO_EDGE);const b=t.createFramebuffer(p[0],p[1],!1);return b.colorAttachment.set(_.texture),b.depthAttachment=new $t(t,b.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&l.texParameterf(l.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:b,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const l=this._style._layers[t],p=l.isHidden(this.painter.transform.zoom);return"custom"!==l.type&&!p&&l.hasTransition()})}_clearRasterFadeFromRenderCache(){let t=!1;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l]._source instanceof ae){t=!0;break}if(t)for(let l=0;l<this._style.order.length;++l){const p=this._style._layers[this._style.order[l]],_=p.isHidden(this.painter.transform.zoom),b=this._style._getLayerSourceCache(p);if("raster"!==p.type||_||!b)continue;const M=p.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const F=this.proxyToSource[O.key][b.id];if(F)for(const q of F){const W=si(b.getTile(q),b.findLoadedParent(q,0),b,this.painter.transform,M);(1!==W.opacity||0!==W.mix)&&this._clearRenderCacheForTile(b.id,q)}}}}_setupDrapedRenderBatches(){const t=this._style.order,l=t.length;if(0===l)return;const p=[];let _,b=0,M=this._style._layers[t[b]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++b<l;)M=this._style._layers[t[b]];for(;b<l;++b){const O=this._style._layers[t[b]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===_&&(_=b):void 0!==_&&(p.push({start:_,end:b-1}),_=void 0))}void 0!==_&&p.push({start:_,end:b-1}),this._drapedRenderBatches=p}_setupRenderCache(t){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const M=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let O=0;O<M.length;++O){const F=Object.values(M[O]);l.renderCachePool.push(...F)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,_=this._tilesDirty;for(let M=p.length-1;M>=0;M--){const O=p[M];if(l.getTileByID(O.key),void 0!==l.proxyCachedFBO[O.key]){const F=t[O.key],q=this.proxyToSource[O.key];let W=0;for(const re in q){const we=q[re],Ue=F[re];if(!Ue||Ue.length!==we.length||we.some((Be,je)=>Be!==Ue[je]||_[re]&&_[re].hasOwnProperty(Be.key))){W=-1;break}++W}for(const re in l.proxyCachedFBO[O.key])l.renderCache[l.proxyCachedFBO[O.key][re]].dirty=W<0||W!==Object.values(F).length}}const b=[...this._drapedRenderBatches];b.sort((M,O)=>O.end-O.start-(M.end-M.start));for(const M of b)for(const O of p){if(l.proxyCachedFBO[O.key])continue;let F=l.renderCachePool.pop();void 0===F&&l.renderCache.length<50&&(F=l.renderCache.length,l.renderCache.push(this._createFBO())),void 0!==F&&(l.proxyCachedFBO[O.key]={},l.proxyCachedFBO[O.key][M.start]=F,l.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(t,l,p,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,M=b.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=l.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(t,l){const p=this.painter,_=this.painter.context,b=_.gl;p._tileClippingMaskIDs={},_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const M=p.useProgram("clippingMask");for(const O of t){const F=p._tileClippingMaskIDs[O.key]=--l;M.draw(_,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},F,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,xi(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(t){const l=this.painter.transform;if(t.x<0||t.x>l.width||t.y<0||t.y>l.height)return null;const p=[t.x,t.y,1,1];a.transformMat4$1(p,p,l.pixelMatrixInverse),a.scale$1(p,p,1/p[3]),p[0]/=l.worldSize,p[1]/=l.worldSize;const _=l._camera.position,b=a.mercatorZfromAltitude(1,l.center.lat),M=[_[0],_[1],_[2]/b,0],O=a.subtract([],p.slice(0,3),M);a.normalize(O,O);const F=this.raycast(M,O,this._exaggeration);return null!==F&&F?(a.scaleAndAdd(M,M,O,F),M[3]=M[2],M[2]*=b,M):null}drawDepth(){const t=this.painter,l=t.context,p=this.proxySourceCache,_=Math.ceil(t.width),b=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===_&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const M=l.gl,O=l.createFramebuffer(_,b,!0);l.activeTexture.set(M.TEXTURE0);const F=new a.Texture(l,{width:_,height:b,data:null},M.RGBA);F.bind(M.NEAREST,M.CLAMP_TO_EDGE),O.colorAttachment.set(F.texture);const q=l.createRenderbuffer(l.gl.DEPTH_COMPONENT16,_,b);O.depthAttachment.set(q),this._depthFBO=O,this._depthTexture=F}l.bindFramebuffer.set(this._depthFBO.framebuffer),l.viewport.set([0,0,_,b]),function(M,O,F,q){if("globe"===M.transform.projection.name)return;const W=M.context,re=W.gl;W.clear({depth:1});const we=M.useProgram("terrainDepth"),Ue=new a.DepthMode(re.LESS,a.DepthMode.ReadWrite,M.depthRangeFor3D);for(const Be of q){const je=F.getTile(Be),Ie=Pt(Be.projMatrix,0);O.setupElevationDraw(je,we),we.draw(W,re.TRIANGLES,Ue,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,Ie,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(t,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,l,p){if(t.getSource()instanceof Ye)return this._setupProxiedCoordsForImageSource(t,l,p);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const _=this.proxiedCoords[t.id]=[],b=this.proxyCoords;for(let O=0;O<b.length;O++){const F=b[O],q=this._findTileCoveringTileID(F,t);if(q){const W=this._createProxiedId(F,q,p[F.key]&&p[F.key][t.id]);_.push(W),this.proxyToSource[F.key][t.id]=[W]}}let M=!1;for(let O=0;O<l.length;O++){const F=t.getTile(l[O]);if(!F||!F.hasData())continue;const q=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(q&&q.tileID.canonical.z!==F.tileID.canonical.z){const W=this.proxyToSource[q.tileID.key][t.id],re=this._createProxiedId(q.tileID,F,p[q.tileID.key]&&p[q.tileID.key][t.id]);W?W.splice(W.length-1,0,re):this.proxyToSource[q.tileID.key][t.id]=[re],_.push(re),M=!0}}this._sourceTilesOverlap[t.id]=M}_setupProxiedCoordsForImageSource(t,l,p){if(!t.getSource().loaded())return;const _=this.proxiedCoords[t.id]=[],b=this.proxyCoords,M=t.getSource(),O=new a.pointGeometry(M.tileID.x,M.tileID.y)._div(1<<M.tileID.z),F=M.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((W,re)=>(W.min.x=Math.min(W.min.x,re.x-O.x),W.min.y=Math.min(W.min.y,re.y-O.y),W.max.x=Math.max(W.max.x,re.x-O.x),W.max.y=Math.max(W.max.y,re.y-O.y),W),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),q=(W,re)=>{const we=W.wrap+W.canonical.x/(1<<W.canonical.z),Ue=W.canonical.y/(1<<W.canonical.z),Be=a.EXTENT/(1<<W.canonical.z),je=re.wrap+re.canonical.x/(1<<re.canonical.z),Ie=re.canonical.y/(1<<re.canonical.z);return we+Be<je+F.min.x||we>je+F.max.x||Ue+Be<Ie+F.min.y||Ue>Ie+F.max.y};for(let W=0;W<b.length;W++){const re=b[W];for(let we=0;we<l.length;we++){const Ue=t.getTile(l[we]);if(!Ue||!Ue.hasData()||q(re,Ue.tileID))continue;const Be=this._createProxiedId(re,Ue,p[re.key]&&p[re.key][t.id]),je=this.proxyToSource[re.key][t.id];je?je.push(Be):this.proxyToSource[re.key][t.id]=[Be],_.push(Be)}}}_createProxiedId(t,l,p){let _=this.orthoMatrix;if(p){const b=p.find(M=>M.key===l.tileID.key);if(b)return b}if(l.tileID.key!==t.key){const b=t.canonical.z-l.tileID.canonical.z;let M,O,F;_=a.create();const q=l.tileID.wrap-t.wrap<<t.overscaledZ;b>0?(M=a.EXTENT>>b,O=M*((l.tileID.canonical.x<<b)-t.canonical.x+q),F=M*((l.tileID.canonical.y<<b)-t.canonical.y)):(M=a.EXTENT<<-b,O=a.EXTENT*(l.tileID.canonical.x-(t.canonical.x+q<<-b)),F=a.EXTENT*(l.tileID.canonical.y-(t.canonical.y<<-b))),a.ortho(_,0,M,0,M,0,1),a.translate(_,_,[O,F,0])}return new Ho(l.tileID,t.key,_)}_findTileCoveringTileID(t,l){let p=l.getTile(t);if(p&&p.hasData())return p;const _=this._findCoveringTileCache[l.id],b=_[t.key];if(p=b?l.getTileByID(b):null,p&&p.hasData()||null===b)return p;let M=p?p.tileID:t,O=M.overscaledZ;const F=l.getSource().minzoom,q=[];if(!b){const re=l.getSource().maxzoom;if(t.canonical.z>=re){const we=t.canonical.z-re;l.getSource().reparseOverscaled?(O=Math.max(t.canonical.z+2,l.transform.tileZoom),M=new a.OverscaledTileID(O,t.wrap,re,t.canonical.x>>we,t.canonical.y>>we)):0!==we&&(O=re,M=new a.OverscaledTileID(O,t.wrap,re,t.canonical.x>>we,t.canonical.y>>we))}M.key!==t.key&&(q.push(M.key),p=l.getTile(M))}const W=re=>{q.forEach(we=>{_[we]=re}),q.length=0};for(O-=1;O>=F&&(!p||!p.hasData());O--){p&&W(p.tileID.key);const re=M.calculateScaledKey(O);if(p=l.getTileByID(re),p&&p.hasData())break;const we=_[re];if(null===we)break;void 0===we?q.push(re):p=l.getTileByID(we)}return W(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,l){let p=this._tilesDirty[t];p||(p=this._tilesDirty[t]={}),p[l.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(l){let p=0;const _=new a.StructArrayLayout2ui4,b=131;for(let M=1;M<129;M++){for(let O=1;O<129;O++)p=M*b+O,_.emplaceBack(p,p+1),_.emplaceBack(p,p+b),_.emplaceBack(p+1,p+b),128===M&&_.emplaceBack(p+b,p+b+1);_.emplaceBack(p+1,p+1+b)}return _}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Rs{static cacheKey(t,l,p,_){let b=`${l}${_?_.cacheKey:""}`;for(const M of p)t.usedDefines.includes(M)&&(b+=`/${M}`);return b}constructor(t,l,p,_,b,M){const O=t.gl;this.program=O.createProgram();const F=function(Ie){const Le=[];for(let Ze=0;Ze<Ie.length;Ze++){if(null===Ie[Ze])continue;const He=Ie[Ze].split(" ");Le.push(He.pop())}return Le}(p.staticAttributes),q=_?_.getBinderAttributes():[],W=F.concat(q);let re=_?_.defines():[];re=re.concat(M.map(Ie=>`#define ${Ie}`));const we=re.concat(t.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(ga):ga,ga,na,fs.fragmentSource,Ur.fragmentSource,p.fragmentSource).join("\n"),Ue=re.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",na,fs.vertexSource,Ur.vertexSource,ta.vertexSource,p.vertexSource).join("\n"),Be=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(Be,we),O.compileShader(Be),O.attachShader(this.program,Be);const je=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(je,Ue),O.compileShader(je),O.attachShader(this.program,je),this.attributes={},this.numAttributes=W.length;for(let Ie=0;Ie<this.numAttributes;Ie++)W[Ie]&&(O.bindAttribLocation(this.program,Ie,W[Ie]),this.attributes[W[Ie]]=Ie);O.linkProgram(this.program),O.deleteShader(je),O.deleteShader(Be),this.fixedUniforms=b(t),this.binderUniforms=_?_.getUniforms(t):[],M.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new a.Uniform1i(Ie=t),u_dem_prev:new a.Uniform1i(Ie),u_dem_unpack:new a.Uniform4f(Ie),u_dem_tl:new a.Uniform2f(Ie),u_dem_scale:new a.Uniform1f(Ie),u_dem_tl_prev:new a.Uniform2f(Ie),u_dem_scale_prev:new a.Uniform1f(Ie),u_dem_size:new a.Uniform1f(Ie),u_dem_lerp:new a.Uniform1f(Ie),u_exaggeration:new a.Uniform1f(Ie),u_depth:new a.Uniform1i(Ie),u_depth_size_inv:new a.Uniform2f(Ie),u_meter_to_dem:new a.Uniform1f(Ie),u_label_plane_matrix_inv:new a.UniformMatrix4f(Ie)}),M.includes("GLOBE")&&(this.globeUniforms=(Ie=>({u_tile_tl_up:new a.Uniform3f(Ie),u_tile_tr_up:new a.Uniform3f(Ie),u_tile_br_up:new a.Uniform3f(Ie),u_tile_bl_up:new a.Uniform3f(Ie),u_tile_up_scale:new a.Uniform1f(Ie)}))(t)),M.includes("FOG")&&(this.fogUniforms=(Ie=>({u_fog_matrix:new a.UniformMatrix4f(Ie),u_fog_range:new a.Uniform2f(Ie),u_fog_color:new a.Uniform4f(Ie),u_fog_horizon_blend:new a.Uniform1f(Ie),u_fog_temporal_offset:new a.Uniform1f(Ie),u_frustum_tl:new a.Uniform3f(Ie),u_frustum_tr:new a.Uniform3f(Ie),u_frustum_br:new a.Uniform3f(Ie),u_frustum_bl:new a.Uniform3f(Ie),u_globe_pos:new a.Uniform3f(Ie),u_globe_radius:new a.Uniform1f(Ie),u_globe_transition:new a.Uniform1f(Ie),u_is_globe:new a.Uniform1i(Ie),u_viewport:new a.Uniform2f(Ie)}))(t))}var Ie}setTerrainUniformValues(t,l){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const _ in l)p[_]&&p[_].set(this.program,_,l[_])}}setGlobeUniformValues(t,l){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const _ in l)p[_]&&p[_].set(this.program,_,l[_])}}setFogUniformValues(t,l){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const _ in l)p[_].set(this.program,_,l[_])}}draw(t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je){const Ie=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(p),t.setStencilMode(_),t.setColorMode(b),t.setCullFace(M);for(const Ze of Object.keys(this.fixedUniforms))this.fixedUniforms[Ze].set(this.program,Ze,O[Ze]);Be&&Be.setUniforms(this.program,t,this.binderUniforms,we,{zoom:Ue});const Le={[Ie.LINES]:2,[Ie.TRIANGLES]:3,[Ie.LINE_STRIP]:1}[l];for(const Ze of re.get()){const He=Ze.vaos||(Ze.vaos={});(He[F]||(He[F]=new gl)).bind(t,this,q,Be?Be.getPaintVertexBuffers():[],W,Ze.vertexOffset,je||[]),Ie.drawElements(l,Ze.primitiveLength*Le,Ie.UNSIGNED_SHORT,Ze.primitiveOffset*Le*2)}}}function _a(u,t){const l=Math.pow(2,t.tileID.overscaledZ),p=t.tileSize*Math.pow(2,u.transform.tileZoom)/l,_=p*(t.tileID.canonical.x+t.tileID.wrap*l),b=p*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/Zt(t,1,u.transform.tileZoom),u_pixel_coord_upper:[_>>16,b>>16],u_pixel_coord_lower:[65535&_,65535&b]}}const Ai=a.create(),Zs=(u,t,l,p,_,b,M,O,F,q,W)=>{const re=t.style.light,we=re.properties.get("position"),Ue=[we.x,we.y,we.z],Be=a.create$1();"viewport"===re.properties.get("anchor")&&(a.fromRotation(Be,-t.transform.angle),a.transformMat3(Ue,Ue,Be));const je=re.properties.get("color"),Ie=t.transform,Le={u_matrix:u,u_lightpos:Ue,u_lightintensity:re.properties.get("intensity"),u_lightcolor:[je.r,je.g,je.b],u_vertical_gradient:+l,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ai,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:_,u_edge_radius:b};return"globe"===Ie.projection.name&&(Le.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Le.u_zoom_transition=F,Le.u_inv_rot_matrix=W,Le.u_merc_center=q,Le.u_up_dir=Ie.projection.upVector(new a.CanonicalTileID(0,0,0),q[0]*a.EXTENT,q[1]*a.EXTENT),Le.u_height_lift=O),Le},J=(u,t,l,p,_,b,M,O,F,q,W,re)=>{const we=Zs(u,t,l,p,_,b,M,F,q,W,re),Ue={u_height_factor:-Math.pow(2,M.overscaledZ)/O.tileSize/8};return a.extend(we,_a(t,O),Ue)},Y=u=>({u_matrix:u}),G=(u,t,l)=>a.extend(Y(u),_a(t,l)),Ee=(u,t)=>({u_matrix:u,u_world:t}),wn=(u,t,l,p)=>a.extend(G(u,t,l),{u_world:p}),Mi=a.create(),uo=(u,t,l,p,_,b)=>{const M=u.transform,O="globe"===M.projection.name;let F;if("map"===b.paint.get("circle-pitch-alignment"))if(O){const W=a.globePixelsToTileUnits(M.zoom,t.canonical)*M._pixelsPerMercatorPixel;F=Float32Array.from([W,0,0,W])}else F=M.calculatePixelsToTileUnitsMatrix(l);else F=new Float32Array([M.pixelsToGLUnits[0],0,0,M.pixelsToGLUnits[1]]);const q={u_camera_to_center_distance:M.cameraToCenterDistance,u_matrix:u.translatePosMatrix(t.projMatrix,l,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:Mi,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){q.u_inv_rot_matrix=p,q.u_merc_center=_,q.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],q.u_zoom_transition=a.globeToMercatorTransition(M.zoom);const W=_[0]*a.EXTENT,re=_[1]*a.EXTENT;q.u_up_dir=M.projection.upVector(new a.CanonicalTileID(0,0,0),W,re)}return q},Tn=u=>{const t=[];return"map"===u.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===u.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},sr=(u,t,l,p)=>{const _=a.EXTENT/l.tileSize;return{u_matrix:u,u_camera_to_center_distance:t.getCameraToCenterDistance(p),u_extrude_scale:[t.pixelsToGLUnits[0]/_,t.pixelsToGLUnits[1]/_]}},ws=(u,t,l=1)=>({u_matrix:u,u_color:t,u_overlay:0,u_overlay_scale:l}),nl=a.create(),ro=(u,t,l,p,_,b,M)=>{const O=u.transform,F="globe"===O.projection.name,q=F?a.globePixelsToTileUnits(O.zoom,t.canonical)*O._pixelsPerMercatorPixel:Zt(l,1,b),W={u_matrix:t.projMatrix,u_extrude_scale:q,u_intensity:M,u_inv_rot_matrix:nl,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){W.u_inv_rot_matrix=p,W.u_merc_center=_,W.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],W.u_zoom_transition=a.globeToMercatorTransition(O.zoom);const re=_[0]*a.EXTENT,we=_[1]*a.EXTENT;W.u_up_dir=O.projection.upVector(new a.CanonicalTileID(0,0,0),re,we)}return W},Fl=(u,t,l,p,_,b,M)=>{const O=u.transform,F=O.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:il(u,t,l,p),u_pixels_to_tile_units:F,u_device_pixel_ratio:b,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:rl(l)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:qo(t,u.transform),u_alpha_discard_threshold:0,u_trim_offset:M}},os=(u,t,l,p,_)=>{const b=u.transform;return{u_matrix:il(u,t,l,p),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:_,u_image:0,u_tile_units_to_pixels:qo(t,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function qo(u,t){return 1/Zt(u,1,t.tileZoom)}function il(u,t,l,p){return u.translatePosMatrix(p||t.tileID.projMatrix,t,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}function rl(u){const t=u.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const Vc=(u,t,l,p,_,b)=>{return{u_matrix:u,u_tl_parent:t,u_scale_parent:l,u_fade_t:p.mix,u_opacity:p.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(O=_.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(M=_.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:ic(_.paint.get("raster-hue-rotate")),u_perspective_transform:b};var M,O};function ic(u){u*=Math.PI/180;const t=Math.sin(u),l=Math.cos(u);return[(2*l+1)/3,(-Math.sqrt(3)*t-l+1)/3,(Math.sqrt(3)*t-l+1)/3]}const rc=a.create(),Nr=(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je)=>{const Ie=_.transform,Le={u_is_size_zoom_constant:+("constant"===u||"source"===u),u_is_size_feature_constant:+("constant"===u||"camera"===u),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:Ie.cameraToCenterDistance,u_rotate_symbol:+l,u_aspect_ratio:Ie.width/Ie.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:M,u_coord_matrix:O,u_is_text:+F,u_pitch_with_map:+p,u_texsize:q,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:rc,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:rc,u_up_vector:[0,-1,0]};return"globe"===je.name&&(Le.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],Le.u_zoom_transition=re,Le.u_inv_rot_matrix=Ue,Le.u_merc_center=we,Le.u_camera_forward=Ie._camera.forward(),Le.u_ecef_origin=a.globeECEFOrigin(Ie.globeMatrix,W.toUnwrapped()),Le.u_tile_matrix=Float32Array.from(Ie.globeMatrix),Le.u_up_vector=Be),Le},ss=(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je,Ie)=>a.extend(Nr(u,t,l,p,_,b,M,O,F,q,re,we,Ue,Be,je,Ie),{u_gamma_scale:p?_.transform.cameraToCenterDistance*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+W}),ks=(u,t,l,p,_,b,M,O,F,q,W,re,we,Ue,Be,je)=>a.extend(ss(u,t,l,p,_,b,M,O,!0,F,!0,W,re,we,Ue,Be,je),{u_texsize_icon:q,u_texture_icon:1}),Ta=(u,t,l)=>({u_matrix:u,u_opacity:t,u_color:l}),Ls=(u,t,l,p,_)=>a.extend(function(b,M,O){const F=M.imageManager.getPattern(b.toString()),{width:q,height:W}=M.imageManager.getPixelSize(),re=Math.pow(2,O.tileID.overscaledZ),we=O.tileSize*Math.pow(2,M.transform.tileZoom)/re,Ue=we*(O.tileID.canonical.x+O.tileID.wrap*re),Be=we*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:F.tl,u_pattern_br:F.br,u_texsize:[q,W],u_pattern_size:F.displaySize,u_tile_units_to_pixels:1/Zt(O,1,M.transform.tileZoom),u_pixel_coord_upper:[Ue>>16,Be>>16],u_pixel_coord_lower:[65535&Ue,65535&Be]}}(p,l,_),{u_matrix:u,u_opacity:t}),_l={fillExtrusion:u=>({u_matrix:new a.UniformMatrix4f(u),u_lightpos:new a.Uniform3f(u),u_lightintensity:new a.Uniform1f(u),u_lightcolor:new a.Uniform3f(u),u_vertical_gradient:new a.Uniform1f(u),u_opacity:new a.Uniform1f(u),u_edge_radius:new a.Uniform1f(u),u_ao:new a.Uniform2f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_up_dir:new a.Uniform3f(u),u_height_lift:new a.Uniform1f(u)}),fillExtrusionPattern:u=>({u_matrix:new a.UniformMatrix4f(u),u_lightpos:new a.Uniform3f(u),u_lightintensity:new a.Uniform1f(u),u_lightcolor:new a.Uniform3f(u),u_vertical_gradient:new a.Uniform1f(u),u_height_factor:new a.Uniform1f(u),u_edge_radius:new a.Uniform1f(u),u_ao:new a.Uniform2f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_up_dir:new a.Uniform3f(u),u_height_lift:new a.Uniform1f(u),u_image:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_pixel_coord_upper:new a.Uniform2f(u),u_pixel_coord_lower:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u),u_opacity:new a.Uniform1f(u)}),fill:u=>({u_matrix:new a.UniformMatrix4f(u)}),fillPattern:u=>({u_matrix:new a.UniformMatrix4f(u),u_image:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_pixel_coord_upper:new a.Uniform2f(u),u_pixel_coord_lower:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u)}),fillOutline:u=>({u_matrix:new a.UniformMatrix4f(u),u_world:new a.Uniform2f(u)}),fillOutlinePattern:u=>({u_matrix:new a.UniformMatrix4f(u),u_world:new a.Uniform2f(u),u_image:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_pixel_coord_upper:new a.Uniform2f(u),u_pixel_coord_lower:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u)}),circle:u=>({u_camera_to_center_distance:new a.Uniform1f(u),u_extrude_scale:new a.UniformMatrix2f(u),u_device_pixel_ratio:new a.Uniform1f(u),u_matrix:new a.UniformMatrix4f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_up_dir:new a.Uniform3f(u)}),collisionBox:u=>({u_matrix:new a.UniformMatrix4f(u),u_camera_to_center_distance:new a.Uniform1f(u),u_extrude_scale:new a.Uniform2f(u)}),collisionCircle:u=>({u_matrix:new a.UniformMatrix4f(u),u_inv_matrix:new a.UniformMatrix4f(u),u_camera_to_center_distance:new a.Uniform1f(u),u_viewport_size:new a.Uniform2f(u)}),debug:u=>({u_color:new a.UniformColor(u),u_matrix:new a.UniformMatrix4f(u),u_overlay:new a.Uniform1i(u),u_overlay_scale:new a.Uniform1f(u)}),clippingMask:u=>({u_matrix:new a.UniformMatrix4f(u)}),heatmap:u=>({u_extrude_scale:new a.Uniform1f(u),u_intensity:new a.Uniform1f(u),u_matrix:new a.UniformMatrix4f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_up_dir:new a.Uniform3f(u)}),heatmapTexture:u=>({u_image:new a.Uniform1i(u),u_color_ramp:new a.Uniform1i(u),u_opacity:new a.Uniform1f(u)}),hillshade:u=>({u_matrix:new a.UniformMatrix4f(u),u_image:new a.Uniform1i(u),u_latrange:new a.Uniform2f(u),u_light:new a.Uniform2f(u),u_shadow:new a.UniformColor(u),u_highlight:new a.UniformColor(u),u_accent:new a.UniformColor(u)}),hillshadePrepare:u=>({u_matrix:new a.UniformMatrix4f(u),u_image:new a.Uniform1i(u),u_dimension:new a.Uniform2f(u),u_zoom:new a.Uniform1f(u),u_unpack:new a.Uniform4f(u)}),line:u=>({u_matrix:new a.UniformMatrix4f(u),u_pixels_to_tile_units:new a.UniformMatrix2f(u),u_device_pixel_ratio:new a.Uniform1f(u),u_units_to_pixels:new a.Uniform2f(u),u_dash_image:new a.Uniform1i(u),u_gradient_image:new a.Uniform1i(u),u_image_height:new a.Uniform1f(u),u_texsize:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u),u_alpha_discard_threshold:new a.Uniform1f(u),u_trim_offset:new a.Uniform2f(u)}),linePattern:u=>({u_matrix:new a.UniformMatrix4f(u),u_texsize:new a.Uniform2f(u),u_pixels_to_tile_units:new a.UniformMatrix2f(u),u_device_pixel_ratio:new a.Uniform1f(u),u_image:new a.Uniform1i(u),u_units_to_pixels:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u),u_alpha_discard_threshold:new a.Uniform1f(u)}),raster:u=>({u_matrix:new a.UniformMatrix4f(u),u_tl_parent:new a.Uniform2f(u),u_scale_parent:new a.Uniform1f(u),u_fade_t:new a.Uniform1f(u),u_opacity:new a.Uniform1f(u),u_image0:new a.Uniform1i(u),u_image1:new a.Uniform1i(u),u_brightness_low:new a.Uniform1f(u),u_brightness_high:new a.Uniform1f(u),u_saturation_factor:new a.Uniform1f(u),u_contrast_factor:new a.Uniform1f(u),u_spin_weights:new a.Uniform3f(u),u_perspective_transform:new a.Uniform2f(u)}),symbolIcon:u=>({u_is_size_zoom_constant:new a.Uniform1i(u),u_is_size_feature_constant:new a.Uniform1i(u),u_size_t:new a.Uniform1f(u),u_size:new a.Uniform1f(u),u_camera_to_center_distance:new a.Uniform1f(u),u_rotate_symbol:new a.Uniform1i(u),u_aspect_ratio:new a.Uniform1f(u),u_fade_change:new a.Uniform1f(u),u_matrix:new a.UniformMatrix4f(u),u_label_plane_matrix:new a.UniformMatrix4f(u),u_coord_matrix:new a.UniformMatrix4f(u),u_is_text:new a.Uniform1i(u),u_pitch_with_map:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_camera_forward:new a.Uniform3f(u),u_tile_matrix:new a.UniformMatrix4f(u),u_up_vector:new a.Uniform3f(u),u_ecef_origin:new a.Uniform3f(u),u_texture:new a.Uniform1i(u)}),symbolSDF:u=>({u_is_size_zoom_constant:new a.Uniform1i(u),u_is_size_feature_constant:new a.Uniform1i(u),u_size_t:new a.Uniform1f(u),u_size:new a.Uniform1f(u),u_camera_to_center_distance:new a.Uniform1f(u),u_rotate_symbol:new a.Uniform1i(u),u_aspect_ratio:new a.Uniform1f(u),u_fade_change:new a.Uniform1f(u),u_matrix:new a.UniformMatrix4f(u),u_label_plane_matrix:new a.UniformMatrix4f(u),u_coord_matrix:new a.UniformMatrix4f(u),u_is_text:new a.Uniform1i(u),u_pitch_with_map:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_texture:new a.Uniform1i(u),u_gamma_scale:new a.Uniform1f(u),u_device_pixel_ratio:new a.Uniform1f(u),u_tile_id:new a.Uniform3f(u),u_zoom_transition:new a.Uniform1f(u),u_inv_rot_matrix:new a.UniformMatrix4f(u),u_merc_center:new a.Uniform2f(u),u_camera_forward:new a.Uniform3f(u),u_tile_matrix:new a.UniformMatrix4f(u),u_up_vector:new a.Uniform3f(u),u_ecef_origin:new a.Uniform3f(u),u_is_halo:new a.Uniform1i(u)}),symbolTextAndIcon:u=>({u_is_size_zoom_constant:new a.Uniform1i(u),u_is_size_feature_constant:new a.Uniform1i(u),u_size_t:new a.Uniform1f(u),u_size:new a.Uniform1f(u),u_camera_to_center_distance:new a.Uniform1f(u),u_rotate_symbol:new a.Uniform1i(u),u_aspect_ratio:new a.Uniform1f(u),u_fade_change:new a.Uniform1f(u),u_matrix:new a.UniformMatrix4f(u),u_label_plane_matrix:new a.UniformMatrix4f(u),u_coord_matrix:new a.UniformMatrix4f(u),u_is_text:new a.Uniform1i(u),u_pitch_with_map:new a.Uniform1i(u),u_texsize:new a.Uniform2f(u),u_texsize_icon:new a.Uniform2f(u),u_texture:new a.Uniform1i(u),u_texture_icon:new a.Uniform1i(u),u_gamma_scale:new a.Uniform1f(u),u_device_pixel_ratio:new a.Uniform1f(u),u_is_halo:new a.Uniform1i(u)}),background:u=>({u_matrix:new a.UniformMatrix4f(u),u_opacity:new a.Uniform1f(u),u_color:new a.UniformColor(u)}),backgroundPattern:u=>({u_matrix:new a.UniformMatrix4f(u),u_opacity:new a.Uniform1f(u),u_image:new a.Uniform1i(u),u_pattern_tl:new a.Uniform2f(u),u_pattern_br:new a.Uniform2f(u),u_texsize:new a.Uniform2f(u),u_pattern_size:new a.Uniform2f(u),u_pixel_coord_upper:new a.Uniform2f(u),u_pixel_coord_lower:new a.Uniform2f(u),u_tile_units_to_pixels:new a.Uniform1f(u)}),terrainRaster:xs,terrainDepth:xs,skybox:u=>({u_matrix:new a.UniformMatrix4f(u),u_sun_direction:new a.Uniform3f(u),u_cubemap:new a.Uniform1i(u),u_opacity:new a.Uniform1f(u),u_temporal_offset:new a.Uniform1f(u)}),skyboxGradient:u=>({u_matrix:new a.UniformMatrix4f(u),u_color_ramp:new a.Uniform1i(u),u_center_direction:new a.Uniform3f(u),u_radius:new a.Uniform1f(u),u_opacity:new a.Uniform1f(u),u_temporal_offset:new a.Uniform1f(u)}),skyboxCapture:u=>({u_matrix_3f:new a.UniformMatrix3f(u),u_sun_direction:new a.Uniform3f(u),u_sun_intensity:new a.Uniform1f(u),u_color_tint_r:new a.Uniform4f(u),u_color_tint_m:new a.Uniform4f(u),u_luminance:new a.Uniform1f(u)}),globeRaster:u=>({u_proj_matrix:new a.UniformMatrix4f(u),u_globe_matrix:new a.UniformMatrix4f(u),u_normalize_matrix:new a.UniformMatrix4f(u),u_merc_matrix:new a.UniformMatrix4f(u),u_zoom_transition:new a.Uniform1f(u),u_merc_center:new a.Uniform2f(u),u_image0:new a.Uniform1i(u),u_grid_matrix:new a.UniformMatrix3f(u),u_frustum_tl:new a.Uniform3f(u),u_frustum_tr:new a.Uniform3f(u),u_frustum_br:new a.Uniform3f(u),u_frustum_bl:new a.Uniform3f(u),u_globe_pos:new a.Uniform3f(u),u_globe_radius:new a.Uniform1f(u),u_viewport:new a.Uniform2f(u)}),globeAtmosphere:u=>({u_frustum_tl:new a.Uniform3f(u),u_frustum_tr:new a.Uniform3f(u),u_frustum_br:new a.Uniform3f(u),u_frustum_bl:new a.Uniform3f(u),u_horizon:new a.Uniform1f(u),u_transition:new a.Uniform1f(u),u_fadeout_range:new a.Uniform1f(u),u_color:new a.Uniform4f(u),u_high_color:new a.Uniform4f(u),u_space_color:new a.Uniform4f(u),u_star_intensity:new a.Uniform1f(u),u_star_density:new a.Uniform1f(u),u_star_size:new a.Uniform1f(u),u_temporal_offset:new a.Uniform1f(u),u_horizon_angle:new a.Uniform1f(u),u_rotation_matrix:new a.UniformMatrix4f(u)})};let Es;function Cc(u,t,l,p,_,b,M){const O=u.context,F=O.gl,q=u.transform,W=u.useProgram("collisionBox"),re=[];let we=0,Ue=0;for(let st=0;st<p.length;st++){const St=p[st],Mt=t.getTile(St),jt=Mt.getBucket(l);if(!jt)continue;const un=Zo(St,jt,q);let rn=un;0===_[0]&&0===_[1]||(rn=u.translatePosMatrix(un,Mt,_,b));const Wt=M?jt.textCollisionBox:jt.iconCollisionBox,Xn=jt.collisionCircleArray;if(Xn.length>0){const tn=a.create(),In=rn;a.mul(tn,jt.placementInvProjMatrix,q.glCoordMatrix),a.mul(tn,tn,jt.placementViewportMatrix),re.push({circleArray:Xn,circleOffset:Ue,transform:In,invTransform:tn,projection:jt.getProjection()}),we+=Xn.length/4,Ue=we}Wt&&(u.terrain&&u.terrain.setupElevationDraw(Mt,W),W.draw(O,F.LINES,a.DepthMode.disabled,a.StencilMode.disabled,u.colorModeForRenderPass(),a.CullFaceMode.disabled,sr(rn,q,Mt,jt.getProjection()),l.id,Wt.layoutVertexBuffer,Wt.indexBuffer,Wt.segments,null,q.zoom,null,[Wt.collisionVertexBuffer,Wt.collisionVertexBufferExt]))}if(!M||!re.length)return;const Be=u.useProgram("collisionCircle"),je=new a.StructArrayLayout2f1f2i16;je.resize(4*we),je._trim();let Ie=0;for(const st of re)for(let St=0;St<st.circleArray.length/4;St++){const Mt=4*St,jt=st.circleArray[Mt+0],un=st.circleArray[Mt+1],rn=st.circleArray[Mt+2],Wt=st.circleArray[Mt+3];je.emplace(Ie++,jt,un,rn,Wt,0),je.emplace(Ie++,jt,un,rn,Wt,1),je.emplace(Ie++,jt,un,rn,Wt,2),je.emplace(Ie++,jt,un,rn,Wt,3)}(!Es||Es.length<2*we)&&(Es=function(st){const St=2*st,Mt=new a.StructArrayLayout3ui6;Mt.resize(St),Mt._trim();for(let jt=0;jt<St;jt++){const un=6*jt;Mt.uint16[un+0]=4*jt+0,Mt.uint16[un+1]=4*jt+1,Mt.uint16[un+2]=4*jt+2,Mt.uint16[un+3]=4*jt+2,Mt.uint16[un+4]=4*jt+3,Mt.uint16[un+5]=4*jt+0}return Mt}(we));const Le=O.createIndexBuffer(Es,!0),Ze=O.createVertexBuffer(je,a.collisionCircleLayout.members,!0);for(const st of re){const St={u_matrix:st.transform,u_inv_matrix:st.invTransform,u_camera_to_center_distance:(He=q).getCameraToCenterDistance(st.projection),u_viewport_size:[He.width,He.height]};Be.draw(O,F.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,u.colorModeForRenderPass(),a.CullFaceMode.disabled,St,l.id,Ze,Le,a.SegmentVector.simpleSegment(0,2*st.circleOffset,st.circleArray.length,st.circleArray.length/2),null,q.zoom)}var He;Ze.destroy(),Le.destroy()}const yl=a.create();function Bl({width:u,height:t,anchor:l,textOffset:p,textScale:_},b){const{horizontalAlign:M,verticalAlign:O}=a.getAnchorAlignment(l),F=-(M-.5)*u,q=-(O-.5)*t,W=a.evaluateVariableOffset(l,p);return new a.pointGeometry((F/_+W[0])*b,(q/_+W[1])*b)}function ol(u,t,l,p,_,b,M,O,F,q,W){const re=u.text.placedSymbolArray,we=u.text.dynamicLayoutVertexArray,Ue=u.icon.dynamicLayoutVertexArray,Be={},je=u.getProjection(),Ie=Vo(O,je,b),Le=b.elevation,Ze=je.upVectorScale(O.canonical,b.center.lat,b.worldSize).metersToTile;we.clear();for(let He=0;He<re.length;He++){const st=re.get(He),{tileAnchorX:St,tileAnchorY:Mt,numGlyphs:jt}=st,rn=st.hidden||!st.crossTileID||u.allowVerticalPlacement&&!st.placedOrientation?null:p[st.crossTileID];if(rn){let Wt=0,Xn=0,tn=0;if(Le){const _i=Le?Le.getAtTileOffset(O,St,Mt):0,[ki,yi,Wi]=je.upVector(O.canonical,St,Mt);Wt=_i*ki*Ze,Xn=_i*yi*Ze,tn=_i*Wi*Ze}let[In,_n,$n,xn]=rr(st.projectedAnchorX+Wt,st.projectedAnchorY+Xn,st.projectedAnchorZ+tn,l?Ie:M);const zn=Kn(b.getCameraToCenterDistance(je),xn);let qn=_.evaluateSizeForFeature(u.textSizeData,q,st)*zn/a.ONE_EM;l&&(qn*=u.tilePixelRatio/F);const qt=Bl(rn,qn);l?(({x:In,y:_n,z:$n}=je.projectTilePoint(St+qt.x,Mt+qt.y,O.canonical)),[In,_n,$n]=rr(In+Wt,_n+Xn,$n+tn,M)):(t&&qt._rotate(-b.angle),In+=qt.x,_n+=qt.y,$n=0);const gn=u.allowVerticalPlacement&&st.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let _i=0;_i<jt;_i++)a.addDynamicAttributes(we,In,_n,$n,gn);W&&st.associatedIconIndex>=0&&(Be[st.associatedIconIndex]={x:In,y:_n,z:$n,angle:gn})}else Br(jt,we)}if(W){Ue.clear();const He=u.icon.placedSymbolArray;for(let st=0;st<He.length;st++){const St=He.get(st),{numGlyphs:Mt}=St,jt=Be[st];if(St.hidden||!jt)Br(Mt,Ue);else{const{x:un,y:rn,z:Wt,angle:Xn}=jt;for(let tn=0;tn<Mt;tn++)a.addDynamicAttributes(Ue,un,rn,Wt,Xn)}}u.icon.dynamicLayoutVertexBuffer.updateData(Ue)}u.text.dynamicLayoutVertexBuffer.updateData(we)}function sl(u,t,l){return l.iconsInText&&t?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function ra(u,t,l,p,_,b,M,O,F,q,W,re){const we=u.context,Ue=we.gl,Be=u.transform,je="map"===O,Ie="map"===F,Le=je&&"point"!==l.layout.get("symbol-placement"),Ze=je&&!Ie&&!Le,He=void 0!==l.layout.get("symbol-sort-key").constantOr(1);let st=!1;const St=u.depthModeForSublayer(0,a.DepthMode.ReadOnly),Mt=[a.mercatorXfromLng(Be.center.lng),a.mercatorYfromLat(Be.center.lat)],jt=l.layout.get("text-variable-anchor"),un="globe"===Be.projection.name,rn=[],Wt=[0,-1,0];let Xn=Wt;!un&&!Be.mercatorFromTransition||je||(Xn=function(tn){const In=tn._camera.getWorldToCamera(tn.worldSize,1),_n=a.multiply([],In,tn.globeMatrix);a.invert(_n,_n);const $n=[0,0,0],xn=[0,1,0,0];return a.transformMat4$1(xn,xn,_n),$n[0]=xn[0],$n[1]=xn[1],$n[2]=xn[2],a.normalize($n,$n),$n}(Be));for(const tn of p){const In=t.getTile(tn),_n=In.getBucket(l);if(!_n||"mercator"===_n.projection.name&&un)continue;const $n=_?_n.text:_n.icon;if(!$n||_n.fullyClipped||!$n.segments.get().length)continue;const xn=$n.programConfigurations.get(l.id),zn=_||_n.sdfIcons,qn=_?_n.textSizeData:_n.iconSizeData,qt=Ie||0!==Be.pitch,gn=a.evaluateSizeForZoom(qn,Be.zoom);let _i,ki,yi,Wi,cr=[0,0],Oi=null;if(_)ki=In.glyphAtlasTexture,yi=Ue.LINEAR,_i=In.glyphAtlasTexture.size,_n.iconsInText&&(cr=In.imageAtlasTexture.size,Oi=In.imageAtlasTexture,Wi=qt||u.options.rotating||u.options.zooming||"composite"===qn.kind||"camera"===qn.kind?Ue.LINEAR:Ue.NEAREST);else{const Fa=1!==l.layout.get("icon-size").constantOr(0)||_n.iconsNeedLinear;ki=In.imageAtlasTexture,yi=zn||u.options.rotating||u.options.zooming||Fa||qt?Ue.LINEAR:Ue.NEAREST,_i=In.imageAtlasTexture.size}const di="globe"===_n.projection.name,Qr=di?Xn:Wt,zr=di?a.globeToMercatorTransition(Be.zoom):0,Gr=Vo(tn,_n.getProjection(),Be),oo=Be.calculatePixelsToTileUnitsMatrix(In),La=Pr(Gr,In.tileID.canonical,Ie,je,Be,_n.getProjection(),oo),Ka=u.terrain&&Ie&&Le?a.invert(a.create(),La):yl,va=Gi(Gr,In.tileID.canonical,Ie,je,Be,_n.getProjection(),oo),jl=jt&&_n.hasTextData(),mo="none"!==l.layout.get("icon-text-fit")&&jl&&_n.hasIconData();if(Le){const Fa=Be.elevation,Xa=Fa?Fa.getAtTileOffsetFunc(tn,Be.center.lat,Be.worldSize,_n.getProjection()):null,Dl=ii(Gr,In.tileID.canonical,Ie,je,Be,_n.getProjection(),oo);bi(_n,Gr,u,_,Dl,va,Ie,q,Xa,tn)}const Jr=Le||_&&jt||mo,Tr=u.translatePosMatrix(Gr,In,b,M),No=Jr?yl:La,Ns=u.translatePosMatrix(va,In,b,M,!0),so=_n.getProjection().createInversionMatrix(Be,tn.canonical),Oo=[];u.terrainRenderModeElevated()&&Ie&&Oo.push("PITCH_WITH_MAP_TERRAIN"),di&&Oo.push("PROJECTION_GLOBE_VIEW"),Jr&&Oo.push("PROJECTED_POS_ON_VIEWPORT");const ou=zn&&0!==l.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1);let Hl;Hl=zn?_n.iconsInText?ks(qn.kind,gn,Ze,Ie,u,Tr,No,Ns,_i,cr,tn,zr,Mt,so,Qr,_n.getProjection()):ss(qn.kind,gn,Ze,Ie,u,Tr,No,Ns,_,_i,!0,tn,zr,Mt,so,Qr,_n.getProjection()):Nr(qn.kind,gn,Ze,Ie,u,Tr,No,Ns,_,_i,tn,zr,Mt,so,Qr,_n.getProjection());const Ys={program:u.useProgram(sl(zn,_,_n),xn,Oo),buffers:$n,uniformValues:Hl,atlasTexture:ki,atlasTextureIcon:Oi,atlasInterpolation:yi,atlasInterpolationIcon:Wi,isSDF:zn,hasHalo:ou,tile:In,labelPlaneMatrixInv:Ka};if(He&&_n.canOverlap){st=!0;const Fa=$n.segments.get();for(const Xa of Fa)rn.push({segments:new a.SegmentVector([Xa]),sortKey:Xa.sortKey,state:Ys})}else rn.push({segments:$n.segments,sortKey:0,state:Ys})}st&&rn.sort((tn,In)=>tn.sortKey-In.sortKey);for(const tn of rn){const In=tn.state;if(u.terrain&&u.terrain.setupElevationDraw(In.tile,In.program,{useDepthForOcclusion:!un,labelPlaneMatrixInv:In.labelPlaneMatrixInv}),we.activeTexture.set(Ue.TEXTURE0),In.atlasTexture.bind(In.atlasInterpolation,Ue.CLAMP_TO_EDGE),In.atlasTextureIcon&&(we.activeTexture.set(Ue.TEXTURE1),In.atlasTextureIcon&&In.atlasTextureIcon.bind(In.atlasInterpolationIcon,Ue.CLAMP_TO_EDGE)),In.isSDF){const _n=In.uniformValues;In.hasHalo&&(_n.u_is_halo=1,oc(In.buffers,tn.segments,l,u,In.program,St,W,re,_n)),_n.u_is_halo=0}oc(In.buffers,tn.segments,l,u,In.program,St,W,re,In.uniformValues)}}function oc(u,t,l,p,_,b,M,O,F){const q=p.context,W=[u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer,u.globeExtVertexBuffer];_.draw(q,q.gl.TRIANGLES,b,M,O,a.CullFaceMode.disabled,F,l.id,u.layoutVertexBuffer,u.indexBuffer,t,l.paint,p.transform.zoom,u.programConfigurations.get(l.id),W)}function al(u,t,l,p,_,b,M){const O=u.context.gl,F=l.paint.get("fill-pattern"),q=F&&F.constantOr(1);let W,re,we,Ue,Be;M?(re=q&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=O.LINES):(re=q?"fillPattern":"fill",W=O.TRIANGLES);for(const je of p){const Ie=t.getTile(je);if(q&&!Ie.patternsLoaded())continue;const Le=Ie.getBucket(l);if(!Le)continue;u.prepareDrawTile();const Ze=Le.programConfigurations.get(l.id),He=u.useProgram(re,Ze);q&&(u.context.activeTexture.set(O.TEXTURE0),Ie.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),Ze.updatePaintBuffers());const st=F.constantOr(null);if(st&&Ie.imageAtlas){const Mt=Ie.imageAtlas.patternPositions[st.toString()];Mt&&Ze.setConstantPatternPositions(Mt)}const St=u.translatePosMatrix(je.projMatrix,Ie,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor"));if(M){Ue=Le.indexBuffer2,Be=Le.segments2;const Mt=u.terrain&&u.terrain.renderingToTexture?u.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];we="fillOutlinePattern"===re&&q?wn(St,u,Ie,Mt):Ee(St,Mt)}else Ue=Le.indexBuffer,Be=Le.segments,we=q?G(St,u,Ie):Y(St);u.prepareDrawProgram(u.context,He,je.toUnwrapped()),He.draw(u.context,W,_,u.stencilModeForClipping(je),b,a.CullFaceMode.disabled,we,l.id,Le.layoutVertexBuffer,Ue,Be,l.paint,u.transform.zoom,Ze)}}function Sa(u,t,l,p,_,b,M){const O=u.context,F=O.gl,q=u.transform,W=l.paint.get("fill-extrusion-pattern"),re=W.constantOr(1),we=l.paint.get("fill-extrusion-opacity"),Ue=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),l.paint.get("fill-extrusion-ambient-occlusion-radius")],Be=l.layout.get("fill-extrusion-edge-radius"),je="globe"===q.projection.name?a.fillExtrusionHeightLift():0,Ie="globe"===q.projection.name,Le=Ie?a.globeToMercatorTransition(q.zoom):0,Ze=[a.mercatorXfromLng(q.center.lng),a.mercatorYfromLat(q.center.lat)],He=[];Ie&&(He.push("PROJECTION_GLOBE_VIEW"),u.style.terrainSetForDrapingOnly()&&He.push("TERRAIN")),Ue[0]>0&&He.push("FAUX_AO");for(const st of p){const St=t.getTile(st),Mt=St.getBucket(l);if(!Mt||Mt.projection.name!==q.projection.name)continue;const jt=Mt.programConfigurations.get(l.id),un=u.useProgram(re?"fillExtrusionPattern":"fillExtrusion",jt,He);if(u.terrain){const $n=u.terrain;if(u.style.terrainSetForDrapingOnly())$n.setupElevationDraw(St,un,{useMeterToDem:!0});else{if(!Mt.enableTerrain)continue;if($n.setupElevationDraw(St,un,{useMeterToDem:!0}),sc(O,t,st,Mt,l,$n),!Mt.centroidVertexBuffer){const xn=un.attributes.a_centroid_pos;void 0!==xn&&F.vertexAttrib2f(xn,0,0)}}}re&&(u.context.activeTexture.set(F.TEXTURE0),St.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),jt.updatePaintBuffers());const rn=W.constantOr(null);if(rn&&St.imageAtlas){const $n=St.imageAtlas.patternPositions[rn.toString()];$n&&jt.setConstantPatternPositions($n)}const Wt=u.translatePosMatrix(st.projMatrix,St,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Xn=q.projection.createInversionMatrix(q,st.canonical),tn=l.paint.get("fill-extrusion-vertical-gradient"),In=re?J(Wt,u,tn,we,Ue,Be,st,St,je,Le,Ze,Xn):Zs(Wt,u,tn,we,Ue,Be,st,je,Le,Ze,Xn);u.prepareDrawProgram(O,un,st.toUnwrapped());const _n=[];u.terrain&&_n.push(Mt.centroidVertexBuffer),Ie&&_n.push(Mt.layoutVertexExtBuffer),un.draw(O,O.gl.TRIANGLES,_,b,M,a.CullFaceMode.backCCW,In,l.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,l.paint,u.transform.zoom,jt,_n)}}function sc(u,t,l,p,_,b){const M=[Le=>{let Ze=Le.canonical.x-1,He=Le.wrap;return Ze<0&&(Ze=(1<<Le.canonical.z)-1,He--),new a.OverscaledTileID(Le.overscaledZ,He,Le.canonical.z,Ze,Le.canonical.y)},Le=>{let Ze=Le.canonical.x+1,He=Le.wrap;return Ze===1<<Le.canonical.z&&(Ze=0,He++),new a.OverscaledTileID(Le.overscaledZ,He,Le.canonical.z,Ze,Le.canonical.y)},Le=>new a.OverscaledTileID(Le.overscaledZ,Le.wrap,Le.canonical.z,Le.canonical.x,(0===Le.canonical.y?1<<Le.canonical.z:Le.canonical.y)-1),Le=>new a.OverscaledTileID(Le.overscaledZ,Le.wrap,Le.canonical.z,Le.canonical.x,Le.canonical.y===(1<<Le.canonical.z)-1?0:Le.canonical.y+1)],O=Le=>{const Ze=t.getSource().minzoom,He=St=>{const Mt=t.getTileByID(St);if(Mt&&Mt.hasData())return Mt.getBucket(_)},st=[0,-1,1];for(const St of st){if(Le.overscaledZ+St<Ze)continue;const Mt=He(Le.calculateScaledKey(Le.overscaledZ+St));if(Mt)return Mt}},F=[0,0,0],q=(Le,Ze)=>(F[0]=Math.min(Le.min.y,Ze.min.y),F[1]=Math.max(Le.max.y,Ze.max.y),F[2]=a.EXTENT-Ze.min.x>Le.max.x?Ze.min.x-a.EXTENT:Le.max.x,F),W=(Le,Ze)=>(F[0]=Math.min(Le.min.x,Ze.min.x),F[1]=Math.max(Le.max.x,Ze.max.x),F[2]=a.EXTENT-Ze.min.y>Le.max.y?Ze.min.y-a.EXTENT:Le.max.y,F),re=[(Le,Ze)=>q(Le,Ze),(Le,Ze)=>q(Ze,Le),(Le,Ze)=>W(Le,Ze),(Le,Ze)=>W(Ze,Le)],we=new a.pointGeometry(0,0);let Ue,Be,je;const Ie=(Le,Ze,He,st,St)=>{const Mt=[[st?He:Le,st?Le:He,0],[st?He:Ze,st?Ze:He,0]],jt=St<0?a.EXTENT+St:St,un=[st?jt:(Le+Ze)/2,st?(Le+Ze)/2:jt,0];return 0===He&&St<0||0!==He&&St>0?b.getForTilePoints(je,[un],!0,Be):Mt.push(un),b.getForTilePoints(l,Mt,!0,Ue),Math.max(Mt[0][2],Mt[1][2],un[2])/b.exaggeration()};for(let Le=0;Le<4;Le++){const Ze=(Le<2?1:5)-Le,He=p.borders[Le];if(0===He.length)continue;const st=je=M[Le](l),St=O(st);if(!(St&&St instanceof a.FillExtrusionBucket&&St.enableTerrain)||p.borderDoneWithNeighborZ[Le]===St.canonical.z&&St.borderDoneWithNeighborZ[Ze]===p.canonical.z||(Be=b.findDEMTileFor(st),!Be||!Be.dem))continue;if(!Ue){const rn=b.findDEMTileFor(l);if(!rn||!rn.dem)return;Ue=rn}const Mt=St.borders[Ze];let jt=0;const un=St.borderDoneWithNeighborZ[Ze]!==p.canonical.z;if(p.canonical.z===St.canonical.z){for(let rn=0;rn<He.length;rn++){const Wt=p.featuresOnBorder[He[rn]],Xn=Wt.borders[Le];let tn;for(;jt<Mt.length&&(tn=St.featuresOnBorder[Mt[jt]],!(tn.borders[Ze][1]>Xn[0]+3));)un&&St.encodeCentroid(void 0,tn,!1),jt++;if(tn&&jt<Mt.length){const In=jt;let _n=0;for(;!(tn.borders[Ze][0]>Xn[1]-3)&&(_n++,++jt!==Mt.length);)tn=St.featuresOnBorder[Mt[jt]];if(tn=St.featuresOnBorder[Mt[In]],Wt.intersectsCount()>1||tn.intersectsCount()>1||1!==_n){1!==_n&&(jt=In),p.encodeCentroid(void 0,Wt,!1),un&&St.encodeCentroid(void 0,tn,!1);continue}const $n=re[Le](Wt,tn),xn=Le%2?a.EXTENT-1:0;we.x=Ie($n[0],Math.min(a.EXTENT-1,$n[1]),xn,Le<2,$n[2]),we.y=0,p.encodeCentroid(we,Wt,!1),un&&St.encodeCentroid(we,tn,!1)}else p.encodeCentroid(void 0,Wt,!1)}p.borderDoneWithNeighborZ[Le]=St.canonical.z,p.needsCentroidUpdate=!0,un&&(St.borderDoneWithNeighborZ[Ze]=p.canonical.z,St.needsCentroidUpdate=!0)}else{for(const rn of He)p.encodeCentroid(void 0,p.featuresOnBorder[rn],!1);if(un){for(const rn of Mt)St.encodeCentroid(void 0,St.featuresOnBorder[rn],!1);St.borderDoneWithNeighborZ[Ze]=p.canonical.z,St.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[Le]=St.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(u)}const ll=new a.Color(1,0,0,1),ac=new a.Color(0,1,0,1),Nl=new a.Color(0,0,1,1),vl=new a.Color(1,0,1,1),Ws=new a.Color(0,1,1,1);function Mc(u,t,l){const p=u.context,_=u.transform,b=p.gl,M="globe"===_.projection.name,O=M?["PROJECTION_GLOBE_VIEW"]:null;let F=l.projMatrix;if(M&&a.globeToMercatorTransition(_.zoom)>0){const Wt=a.transitionTileAABBinECEF(l.canonical,_),Xn=a.globeDenormalizeECEF(Wt);F=a.multiply(new Float32Array(16),_.globeMatrix,Xn),a.multiply(F,_.projMatrix,F)}const q=u.useProgram("debug",null,O),W=t.getTileByID(l.key);u.terrain&&u.terrain.setupElevationDraw(W,q);const re=a.DepthMode.disabled,we=a.StencilMode.disabled,Ue=u.colorModeForRenderPass();p.activeTexture.set(b.TEXTURE0),u.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),M?W._makeGlobeTileDebugBuffers(u.context,_):W._makeDebugTileBoundsBuffers(u.context,_.projection);const je=W._tileDebugBuffer||u.debugBuffer,Ie=W._tileDebugIndexBuffer||u.debugIndexBuffer,Le=W._tileDebugSegments||u.debugSegments;q.draw(p,b.LINE_STRIP,re,we,Ue,a.CullFaceMode.disabled,ws(F,a.Color.red),"$debug",je,Ie,Le,null,null,null,[W._globeTileDebugBorderBuffer]);const Ze=W.latestRawTileData,He=Math.floor((Ze&&Ze.byteLength||0)/1024),st=t.getTile(l).tileSize,St=512/Math.min(st,512)*(l.overscaledZ/_.zoom)*.5;let Mt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Mt+=` => ${l.overscaledZ}`),Mt+=` ${He}kb`,function(Wt,Xn){Wt.initDebugOverlayCanvas();const tn=Wt.debugOverlayCanvas,In=Wt.context.gl,_n=Wt.debugOverlayCanvas.getContext("2d");_n.clearRect(0,0,tn.width,tn.height),_n.shadowColor="white",_n.shadowBlur=2,_n.lineWidth=1.5,_n.strokeStyle="white",_n.textBaseline="top",_n.font="bold 36px Open Sans, sans-serif",_n.fillText(Xn,5,5),_n.strokeText(Xn,5,5),Wt.debugOverlayTexture.update(tn),Wt.debugOverlayTexture.bind(In.LINEAR,In.CLAMP_TO_EDGE)}(u,Mt);const jt=W._tileDebugTextBuffer||u.debugBuffer,un=W._tileDebugTextIndexBuffer||u.quadTriangleIndexBuffer,rn=W._tileDebugTextSegments||u.debugSegments;q.draw(p,b.TRIANGLES,re,we,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,ws(F,a.Color.transparent,St),"$debug",jt,un,rn,null,null,null,[W._globeTileDebugTextBuffer])}function Lo(u,t,l,p){Sr(u,0,t+l/2,u.transform.width,l,p)}function qs(u,t,l,p){Sr(u,t-l/2,0,l,u.transform.height,p)}function Sr(u,t,l,p,_,b){const M=u.context,O=M.gl;O.enable(O.SCISSOR_TEST),O.scissor(t*a.exported.devicePixelRatio,l*a.exported.devicePixelRatio,p*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio),M.clear({color:b}),O.disable(O.SCISSOR_TEST)}const Aa=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:lc}=Aa;function as(u,t,l,p){u.emplaceBack(t,l,p)}class Ha{constructor(t){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,as(this.vertexArray,-1,-1,1),as(this.vertexArray,1,-1,1),as(this.vertexArray,-1,1,1),as(this.vertexArray,1,1,1),as(this.vertexArray,-1,-1,-1),as(this.vertexArray,1,-1,-1),as(this.vertexArray,-1,1,-1),as(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,lc),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Ga(u,t,l,p,_,b){const M=u.gl,O=t.paint.get("sky-atmosphere-color"),F=t.paint.get("sky-atmosphere-halo-color"),q=t.paint.get("sky-atmosphere-sun-intensity"),W={u_matrix_3f:a.fromMat4(a.create$1(),p),u_sun_direction:_,u_sun_intensity:q,u_color_tint_r:[(Be=O).r,Be.g,Be.b,Be.a],u_color_tint_m:[(je=F).r,je.g,je.b,je.a],u_luminance:5e-5};var Be,je;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+b,t.skyboxTexture,0),l.draw(u,M.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,W,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const cc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class mr{constructor(t){const l=new a.StructArrayLayout5f20;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const p=new a.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(l,cc.members),this.indexBuffer=t.createIndexBuffer(p),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ia={symbol:function(u,t,l,p,_){if("translucent"!==u.renderPass)return;const b=a.StencilMode.disabled,M=u.colorModeForRenderPass();l.layout.get("text-variable-anchor")&&function(O,F,q,W,re,we,Ue){const Be=F.transform,je="map"===re,Ie="map"===we;for(const Le of O){const Ze=W.getTile(Le),He=Ze.getBucket(q);if(!He||!He.text||!He.text.segments.get().length)continue;const st=a.evaluateSizeForZoom(He.textSizeData,Be.zoom),St=Vo(Le,He.getProjection(),Be),Mt=Be.calculatePixelsToTileUnitsMatrix(Ze),jt=Pr(St,Ze.tileID.canonical,Ie,je,Be,He.getProjection(),Mt),un="none"!==q.layout.get("icon-text-fit")&&He.hasIconData();if(st){const rn=Math.pow(2,Be.zoom-Ze.tileID.overscaledZ);ol(He,je,Ie,Ue,a.symbolSize,Be,jt,Le,rn,st,un)}}}(p,u,l,t,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),_),0!==l.paint.get("icon-opacity").constantOr(1)&&ra(u,t,l,p,!1,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),l.layout.get("icon-rotation-alignment"),l.layout.get("icon-pitch-alignment"),l.layout.get("icon-keep-upright"),b,M),0!==l.paint.get("text-opacity").constantOr(1)&&ra(u,t,l,p,!0,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),l.layout.get("text-keep-upright"),b,M),t.map.showCollisionBoxes&&(Cc(u,t,l,p,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),Cc(u,t,l,p,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(u,t,l,p){if("translucent"!==u.renderPass)return;const _=l.paint.get("circle-opacity"),b=l.paint.get("circle-stroke-width"),M=l.paint.get("circle-stroke-opacity"),O=void 0!==l.layout.get("circle-sort-key").constantOr(1);if(0===_.constantOr(1)&&(0===b.constantOr(1)||0===M.constantOr(1)))return;const F=u.context,q=F.gl,W=u.transform,re=u.depthModeForSublayer(0,a.DepthMode.ReadOnly),we=a.StencilMode.disabled,Ue=u.colorModeForRenderPass(),Be="globe"===W.projection.name,je=[a.mercatorXfromLng(W.center.lng),a.mercatorYfromLat(W.center.lat)],Ie=[];for(let Ze=0;Ze<p.length;Ze++){const He=p[Ze],st=t.getTile(He),St=st.getBucket(l);if(!St||St.projection.name!==W.projection.name)continue;const Mt=St.programConfigurations.get(l.id),jt=Tn(l);Be&&jt.push("PROJECTION_GLOBE_VIEW");const un=u.useProgram("circle",Mt,jt),rn=St.layoutVertexBuffer,Wt=St.globeExtVertexBuffer,Xn=St.indexBuffer,tn=W.projection.createInversionMatrix(W,He.canonical),In={programConfiguration:Mt,program:un,layoutVertexBuffer:rn,globeExtVertexBuffer:Wt,indexBuffer:Xn,uniformValues:uo(u,He,st,tn,je,l),tile:st};if(O){const _n=St.segments.get();for(const $n of _n)Ie.push({segments:new a.SegmentVector([$n]),sortKey:$n.sortKey,state:In})}else Ie.push({segments:St.segments,sortKey:0,state:In})}O&&Ie.sort((Ze,He)=>Ze.sortKey-He.sortKey);const Le={useDepthForOcclusion:!Be};for(const Ze of Ie){const{programConfiguration:He,program:st,layoutVertexBuffer:St,globeExtVertexBuffer:Mt,indexBuffer:jt,uniformValues:un,tile:rn}=Ze.state,Wt=Ze.segments;u.terrain&&u.terrain.setupElevationDraw(rn,st,Le),u.prepareDrawProgram(F,st,rn.tileID.toUnwrapped()),st.draw(F,q.TRIANGLES,re,we,Ue,a.CullFaceMode.disabled,un,l.id,St,jt,Wt,l.paint,W.zoom,He,[Mt])}},heatmap:function(u,t,l,p){if(0!==l.paint.get("heatmap-opacity"))if("offscreen"===u.renderPass){const _=u.context,b=_.gl,M=a.StencilMode.disabled,O=new a.ColorMode([b.ONE,b.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Ue,Be,je,Ie){const Le=Ue.gl,Ze=Be.width*Ie,He=Be.height*Ie;Ue.activeTexture.set(Le.TEXTURE1),Ue.viewport.set([0,0,Ze,He]);let st=je.heatmapFbo;if(!st||st&&(st.width!==Ze||st.height!==He)){st&&st.destroy();const St=Le.createTexture();Le.bindTexture(Le.TEXTURE_2D,St),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_WRAP_S,Le.CLAMP_TO_EDGE),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_WRAP_T,Le.CLAMP_TO_EDGE),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_MIN_FILTER,Le.LINEAR),Le.texParameteri(Le.TEXTURE_2D,Le.TEXTURE_MAG_FILTER,Le.LINEAR),st=je.heatmapFbo=Ue.createFramebuffer(Ze,He,!1),function(Mt,jt,un,rn,Wt,Xn){const tn=Mt.gl;tn.texImage2D(tn.TEXTURE_2D,0,tn.RGBA,Wt,Xn,0,tn.RGBA,Mt.extRenderToTextureHalfFloat?Mt.extTextureHalfFloat.HALF_FLOAT_OES:tn.UNSIGNED_BYTE,null),rn.colorAttachment.set(un)}(Ue,0,St,st,Ze,He)}else Le.bindTexture(Le.TEXTURE_2D,st.colorAttachment.get()),Ue.bindFramebuffer.set(st.framebuffer)})(_,u,l,"globe"===u.transform.projection.name?.5:.25),_.clear({color:a.Color.transparent});const F=u.transform,q="globe"===F.projection.name,W=q?["PROJECTION_GLOBE_VIEW"]:null,re=q?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,we=[a.mercatorXfromLng(F.center.lng),a.mercatorYfromLat(F.center.lat)];for(let Ue=0;Ue<p.length;Ue++){const Be=p[Ue];if(t.hasRenderableParent(Be))continue;const je=t.getTile(Be),Ie=je.getBucket(l);if(!Ie||Ie.projection.name!==F.projection.name)continue;const Le=Ie.programConfigurations.get(l.id),Ze=u.useProgram("heatmap",Le,W),{zoom:He}=u.transform;u.terrain&&u.terrain.setupElevationDraw(je,Ze),u.prepareDrawProgram(_,Ze,Be.toUnwrapped());const st=F.projection.createInversionMatrix(F,Be.canonical);Ze.draw(_,b.TRIANGLES,a.DepthMode.disabled,M,O,re,ro(u,Be,je,st,we,He,l.paint.get("heatmap-intensity")),l.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,l.paint,u.transform.zoom,Le,q?[Ie.globeExtVertexBuffer]:null)}_.viewport.set([0,0,u.width,u.height])}else"translucent"===u.renderPass&&(u.context.setColorMode(u.colorModeForRenderPass()),function(_,b){const M=_.context,O=M.gl,F=b.heatmapFbo;if(!F)return;M.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,F.colorAttachment.get()),M.activeTexture.set(O.TEXTURE1);let q=b.colorRampTexture;q||(q=b.colorRampTexture=new a.Texture(M,b.colorRamp,O.RGBA)),q.bind(O.LINEAR,O.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(M,O.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,_.colorModeForRenderPass(),a.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:b.paint.get("heatmap-opacity")},b.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,b.paint,_.transform.zoom)}(u,l))},line:function(u,t,l,p){if("translucent"!==u.renderPass)return;const _=l.paint.get("line-opacity"),b=l.paint.get("line-width");if(0===_.constantOr(1)||0===b.constantOr(1))return;const M=u.depthModeForSublayer(0,a.DepthMode.ReadOnly),O=u.colorModeForRenderPass(),F=u.terrain&&u.terrain.renderingToTexture?1:a.exported.devicePixelRatio,q=l.paint.get("line-dasharray"),W=q.constantOr(1),re=l.layout.get("line-cap"),we=l.paint.get("line-pattern"),Ue=we.constantOr(1),Be=l.paint.get("line-gradient"),je=Ue?"linePattern":"line",Ie=u.context,Le=Ie.gl,Ze=(st=>{const St=[];rl(st)&&St.push("RENDER_LINE_DASH"),st.paint.get("line-gradient")&&St.push("RENDER_LINE_GRADIENT");const Mt=st.paint.get("line-trim-offset");0===Mt[0]&&0===Mt[1]||St.push("RENDER_LINE_TRIM_OFFSET");const jt=st.paint.get("line-pattern").constantOr(1),un=1!==st.paint.get("line-opacity").constantOr(1);return!jt&&un&&St.push("RENDER_LINE_ALPHA_DISCARD"),St})(l);let He=Ze.includes("RENDER_LINE_ALPHA_DISCARD");u.terrain&&u.terrain.clipOrMaskOverlapStencilType()&&(He=!1);for(const st of p){const St=t.getTile(st);if(Ue&&!St.patternsLoaded())continue;const Mt=St.getBucket(l);if(!Mt)continue;u.prepareDrawTile();const jt=Mt.programConfigurations.get(l.id),un=u.useProgram(je,jt,Ze),rn=we.constantOr(null);if(rn&&St.imageAtlas){const zn=St.imageAtlas.patternPositions[rn.toString()];zn&&jt.setConstantPatternPositions(zn)}const Wt=q.constantOr(null),Xn=re.constantOr(null);if(!Ue&&Wt&&Xn&&St.lineAtlas){const zn=St.lineAtlas.getDash(Wt,Xn);zn&&jt.setConstantPatternPositions(zn)}let[tn,In]=l.paint.get("line-trim-offset");("round"===Xn||"square"===Xn)&&tn!==In&&(0===tn&&(tn-=1),1===In&&(In+=1));const _n=u.terrain?st.projMatrix:null,$n=Ue?os(u,St,l,_n,F):Fl(u,St,l,_n,Mt.lineClipsArray.length,F,[tn,In]);if(Be){const zn=Mt.gradients[l.id];let qn=zn.texture;if(l.gradientVersion!==zn.version){let qt=256;if(l.stepInterpolant){const gn=t.getSource().maxzoom,_i=st.canonical.z===gn?Math.ceil(1<<u.transform.maxZoom-st.canonical.z):1;qt=a.clamp(a.nextPowerOfTwo(Mt.maxLineLength/a.EXTENT*1024*_i),256,Ie.maxTextureSize)}zn.gradient=a.renderColorRamp({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:qt,image:zn.gradient||void 0,clips:Mt.lineClipsArray}),zn.texture?zn.texture.update(zn.gradient):zn.texture=new a.Texture(Ie,zn.gradient,Le.RGBA),zn.version=l.gradientVersion,qn=zn.texture}Ie.activeTexture.set(Le.TEXTURE1),qn.bind(l.stepInterpolant?Le.NEAREST:Le.LINEAR,Le.CLAMP_TO_EDGE)}W&&(Ie.activeTexture.set(Le.TEXTURE0),St.lineAtlasTexture.bind(Le.LINEAR,Le.REPEAT),jt.updatePaintBuffers()),Ue&&(Ie.activeTexture.set(Le.TEXTURE0),St.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),jt.updatePaintBuffers()),u.prepareDrawProgram(Ie,un,st.toUnwrapped());const xn=zn=>{un.draw(Ie,Le.TRIANGLES,M,zn,O,a.CullFaceMode.disabled,$n,l.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,l.paint,u.transform.zoom,jt,[Mt.layoutVertexBuffer2])};if(He){const zn=u.stencilModeForClipping(st).ref;0===zn&&u.terrain&&Ie.clear({stencil:0});const qn={func:Le.EQUAL,mask:255};$n.u_alpha_discard_threshold=.8,xn(new a.StencilMode(qn,zn,255,Le.KEEP,Le.KEEP,Le.INVERT)),$n.u_alpha_discard_threshold=0,xn(new a.StencilMode(qn,zn,255,Le.KEEP,Le.KEEP,Le.KEEP))}else xn(u.stencilModeForClipping(st))}He&&(u.resetStencilClippingMasks(),u.terrain&&Ie.clear({stencil:0}))},fill:function(u,t,l,p){const _=l.paint.get("fill-color"),b=l.paint.get("fill-opacity");if(0===b.constantOr(1))return;const M=u.colorModeForRenderPass(),O=l.paint.get("fill-pattern"),F=u.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===_.constantOr(a.Color.transparent).a&&1===b.constantOr(0)?"opaque":"translucent";if(u.renderPass===F){const q=u.depthModeForSublayer(1,"opaque"===u.renderPass?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);al(u,t,l,p,q,M,!1)}if("translucent"===u.renderPass&&l.paint.get("fill-antialias")){const q=u.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);al(u,t,l,p,q,M,!0)}},"fill-extrusion":function(u,t,l,p){const _=l.paint.get("fill-extrusion-opacity");if(0!==_&&"translucent"===u.renderPass){const b=new a.DepthMode(u.context.gl.LEQUAL,a.DepthMode.ReadWrite,u.depthRangeFor3D);if(1!==_||l.paint.get("fill-extrusion-pattern").constantOr(1))Sa(u,t,l,p,b,a.StencilMode.disabled,a.ColorMode.disabled),Sa(u,t,l,p,b,u.stencilModeFor3D(),u.colorModeForRenderPass()),u.resetStencilClippingMasks();else{const M=u.colorModeForRenderPass();Sa(u,t,l,p,b,a.StencilMode.disabled,M)}}},hillshade:function(u,t,l,p){if("offscreen"!==u.renderPass&&"translucent"!==u.renderPass)return;const _=u.context,b=u.depthModeForSublayer(0,a.DepthMode.ReadOnly),M=u.colorModeForRenderPass(),O=u.terrain&&u.terrain.renderingToTexture,[F,q]="translucent"!==u.renderPass||O?[{},p]:u.stencilConfigForOverlap(p);for(const W of q){const re=t.getTile(W);if(re.needsHillshadePrepare&&"offscreen"===u.renderPass)$s(u,re,l,b,a.StencilMode.disabled,M);else if("translucent"===u.renderPass){const we=O&&u.terrain?u.terrain.stencilModeForRTTOverlap(W):F[W.overscaledZ];Da(u,W,re,l,b,we,M)}}_.viewport.set([0,0,u.width,u.height]),u.resetStencilClippingMasks()},raster:function(u,t,l,p,_,b){if("translucent"!==u.renderPass||0===l.paint.get("raster-opacity")||!p.length)return;const M=u.context,O=M.gl,F=t.getSource(),q=u.useProgram("raster"),W=u.colorModeForRenderPass(),re=u.terrain&&u.terrain.renderingToTexture,[we,Ue]=F instanceof Ye||re?[{},p]:u.stencilConfigForOverlap(p),Be=Ue[Ue.length-1].overscaledZ,je=!u.options.moving;for(const Ie of Ue){const Le=re?a.DepthMode.disabled:u.depthModeForSublayer(Ie.overscaledZ-Be,1===l.paint.get("raster-opacity")?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,O.LESS),Ze=Ie.toUnwrapped(),He=t.getTile(Ie);if(re&&(!He||!He.hasData()))continue;const st=re?Ie.projMatrix:u.transform.calculateProjMatrix(Ze,je),St=u.terrain&&re?u.terrain.stencilModeForRTTOverlap(Ie):we[Ie.overscaledZ],Mt=b?0:l.paint.get("raster-fade-duration");He.registerFadeDuration(Mt);const jt=t.findLoadedParent(Ie,0),un=si(He,jt,t,u.transform,Mt);let rn,Wt;u.terrain&&u.terrain.prepareDrawTile();const Xn="nearest"===l.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;M.activeTexture.set(O.TEXTURE0),He.texture.bind(Xn,O.CLAMP_TO_EDGE),M.activeTexture.set(O.TEXTURE1),jt?(jt.texture.bind(Xn,O.CLAMP_TO_EDGE),rn=Math.pow(2,jt.tileID.overscaledZ-He.tileID.overscaledZ),Wt=[He.tileID.canonical.x*rn%1,He.tileID.canonical.y*rn%1]):He.texture.bind(Xn,O.CLAMP_TO_EDGE);const tn=Vc(st,Wt||[0,0],rn||1,un,l,F instanceof Ye?F.perspectiveTransform:[0,0]);if(u.prepareDrawProgram(M,q,Ze),F instanceof Ye)F.boundsBuffer&&F.boundsSegments&&q.draw(M,O.TRIANGLES,Le,a.StencilMode.disabled,W,a.CullFaceMode.disabled,tn,l.id,F.boundsBuffer,u.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:In,tileBoundsIndexBuffer:_n,tileBoundsSegments:$n}=u.getTileBoundsBuffers(He);q.draw(M,O.TRIANGLES,Le,St,W,a.CullFaceMode.disabled,tn,l.id,In,_n,$n)}}u.resetStencilClippingMasks()},background:function(u,t,l,p){const _=l.paint.get("background-color"),b=l.paint.get("background-opacity");if(0===b)return;const M=u.context,O=M.gl,F=u.transform,q=F.tileSize,W=l.paint.get("background-pattern");if(u.isPatternMissing(W))return;const re=!W&&1===_.a&&1===b&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass!==re)return;const we=a.StencilMode.disabled,Ue=u.depthModeForSublayer(0,"opaque"===re?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),Be=u.colorModeForRenderPass(),je=u.useProgram(W?"backgroundPattern":"background");let Ie,Le=p;Le||(Ie=u.getBackgroundTiles(),Le=Object.values(Ie).map(Ze=>Ze.tileID)),W&&(M.activeTexture.set(O.TEXTURE0),u.imageManager.bind(u.context));for(const Ze of Le){const He=Ze.toUnwrapped(),st=p?Ze.projMatrix:u.transform.calculateProjMatrix(He);u.prepareDrawTile();const St=t?t.getTile(Ze):Ie?Ie[Ze.key]:new a.Tile(Ze,q,F.zoom,u),Mt=W?Ls(st,b,u,W,{tileID:Ze,tileSize:q}):Ta(st,b,_);u.prepareDrawProgram(M,je,He);const{tileBoundsBuffer:jt,tileBoundsIndexBuffer:un,tileBoundsSegments:rn}=u.getTileBoundsBuffers(St);je.draw(M,O.TRIANGLES,Ue,we,Be,a.CullFaceMode.disabled,Mt,l.id,jt,un,rn)}},sky:function(u,t,l){const p=u.transform,_="mercator"===p.projection.name||"globe"===p.projection.name?1:a.smoothstep(7,8,p.zoom),b=l.paint.get("sky-opacity")*_;if(0===b)return;const M=u.context,O=l.paint.get("sky-type"),F=new a.DepthMode(M.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),q=u.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===u.renderPass?l.needsSkyboxCapture(u)&&(function(W,re,we,Ue){const Be=W.context,je=Be.gl;let Ie=re.skyboxFbo;if(!Ie){Ie=re.skyboxFbo=Be.createFramebuffer(32,32,!1),re.skyboxGeometry=new Ha(Be),re.skyboxTexture=Be.gl.createTexture(),je.bindTexture(je.TEXTURE_CUBE_MAP,re.skyboxTexture),je.texParameteri(je.TEXTURE_CUBE_MAP,je.TEXTURE_WRAP_S,je.CLAMP_TO_EDGE),je.texParameteri(je.TEXTURE_CUBE_MAP,je.TEXTURE_WRAP_T,je.CLAMP_TO_EDGE),je.texParameteri(je.TEXTURE_CUBE_MAP,je.TEXTURE_MIN_FILTER,je.LINEAR),je.texParameteri(je.TEXTURE_CUBE_MAP,je.TEXTURE_MAG_FILTER,je.LINEAR);for(let st=0;st<6;++st)je.texImage2D(je.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,je.RGBA,32,32,0,je.RGBA,je.UNSIGNED_BYTE,null)}Be.bindFramebuffer.set(Ie.framebuffer),Be.viewport.set([0,0,32,32]);const Le=re.getCenter(W,!0),Ze=W.useProgram("skyboxCapture"),He=new Float64Array(16);a.identity(He),a.rotateY(He,He,.5*-Math.PI),Ga(Be,re,Ze,He,Le,0),a.identity(He),a.rotateY(He,He,.5*Math.PI),Ga(Be,re,Ze,He,Le,1),a.identity(He),a.rotateX(He,He,.5*-Math.PI),Ga(Be,re,Ze,He,Le,2),a.identity(He),a.rotateX(He,He,.5*Math.PI),Ga(Be,re,Ze,He,Le,3),a.identity(He),Ga(Be,re,Ze,He,Le,4),a.identity(He),a.rotateY(He,He,Math.PI),Ga(Be,re,Ze,He,Le,5),Be.viewport.set([0,0,W.width,W.height])}(u,l),l.markSkyboxValid(u)):"sky"===u.renderPass&&function(W,re,we,Ue,Be){const je=W.context,Ie=je.gl,Le=W.transform,Ze=W.useProgram("skybox");je.activeTexture.set(Ie.TEXTURE0),Ie.bindTexture(Ie.TEXTURE_CUBE_MAP,re.skyboxTexture);const He={u_matrix:Le.skyboxMatrix,u_sun_direction:re.getCenter(W,!1),u_cubemap:0,u_opacity:Ue,u_temporal_offset:Be};W.prepareDrawProgram(je,Ze),Ze.draw(je,Ie.TRIANGLES,we,a.StencilMode.disabled,W.colorModeForRenderPass(),a.CullFaceMode.backCW,He,"skybox",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(u,l,F,b,q):"gradient"===O&&"sky"===u.renderPass&&function(W,re,we,Ue,Be){const je=W.context,Ie=je.gl,Le=W.transform,Ze=W.useProgram("skyboxGradient");re.skyboxGeometry||(re.skyboxGeometry=new Ha(je)),je.activeTexture.set(Ie.TEXTURE0);let He=re.colorRampTexture;He||(He=re.colorRampTexture=new a.Texture(je,re.colorRamp,Ie.RGBA)),He.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE);const st=(St=Le.skyboxMatrix,Mt=re.getCenter(W,!1),jt=re.paint.get("sky-gradient-radius"),un=Ue,rn=Be,{u_matrix:St,u_color_ramp:0,u_center_direction:Mt,u_radius:a.degToRad(jt),u_opacity:un,u_temporal_offset:rn});var St,Mt,jt,un,rn;W.prepareDrawProgram(je,Ze),Ze.draw(je,Ie.TRIANGLES,we,a.StencilMode.disabled,W.colorModeForRenderPass(),a.CullFaceMode.backCW,st,"skyboxGradient",re.skyboxGeometry.vertexBuffer,re.skyboxGeometry.indexBuffer,re.skyboxGeometry.segment)}(u,l,F,b,q)},debug:function(u,t,l){for(let p=0;p<l.length;p++)Mc(u,t,l[p])},custom:function(u,t,l){const p=u.context,_=l.implementation;if(u.transform.projection.unsupportedLayers&&u.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===u.renderPass){const b=_.prerender;b&&(u.setCustomLayerDefaults(),p.setColorMode(u.colorModeForRenderPass()),b.call(_,p.gl,u.transform.customLayerMatrix()),p.setDirty(),u.setBaseState())}else if("translucent"===u.renderPass){u.setCustomLayerDefaults(),p.setColorMode(u.colorModeForRenderPass()),p.setStencilMode(a.StencilMode.disabled);const b="3d"===_.renderingMode?new a.DepthMode(u.context.gl.LEQUAL,a.DepthMode.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,a.DepthMode.ReadOnly);p.setDepthMode(b),_.render(p.gl,u.transform.customLayerMatrix()),p.setDirty(),u.setBaseState(),p.bindFramebuffer.set(null)}}};class cl{constructor(t,l){this.context=new Q(t),this.transform=l,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Is,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,l){const p=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Mo(this,t));const _=this._terrain;this.transform.elevation=p?_:null,_.update(t,this.transform,l)}_updateFog(t){const l=t.fog;if(!l||"globe"===this.transform.projection.name||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,_]=l.getFovAdjustedRange(this.transform._fov);if(p>_)return void(this.transform.fogCullDistSq=null);const b=p+.78*(_-p);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,l){if(this.width=t*a.exported.devicePixelRatio,this.height=l*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const t=this.context,l=new a.StructArrayLayout2i4;l.emplaceBack(0,0),l.emplaceBack(a.EXTENT,0),l.emplaceBack(0,a.EXTENT),l.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(l,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const p=new a.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(a.EXTENT,0),p.emplaceBack(0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=t.createVertexBuffer(p,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const _=new a.StructArrayLayout2i4;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(_,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const b=new a.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(a.EXTENT,0,a.EXTENT,0),b.emplaceBack(0,a.EXTENT,0,a.EXTENT),b.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(b,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const M=new a.StructArrayLayout3ui6;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(M);const O=new a.StructArrayLayout1ui2;for(const q of[0,1,3,2,0])O.emplaceBack(q);this.debugIndexBuffer=t.createIndexBuffer(O),this.emptyTexture=new a.Texture(t,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=a.create();const F=this.context.gl;this.stencilClearMode=new a.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new mr(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,l=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,l.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,xi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,l,p){if(!l||this.currentStencilSource===l.id||!t.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const F of p)if(void 0===this._tileClippingMaskIDs[F.key]){O=!0;break}if(!O)return}this.currentStencilSource=l.id;const _=this.context,b=_.gl;this.nextStencilID+p.length>256&&this.clearStencil(),_.setColorMode(a.ColorMode.disabled),_.setDepthMode(a.DepthMode.disabled);const M=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const F=l.getTile(O),q=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:re,tileBoundsSegments:we}=this.getTileBoundsBuffers(F);M.draw(_,b.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:b.ALWAYS,mask:0},q,255,b.KEEP,b.KEEP,b.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,xi(O.projMatrix),"$clipping",W,re,we)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,l=this.context.gl;return new a.StencilMode({func:l.NOTEQUAL,mask:255},t,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const l=this.context.gl;return new a.StencilMode({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(t){const l=this.context.gl,p=t.sort((M,O)=>O.overscaledZ-M.overscaledZ),_=p[p.length-1].overscaledZ,b=p[0].overscaledZ-_+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const M={};for(let O=0;O<b;O++)M[O+_]=new a.StencilMode({func:l.GEQUAL,mask:255},O+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=b,[M,p]}return[{[_]:a.StencilMode.disabled},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([t.CONSTANT_COLOR,t.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(t,l,p){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new a.DepthMode(p||this.context.gl.LEQUAL,l,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,l){this.style=t,this.options=l,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const p=this.style.order,_=this.style._sourceCaches;for(const F in _){const q=_[F];q.used&&q.prepare(this.context)}const b={},M={},O={};for(const F in _){const q=_[F];b[F]=q.getVisibleCoordinates(),M[F]=b[F].slice().reverse(),O[F]=q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let F=0;F<p.length;F++)if(this.style._layers[p[F]].is3D()){this.opaquePassCutoff=F;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),a.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const F of p){const q=this.style._layers[F],W=t._getLayerSourceCache(q);if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const re=W?M[W.id]:void 0;("custom"===q.type||q.isSky()||re&&re.length)&&this.renderLayer(this,W,q,re)}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:l.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const F=this.style._layers[p[this.currentLayer]],q=t._getLayerSourceCache(F);if(F.isSky())continue;const W=q?M[q.id]:void 0;this._renderTileClippingMasks(F,q,W),this.renderLayer(this,q,F,W)}if(this.style.fog&&this.transform.projection.supportsFog&&function(F,q){const W=F.context,re=W.gl,we=F.transform,Ue=new a.DepthMode(re.LEQUAL,a.DepthMode.ReadOnly,[0,1]),Be=F.useProgram("globeAtmosphere",null,"globe"===we.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),je=a.globeToMercatorTransition(we.zoom),Ie=q.properties.get("color").toArray01(),Le=q.properties.get("high-color").toArray01(),Ze=q.properties.get("space-color").toArray01PremultipliedAlpha(),He=a.identity$1([]);a.rotateY$1(He,He,-a.degToRad(we._center.lng)),a.rotateX$1(He,He,a.degToRad(we._center.lat)),a.rotateZ$1(He,He,we.angle),a.rotateX$1(He,He,-we._pitch);const st=a.fromQuat(new Float32Array(16),He),St=a.mapValue(q.properties.get("star-intensity"),0,1,0,.25),jt=a.mapValue(q.properties.get("horizon-blend"),0,1,5e-4,.25),un=a.globeUseCustomAntiAliasing(F,W,we)&&5e-4===jt?we.worldSize/(2*Math.PI*1.025)-1:we.globeRadius,rn=F.frameCounter/1e3%1,Wt=a.length(we.globeCenterInViewSpace),Xn=Math.sqrt(Math.pow(Wt,2)-Math.pow(un,2)),tn=Math.acos(Xn/Wt),In={u_frustum_tl:we.frustumCorners.TL,u_frustum_tr:we.frustumCorners.TR,u_frustum_br:we.frustumCorners.BR,u_frustum_bl:we.frustumCorners.BL,u_horizon:we.frustumCorners.horizon,u_transition:je,u_fadeout_range:jt,u_color:Ie,u_high_color:Le,u_space_color:Ze,u_star_intensity:St,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:rn,u_horizon_angle:tn,u_rotation_matrix:st};F.prepareDrawProgram(W,Be);const _n=F.atmosphereBuffer;_n&&Be.draw(W,re.TRIANGLES,Ue,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,In,"skybox",_n.vertexBuffer,_n.indexBuffer,_n.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const F=this.style._layers[p[this.currentLayer]],q=t._getLayerSourceCache(F);F.isSky()&&this.renderLayer(this,q,F,q?M[q.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const F=this.style._layers[p[this.currentLayer]],q=t._getLayerSourceCache(F);if(F.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(F)){if(F.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const W=q?("symbol"===F.type?O:M)[q.id]:void 0;this._renderTileClippingMasks(F,q,q?b[q.id]:void 0),this.renderLayer(this,q,F,W),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let F=null;a.values(this.style._layers).forEach(q=>{const W=t._getLayerSourceCache(q);W&&!q.isHidden(this.transform.zoom)&&(!F||F.getSource().maxzoom<W.getSource().maxzoom)&&(F=W)}),F&&this.options.showTileBoundaries&&Ia.debug(this,F,F.getVisibleCoordinates())}this.options.showPadding&&function(F){const q=F.transform.padding;Lo(F,F.transform.height-(q.top||0),3,ll),Lo(F,q.bottom||0,3,ac),qs(F,q.left||0,3,Nl),qs(F,F.transform.width-(q.right||0),3,vl);const W=F.transform.centerPoint;var re,we,Ue,Be;Sr(re=F,(we=W.x)-1,(Ue=F.transform.height-W.y)-10,2,20,Be=Ws),Sr(re,we-10,Ue-1,20,2,Be)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}}renderLayer(t,l,p,_){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||_&&_.length)&&(this.id=p.id,this.gpuTimingStart(p),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(p.type)||Ia[p.type](t,l,p,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;let p=this.gpuTimers[t.id];p||(p=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:l.createQueryEXT()}),p.calls++,l.beginQueryEXT(l.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,l=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(l),t.beginQueryEXT(t.TIME_ELAPSED_EXT,l)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const l={};for(const p in t){const _=t[p],b=this.context.extTimerQuery,M=b.getQueryObjectEXT(_.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(_.query),l[p]=M}return l}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.extTimerQuery;let p=0;for(const _ of t)p+=l.getQueryObjectEXT(_,l.QUERY_RESULT_EXT)/1e6,l.deleteQueryEXT(_);return p}translatePosMatrix(t,l,p,_,b){if(!p[0]&&!p[1])return t;const M=b?"map"===_?this.transform.angle:0:"viewport"===_?-this.transform.angle:0;if(M){const q=Math.sin(M),W=Math.cos(M);p=[p[0]*W-p[1]*q,p[0]*q+p[1]*W]}const O=[b?p[0]:Zt(l,p[0],this.transform.zoom),b?p[1]:Zt(l,p[1],this.transform.zoom),0],F=new Float32Array(16);return a.translate(F,t,O),F}saveTileTexture(t){const l=this._tileTextures[t.size[0]];l?l.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const l=this._tileTextures[t];return l&&l.length>0?l.pop():null}isPatternMissing(t){return null===t||void 0!==t&&!this.imageManager.getPattern(t.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,l=this.terrain&&0===this.terrain.exaggeration(),p=this.style&&this.style.fog,_=[];return this.terrainRenderModeElevated()&&_.push("TERRAIN"),"globe"===this.transform.projection.name&&_.push("GLOBE"),l&&_.push("ZERO_EXAGGERATION"),p&&!t&&0!==p.getOpacity(this.transform.pitch)&&_.push("FOG"),t&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(t,l,p){this.cache=this.cache||{};const _=p||[],b=this.currentGlobalDefines().concat(_),M=Rs.cacheKey(ia[t],t,b,l);return this.cache[M]||(this.cache[M]=new Rs(this.context,t,ia[t],l,_l[t],b)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,l,p){if(this.terrain&&this.terrain.renderingToTexture)return;const _=this.style.fog;if(_){const b=_.getOpacity(this.transform.pitch),M=((O,F,q,W,re,we,Ue,Be,je,Ie,Le)=>{const Ze=O.transform,He=F.properties.get("color").toArray01();He[3]=W;const st=O.frameCounter/1e3%1;return{u_fog_matrix:q?Ze.calculateFogTileMatrix(q):O.identityMat,u_fog_range:F.getFovAdjustedRange(Ze._fov),u_fog_color:He,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_temporal_offset:st,u_frustum_tl:re,u_frustum_tr:we,u_frustum_br:Ue,u_frustum_bl:Be,u_globe_pos:je,u_globe_radius:Ie,u_viewport:Le,u_globe_transition:a.globeToMercatorTransition(Ze.zoom),u_is_globe:+("globe"===Ze.projection.name)}})(this,_,p,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);l.setFogUniformValues(t,M)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,l=t.createTexture();return t.bindTexture(t.TEXTURE_2D,l),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,l=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const _ of p)l[_.key]=t[_.key]||new a.Tile(_,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}}class U{constructor(t=0,l=0,p=0,_=0){if(isNaN(t)||t<0||isNaN(l)||l<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=l,this.left=p,this.right=_}interpolate(t,l,p){return null!=l.top&&null!=t.top&&(this.top=a.number(t.top,l.top,p)),null!=l.bottom&&null!=t.bottom&&(this.bottom=a.number(t.bottom,l.bottom,p)),null!=l.left&&null!=t.left&&(this.left=a.number(t.left,l.left,p)),null!=l.right&&null!=t.right&&(this.right=a.number(t.right,l.right,p)),this}getCenter(t,l){const p=a.clamp((this.left+t-this.right)/2,0,t),_=a.clamp((this.top+l-this.bottom)/2,0,l);return new a.pointGeometry(p,_)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new U(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function se(u,t){const l=a.getColumn(u,3);a.fromQuat(u,t),a.setColumn(u,3,l)}function Z(u,t){const l=a.identity$1([]);return a.rotateZ$1(l,l,-t),a.rotateX$1(l,l,-u),l}function _e(u,t){const l=[u[0],u[1],0],p=[t[0],t[1],0];if(a.length(l)>=1e-15){const M=a.normalize([],l);a.scale$2(p,M,a.dot(p,M)),t[0]=p[0],t[1]=p[1]}const _=a.cross([],t,u);if(a.len(_)<1e-15)return null;const b=Math.atan2(-_[1],_[0]);return Z(Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2]),b)}class pt{constructor(t,l){this.position=t,this.orientation=l}get position(){return this._position}set position(t){if(t){const l=t instanceof a.MercatorCoordinate?t:new a.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(l.x=a.wrap(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(t,l){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(t)):0,_=this.position,b=a.MercatorCoordinate.fromLngLat(t,p),M=[b.x-_.x,b.y-_.y,b.z-_.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=_e(M,l)}setPitchBearing(t,l){this.orientation=Z(a.degToRad(t),a.degToRad(-l))}}class En{constructor(t,l){this._transform=a.identity([]),this.orientation=l,this.position=t}get mercatorPosition(){const t=this.position;return new a.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=a.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var l;t&&a.setColumn(this._transform,3,[(l=t)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||a.identity$1([]),t&&se(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,l){this._orientation=Z(t,l),se(this._transform,this._orientation)}forward(){const t=a.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=a.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=a.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,l){const p=new Float64Array(16);return a.invert(p,this.getWorldToCamera(t,l)),p}getWorldToCameraPosition(t,l,p){const _=this.position;a.scale$2(_,_,-t);const b=new Float64Array(16);return a.fromScaling(b,[p,p,p]),a.translate(b,b,_),b[10]*=l,b}getWorldToCamera(t,l){const p=new Float64Array(16),_=new Float64Array(4),b=this.position;return a.conjugate(_,this._orientation),a.scale$2(b,b,-t),a.fromQuat(p,_),a.translate(p,p,b),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=l,p[9]*=l,p[10]*=l,p[11]*=l,p}getCameraToClipPerspective(t,l,p,_){const b=new Float64Array(16);return a.perspective(b,t,l,p,_),b}getDistanceToElevation(t,l=!1){const p=0===t?0:a.mercatorZfromAltitude(t,l?a.latFromMercatorY(this.position[1]):this.position[1]),_=this.forward();return(p-this.position[2])/_[2]}clone(){return new En([...this.position],[...this.orientation])}}function kn(u,t){const l=br(u.projection,u.zoom,u.width,u.height),p=function(b,M,O,F,q){const W=new a.LngLat(O.lng-180*xr,O.lat),re=new a.LngLat(O.lng+180*xr,O.lat),we=b.project(W.lng,W.lat),Ue=b.project(re.lng,re.lat),Be=-Math.atan2(Ue.y-we.y,Ue.x-we.x),je=a.MercatorCoordinate.fromLngLat(O);je.y=a.clamp(je.y,-.999975,.999975);const Ie=je.toLngLat(),Le=b.project(Ie.lng,Ie.lat),Ze=a.MercatorCoordinate.fromLngLat(Ie);Ze.x+=xr;const He=Ze.toLngLat(),st=b.project(He.lng,He.lat),St=Xi(st.x-Le.x,st.y-Le.y,Be),Mt=a.MercatorCoordinate.fromLngLat(Ie);Mt.y+=xr;const jt=Mt.toLngLat(),un=b.project(jt.lng,jt.lat),rn=Xi(un.x-Le.x,un.y-Le.y,Be),Wt=Math.abs(St.x)/Math.abs(rn.y),Xn=a.identity([]);a.rotateZ(Xn,Xn,-Be*(1-(q?0:F)));const tn=a.identity([]);return a.scale(tn,tn,[1,1-(1-Wt)*F,1]),tn[4]=-rn.x/rn.y*F,a.rotateZ(tn,tn,Be),a.multiply(tn,Xn,tn),tn}(u.projection,0,u.center,l,t),_=wi(u);return a.scale(p,p,[_,_,1]),p}function wi(u){const t=u.projection,l=br(u.projection,u.zoom,u.width,u.height),p=Er(t,u.center),_=Er(t,a.LngLat.convert(t.center));return Math.pow(2,p*l+(1-l)*_)}function br(u,t,l,p,_=1/0){const b=u.range;if(!b)return 0;const M=Math.min(_,Math.max(l,p)),O=Math.log(M/1024)/Math.LN2;return a.smoothstep(b[0]+O,b[1]+O,t)}const xr=1/4e4;function Er(u,t){const l=a.clamp(t.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=new a.LngLat(t.lng-180*xr,l),_=new a.LngLat(t.lng+180*xr,l),b=u.project(p.lng,l),M=u.project(_.lng,l),O=a.MercatorCoordinate.fromLngLat(p),F=a.MercatorCoordinate.fromLngLat(_),q=M.x-b.x,W=M.y-b.y,re=F.x-O.x,we=F.y-O.y,Ue=Math.sqrt((re*re+we*we)/(q*q+W*W));return Math.log(Ue)/Math.LN2}function Xi(u,t,l){const p=Math.cos(l),_=Math.sin(l);return{x:u*p-t*_,y:u*_+t*p}}class Yr{constructor(t,l,p,_,b,M,O){this.tileSize=512,this._renderWorldCopies=void 0===b||b,this._minZoom=t||0,this._maxZoom=l||22,this._minPitch=p??0,this._maxPitch=_??60,this.setProjection(M),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new U,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new En,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new Yr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t,l=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||p)&&this._updateCameraOnTerrain(),(t||p)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const p=!de(l,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const l=t!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const l=-t*Math.PI/180;var p,_,b,M,O,F,q,W,re,we;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=(p=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),_=this.rotationMatrix,M=this.angle,O=(b=this.rotationMatrix)[0],F=b[1],q=b[2],W=b[3],re=Math.sin(M),we=Math.cos(M),_[0]=O*we+q*re,_[1]=F*we+W*re,_[2]=O*-re+q*we,_[3]=F*-re+W*we)}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const l=a.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=a.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const l=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let _=0,b=0;for(let M=0;M<l.length;M++){const O=new a.pointGeometry(l[M][0]*this.width,p+l[M][1]*(this.height-p)),F=t.pointCoordinate(O);if(!F)continue;const q=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);_+=F[3]*q,b+=q}return 0===b?NaN:_/b}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*l,_=this._mercatorZfromZoom(t),b=this._mercatorZfromZoom(this._maxZoom),M=Math.max(_-p,b);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let p;p=t.z<this._camera.position[2]?[l.x,l.y,l.z]:[t.x,t.y,t.z];const _=a.length(a.sub([],this._camera.position,p));return a.clamp(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let l=!1;if(t.orientation&&!a.exactEquals(t.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(t.orientation)),t.position){const p=[t.position.x,t.position.y,t.position.z];a.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,l=new pt;return l.position=new a.MercatorCoordinate(t[0],t[1],t[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(t){if(!a.length$1(t))return!1;a.normalize$1(t,t);const l=a.transformQuat([],[0,0,-1],t),p=a.transformQuat([],[0,-1,0],t);if(p[2]<0)return!1;const _=_e(l,p);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(t){const l=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;t[2]=a.clamp(t[2],_/p,_/l),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,l,p){this._unmodified=!1,this._edgeInsets.interpolate(t,l,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const l=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(t){const l=[new a.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const p=this.pointCoordinate(new a.pointGeometry(0,0)),_=this.pointCoordinate(new a.pointGeometry(this.width,0)),b=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),M=this.pointCoordinate(new a.pointGeometry(0,this.height)),O=Math.floor(Math.min(p.x,_.x,b.x,M.x)),F=Math.floor(Math.max(p.x,_.x,b.x,M.x)),q=1;for(let W=O-q;W<=F+q;W++)0!==W&&l.push(new a.UnwrappedTileID(W,t))}return l}coveringTiles(t){let l=this.coveringZoomLevel(t);const p=l,_=this.elevation&&!t.isTerrainDEM,b="mercator"===this.projection.name;if(void 0!==t.minzoom&&l<t.minzoom)return[];void 0!==t.maxzoom&&l>t.maxzoom&&(l=t.maxzoom);const M=this.locationCoordinate(this.center),O=this.center.lat,F=1<<l,q=[F*M.x,F*M.y,0],W="globe"===this.projection.name,re=!W,we=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,re),Ue=W?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Be=F*a.mercatorZfromAltitude(1,this.center.lat),je=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),Ie=[F*Ue.x,F*Ue.y,je*(re?1:Be)],Le=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Ze=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?l:0,He=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,st=t.isTerrainDEM?-He:this._elevation?this._elevation.getMinElevationBelowMSL():0,St=this.projection.isReprojectedInTileSpace?wi(this):1,Mt=xn=>{const qn=new a.MercatorCoordinate(xn.x+25e-6,xn.y,xn.z),qt=new a.MercatorCoordinate(xn.x,xn.y+25e-6,xn.z),gn=xn.toLngLat(),_i=qn.toLngLat(),ki=qt.toLngLat(),yi=this.locationCoordinate(gn),Wi=this.locationCoordinate(_i),cr=this.locationCoordinate(ki),Oi=Math.hypot(Wi.x-yi.x,Wi.y-yi.y),di=Math.hypot(cr.x-yi.x,cr.y-yi.y);return Math.sqrt(Oi*di)*St/25e-6},jt=xn=>{const zn=He,qn=st;return{aabb:a.tileAABB(this,F,0,0,0,xn,qn,zn,this.projection),zoom:0,x:0,y:0,minZ:qn,maxZ:zn,wrap:xn,fullyVisible:!1}},un=[];let rn=[];const Wt=l,Xn=t.reparseOverscaled?p:l,tn=xn=>xn*xn,In=tn((je-this._centerAltitude)*Be),_n=xn=>{if(!this._elevation||!xn.tileID||!b)return;const zn=this._elevation.getMinMaxForTile(xn.tileID),qn=xn.aabb;zn?(qn.min[2]=zn.min,qn.max[2]=zn.max,qn.center[2]=(qn.min[2]+qn.max[2])/2):(xn.shouldSplit=$n(xn),xn.shouldSplit||(qn.min[2]=qn.max[2]=qn.center[2]=this._centerAltitude))},$n=xn=>{if(xn.zoom<Ze)return!0;if(xn.zoom===Wt)return!1;if(null!=xn.shouldSplit)return xn.shouldSplit;const zn=xn.aabb.distanceX(Ie),qn=xn.aabb.distanceY(Ie);let qt=In,gn=1;if(W){qt=tn(xn.aabb.distanceZ(Ie));const yi=Math.pow(2,xn.zoom),Wi=a.latFromMercatorY((xn.y+1)/yi),cr=a.latFromMercatorY(xn.y/yi),Oi=Math.min(Math.max(O,Wi),cr),di=a.circumferenceAtLatitude(Oi)/a.circumferenceAtLatitude(O);if(gn=Oi===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,di/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&xn.zoom===Wt-1&&di>=.9)return!0}else if(_&&(qt=tn(xn.aabb.distanceZ(Ie)*Be)),this.projection.isReprojectedInTileSpace&&p<=5){const yi=Math.pow(2,xn.zoom),Wi=Mt(new a.MercatorCoordinate((xn.x+.5)/yi,(xn.y+.5)/yi));gn=Wi>.85?1:Wi}const _i=zn*zn+qn*qn+qt;return _i<tn((1<<Wt-xn.zoom)*Le*gn*((yi,Wi)=>{if(Wi*tn(.707)<yi)return 1;const cr=Math.sqrt(Wi/yi);return cr/(1.4144271570014144+(Math.pow(1.1,cr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(qt,In),_i))};if(this.renderWorldCopies)for(let xn=1;xn<=3;xn++)un.push(jt(-xn)),un.push(jt(xn));for(un.push(jt(0));un.length>0;){const xn=un.pop(),zn=xn.x,qn=xn.y;let qt=xn.fullyVisible;if(!qt){const gn=xn.aabb.intersects(we);if(0===gn)continue;qt=2===gn}if(xn.zoom!==Wt&&$n(xn))for(let gn=0;gn<4;gn++){const _i=(zn<<1)+gn%2,ki=(qn<<1)+(gn>>1),yi={aabb:b?xn.aabb.quadrant(gn):a.tileAABB(this,F,xn.zoom+1,_i,ki,xn.wrap,xn.minZ,xn.maxZ,this.projection),zoom:xn.zoom+1,x:_i,y:ki,wrap:xn.wrap,fullyVisible:qt,tileID:void 0,shouldSplit:void 0,minZ:xn.minZ,maxZ:xn.maxZ};_&&!W&&(yi.tileID=new a.OverscaledTileID(xn.zoom+1===Wt?Xn:xn.zoom+1,xn.wrap,xn.zoom+1,_i,ki),_n(yi)),un.push(yi)}else{const gn=xn.zoom===Wt?Xn:xn.zoom;if(t.minzoom&&t.minzoom>gn)continue;const _i=q[0]-(.5+zn+(xn.wrap<<xn.zoom))*(1<<l-xn.zoom),ki=q[1]-.5-qn,yi=xn.tileID?xn.tileID:new a.OverscaledTileID(gn,xn.wrap,xn.zoom,zn,qn);rn.push({tileID:yi,distanceSq:_i*_i+ki*ki})}}if(this.fogCullDistSq){const xn=this.fogCullDistSq,zn=this.horizonLineFromTop();rn=rn.filter(qn=>{const qt=[0,0,0,1],gn=[a.EXTENT,a.EXTENT,0,1],_i=this.calculateFogTileMatrix(qn.tileID.toUnwrapped());a.transformMat4$1(qt,qt,_i),a.transformMat4$1(gn,gn,_i);const ki=a.getAABBPointSquareDist(qt,gn);if(0===ki)return!0;let yi=!1;const Wi=this._elevation;if(Wi&&ki>xn&&0!==zn){const cr=this.calculateProjMatrix(qn.tileID.toUnwrapped());let Oi;t.isTerrainDEM||(Oi=Wi.getMinMaxForTile(qn.tileID)),Oi||(Oi={min:st,max:He});const di=a.furthestTileCorner(this.rotation),Qr=[di[0]*a.EXTENT,di[1]*a.EXTENT,Oi.max];a.transformMat4(Qr,Qr,cr),yi=(1-Qr[1])*this.height*.5<zn}return ki<xn||yi})}return rn.sort((xn,zn)=>xn.distanceSq-zn.distanceSq).map(xn=>xn.tileID)}resize(t,l){this.width=t,this.height=l,this.pixelsToGLUnits=[2/t,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const l=a.clamp(t.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),p=this.projection.project(t.lng,l);return new a.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,l){let p,_;const b=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;p=(l.x-b.x)/O,_=(l.y-b.y)/O}else{const O=this.pointCoordinate(l),F=this.pointCoordinate(b);p=O.x-F.x,_=O.y-F.y}const M=this.locationCoordinate(t);this.setLocation(new a.MercatorCoordinate(M.x-p,M.y-_))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,l){const p=l?a.mercatorZfromAltitude(l,t.lat):void 0,_=this.projection.project(t.lng,t.lat);return new a.MercatorCoordinate(_.x,_.y,p)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,l){const p=l??this._centerAltitude,_=[t.x,t.y,0,1],b=[t.x,t.y,1,1];a.transformMat4$1(_,_,this.pixelMatrixInverse),a.transformMat4$1(b,b,this.pixelMatrixInverse);const M=b[3];a.scale$1(_,_,1/_[3]),a.scale$1(b,b,1/M);const O=_[2],F=b[2];return{p0:_,p1:b,t:O===F?0:(p-O)/(F-O)}}screenPointToMercatorRay(t){const l=[t.x,t.y,0,1],p=[t.x,t.y,1,1];return a.transformMat4$1(l,l,this.pixelMatrixInverse),a.transformMat4$1(p,p,this.pixelMatrixInverse),a.scale$1(l,l,1/l[3]),a.scale$1(p,p,1/p[3]),l[2]=a.mercatorZfromAltitude(l[2],this._center.lat)*this.worldSize,p[2]=a.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,a.scale$1(l,l,1/this.worldSize),a.scale$1(p,p,1/this.worldSize),new a.Ray([l[0],l[1],l[2]],a.normalize([],a.sub([],p,l)))}rayIntersectionCoordinate(t){const{p0:l,p1:p,t:_}=t,b=a.mercatorZfromAltitude(l[2],this._center.lat),M=a.mercatorZfromAltitude(p[2],this._center.lat);return new a.MercatorCoordinate(a.number(l[0],p[0],_)/this.worldSize,a.number(l[1],p[1],_)/this.worldSize,a.number(b,M,_))}pointCoordinate(t,l=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,l)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let l=this.projection.pointCoordinate3D(this,t.x,t.y);if(l)return new a.MercatorCoordinate(l[0],l[1],l[2]);let p=0,_=this.horizonLineFromTop();if(t.y>_)return this.pointCoordinate(t);const b=.02*_,M=t.clone();for(let O=0;O<10&&_-p>b;O++){M.y=a.number(p,_,.66);const F=this.projection.pointCoordinate3D(this,M.x,M.y);F?(_=M.y,l=F):p=M.y}return l?new a.MercatorCoordinate(l[0],l[1],l[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}_coordinatePoint(t,l){const p=l&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,_=[t.x*this.worldSize,t.y*this.worldSize,p+t.toAltitude(),1];return a.transformMat4$1(_,_,this.pixelMatrix),_[3]>0?new a.pointGeometry(_[0]/_[3],_[1]/_[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:t,left:l}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,b=this.pointCoordinate3D(new a.pointGeometry(l,t)),M=this.pointCoordinate3D(new a.pointGeometry(_,t)),O=this.pointCoordinate3D(new a.pointGeometry(_,p)),F=this.pointCoordinate3D(new a.pointGeometry(l,p));let q=Math.min(b.x,F.x),W=Math.max(M.x,O.x),re=Math.min(b.y,M.y),we=Math.max(F.y,O.y);const Ue=Math.pow(2,-this.zoom)/16,Be=(Mt,jt,un,rn)=>{const Wt=(Mt+un)/2,Xn=(jt+rn)/2,tn=new a.pointGeometry(Wt,Xn),In=this.pointCoordinate3D(tn),_n=Math.max(0,q-In.x,re-In.y,In.x-W,In.y-we);q=Math.min(q,In.x),W=Math.max(W,In.x),re=Math.min(re,In.y),we=Math.max(we,In.y),_n>Ue&&(Be(Mt,jt,Wt,Xn),Be(Wt,Xn,un,rn))};Be(l,t,_,t),Be(_,t,_,p),Be(_,p,l,p),Be(l,p,l,t);const[je,Ie]=a.polesInViewport(this),Le=je||Ie,Ze=je?90:a.latFromMercatorY(re),He=Le?180:a.lngFromMercatorX(W),st=Ie?-90:a.latFromMercatorY(we),St=Le?-180:a.lngFromMercatorX(q);return new a.LngLatBounds(new a.LngLat(St,st),new a.LngLat(He,Ze))}_getBounds(t,l){if("globe"===this.projection.name)return this._getGlobeBounds();const p=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),_=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),b=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),M=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let O=this.pointCoordinate(p,t),F=this.pointCoordinate(_,t);const q=this.pointCoordinate(b,l),W=this.pointCoordinate(M,l),re=(we,Ue)=>(Ue.y-we.y)/(Ue.x-we.x);return O.y>1&&F.y>=0?O=new a.MercatorCoordinate((1-W.y)/re(W,O)+W.x,1):O.y<0&&F.y<=1&&(O=new a.MercatorCoordinate(-W.y/re(W,O)+W.x,0)),F.y>1&&O.y>=0?F=new a.MercatorCoordinate((1-q.y)/re(q,F)+q.x,1):F.y<0&&O.y<=1&&(F=new a.MercatorCoordinate(-q.y/re(q,F)+q.x,0)),(new a.LngLatBounds).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(q))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBounds(0,0);const l=t.visibleDemTiles.reduce((p,_)=>{if(_.dem){const b=_.dem.tree;p.min=Math.min(p.min,b.minimums[0]),p.max=Math.max(p.max,b.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(l.min*t.exaggeration(),l.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-l*(1-this._horizonShift);return t?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,l){return this.projection.createTileMatrix(this,l,t)}calculateDistanceTileData(t){const l=t.key,p=this._distanceTileDataCache;if(p[l])return p[l];const _=t.canonical,b=1/this.height,M=this.cameraWorldSize,O=M/this.zoomScale(_.z),F=(_.x+Math.pow(2,_.z)*t.wrap)*O,q=_.y*O,W=this.point;W.x*=M/this.worldSize,W.y*=M/this.worldSize;const re=this.angle,we=Math.sin(-re),Ue=-Math.cos(-re);return p[l]={bearing:[we,Ue],center:[(W.x-F)*b,(W.y-q)*b],scale:O/a.EXTENT*b},p[l]}calculateFogTileMatrix(t){const l=t.key,p=this._fogTileMatrixCache;if(p[l])return p[l];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return a.multiply(_,this.worldToFogMatrix,_),p[l]=new Float32Array(_),p[l]}calculateProjMatrix(t,l=!1){const p=t.key,_=l?this._alignedProjMatrixCache:this._projMatrixCache;if(_[p])return _[p];const b=this.calculatePosMatrix(t,this.worldSize);return a.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:l?this.alignedProjMatrix:this.projMatrix,b),_[p]=new Float32Array(b),_[p]}calculatePixelsToTileUnitsMatrix(t){const l=t.tileID.key,p=this._pixelsToTileUnitsCache;if(p[l])return p[l];const _=function(b,M){const{scale:O}=b.tileTransform,F=O*a.EXTENT/(b.tileSize*Math.pow(2,M.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return q=new Float32Array(4),we=(W=M.inverseAdjustmentMatrix)[1],Ue=W[2],Be=W[3],Ie=(re=[F,F])[1],q[0]=W[0]*(je=re[0]),q[1]=we*je,q[2]=Ue*Ie,q[3]=Be*Ie,q;var q,W,re,we,Ue,Be,je,Ie}(t,this);return p[l]=_,p[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const l=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(l),_=this._camera.forward(),b=a.mercatorZfromAltitude(1,this._center.lat);p[2]/=b,_[2]/=b,a.normalize(_,_);const M=t.raycast(p,_,t.exaggeration());if(M){const O=a.scaleAndAdd([],p,_,M),F=new a.MercatorCoordinate(O[0],O[1],a.mercatorZfromAltitude(O[2],a.latFromMercatorY(O[1]))),q=(F.z+a.length([F.x-p[0],F.y-p[1],F.z-p[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(q),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const l=this._elevation,p=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),b=l.getAtPointOrZero(new a.MercatorCoordinate(..._)),M=this.pixelsPerMeter/this.worldSize*b,O=this._minimumHeightOverTerrain(),F=_[2]-M;if(F<=O)if(F<0||t){const q=this.locationCoordinate(this._center,this._centerAltitude),W=[_[0],_[1],q.z-_[2]],re=a.length(W);W[2]-=(O-F)/this._pixelsPerMercatorPixel;const we=a.length(W);if(0===we)return;a.scale$2(W,W,re/we*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],q.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const we=this.center;return we.lat=a.clamp(we.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(we.lng=a.clamp(we.lng,this.minLng,this.maxLng)),this.center=we,void(this._constraining=!1)}const l=this._unmodified,{x:p,y:_}=this.point;let b=0,M=p,O=_;const F=this.width/2,q=this.height/2,W=this.worldMinY*this.scale,re=this.worldMaxY*this.scale;if(_-q<W&&(O=W+q),_+q>re&&(O=re-q),re-W<this.height&&(b=Math.max(b,this.height/(re-W)),O=(re+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const we=this.worldMinX*this.scale,Ue=this.worldMaxX*this.scale,Be=this.worldSize/2-(we+Ue)/2;M=(p+Be+this.worldSize)%this.worldSize-Be,M-F<we&&(M=we+F),M+F>Ue&&(M=Ue-F),Ue-we<this.width&&(b=Math.max(b,this.width/(Ue-we)),M=(Ue+we)/2)}M===p&&O===_||(this.center=this.unproject(new a.pointGeometry(M,O))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,l=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const p=br(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const _=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?l:1),b=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);b[8]=2*-t.x/this.width,b[9]=2*t.y/this.height;let M=a.mul([],b,_);if(this.projection.isReprojectedInTileSpace){const St=this.locationCoordinate(this.center),Mt=a.identity([]);a.translate(Mt,Mt,[St.x*this.worldSize,St.y*this.worldSize,0]),a.multiply(Mt,Mt,kn(this)),a.translate(Mt,Mt,[-St.x*this.worldSize,-St.y*this.worldSize,0]),a.multiply(M,M,Mt),this.inverseAdjustmentMatrix=function(jt){const un=kn(jt,!0);return Te([],[un[0],un[1],un[4],un[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],M,[this.worldSize,this.worldSize,this.worldSize/l,1]),this.projMatrix=M,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const O=a.invert([],b);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(O,this.horizonLineFromTop(),this.height);const F=new Float32Array(16);a.identity(F),a.scale(F,F,[1,-1,1]),a.rotateX(F,F,this._pitch),a.rotateZ(F,F,this.angle);const q=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),W=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;q[8]=2*-t.x/this.width,q[9]=2*(t.y+W)/this.height,this.skyboxMatrix=a.multiply(F,q,F);const re=this.point,we=re.x,Ue=re.y,Be=this.width%2/2,je=this.height%2/2,Ie=Math.cos(this.angle),Le=Math.sin(this.angle),Ze=we-Math.round(we)+Ie*Be+Le*je,He=Ue-Math.round(Ue)+Ie*je+Le*Be,st=new Float64Array(M);if(a.translate(st,st,[Ze>.5?Ze-1:Ze,He>.5?He-1:He,0]),this.alignedProjMatrix=st,M=a.create(),a.scale(M,M,[this.width/2,-this.height/2,1]),a.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=a.create(),a.scale(M,M,[1,-1,1]),a.translate(M,M,[-1,-1,0]),a.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=a.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const St=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(St,St,_),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,p=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,b=[t,t,l];a.scale$2(b,b,_),a.scale$2(p,p,-1),a.multiply$2(p,p,b);const M=a.create();a.translate(M,M,p),a.scale(M,M,b),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,l,_)}_computeCameraPosition(t){const l=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),_=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-t/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-p[0]*b,_.y/this.worldSize-p[1]*b,t/this.worldSize*this._centerAltitude-p[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],_=t[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(b=Math.min((l-p)/_,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,t,b),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,l=this._camera.forward(),{pitch:p,bearing:_}=this._camera.getPitchBearing(),b=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),O=Math.max((t[2]-b)/Math.cos(p),M),F=this._zoomFromMercatorZ(O);a.scaleAndAdd(t,t,l,O),this._pitch=a.clamp(p,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(_,-Math.PI,Math.PI),this._setZoom(a.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){const l=M=>{const O=this.getCameraToCenterDistance(this.projection,M);return this.scaleZoom(O/(t*this.tileSize))};let p,_=l(this.zoom),b=Math.abs(_-l(_));for(;p!==b;)_=l(_),p=b,b=Math.abs(_-l(_));return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,l){const p=Math.min(t.x,l.x),_=Math.max(t.x,l.x),b=Math.min(t.y,l.y),M=Math.max(t.y,l.y);if(b<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new a.pointGeometry(p,b),new a.pointGeometry(_,M),new a.pointGeometry(p,M),new a.pointGeometry(_,b)],F=this.renderWorldCopies?-3:0,q=this.renderWorldCopies?4:1;for(const W of O){const re=this.pointRayIntersection(W);if(re.t<0)return!0;const we=this.rayIntersectionCoordinate(re);if(we.x<F||we.y<0||we.x>q||we.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,l){const p=a.length(a.sub([],this._camera.position,t)),_=this._zoomFromMercatorZ(p)+l;return p-this._mercatorZfromZoom(_)}getCameraPoint(){if("globe"===this.projection.name){const t=function([l,p,_],b){const M=[l,p,_,1];a.transformMat4$1(M,M,b);const O=M[3]=Math.max(M[3],1e-6);return M[0]/=O,M[1]/=O,M[2]/=O,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,t))}}getCameraToCenterDistance(t,l=this.zoom){const p=br(t,l,this.width,this.height,1024),_=t.pixelSpaceConversion(this.center.lat,this.worldSize,p);return.5/Math.tan(.5*this._fov)*this.height*_}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&a.multiply(t,t,this.globeMatrix),t}}function hr(u,t){let l=!1,p=null;const _=()=>{p=null,l&&(u(),p=setTimeout(_,t),l=!1)};return()=>(l=!0,p||_(),p)}class Hn{constructor(t){this._hashName=t&&encodeURIComponent(t),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=hr(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,a.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const l=Kr(t);if(this._hashName){const p=this._hashName;let _=!1;const b=a.window.location.hash.slice(1).split("&").map(M=>{const O=M.split("=")[0];return O===p?(_=!0,`${O}=${l}`):M}).filter(M=>M);return _||b.push(`${p}=${l}`),`#${b.join("&")}`}return`#${l}`}_getCurrentHash(){const t=a.window.location.hash.replace("#","");if(this._hashName){let l;return t.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(l=p)}),(l&&l[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(p=>isNaN(p))){const p=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(l[3]||0):t.getBearing();return t.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:p,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,t)}}function Kr(u,t){const l=u.getCenter(),p=Math.round(100*u.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,_),M=Math.round(l.lng*b)/b,O=Math.round(l.lat*b)/b,F=u.getBearing(),q=u.getPitch();let W=t?`/${M}/${O}/${p}`:`${p}/${O}/${M}`;return(F||q)&&(W+="/"+Math.round(10*F)/10),q&&(W+=`/${Math.round(q)}`),W}const vo={linearity:.3,easing:a.bezier(0,0,.3,1)},Fs=a.extend({deceleration:2500,maxSpeed:1400},vo),Fo=a.extend({deceleration:20,maxSpeed:1400},vo),Go=a.extend({deceleration:1e3,maxSpeed:360},vo),oa=a.extend({deceleration:1e3,maxSpeed:90},vo);class Cs{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,l=a.exported.now();for(;t.length>0&&l-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const l={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)l.zoom+=b.zoomDelta||0,l.bearing+=b.bearingDelta||0,l.pitch+=b.pitchDelta||0,b.panDelta&&l.pan._add(b.panDelta),b.around&&(l.around=b.around),b.pinchAround&&(l.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(l.pan.mag()){const b=sa(l.pan.mag(),p,a.extend({},Fs,t||{}));_.offset=l.pan.mult(b.amount/l.pan.mag()),_.center=this._map.transform.center,$a(_,b)}if(l.zoom){const b=sa(l.zoom,p,Fo);_.zoom=this._map.transform.zoom+b.amount,$a(_,b)}if(l.bearing){const b=sa(l.bearing,p,Go);_.bearing=this._map.transform.bearing+a.clamp(b.amount,-179,179),$a(_,b)}if(l.pitch){const b=sa(l.pitch,p,oa);_.pitch=this._map.transform.pitch+b.amount,$a(_,b)}if(_.zoom||_.bearing){const b=void 0===l.pinchAround?l.around:l.pinchAround;_.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function $a(u,t){(!u.duration||u.duration<t.duration)&&(u.duration=t.duration,u.easing=t.easing)}function sa(u,t,l){const{maxSpeed:p,linearity:_,deceleration:b}=l,M=a.clamp(u*_/(t/1e3),-p,p),O=Math.abs(M)/(b*_);return{easing:l.easing,duration:1e3*O,amount:M*(O/2)}}class Bs extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p,_={}){const b=ht(l.getCanvasContainer(),p),M=l.unproject(b);super(t,a.extend({point:b,lngLat:M,originalEvent:p},_)),this._defaultPrevented=!1,this.target=l}}class bl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p){const _="touchend"===t?p.changedTouches:p.touches,b=Gt(l.getCanvasContainer(),_),M=b.map(F=>l.unproject(F)),O=b.reduce((F,q,W,re)=>F.add(q.div(re.length)),new a.pointGeometry(0,0));super(t,{points:b,point:O,lngLats:M,lngLat:l.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class ms extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,l,p){super(t,{originalEvent:p}),this._defaultPrevented=!1}}class ru{constructor(t,l){this._map=t,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new ms(t.type,this._map,t))}mousedown(t,l){return this._mousedownPos=l,this._firePreventable(new Bs(t.type,this._map,t))}mouseup(t){this._map.fire(new Bs(t.type,this._map,t))}preclick(t){const l=a.extend({},t);l.type="preclick",this._map.fire(new Bs(l.type,this._map,l))}click(t,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Bs(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Bs(t.type,this._map,t))}mouseover(t){this._map.fire(new Bs(t.type,this._map,t))}mouseout(t){this._map.fire(new Bs(t.type,this._map,t))}touchstart(t){return this._firePreventable(new bl(t.type,this._map,t))}touchmove(t){this._map.fire(new bl(t.type,this._map,t))}touchend(t){this._map.fire(new bl(t.type,this._map,t))}touchcancel(t){this._map.fire(new bl(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ya{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Bs(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Bs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Bs(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Za{constructor(t,l){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,l){this.isEnabled()&&t.shiftKey&&0===t.button&&(tt(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(t,l){if(!this._active)return;const p=l,_=this._startPos,b=this._lastPos;if(!_||!b||b.equals(p)||!this._box&&p.dist(_)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=Fe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const M=Math.min(_.x,p.x),O=Math.max(_.x,p.x),F=Math.min(_.y,p.y),q=Math.max(_.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${F}px)`,this._box.style.width=O-M+"px",this._box.style.height=q-F+"px")})}mouseupWindow(t,l){if(!this._active)return;const p=this._startPos,_=l;if(p&&0===t.button){if(this.reset(),et(),p.x!==_.x||p.y!==_.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:b=>b.fitScreenCoordinates(p,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Re(),delete this._startPos,delete this._lastPos}_fireEvent(t,l){return this._map.fire(new a.Event(t,{originalEvent:l}))}}function Pa(u,t){const l={};for(let p=0;p<u.length;p++)l[u[p].identifier]=t[p];return l}class Wa{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,l,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const b=new a.pointGeometry(0,0);for(const M of _)b._add(M);return b.div(_.length)}(l),this.touches=Pa(p,l)))}touchmove(t,l,p){if(this.aborted||!this.centroid)return;const _=Pa(p,l);for(const b in this.touches){const O=_[b];(!O||O.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(t,l,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class zl{constructor(t){this.singleTap=new Wa(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,l,p){this.singleTap.touchstart(t,l,p)}touchmove(t,l,p){this.singleTap.touchmove(t,l,p)}touchend(t,l,p){const _=this.singleTap.touchend(t,l,p);if(_){const b=t.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(_)<30;if(b&&M||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class uc{constructor(){this._zoomIn=new zl({numTouches:1,numTaps:2}),this._zoomOut=new zl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,l,p){this._zoomIn.touchstart(t,l,p),this._zoomOut.touchstart(t,l,p)}touchmove(t,l,p){this._zoomIn.touchmove(t,l,p),this._zoomOut.touchmove(t,l,p)}touchend(t,l,p){const _=this._zoomIn.touchend(t,l,p),b=this._zoomOut.touchend(t,l,p);return _?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(_)},{originalEvent:t})}):b?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(b)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Do={0:1,2:2};class xl{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,l){return!1}_move(t,l){return{}}mousedown(t,l){if(this._lastPoint)return;const p=an(t);this._correctButton(t,p)&&(this._lastPoint=l,this._eventButton=p)}mousemoveWindow(t,l){const p=this._lastPoint;if(p)if(t.preventDefault(),null!=this._eventButton&&function(_,b){const M=Do[b];return void 0===_.buttons||(_.buttons&M)!==M}(t,this._eventButton))this.reset();else if(this._moved||!(l.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(p,l)}mouseupWindow(t){this._lastPoint&&an(t)===this._eventButton&&(this._moved&&et(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wl extends xl{mousedown(t,l){super.mousedown(t,l),this._lastPoint&&(this._active=!0)}_correctButton(t,l){return 0===l&&!t.ctrlKey}_move(t,l){return{around:l,panDelta:l.sub(t)}}}class El extends xl{_correctButton(t,l){return 0===l&&t.ctrlKey||2===l}_move(t,l){const p=.8*(l.x-t.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(t){t.preventDefault()}}class Ul extends xl{_correctButton(t,l){return 0===l&&t.ctrlKey||2===l}_move(t,l){const p=-.5*(l.y-t.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(t){t.preventDefault()}}class dc{constructor(t,l){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(t,l,p){return this._calculateTransform(t,l,p)}touchmove(t,l,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,l,p)}}touchend(t,l,p){this._calculateTransform(t,l,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,l,p){p.length>0&&(this._active=!0);const _=Pa(p,l),b=new a.pointGeometry(0,0),M=new a.pointGeometry(0,0);let O=0;for(const q in _){const W=_[q],re=this._touches[q];re&&(b._add(W),M._add(W.sub(re)),O++,_[q]=W)}if(this._touches=_,O<this._minTouches||!M.mag())return;const F=M.div(O);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(O),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Fe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class hc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,l,p){return{}}touchstart(t,l,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([l[0],l[1]]))}touchmove(t,l,p){const _=this._firstTwoTouches;if(!_)return;t.preventDefault();const[b,M]=_,O=aa(p,l,b),F=aa(p,l,M);if(!O||!F)return;const q=this._aroundCenter?null:O.add(F).div(2);return this._move([O,F],q,t)}touchend(t,l,p){if(!this._firstTwoTouches)return;const[_,b]=this._firstTwoTouches,M=aa(p,l,_),O=aa(p,l,b);M&&O||(this._active&&et(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function aa(u,t,l){for(let p=0;p<u.length;p++)if(u[p].identifier===l)return t[p]}function Oa(u,t){return Math.log(u/t)/Math.LN2}class K extends hc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,l){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Oa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Oa(this._distance,p),pinchAround:l}}}function S(u,t){return 180*u.angleWith(t)/Math.PI}class T extends hc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,l){const p=this._vector;if(this._vector=t[0].sub(t[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:S(this._vector,p),pinchAround:l}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const l=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const _=S(t,p);return Math.abs(_)<l}}function V(u){return Math.abs(u.y)>Math.abs(u.x)}class ie extends hc{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,V(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,l,p){const _=this._lastPoints;if(!_)return;const b=t[0].sub(_[0]),M=t[1].sub(_[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(b,M,p.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(b.y+M.y)/2*-.5})}gestureBeginsVertically(t,l,p){if(void 0!==this._valid)return this._valid;const _=t.mag()>=2,b=l.mag()>=2;if(!_&&!b)return;if(!_||!b)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const M=t.y>0==l.y>0;return V(t)&&V(l)&&M}}const Oe={panStep:100,bearingStep:15,pitchStep:10};class Je{constructor(){const t=Oe;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let l=0,p=0,_=0,b=0,M=0;switch(t.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),b=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),b=1);break;case 38:t.shiftKey?_=1:(t.preventDefault(),M=-1);break;case 40:t.shiftKey?_=-1:(t.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:O=>{const F=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Ot,zoom:l?Math.round(F)+l*(t.shiftKey?2:1):F,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+_*this._pitchStep,offset:[-b*this._panStep,-M*this._panStep],center:O.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ot(u){return u*(2-u)}const hn=4.000244140625;class On{constructor(t,l){this._map=t,this._el=t.getCanvasContainer(),this._handler=l,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=t.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=a.exported.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==l&&l%hn==0?this._type="wheel":0!==l&&Math.abs(l)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=l,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(_*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),t.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=t,this._delta-=l,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=ht(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const F="wheel"===this._type&&Math.abs(this._delta)>hn?this._wheelZoomRate:this._defaultZoomRate;let q=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==q&&(q=1/q);const W=l(),re=Math.pow(2,W),we="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):re;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(we*q))),"wheel"===this._type&&(this._startZoom=W,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:l(),_=this._startZoom,b=this._easing;let M,O=!1;if("wheel"===this._type&&_&&b){const F=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),q=b(F);M=a.number(_,p,q),F<1?this._frameId||(this._frameId=!0):O=!0}else M=p,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:M-l(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let l=a.ease;if(this._prevEase){const p=this._prevEase,_=(a.exported.now()-p.start)/p.duration,b=p.easing(_+.01)-p.easing(_),M=.27/Math.sqrt(b*b+1e-4)*.01,O=Math.sqrt(.0729-M*M);l=a.bezier(M,O,.25,1)}return this._prevEase={start:a.exported.now(),duration:t,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Fe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ri{constructor(t,l){this._clickZoom=t,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ui{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,l){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(t.shiftKey?-1:1),around:p.unproject(l)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ar{constructor(){this._tap=new zl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,l,p){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=l[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(t,l,p))}touchmove(t,l,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=l[0],b=_.y-this._swipePoint.y;return this._swipePoint=_,t.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(t,l,p)}touchend(t,l,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(t,l,p)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class nr{constructor(t,l,p){this._el=t,this._mousePan=l,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ti{constructor(t,l,p){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=l,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Zi{constructor(t,l,p,_){this._el=t,this._touchZoom=l,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wn=u=>u.zoom||u.drag||u.pitch||u.rotate;class Xr extends a.Event{}class or{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,l){const p=a.sub([],l,t);this.radius=a.length(p[2]<0?a.div([],p,this.constants):[p[0],p[1],0])}projectRay(t){a.div(t,t,this.constants),a.normalize(t,t),a.mul$1(t,t,this.constants);const l=a.scale$2([],t,this.radius);if(l[2]>0){const p=a.scale$2([],[0,0,1],a.dot(l,[0,0,1])),_=a.scale$2([],a.normalize([],[l[0],l[1],0]),this.radius),b=a.add([],l,a.scale$2([],a.sub([],a.add([],_,p),l),2));l[0]=b[0],l[1]=b[1]}return l}}function To(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}class Bo{constructor(t,l){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cs(t),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new or,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),a.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[_,b,M]of this._listeners)_.addEventListener(b,_===a.window.document?this.handleWindowEvent:this.handleEvent,M)}destroy(){for(const[t,l,p]of this._listeners)t.removeEventListener(l,t===a.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(t){const l=this._map,p=l.getCanvasContainer();this._add("mapEvent",new ru(l,t));const _=l.boxZoom=new Za(l,t);this._add("boxZoom",_);const b=new uc,M=new ui;l.doubleClickZoom=new ri(M,b),this._add("tapZoom",b),this._add("clickZoom",M);const O=new ar;this._add("tapDragZoom",O);const F=l.touchPitch=new ie(l);this._add("touchPitch",F);const q=new El(t),W=new Ul(t);l.dragRotate=new Ti(t,q,W),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const re=new wl(t),we=new dc(l,t);l.dragPan=new nr(p,re,we),this._add("mousePan",re),this._add("touchPan",we,["touchZoom","touchRotate"]);const Ue=new T,Be=new K;l.touchZoomRotate=new Zi(p,Be,Ue,O),this._add("touchRotate",Ue,["touchPan","touchZoom"]),this._add("touchZoom",Be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ya(l));const je=l.scrollZoom=new On(l,this);this._add("scrollZoom",je,["mousePan"]);const Ie=l.keyboard=new Je;this._add("keyboard",Ie);for(const Le of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[Le]&&l[Le].enable(t[Le])}_add(t,l,p){this._handlers.push({handlerName:t,handler:l,allowed:p}),this._handlersById[t]=l}stop(t){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,l,p){for(const _ in t)if(_!==p&&(!l||l.indexOf(_)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const l=[];for(const p of t)this._el.contains(p.target)&&l.push(p);return l}handleEvent(t,l){this._updatingCamera=!0;const p="renderFrame"===t.type,_=p?void 0:t,b={needsRenderFrame:!1},M={},O={},F=t.touches?this._getMapTouches(t.touches):void 0,q=F?Gt(this._el,F):p?void 0:ht(this._el,t);for(const{handlerName:we,handler:Ue,allowed:Be}of this._handlers){if(!Ue.isEnabled())continue;let je;this._blockedByActive(O,Be,we)?Ue.reset():Ue[l||t.type]&&(je=Ue[l||t.type](t,q,F),this.mergeHandlerResult(b,M,je,we,_),je&&je.needsRenderFrame&&this._triggerRenderFrame()),(je||Ue.isActive())&&(O[we]=Ue)}const W={};for(const we in this._previousActiveHandlers)O[we]||(W[we]=_);this._previousActiveHandlers=O,(Object.keys(W).length||To(b))&&(this._changes.push([b,M,W]),this._triggerRenderFrame()),(Object.keys(O).length||To(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:re}=b;re&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],re(this._map))}mergeHandlerResult(t,l,p,_,b){if(!p)return;a.extend(t,p);const M={handlerName:_,originalEvent:p.originalEvent||b};void 0!==p.zoomDelta&&(l.zoom=M),void 0!==p.panDelta&&(l.drag=M),void 0!==p.pitchDelta&&(l.pitch=M),void 0!==p.bearingDelta&&(l.rotate=M)}_applyChanges(){const t={},l={},p={};for(const[_,b,M]of this._changes)_.panDelta&&(t.panDelta=(t.panDelta||new a.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+_.pitchDelta),void 0!==_.around&&(t.around=_.around),void 0!==_.aroundCoord&&(t.aroundCoord=_.aroundCoord),void 0!==_.pinchAround&&(t.pinchAround=_.pinchAround),_.noInertia&&(t.noInertia=_.noInertia),a.extend(l,b),a.extend(p,M);this._updateMapTransform(t,l,p),this._changes=[]}_updateMapTransform(t,l,p){const _=this._map,b=_.transform,M=Ze=>[Ze.x,Ze.y,Ze.z];if((Ze=>{const He=this._eventsInProgress.drag;return He&&!this._handlersById[He.handlerName].isActive()})()&&!To(t)){const Ze=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",Ze!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&_._stop(!0),!To(t))return void this._fireEvents(l,p,!0);let{panDelta:O,zoomDelta:F,bearingDelta:q,pitchDelta:W,around:re,aroundCoord:we,pinchAround:Ue}=t;b._isCameraConstrained&&(F>0&&(F=0),b._isCameraConstrained=!1),void 0!==Ue&&(re=Ue),(Ze=>l.drag&&!this._eventsInProgress.drag)()&&re&&(this._dragOrigin=M(b.pointCoordinate3D(re)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",_._stop(!0),re=re||_.transform.centerPoint,q&&(b.bearing+=q),W&&(b.pitch+=W),b._updateCameraState();const Be=[0,0,0];if(O)if("mercator"===b.projection.name){const Ze=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(re).dir),He=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(re.sub(O)).dir);Be[0]=He[0]-Ze[0],Be[1]=He[1]-Ze[1]}else{const Ze=b.pointCoordinate(re);if("globe"===b.projection.name){O=O.rotate(-b.angle);const He=b._pixelsPerMercatorPixel/b.worldSize;Be[0]=-O.x*a.mercatorScale(a.latFromMercatorY(Ze.y))*He,Be[1]=-O.y*a.mercatorScale(b.center.lat)*He}else{const He=b.pointCoordinate(re.sub(O));Ze&&He&&(Be[0]=He.x-Ze.x,Be[1]=He.y-Ze.y)}}const je=b.zoom,Ie=[0,0,0];if(F){const Ze=M(we||b.pointCoordinate3D(re)),He={dir:a.normalize([],a.sub([],Ze,b._camera.position))};if(He.dir[2]<0){const st=b.zoomDeltaToMovement(Ze,F);a.scale$2(Ie,He.dir,st)}}const Le=a.add(Be,Be,Ie);b._translateCameraConstrained(Le),F&&Math.abs(b.zoom-je)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(l,p,!0)}_fireEvents(t,l,p){const _=Wn(this._eventsInProgress),b=Wn(t),M={};for(const W in t){const{originalEvent:re}=t[W];this._eventsInProgress[W]||(M[`${W}start`]=re),this._eventsInProgress[W]=t[W]}!_&&b&&this._fireEvent("movestart",b.originalEvent);for(const W in M)this._fireEvent(W,M[W]);b&&this._fireEvent("move",b.originalEvent);for(const W in t){const{originalEvent:re}=t[W];this._fireEvent(W,re)}const O={};let F;for(const W in this._eventsInProgress){const{handlerName:re,originalEvent:we}=this._eventsInProgress[W];this._handlersById[re].isActive()||(delete this._eventsInProgress[W],F=l[re]||we,O[`${W}end`]=F)}for(const W in O)this._fireEvent(W,O[W]);const q=Wn(this._eventsInProgress);if(p&&(_||b)&&!q){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),re=we=>0!==we&&-this._bearingSnap<we&&we<this._bearingSnap;W?(re(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:F})):(this._map.fire(new a.Event("moveend",{originalEvent:F})),re(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,l){this._map.fire(new a.Event(t,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Xr("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Cl="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ra extends a.Evented{constructor(t,l){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=l.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,l){return this.jumpTo({center:t},l)}panBy(t,l,p){return t=a.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,a.extend({offset:t},l),p)}panTo(t,l,p){return this.easeTo(a.extend({center:t},l),p)}getZoom(){return this.transform.zoom}setZoom(t,l){return this.jumpTo({zoom:t},l),this}zoomTo(t,l,p){return this.easeTo(a.extend({zoom:t},l),p)}zoomIn(t,l){return this.zoomTo(this.getZoom()+1,t,l),this}zoomOut(t,l){return this.zoomTo(this.getZoom()-1,t,l),this}getBearing(){return this.transform.bearing}setBearing(t,l){return this.jumpTo({bearing:t},l),this}getPadding(){return this.transform.padding}setPadding(t,l){return this.jumpTo({padding:t},l),this}rotateTo(t,l,p){return this.easeTo(a.extend({bearing:t},l),p)}resetNorth(t,l){return this.rotateTo(0,a.extend({duration:1e3},t),l),this}resetNorthPitch(t,l){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},t),l),this}snapToNorth(t,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,l):this}getPitch(){return this.transform.pitch}setPitch(t,l){return this.jumpTo({pitch:t},l),this}cameraForBounds(t,l){t=a.LngLatBounds.convert(t);const p=l&&l.bearing||0,_=l&&l.pitch||0,b=t.getNorthWest(),M=t.getSouthEast();return this._cameraForBounds(this.transform,b,M,p,_,l)}_extendCameraOptions(t){const l={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=a.extend({padding:l,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const p=t.padding;t.padding={top:p,bottom:p,right:p,left:p}}return t.padding=a.extend(l,t.padding),t}_minimumAABBFrustumDistance(t,l){const p=l.max[0]-l.min[0],_=l.max[1]-l.min[1];return p/_>t.aspect?p/(2*Math.tan(.5*t.fovX)*t.aspect):_/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,l,p,_,b,M){const O=t.clone(),F=this._extendCameraOptions(M);O.bearing=_,O.pitch=b;const q=a.LngLat.convert(l),W=a.LngLat.convert(p),re=.5*(q.lat+W.lat),we=.5*(q.lng+W.lng),Ue=a.latLngToECEF(re,we),Be=a.normalize([],Ue),je=a.normalize([],a.cross([],Be,[0,1,0])),Ie=a.cross([],je,Be),Le=[je[0],je[1],je[2],0,Ie[0],Ie[1],Ie[2],0,Be[0],Be[1],Be[2],0,0,0,0,1],Ze=[Ue,a.latLngToECEF(q.lat,q.lng),a.latLngToECEF(W.lat,q.lng),a.latLngToECEF(W.lat,W.lng),a.latLngToECEF(q.lat,W.lng),a.latLngToECEF(re,q.lng),a.latLngToECEF(re,W.lng),a.latLngToECEF(q.lat,we),a.latLngToECEF(W.lat,we)];let He=a.Aabb.fromPoints(Ze.map(qt=>[a.dot(je,qt),a.dot(Ie,qt),a.dot(Be,qt)]));const st=a.transformMat4([],He.center,Le);0===a.squaredLength(st)&&a.set(st,0,0,1),a.normalize(st,st),a.scale$2(st,st,a.GLOBE_RADIUS),O.center=a.ecefToLatLng(st);const St=O.getWorldToCameraMatrix(),Mt=a.invert(new Float64Array(16),St);He=a.Aabb.applyTransform(He,a.multiply([],St,Le)),a.transformMat4(st,st,St);const jt=.5*(He.max[2]-He.min[2]),un=this._minimumAABBFrustumDistance(O,He),rn=a.scale$2([],[0,0,1],jt),Wt=a.add(rn,st,rn),Xn=un+(0===O.pitch?0:a.distance(st,Wt)),tn=O.globeCenterInViewSpace,In=a.sub([],st,[tn[0],tn[1],tn[2]]);a.normalize(In,In),a.scale$2(In,In,Xn);const _n=a.add([],st,In);a.transformMat4(_n,_n,Mt);const $n=a.earthRadius/a.GLOBE_RADIUS,xn=a.length(_n),zn=a.mercatorZfromAltitude(xn*$n-a.earthRadius,0),qn=Math.min(O.zoomFromMercatorZAdjusted(zn),F.maxZoom);return qn>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=qn,this._cameraForBounds(O,l,p,_,b,M)):{center:O.center,zoom:qn,bearing:_,pitch:b}}queryTerrainElevation(t,l){const p=this.transform.elevation;return p?(l=a.extend({},{exaggerated:!0},l),p.getAtPoint(a.MercatorCoordinate.fromLngLat(t),null,l.exaggerated)):null}_cameraForBounds(t,l,p,_,b,M){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,l,p,_,b,M);const O=t.clone(),F=this._extendCameraOptions(M),q=O.padding;O.bearing=_,O.pitch=b;const W=a.LngLat.convert(l),re=a.LngLat.convert(p),we=new a.LngLat(W.lng,re.lat),Ue=new a.LngLat(re.lng,W.lat),Be=O.project(W),je=O.project(re),Ie=this.queryTerrainElevation(W),Le=this.queryTerrainElevation(re),Ze=this.queryTerrainElevation(we),He=this.queryTerrainElevation(Ue),st=[[Be.x,Be.y,Math.min(Ie||0,Le||0,Ze||0,He||0)],[je.x,je.y,Math.max(Ie||0,Le||0,Ze||0,He||0)]];let St=a.Aabb.fromPoints(st);const Mt=O.getWorldToCameraMatrix(),jt=a.invert(new Float64Array(16),Mt);St=a.Aabb.applyTransform(St,Mt);const un=a.sub([],St.max,St.min),rn=q.left||0,Wt=q.right||0,Xn=q.bottom||0,tn=q.top||0,{left:In,right:_n,top:$n,bottom:xn}=F.padding,zn=.5*(rn+Wt),qn=.5*(tn+Xn),qt=Math.min(O.scaleZoom(O.scale*Math.min((O.width-(rn+Wt+In+_n))/un[0],(O.height-(Xn+tn+xn+$n))/un[1])),F.maxZoom),gn=O.scale/O.zoomScale(qt);St=new a.Aabb([St.min[0]-(In+zn)*gn,St.min[1]-(xn+qn)*gn,St.min[2]],[St.max[0]+(_n+zn)*gn,St.max[1]+($n+qn)*gn,St.max[2]]);const _i=.5*un[2],ki=this._minimumAABBFrustumDistance(O,St),yi=[0,0,1,0];a.transformMat4$1(yi,yi,Mt),a.normalize$2(yi,yi);const Wi=a.scale$2([],yi,ki+_i),cr=a.add([],St.center,Wi),Oi=("number"==typeof F.offset.x&&"number"==typeof F.offset.y?new a.pointGeometry(F.offset.x,F.offset.y):a.pointGeometry.convert(F.offset)).rotate(-a.degToRad(_));St.center[0]-=Oi.x*gn,St.center[1]+=Oi.y*gn,a.transformMat4(St.center,St.center,jt),a.transformMat4(cr,cr,jt);const di=[St.center[0],St.center[1],cr[2]*O.pixelsPerMeter];a.scale$2(di,di,1/O.worldSize);const Qr=a.lngFromMercatorX(di[0]),zr=a.latFromMercatorY(di[1]),Gr=Math.min(O._zoomFromMercatorZ(di[2]),F.maxZoom),oo=new a.LngLat(Qr,zr);return O.mercatorFromTransition&&Gr<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=Gr,this._cameraForBounds(O,l,p,_,b,M)):{center:oo,zoom:Gr,bearing:_,pitch:b}}fitBounds(t,l,p){const _=this.cameraForBounds(t,l);return this._fitInternal(_,l,p)}fitScreenCoordinates(t,l,p,_,b){const M=a.pointGeometry.convert(t),O=a.pointGeometry.convert(l),F=new a.pointGeometry(Math.min(M.x,O.x),Math.min(M.y,O.y)),q=new a.pointGeometry(Math.max(M.x,O.x),Math.max(M.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(M,O))return this;const W=this.transform.pointLocation3D(F),re=this.transform.pointLocation3D(q),we=this.transform.pointLocation3D(new a.pointGeometry(F.x,q.y)),Ue=this.transform.pointLocation3D(new a.pointGeometry(q.x,F.y)),Be=[Math.min(W.lng,re.lng,we.lng,Ue.lng),Math.min(W.lat,re.lat,we.lat,Ue.lat)],je=[Math.max(W.lng,re.lng,we.lng,Ue.lng),Math.max(W.lat,re.lat,we.lat,Ue.lat)],Ie=_&&_.pitch?_.pitch:this.getPitch(),Le=this._cameraForBounds(this.transform,Be,je,p,Ie,_);return this._fitInternal(Le,_,b)}_fitInternal(t,l,p){return t?(delete(l=a.extend(t,l)).padding,l.linear?this.easeTo(l,p):this.flyTo(l,p)):this}jumpTo(t,l){this.stop();const p=t.preloadOnly?this.transform.clone():this.transform;let _=!1,b=!1,M=!1;return"zoom"in t&&p.zoom!==+t.zoom&&(_=!0,p.zoom=+t.zoom),void 0!==t.center&&(p.center=a.LngLat.convert(t.center)),"bearing"in t&&p.bearing!==+t.bearing&&(b=!0,p.bearing=+t.bearing),"pitch"in t&&p.pitch!==+t.pitch&&(M=!0,p.pitch=+t.pitch),null==t.padding||p.isPaddingEqual(t.padding)||(p.padding=t.padding),t.preloadOnly?(this._preloadTiles(p),this):(this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),_&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),b&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),M&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Cl),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,l){const p=this.transform;if(!p.projection.supportsFreeCamera)return a.warnOnce(Cl),this;this.stop();const _=p.zoom,b=p.pitch,M=p.bearing;p.setFreeCameraOptions(t);const O=_!==p.zoom,F=b!==p.pitch,q=M!==p.bearing;return this.fire(new a.Event("movestart",l)).fire(new a.Event("move",l)),O&&this.fire(new a.Event("zoomstart",l)).fire(new a.Event("zoom",l)).fire(new a.Event("zoomend",l)),q&&this.fire(new a.Event("rotatestart",l)).fire(new a.Event("rotate",l)).fire(new a.Event("rotateend",l)),F&&this.fire(new a.Event("pitchstart",l)).fire(new a.Event("pitch",l)).fire(new a.Event("pitchend",l)),this.fire(new a.Event("moveend",l)),this}easeTo(t,l){this._stop(!1,t.easeId),(!1===(t=a.extend({offset:[0,0],duration:500,easing:a.ease},t)).animate||!t.essential&&a.exported.prefersReducedMotion)&&(t.duration=0);const p=this.transform,_=this.getZoom(),b=this.getBearing(),M=this.getPitch(),O=this.getPadding(),F="zoom"in t?+t.zoom:_,q="bearing"in t?this._normalizeBearing(t.bearing,b):b,W="pitch"in t?+t.pitch:M,re="padding"in t?t.padding:p.padding,we=a.pointGeometry.convert(t.offset);let Ue,Be,je;if("globe"===p.projection.name){const rn=a.MercatorCoordinate.fromLngLat(p.center),Wt=we.rotate(-p.angle);rn.x+=Wt.x/p.worldSize,rn.y+=Wt.y/p.worldSize;const Xn=rn.toLngLat(),tn=a.LngLat.convert(t.center||Xn);this._normalizeCenter(tn),Ue=p.centerPoint.add(Wt),Be=new a.pointGeometry(rn.x,rn.y).mult(p.worldSize),je=new a.pointGeometry(a.mercatorXfromLng(tn.lng),a.mercatorYfromLat(tn.lat)).mult(p.worldSize).sub(Be)}else{Ue=p.centerPoint.add(we);const rn=p.pointLocation(Ue),Wt=a.LngLat.convert(t.center||rn);this._normalizeCenter(Wt),Be=p.project(rn),je=p.project(Wt).sub(Be)}const Ie=p.zoomScale(F-_);let Le,Ze;t.around&&(Le=a.LngLat.convert(t.around),Ze=p.locationPoint(Le));const He=this._zooming||F!==_,st=this._rotating||b!==q,St=this._pitching||W!==M,Mt=!p.isPaddingEqual(re),jt=rn=>Wt=>{if(He&&(rn.zoom=a.number(_,F,Wt)),st&&(rn.bearing=a.number(b,q,Wt)),St&&(rn.pitch=a.number(M,W,Wt)),Mt&&(rn.interpolatePadding(O,re,Wt),Ue=rn.centerPoint.add(we)),Le)rn.setLocationAtPoint(Le,Ze);else{const Xn=rn.zoomScale(rn.zoom-_),tn=F>_?Math.min(2,Ie):Math.max(.5,Ie),In=Math.pow(tn,1-Wt),_n=rn.unproject(Be.add(je.mult(Wt*In)).mult(Xn));rn.setLocationAtPoint(rn.renderWorldCopies?_n.wrap():_n,Ue)}return t.preloadOnly||this._fireMoveEvents(l),rn};if(t.preloadOnly){const rn=this._emulate(jt,t.duration,p);return this._preloadTiles(rn),this}const un={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=He,this._rotating=st,this._pitching=St,this._padding=Mt,this._easeId=t.easeId,this._prepareEase(l,t.noMoveStart,un),this._ease(jt(p),rn=>{p.recenterOnTerrain(),this._afterEase(l,rn)},t),this}_prepareEase(t,l,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",l||p.moving||this.fire(new a.Event("movestart",t)),this._zooming&&!p.zooming&&this.fire(new a.Event("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new a.Event("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new a.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new a.Event("move",t)),this._zooming&&this.fire(new a.Event("zoom",t)),this._rotating&&this.fire(new a.Event("rotate",t)),this._pitching&&this.fire(new a.Event("pitch",t))}_afterEase(t,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,_=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new a.Event("zoomend",t)),_&&this.fire(new a.Event("rotateend",t)),b&&this.fire(new a.Event("pitchend",t)),this.fire(new a.Event("moveend",t))}flyTo(t,l){if(!t.essential&&a.exported.prefersReducedMotion){const qt=a.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qt,l)}this.stop(),t=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},t);const p=this.transform,_=this.getZoom(),b=this.getBearing(),M=this.getPitch(),O=this.getPadding(),F="zoom"in t?a.clamp(+t.zoom,p.minZoom,p.maxZoom):_,q="bearing"in t?this._normalizeBearing(t.bearing,b):b,W="pitch"in t?+t.pitch:M,re="padding"in t?t.padding:p.padding,we=p.zoomScale(F-_),Ue=a.pointGeometry.convert(t.offset);let Be=p.centerPoint.add(Ue);const je=p.pointLocation(Be),Ie=a.LngLat.convert(t.center||je);this._normalizeCenter(Ie);const Le=p.project(je),Ze=p.project(Ie).sub(Le);let He=t.curve;const st=Math.max(p.width,p.height),St=st/we,Mt=Ze.mag();if("minZoom"in t){const qt=a.clamp(Math.min(t.minZoom,_,F),p.minZoom,p.maxZoom),gn=st/p.zoomScale(qt-_);He=Math.sqrt(gn/Mt*2)}const jt=He*He;function un(qt){const gn=(St*St-st*st+(qt?-1:1)*jt*jt*Mt*Mt)/(2*(qt?St:st)*jt*Mt);return Math.log(Math.sqrt(gn*gn+1)-gn)}function rn(qt){return(Math.exp(qt)-Math.exp(-qt))/2}function Wt(qt){return(Math.exp(qt)+Math.exp(-qt))/2}const Xn=un(0);let tn=function(qt){return Wt(Xn)/Wt(Xn+He*qt)},In=function(qt){return st*((Wt(Xn)*(rn(gn=Xn+He*qt)/Wt(gn))-rn(Xn))/jt)/Mt;var gn},_n=(un(1)-Xn)/He;if(Math.abs(Mt)<1e-6||!isFinite(_n)){if(Math.abs(st-St)<1e-6)return this.easeTo(t,l);const qt=St<st?-1:1;_n=Math.abs(Math.log(St/st))/He,In=function(){return 0},tn=function(gn){return Math.exp(qt*He*gn)}}t.duration="duration"in t?+t.duration:1e3*_n/("screenSpeed"in t?+t.screenSpeed/He:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const $n=b!==q,xn=W!==M,zn=!p.isPaddingEqual(re),qn=qt=>gn=>{const _i=gn*_n,ki=1/tn(_i);qt.zoom=1===gn?F:_+qt.scaleZoom(ki),$n&&(qt.bearing=a.number(b,q,gn)),xn&&(qt.pitch=a.number(M,W,gn)),zn&&(qt.interpolatePadding(O,re,gn),Be=qt.centerPoint.add(Ue));const yi=1===gn?Ie:qt.unproject(Le.add(Ze.mult(In(_i))).mult(ki));return qt.setLocationAtPoint(qt.renderWorldCopies?yi.wrap():yi,Be),qt._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(l),qt};if(t.preloadOnly){const qt=this._emulate(qn,t.duration,p);return this._preloadTiles(qt),this}return this._zooming=!0,this._rotating=$n,this._pitching=xn,this._padding=zn,this._prepareEase(l,!1),this._ease(qn(p),()=>this._afterEase(l),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,l)}if(!t){const p=this.handlers;p&&p.stop(!1)}return this}_ease(t,l,p){!1===p.animate||0===p.duration?(t(1),l()):(this._easeStart=a.exported.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,l){t=a.wrap(t,-180,180);const p=Math.abs(t-l);return Math.abs(t-360-l)<p&&(t-=360),Math.abs(t+360-l)<p&&(t+=360),t}_normalizeCenter(t){const l=this.transform;if(!l.renderWorldCopies||l.maxBounds)return;const p=t.lng-l.center.lng;t.lng+=p>180?-360:p<-180?360:0}_emulate(t,l,p){const _=Math.ceil(15*l/1e3),b=[],M=t(p.clone());for(let O=0;O<=_;O++){const F=M(O/_);b.push(F.clone())}return b}}class Po{constructor(t={}){this.options=t,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const l=this.options&&this.options.compact;return this._map=t,this._container=Fe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Fe("button","mapboxgl-ctrl-attrib-button",this._container),Fe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Fe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===l&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,l){const p=this._map._getUIString(`AttributionControl.${l}`);t.setAttribute("aria-label",p),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(t){const p=l.reduce((_,b,M)=>(b.value&&(_+=`${b.key}=${b.value}${M<l.length-1?"&":""}`),_),"?");t.href=`${a.config.FEEDBACK_URL}/${p}#${Kr(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const l=this._map.style._sourceCaches;for(const _ in l){const b=l[_];if(b.used){const M=b.getSource();M.attribution&&t.indexOf(M.attribution)<0&&t.push(M.attribution)}}t.sort((_,b)=>_.length-b.length),t=t.filter((_,b)=>{for(let M=b+1;M<t.length;M++)if(t[M].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ka{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Fe("div","mapboxgl-ctrl");const l=Fe("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const l in t){const p=t[l].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const l=t[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class la{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const l=++this._id;return this._queue.push({callback:t,id:l,cancelled:!1}),l}remove(t){const l=this._currentlyRunning,p=l?this._queue.concat(l):this._queue;for(const _ of p)if(_.id===t)return void(_.cancelled=!0)}run(t=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const p of l)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function gs(u,t,l){if(u=new a.LngLat(u.lng,u.lat),t){const p=new a.LngLat(u.lng-360,u.lat),_=new a.LngLat(u.lng+360,u.lat),b=360*Math.ceil(Math.abs(u.lng-l.center.lng)/360),M=l.locationPoint(u).distSqr(t),O=t.x<0||t.y<0||t.x>l.width||t.y>l.height;l.locationPoint(p).distSqr(t)<M&&(O||Math.abs(p.lng-l.center.lng)<b)?u=p:l.locationPoint(_).distSqr(t)<M&&(O||Math.abs(_.lng-l.center.lng)<b)&&(u=_)}for(;Math.abs(u.lng-l.center.lng)>180;){const p=l.locationPoint(u);if(p.x>=0&&p.y>=0&&p.x<=l.width&&p.y<=l.height)break;u.lng>l.center.lng?u.lng-=360:u.lng+=360}return u}const Ml={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class qa extends a.Evented{constructor(t,l){if(super(),(t instanceof a.window.HTMLElement||l)&&(t=a.extend({element:t},l)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=a.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Fe("div");const _=41,b=27,M=$e("svg",{display:"block",height:_*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${_}`},this._element),O=$e("radialGradient",{id:"shadowGradient"},$e("defs",{},M));$e("stop",{offset:"10%","stop-opacity":.4},O),$e("stop",{offset:"100%","stop-opacity":.05},O),$e("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},M),$e("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},M),$e("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},M),$e("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},M),this._offset=a.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",_=>{_.preventDefault()}),this._element.addEventListener("mousedown",_=>{_.preventDefault()});const p=this._element.classList;for(const _ in Ml)p.remove(`mapboxgl-marker-anchor-${_}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=a.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const l=t.code,p=t.charCode||t.keyCode;"Space"!==l&&"Enter"!==l&&32!==p&&13!==p||this.togglePopup()}_onMapClick(t){const l=t.originalEvent.target,p=this._element;this._popup&&(l===p||p.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,l=this._pos;if(!t||!l)return!1;const p=t.unproject(l),_=t.getFreeCameraOptions();if(!_.position)return!1;const b=_.position.toLngLat();return b.distanceTo(p)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const l=this._pos;if(!l||l.x<0||l.x>t.transform.width||l.y<0||l.y>t.transform.height)return void this._clearFadeTimer();const p=t.unproject(l);let _;t._showingGlobe()&&a.isLngLatBehindGlobe(t.transform,this._lngLat)?_=0:(_=1-t._queryFogOpacity(p),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${Ml[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${l.x}px,${l.y}px)\n        `}_calculateXYTransform(){const t=this._pos,l=this._map,p=this.getPitchAlignment();if(!l||!t||"map"!==p)return"";if(!l._showingGlobe()){const F=l.getPitch();return F?`rotateX(${F}deg)`:""}const _=a.radToDeg(a.globeTiltAtLngLat(l.transform,this._lngLat)),b=t.sub(a.globeCenterToScreenPoint(l.transform)),M=Math.abs(b.x)+Math.abs(b.y);if(0===M)return"";const O=_/M;return`rotateX(${-b.y*O}deg) rotateY(${b.x*O}deg)`}_calculateZTransform(){const t=this._pos,l=this._map;if(!l||!t)return"";let p=0;const _=this.getRotationAlignment();if("map"===_)if(l._showingGlobe()){const b=l.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),M=l.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);p=a.radToDeg(Math.atan2(M.y,M.x))-90}else p=-l.getBearing();else if("horizon"===_){const b=a.smoothstep(4,6,l.getZoom()),M=a.globeCenterToScreenPoint(l.transform);M.y+=b*l.transform.height;const O=t.sub(M),F=a.radToDeg(Math.atan2(O.y,O.x));p=(F>90?F-270:F+90)*(1-b)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(t){a.window.cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=gs(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),!0===t?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=a.pointGeometry.convert(t),this._update(),this}_onMove(t){const l=this._map;if(!l)return;const p=this._pointerdownPos,_=this._positionDelta;if(p&&_){if(!this._isDragging){const b=this._clickTolerance||l._clickTolerance;if(t.point.dist(p)<b)return;this._isDragging=!0}this._pos=t.point.sub(_),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(t){const l=this._map,p=this._pos;l&&p&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(p),this._pointerdownPos=t.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const l=this._map;return l&&(t?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Hr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ya(u=new a.pointGeometry(0,0),t="bottom"){if("number"==typeof u){const l=Math.round(Math.sqrt(.5*Math.pow(u,2)));switch(t){case"top":return new a.pointGeometry(0,u);case"top-left":return new a.pointGeometry(l,l);case"top-right":return new a.pointGeometry(-l,l);case"bottom":return new a.pointGeometry(0,-u);case"bottom-left":return new a.pointGeometry(l,-l);case"bottom-right":return new a.pointGeometry(-l,-l);case"left":return new a.pointGeometry(u,0);case"right":return new a.pointGeometry(-u,0)}return new a.pointGeometry(0,0)}return u instanceof a.pointGeometry||Array.isArray(u)?a.pointGeometry.convert(u):a.pointGeometry.convert(u[t]||[0,0])}class Si{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const l=a.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,l,p){this._start=this.getValue(l),this._end=t,this._startTime=l,this._endTime=l+p}}const Di={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Ni={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Mr={showCompass:!0,showZoom:!0,visualizePitch:!1};class So{constructor(t,l,p=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new El({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,p&&(this.mousePitch=new Ul({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(t,l){this.mouseRotate.mousedown(t,l),this.mousePitch&&this.mousePitch.mousedown(t,l),tt()}move(t,l){const p=this.map,_=this.mouseRotate.mousemoveWindow(t,l),b=_&&_.bearingDelta;if(b&&p.setBearing(p.getBearing()+b),this.mousePitch){const M=this.mousePitch.mousemoveWindow(t,l),O=M&&M.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Re(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(a.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),ht(this.element,t)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,ht(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=Gt(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=Gt(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const P={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},k={maxWidth:100,unit:"metric"};function D(u,t,l){const p=z(t),_=p/t,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[l];this._map._requestDomTask(()=>{this._container.style.width=u*_+"px",this._container.innerHTML=`${p}&nbsp;${b}`})}function z(u){const t=Math.pow(10,`${Math.floor(u)}`.length-1);let l=u/t;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:l>=1?1:function(p){const _=Math.pow(10,Math.ceil(-Math.log(p)/Math.LN10));return Math.round(p*_)/_}(l),t*l}const ee={version:a.version,supported:Qe,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Ra{constructor(u){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),null!=(u=a.extend({},Ni,u)).minZoom&&null!=u.maxZoom&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=u.minPitch&&null!=u.maxPitch&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=u.minPitch&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=u.maxPitch&&u.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(u.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(u.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Yr(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies),u),this._interactive=u.interactive,this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=u.crossSourceCollisions,this._collectResourceTiming=u.collectResourceTiming,this._optimizeForTerrain=u.optimizeForTerrain,this._language=this._parseLanguage(u.language),this._worldview=u.worldview,this._renderTaskQueue=new la,this._domRenderTaskQueue=new la,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Di,u.locale),this._clickTolerance=u.clickTolerance,this._cooperativeGestures=u.cooperativeGestures,this._performanceMetricsCollection=u.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Si(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(u.transformRequest,u.accessToken,u.testMode),this._silenceAuthErrors=!!u.testMode,"string"==typeof u.container){if(this._container=a.window.document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),u.maxBounds&&this.setMaxBounds(u.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Bo(this,u),this._localFontFamily=u.localFontFamily,this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),u.projection&&this.setProjection(u.projection),this._hash=u.hash&&new Hn("string"==typeof u.hash&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,a.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),u.attributionControl&&this.addControl(new Po({customAttribution:u.customAttribution})),this._logoControl=new ka,this.addControl(this._logoControl,u.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new a.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new a.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(u,t){if(void 0===t&&(t=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=u.onAdd(this);this._controls.push(u);const p=this._controlPositions[t];return-1!==t.indexOf("bottom")?p.insertBefore(l,p.firstChild):p.appendChild(l),this}removeControl(u){if(!u||!u.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(u);return t>-1&&this._controls.splice(t,1),u.onRemove(this),this}hasControl(u){return this._controls.indexOf(u)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(u){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),this.fire(new a.Event("resize",u)),t&&this.fire(new a.Event("moveend",u)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(u){return this.transform.setMaxBounds(a.LngLatBounds.convert(u)),this._update()}setMinZoom(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u?this.setZoom(u):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u?this.setZoom(u):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u?this.setPitch(u):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(u){if((u=u??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u?this.setPitch(u):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(u){return this.transform.renderWorldCopies=u,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(u){return"auto"===u?a.window.navigator.language:Array.isArray(u)?0===u.length?void 0:u.map(t=>"auto"===t?a.window.navigator.language:t):u}setLanguage(u){const t=this._parseLanguage(u);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(u){return this.style&&u!==this._worldview?(this._worldview=u,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(u){return this._lazyInitEmptyStyle(),u?"string"==typeof u&&(u={name:u}):u=null,this._useExplicitProjection=!!u,this._prioritizeAndUpdateProjection(u,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const u=this.transform,t=u.projection.name;let l;"globe"===t&&u.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(u.setMercatorFromTransition(),l=!0):"mercator"===t&&u.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(u.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(u,t){return this._updateProjection(u||t||{name:"mercator"})}_updateProjection(u){let t;if(t="globe"===u.name&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(u),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const l in this.style._sourceCaches)this.style._sourceCaches[l].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(u){return this.transform.locationPoint3D(a.LngLat.convert(u))}unproject(u){return this.transform.pointLocation3D(a.pointGeometry.convert(u))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(u,t,l){if("mouseenter"===u||"mouseover"===u){let p=!1;const _=M=>{const O=t.filter(q=>this.getLayer(q)),F=O.length?this.queryRenderedFeatures(M.point,{layers:O}):[];F.length?p||(p=!0,l.call(this,new Bs(u,this,M.originalEvent,{features:F}))):p=!1},b=()=>{p=!1};return{layers:new Set(t),listener:l,delegates:{mousemove:_,mouseout:b}}}if("mouseleave"===u||"mouseout"===u){let p=!1;const _=M=>{const O=t.filter(F=>this.getLayer(F));(O.length?this.queryRenderedFeatures(M.point,{layers:O}):[]).length?p=!0:p&&(p=!1,l.call(this,new Bs(u,this,M.originalEvent)))},b=M=>{p&&(p=!1,l.call(this,new Bs(u,this,M.originalEvent)))};return{layers:new Set(t),listener:l,delegates:{mousemove:_,mouseout:b}}}{const p=_=>{const b=t.filter(O=>this.getLayer(O)),M=b.length?this.queryRenderedFeatures(_.point,{layers:b}):[];M.length&&(_.features=M,l.call(this,_),delete _.features)};return{layers:new Set(t),listener:l,delegates:{[u]:p}}}}on(u,t,l){if(void 0===l)return super.on(u,t);Array.isArray(t)||(t=[t]);const p=this._createDelegatedListener(u,t,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(u,t,l){if(void 0===l)return super.once(u,t);Array.isArray(t)||(t=[t]);const p=this._createDelegatedListener(u,t,l);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(u,t,l){if(void 0===l)return super.off(u,t);t=new Set(Array.isArray(t)?t:[t]);const p=(b,M)=>{if(b.size!==M.size)return!1;for(const O of b)if(!M.has(O))return!1;return!0},_=this._delegatedListeners?this._delegatedListeners[u]:void 0;return _&&(b=>{for(let M=0;M<b.length;M++){const O=b[M];if(O.listener===l&&p(O.layers,t)){for(const F in O.delegates)this.off(F,O.delegates[F]);return b.splice(M,1),this}}})(_),this}queryRenderedFeatures(u,t){return this.style?(void 0!==t||void 0===u||u instanceof a.pointGeometry||Array.isArray(u)||(t=u,u=void 0),this.style.queryRenderedFeatures(u=u||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(u,t){return this.style.querySourceFeatures(u,t)}setStyle(u,t){return!1!==(t=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&u?(this._diffStyle(u,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(u,t))}_getUIString(u){const t=this._locale[u];if(null==t)throw new Error(`Missing UI string '${u}'`);return t}_updateStyle(u,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),u&&(this.style=new yo(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof u?this.style.loadURL(u):this.style.loadJSON(u)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new yo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(u,t){if("string"==typeof u){const l=this._requestManager.normalizeStyleURL(u),p=this._requestManager.transformRequest(l,a.ResourceType.Style);a.getJSON(p,(_,b)=>{_?this.fire(new a.ErrorEvent(_)):b&&this._updateDiff(b,t)})}else"object"==typeof u&&this._updateDiff(u,t)}_updateDiff(u,t){try{this.style.setState(u)&&this._update(!0)}catch(l){a.warnOnce(`Unable to perform style diff: ${l.message||l.error||l}.  Rebuilding the style from scratch.`),this._updateStyle(u,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(u,t){return this._lazyInitEmptyStyle(),this.style.addSource(u,t),this._update(!0)}isSourceLoaded(u){return!!this.style&&this.style._isSourceCacheLoaded(u)}areTilesLoaded(){const u=this.style&&this.style._sourceCaches;for(const t in u){const l=u[t]._tiles;for(const p in l){const _=l[p];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}addSourceType(u,t,l){this._lazyInitEmptyStyle(),this.style.addSourceType(u,t,l)}removeSource(u){return this.style.removeSource(u),this._updateTerrain(),this._update(!0)}getSource(u){return this.style.getSource(u)}addImage(u,t,{pixelRatio:l=1,sdf:p=!1,stretchX:_,stretchY:b,content:M}={}){if(this._lazyInitEmptyStyle(),t instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&t instanceof a.window.ImageBitmap){const{width:O,height:F,data:q}=a.exported.getImageData(t);this.style.addImage(u,{data:new a.RGBAImage({width:O,height:F},q),pixelRatio:l,stretchX:_,stretchY:b,content:M,sdf:p,version:0})}else if(void 0===t.width||void 0===t.height)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:F}=t,q=t;this.style.addImage(u,{data:new a.RGBAImage({width:O,height:F},new Uint8Array(q.data)),pixelRatio:l,stretchX:_,stretchY:b,content:M,sdf:p,version:0,userImage:q}),q.onAdd&&q.onAdd(this,u)}}updateImage(u,t){const l=this.style.getImage(u);if(!l)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&t instanceof a.window.ImageBitmap?a.exported.getImageData(t):t,{width:_,height:b}=p;void 0!==_&&void 0!==b?_===l.data.width&&b===l.data.height?(l.data.replace(p.data,!(t instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&t instanceof a.window.ImageBitmap)),this.style.updateImage(u,l)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${_}, ${b})\n                must be that same as the previous version of the image\n                (${l.data.width}, ${l.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(u){return u?!!this.style.getImage(u):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(u){this.style.removeImage(u)}loadImage(u,t){a.getImage(this._requestManager.transformRequest(u,a.ResourceType.Image),(l,p)=>{t(l,p instanceof a.window.HTMLImageElement?a.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(u,t){return this._lazyInitEmptyStyle(),this.style.addLayer(u,t),this._update(!0)}moveLayer(u,t){return this.style.moveLayer(u,t),this._update(!0)}removeLayer(u){return this.style.removeLayer(u),this._update(!0)}getLayer(u){return this.style.getLayer(u)}setLayerZoomRange(u,t,l){return this.style.setLayerZoomRange(u,t,l),this._update(!0)}setFilter(u,t,l={}){return this.style.setFilter(u,t,l),this._update(!0)}getFilter(u){return this.style.getFilter(u)}setPaintProperty(u,t,l,p={}){return this.style.setPaintProperty(u,t,l,p),this._update(!0)}getPaintProperty(u,t){return this.style.getPaintProperty(u,t)}setLayoutProperty(u,t,l,p={}){return this.style.setLayoutProperty(u,t,l,p),this._update(!0)}getLayoutProperty(u,t){return this.style.getLayoutProperty(u,t)}setLight(u,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(u,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(u){return this._lazyInitEmptyStyle(),!u&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(u),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(u){return this._lazyInitEmptyStyle(),this.style.setFog(u),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(u){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(u),this.transform):0}setFeatureState(u,t){return this.style.setFeatureState(u,t),this._update()}removeFeatureState(u,t){return this.style.removeFeatureState(u,t),this._update()}getFeatureState(u){return this.style.getFeatureState(u)}_updateContainerDimensions(){if(!this._container)return;const u=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let l,p,_,b=this._container;for(;b&&(!p||!_);){const M=a.window.getComputedStyle(b).transform;M&&"none"!==M&&(l=M.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&"0"!==l[0]&&"1"!==l[0]&&(p=l[0]),l[3]&&"0"!==l[3]&&"1"!==l[3]&&(_=l[3])),b=b.parentElement}this._containerWidth=p?Math.abs(u/p):u,this._containerHeight=_?Math.abs(t/_):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=Fe("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Fe("div","mapboxgl-canvas-container",u);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Fe("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=Fe("div","mapboxgl-control-container",u),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{p[_]=Fe("div",`mapboxgl-ctrl-${_}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(u,t){const l=a.exported.devicePixelRatio||1;this._canvas.width=l*Math.ceil(u),this._canvas.height=l*Math.ceil(t),this._canvas.style.width=`${u}px`,this._canvas.style.height=`${t}px`}_addMarker(u){this._markers.push(u)}_removeMarker(u){const t=this._markers.indexOf(u);-1!==t&&this._markers.splice(t,1)}_addPopup(u){this._popups.push(u)}_removePopup(u){const t=this._popups.indexOf(u);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const u=a.extend({},Qe.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);t?(a.storeAuthState(t,!0),this.painter=new cl(t,this.transform),this.on("data",l=>{"source"===l.dataType&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(t)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:u}))}_contextRestored(u){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:u}))}_onMapScroll(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(u){return this._update(),this._renderTaskQueue.add(u)}_cancelRenderFrame(u){this._renderTaskQueue.remove(u)}_requestDomTask(u){!this.loaded()||this.loaded()&&!this.isMoving()?u():this._domRenderTaskQueue.add(u)}_render(u){let t;const l=this.painter.context.extTimerQuery,p=a.exported.now();if(this.listens("gpu-timing-frame")&&(t=l.createQueryEXT(),l.beginQueryEXT(l.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(u),this._domRenderTaskQueue.run(u),this._removed)return;this._updateProjectionTransition();const _=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,F=this.transform.pitch,q=a.exported.now(),W=new a.EvaluationParameters(O,{now:q,fadeDuration:_,pitch:F,transition:this.style.getTransition()});this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,_,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const O=a.exported.now()-p;l.endQueryEXT(l.TIME_ELAPSED_EXT,t),setTimeout(()=>{const F=l.getQueryObjectEXT(t,l.QUERY_RESULT_EXT)/1e6;l.deleteQueryEXT(t),this.fire(new a.Event("gpu-timing-frame",{cpuTime:O,gpuTime:F})),a.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:F}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(O);this.fire(new a.Event("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(O);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:F}))},50)}const M=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(M||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(b=this._updateAverageElevation(p,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(u){for(const t of this._markers)u&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!u||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(u,t=!1){const l=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&l(0);if((t||u-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(u)){const p=this.transform.averageElevation;let _=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(_)?_=0:this._averageElevationLastSampledAt=u;const M=Math.abs(p-_);if(M>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(_),l(_);this._averageElevation.easeTo(_,u,300)}else if(M>1e-4)return this._averageElevation.jumpTo(_),l(_)}return!!this._averageElevation.isEasing(u)&&l(this._averageElevation.getValue(u))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,u=>{if(u&&(u.message===a.AUTH_ERR_MSG||401===u.status)){const t=this.painter.context.gl;a.storeAuthState(t,!1),this._logoControl instanceof ka&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const u=this._isDragging();this.painter.updateTerrain(this.style,u)}_calculateSpeedIndex(){const u=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const l=this.painter.context.gl,p=l.createFramebuffer();function _(b){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,b,0);const M=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,M),M}return l.bindFramebuffer(l.FRAMEBUFFER,p),this._canvasPixelComparison(_(u),t.canvasCopies.map(_),t.timeStamps)}_canvasPixelComparison(u,t,l){let p=l[1]-l[0];const _=u.length/4;for(let b=0;b<t.length;b++){const M=t[b];let O=0;for(let F=0;F<M.length;F+=4)M[F]===u[F]&&M[F+1]===u[F+1]&&M[F+2]===u[F+2]&&M[F+3]===u[F+3]&&(O+=1);p+=(l[b+2]-l[b+1])*(1-O/_)}return p}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(u){this._renderNextFrame=this._renderNextFrame||u,this.style&&!this._frame&&(this._frame=a.exported.frame(t=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(t)}))}_preloadTiles(u){const t=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(t,(l,p)=>l._preloadTiles(u,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(u){this._trackResize&&this.resize({originalEvent:u})._update()}_onVisibilityChange(){"hidden"===a.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(u){this._showTerrainWireframe!==u&&(this._showTerrainWireframe=u,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(u){this._speedIndexTiming!==u&&(this._speedIndexTiming=u,this._update())}get showPadding(){return!!this._showPadding}set showPadding(u){this._showPadding!==u&&(this._showPadding=u,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())}get repaint(){return!!this._repaint}set repaint(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(u){this._vertices=u,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(u){this._showTileAABBs!==u&&(this._showTileAABBs=u,u&&this._update())}_setCacheLimits(u,t){a.setCacheLimits(u,t)}get version(){return a.version}},NavigationControl:class{constructor(u){this.options=a.extend({},Mr,u),this._container=Fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Fe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Fe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:t}):l.resetNorth({},{originalEvent:t}))}),this._compassIcon=Fe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const u=this._map;if(!u)return;const t=u.getZoom(),l=t===u.getMaxZoom(),p=t===u.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const u=this._map;if(!u)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(u.transform.pitch*(Math.PI/180)),.5)}) rotateX(${u.transform.pitch}deg) rotateZ(${u.transform.angle*(180/Math.PI)}deg)`:`rotate(${u.transform.angle*(180/Math.PI)}deg)`;u._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),u.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&u.on("pitch",this._rotateCompassArrow),u.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new So(u,this._compass,this.options.visualizePitch)),this._container}onRemove(){const u=this._map;u&&(this._container.remove(),this.options.showZoom&&u.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&u.off("pitch",this._rotateCompassArrow),u.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(u,t){const l=Fe("button",u,this._container);return l.type="button",l.addEventListener("click",t),l}_setButtonTitle(u,t){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${t}`);u.setAttribute("aria-label",l),u.firstElementChild&&u.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends a.Evented{constructor(u){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},P,u),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=hr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(u){return this._map=u,this._container=Fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(u){const t=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,u(l)};void 0!==this._supportsGeolocation?u(this._supportsGeolocation):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(l=>t("denied"!==l.state)).catch(()=>t()):t()}_isOutOfMapMaxBounds(u){const t=this._map.getMaxBounds(),l=u.coords;return!!t&&(l.longitude<t.getWest()||l.longitude>t.getEast()||l.latitude<t.getSouth()||l.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(u){if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(u),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(u),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",u)),this._finish()}}_updateCamera(u){const t=new a.LngLat(u.coords.longitude,u.coords.latitude),l=u.coords.accuracy,p=this._map.getBearing(),_=a.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(l),_,{geolocateSource:!0})}_updateMarker(u){if(u){const t=new a.LngLat(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=u.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const u=this._map.transform,t=a.mercatorZfromAltitude(1,u._center.lat)*u.worldSize,l=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(u){if(this._map){if(this.options.trackUserLocation)if(1===u.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===u.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",u)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(u){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Fe("button","mapboxgl-ctrl-geolocate",this._container),Fe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===u){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Fe("div","mapboxgl-user-location"),this._dotElement.appendChild(Fe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Fe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new qa({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Fe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(u){this._userLocationDotMarker&&(u.webkitCompassHeading?this._heading=u.webkitCompassHeading:!0===u.absolute&&(this._heading=-1*u.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let u;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(u={maximumAge:6e5,timeout:0},this._noTimeout=!0):(u=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,u),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const u=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==a.window.DeviceMotionEvent&&"function"==typeof a.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&u()}).catch(console.error):u()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Po,ScaleControl:class{constructor(u){this.options=a.extend({},k,u),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=D.bind(this)),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const u=this.options.maxWidth||100,t=this._map,l=t._containerHeight/2,p=t._containerWidth/2-u/2,_=t.unproject([p,l]),b=t.unproject([p+u,l]),M=_.distanceTo(b);if("imperial"===this.options.unit){const O=3.2808*M;O>5280?this._setScale(u,O/5280,"mile"):this._setScale(u,O,"foot")}else"nautical"===this.options.unit?this._setScale(u,M/1852,"nautical-mile"):M>=1e3?this._setScale(u,M/1e3,"kilometer"):this._setScale(u,M,"meter")}_setScale(u,t,l){const p=z(t),_=p/t;this._map._requestDomTask(()=>{this._container.style.width=u*_+"px",this._container.innerHTML="nautical-mile"!==l?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:l}).format(p):`${p}&nbsp;nm`})}onAdd(u){return this._map=u,this._language=u.getLanguage(),this._container=Fe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(u){this._language=u,this._update()}setUnit(u){this.options.unit=u,this._update()}},FullscreenControl:class{constructor(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof a.window.HTMLElement?this._container=u.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=Fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const u=this._fullscreenButton=Fe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Fe("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden","true"),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",u)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(u){super(),this.options=a.extend(Object.create(Hr),u),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(u&&u.className?u.className.trim().split(/\s+/):[])}addTo(u){return this._map&&this.remove(),this._map=u,this.options.closeOnClick&&u.on("preclick",this._onClose),this.options.closeOnMove&&u.on("move",this._onClose),u.on("remove",this.remove),this._update(),u._addPopup(this),this._focusFirstElement(),this._trackPointer?(u.on("mousemove",this._onMouseEvent),u.on("mouseup",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")):u.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const u=this._map;return u&&(u.off("move",this._update),u.off("move",this._onClose),u.off("preclick",this._onClose),u.off("click",this._onClose),u.off("remove",this.remove),u.off("mousemove",this._onMouseEvent),u.off("mouseup",this._onMouseEvent),u.off("drag",this._onMouseEvent),u._canvasContainer&&u._canvasContainer.classList.remove("mapboxgl-track-pointer"),u._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(u){this._lngLat=a.LngLat.convert(u),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const u=this._map;return u&&(u.off("move",this._update),u.on("mousemove",this._onMouseEvent),u.on("drag",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(u){return this.setDOMContent(a.window.document.createTextNode(u))}setHTML(u){const t=a.window.document.createDocumentFragment(),l=a.window.document.createElement("body");let p;for(l.innerHTML=u;p=l.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(u){return this.options.maxWidth=u,this._update(),this}setDOMContent(u){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Fe("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(u),this.options.closeButton){const l=this._closeButton=Fe("button","mapboxgl-popup-close-button",t);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(u){return this._classList.add(u),this._updateClassList(),this}removeClassName(u){return this._classList.delete(u),this._updateClassList(),this}setOffset(u){return this.options.offset=u,this._update(),this}toggleClassName(u){let t;return this._classList.delete(u)?t=!1:(this._classList.add(u),t=!0),this._updateClassList(),t}_onMouseEvent(u){this._update(u.point)}_getAnchor(u){if(this.options.anchor)return this.options.anchor;const t=this._map,l=this._container,p=this._pos;if(!t||!l||!p)return"bottom";const _=l.offsetWidth,b=l.offsetHeight,M=p.x<_/2,O=p.x>t.transform.width-_/2;if(p.y+u<b)return M?"top-left":O?"top-right":"top";if(p.y>t.transform.height-b){if(M)return"bottom-left";if(O)return"bottom-right"}return M?"left":O?"right":"bottom"}_updateClassList(){const u=this._container;if(!u)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),u.className=t.join(" ")}_update(u){const t=this._map,l=this._content;if(!t||!this._lngLat&&!this._trackPointer||!l)return;let p=this._container;if(p||(p=this._container=Fe("div","mapboxgl-popup",t.getContainer()),this._tip=Fe("div","mapboxgl-popup-tip",p),p.appendChild(l)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gs(this._lngLat,this._pos,t.transform)),!this._trackPointer||u){const _=this._pos=this._trackPointer&&u?u:t.project(this._lngLat),b=Ya(this.options.offset),M=this._anchor=this._getAnchor(b.y),O=Ya(this.options.offset,M),F=_.add(O).round();t._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${Ml[M]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&t._showingGlobe()){const _=a.isLngLatBehindGlobe(t.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const u=this._container.querySelector(Vl);u&&u.focus()}_onClose(){this.remove()}_setOpacity(u){this._container&&(this._container.style.opacity=`${u}`),this._content&&(this._content.style.pointerEvents=u?"auto":"none")}},Marker:qa,Style:yo,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:pt,Evented:a.Evented,config:a.config,prewarm:function(){gi().acquire(Qn)},clearPrewarmedResources:function(){const u=ci;u&&(u.isPreloaded()&&1===u.numActive()?(u.release(Qn),ci=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(u){a.config.ACCESS_TOKEN=u},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(u){a.config.API_URL=u},get workerCount(){return ei.workerCount},set workerCount(u){ei.workerCount=u},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){a.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage(u){a.clearTileCache(u)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return ee}),w}()},1135:(Yn,kt,L)=>{"use strict";L.d(kt,{X:()=>y});var w=L(7579);class y extends w.x{constructor(a){super(),this._value=a}get value(){return this.getValue()}_subscribe(a){const de=super._subscribe(a);return!de.closed&&a.next(this._value),de}getValue(){const{hasError:a,thrownError:de,_value:Qe}=this;if(a)throw de;return this._throwIfClosed(),Qe}next(a){super.next(this._value=a)}}},9751:(Yn,kt,L)=>{"use strict";L.d(kt,{y:()=>Ce});var w=L(930),y=L(727),j=L(8822),a=L(9635),de=L(2416),Qe=L(576),it=L(2806);let Ce=(()=>{class qe{constructor(tt){tt&&(this._subscribe=tt)}lift(tt){const Re=new qe;return Re.source=this,Re.operator=tt,Re}subscribe(tt,Re,ft){const et=function at(qe){return qe&&qe instanceof w.Lv||function $e(qe){return qe&&(0,Qe.m)(qe.next)&&(0,Qe.m)(qe.error)&&(0,Qe.m)(qe.complete)}(qe)&&(0,y.Nn)(qe)}(tt)?tt:new w.Hp(tt,Re,ft);return(0,it.x)(()=>{const{operator:ht,source:Gt}=this;et.add(ht?ht.call(et,Gt):Gt?this._subscribe(et):this._trySubscribe(et))}),et}_trySubscribe(tt){try{return this._subscribe(tt)}catch(Re){tt.error(Re)}}forEach(tt,Re){return new(Re=Fe(Re))((ft,et)=>{const ht=new w.Hp({next:Gt=>{try{tt(Gt)}catch(an){et(an),ht.unsubscribe()}},error:et,complete:ft});this.subscribe(ht)})}_subscribe(tt){var Re;return null===(Re=this.source)||void 0===Re?void 0:Re.subscribe(tt)}[j.L](){return this}pipe(...tt){return(0,a.U)(tt)(this)}toPromise(tt){return new(tt=Fe(tt))((Re,ft)=>{let et;this.subscribe(ht=>et=ht,ht=>ft(ht),()=>Re(et))})}}return qe.create=Ve=>new qe(Ve),qe})();function Fe(qe){var Ve;return null!==(Ve=qe??de.v.Promise)&&void 0!==Ve?Ve:Promise}},7579:(Yn,kt,L)=>{"use strict";L.d(kt,{x:()=>it});var w=L(9751),y=L(727);const a=(0,L(3888).d)(Fe=>function(){Fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var de=L(8737),Qe=L(2806);let it=(()=>{class Fe extends w.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(at){const qe=new Ce(this,this);return qe.operator=at,qe}_throwIfClosed(){if(this.closed)throw new a}next(at){(0,Qe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const qe of this.currentObservers)qe.next(at)}})}error(at){(0,Qe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=at;const{observers:qe}=this;for(;qe.length;)qe.shift().error(at)}})}complete(){(0,Qe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:at}=this;for(;at.length;)at.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var at;return(null===(at=this.observers)||void 0===at?void 0:at.length)>0}_trySubscribe(at){return this._throwIfClosed(),super._trySubscribe(at)}_subscribe(at){return this._throwIfClosed(),this._checkFinalizedStatuses(at),this._innerSubscribe(at)}_innerSubscribe(at){const{hasError:qe,isStopped:Ve,observers:tt}=this;return qe||Ve?y.Lc:(this.currentObservers=null,tt.push(at),new y.w0(()=>{this.currentObservers=null,(0,de.P)(tt,at)}))}_checkFinalizedStatuses(at){const{hasError:qe,thrownError:Ve,isStopped:tt}=this;qe?at.error(Ve):tt&&at.complete()}asObservable(){const at=new w.y;return at.source=this,at}}return Fe.create=($e,at)=>new Ce($e,at),Fe})();class Ce extends it{constructor($e,at){super(),this.destination=$e,this.source=at}next($e){var at,qe;null===(qe=null===(at=this.destination)||void 0===at?void 0:at.next)||void 0===qe||qe.call(at,$e)}error($e){var at,qe;null===(qe=null===(at=this.destination)||void 0===at?void 0:at.error)||void 0===qe||qe.call(at,$e)}complete(){var $e,at;null===(at=null===($e=this.destination)||void 0===$e?void 0:$e.complete)||void 0===at||at.call($e)}_subscribe($e){var at,qe;return null!==(qe=null===(at=this.source)||void 0===at?void 0:at.subscribe($e))&&void 0!==qe?qe:y.Lc}}},930:(Yn,kt,L)=>{"use strict";L.d(kt,{Hp:()=>ft,Lv:()=>qe});var w=L(576),y=L(727),j=L(2416),a=L(7849),de=L(5032);const Qe=Fe("C",void 0,void 0);function Fe(ot,Te,Ne){return{kind:ot,value:Te,error:Ne}}var $e=L(3410),at=L(2806);class qe extends y.w0{constructor(Te){super(),this.isStopped=!1,Te?(this.destination=Te,(0,y.Nn)(Te)&&Te.add(this)):this.destination=an}static create(Te,Ne,mt){return new ft(Te,Ne,mt)}next(Te){this.isStopped?Gt(function Ce(ot){return Fe("N",ot,void 0)}(Te),this):this._next(Te)}error(Te){this.isStopped?Gt(function it(ot){return Fe("E",void 0,ot)}(Te),this):(this.isStopped=!0,this._error(Te))}complete(){this.isStopped?Gt(Qe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Te){this.destination.next(Te)}_error(Te){try{this.destination.error(Te)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ve=Function.prototype.bind;function tt(ot,Te){return Ve.call(ot,Te)}class Re{constructor(Te){this.partialObserver=Te}next(Te){const{partialObserver:Ne}=this;if(Ne.next)try{Ne.next(Te)}catch(mt){et(mt)}}error(Te){const{partialObserver:Ne}=this;if(Ne.error)try{Ne.error(Te)}catch(mt){et(mt)}else et(Te)}complete(){const{partialObserver:Te}=this;if(Te.complete)try{Te.complete()}catch(Ne){et(Ne)}}}class ft extends qe{constructor(Te,Ne,mt){let It;if(super(),(0,w.m)(Te)||!Te)It={next:Te??void 0,error:Ne??void 0,complete:mt??void 0};else{let sn;this&&j.v.useDeprecatedNextContext?(sn=Object.create(Te),sn.unsubscribe=()=>this.unsubscribe(),It={next:Te.next&&tt(Te.next,sn),error:Te.error&&tt(Te.error,sn),complete:Te.complete&&tt(Te.complete,sn)}):It=Te}this.destination=new Re(It)}}function et(ot){j.v.useDeprecatedSynchronousErrorHandling?(0,at.O)(ot):(0,a.h)(ot)}function Gt(ot,Te){const{onStoppedNotification:Ne}=j.v;Ne&&$e.z.setTimeout(()=>Ne(ot,Te))}const an={closed:!0,next:de.Z,error:function ht(ot){throw ot},complete:de.Z}},727:(Yn,kt,L)=>{"use strict";L.d(kt,{Lc:()=>Qe,w0:()=>de,Nn:()=>it});var w=L(576);const j=(0,L(3888).d)(Fe=>function(at){Fe(this),this.message=at?`${at.length} errors occurred during unsubscription:\n${at.map((qe,Ve)=>`${Ve+1}) ${qe.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=at});var a=L(8737);class de{constructor($e){this.initialTeardown=$e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let $e;if(!this.closed){this.closed=!0;const{_parentage:at}=this;if(at)if(this._parentage=null,Array.isArray(at))for(const tt of at)tt.remove(this);else at.remove(this);const{initialTeardown:qe}=this;if((0,w.m)(qe))try{qe()}catch(tt){$e=tt instanceof j?tt.errors:[tt]}const{_finalizers:Ve}=this;if(Ve){this._finalizers=null;for(const tt of Ve)try{Ce(tt)}catch(Re){$e=$e??[],Re instanceof j?$e=[...$e,...Re.errors]:$e.push(Re)}}if($e)throw new j($e)}}add($e){var at;if($e&&$e!==this)if(this.closed)Ce($e);else{if($e instanceof de){if($e.closed||$e._hasParent(this))return;$e._addParent(this)}(this._finalizers=null!==(at=this._finalizers)&&void 0!==at?at:[]).push($e)}}_hasParent($e){const{_parentage:at}=this;return at===$e||Array.isArray(at)&&at.includes($e)}_addParent($e){const{_parentage:at}=this;this._parentage=Array.isArray(at)?(at.push($e),at):at?[at,$e]:$e}_removeParent($e){const{_parentage:at}=this;at===$e?this._parentage=null:Array.isArray(at)&&(0,a.P)(at,$e)}remove($e){const{_finalizers:at}=this;at&&(0,a.P)(at,$e),$e instanceof de&&$e._removeParent(this)}}de.EMPTY=(()=>{const Fe=new de;return Fe.closed=!0,Fe})();const Qe=de.EMPTY;function it(Fe){return Fe instanceof de||Fe&&"closed"in Fe&&(0,w.m)(Fe.remove)&&(0,w.m)(Fe.add)&&(0,w.m)(Fe.unsubscribe)}function Ce(Fe){(0,w.m)(Fe)?Fe():Fe.unsubscribe()}},2416:(Yn,kt,L)=>{"use strict";L.d(kt,{v:()=>w});const w={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},4033:(Yn,kt,L)=>{"use strict";L.d(kt,{c:()=>Qe});var w=L(9751),y=L(727),j=L(8343),a=L(5403),de=L(4482);class Qe extends w.y{constructor(Ce,Fe){super(),this.source=Ce,this.subjectFactory=Fe,this._subject=null,this._refCount=0,this._connection=null,(0,de.A)(Ce)&&(this.lift=Ce.lift)}_subscribe(Ce){return this.getSubject().subscribe(Ce)}getSubject(){const Ce=this._subject;return(!Ce||Ce.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:Ce}=this;this._subject=this._connection=null,Ce?.unsubscribe()}connect(){let Ce=this._connection;if(!Ce){Ce=this._connection=new y.w0;const Fe=this.getSubject();Ce.add(this.source.subscribe((0,a.x)(Fe,void 0,()=>{this._teardown(),Fe.complete()},$e=>{this._teardown(),Fe.error($e)},()=>this._teardown()))),Ce.closed&&(this._connection=null,Ce=y.w0.EMPTY)}return Ce}refCount(){return(0,j.x)()(this)}}},9841:(Yn,kt,L)=>{"use strict";L.d(kt,{a:()=>$e});var w=L(9751),y=L(4742),j=L(2076),a=L(4671),de=L(3268),Qe=L(3269),it=L(1810),Ce=L(5403),Fe=L(9672);function $e(...Ve){const tt=(0,Qe.yG)(Ve),Re=(0,Qe.jO)(Ve),{args:ft,keys:et}=(0,y.D)(Ve);if(0===ft.length)return(0,j.D)([],tt);const ht=new w.y(function at(Ve,tt,Re=a.y){return ft=>{qe(tt,()=>{const{length:et}=Ve,ht=new Array(et);let Gt=et,an=et;for(let ot=0;ot<et;ot++)qe(tt,()=>{const Te=(0,j.D)(Ve[ot],tt);let Ne=!1;Te.subscribe((0,Ce.x)(ft,mt=>{ht[ot]=mt,Ne||(Ne=!0,an--),an||ft.next(Re(ht.slice()))},()=>{--Gt||ft.complete()}))},ft)},ft)}}(ft,tt,et?Gt=>(0,it.n)(et,Gt):a.y));return Re?ht.pipe((0,de.Z)(Re)):ht}function qe(Ve,tt,Re){Ve?(0,Fe.f)(Re,Ve,tt):tt()}},7272:(Yn,kt,L)=>{"use strict";L.d(kt,{z:()=>de});var w=L(8189),j=L(3269),a=L(2076);function de(...Qe){return function y(){return(0,w.J)(1)}()((0,a.D)(Qe,(0,j.yG)(Qe)))}},9770:(Yn,kt,L)=>{"use strict";L.d(kt,{P:()=>j});var w=L(9751),y=L(8421);function j(a){return new w.y(de=>{(0,y.Xf)(a()).subscribe(de)})}},515:(Yn,kt,L)=>{"use strict";L.d(kt,{E:()=>y});const y=new(L(9751).y)(de=>de.complete())},4128:(Yn,kt,L)=>{"use strict";L.d(kt,{D:()=>Ce});var w=L(9751),y=L(4742),j=L(8421),a=L(3269),de=L(5403),Qe=L(3268),it=L(1810);function Ce(...Fe){const $e=(0,a.jO)(Fe),{args:at,keys:qe}=(0,y.D)(Fe),Ve=new w.y(tt=>{const{length:Re}=at;if(!Re)return void tt.complete();const ft=new Array(Re);let et=Re,ht=Re;for(let Gt=0;Gt<Re;Gt++){let an=!1;(0,j.Xf)(at[Gt]).subscribe((0,de.x)(tt,ot=>{an||(an=!0,ht--),ft[Gt]=ot},()=>et--,void 0,()=>{(!et||!an)&&(ht||tt.next(qe?(0,it.n)(qe,ft):ft),tt.complete())}))}});return $e?Ve.pipe((0,Qe.Z)($e)):Ve}},2076:(Yn,kt,L)=>{"use strict";L.d(kt,{D:()=>mt});var w=L(8421),y=L(9672),j=L(4482),a=L(5403);function de(It,sn=0){return(0,j.e)((Cn,Yt)=>{Cn.subscribe((0,a.x)(Yt,nt=>(0,y.f)(Yt,It,()=>Yt.next(nt),sn),()=>(0,y.f)(Yt,It,()=>Yt.complete(),sn),nt=>(0,y.f)(Yt,It,()=>Yt.error(nt),sn)))})}function Qe(It,sn=0){return(0,j.e)((Cn,Yt)=>{Yt.add(It.schedule(()=>Cn.subscribe(Yt),sn))})}var Fe=L(9751),at=L(2202),qe=L(576);function tt(It,sn){if(!It)throw new Error("Iterable cannot be null");return new Fe.y(Cn=>{(0,y.f)(Cn,sn,()=>{const Yt=It[Symbol.asyncIterator]();(0,y.f)(Cn,sn,()=>{Yt.next().then(nt=>{nt.done?Cn.complete():Cn.next(nt.value)})},0,!0)})})}var Re=L(3670),ft=L(8239),et=L(1144),ht=L(6495),Gt=L(2206),an=L(4532),ot=L(3260);function mt(It,sn){return sn?function Ne(It,sn){if(null!=It){if((0,Re.c)(It))return function it(It,sn){return(0,w.Xf)(It).pipe(Qe(sn),de(sn))}(It,sn);if((0,et.z)(It))return function $e(It,sn){return new Fe.y(Cn=>{let Yt=0;return sn.schedule(function(){Yt===It.length?Cn.complete():(Cn.next(It[Yt++]),Cn.closed||this.schedule())})})}(It,sn);if((0,ft.t)(It))return function Ce(It,sn){return(0,w.Xf)(It).pipe(Qe(sn),de(sn))}(It,sn);if((0,Gt.D)(It))return tt(It,sn);if((0,ht.T)(It))return function Ve(It,sn){return new Fe.y(Cn=>{let Yt;return(0,y.f)(Cn,sn,()=>{Yt=It[at.h](),(0,y.f)(Cn,sn,()=>{let nt,Et;try{({value:nt,done:Et}=Yt.next())}catch(ct){return void Cn.error(ct)}Et?Cn.complete():Cn.next(nt)},0,!0)}),()=>(0,qe.m)(Yt?.return)&&Yt.return()})}(It,sn);if((0,ot.L)(It))return function Te(It,sn){return tt((0,ot.Q)(It),sn)}(It,sn)}throw(0,an.z)(It)}(It,sn):(0,w.Xf)(It)}},4968:(Yn,kt,L)=>{"use strict";L.d(kt,{R:()=>$e});var w=L(8421),y=L(9751),j=L(5577),a=L(1144),de=L(576),Qe=L(3268);const it=["addListener","removeListener"],Ce=["addEventListener","removeEventListener"],Fe=["on","off"];function $e(Re,ft,et,ht){if((0,de.m)(et)&&(ht=et,et=void 0),ht)return $e(Re,ft,et).pipe((0,Qe.Z)(ht));const[Gt,an]=function tt(Re){return(0,de.m)(Re.addEventListener)&&(0,de.m)(Re.removeEventListener)}(Re)?Ce.map(ot=>Te=>Re[ot](ft,Te,et)):function qe(Re){return(0,de.m)(Re.addListener)&&(0,de.m)(Re.removeListener)}(Re)?it.map(at(Re,ft)):function Ve(Re){return(0,de.m)(Re.on)&&(0,de.m)(Re.off)}(Re)?Fe.map(at(Re,ft)):[];if(!Gt&&(0,a.z)(Re))return(0,j.z)(ot=>$e(ot,ft,et))((0,w.Xf)(Re));if(!Gt)throw new TypeError("Invalid event target");return new y.y(ot=>{const Te=(...Ne)=>ot.next(1<Ne.length?Ne:Ne[0]);return Gt(Te),()=>an(Te)})}function at(Re,ft){return et=>ht=>Re[et](ft,ht)}},8421:(Yn,kt,L)=>{"use strict";L.d(kt,{Xf:()=>Ve});var w=L(7582),y=L(1144),j=L(8239),a=L(9751),de=L(3670),Qe=L(2206),it=L(4532),Ce=L(6495),Fe=L(3260),$e=L(576),at=L(7849),qe=L(8822);function Ve(ot){if(ot instanceof a.y)return ot;if(null!=ot){if((0,de.c)(ot))return function tt(ot){return new a.y(Te=>{const Ne=ot[qe.L]();if((0,$e.m)(Ne.subscribe))return Ne.subscribe(Te);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(ot);if((0,y.z)(ot))return function Re(ot){return new a.y(Te=>{for(let Ne=0;Ne<ot.length&&!Te.closed;Ne++)Te.next(ot[Ne]);Te.complete()})}(ot);if((0,j.t)(ot))return function ft(ot){return new a.y(Te=>{ot.then(Ne=>{Te.closed||(Te.next(Ne),Te.complete())},Ne=>Te.error(Ne)).then(null,at.h)})}(ot);if((0,Qe.D)(ot))return ht(ot);if((0,Ce.T)(ot))return function et(ot){return new a.y(Te=>{for(const Ne of ot)if(Te.next(Ne),Te.closed)return;Te.complete()})}(ot);if((0,Fe.L)(ot))return function Gt(ot){return ht((0,Fe.Q)(ot))}(ot)}throw(0,it.z)(ot)}function ht(ot){return new a.y(Te=>{(function an(ot,Te){var Ne,mt,It,sn;return(0,w.mG)(this,void 0,void 0,function*(){try{for(Ne=(0,w.KL)(ot);!(mt=yield Ne.next()).done;)if(Te.next(mt.value),Te.closed)return}catch(Cn){It={error:Cn}}finally{try{mt&&!mt.done&&(sn=Ne.return)&&(yield sn.call(Ne))}finally{if(It)throw It.error}}Te.complete()})})(ot,Te).catch(Ne=>Te.error(Ne))})}},6451:(Yn,kt,L)=>{"use strict";L.d(kt,{T:()=>Qe});var w=L(8189),y=L(8421),j=L(515),a=L(3269),de=L(2076);function Qe(...it){const Ce=(0,a.yG)(it),Fe=(0,a._6)(it,1/0),$e=it;return $e.length?1===$e.length?(0,y.Xf)($e[0]):(0,w.J)(Fe)((0,de.D)($e,Ce)):j.E}},9646:(Yn,kt,L)=>{"use strict";L.d(kt,{of:()=>j});var w=L(3269),y=L(2076);function j(...a){const de=(0,w.yG)(a);return(0,y.D)(a,de)}},2843:(Yn,kt,L)=>{"use strict";L.d(kt,{_:()=>j});var w=L(9751),y=L(576);function j(a,de){const Qe=(0,y.m)(a)?a:()=>a,it=Ce=>Ce.error(Qe());return new w.y(de?Ce=>de.schedule(it,0,Ce):it)}},5963:(Yn,kt,L)=>{"use strict";L.d(kt,{H:()=>de});var w=L(9751),y=L(4986),j=L(3532);function de(Qe=0,it,Ce=y.P){let Fe=-1;return null!=it&&((0,j.K)(it)?Ce=it:Fe=it),new w.y($e=>{let at=function a(Qe){return Qe instanceof Date&&!isNaN(Qe)}(Qe)?+Qe-Ce.now():Qe;at<0&&(at=0);let qe=0;return Ce.schedule(function(){$e.closed||($e.next(qe++),0<=Fe?this.schedule(void 0,Fe):$e.complete())},at)})}},5403:(Yn,kt,L)=>{"use strict";L.d(kt,{x:()=>y});var w=L(930);function y(a,de,Qe,it,Ce){return new j(a,de,Qe,it,Ce)}class j extends w.Lv{constructor(de,Qe,it,Ce,Fe,$e){super(de),this.onFinalize=Fe,this.shouldUnsubscribe=$e,this._next=Qe?function(at){try{Qe(at)}catch(qe){de.error(qe)}}:super._next,this._error=Ce?function(at){try{Ce(at)}catch(qe){de.error(qe)}finally{this.unsubscribe()}}:super._error,this._complete=it?function(){try{it()}catch(at){de.error(at)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var de;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Qe}=this;super.unsubscribe(),!Qe&&(null===(de=this.onFinalize)||void 0===de||de.call(this))}}}},262:(Yn,kt,L)=>{"use strict";L.d(kt,{K:()=>a});var w=L(8421),y=L(5403),j=L(4482);function a(de){return(0,j.e)((Qe,it)=>{let $e,Ce=null,Fe=!1;Ce=Qe.subscribe((0,y.x)(it,void 0,void 0,at=>{$e=(0,w.Xf)(de(at,a(de)(Qe))),Ce?(Ce.unsubscribe(),Ce=null,$e.subscribe(it)):Fe=!0})),Fe&&(Ce.unsubscribe(),Ce=null,$e.subscribe(it))})}},4351:(Yn,kt,L)=>{"use strict";L.d(kt,{b:()=>j});var w=L(5577),y=L(576);function j(a,de){return(0,y.m)(de)?(0,w.z)(a,de,1):(0,w.z)(a,1)}},8372:(Yn,kt,L)=>{"use strict";L.d(kt,{b:()=>a});var w=L(4986),y=L(4482),j=L(5403);function a(de,Qe=w.z){return(0,y.e)((it,Ce)=>{let Fe=null,$e=null,at=null;const qe=()=>{if(Fe){Fe.unsubscribe(),Fe=null;const tt=$e;$e=null,Ce.next(tt)}};function Ve(){const tt=at+de,Re=Qe.now();if(Re<tt)return Fe=this.schedule(void 0,tt-Re),void Ce.add(Fe);qe()}it.subscribe((0,j.x)(Ce,tt=>{$e=tt,at=Qe.now(),Fe||(Fe=Qe.schedule(Ve,de),Ce.add(Fe))},()=>{qe(),Ce.complete()},void 0,()=>{$e=Fe=null}))})}},1005:(Yn,kt,L)=>{"use strict";L.d(kt,{g:()=>qe});var w=L(4986),y=L(7272),j=L(5698),a=L(4482),de=L(5403),Qe=L(5032),Ce=L(9718),Fe=L(5577);function $e(Ve,tt){return tt?Re=>(0,y.z)(tt.pipe((0,j.q)(1),function it(){return(0,a.e)((Ve,tt)=>{Ve.subscribe((0,de.x)(tt,Qe.Z))})}()),Re.pipe($e(Ve))):(0,Fe.z)((Re,ft)=>Ve(Re,ft).pipe((0,j.q)(1),(0,Ce.h)(Re)))}var at=L(5963);function qe(Ve,tt=w.z){const Re=(0,at.H)(Ve,tt);return $e(()=>Re)}},1884:(Yn,kt,L)=>{"use strict";L.d(kt,{x:()=>a});var w=L(4671),y=L(4482),j=L(5403);function a(Qe,it=w.y){return Qe=Qe??de,(0,y.e)((Ce,Fe)=>{let $e,at=!0;Ce.subscribe((0,j.x)(Fe,qe=>{const Ve=it(qe);(at||!Qe($e,Ve))&&(at=!1,$e=Ve,Fe.next(qe))}))})}function de(Qe,it){return Qe===it}},9300:(Yn,kt,L)=>{"use strict";L.d(kt,{h:()=>j});var w=L(4482),y=L(5403);function j(a,de){return(0,w.e)((Qe,it)=>{let Ce=0;Qe.subscribe((0,y.x)(it,Fe=>a.call(de,Fe,Ce++)&&it.next(Fe)))})}},8746:(Yn,kt,L)=>{"use strict";L.d(kt,{x:()=>y});var w=L(4482);function y(j){return(0,w.e)((a,de)=>{try{a.subscribe(de)}finally{de.add(j)}})}},4004:(Yn,kt,L)=>{"use strict";L.d(kt,{U:()=>j});var w=L(4482),y=L(5403);function j(a,de){return(0,w.e)((Qe,it)=>{let Ce=0;Qe.subscribe((0,y.x)(it,Fe=>{it.next(a.call(de,Fe,Ce++))}))})}},9718:(Yn,kt,L)=>{"use strict";L.d(kt,{h:()=>y});var w=L(4004);function y(j){return(0,w.U)(()=>j)}},8189:(Yn,kt,L)=>{"use strict";L.d(kt,{J:()=>j});var w=L(5577),y=L(4671);function j(a=1/0){return(0,w.z)(y.y,a)}},5577:(Yn,kt,L)=>{"use strict";L.d(kt,{z:()=>Ce});var w=L(4004),y=L(8421),j=L(4482),a=L(9672),de=L(5403),it=L(576);function Ce(Fe,$e,at=1/0){return(0,it.m)($e)?Ce((qe,Ve)=>(0,w.U)((tt,Re)=>$e(qe,tt,Ve,Re))((0,y.Xf)(Fe(qe,Ve))),at):("number"==typeof $e&&(at=$e),(0,j.e)((qe,Ve)=>function Qe(Fe,$e,at,qe,Ve,tt,Re,ft){const et=[];let ht=0,Gt=0,an=!1;const ot=()=>{an&&!et.length&&!ht&&$e.complete()},Te=mt=>ht<qe?Ne(mt):et.push(mt),Ne=mt=>{tt&&$e.next(mt),ht++;let It=!1;(0,y.Xf)(at(mt,Gt++)).subscribe((0,de.x)($e,sn=>{Ve?.(sn),tt?Te(sn):$e.next(sn)},()=>{It=!0},void 0,()=>{if(It)try{for(ht--;et.length&&ht<qe;){const sn=et.shift();Re?(0,a.f)($e,Re,()=>Ne(sn)):Ne(sn)}ot()}catch(sn){$e.error(sn)}}))};return Fe.subscribe((0,de.x)($e,Te,()=>{an=!0,ot()})),()=>{ft?.()}}(qe,Ve,Fe,at)))}},8343:(Yn,kt,L)=>{"use strict";L.d(kt,{x:()=>j});var w=L(4482),y=L(5403);function j(){return(0,w.e)((a,de)=>{let Qe=null;a._refCount++;const it=(0,y.x)(de,void 0,void 0,void 0,()=>{if(!a||a._refCount<=0||0<--a._refCount)return void(Qe=null);const Ce=a._connection,Fe=Qe;Qe=null,Ce&&(!Fe||Ce===Fe)&&Ce.unsubscribe(),de.unsubscribe()});a.subscribe(it),it.closed||(Qe=a.connect())})}},3099:(Yn,kt,L)=>{"use strict";L.d(kt,{B:()=>de});var w=L(8421),y=L(7579),j=L(930),a=L(4482);function de(it={}){const{connector:Ce=(()=>new y.x),resetOnError:Fe=!0,resetOnComplete:$e=!0,resetOnRefCountZero:at=!0}=it;return qe=>{let Ve,tt,Re,ft=0,et=!1,ht=!1;const Gt=()=>{tt?.unsubscribe(),tt=void 0},an=()=>{Gt(),Ve=Re=void 0,et=ht=!1},ot=()=>{const Te=Ve;an(),Te?.unsubscribe()};return(0,a.e)((Te,Ne)=>{ft++,!ht&&!et&&Gt();const mt=Re=Re??Ce();Ne.add(()=>{ft--,0===ft&&!ht&&!et&&(tt=Qe(ot,at))}),mt.subscribe(Ne),!Ve&&ft>0&&(Ve=new j.Hp({next:It=>mt.next(It),error:It=>{ht=!0,Gt(),tt=Qe(an,Fe,It),mt.error(It)},complete:()=>{et=!0,Gt(),tt=Qe(an,$e),mt.complete()}}),(0,w.Xf)(Te).subscribe(Ve))})(qe)}}function Qe(it,Ce,...Fe){if(!0===Ce)return void it();if(!1===Ce)return;const $e=new j.Hp({next:()=>{$e.unsubscribe(),it()}});return Ce(...Fe).subscribe($e)}},5684:(Yn,kt,L)=>{"use strict";L.d(kt,{T:()=>y});var w=L(9300);function y(j){return(0,w.h)((a,de)=>j<=de)}},8675:(Yn,kt,L)=>{"use strict";L.d(kt,{O:()=>a});var w=L(7272),y=L(3269),j=L(4482);function a(...de){const Qe=(0,y.yG)(de);return(0,j.e)((it,Ce)=>{(Qe?(0,w.z)(de,it,Qe):(0,w.z)(de,it)).subscribe(Ce)})}},3900:(Yn,kt,L)=>{"use strict";L.d(kt,{w:()=>a});var w=L(8421),y=L(4482),j=L(5403);function a(de,Qe){return(0,y.e)((it,Ce)=>{let Fe=null,$e=0,at=!1;const qe=()=>at&&!Fe&&Ce.complete();it.subscribe((0,j.x)(Ce,Ve=>{Fe?.unsubscribe();let tt=0;const Re=$e++;(0,w.Xf)(de(Ve,Re)).subscribe(Fe=(0,j.x)(Ce,ft=>Ce.next(Qe?Qe(Ve,ft,Re,tt++):ft),()=>{Fe=null,qe()}))},()=>{at=!0,qe()}))})}},5698:(Yn,kt,L)=>{"use strict";L.d(kt,{q:()=>a});var w=L(515),y=L(4482),j=L(5403);function a(de){return de<=0?()=>w.E:(0,y.e)((Qe,it)=>{let Ce=0;Qe.subscribe((0,j.x)(it,Fe=>{++Ce<=de&&(it.next(Fe),de<=Ce&&it.complete())}))})}},2722:(Yn,kt,L)=>{"use strict";L.d(kt,{R:()=>de});var w=L(4482),y=L(5403),j=L(8421),a=L(5032);function de(Qe){return(0,w.e)((it,Ce)=>{(0,j.Xf)(Qe).subscribe((0,y.x)(Ce,()=>Ce.complete(),a.Z)),!Ce.closed&&it.subscribe(Ce)})}},8505:(Yn,kt,L)=>{"use strict";L.d(kt,{b:()=>de});var w=L(576),y=L(4482),j=L(5403),a=L(4671);function de(Qe,it,Ce){const Fe=(0,w.m)(Qe)||it||Ce?{next:Qe,error:it,complete:Ce}:Qe;return Fe?(0,y.e)(($e,at)=>{var qe;null===(qe=Fe.subscribe)||void 0===qe||qe.call(Fe);let Ve=!0;$e.subscribe((0,j.x)(at,tt=>{var Re;null===(Re=Fe.next)||void 0===Re||Re.call(Fe,tt),at.next(tt)},()=>{var tt;Ve=!1,null===(tt=Fe.complete)||void 0===tt||tt.call(Fe),at.complete()},tt=>{var Re;Ve=!1,null===(Re=Fe.error)||void 0===Re||Re.call(Fe,tt),at.error(tt)},()=>{var tt,Re;Ve&&(null===(tt=Fe.unsubscribe)||void 0===tt||tt.call(Fe)),null===(Re=Fe.finalize)||void 0===Re||Re.call(Fe)}))}):a.y}},4408:(Yn,kt,L)=>{"use strict";L.d(kt,{o:()=>de});var w=L(727);class y extends w.w0{constructor(it,Ce){super()}schedule(it,Ce=0){return this}}const j={setInterval(Qe,it,...Ce){const{delegate:Fe}=j;return Fe?.setInterval?Fe.setInterval(Qe,it,...Ce):setInterval(Qe,it,...Ce)},clearInterval(Qe){const{delegate:it}=j;return(it?.clearInterval||clearInterval)(Qe)},delegate:void 0};var a=L(8737);class de extends y{constructor(it,Ce){super(it,Ce),this.scheduler=it,this.work=Ce,this.pending=!1}schedule(it,Ce=0){var Fe;if(this.closed)return this;this.state=it;const $e=this.id,at=this.scheduler;return null!=$e&&(this.id=this.recycleAsyncId(at,$e,Ce)),this.pending=!0,this.delay=Ce,this.id=null!==(Fe=this.id)&&void 0!==Fe?Fe:this.requestAsyncId(at,this.id,Ce),this}requestAsyncId(it,Ce,Fe=0){return j.setInterval(it.flush.bind(it,this),Fe)}recycleAsyncId(it,Ce,Fe=0){if(null!=Fe&&this.delay===Fe&&!1===this.pending)return Ce;null!=Ce&&j.clearInterval(Ce)}execute(it,Ce){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Fe=this._execute(it,Ce);if(Fe)return Fe;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(it,Ce){let $e,Fe=!1;try{this.work(it)}catch(at){Fe=!0,$e=at||new Error("Scheduled action threw falsy error")}if(Fe)return this.unsubscribe(),$e}unsubscribe(){if(!this.closed){const{id:it,scheduler:Ce}=this,{actions:Fe}=Ce;this.work=this.state=this.scheduler=null,this.pending=!1,(0,a.P)(Fe,this),null!=it&&(this.id=this.recycleAsyncId(Ce,it,null)),this.delay=null,super.unsubscribe()}}}},640:(Yn,kt,L)=>{"use strict";L.d(kt,{v:()=>j});const w={now:()=>(w.delegate||Date).now(),delegate:void 0};class y{constructor(de,Qe=y.now){this.schedulerActionCtor=de,this.now=Qe}schedule(de,Qe=0,it){return new this.schedulerActionCtor(this,de).schedule(it,Qe)}}y.now=w.now;class j extends y{constructor(de,Qe=y.now){super(de,Qe),this.actions=[],this._active=!1}flush(de){const{actions:Qe}=this;if(this._active)return void Qe.push(de);let it;this._active=!0;do{if(it=de.execute(de.state,de.delay))break}while(de=Qe.shift());if(this._active=!1,it){for(;de=Qe.shift();)de.unsubscribe();throw it}}}},4986:(Yn,kt,L)=>{"use strict";L.d(kt,{P:()=>a,z:()=>j});var w=L(4408);const j=new(L(640).v)(w.o),a=j},3410:(Yn,kt,L)=>{"use strict";L.d(kt,{z:()=>w});const w={setTimeout(y,j,...a){const{delegate:de}=w;return de?.setTimeout?de.setTimeout(y,j,...a):setTimeout(y,j,...a)},clearTimeout(y){const{delegate:j}=w;return(j?.clearTimeout||clearTimeout)(y)},delegate:void 0}},2202:(Yn,kt,L)=>{"use strict";L.d(kt,{h:()=>y});const y=function w(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Yn,kt,L)=>{"use strict";L.d(kt,{L:()=>w});const w="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(Yn,kt,L)=>{"use strict";L.d(kt,{_6:()=>Qe,jO:()=>a,yG:()=>de});var w=L(576),y=L(3532);function j(it){return it[it.length-1]}function a(it){return(0,w.m)(j(it))?it.pop():void 0}function de(it){return(0,y.K)(j(it))?it.pop():void 0}function Qe(it,Ce){return"number"==typeof j(it)?it.pop():Ce}},4742:(Yn,kt,L)=>{"use strict";L.d(kt,{D:()=>de});const{isArray:w}=Array,{getPrototypeOf:y,prototype:j,keys:a}=Object;function de(it){if(1===it.length){const Ce=it[0];if(w(Ce))return{args:Ce,keys:null};if(function Qe(it){return it&&"object"==typeof it&&y(it)===j}(Ce)){const Fe=a(Ce);return{args:Fe.map($e=>Ce[$e]),keys:Fe}}}return{args:it,keys:null}}},8737:(Yn,kt,L)=>{"use strict";function w(y,j){if(y){const a=y.indexOf(j);0<=a&&y.splice(a,1)}}L.d(kt,{P:()=>w})},3888:(Yn,kt,L)=>{"use strict";function w(y){const a=y(de=>{Error.call(de),de.stack=(new Error).stack});return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}L.d(kt,{d:()=>w})},1810:(Yn,kt,L)=>{"use strict";function w(y,j){return y.reduce((a,de,Qe)=>(a[de]=j[Qe],a),{})}L.d(kt,{n:()=>w})},2806:(Yn,kt,L)=>{"use strict";L.d(kt,{O:()=>a,x:()=>j});var w=L(2416);let y=null;function j(de){if(w.v.useDeprecatedSynchronousErrorHandling){const Qe=!y;if(Qe&&(y={errorThrown:!1,error:null}),de(),Qe){const{errorThrown:it,error:Ce}=y;if(y=null,it)throw Ce}}else de()}function a(de){w.v.useDeprecatedSynchronousErrorHandling&&y&&(y.errorThrown=!0,y.error=de)}},9672:(Yn,kt,L)=>{"use strict";function w(y,j,a,de=0,Qe=!1){const it=j.schedule(function(){a(),Qe?y.add(this.schedule(null,de)):this.unsubscribe()},de);if(y.add(it),!Qe)return it}L.d(kt,{f:()=>w})},4671:(Yn,kt,L)=>{"use strict";function w(y){return y}L.d(kt,{y:()=>w})},1144:(Yn,kt,L)=>{"use strict";L.d(kt,{z:()=>w});const w=y=>y&&"number"==typeof y.length&&"function"!=typeof y},2206:(Yn,kt,L)=>{"use strict";L.d(kt,{D:()=>y});var w=L(576);function y(j){return Symbol.asyncIterator&&(0,w.m)(j?.[Symbol.asyncIterator])}},576:(Yn,kt,L)=>{"use strict";function w(y){return"function"==typeof y}L.d(kt,{m:()=>w})},3670:(Yn,kt,L)=>{"use strict";L.d(kt,{c:()=>j});var w=L(8822),y=L(576);function j(a){return(0,y.m)(a[w.L])}},6495:(Yn,kt,L)=>{"use strict";L.d(kt,{T:()=>j});var w=L(2202),y=L(576);function j(a){return(0,y.m)(a?.[w.h])}},8239:(Yn,kt,L)=>{"use strict";L.d(kt,{t:()=>y});var w=L(576);function y(j){return(0,w.m)(j?.then)}},3260:(Yn,kt,L)=>{"use strict";L.d(kt,{L:()=>a,Q:()=>j});var w=L(7582),y=L(576);function j(de){return(0,w.FC)(this,arguments,function*(){const it=de.getReader();try{for(;;){const{value:Ce,done:Fe}=yield(0,w.qq)(it.read());if(Fe)return yield(0,w.qq)(void 0);yield yield(0,w.qq)(Ce)}}finally{it.releaseLock()}})}function a(de){return(0,y.m)(de?.getReader)}},3532:(Yn,kt,L)=>{"use strict";L.d(kt,{K:()=>y});var w=L(576);function y(j){return j&&(0,w.m)(j.schedule)}},4482:(Yn,kt,L)=>{"use strict";L.d(kt,{A:()=>y,e:()=>j});var w=L(576);function y(a){return(0,w.m)(a?.lift)}function j(a){return de=>{if(y(de))return de.lift(function(Qe){try{return a(Qe,this)}catch(it){this.error(it)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Yn,kt,L)=>{"use strict";L.d(kt,{Z:()=>a});var w=L(4004);const{isArray:y}=Array;function a(de){return(0,w.U)(Qe=>function j(de,Qe){return y(Qe)?de(...Qe):de(Qe)}(de,Qe))}},5032:(Yn,kt,L)=>{"use strict";function w(){}L.d(kt,{Z:()=>w})},9635:(Yn,kt,L)=>{"use strict";L.d(kt,{U:()=>j,z:()=>y});var w=L(4671);function y(...a){return j(a)}function j(a){return 0===a.length?w.y:1===a.length?a[0]:function(Qe){return a.reduce((it,Ce)=>Ce(it),Qe)}}},7849:(Yn,kt,L)=>{"use strict";L.d(kt,{h:()=>j});var w=L(2416),y=L(3410);function j(a){y.z.setTimeout(()=>{const{onUnhandledError:de}=w.v;if(!de)throw a;de(a)})}},4532:(Yn,kt,L)=>{"use strict";function w(y){return new TypeError(`You provided ${null!==y&&"object"==typeof y?"an invalid object":`'${y}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}L.d(kt,{z:()=>w})},7340:(Yn,kt,L)=>{"use strict";L.d(kt,{IO:()=>Re,LC:()=>y,SB:()=>Fe,X$:()=>a,ZE:()=>Gt,ZN:()=>ht,_j:()=>w,eR:()=>at,jt:()=>de,k1:()=>an,l3:()=>j,oB:()=>Ce,pV:()=>Ve,ru:()=>Qe,vP:()=>it});class w{}class y{}const j="*";function a(ot,Te){return{type:7,name:ot,definitions:Te,options:{}}}function de(ot,Te=null){return{type:4,styles:Te,timings:ot}}function Qe(ot,Te=null){return{type:3,steps:ot,options:Te}}function it(ot,Te=null){return{type:2,steps:ot,options:Te}}function Ce(ot){return{type:6,styles:ot,offset:null}}function Fe(ot,Te,Ne){return{type:0,name:ot,styles:Te,options:Ne}}function at(ot,Te,Ne=null){return{type:1,expr:ot,animation:Te,options:Ne}}function Ve(ot=null){return{type:9,options:ot}}function Re(ot,Te,Ne=null){return{type:11,selector:ot,animation:Te,options:Ne}}function et(ot){Promise.resolve().then(ot)}class ht{constructor(Te=0,Ne=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Te+Ne}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Te=>Te()),this._onDoneFns=[])}onStart(Te){this._originalOnStartFns.push(Te),this._onStartFns.push(Te)}onDone(Te){this._originalOnDoneFns.push(Te),this._onDoneFns.push(Te)}onDestroy(Te){this._onDestroyFns.push(Te)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){et(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Te=>Te()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Te=>Te()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Te){this._position=this.totalTime?Te*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Te){const Ne="start"==Te?this._onStartFns:this._onDoneFns;Ne.forEach(mt=>mt()),Ne.length=0}}class Gt{constructor(Te){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Te;let Ne=0,mt=0,It=0;const sn=this.players.length;0==sn?et(()=>this._onFinish()):this.players.forEach(Cn=>{Cn.onDone(()=>{++Ne==sn&&this._onFinish()}),Cn.onDestroy(()=>{++mt==sn&&this._onDestroy()}),Cn.onStart(()=>{++It==sn&&this._onStart()})}),this.totalTime=this.players.reduce((Cn,Yt)=>Math.max(Cn,Yt.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Te=>Te()),this._onDoneFns=[])}init(){this.players.forEach(Te=>Te.init())}onStart(Te){this._onStartFns.push(Te)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Te=>Te()),this._onStartFns=[])}onDone(Te){this._onDoneFns.push(Te)}onDestroy(Te){this._onDestroyFns.push(Te)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Te=>Te.play())}pause(){this.players.forEach(Te=>Te.pause())}restart(){this.players.forEach(Te=>Te.restart())}finish(){this._onFinish(),this.players.forEach(Te=>Te.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Te=>Te.destroy()),this._onDestroyFns.forEach(Te=>Te()),this._onDestroyFns=[])}reset(){this.players.forEach(Te=>Te.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Te){const Ne=Te*this.totalTime;this.players.forEach(mt=>{const It=mt.totalTime?Math.min(1,Ne/mt.totalTime):1;mt.setPosition(It)})}getPosition(){const Te=this.players.reduce((Ne,mt)=>null===Ne||mt.totalTime>Ne.totalTime?mt:Ne,null);return null!=Te?Te.getPosition():0}beforeDestroy(){this.players.forEach(Te=>{Te.beforeDestroy&&Te.beforeDestroy()})}triggerCallback(Te){const Ne="start"==Te?this._onStartFns:this._onDoneFns;Ne.forEach(mt=>mt()),Ne.length=0}}const an="!"},2687:(Yn,kt,L)=>{"use strict";L.d(kt,{Em:()=>Nn,Kd:()=>Dn,X6:()=>ke,ic:()=>Ci,qV:()=>Se,qm:()=>_t,rt:()=>bn,s1:()=>Pn,tE:()=>Qi,yG:()=>xt});var w=L(6895),y=L(4650),j=L(3353),a=L(7579),de=L(727),Qe=L(1135),it=L(9646),Ce=L(9521),Fe=L(8505),$e=L(8372),at=L(9300),qe=L(4004),Ve=L(5698),tt=L(5684),Re=L(1884),ft=L(2722),et=L(1281),ht=L(9643),Gt=L(2289);class ct{constructor(De){this._items=De,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new a.x,this._typeaheadSubscription=de.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=oe=>oe.disabled,this._pressedLetters=[],this.tabOut=new a.x,this.change=new a.x,De instanceof y.n_E&&De.changes.subscribe(oe=>{if(this._activeItem){const wt=oe.toArray().indexOf(this._activeItem);wt>-1&&wt!==this._activeItemIndex&&(this._activeItemIndex=wt)}})}skipPredicate(De){return this._skipPredicateFn=De,this}withWrap(De=!0){return this._wrap=De,this}withVerticalOrientation(De=!0){return this._vertical=De,this}withHorizontalOrientation(De){return this._horizontal=De,this}withAllowedModifierKeys(De){return this._allowedModifierKeys=De,this}withTypeAhead(De=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,Fe.b)(oe=>this._pressedLetters.push(oe)),(0,$e.b)(De),(0,at.h)(()=>this._pressedLetters.length>0),(0,qe.U)(()=>this._pressedLetters.join(""))).subscribe(oe=>{const be=this._getItemsArray();for(let wt=1;wt<be.length+1;wt++){const $t=(this._activeItemIndex+wt)%be.length,pe=be[$t];if(!this._skipPredicateFn(pe)&&0===pe.getLabel().toUpperCase().trim().indexOf(oe)){this.setActiveItem($t);break}}this._pressedLetters=[]}),this}withHomeAndEnd(De=!0){return this._homeAndEnd=De,this}setActiveItem(De){const oe=this._activeItem;this.updateActiveItem(De),this._activeItem!==oe&&this.change.next(this._activeItemIndex)}onKeydown(De){const oe=De.keyCode,wt=["altKey","ctrlKey","metaKey","shiftKey"].every($t=>!De[$t]||this._allowedModifierKeys.indexOf($t)>-1);switch(oe){case Ce.Mf:return void this.tabOut.next();case Ce.JH:if(this._vertical&&wt){this.setNextItemActive();break}return;case Ce.LH:if(this._vertical&&wt){this.setPreviousItemActive();break}return;case Ce.SV:if(this._horizontal&&wt){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case Ce.oh:if(this._horizontal&&wt){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case Ce.Sd:if(this._homeAndEnd&&wt){this.setFirstItemActive();break}return;case Ce.uR:if(this._homeAndEnd&&wt){this.setLastItemActive();break}return;default:return void((wt||(0,Ce.Vb)(De,"shiftKey"))&&(De.key&&1===De.key.length?this._letterKeyStream.next(De.key.toLocaleUpperCase()):(oe>=Ce.A&&oe<=Ce.Z||oe>=Ce.xE&&oe<=Ce.aO)&&this._letterKeyStream.next(String.fromCharCode(oe))))}this._pressedLetters=[],De.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(De){const oe=this._getItemsArray(),be="number"==typeof De?De:oe.indexOf(De);this._activeItem=oe[be]??null,this._activeItemIndex=be}_setActiveItemByDelta(De){this._wrap?this._setActiveInWrapMode(De):this._setActiveInDefaultMode(De)}_setActiveInWrapMode(De){const oe=this._getItemsArray();for(let be=1;be<=oe.length;be++){const wt=(this._activeItemIndex+De*be+oe.length)%oe.length;if(!this._skipPredicateFn(oe[wt]))return void this.setActiveItem(wt)}}_setActiveInDefaultMode(De){this._setActiveItemByIndex(this._activeItemIndex+De,De)}_setActiveItemByIndex(De,oe){const be=this._getItemsArray();if(be[De]){for(;this._skipPredicateFn(be[De]);)if(!be[De+=oe])return;this.setActiveItem(De)}}_getItemsArray(){return this._items instanceof y.n_E?this._items.toArray():this._items}}class Pn extends ct{setActiveItem(De){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(De),this.activeItem&&this.activeItem.setActiveStyles()}}class Nn extends ct{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(De){return this._origin=De,this}setActiveItem(De){super.setActiveItem(De),this.activeItem&&this.activeItem.focus(this._origin)}}let Ci=(()=>{class Ut{constructor(oe){this._platform=oe}isDisabled(oe){return oe.hasAttribute("disabled")}isVisible(oe){return function Zt(Ut){return!!(Ut.offsetWidth||Ut.offsetHeight||"function"==typeof Ut.getClientRects&&Ut.getClientRects().length)}(oe)&&"visible"===getComputedStyle(oe).visibility}isTabbable(oe){if(!this._platform.isBrowser)return!1;const be=function Bt(Ut){try{return Ut.frameElement}catch{return null}}(function me(Ut){return Ut.ownerDocument&&Ut.ownerDocument.defaultView||window}(oe));if(be&&(-1===Lt(be)||!this.isVisible(be)))return!1;let wt=oe.nodeName.toLowerCase(),$t=Lt(oe);return oe.hasAttribute("contenteditable")?-1!==$t:!("iframe"===wt||"object"===wt||this._platform.WEBKIT&&this._platform.IOS&&!function Tt(Ut){let De=Ut.nodeName.toLowerCase(),oe="input"===De&&Ut.type;return"text"===oe||"password"===oe||"select"===De||"textarea"===De}(oe))&&("audio"===wt?!!oe.hasAttribute("controls")&&-1!==$t:"video"===wt?-1!==$t&&(null!==$t||this._platform.FIREFOX||oe.hasAttribute("controls")):oe.tabIndex>=0)}isFocusable(oe,be){return function fn(Ut){return!function Ct(Ut){return function ze(Ut){return"input"==Ut.nodeName.toLowerCase()}(Ut)&&"hidden"==Ut.type}(Ut)&&(function nn(Ut){let De=Ut.nodeName.toLowerCase();return"input"===De||"select"===De||"button"===De||"textarea"===De}(Ut)||function Jt(Ut){return function zt(Ut){return"a"==Ut.nodeName.toLowerCase()}(Ut)&&Ut.hasAttribute("href")}(Ut)||Ut.hasAttribute("contenteditable")||ve(Ut))}(oe)&&!this.isDisabled(oe)&&(be?.ignoreVisibility||this.isVisible(oe))}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(j.t4))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})();function ve(Ut){if(!Ut.hasAttribute("tabindex")||void 0===Ut.tabIndex)return!1;let De=Ut.getAttribute("tabindex");return!(!De||isNaN(parseInt(De,10)))}function Lt(Ut){if(!ve(Ut))return null;const De=parseInt(Ut.getAttribute("tabindex")||"",10);return isNaN(De)?-1:De}class Rt{constructor(De,oe,be,wt,$t=!1){this._element=De,this._checker=oe,this._ngZone=be,this._document=wt,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,$t||this.attachAnchors()}get enabled(){return this._enabled}set enabled(De){this._enabled=De,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(De,this._startAnchor),this._toggleAnchorTabIndex(De,this._endAnchor))}destroy(){const De=this._startAnchor,oe=this._endAnchor;De&&(De.removeEventListener("focus",this.startAnchorListener),De.remove()),oe&&(oe.removeEventListener("focus",this.endAnchorListener),oe.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(De){return new Promise(oe=>{this._executeOnStable(()=>oe(this.focusInitialElement(De)))})}focusFirstTabbableElementWhenReady(De){return new Promise(oe=>{this._executeOnStable(()=>oe(this.focusFirstTabbableElement(De)))})}focusLastTabbableElementWhenReady(De){return new Promise(oe=>{this._executeOnStable(()=>oe(this.focusLastTabbableElement(De)))})}_getRegionBoundary(De){const oe=this._element.querySelectorAll(`[cdk-focus-region-${De}], [cdkFocusRegion${De}], [cdk-focus-${De}]`);return"start"==De?oe.length?oe[0]:this._getFirstTabbableElement(this._element):oe.length?oe[oe.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(De){const oe=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(oe){if(!this._checker.isFocusable(oe)){const be=this._getFirstTabbableElement(oe);return be?.focus(De),!!be}return oe.focus(De),!0}return this.focusFirstTabbableElement(De)}focusFirstTabbableElement(De){const oe=this._getRegionBoundary("start");return oe&&oe.focus(De),!!oe}focusLastTabbableElement(De){const oe=this._getRegionBoundary("end");return oe&&oe.focus(De),!!oe}hasAttached(){return this._hasAttached}_getFirstTabbableElement(De){if(this._checker.isFocusable(De)&&this._checker.isTabbable(De))return De;const oe=De.children;for(let be=0;be<oe.length;be++){const wt=oe[be].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(oe[be]):null;if(wt)return wt}return null}_getLastTabbableElement(De){if(this._checker.isFocusable(De)&&this._checker.isTabbable(De))return De;const oe=De.children;for(let be=oe.length-1;be>=0;be--){const wt=oe[be].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(oe[be]):null;if(wt)return wt}return null}_createAnchor(){const De=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,De),De.classList.add("cdk-visually-hidden"),De.classList.add("cdk-focus-trap-anchor"),De.setAttribute("aria-hidden","true"),De}_toggleAnchorTabIndex(De,oe){De?oe.setAttribute("tabindex","0"):oe.removeAttribute("tabindex")}toggleAnchors(De){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(De,this._startAnchor),this._toggleAnchorTabIndex(De,this._endAnchor))}_executeOnStable(De){this._ngZone.isStable?De():this._ngZone.onStable.pipe((0,Ve.q)(1)).subscribe(De)}}let Se=(()=>{class Ut{constructor(oe,be,wt){this._checker=oe,this._ngZone=be,this._document=wt}create(oe,be=!1){return new Rt(oe,this._checker,this._ngZone,this._document,be)}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(Ci),y.LFG(y.R0b),y.LFG(w.K0))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})();function ke(Ut){return 0===Ut.buttons||0===Ut.offsetX&&0===Ut.offsetY}function xt(Ut){const De=Ut.touches&&Ut.touches[0]||Ut.changedTouches&&Ut.changedTouches[0];return!(!De||-1!==De.identifier||null!=De.radiusX&&1!==De.radiusX||null!=De.radiusY&&1!==De.radiusY)}const lt=new y.OlP("cdk-input-modality-detector-options"),Vt={ignoreKeys:[Ce.zL,Ce.jx,Ce.b2,Ce.MW,Ce.JU]},Fn=(0,j.i$)({passive:!0,capture:!0});let Mn=(()=>{class Ut{constructor(oe,be,wt,$t){this._platform=oe,this._mostRecentTarget=null,this._modality=new Qe.X(null),this._lastTouchMs=0,this._onKeydown=pe=>{this._options?.ignoreKeys?.some(Q=>Q===pe.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,j.sA)(pe))},this._onMousedown=pe=>{Date.now()-this._lastTouchMs<650||(this._modality.next(ke(pe)?"keyboard":"mouse"),this._mostRecentTarget=(0,j.sA)(pe))},this._onTouchstart=pe=>{xt(pe)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,j.sA)(pe))},this._options={...Vt,...$t},this.modalityDetected=this._modality.pipe((0,tt.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,Re.x)()),oe.isBrowser&&be.runOutsideAngular(()=>{wt.addEventListener("keydown",this._onKeydown,Fn),wt.addEventListener("mousedown",this._onMousedown,Fn),wt.addEventListener("touchstart",this._onTouchstart,Fn)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Fn),document.removeEventListener("mousedown",this._onMousedown,Fn),document.removeEventListener("touchstart",this._onTouchstart,Fn))}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(j.t4),y.LFG(y.R0b),y.LFG(w.K0),y.LFG(lt,8))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})();const At=new y.OlP("liveAnnouncerElement",{providedIn:"root",factory:function Ae(){return null}}),Qt=new y.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Dn=(()=>{class Ut{constructor(oe,be,wt,$t){this._ngZone=be,this._defaultOptions=$t,this._document=wt,this._liveElement=oe||this._createLiveElement()}announce(oe,...be){const wt=this._defaultOptions;let $t,pe;return 1===be.length&&"number"==typeof be[0]?pe=be[0]:[$t,pe]=be,this.clear(),clearTimeout(this._previousTimeout),$t||($t=wt&&wt.politeness?wt.politeness:"polite"),null==pe&&wt&&(pe=wt.duration),this._liveElement.setAttribute("aria-live",$t),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(Q=>this._currentResolve=Q)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=oe,"number"==typeof pe&&(this._previousTimeout=setTimeout(()=>this.clear(),pe)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const oe="cdk-live-announcer-element",be=this._document.getElementsByClassName(oe),wt=this._document.createElement("div");for(let $t=0;$t<be.length;$t++)be[$t].remove();return wt.classList.add(oe),wt.classList.add("cdk-visually-hidden"),wt.setAttribute("aria-atomic","true"),wt.setAttribute("aria-live","polite"),this._document.body.appendChild(wt),wt}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(At,8),y.LFG(y.R0b),y.LFG(w.K0),y.LFG(Qt,8))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})();const mi=new y.OlP("cdk-focus-monitor-default-options"),Li=(0,j.i$)({passive:!0,capture:!0});let Qi=(()=>{class Ut{constructor(oe,be,wt,$t,pe){this._ngZone=oe,this._platform=be,this._inputModalityDetector=wt,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new a.x,this._rootNodeFocusAndBlurListener=Q=>{for(let ye=(0,j.sA)(Q);ye;ye=ye.parentElement)"focus"===Q.type?this._onFocus(Q,ye):this._onBlur(Q,ye)},this._document=$t,this._detectionMode=pe?.detectionMode||0}monitor(oe,be=!1){const wt=(0,et.fI)(oe);if(!this._platform.isBrowser||1!==wt.nodeType)return(0,it.of)(null);const $t=(0,j.kV)(wt)||this._getDocument(),pe=this._elementInfo.get(wt);if(pe)return be&&(pe.checkChildren=!0),pe.subject;const Q={checkChildren:be,subject:new a.x,rootNode:$t};return this._elementInfo.set(wt,Q),this._registerGlobalListeners(Q),Q.subject}stopMonitoring(oe){const be=(0,et.fI)(oe),wt=this._elementInfo.get(be);wt&&(wt.subject.complete(),this._setClasses(be),this._elementInfo.delete(be),this._removeGlobalListeners(wt))}focusVia(oe,be,wt){const $t=(0,et.fI)(oe);$t===this._getDocument().activeElement?this._getClosestElementsInfo($t).forEach(([Q,ae])=>this._originChanged(Q,be,ae)):(this._setOrigin(be),"function"==typeof $t.focus&&$t.focus(wt))}ngOnDestroy(){this._elementInfo.forEach((oe,be)=>this.stopMonitoring(be))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(oe){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(oe)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:oe&&this._isLastInteractionFromInputLabel(oe)?"mouse":"program"}_shouldBeAttributedToTouch(oe){return 1===this._detectionMode||!!oe?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(oe,be){oe.classList.toggle("cdk-focused",!!be),oe.classList.toggle("cdk-touch-focused","touch"===be),oe.classList.toggle("cdk-keyboard-focused","keyboard"===be),oe.classList.toggle("cdk-mouse-focused","mouse"===be),oe.classList.toggle("cdk-program-focused","program"===be)}_setOrigin(oe,be=!1){this._ngZone.runOutsideAngular(()=>{this._origin=oe,this._originFromTouchInteraction="touch"===oe&&be,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(oe,be){const wt=this._elementInfo.get(be),$t=(0,j.sA)(oe);!wt||!wt.checkChildren&&be!==$t||this._originChanged(be,this._getFocusOrigin($t),wt)}_onBlur(oe,be){const wt=this._elementInfo.get(be);!wt||wt.checkChildren&&oe.relatedTarget instanceof Node&&be.contains(oe.relatedTarget)||(this._setClasses(be),this._emitOrigin(wt,null))}_emitOrigin(oe,be){oe.subject.observers.length&&this._ngZone.run(()=>oe.subject.next(be))}_registerGlobalListeners(oe){if(!this._platform.isBrowser)return;const be=oe.rootNode,wt=this._rootNodeFocusListenerCount.get(be)||0;wt||this._ngZone.runOutsideAngular(()=>{be.addEventListener("focus",this._rootNodeFocusAndBlurListener,Li),be.addEventListener("blur",this._rootNodeFocusAndBlurListener,Li)}),this._rootNodeFocusListenerCount.set(be,wt+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,ft.R)(this._stopInputModalityDetector)).subscribe($t=>{this._setOrigin($t,!0)}))}_removeGlobalListeners(oe){const be=oe.rootNode;if(this._rootNodeFocusListenerCount.has(be)){const wt=this._rootNodeFocusListenerCount.get(be);wt>1?this._rootNodeFocusListenerCount.set(be,wt-1):(be.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Li),be.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Li),this._rootNodeFocusListenerCount.delete(be))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(oe,be,wt){this._setClasses(oe,be),this._emitOrigin(wt,be),this._lastFocusOrigin=be}_getClosestElementsInfo(oe){const be=[];return this._elementInfo.forEach((wt,$t)=>{($t===oe||wt.checkChildren&&$t.contains(oe))&&be.push([$t,wt])}),be}_isLastInteractionFromInputLabel(oe){const{_mostRecentTarget:be,mostRecentModality:wt}=this._inputModalityDetector;if("mouse"!==wt||!be||be===oe||"INPUT"!==oe.nodeName&&"TEXTAREA"!==oe.nodeName||oe.disabled)return!1;const $t=oe.labels;if($t)for(let pe=0;pe<$t.length;pe++)if($t[pe].contains(be))return!0;return!1}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(y.R0b),y.LFG(j.t4),y.LFG(Mn),y.LFG(w.K0,8),y.LFG(mi,8))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})();const Ir="cdk-high-contrast-black-on-white",Kt="cdk-high-contrast-white-on-black",Ft="cdk-high-contrast-active";let _t=(()=>{class Ut{constructor(oe,be){this._platform=oe,this._document=be,this._breakpointSubscription=(0,y.f3M)(Gt.Yg).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const oe=this._document.createElement("div");oe.style.backgroundColor="rgb(1,2,3)",oe.style.position="absolute",this._document.body.appendChild(oe);const be=this._document.defaultView||window,wt=be&&be.getComputedStyle?be.getComputedStyle(oe):null,$t=(wt&&wt.backgroundColor||"").replace(/ /g,"");switch(oe.remove(),$t){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const oe=this._document.body.classList;oe.remove(Ft,Ir,Kt),this._hasCheckedHighContrastMode=!0;const be=this.getHighContrastMode();1===be?oe.add(Ft,Ir):2===be&&oe.add(Ft,Kt)}}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(j.t4),y.LFG(w.K0))},Ut.\u0275prov=y.Yz7({token:Ut,factory:Ut.\u0275fac,providedIn:"root"}),Ut})(),bn=(()=>{class Ut{constructor(oe){oe._applyBodyHighContrastModeCssClasses()}}return Ut.\u0275fac=function(oe){return new(oe||Ut)(y.LFG(_t))},Ut.\u0275mod=y.oAB({type:Ut}),Ut.\u0275inj=y.cJS({imports:[ht.Q8]}),Ut})()},445:(Yn,kt,L)=>{"use strict";L.d(kt,{Is:()=>it,vT:()=>Fe});var w=L(4650),y=L(6895);const j=new w.OlP("cdk-dir-doc",{providedIn:"root",factory:function a(){return(0,w.f3M)(y.K0)}}),de=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let it=(()=>{class $e{constructor(qe){this.value="ltr",this.change=new w.vpe,qe&&(this.value=function Qe($e){const at=$e?.toLowerCase()||"";return"auto"===at&&typeof navigator<"u"&&navigator?.language?de.test(navigator.language)?"rtl":"ltr":"rtl"===at?"rtl":"ltr"}((qe.body?qe.body.dir:null)||(qe.documentElement?qe.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return $e.\u0275fac=function(qe){return new(qe||$e)(w.LFG(j,8))},$e.\u0275prov=w.Yz7({token:$e,factory:$e.\u0275fac,providedIn:"root"}),$e})(),Fe=(()=>{class $e{}return $e.\u0275fac=function(qe){return new(qe||$e)},$e.\u0275mod=w.oAB({type:$e}),$e.\u0275inj=w.cJS({}),$e})()},1281:(Yn,kt,L)=>{"use strict";L.d(kt,{Eq:()=>de,HM:()=>Qe,Ig:()=>y,du:()=>Ce,fI:()=>it,su:()=>j});var w=L(4650);function y(Fe){return null!=Fe&&"false"!=`${Fe}`}function j(Fe,$e=0){return function a(Fe){return!isNaN(parseFloat(Fe))&&!isNaN(Number(Fe))}(Fe)?Number(Fe):$e}function de(Fe){return Array.isArray(Fe)?Fe:[Fe]}function Qe(Fe){return null==Fe?"":"string"==typeof Fe?Fe:`${Fe}px`}function it(Fe){return Fe instanceof w.SBq?Fe.nativeElement:Fe}function Ce(Fe,$e=/\s+/){const at=[];if(null!=Fe){const qe=Array.isArray(Fe)?Fe:`${Fe}`.split($e);for(const Ve of qe){const tt=`${Ve}`.trim();tt&&at.push(tt)}}return at}},5017:(Yn,kt,L)=>{"use strict";L.d(kt,{A8:()=>$e,Ov:()=>Ce});var w=L(7579),y=L(4650);class Ce{constructor(Ve=!1,tt,Re=!0,ft){this._multiple=Ve,this._emitChanges=Re,this.compareWith=ft,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new w.x,tt&&tt.length&&(Ve?tt.forEach(et=>this._markSelected(et)):this._markSelected(tt[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...Ve){this._verifyValueAssignment(Ve),Ve.forEach(Re=>this._markSelected(Re));const tt=this._hasQueuedChanges();return this._emitChangeEvent(),tt}deselect(...Ve){this._verifyValueAssignment(Ve),Ve.forEach(Re=>this._unmarkSelected(Re));const tt=this._hasQueuedChanges();return this._emitChangeEvent(),tt}setSelection(...Ve){this._verifyValueAssignment(Ve);const tt=this.selected,Re=new Set(Ve);Ve.forEach(et=>this._markSelected(et)),tt.filter(et=>!Re.has(et)).forEach(et=>this._unmarkSelected(et));const ft=this._hasQueuedChanges();return this._emitChangeEvent(),ft}toggle(Ve){return this.isSelected(Ve)?this.deselect(Ve):this.select(Ve)}clear(Ve=!0){this._unmarkAll();const tt=this._hasQueuedChanges();return Ve&&this._emitChangeEvent(),tt}isSelected(Ve){if(this.compareWith){for(const tt of this._selection)if(this.compareWith(tt,Ve))return!0;return!1}return this._selection.has(Ve)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(Ve){this._multiple&&this.selected&&this._selected.sort(Ve)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(Ve){this.isSelected(Ve)||(this._multiple||this._unmarkAll(),this.isSelected(Ve)||this._selection.add(Ve),this._emitChanges&&this._selectedToEmit.push(Ve))}_unmarkSelected(Ve){this.isSelected(Ve)&&(this._selection.delete(Ve),this._emitChanges&&this._deselectedToEmit.push(Ve))}_unmarkAll(){this.isEmpty()||this._selection.forEach(Ve=>this._unmarkSelected(Ve))}_verifyValueAssignment(Ve){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}}let $e=(()=>{class qe{constructor(){this._listeners=[]}notify(tt,Re){for(let ft of this._listeners)ft(tt,Re)}listen(tt){return this._listeners.push(tt),()=>{this._listeners=this._listeners.filter(Re=>tt!==Re)}}ngOnDestroy(){this._listeners=[]}}return qe.\u0275fac=function(tt){return new(tt||qe)},qe.\u0275prov=y.Yz7({token:qe,factory:qe.\u0275fac,providedIn:"root"}),qe})()},9521:(Yn,kt,L)=>{"use strict";L.d(kt,{A:()=>Ct,JH:()=>an,JU:()=>Qe,K5:()=>de,LH:()=>ht,L_:()=>qe,MW:()=>Qt,Mf:()=>j,SV:()=>Gt,Sd:()=>ft,Vb:()=>Fr,Z:()=>Ae,aO:()=>fi,b2:()=>bi,hY:()=>at,jx:()=>it,oh:()=>et,uR:()=>Re,xE:()=>It,zL:()=>Ce});const j=9,de=13,Qe=16,it=17,Ce=18,at=27,qe=32,Re=35,ft=36,et=37,ht=38,Gt=39,an=40,It=48,fi=57,Ct=65,Ae=90,Qt=91,bi=224;function Fr(Ji,...Pi){return Pi.length?Pi.some(wo=>Ji[wo]):Ji.altKey||Ji.shiftKey||Ji.ctrlKey||Ji.metaKey}},2289:(Yn,kt,L)=>{"use strict";L.d(kt,{Yg:()=>an,u3:()=>Te});var w=L(4650),y=L(1281),j=L(7579),a=L(9841),de=L(7272),Qe=L(9751),it=L(5698),Ce=L(5684),Fe=L(8372),$e=L(4004),at=L(8675),qe=L(2722),Ve=L(3353);const Re=new Set;let ft,et=(()=>{class Ne{constructor(It){this._platform=It,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Gt}matchMedia(It){return(this._platform.WEBKIT||this._platform.BLINK)&&function ht(Ne){if(!Re.has(Ne))try{ft||(ft=document.createElement("style"),ft.setAttribute("type","text/css"),document.head.appendChild(ft)),ft.sheet&&(ft.sheet.insertRule(`@media ${Ne} {body{ }}`,0),Re.add(Ne))}catch(mt){console.error(mt)}}(It),this._matchMedia(It)}}return Ne.\u0275fac=function(It){return new(It||Ne)(w.LFG(Ve.t4))},Ne.\u0275prov=w.Yz7({token:Ne,factory:Ne.\u0275fac,providedIn:"root"}),Ne})();function Gt(Ne){return{matches:"all"===Ne||""===Ne,media:Ne,addListener:()=>{},removeListener:()=>{}}}let an=(()=>{class Ne{constructor(It,sn){this._mediaMatcher=It,this._zone=sn,this._queries=new Map,this._destroySubject=new j.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(It){return ot((0,y.Eq)(It)).some(Cn=>this._registerQuery(Cn).mql.matches)}observe(It){const Cn=ot((0,y.Eq)(It)).map(nt=>this._registerQuery(nt).observable);let Yt=(0,a.a)(Cn);return Yt=(0,de.z)(Yt.pipe((0,it.q)(1)),Yt.pipe((0,Ce.T)(1),(0,Fe.b)(0))),Yt.pipe((0,$e.U)(nt=>{const Et={matches:!1,breakpoints:{}};return nt.forEach(({matches:ct,query:Pn})=>{Et.matches=Et.matches||ct,Et.breakpoints[Pn]=ct}),Et}))}_registerQuery(It){if(this._queries.has(It))return this._queries.get(It);const sn=this._mediaMatcher.matchMedia(It),Yt={observable:new Qe.y(nt=>{const Et=ct=>this._zone.run(()=>nt.next(ct));return sn.addListener(Et),()=>{sn.removeListener(Et)}}).pipe((0,at.O)(sn),(0,$e.U)(({matches:nt})=>({query:It,matches:nt})),(0,qe.R)(this._destroySubject)),mql:sn};return this._queries.set(It,Yt),Yt}}return Ne.\u0275fac=function(It){return new(It||Ne)(w.LFG(et),w.LFG(w.R0b))},Ne.\u0275prov=w.Yz7({token:Ne,factory:Ne.\u0275fac,providedIn:"root"}),Ne})();function ot(Ne){return Ne.map(mt=>mt.split(",")).reduce((mt,It)=>mt.concat(It)).map(mt=>mt.trim())}const Te={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"}},9643:(Yn,kt,L)=>{"use strict";L.d(kt,{Q8:()=>Fe,wD:()=>Ce});var w=L(1281),y=L(4650),j=L(9751),a=L(7579),de=L(8372);let Qe=(()=>{class $e{create(qe){return typeof MutationObserver>"u"?null:new MutationObserver(qe)}}return $e.\u0275fac=function(qe){return new(qe||$e)},$e.\u0275prov=y.Yz7({token:$e,factory:$e.\u0275fac,providedIn:"root"}),$e})(),it=(()=>{class $e{constructor(qe){this._mutationObserverFactory=qe,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((qe,Ve)=>this._cleanupObserver(Ve))}observe(qe){const Ve=(0,w.fI)(qe);return new j.y(tt=>{const ft=this._observeElement(Ve).subscribe(tt);return()=>{ft.unsubscribe(),this._unobserveElement(Ve)}})}_observeElement(qe){if(this._observedElements.has(qe))this._observedElements.get(qe).count++;else{const Ve=new a.x,tt=this._mutationObserverFactory.create(Re=>Ve.next(Re));tt&&tt.observe(qe,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(qe,{observer:tt,stream:Ve,count:1})}return this._observedElements.get(qe).stream}_unobserveElement(qe){this._observedElements.has(qe)&&(this._observedElements.get(qe).count--,this._observedElements.get(qe).count||this._cleanupObserver(qe))}_cleanupObserver(qe){if(this._observedElements.has(qe)){const{observer:Ve,stream:tt}=this._observedElements.get(qe);Ve&&Ve.disconnect(),tt.complete(),this._observedElements.delete(qe)}}}return $e.\u0275fac=function(qe){return new(qe||$e)(y.LFG(Qe))},$e.\u0275prov=y.Yz7({token:$e,factory:$e.\u0275fac,providedIn:"root"}),$e})(),Ce=(()=>{class $e{constructor(qe,Ve,tt){this._contentObserver=qe,this._elementRef=Ve,this._ngZone=tt,this.event=new y.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(qe){this._disabled=(0,w.Ig)(qe),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(qe){this._debounce=(0,w.su)(qe),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const qe=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?qe.pipe((0,de.b)(this.debounce)):qe).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return $e.\u0275fac=function(qe){return new(qe||$e)(y.Y36(it),y.Y36(y.SBq),y.Y36(y.R0b))},$e.\u0275dir=y.lG2({type:$e,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),$e})(),Fe=(()=>{class $e{}return $e.\u0275fac=function(qe){return new(qe||$e)},$e.\u0275mod=y.oAB({type:$e}),$e.\u0275inj=y.cJS({providers:[Qe]}),$e})()},8184:(Yn,kt,L)=>{"use strict";L.d(kt,{Iu:()=>Pn,U8:()=>li,X_:()=>Te,Xj:()=>ct,aV:()=>Tt});var w=L(8605),y=L(6895),j=L(4650),a=L(1281),de=L(3353),Qe=L(445),it=L(4080),Ce=L(7579),Fe=L(727),$e=L(6451),at=L(5698),qe=L(2722);const Ve=(0,de.Mq)();class tt{constructor(ue,ke){this._viewportRuler=ue,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=ke}attach(){}enable(){if(this._canBeEnabled()){const ue=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=ue.style.left||"",this._previousHTMLStyles.top=ue.style.top||"",ue.style.left=(0,a.HM)(-this._previousScrollPosition.left),ue.style.top=(0,a.HM)(-this._previousScrollPosition.top),ue.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const ue=this._document.documentElement,xt=ue.style,lt=this._document.body.style,Vt=xt.scrollBehavior||"",An=lt.scrollBehavior||"";this._isEnabled=!1,xt.left=this._previousHTMLStyles.left,xt.top=this._previousHTMLStyles.top,ue.classList.remove("cdk-global-scrollblock"),Ve&&(xt.scrollBehavior=lt.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Ve&&(xt.scrollBehavior=Vt,lt.scrollBehavior=An)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const ke=this._document.body,xt=this._viewportRuler.getViewportSize();return ke.scrollHeight>xt.height||ke.scrollWidth>xt.width}}class ft{constructor(ue,ke,xt,lt){this._scrollDispatcher=ue,this._ngZone=ke,this._viewportRuler=xt,this._config=lt,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(ue){this._overlayRef=ue}enable(){if(this._scrollSubscription)return;const ue=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=ue.subscribe(()=>{const ke=this._viewportRuler.getViewportScrollPosition().top;Math.abs(ke-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=ue.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class et{enable(){}disable(){}attach(){}}function ht(dn,ue){return ue.some(ke=>dn.bottom<ke.top||dn.top>ke.bottom||dn.right<ke.left||dn.left>ke.right)}function Gt(dn,ue){return ue.some(ke=>dn.top<ke.top||dn.bottom>ke.bottom||dn.left<ke.left||dn.right>ke.right)}class an{constructor(ue,ke,xt,lt){this._scrollDispatcher=ue,this._viewportRuler=ke,this._ngZone=xt,this._config=lt,this._scrollSubscription=null}attach(ue){this._overlayRef=ue}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const ke=this._overlayRef.overlayElement.getBoundingClientRect(),{width:xt,height:lt}=this._viewportRuler.getViewportSize();ht(ke,[{width:xt,height:lt,bottom:lt,right:xt,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let ot=(()=>{class dn{constructor(ke,xt,lt,Vt){this._scrollDispatcher=ke,this._viewportRuler=xt,this._ngZone=lt,this.noop=()=>new et,this.close=An=>new ft(this._scrollDispatcher,this._ngZone,this._viewportRuler,An),this.block=()=>new tt(this._viewportRuler,this._document),this.reposition=An=>new an(this._scrollDispatcher,this._viewportRuler,this._ngZone,An),this._document=Vt}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(w.mF),j.LFG(w.rL),j.LFG(j.R0b),j.LFG(y.K0))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})();class Te{constructor(ue){if(this.scrollStrategy=new et,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,ue){const ke=Object.keys(ue);for(const xt of ke)void 0!==ue[xt]&&(this[xt]=ue[xt])}}}class It{constructor(ue,ke){this.connectionPair=ue,this.scrollableViewProperties=ke}}let Yt=(()=>{class dn{constructor(ke){this._attachedOverlays=[],this._document=ke}ngOnDestroy(){this.detach()}add(ke){this.remove(ke),this._attachedOverlays.push(ke)}remove(ke){const xt=this._attachedOverlays.indexOf(ke);xt>-1&&this._attachedOverlays.splice(xt,1),0===this._attachedOverlays.length&&this.detach()}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(y.K0))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})(),nt=(()=>{class dn extends Yt{constructor(ke,xt){super(ke),this._ngZone=xt,this._keydownListener=lt=>{const Vt=this._attachedOverlays;for(let An=Vt.length-1;An>-1;An--)if(Vt[An]._keydownEvents.observers.length>0){const Fn=Vt[An]._keydownEvents;this._ngZone?this._ngZone.run(()=>Fn.next(lt)):Fn.next(lt);break}}}add(ke){super.add(ke),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(y.K0),j.LFG(j.R0b,8))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})(),Et=(()=>{class dn extends Yt{constructor(ke,xt,lt){super(ke),this._platform=xt,this._ngZone=lt,this._cursorStyleIsSet=!1,this._pointerDownListener=Vt=>{this._pointerDownEventTarget=(0,de.sA)(Vt)},this._clickListener=Vt=>{const An=(0,de.sA)(Vt),Fn="click"===Vt.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:An;this._pointerDownEventTarget=null;const Mn=this._attachedOverlays.slice();for(let At=Mn.length-1;At>-1;At--){const Ae=Mn[At];if(Ae._outsidePointerEvents.observers.length<1||!Ae.hasAttached())continue;if(Ae.overlayElement.contains(An)||Ae.overlayElement.contains(Fn))break;const Qt=Ae._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>Qt.next(Vt)):Qt.next(Vt)}}}add(ke){if(super.add(ke),!this._isAttached){const xt=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(xt)):this._addEventListeners(xt),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=xt.style.cursor,xt.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const ke=this._document.body;ke.removeEventListener("pointerdown",this._pointerDownListener,!0),ke.removeEventListener("click",this._clickListener,!0),ke.removeEventListener("auxclick",this._clickListener,!0),ke.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(ke.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(ke){ke.addEventListener("pointerdown",this._pointerDownListener,!0),ke.addEventListener("click",this._clickListener,!0),ke.addEventListener("auxclick",this._clickListener,!0),ke.addEventListener("contextmenu",this._clickListener,!0)}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(y.K0),j.LFG(de.t4),j.LFG(j.R0b,8))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})(),ct=(()=>{class dn{constructor(ke,xt){this._platform=xt,this._document=ke}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const ke="cdk-overlay-container";if(this._platform.isBrowser||(0,de.Oy)()){const lt=this._document.querySelectorAll(`.${ke}[platform="server"], .${ke}[platform="test"]`);for(let Vt=0;Vt<lt.length;Vt++)lt[Vt].remove()}const xt=this._document.createElement("div");xt.classList.add(ke),(0,de.Oy)()?xt.setAttribute("platform","test"):this._platform.isBrowser||xt.setAttribute("platform","server"),this._document.body.appendChild(xt),this._containerElement=xt}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(y.K0),j.LFG(de.t4))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})();class Pn{constructor(ue,ke,xt,lt,Vt,An,Fn,Mn,At,Ae=!1){this._portalOutlet=ue,this._host=ke,this._pane=xt,this._config=lt,this._ngZone=Vt,this._keyboardDispatcher=An,this._document=Fn,this._location=Mn,this._outsideClickDispatcher=At,this._animationsDisabled=Ae,this._backdropElement=null,this._backdropClick=new Ce.x,this._attachments=new Ce.x,this._detachments=new Ce.x,this._locationChanges=Fe.w0.EMPTY,this._backdropClickHandler=Qt=>this._backdropClick.next(Qt),this._backdropTransitionendHandler=Qt=>{this._disposeBackdrop(Qt.target)},this._keydownEvents=new Ce.x,this._outsidePointerEvents=new Ce.x,lt.scrollStrategy&&(this._scrollStrategy=lt.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=lt.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(ue){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const ke=this._portalOutlet.attach(ue);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,at.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof ke?.onDestroy&&ke.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),ke}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const ue=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),ue}dispose(){const ue=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,ue&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(ue){ue!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=ue,this.hasAttached()&&(ue.attach(this),this.updatePosition()))}updateSize(ue){this._config={...this._config,...ue},this._updateElementSize()}setDirection(ue){this._config={...this._config,direction:ue},this._updateElementDirection()}addPanelClass(ue){this._pane&&this._toggleClasses(this._pane,ue,!0)}removePanelClass(ue){this._pane&&this._toggleClasses(this._pane,ue,!1)}getDirection(){const ue=this._config.direction;return ue?"string"==typeof ue?ue:ue.value:"ltr"}updateScrollStrategy(ue){ue!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=ue,this.hasAttached()&&(ue.attach(this),ue.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const ue=this._pane.style;ue.width=(0,a.HM)(this._config.width),ue.height=(0,a.HM)(this._config.height),ue.minWidth=(0,a.HM)(this._config.minWidth),ue.minHeight=(0,a.HM)(this._config.minHeight),ue.maxWidth=(0,a.HM)(this._config.maxWidth),ue.maxHeight=(0,a.HM)(this._config.maxHeight)}_togglePointerEvents(ue){this._pane.style.pointerEvents=ue?"":"none"}_attachBackdrop(){const ue="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(ue)})}):this._backdropElement.classList.add(ue)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const ue=this._backdropElement;if(ue){if(this._animationsDisabled)return void this._disposeBackdrop(ue);ue.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{ue.addEventListener("transitionend",this._backdropTransitionendHandler)}),ue.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(ue)},500))}}_toggleClasses(ue,ke,xt){const lt=(0,a.Eq)(ke||[]).filter(Vt=>!!Vt);lt.length&&(xt?ue.classList.add(...lt):ue.classList.remove(...lt))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const ue=this._ngZone.onStable.pipe((0,qe.R)((0,$e.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),ue.unsubscribe())})})}_disposeScrollStrategy(){const ue=this._scrollStrategy;ue&&(ue.disable(),ue.detach&&ue.detach())}_disposeBackdrop(ue){ue&&(ue.removeEventListener("click",this._backdropClickHandler),ue.removeEventListener("transitionend",this._backdropTransitionendHandler),ue.remove(),this._backdropElement===ue&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const Nn="cdk-overlay-connected-position-bounding-box",fi=/([A-Za-z%]+)$/;class Ci{constructor(ue,ke,xt,lt,Vt){this._viewportRuler=ke,this._document=xt,this._platform=lt,this._overlayContainer=Vt,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new Ce.x,this._resizeSubscription=Fe.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(ue)}get positions(){return this._preferredPositions}attach(ue){this._validatePositions(),ue.hostElement.classList.add(Nn),this._overlayRef=ue,this._boundingBox=ue.hostElement,this._pane=ue.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const ue=this._originRect,ke=this._overlayRect,xt=this._viewportRect,lt=this._containerRect,Vt=[];let An;for(let Fn of this._preferredPositions){let Mn=this._getOriginPoint(ue,lt,Fn),At=this._getOverlayPoint(Mn,ke,Fn),Ae=this._getOverlayFit(At,ke,xt,Fn);if(Ae.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(Fn,Mn);this._canFitWithFlexibleDimensions(Ae,At,xt)?Vt.push({position:Fn,origin:Mn,overlayRect:ke,boundingBoxRect:this._calculateBoundingBoxRect(Mn,Fn)}):(!An||An.overlayFit.visibleArea<Ae.visibleArea)&&(An={overlayFit:Ae,overlayPoint:At,originPoint:Mn,position:Fn,overlayRect:ke})}if(Vt.length){let Fn=null,Mn=-1;for(const At of Vt){const Ae=At.boundingBoxRect.width*At.boundingBoxRect.height*(At.position.weight||1);Ae>Mn&&(Mn=Ae,Fn=At)}return this._isPushed=!1,void this._applyPosition(Fn.position,Fn.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(An.position,An.originPoint);this._applyPosition(An.position,An.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Bt(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Nn),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const ue=this._lastPosition;if(ue){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const ke=this._getOriginPoint(this._originRect,this._containerRect,ue);this._applyPosition(ue,ke)}else this.apply()}withScrollableContainers(ue){return this._scrollables=ue,this}withPositions(ue){return this._preferredPositions=ue,-1===ue.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(ue){return this._viewportMargin=ue,this}withFlexibleDimensions(ue=!0){return this._hasFlexibleDimensions=ue,this}withGrowAfterOpen(ue=!0){return this._growAfterOpen=ue,this}withPush(ue=!0){return this._canPush=ue,this}withLockedPosition(ue=!0){return this._positionLocked=ue,this}setOrigin(ue){return this._origin=ue,this}withDefaultOffsetX(ue){return this._offsetX=ue,this}withDefaultOffsetY(ue){return this._offsetY=ue,this}withTransformOriginOn(ue){return this._transformOriginSelector=ue,this}_getOriginPoint(ue,ke,xt){let lt,Vt;if("center"==xt.originX)lt=ue.left+ue.width/2;else{const An=this._isRtl()?ue.right:ue.left,Fn=this._isRtl()?ue.left:ue.right;lt="start"==xt.originX?An:Fn}return ke.left<0&&(lt-=ke.left),Vt="center"==xt.originY?ue.top+ue.height/2:"top"==xt.originY?ue.top:ue.bottom,ke.top<0&&(Vt-=ke.top),{x:lt,y:Vt}}_getOverlayPoint(ue,ke,xt){let lt,Vt;return lt="center"==xt.overlayX?-ke.width/2:"start"===xt.overlayX?this._isRtl()?-ke.width:0:this._isRtl()?0:-ke.width,Vt="center"==xt.overlayY?-ke.height/2:"top"==xt.overlayY?0:-ke.height,{x:ue.x+lt,y:ue.y+Vt}}_getOverlayFit(ue,ke,xt,lt){const Vt=nn(ke);let{x:An,y:Fn}=ue,Mn=this._getOffset(lt,"x"),At=this._getOffset(lt,"y");Mn&&(An+=Mn),At&&(Fn+=At);let Dn=0-Fn,ln=Fn+Vt.height-xt.height,mi=this._subtractOverflows(Vt.width,0-An,An+Vt.width-xt.width),Li=this._subtractOverflows(Vt.height,Dn,ln),Qi=mi*Li;return{visibleArea:Qi,isCompletelyWithinViewport:Vt.width*Vt.height===Qi,fitsInViewportVertically:Li===Vt.height,fitsInViewportHorizontally:mi==Vt.width}}_canFitWithFlexibleDimensions(ue,ke,xt){if(this._hasFlexibleDimensions){const lt=xt.bottom-ke.y,Vt=xt.right-ke.x,An=Zt(this._overlayRef.getConfig().minHeight),Fn=Zt(this._overlayRef.getConfig().minWidth);return(ue.fitsInViewportVertically||null!=An&&An<=lt)&&(ue.fitsInViewportHorizontally||null!=Fn&&Fn<=Vt)}return!1}_pushOverlayOnScreen(ue,ke,xt){if(this._previousPushAmount&&this._positionLocked)return{x:ue.x+this._previousPushAmount.x,y:ue.y+this._previousPushAmount.y};const lt=nn(ke),Vt=this._viewportRect,An=Math.max(ue.x+lt.width-Vt.width,0),Fn=Math.max(ue.y+lt.height-Vt.height,0),Mn=Math.max(Vt.top-xt.top-ue.y,0),At=Math.max(Vt.left-xt.left-ue.x,0);let Ae=0,Qt=0;return Ae=lt.width<=Vt.width?At||-An:ue.x<this._viewportMargin?Vt.left-xt.left-ue.x:0,Qt=lt.height<=Vt.height?Mn||-Fn:ue.y<this._viewportMargin?Vt.top-xt.top-ue.y:0,this._previousPushAmount={x:Ae,y:Qt},{x:ue.x+Ae,y:ue.y+Qt}}_applyPosition(ue,ke){if(this._setTransformOrigin(ue),this._setOverlayElementStyles(ke,ue),this._setBoundingBoxStyles(ke,ue),ue.panelClass&&this._addPanelClasses(ue.panelClass),this._lastPosition=ue,this._positionChanges.observers.length){const xt=this._getScrollVisibility(),lt=new It(ue,xt);this._positionChanges.next(lt)}this._isInitialRender=!1}_setTransformOrigin(ue){if(!this._transformOriginSelector)return;const ke=this._boundingBox.querySelectorAll(this._transformOriginSelector);let xt,lt=ue.overlayY;xt="center"===ue.overlayX?"center":this._isRtl()?"start"===ue.overlayX?"right":"left":"start"===ue.overlayX?"left":"right";for(let Vt=0;Vt<ke.length;Vt++)ke[Vt].style.transformOrigin=`${xt} ${lt}`}_calculateBoundingBoxRect(ue,ke){const xt=this._viewportRect,lt=this._isRtl();let Vt,An,Fn,Ae,Qt,Dn;if("top"===ke.overlayY)An=ue.y,Vt=xt.height-An+this._viewportMargin;else if("bottom"===ke.overlayY)Fn=xt.height-ue.y+2*this._viewportMargin,Vt=xt.height-Fn+this._viewportMargin;else{const ln=Math.min(xt.bottom-ue.y+xt.top,ue.y),mi=this._lastBoundingBoxSize.height;Vt=2*ln,An=ue.y-ln,Vt>mi&&!this._isInitialRender&&!this._growAfterOpen&&(An=ue.y-mi/2)}if("end"===ke.overlayX&&!lt||"start"===ke.overlayX&&lt)Dn=xt.width-ue.x+this._viewportMargin,Ae=ue.x-this._viewportMargin;else if("start"===ke.overlayX&&!lt||"end"===ke.overlayX&&lt)Qt=ue.x,Ae=xt.right-ue.x;else{const ln=Math.min(xt.right-ue.x+xt.left,ue.x),mi=this._lastBoundingBoxSize.width;Ae=2*ln,Qt=ue.x-ln,Ae>mi&&!this._isInitialRender&&!this._growAfterOpen&&(Qt=ue.x-mi/2)}return{top:An,left:Qt,bottom:Fn,right:Dn,width:Ae,height:Vt}}_setBoundingBoxStyles(ue,ke){const xt=this._calculateBoundingBoxRect(ue,ke);!this._isInitialRender&&!this._growAfterOpen&&(xt.height=Math.min(xt.height,this._lastBoundingBoxSize.height),xt.width=Math.min(xt.width,this._lastBoundingBoxSize.width));const lt={};if(this._hasExactPosition())lt.top=lt.left="0",lt.bottom=lt.right=lt.maxHeight=lt.maxWidth="",lt.width=lt.height="100%";else{const Vt=this._overlayRef.getConfig().maxHeight,An=this._overlayRef.getConfig().maxWidth;lt.height=(0,a.HM)(xt.height),lt.top=(0,a.HM)(xt.top),lt.bottom=(0,a.HM)(xt.bottom),lt.width=(0,a.HM)(xt.width),lt.left=(0,a.HM)(xt.left),lt.right=(0,a.HM)(xt.right),lt.alignItems="center"===ke.overlayX?"center":"end"===ke.overlayX?"flex-end":"flex-start",lt.justifyContent="center"===ke.overlayY?"center":"bottom"===ke.overlayY?"flex-end":"flex-start",Vt&&(lt.maxHeight=(0,a.HM)(Vt)),An&&(lt.maxWidth=(0,a.HM)(An))}this._lastBoundingBoxSize=xt,Bt(this._boundingBox.style,lt)}_resetBoundingBoxStyles(){Bt(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Bt(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(ue,ke){const xt={},lt=this._hasExactPosition(),Vt=this._hasFlexibleDimensions,An=this._overlayRef.getConfig();if(lt){const Ae=this._viewportRuler.getViewportScrollPosition();Bt(xt,this._getExactOverlayY(ke,ue,Ae)),Bt(xt,this._getExactOverlayX(ke,ue,Ae))}else xt.position="static";let Fn="",Mn=this._getOffset(ke,"x"),At=this._getOffset(ke,"y");Mn&&(Fn+=`translateX(${Mn}px) `),At&&(Fn+=`translateY(${At}px)`),xt.transform=Fn.trim(),An.maxHeight&&(lt?xt.maxHeight=(0,a.HM)(An.maxHeight):Vt&&(xt.maxHeight="")),An.maxWidth&&(lt?xt.maxWidth=(0,a.HM)(An.maxWidth):Vt&&(xt.maxWidth="")),Bt(this._pane.style,xt)}_getExactOverlayY(ue,ke,xt){let lt={top:"",bottom:""},Vt=this._getOverlayPoint(ke,this._overlayRect,ue);return this._isPushed&&(Vt=this._pushOverlayOnScreen(Vt,this._overlayRect,xt)),"bottom"===ue.overlayY?lt.bottom=this._document.documentElement.clientHeight-(Vt.y+this._overlayRect.height)+"px":lt.top=(0,a.HM)(Vt.y),lt}_getExactOverlayX(ue,ke,xt){let An,lt={left:"",right:""},Vt=this._getOverlayPoint(ke,this._overlayRect,ue);return this._isPushed&&(Vt=this._pushOverlayOnScreen(Vt,this._overlayRect,xt)),An=this._isRtl()?"end"===ue.overlayX?"left":"right":"end"===ue.overlayX?"right":"left","right"===An?lt.right=this._document.documentElement.clientWidth-(Vt.x+this._overlayRect.width)+"px":lt.left=(0,a.HM)(Vt.x),lt}_getScrollVisibility(){const ue=this._getOriginRect(),ke=this._pane.getBoundingClientRect(),xt=this._scrollables.map(lt=>lt.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Gt(ue,xt),isOriginOutsideView:ht(ue,xt),isOverlayClipped:Gt(ke,xt),isOverlayOutsideView:ht(ke,xt)}}_subtractOverflows(ue,...ke){return ke.reduce((xt,lt)=>xt-Math.max(lt,0),ue)}_getNarrowedViewportRect(){const ue=this._document.documentElement.clientWidth,ke=this._document.documentElement.clientHeight,xt=this._viewportRuler.getViewportScrollPosition();return{top:xt.top+this._viewportMargin,left:xt.left+this._viewportMargin,right:xt.left+ue-this._viewportMargin,bottom:xt.top+ke-this._viewportMargin,width:ue-2*this._viewportMargin,height:ke-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(ue,ke){return"x"===ke?null==ue.offsetX?this._offsetX:ue.offsetX:null==ue.offsetY?this._offsetY:ue.offsetY}_validatePositions(){}_addPanelClasses(ue){this._pane&&(0,a.Eq)(ue).forEach(ke=>{""!==ke&&-1===this._appliedPanelClasses.indexOf(ke)&&(this._appliedPanelClasses.push(ke),this._pane.classList.add(ke))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(ue=>{this._pane.classList.remove(ue)}),this._appliedPanelClasses=[])}_getOriginRect(){const ue=this._origin;if(ue instanceof j.SBq)return ue.nativeElement.getBoundingClientRect();if(ue instanceof Element)return ue.getBoundingClientRect();const ke=ue.width||0,xt=ue.height||0;return{top:ue.y,bottom:ue.y+xt,left:ue.x,right:ue.x+ke,height:xt,width:ke}}}function Bt(dn,ue){for(let ke in ue)ue.hasOwnProperty(ke)&&(dn[ke]=ue[ke]);return dn}function Zt(dn){if("number"!=typeof dn&&null!=dn){const[ue,ke]=dn.split(fi);return ke&&"px"!==ke?null:parseFloat(ue)}return dn||null}function nn(dn){return{top:Math.floor(dn.top),right:Math.floor(dn.right),bottom:Math.floor(dn.bottom),left:Math.floor(dn.left),width:Math.floor(dn.width),height:Math.floor(dn.height)}}const ze="cdk-global-overlay-wrapper";class zt{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(ue){const ke=ue.getConfig();this._overlayRef=ue,this._width&&!ke.width&&ue.updateSize({width:this._width}),this._height&&!ke.height&&ue.updateSize({height:this._height}),ue.hostElement.classList.add(ze),this._isDisposed=!1}top(ue=""){return this._bottomOffset="",this._topOffset=ue,this._alignItems="flex-start",this}left(ue=""){return this._xOffset=ue,this._xPosition="left",this}bottom(ue=""){return this._topOffset="",this._bottomOffset=ue,this._alignItems="flex-end",this}right(ue=""){return this._xOffset=ue,this._xPosition="right",this}start(ue=""){return this._xOffset=ue,this._xPosition="start",this}end(ue=""){return this._xOffset=ue,this._xPosition="end",this}width(ue=""){return this._overlayRef?this._overlayRef.updateSize({width:ue}):this._width=ue,this}height(ue=""){return this._overlayRef?this._overlayRef.updateSize({height:ue}):this._height=ue,this}centerHorizontally(ue=""){return this.left(ue),this._xPosition="center",this}centerVertically(ue=""){return this.top(ue),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const ue=this._overlayRef.overlayElement.style,ke=this._overlayRef.hostElement.style,xt=this._overlayRef.getConfig(),{width:lt,height:Vt,maxWidth:An,maxHeight:Fn}=xt,Mn=!("100%"!==lt&&"100vw"!==lt||An&&"100%"!==An&&"100vw"!==An),At=!("100%"!==Vt&&"100vh"!==Vt||Fn&&"100%"!==Fn&&"100vh"!==Fn),Ae=this._xPosition,Qt=this._xOffset,Dn="rtl"===this._overlayRef.getConfig().direction;let ln="",mi="",Li="";Mn?Li="flex-start":"center"===Ae?(Li="center",Dn?mi=Qt:ln=Qt):Dn?"left"===Ae||"end"===Ae?(Li="flex-end",ln=Qt):("right"===Ae||"start"===Ae)&&(Li="flex-start",mi=Qt):"left"===Ae||"start"===Ae?(Li="flex-start",ln=Qt):("right"===Ae||"end"===Ae)&&(Li="flex-end",mi=Qt),ue.position=this._cssPosition,ue.marginLeft=Mn?"0":ln,ue.marginTop=At?"0":this._topOffset,ue.marginBottom=this._bottomOffset,ue.marginRight=Mn?"0":mi,ke.justifyContent=Li,ke.alignItems=At?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const ue=this._overlayRef.overlayElement.style,ke=this._overlayRef.hostElement,xt=ke.style;ke.classList.remove(ze),xt.justifyContent=xt.alignItems=ue.marginTop=ue.marginBottom=ue.marginLeft=ue.marginRight=ue.position="",this._overlayRef=null,this._isDisposed=!0}}let ve=(()=>{class dn{constructor(ke,xt,lt,Vt){this._viewportRuler=ke,this._document=xt,this._platform=lt,this._overlayContainer=Vt}global(){return new zt}flexibleConnectedTo(ke){return new Ci(ke,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(w.rL),j.LFG(y.K0),j.LFG(de.t4),j.LFG(ct))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac,providedIn:"root"}),dn})(),Lt=0,Tt=(()=>{class dn{constructor(ke,xt,lt,Vt,An,Fn,Mn,At,Ae,Qt,Dn,ln){this.scrollStrategies=ke,this._overlayContainer=xt,this._componentFactoryResolver=lt,this._positionBuilder=Vt,this._keyboardDispatcher=An,this._injector=Fn,this._ngZone=Mn,this._document=At,this._directionality=Ae,this._location=Qt,this._outsideClickDispatcher=Dn,this._animationsModuleType=ln}create(ke){const xt=this._createHostElement(),lt=this._createPaneElement(xt),Vt=this._createPortalOutlet(lt),An=new Te(ke);return An.direction=An.direction||this._directionality.value,new Pn(Vt,xt,lt,An,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(ke){const xt=this._document.createElement("div");return xt.id="cdk-overlay-"+Lt++,xt.classList.add("cdk-overlay-pane"),ke.appendChild(xt),xt}_createHostElement(){const ke=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(ke),ke}_createPortalOutlet(ke){return this._appRef||(this._appRef=this._injector.get(j.z2F)),new it.u0(ke,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return dn.\u0275fac=function(ke){return new(ke||dn)(j.LFG(ot),j.LFG(ct),j.LFG(j._Vd),j.LFG(ve),j.LFG(nt),j.LFG(j.zs3),j.LFG(j.R0b),j.LFG(y.K0),j.LFG(Qe.Is),j.LFG(y.Ye),j.LFG(Et),j.LFG(j.QbO,8))},dn.\u0275prov=j.Yz7({token:dn,factory:dn.\u0275fac}),dn})();const jn={provide:new j.OlP("cdk-connected-overlay-scroll-strategy"),deps:[Tt],useFactory:function vt(dn){return()=>dn.scrollStrategies.reposition()}};let li=(()=>{class dn{}return dn.\u0275fac=function(ke){return new(ke||dn)},dn.\u0275mod=j.oAB({type:dn}),dn.\u0275inj=j.cJS({providers:[Tt,jn],imports:[Qe.vT,it.eL,w.Cl,w.Cl]}),dn})()},3353:(Yn,kt,L)=>{"use strict";L.d(kt,{Mq:()=>tt,Oy:()=>ot,_i:()=>Re,ht:()=>Gt,i$:()=>at,kV:()=>ht,qK:()=>Ce,sA:()=>an,t4:()=>a});var w=L(4650),y=L(6895);let j;try{j=typeof Intl<"u"&&Intl.v8BreakIterator}catch{j=!1}let Qe,a=(()=>{class Te{constructor(mt){this._platformId=mt,this.isBrowser=this._platformId?(0,y.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!j)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return Te.\u0275fac=function(mt){return new(mt||Te)(w.LFG(w.Lbi))},Te.\u0275prov=w.Yz7({token:Te,factory:Te.\u0275fac,providedIn:"root"}),Te})();const it=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Ce(){if(Qe)return Qe;if("object"!=typeof document||!document)return Qe=new Set(it),Qe;let Te=document.createElement("input");return Qe=new Set(it.filter(Ne=>(Te.setAttribute("type",Ne),Te.type===Ne))),Qe}let Fe,qe,Ve,ft;function at(Te){return function $e(){if(null==Fe&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Fe=!0}))}finally{Fe=Fe||!1}return Fe}()?Te:!!Te.capture}function tt(){if(null==Ve){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Ve=!1,Ve;if("scrollBehavior"in document.documentElement.style)Ve=!0;else{const Te=Element.prototype.scrollTo;Ve=!!Te&&!/\{\s*\[native code\]\s*\}/.test(Te.toString())}}return Ve}function Re(){if("object"!=typeof document||!document)return 0;if(null==qe){const Te=document.createElement("div"),Ne=Te.style;Te.dir="rtl",Ne.width="1px",Ne.overflow="auto",Ne.visibility="hidden",Ne.pointerEvents="none",Ne.position="absolute";const mt=document.createElement("div"),It=mt.style;It.width="2px",It.height="1px",Te.appendChild(mt),document.body.appendChild(Te),qe=0,0===Te.scrollLeft&&(Te.scrollLeft=1,qe=0===Te.scrollLeft?1:2),Te.remove()}return qe}function ht(Te){if(function et(){if(null==ft){const Te=typeof document<"u"?document.head:null;ft=!(!Te||!Te.createShadowRoot&&!Te.attachShadow)}return ft}()){const Ne=Te.getRootNode?Te.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&Ne instanceof ShadowRoot)return Ne}return null}function Gt(){let Te=typeof document<"u"&&document?document.activeElement:null;for(;Te&&Te.shadowRoot;){const Ne=Te.shadowRoot.activeElement;if(Ne===Te)break;Te=Ne}return Te}function an(Te){return Te.composedPath?Te.composedPath()[0]:Te.target}function ot(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}},4080:(Yn,kt,L)=>{"use strict";L.d(kt,{C5:()=>$e,Pl:()=>Gt,UE:()=>at,eL:()=>ot,en:()=>Ve,u0:()=>Re});var w=L(4650),y=L(6895);class Fe{attach(mt){return this._attachedHost=mt,mt.attach(this)}detach(){let mt=this._attachedHost;null!=mt&&(this._attachedHost=null,mt.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(mt){this._attachedHost=mt}}class $e extends Fe{constructor(mt,It,sn,Cn){super(),this.component=mt,this.viewContainerRef=It,this.injector=sn,this.componentFactoryResolver=Cn}}class at extends Fe{constructor(mt,It,sn,Cn){super(),this.templateRef=mt,this.viewContainerRef=It,this.context=sn,this.injector=Cn}get origin(){return this.templateRef.elementRef}attach(mt,It=this.context){return this.context=It,super.attach(mt)}detach(){return this.context=void 0,super.detach()}}class qe extends Fe{constructor(mt){super(),this.element=mt instanceof w.SBq?mt.nativeElement:mt}}class Ve{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(mt){return mt instanceof $e?(this._attachedPortal=mt,this.attachComponentPortal(mt)):mt instanceof at?(this._attachedPortal=mt,this.attachTemplatePortal(mt)):this.attachDomPortal&&mt instanceof qe?(this._attachedPortal=mt,this.attachDomPortal(mt)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(mt){this._disposeFn=mt}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Re extends Ve{constructor(mt,It,sn,Cn,Yt){super(),this.outletElement=mt,this._componentFactoryResolver=It,this._appRef=sn,this._defaultInjector=Cn,this.attachDomPortal=nt=>{const Et=nt.element,ct=this._document.createComment("dom-portal");Et.parentNode.insertBefore(ct,Et),this.outletElement.appendChild(Et),this._attachedPortal=nt,super.setDisposeFn(()=>{ct.parentNode&&ct.parentNode.replaceChild(Et,ct)})},this._document=Yt}attachComponentPortal(mt){const sn=(mt.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(mt.component);let Cn;return mt.viewContainerRef?(Cn=mt.viewContainerRef.createComponent(sn,mt.viewContainerRef.length,mt.injector||mt.viewContainerRef.injector),this.setDisposeFn(()=>Cn.destroy())):(Cn=sn.create(mt.injector||this._defaultInjector||w.zs3.NULL),this._appRef.attachView(Cn.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(Cn.hostView),Cn.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(Cn)),this._attachedPortal=mt,Cn}attachTemplatePortal(mt){let It=mt.viewContainerRef,sn=It.createEmbeddedView(mt.templateRef,mt.context,{injector:mt.injector});return sn.rootNodes.forEach(Cn=>this.outletElement.appendChild(Cn)),sn.detectChanges(),this.setDisposeFn(()=>{let Cn=It.indexOf(sn);-1!==Cn&&It.remove(Cn)}),this._attachedPortal=mt,sn}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(mt){return mt.hostView.rootNodes[0]}}let Gt=(()=>{class Ne extends Ve{constructor(It,sn,Cn){super(),this._componentFactoryResolver=It,this._viewContainerRef=sn,this._isInitialized=!1,this.attached=new w.vpe,this.attachDomPortal=Yt=>{const nt=Yt.element,Et=this._document.createComment("dom-portal");Yt.setAttachedHost(this),nt.parentNode.insertBefore(Et,nt),this._getRootNode().appendChild(nt),this._attachedPortal=Yt,super.setDisposeFn(()=>{Et.parentNode&&Et.parentNode.replaceChild(nt,Et)})},this._document=Cn}get portal(){return this._attachedPortal}set portal(It){this.hasAttached()&&!It&&!this._isInitialized||(this.hasAttached()&&super.detach(),It&&super.attach(It),this._attachedPortal=It||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(It){It.setAttachedHost(this);const sn=null!=It.viewContainerRef?It.viewContainerRef:this._viewContainerRef,Yt=(It.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(It.component),nt=sn.createComponent(Yt,sn.length,It.injector||sn.injector);return sn!==this._viewContainerRef&&this._getRootNode().appendChild(nt.hostView.rootNodes[0]),super.setDisposeFn(()=>nt.destroy()),this._attachedPortal=It,this._attachedRef=nt,this.attached.emit(nt),nt}attachTemplatePortal(It){It.setAttachedHost(this);const sn=this._viewContainerRef.createEmbeddedView(It.templateRef,It.context,{injector:It.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=It,this._attachedRef=sn,this.attached.emit(sn),sn}_getRootNode(){const It=this._viewContainerRef.element.nativeElement;return It.nodeType===It.ELEMENT_NODE?It:It.parentNode}}return Ne.\u0275fac=function(It){return new(It||Ne)(w.Y36(w._Vd),w.Y36(w.s_b),w.Y36(y.K0))},Ne.\u0275dir=w.lG2({type:Ne,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[w.qOj]}),Ne})(),ot=(()=>{class Ne{}return Ne.\u0275fac=function(It){return new(It||Ne)},Ne.\u0275mod=w.oAB({type:Ne}),Ne.\u0275inj=w.cJS({}),Ne})()},8605:(Yn,kt,L)=>{"use strict";L.d(kt,{PQ:()=>Rt,ZD:()=>An,mF:()=>me,Cl:()=>Fn,rL:()=>vt});var w=L(1281),y=L(4650),j=L(7579),a=L(9646),de=L(9751),Qe=L(4968),it=L(4408),Ce=L(727);const Fe={schedule(Mn){let At=requestAnimationFrame,Ae=cancelAnimationFrame;const{delegate:Qt}=Fe;Qt&&(At=Qt.requestAnimationFrame,Ae=Qt.cancelAnimationFrame);const Dn=At(ln=>{Ae=void 0,Mn(ln)});return new Ce.w0(()=>Ae?.(Dn))},requestAnimationFrame(...Mn){const{delegate:At}=Fe;return(At?.requestAnimationFrame||requestAnimationFrame)(...Mn)},cancelAnimationFrame(...Mn){const{delegate:At}=Fe;return(At?.cancelAnimationFrame||cancelAnimationFrame)(...Mn)},delegate:void 0};var at=L(640);new class qe extends at.v{flush(At){this._active=!0;const Ae=this._scheduled;this._scheduled=void 0;const{actions:Qt}=this;let Dn;At=At||Qt.shift();do{if(Dn=At.execute(At.state,At.delay))break}while((At=Qt[0])&&At.id===Ae&&Qt.shift());if(this._active=!1,Dn){for(;(At=Qt[0])&&At.id===Ae&&Qt.shift();)At.unsubscribe();throw Dn}}}(class $e extends it.o{constructor(At,Ae){super(At,Ae),this.scheduler=At,this.work=Ae}requestAsyncId(At,Ae,Qt=0){return null!==Qt&&Qt>0?super.requestAsyncId(At,Ae,Qt):(At.actions.push(this),At._scheduled||(At._scheduled=Fe.requestAnimationFrame(()=>At.flush(void 0))))}recycleAsyncId(At,Ae,Qt=0){var Dn;if(null!=Qt?Qt>0:this.delay>0)return super.recycleAsyncId(At,Ae,Qt);const{actions:ln}=At;null!=Ae&&(null===(Dn=ln[ln.length-1])||void 0===Dn?void 0:Dn.id)!==Ae&&(Fe.cancelAnimationFrame(Ae),At._scheduled=void 0)}});let ft,Re=1;const et={};function ht(Mn){return Mn in et&&(delete et[Mn],!0)}const Gt={setImmediate(Mn){const At=Re++;return et[At]=!0,ft||(ft=Promise.resolve()),ft.then(()=>ht(At)&&Mn()),At},clearImmediate(Mn){ht(Mn)}},{setImmediate:ot,clearImmediate:Te}=Gt,Ne={setImmediate(...Mn){const{delegate:At}=Ne;return(At?.setImmediate||ot)(...Mn)},clearImmediate(Mn){const{delegate:At}=Ne;return(At?.clearImmediate||Te)(Mn)},delegate:void 0};new class It extends at.v{flush(At){this._active=!0;const Ae=this._scheduled;this._scheduled=void 0;const{actions:Qt}=this;let Dn;At=At||Qt.shift();do{if(Dn=At.execute(At.state,At.delay))break}while((At=Qt[0])&&At.id===Ae&&Qt.shift());if(this._active=!1,Dn){for(;(At=Qt[0])&&At.id===Ae&&Qt.shift();)At.unsubscribe();throw Dn}}}(class mt extends it.o{constructor(At,Ae){super(At,Ae),this.scheduler=At,this.work=Ae}requestAsyncId(At,Ae,Qt=0){return null!==Qt&&Qt>0?super.requestAsyncId(At,Ae,Qt):(At.actions.push(this),At._scheduled||(At._scheduled=Ne.setImmediate(At.flush.bind(At,void 0))))}recycleAsyncId(At,Ae,Qt=0){var Dn;if(null!=Qt?Qt>0:this.delay>0)return super.recycleAsyncId(At,Ae,Qt);const{actions:ln}=At;null!=Ae&&(null===(Dn=ln[ln.length-1])||void 0===Dn?void 0:Dn.id)!==Ae&&(Ne.clearImmediate(Ae),At._scheduled=void 0)}});var Yt=L(4986),nt=L(4482),Et=L(8421),ct=L(5403),Nn=L(5963);function fi(Mn,At=Yt.z){return function Pn(Mn){return(0,nt.e)((At,Ae)=>{let Qt=!1,Dn=null,ln=null,mi=!1;const Li=()=>{if(ln?.unsubscribe(),ln=null,Qt){Qt=!1;const Ii=Dn;Dn=null,Ae.next(Ii)}mi&&Ae.complete()},Qi=()=>{ln=null,mi&&Ae.complete()};At.subscribe((0,ct.x)(Ae,Ii=>{Qt=!0,Dn=Ii,ln||(0,Et.Xf)(Mn(Ii)).subscribe(ln=(0,ct.x)(Ae,Li,Qi))},()=>{mi=!0,(!Qt||!ln||ln.closed)&&Ae.complete()}))})}(()=>(0,Nn.H)(Mn,At))}var Ci=L(9300),Bt=L(2722),Zt=L(3353),nn=L(6895),Ct=L(445);let me=(()=>{class Mn{constructor(Ae,Qt,Dn){this._ngZone=Ae,this._platform=Qt,this._scrolled=new j.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=Dn}register(Ae){this.scrollContainers.has(Ae)||this.scrollContainers.set(Ae,Ae.elementScrolled().subscribe(()=>this._scrolled.next(Ae)))}deregister(Ae){const Qt=this.scrollContainers.get(Ae);Qt&&(Qt.unsubscribe(),this.scrollContainers.delete(Ae))}scrolled(Ae=20){return this._platform.isBrowser?new de.y(Qt=>{this._globalSubscription||this._addGlobalListener();const Dn=Ae>0?this._scrolled.pipe(fi(Ae)).subscribe(Qt):this._scrolled.subscribe(Qt);return this._scrolledCount++,()=>{Dn.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,a.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((Ae,Qt)=>this.deregister(Qt)),this._scrolled.complete()}ancestorScrolled(Ae,Qt){const Dn=this.getAncestorScrollContainers(Ae);return this.scrolled(Qt).pipe((0,Ci.h)(ln=>!ln||Dn.indexOf(ln)>-1))}getAncestorScrollContainers(Ae){const Qt=[];return this.scrollContainers.forEach((Dn,ln)=>{this._scrollableContainsElement(ln,Ae)&&Qt.push(ln)}),Qt}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(Ae,Qt){let Dn=(0,w.fI)(Qt),ln=Ae.getElementRef().nativeElement;do{if(Dn==ln)return!0}while(Dn=Dn.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const Ae=this._getWindow();return(0,Qe.R)(Ae.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return Mn.\u0275fac=function(Ae){return new(Ae||Mn)(y.LFG(y.R0b),y.LFG(Zt.t4),y.LFG(nn.K0,8))},Mn.\u0275prov=y.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),Rt=(()=>{class Mn{constructor(Ae,Qt,Dn,ln){this.elementRef=Ae,this.scrollDispatcher=Qt,this.ngZone=Dn,this.dir=ln,this._destroyed=new j.x,this._elementScrolled=new de.y(mi=>this.ngZone.runOutsideAngular(()=>(0,Qe.R)(this.elementRef.nativeElement,"scroll").pipe((0,Bt.R)(this._destroyed)).subscribe(mi)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(Ae){const Qt=this.elementRef.nativeElement,Dn=this.dir&&"rtl"==this.dir.value;null==Ae.left&&(Ae.left=Dn?Ae.end:Ae.start),null==Ae.right&&(Ae.right=Dn?Ae.start:Ae.end),null!=Ae.bottom&&(Ae.top=Qt.scrollHeight-Qt.clientHeight-Ae.bottom),Dn&&0!=(0,Zt._i)()?(null!=Ae.left&&(Ae.right=Qt.scrollWidth-Qt.clientWidth-Ae.left),2==(0,Zt._i)()?Ae.left=Ae.right:1==(0,Zt._i)()&&(Ae.left=Ae.right?-Ae.right:Ae.right)):null!=Ae.right&&(Ae.left=Qt.scrollWidth-Qt.clientWidth-Ae.right),this._applyScrollToOptions(Ae)}_applyScrollToOptions(Ae){const Qt=this.elementRef.nativeElement;(0,Zt.Mq)()?Qt.scrollTo(Ae):(null!=Ae.top&&(Qt.scrollTop=Ae.top),null!=Ae.left&&(Qt.scrollLeft=Ae.left))}measureScrollOffset(Ae){const Qt="left",ln=this.elementRef.nativeElement;if("top"==Ae)return ln.scrollTop;if("bottom"==Ae)return ln.scrollHeight-ln.clientHeight-ln.scrollTop;const mi=this.dir&&"rtl"==this.dir.value;return"start"==Ae?Ae=mi?"right":Qt:"end"==Ae&&(Ae=mi?Qt:"right"),mi&&2==(0,Zt._i)()?Ae==Qt?ln.scrollWidth-ln.clientWidth-ln.scrollLeft:ln.scrollLeft:mi&&1==(0,Zt._i)()?Ae==Qt?ln.scrollLeft+ln.scrollWidth-ln.clientWidth:-ln.scrollLeft:Ae==Qt?ln.scrollLeft:ln.scrollWidth-ln.clientWidth-ln.scrollLeft}}return Mn.\u0275fac=function(Ae){return new(Ae||Mn)(y.Y36(y.SBq),y.Y36(me),y.Y36(y.R0b),y.Y36(Ct.Is,8))},Mn.\u0275dir=y.lG2({type:Mn,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),Mn})(),vt=(()=>{class Mn{constructor(Ae,Qt,Dn){this._platform=Ae,this._change=new j.x,this._changeListener=ln=>{this._change.next(ln)},this._document=Dn,Qt.runOutsideAngular(()=>{if(Ae.isBrowser){const ln=this._getWindow();ln.addEventListener("resize",this._changeListener),ln.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const Ae=this._getWindow();Ae.removeEventListener("resize",this._changeListener),Ae.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const Ae={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),Ae}getViewportRect(){const Ae=this.getViewportScrollPosition(),{width:Qt,height:Dn}=this.getViewportSize();return{top:Ae.top,left:Ae.left,bottom:Ae.top+Dn,right:Ae.left+Qt,height:Dn,width:Qt}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const Ae=this._document,Qt=this._getWindow(),Dn=Ae.documentElement,ln=Dn.getBoundingClientRect();return{top:-ln.top||Ae.body.scrollTop||Qt.scrollY||Dn.scrollTop||0,left:-ln.left||Ae.body.scrollLeft||Qt.scrollX||Dn.scrollLeft||0}}change(Ae=20){return Ae>0?this._change.pipe(fi(Ae)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const Ae=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:Ae.innerWidth,height:Ae.innerHeight}:{width:0,height:0}}}return Mn.\u0275fac=function(Ae){return new(Ae||Mn)(y.LFG(Zt.t4),y.LFG(y.R0b),y.LFG(nn.K0,8))},Mn.\u0275prov=y.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),An=(()=>{class Mn{}return Mn.\u0275fac=function(Ae){return new(Ae||Mn)},Mn.\u0275mod=y.oAB({type:Mn}),Mn.\u0275inj=y.cJS({}),Mn})(),Fn=(()=>{class Mn{}return Mn.\u0275fac=function(Ae){return new(Ae||Mn)},Mn.\u0275mod=y.oAB({type:Mn}),Mn.\u0275inj=y.cJS({imports:[Ct.vT,An,Ct.vT,An]}),Mn})()},6895:(Yn,kt,L)=>{"use strict";L.d(kt,{Do:()=>Gt,EM:()=>na,HT:()=>a,JF:()=>gl,K0:()=>Qe,Mx:()=>js,NF:()=>ea,O5:()=>wo,RF:()=>ur,S$:()=>ft,V_:()=>Fe,Ye:()=>an,b0:()=>ht,bD:()=>fa,ez:()=>yo,mk:()=>Gi,n9:()=>xo,q:()=>j,rS:()=>Co,sg:()=>Fr,uU:()=>no,w_:()=>de});var w=L(4650);let y=null;function j(){return y}function a(U){y||(y=U)}class de{}const Qe=new w.OlP("DocumentToken");let it=(()=>{class U{historyGo(Z){throw new Error("Not implemented")}}return U.\u0275fac=function(Z){return new(Z||U)},U.\u0275prov=w.Yz7({token:U,factory:function(){return function Ce(){return(0,w.LFG)($e)}()},providedIn:"platform"}),U})();const Fe=new w.OlP("Location Initialized");let $e=(()=>{class U extends it{constructor(Z){super(),this._doc=Z,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return j().getBaseHref(this._doc)}onPopState(Z){const _e=j().getGlobalEventTarget(this._doc,"window");return _e.addEventListener("popstate",Z,!1),()=>_e.removeEventListener("popstate",Z)}onHashChange(Z){const _e=j().getGlobalEventTarget(this._doc,"window");return _e.addEventListener("hashchange",Z,!1),()=>_e.removeEventListener("hashchange",Z)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(Z){this._location.pathname=Z}pushState(Z,_e,pt){at()?this._history.pushState(Z,_e,pt):this._location.hash=pt}replaceState(Z,_e,pt){at()?this._history.replaceState(Z,_e,pt):this._location.hash=pt}forward(){this._history.forward()}back(){this._history.back()}historyGo(Z=0){this._history.go(Z)}getState(){return this._history.state}}return U.\u0275fac=function(Z){return new(Z||U)(w.LFG(Qe))},U.\u0275prov=w.Yz7({token:U,factory:function(){return function qe(){return new $e((0,w.LFG)(Qe))}()},providedIn:"platform"}),U})();function at(){return!!window.history.pushState}function Ve(U,se){if(0==U.length)return se;if(0==se.length)return U;let Z=0;return U.endsWith("/")&&Z++,se.startsWith("/")&&Z++,2==Z?U+se.substring(1):1==Z?U+se:U+"/"+se}function tt(U){const se=U.match(/#|\?|$/),Z=se&&se.index||U.length;return U.slice(0,Z-("/"===U[Z-1]?1:0))+U.slice(Z)}function Re(U){return U&&"?"!==U[0]?"?"+U:U}let ft=(()=>{class U{historyGo(Z){throw new Error("Not implemented")}}return U.\u0275fac=function(Z){return new(Z||U)},U.\u0275prov=w.Yz7({token:U,factory:function(){return(0,w.f3M)(ht)},providedIn:"root"}),U})();const et=new w.OlP("appBaseHref");let ht=(()=>{class U extends ft{constructor(Z,_e){super(),this._platformLocation=Z,this._removeListenerFns=[],this._baseHref=_e??this._platformLocation.getBaseHrefFromDOM()??(0,w.f3M)(Qe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Z){this._removeListenerFns.push(this._platformLocation.onPopState(Z),this._platformLocation.onHashChange(Z))}getBaseHref(){return this._baseHref}prepareExternalUrl(Z){return Ve(this._baseHref,Z)}path(Z=!1){const _e=this._platformLocation.pathname+Re(this._platformLocation.search),pt=this._platformLocation.hash;return pt&&Z?`${_e}${pt}`:_e}pushState(Z,_e,pt,En){const kn=this.prepareExternalUrl(pt+Re(En));this._platformLocation.pushState(Z,_e,kn)}replaceState(Z,_e,pt,En){const kn=this.prepareExternalUrl(pt+Re(En));this._platformLocation.replaceState(Z,_e,kn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Z=0){this._platformLocation.historyGo?.(Z)}}return U.\u0275fac=function(Z){return new(Z||U)(w.LFG(it),w.LFG(et,8))},U.\u0275prov=w.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})(),Gt=(()=>{class U extends ft{constructor(Z,_e){super(),this._platformLocation=Z,this._baseHref="",this._removeListenerFns=[],null!=_e&&(this._baseHref=_e)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(Z){this._removeListenerFns.push(this._platformLocation.onPopState(Z),this._platformLocation.onHashChange(Z))}getBaseHref(){return this._baseHref}path(Z=!1){let _e=this._platformLocation.hash;return null==_e&&(_e="#"),_e.length>0?_e.substring(1):_e}prepareExternalUrl(Z){const _e=Ve(this._baseHref,Z);return _e.length>0?"#"+_e:_e}pushState(Z,_e,pt,En){let kn=this.prepareExternalUrl(pt+Re(En));0==kn.length&&(kn=this._platformLocation.pathname),this._platformLocation.pushState(Z,_e,kn)}replaceState(Z,_e,pt,En){let kn=this.prepareExternalUrl(pt+Re(En));0==kn.length&&(kn=this._platformLocation.pathname),this._platformLocation.replaceState(Z,_e,kn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(Z=0){this._platformLocation.historyGo?.(Z)}}return U.\u0275fac=function(Z){return new(Z||U)(w.LFG(it),w.LFG(et,8))},U.\u0275prov=w.Yz7({token:U,factory:U.\u0275fac}),U})(),an=(()=>{class U{constructor(Z){this._subject=new w.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=Z;const _e=this._locationStrategy.getBaseHref();this._basePath=function mt(U){if(new RegExp("^(https?:)?//").test(U)){const[,Z]=U.split(/\/\/[^\/]+/);return Z}return U}(tt(Ne(_e))),this._locationStrategy.onPopState(pt=>{this._subject.emit({url:this.path(!0),pop:!0,state:pt.state,type:pt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(Z=!1){return this.normalize(this._locationStrategy.path(Z))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(Z,_e=""){return this.path()==this.normalize(Z+Re(_e))}normalize(Z){return U.stripTrailingSlash(function Te(U,se){if(!U||!se.startsWith(U))return se;const Z=se.substring(U.length);return""===Z||["/",";","?","#"].includes(Z[0])?Z:se}(this._basePath,Ne(Z)))}prepareExternalUrl(Z){return Z&&"/"!==Z[0]&&(Z="/"+Z),this._locationStrategy.prepareExternalUrl(Z)}go(Z,_e="",pt=null){this._locationStrategy.pushState(pt,"",Z,_e),this._notifyUrlChangeListeners(this.prepareExternalUrl(Z+Re(_e)),pt)}replaceState(Z,_e="",pt=null){this._locationStrategy.replaceState(pt,"",Z,_e),this._notifyUrlChangeListeners(this.prepareExternalUrl(Z+Re(_e)),pt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(Z=0){this._locationStrategy.historyGo?.(Z)}onUrlChange(Z){return this._urlChangeListeners.push(Z),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(_e=>{this._notifyUrlChangeListeners(_e.url,_e.state)})),()=>{const _e=this._urlChangeListeners.indexOf(Z);this._urlChangeListeners.splice(_e,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(Z="",_e){this._urlChangeListeners.forEach(pt=>pt(Z,_e))}subscribe(Z,_e,pt){return this._subject.subscribe({next:Z,error:_e,complete:pt})}}return U.normalizeQueryParams=Re,U.joinWithSlash=Ve,U.stripTrailingSlash=tt,U.\u0275fac=function(Z){return new(Z||U)(w.LFG(ft))},U.\u0275prov=w.Yz7({token:U,factory:function(){return function ot(){return new an((0,w.LFG)(ft))}()},providedIn:"root"}),U})();function Ne(U){return U.replace(/\/index.html$/,"")}var Yt=(()=>((Yt=Yt||{})[Yt.Format=0]="Format",Yt[Yt.Standalone=1]="Standalone",Yt))(),nt=(()=>((nt=nt||{})[nt.Narrow=0]="Narrow",nt[nt.Abbreviated=1]="Abbreviated",nt[nt.Wide=2]="Wide",nt[nt.Short=3]="Short",nt))(),Et=(()=>((Et=Et||{})[Et.Short=0]="Short",Et[Et.Medium=1]="Medium",Et[Et.Long=2]="Long",Et[Et.Full=3]="Full",Et))(),ct=(()=>((ct=ct||{})[ct.Decimal=0]="Decimal",ct[ct.Group=1]="Group",ct[ct.List=2]="List",ct[ct.PercentSign=3]="PercentSign",ct[ct.PlusSign=4]="PlusSign",ct[ct.MinusSign=5]="MinusSign",ct[ct.Exponential=6]="Exponential",ct[ct.SuperscriptingExponent=7]="SuperscriptingExponent",ct[ct.PerMille=8]="PerMille",ct[ct.Infinity=9]="Infinity",ct[ct.NaN=10]="NaN",ct[ct.TimeSeparator=11]="TimeSeparator",ct[ct.CurrencyDecimal=12]="CurrencyDecimal",ct[ct.CurrencyGroup=13]="CurrencyGroup",ct))();function Jt(U,se){return dn((0,w.cg1)(U)[w.wAp.DateFormat],se)}function ze(U,se){return dn((0,w.cg1)(U)[w.wAp.TimeFormat],se)}function zt(U,se){return dn((0,w.cg1)(U)[w.wAp.DateTimeFormat],se)}function ve(U,se){const Z=(0,w.cg1)(U),_e=Z[w.wAp.NumberSymbols][se];if(typeof _e>"u"){if(se===ct.CurrencyDecimal)return Z[w.wAp.NumberSymbols][ct.Decimal];if(se===ct.CurrencyGroup)return Z[w.wAp.NumberSymbols][ct.Group]}return _e}function vt(U){if(!U[w.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${U[w.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function dn(U,se){for(let Z=se;Z>-1;Z--)if(typeof U[Z]<"u")return U[Z];throw new Error("Locale data API: locale data undefined")}function ue(U){const[se,Z]=U.split(":");return{hours:+se,minutes:+Z}}const Vt=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,An={},Fn=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Mn=(()=>((Mn=Mn||{})[Mn.Short=0]="Short",Mn[Mn.ShortGMT=1]="ShortGMT",Mn[Mn.Long=2]="Long",Mn[Mn.Extended=3]="Extended",Mn))(),At=(()=>((At=At||{})[At.FullYear=0]="FullYear",At[At.Month=1]="Month",At[At.Date=2]="Date",At[At.Hours=3]="Hours",At[At.Minutes=4]="Minutes",At[At.Seconds=5]="Seconds",At[At.FractionalSeconds=6]="FractionalSeconds",At[At.Day=7]="Day",At))(),Ae=(()=>((Ae=Ae||{})[Ae.DayPeriods=0]="DayPeriods",Ae[Ae.Days=1]="Days",Ae[Ae.Months=2]="Months",Ae[Ae.Eras=3]="Eras",Ae))();function Qt(U,se,Z,_e){let pt=function Ge(U){if(xe(U))return U;if("number"==typeof U&&!isNaN(U))return new Date(U);if("string"==typeof U){if(U=U.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(U)){const[pt,En=1,kn=1]=U.split("-").map(wi=>+wi);return Dn(pt,En-1,kn)}const Z=parseFloat(U);if(!isNaN(U-Z))return new Date(Z);let _e;if(_e=U.match(Vt))return function Ye(U){const se=new Date(0);let Z=0,_e=0;const pt=U[8]?se.setUTCFullYear:se.setFullYear,En=U[8]?se.setUTCHours:se.setHours;U[9]&&(Z=Number(U[9]+U[10]),_e=Number(U[9]+U[11])),pt.call(se,Number(U[1]),Number(U[2])-1,Number(U[3]));const kn=Number(U[4]||0)-Z,wi=Number(U[5]||0)-_e,br=Number(U[6]||0),xr=Math.floor(1e3*parseFloat("0."+(U[7]||0)));return En.call(se,kn,wi,br,xr),se}(_e)}const se=new Date(U);if(!xe(se))throw new Error(`Unable to convert "${U}" into a date`);return se}(U);se=ln(Z,se)||se;let wi,kn=[];for(;se;){if(wi=Fn.exec(se),!wi){kn.push(se);break}{kn=kn.concat(wi.slice(1));const Er=kn.pop();if(!Er)break;se=Er}}let br=pt.getTimezoneOffset();_e&&(br=Q(_e,br),pt=function ye(U,se,Z){const _e=Z?-1:1,pt=U.getTimezoneOffset();return function ae(U,se){return(U=new Date(U.getTime())).setMinutes(U.getMinutes()+se),U}(U,_e*(Q(se,pt)-pt))}(pt,_e,!0));let xr="";return kn.forEach(Er=>{const Xi=function pe(U){if($t[U])return $t[U];let se;switch(U){case"G":case"GG":case"GGG":se=Kt(Ae.Eras,nt.Abbreviated);break;case"GGGG":se=Kt(Ae.Eras,nt.Wide);break;case"GGGGG":se=Kt(Ae.Eras,nt.Narrow);break;case"y":se=Ii(At.FullYear,1,0,!1,!0);break;case"yy":se=Ii(At.FullYear,2,0,!0,!0);break;case"yyy":se=Ii(At.FullYear,3,0,!1,!0);break;case"yyyy":se=Ii(At.FullYear,4,0,!1,!0);break;case"Y":se=wt(1);break;case"YY":se=wt(2,!0);break;case"YYY":se=wt(3);break;case"YYYY":se=wt(4);break;case"M":case"L":se=Ii(At.Month,1,1);break;case"MM":case"LL":se=Ii(At.Month,2,1);break;case"MMM":se=Kt(Ae.Months,nt.Abbreviated);break;case"MMMM":se=Kt(Ae.Months,nt.Wide);break;case"MMMMM":se=Kt(Ae.Months,nt.Narrow);break;case"LLL":se=Kt(Ae.Months,nt.Abbreviated,Yt.Standalone);break;case"LLLL":se=Kt(Ae.Months,nt.Wide,Yt.Standalone);break;case"LLLLL":se=Kt(Ae.Months,nt.Narrow,Yt.Standalone);break;case"w":se=be(1);break;case"ww":se=be(2);break;case"W":se=be(1,!0);break;case"d":se=Ii(At.Date,1);break;case"dd":se=Ii(At.Date,2);break;case"c":case"cc":se=Ii(At.Day,1);break;case"ccc":se=Kt(Ae.Days,nt.Abbreviated,Yt.Standalone);break;case"cccc":se=Kt(Ae.Days,nt.Wide,Yt.Standalone);break;case"ccccc":se=Kt(Ae.Days,nt.Narrow,Yt.Standalone);break;case"cccccc":se=Kt(Ae.Days,nt.Short,Yt.Standalone);break;case"E":case"EE":case"EEE":se=Kt(Ae.Days,nt.Abbreviated);break;case"EEEE":se=Kt(Ae.Days,nt.Wide);break;case"EEEEE":se=Kt(Ae.Days,nt.Narrow);break;case"EEEEEE":se=Kt(Ae.Days,nt.Short);break;case"a":case"aa":case"aaa":se=Kt(Ae.DayPeriods,nt.Abbreviated);break;case"aaaa":se=Kt(Ae.DayPeriods,nt.Wide);break;case"aaaaa":se=Kt(Ae.DayPeriods,nt.Narrow);break;case"b":case"bb":case"bbb":se=Kt(Ae.DayPeriods,nt.Abbreviated,Yt.Standalone,!0);break;case"bbbb":se=Kt(Ae.DayPeriods,nt.Wide,Yt.Standalone,!0);break;case"bbbbb":se=Kt(Ae.DayPeriods,nt.Narrow,Yt.Standalone,!0);break;case"B":case"BB":case"BBB":se=Kt(Ae.DayPeriods,nt.Abbreviated,Yt.Format,!0);break;case"BBBB":se=Kt(Ae.DayPeriods,nt.Wide,Yt.Format,!0);break;case"BBBBB":se=Kt(Ae.DayPeriods,nt.Narrow,Yt.Format,!0);break;case"h":se=Ii(At.Hours,1,-12);break;case"hh":se=Ii(At.Hours,2,-12);break;case"H":se=Ii(At.Hours,1);break;case"HH":se=Ii(At.Hours,2);break;case"m":se=Ii(At.Minutes,1);break;case"mm":se=Ii(At.Minutes,2);break;case"s":se=Ii(At.Seconds,1);break;case"ss":se=Ii(At.Seconds,2);break;case"S":se=Ii(At.FractionalSeconds,1);break;case"SS":se=Ii(At.FractionalSeconds,2);break;case"SSS":se=Ii(At.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":se=_t(Mn.Short);break;case"ZZZZZ":se=_t(Mn.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":se=_t(Mn.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":se=_t(Mn.Long);break;default:return null}return $t[U]=se,se}(Er);xr+=Xi?Xi(pt,Z,br):"''"===Er?"'":Er.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),xr}function Dn(U,se,Z){const _e=new Date(0);return _e.setFullYear(U,se,Z),_e.setHours(0,0,0),_e}function ln(U,se){const Z=function Nn(U){return(0,w.cg1)(U)[w.wAp.LocaleId]}(U);if(An[Z]=An[Z]||{},An[Z][se])return An[Z][se];let _e="";switch(se){case"shortDate":_e=Jt(U,Et.Short);break;case"mediumDate":_e=Jt(U,Et.Medium);break;case"longDate":_e=Jt(U,Et.Long);break;case"fullDate":_e=Jt(U,Et.Full);break;case"shortTime":_e=ze(U,Et.Short);break;case"mediumTime":_e=ze(U,Et.Medium);break;case"longTime":_e=ze(U,Et.Long);break;case"fullTime":_e=ze(U,Et.Full);break;case"short":const pt=ln(U,"shortTime"),En=ln(U,"shortDate");_e=mi(zt(U,Et.Short),[pt,En]);break;case"medium":const kn=ln(U,"mediumTime"),wi=ln(U,"mediumDate");_e=mi(zt(U,Et.Medium),[kn,wi]);break;case"long":const br=ln(U,"longTime"),xr=ln(U,"longDate");_e=mi(zt(U,Et.Long),[br,xr]);break;case"full":const Er=ln(U,"fullTime"),Xi=ln(U,"fullDate");_e=mi(zt(U,Et.Full),[Er,Xi])}return _e&&(An[Z][se]=_e),_e}function mi(U,se){return se&&(U=U.replace(/\{([^}]+)}/g,function(Z,_e){return null!=se&&_e in se?se[_e]:Z})),U}function Li(U,se,Z="-",_e,pt){let En="";(U<0||pt&&U<=0)&&(pt?U=1-U:(U=-U,En=Z));let kn=String(U);for(;kn.length<se;)kn="0"+kn;return _e&&(kn=kn.slice(kn.length-se)),En+kn}function Ii(U,se,Z=0,_e=!1,pt=!1){return function(En,kn){let wi=function Ir(U,se){switch(U){case At.FullYear:return se.getFullYear();case At.Month:return se.getMonth();case At.Date:return se.getDate();case At.Hours:return se.getHours();case At.Minutes:return se.getMinutes();case At.Seconds:return se.getSeconds();case At.FractionalSeconds:return se.getMilliseconds();case At.Day:return se.getDay();default:throw new Error(`Unknown DateType value "${U}".`)}}(U,En);if((Z>0||wi>-Z)&&(wi+=Z),U===At.Hours)0===wi&&-12===Z&&(wi=12);else if(U===At.FractionalSeconds)return function Qi(U,se){return Li(U,3).substring(0,se)}(wi,se);const br=ve(kn,ct.MinusSign);return Li(wi,se,br,_e,pt)}}function Kt(U,se,Z=Yt.Format,_e=!1){return function(pt,En){return function Ft(U,se,Z,_e,pt,En){switch(Z){case Ae.Months:return function Bt(U,se,Z){const _e=(0,w.cg1)(U),En=dn([_e[w.wAp.MonthsFormat],_e[w.wAp.MonthsStandalone]],se);return dn(En,Z)}(se,pt,_e)[U.getMonth()];case Ae.Days:return function Ci(U,se,Z){const _e=(0,w.cg1)(U),En=dn([_e[w.wAp.DaysFormat],_e[w.wAp.DaysStandalone]],se);return dn(En,Z)}(se,pt,_e)[U.getDay()];case Ae.DayPeriods:const kn=U.getHours(),wi=U.getMinutes();if(En){const xr=function jn(U){const se=(0,w.cg1)(U);return vt(se),(se[w.wAp.ExtraData][2]||[]).map(_e=>"string"==typeof _e?ue(_e):[ue(_e[0]),ue(_e[1])])}(se),Er=function li(U,se,Z){const _e=(0,w.cg1)(U);vt(_e);const En=dn([_e[w.wAp.ExtraData][0],_e[w.wAp.ExtraData][1]],se)||[];return dn(En,Z)||[]}(se,pt,_e),Xi=xr.findIndex(Yr=>{if(Array.isArray(Yr)){const[hr,Hn]=Yr,Kr=kn>=hr.hours&&wi>=hr.minutes,vo=kn<Hn.hours||kn===Hn.hours&&wi<Hn.minutes;if(hr.hours<Hn.hours){if(Kr&&vo)return!0}else if(Kr||vo)return!0}else if(Yr.hours===kn&&Yr.minutes===wi)return!0;return!1});if(-1!==Xi)return Er[Xi]}return function fi(U,se,Z){const _e=(0,w.cg1)(U),En=dn([_e[w.wAp.DayPeriodsFormat],_e[w.wAp.DayPeriodsStandalone]],se);return dn(En,Z)}(se,pt,_e)[kn<12?0:1];case Ae.Eras:return function Zt(U,se){return dn((0,w.cg1)(U)[w.wAp.Eras],se)}(se,_e)[U.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${Z}`)}}(pt,En,U,se,Z,_e)}}function _t(U){return function(se,Z,_e){const pt=-1*_e,En=ve(Z,ct.MinusSign),kn=pt>0?Math.floor(pt/60):Math.ceil(pt/60);switch(U){case Mn.Short:return(pt>=0?"+":"")+Li(kn,2,En)+Li(Math.abs(pt%60),2,En);case Mn.ShortGMT:return"GMT"+(pt>=0?"+":"")+Li(kn,1,En);case Mn.Long:return"GMT"+(pt>=0?"+":"")+Li(kn,2,En)+":"+Li(Math.abs(pt%60),2,En);case Mn.Extended:return 0===_e?"Z":(pt>=0?"+":"")+Li(kn,2,En)+":"+Li(Math.abs(pt%60),2,En);default:throw new Error(`Unknown zone width "${U}"`)}}}const bn=0,Ut=4;function oe(U){return Dn(U.getFullYear(),U.getMonth(),U.getDate()+(Ut-U.getDay()))}function be(U,se=!1){return function(Z,_e){let pt;if(se){const En=new Date(Z.getFullYear(),Z.getMonth(),1).getDay()-1,kn=Z.getDate();pt=1+Math.floor((kn+En)/7)}else{const En=oe(Z),kn=function De(U){const se=Dn(U,bn,1).getDay();return Dn(U,0,1+(se<=Ut?Ut:Ut+7)-se)}(En.getFullYear()),wi=En.getTime()-kn.getTime();pt=1+Math.round(wi/6048e5)}return Li(pt,U,ve(_e,ct.MinusSign))}}function wt(U,se=!1){return function(Z,_e){return Li(oe(Z).getFullYear(),U,ve(_e,ct.MinusSign),se)}}const $t={};function Q(U,se){U=U.replace(/:/g,"");const Z=Date.parse("Jan 01, 1970 00:00:00 "+U)/6e4;return isNaN(Z)?se:Z}function xe(U){return U instanceof Date&&!isNaN(U.valueOf())}function js(U,se){se=encodeURIComponent(se);for(const Z of U.split(";")){const _e=Z.indexOf("="),[pt,En]=-1==_e?[Z,""]:[Z.slice(0,_e),Z.slice(_e+1)];if(pt.trim()===se)return decodeURIComponent(En)}return null}const Pr=/\s+/,ii=[];let Gi=(()=>{class U{constructor(Z,_e,pt,En){this._iterableDiffers=Z,this._keyValueDiffers=_e,this._ngEl=pt,this._renderer=En,this.initialClasses=ii,this.stateMap=new Map}set klass(Z){this.initialClasses=null!=Z?Z.trim().split(Pr):ii}set ngClass(Z){this.rawClass="string"==typeof Z?Z.trim().split(Pr):Z}ngDoCheck(){for(const _e of this.initialClasses)this._updateState(_e,!0);const Z=this.rawClass;if(Array.isArray(Z)||Z instanceof Set)for(const _e of Z)this._updateState(_e,!0);else if(null!=Z)for(const _e of Object.keys(Z))this._updateState(_e,Boolean(Z[_e]));this._applyStateDiff()}_updateState(Z,_e){const pt=this.stateMap.get(Z);void 0!==pt?(pt.enabled!==_e&&(pt.changed=!0,pt.enabled=_e),pt.touched=!0):this.stateMap.set(Z,{enabled:_e,changed:!0,touched:!0})}_applyStateDiff(){for(const Z of this.stateMap){const _e=Z[0],pt=Z[1];pt.changed?(this._toggleClass(_e,pt.enabled),pt.changed=!1):pt.touched||(pt.enabled&&this._toggleClass(_e,!1),this.stateMap.delete(_e)),pt.touched=!1}}_toggleClass(Z,_e){(Z=Z.trim()).length>0&&Z.split(Pr).forEach(pt=>{_e?this._renderer.addClass(this._ngEl.nativeElement,pt):this._renderer.removeClass(this._ngEl.nativeElement,pt)})}}return U.\u0275fac=function(Z){return new(Z||U)(w.Y36(w.ZZ4),w.Y36(w.aQg),w.Y36(w.SBq),w.Y36(w.Qsj))},U.\u0275dir=w.lG2({type:U,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),U})();class bi{constructor(se,Z,_e,pt){this.$implicit=se,this.ngForOf=Z,this.index=_e,this.count=pt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Fr=(()=>{class U{set ngForOf(Z){this._ngForOf=Z,this._ngForOfDirty=!0}set ngForTrackBy(Z){this._trackByFn=Z}get ngForTrackBy(){return this._trackByFn}constructor(Z,_e,pt){this._viewContainer=Z,this._template=_e,this._differs=pt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(Z){Z&&(this._template=Z)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const Z=this._ngForOf;!this._differ&&Z&&(this._differ=this._differs.find(Z).create(this.ngForTrackBy))}if(this._differ){const Z=this._differ.diff(this._ngForOf);Z&&this._applyChanges(Z)}}_applyChanges(Z){const _e=this._viewContainer;Z.forEachOperation((pt,En,kn)=>{if(null==pt.previousIndex)_e.createEmbeddedView(this._template,new bi(pt.item,this._ngForOf,-1,-1),null===kn?void 0:kn);else if(null==kn)_e.remove(null===En?void 0:En);else if(null!==En){const wi=_e.get(En);_e.move(wi,kn),Ji(wi,pt)}});for(let pt=0,En=_e.length;pt<En;pt++){const wi=_e.get(pt).context;wi.index=pt,wi.count=En,wi.ngForOf=this._ngForOf}Z.forEachIdentityChange(pt=>{Ji(_e.get(pt.currentIndex),pt)})}static ngTemplateContextGuard(Z,_e){return!0}}return U.\u0275fac=function(Z){return new(Z||U)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(w.ZZ4))},U.\u0275dir=w.lG2({type:U,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),U})();function Ji(U,se){U.context.$implicit=se.item}let wo=(()=>{class U{constructor(Z,_e){this._viewContainer=Z,this._context=new $i,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=_e}set ngIf(Z){this._context.$implicit=this._context.ngIf=Z,this._updateView()}set ngIfThen(Z){Eo("ngIfThen",Z),this._thenTemplateRef=Z,this._thenViewRef=null,this._updateView()}set ngIfElse(Z){Eo("ngIfElse",Z),this._elseTemplateRef=Z,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(Z,_e){return!0}}return U.\u0275fac=function(Z){return new(Z||U)(w.Y36(w.s_b),w.Y36(w.Rgc))},U.\u0275dir=w.lG2({type:U,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),U})();class $i{constructor(){this.$implicit=null,this.ngIf=null}}function Eo(U,se){if(se&&!se.createEmbeddedView)throw new Error(`${U} must be a TemplateRef, but received '${(0,w.AaK)(se)}'.`)}class Br{constructor(se,Z){this._viewContainerRef=se,this._templateRef=Z,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(se){se&&!this._created?this.create():!se&&this._created&&this.destroy()}}let ur=(()=>{class U{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(Z){this._ngSwitch=Z,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(Z){this._defaultViews.push(Z)}_matchCase(Z){const _e=Z==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||_e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),_e}_updateDefaultCases(Z){if(this._defaultViews.length>0&&Z!==this._defaultUsed){this._defaultUsed=Z;for(const _e of this._defaultViews)_e.enforceState(Z)}}}return U.\u0275fac=function(Z){return new(Z||U)},U.\u0275dir=w.lG2({type:U,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),U})(),xo=(()=>{class U{constructor(Z,_e,pt){this.ngSwitch=pt,pt._addCase(),this._view=new Br(Z,_e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return U.\u0275fac=function(Z){return new(Z||U)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(ur,9))},U.\u0275dir=w.lG2({type:U,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),U})();function Io(U,se){return new w.vHH(2100,!1)}const ns=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let Co=(()=>{class U{transform(Z){if(null==Z)return null;if("string"!=typeof Z)throw Io();return Z.replace(ns,_e=>_e[0].toUpperCase()+_e.slice(1).toLowerCase())}}return U.\u0275fac=function(Z){return new(Z||U)},U.\u0275pipe=w.Yjl({name:"titlecase",type:U,pure:!0,standalone:!0}),U})();const fo=new w.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),is=new w.OlP("DATE_PIPE_DEFAULT_OPTIONS");let no=(()=>{class U{constructor(Z,_e,pt){this.locale=Z,this.defaultTimezone=_e,this.defaultOptions=pt}transform(Z,_e,pt,En){if(null==Z||""===Z||Z!=Z)return null;try{return Qt(Z,_e??this.defaultOptions?.dateFormat??"mediumDate",En||this.locale,pt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(kn){throw Io()}}}return U.\u0275fac=function(Z){return new(Z||U)(w.Y36(w.soG,16),w.Y36(fo,24),w.Y36(is,24))},U.\u0275pipe=w.Yjl({name:"date",type:U,pure:!0,standalone:!0}),U})(),yo=(()=>{class U{}return U.\u0275fac=function(Z){return new(Z||U)},U.\u0275mod=w.oAB({type:U}),U.\u0275inj=w.cJS({}),U})();const fa="browser";function ea(U){return U===fa}let na=(()=>{class U{}return U.\u0275prov=(0,w.Yz7)({token:U,providedIn:"root",factory:()=>new ga((0,w.LFG)(Qe),window)}),U})();class ga{constructor(se,Z){this.document=se,this.window=Z,this.offset=()=>[0,0]}setOffset(se){this.offset=Array.isArray(se)?()=>se:se}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(se){this.supportsScrolling()&&this.window.scrollTo(se[0],se[1])}scrollToAnchor(se){if(!this.supportsScrolling())return;const Z=function ko(U,se){const Z=U.getElementById(se)||U.getElementsByName(se)[0];if(Z)return Z;if("function"==typeof U.createTreeWalker&&U.body&&(U.body.createShadowRoot||U.body.attachShadow)){const _e=U.createTreeWalker(U.body,NodeFilter.SHOW_ELEMENT);let pt=_e.currentNode;for(;pt;){const En=pt.shadowRoot;if(En){const kn=En.getElementById(se)||En.querySelector(`[name="${se}"]`);if(kn)return kn}pt=_e.nextNode()}}return null}(this.document,se);Z&&(this.scrollToElement(Z),Z.focus())}setHistoryScrollRestoration(se){if(this.supportScrollRestoration()){const Z=this.window.history;Z&&Z.scrollRestoration&&(Z.scrollRestoration=se)}}scrollToElement(se){const Z=se.getBoundingClientRect(),_e=Z.left+this.window.pageXOffset,pt=Z.top+this.window.pageYOffset,En=this.offset();this.window.scrollTo(_e-En[0],pt-En[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const se=ia(this.window.history)||ia(Object.getPrototypeOf(this.window.history));return!(!se||!se.writable&&!se.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function ia(U){return Object.getOwnPropertyDescriptor(U,"scrollRestoration")}class gl{}},529:(Yn,kt,L)=>{"use strict";L.d(kt,{JF:()=>_t,eN:()=>Nn});var w=L(6895),y=L(4650),j=L(9646),a=L(9751),de=L(4351),Qe=L(9300),it=L(4004);class Ce{}class Fe{}class $e{constructor(oe){this.normalizedNames=new Map,this.lazyUpdate=null,oe?this.lazyInit="string"==typeof oe?()=>{this.headers=new Map,oe.split("\n").forEach(be=>{const wt=be.indexOf(":");if(wt>0){const $t=be.slice(0,wt),pe=$t.toLowerCase(),Q=be.slice(wt+1).trim();this.maybeSetNormalizedName($t,pe),this.headers.has(pe)?this.headers.get(pe).push(Q):this.headers.set(pe,[Q])}})}:()=>{this.headers=new Map,Object.entries(oe).forEach(([be,wt])=>{let $t;if($t="string"==typeof wt?[wt]:"number"==typeof wt?[wt.toString()]:wt.map(pe=>pe.toString()),$t.length>0){const pe=be.toLowerCase();this.headers.set(pe,$t),this.maybeSetNormalizedName(be,pe)}})}:this.headers=new Map}has(oe){return this.init(),this.headers.has(oe.toLowerCase())}get(oe){this.init();const be=this.headers.get(oe.toLowerCase());return be&&be.length>0?be[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(oe){return this.init(),this.headers.get(oe.toLowerCase())||null}append(oe,be){return this.clone({name:oe,value:be,op:"a"})}set(oe,be){return this.clone({name:oe,value:be,op:"s"})}delete(oe,be){return this.clone({name:oe,value:be,op:"d"})}maybeSetNormalizedName(oe,be){this.normalizedNames.has(be)||this.normalizedNames.set(be,oe)}init(){this.lazyInit&&(this.lazyInit instanceof $e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(oe=>this.applyUpdate(oe)),this.lazyUpdate=null))}copyFrom(oe){oe.init(),Array.from(oe.headers.keys()).forEach(be=>{this.headers.set(be,oe.headers.get(be)),this.normalizedNames.set(be,oe.normalizedNames.get(be))})}clone(oe){const be=new $e;return be.lazyInit=this.lazyInit&&this.lazyInit instanceof $e?this.lazyInit:this,be.lazyUpdate=(this.lazyUpdate||[]).concat([oe]),be}applyUpdate(oe){const be=oe.name.toLowerCase();switch(oe.op){case"a":case"s":let wt=oe.value;if("string"==typeof wt&&(wt=[wt]),0===wt.length)return;this.maybeSetNormalizedName(oe.name,be);const $t=("a"===oe.op?this.headers.get(be):void 0)||[];$t.push(...wt),this.headers.set(be,$t);break;case"d":const pe=oe.value;if(pe){let Q=this.headers.get(be);if(!Q)return;Q=Q.filter(ae=>-1===pe.indexOf(ae)),0===Q.length?(this.headers.delete(be),this.normalizedNames.delete(be)):this.headers.set(be,Q)}else this.headers.delete(be),this.normalizedNames.delete(be)}}forEach(oe){this.init(),Array.from(this.normalizedNames.keys()).forEach(be=>oe(this.normalizedNames.get(be),this.headers.get(be)))}}class qe{encodeKey(oe){return ft(oe)}encodeValue(oe){return ft(oe)}decodeKey(oe){return decodeURIComponent(oe)}decodeValue(oe){return decodeURIComponent(oe)}}const tt=/%(\d[a-f0-9])/gi,Re={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ft(De){return encodeURIComponent(De).replace(tt,(oe,be)=>Re[be]??oe)}function et(De){return`${De}`}class ht{constructor(oe={}){if(this.updates=null,this.cloneFrom=null,this.encoder=oe.encoder||new qe,oe.fromString){if(oe.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ve(De,oe){const be=new Map;return De.length>0&&De.replace(/^\?/,"").split("&").forEach($t=>{const pe=$t.indexOf("="),[Q,ae]=-1==pe?[oe.decodeKey($t),""]:[oe.decodeKey($t.slice(0,pe)),oe.decodeValue($t.slice(pe+1))],ye=be.get(Q)||[];ye.push(ae),be.set(Q,ye)}),be}(oe.fromString,this.encoder)}else oe.fromObject?(this.map=new Map,Object.keys(oe.fromObject).forEach(be=>{const wt=oe.fromObject[be],$t=Array.isArray(wt)?wt.map(et):[et(wt)];this.map.set(be,$t)})):this.map=null}has(oe){return this.init(),this.map.has(oe)}get(oe){this.init();const be=this.map.get(oe);return be?be[0]:null}getAll(oe){return this.init(),this.map.get(oe)||null}keys(){return this.init(),Array.from(this.map.keys())}append(oe,be){return this.clone({param:oe,value:be,op:"a"})}appendAll(oe){const be=[];return Object.keys(oe).forEach(wt=>{const $t=oe[wt];Array.isArray($t)?$t.forEach(pe=>{be.push({param:wt,value:pe,op:"a"})}):be.push({param:wt,value:$t,op:"a"})}),this.clone(be)}set(oe,be){return this.clone({param:oe,value:be,op:"s"})}delete(oe,be){return this.clone({param:oe,value:be,op:"d"})}toString(){return this.init(),this.keys().map(oe=>{const be=this.encoder.encodeKey(oe);return this.map.get(oe).map(wt=>be+"="+this.encoder.encodeValue(wt)).join("&")}).filter(oe=>""!==oe).join("&")}clone(oe){const be=new ht({encoder:this.encoder});return be.cloneFrom=this.cloneFrom||this,be.updates=(this.updates||[]).concat(oe),be}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(oe=>this.map.set(oe,this.cloneFrom.map.get(oe))),this.updates.forEach(oe=>{switch(oe.op){case"a":case"s":const be=("a"===oe.op?this.map.get(oe.param):void 0)||[];be.push(et(oe.value)),this.map.set(oe.param,be);break;case"d":if(void 0===oe.value){this.map.delete(oe.param);break}{let wt=this.map.get(oe.param)||[];const $t=wt.indexOf(et(oe.value));-1!==$t&&wt.splice($t,1),wt.length>0?this.map.set(oe.param,wt):this.map.delete(oe.param)}}}),this.cloneFrom=this.updates=null)}}class an{constructor(){this.map=new Map}set(oe,be){return this.map.set(oe,be),this}get(oe){return this.map.has(oe)||this.map.set(oe,oe.defaultValue()),this.map.get(oe)}delete(oe){return this.map.delete(oe),this}has(oe){return this.map.has(oe)}keys(){return this.map.keys()}}function Te(De){return typeof ArrayBuffer<"u"&&De instanceof ArrayBuffer}function Ne(De){return typeof Blob<"u"&&De instanceof Blob}function mt(De){return typeof FormData<"u"&&De instanceof FormData}class sn{constructor(oe,be,wt,$t){let pe;if(this.url=be,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=oe.toUpperCase(),function ot(De){switch(De){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||$t?(this.body=void 0!==wt?wt:null,pe=$t):pe=wt,pe&&(this.reportProgress=!!pe.reportProgress,this.withCredentials=!!pe.withCredentials,pe.responseType&&(this.responseType=pe.responseType),pe.headers&&(this.headers=pe.headers),pe.context&&(this.context=pe.context),pe.params&&(this.params=pe.params)),this.headers||(this.headers=new $e),this.context||(this.context=new an),this.params){const Q=this.params.toString();if(0===Q.length)this.urlWithParams=be;else{const ae=be.indexOf("?");this.urlWithParams=be+(-1===ae?"?":ae<be.length-1?"&":"")+Q}}else this.params=new ht,this.urlWithParams=be}serializeBody(){return null===this.body?null:Te(this.body)||Ne(this.body)||mt(this.body)||function It(De){return typeof URLSearchParams<"u"&&De instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ht?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||mt(this.body)?null:Ne(this.body)?this.body.type||null:Te(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ht?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(oe={}){const be=oe.method||this.method,wt=oe.url||this.url,$t=oe.responseType||this.responseType,pe=void 0!==oe.body?oe.body:this.body,Q=void 0!==oe.withCredentials?oe.withCredentials:this.withCredentials,ae=void 0!==oe.reportProgress?oe.reportProgress:this.reportProgress;let ye=oe.headers||this.headers,Ge=oe.params||this.params;const Ye=oe.context??this.context;return void 0!==oe.setHeaders&&(ye=Object.keys(oe.setHeaders).reduce((xe,fe)=>xe.set(fe,oe.setHeaders[fe]),ye)),oe.setParams&&(Ge=Object.keys(oe.setParams).reduce((xe,fe)=>xe.set(fe,oe.setParams[fe]),Ge)),new sn(be,wt,pe,{params:Ge,headers:ye,context:Ye,reportProgress:ae,responseType:$t,withCredentials:Q})}}var Cn=(()=>((Cn=Cn||{})[Cn.Sent=0]="Sent",Cn[Cn.UploadProgress=1]="UploadProgress",Cn[Cn.ResponseHeader=2]="ResponseHeader",Cn[Cn.DownloadProgress=3]="DownloadProgress",Cn[Cn.Response=4]="Response",Cn[Cn.User=5]="User",Cn))();class Yt{constructor(oe,be=200,wt="OK"){this.headers=oe.headers||new $e,this.status=void 0!==oe.status?oe.status:be,this.statusText=oe.statusText||wt,this.url=oe.url||null,this.ok=this.status>=200&&this.status<300}}class nt extends Yt{constructor(oe={}){super(oe),this.type=Cn.ResponseHeader}clone(oe={}){return new nt({headers:oe.headers||this.headers,status:void 0!==oe.status?oe.status:this.status,statusText:oe.statusText||this.statusText,url:oe.url||this.url||void 0})}}class Et extends Yt{constructor(oe={}){super(oe),this.type=Cn.Response,this.body=void 0!==oe.body?oe.body:null}clone(oe={}){return new Et({body:void 0!==oe.body?oe.body:this.body,headers:oe.headers||this.headers,status:void 0!==oe.status?oe.status:this.status,statusText:oe.statusText||this.statusText,url:oe.url||this.url||void 0})}}class ct extends Yt{constructor(oe){super(oe,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${oe.url||"(unknown url)"}`:`Http failure response for ${oe.url||"(unknown url)"}: ${oe.status} ${oe.statusText}`,this.error=oe.error||null}}function Pn(De,oe){return{body:oe,headers:De.headers,context:De.context,observe:De.observe,params:De.params,reportProgress:De.reportProgress,responseType:De.responseType,withCredentials:De.withCredentials}}let Nn=(()=>{class De{constructor(be){this.handler=be}request(be,wt,$t={}){let pe;if(be instanceof sn)pe=be;else{let ye,Ge;ye=$t.headers instanceof $e?$t.headers:new $e($t.headers),$t.params&&(Ge=$t.params instanceof ht?$t.params:new ht({fromObject:$t.params})),pe=new sn(be,wt,void 0!==$t.body?$t.body:null,{headers:ye,context:$t.context,params:Ge,reportProgress:$t.reportProgress,responseType:$t.responseType||"json",withCredentials:$t.withCredentials})}const Q=(0,j.of)(pe).pipe((0,de.b)(ye=>this.handler.handle(ye)));if(be instanceof sn||"events"===$t.observe)return Q;const ae=Q.pipe((0,Qe.h)(ye=>ye instanceof Et));switch($t.observe||"body"){case"body":switch(pe.responseType){case"arraybuffer":return ae.pipe((0,it.U)(ye=>{if(null!==ye.body&&!(ye.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return ye.body}));case"blob":return ae.pipe((0,it.U)(ye=>{if(null!==ye.body&&!(ye.body instanceof Blob))throw new Error("Response is not a Blob.");return ye.body}));case"text":return ae.pipe((0,it.U)(ye=>{if(null!==ye.body&&"string"!=typeof ye.body)throw new Error("Response is not a string.");return ye.body}));default:return ae.pipe((0,it.U)(ye=>ye.body))}case"response":return ae;default:throw new Error(`Unreachable: unhandled observe type ${$t.observe}}`)}}delete(be,wt={}){return this.request("DELETE",be,wt)}get(be,wt={}){return this.request("GET",be,wt)}head(be,wt={}){return this.request("HEAD",be,wt)}jsonp(be,wt){return this.request("JSONP",be,{params:(new ht).append(wt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(be,wt={}){return this.request("OPTIONS",be,wt)}patch(be,wt,$t={}){return this.request("PATCH",be,Pn($t,wt))}post(be,wt,$t={}){return this.request("POST",be,Pn($t,wt))}put(be,wt,$t={}){return this.request("PUT",be,Pn($t,wt))}}return De.\u0275fac=function(be){return new(be||De)(y.LFG(Ce))},De.\u0275prov=y.Yz7({token:De,factory:De.\u0275fac}),De})();function fi(De,oe){return oe(De)}function Ci(De,oe){return(be,wt)=>oe.intercept(be,{handle:$t=>De($t,wt)})}const Zt=new y.OlP("HTTP_INTERCEPTORS"),nn=new y.OlP("HTTP_INTERCEPTOR_FNS");function Ct(){let De=null;return(oe,be)=>(null===De&&(De=((0,y.f3M)(Zt,{optional:!0})??[]).reduceRight(Ci,fi)),De(oe,be))}let Jt=(()=>{class De extends Ce{constructor(be,wt){super(),this.backend=be,this.injector=wt,this.chain=null}handle(be){if(null===this.chain){const wt=Array.from(new Set(this.injector.get(nn)));this.chain=wt.reduceRight(($t,pe)=>function Bt(De,oe,be){return(wt,$t)=>be.runInContext(()=>oe(wt,pe=>De(pe,$t)))}($t,pe,this.injector),fi)}return this.chain(be,wt=>this.backend.handle(wt))}}return De.\u0275fac=function(be){return new(be||De)(y.LFG(Fe),y.LFG(y.lqb))},De.\u0275prov=y.Yz7({token:De,factory:De.\u0275fac}),De})();const li=/^\)\]\}',?\n/;let dn=(()=>{class De{constructor(be){this.xhrFactory=be}handle(be){if("JSONP"===be.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new a.y(wt=>{const $t=this.xhrFactory.build();if($t.open(be.method,be.urlWithParams),be.withCredentials&&($t.withCredentials=!0),be.headers.forEach((te,ge)=>$t.setRequestHeader(te,ge.join(","))),be.headers.has("Accept")||$t.setRequestHeader("Accept","application/json, text/plain, */*"),!be.headers.has("Content-Type")){const te=be.detectContentTypeHeader();null!==te&&$t.setRequestHeader("Content-Type",te)}if(be.responseType){const te=be.responseType.toLowerCase();$t.responseType="json"!==te?te:"text"}const pe=be.serializeBody();let Q=null;const ae=()=>{if(null!==Q)return Q;const te=$t.statusText||"OK",ge=new $e($t.getAllResponseHeaders()),ut=function Bi(De){return"responseURL"in De&&De.responseURL?De.responseURL:/^X-Request-URL:/m.test(De.getAllResponseHeaders())?De.getResponseHeader("X-Request-URL"):null}($t)||be.url;return Q=new nt({headers:ge,status:$t.status,statusText:te,url:ut}),Q},ye=()=>{let{headers:te,status:ge,statusText:ut,url:en}=ae(),Xt=null;204!==ge&&(Xt=typeof $t.response>"u"?$t.responseText:$t.response),0===ge&&(ge=Xt?200:0);let Qn=ge>=200&&ge<300;if("json"===be.responseType&&"string"==typeof Xt){const ei=Xt;Xt=Xt.replace(li,"");try{Xt=""!==Xt?JSON.parse(Xt):null}catch(ci){Xt=ei,Qn&&(Qn=!1,Xt={error:ci,text:Xt})}}Qn?(wt.next(new Et({body:Xt,headers:te,status:ge,statusText:ut,url:en||void 0})),wt.complete()):wt.error(new ct({error:Xt,headers:te,status:ge,statusText:ut,url:en||void 0}))},Ge=te=>{const{url:ge}=ae(),ut=new ct({error:te,status:$t.status||0,statusText:$t.statusText||"Unknown Error",url:ge||void 0});wt.error(ut)};let Ye=!1;const xe=te=>{Ye||(wt.next(ae()),Ye=!0);let ge={type:Cn.DownloadProgress,loaded:te.loaded};te.lengthComputable&&(ge.total=te.total),"text"===be.responseType&&$t.responseText&&(ge.partialText=$t.responseText),wt.next(ge)},fe=te=>{let ge={type:Cn.UploadProgress,loaded:te.loaded};te.lengthComputable&&(ge.total=te.total),wt.next(ge)};return $t.addEventListener("load",ye),$t.addEventListener("error",Ge),$t.addEventListener("timeout",Ge),$t.addEventListener("abort",Ge),be.reportProgress&&($t.addEventListener("progress",xe),null!==pe&&$t.upload&&$t.upload.addEventListener("progress",fe)),$t.send(pe),wt.next({type:Cn.Sent}),()=>{$t.removeEventListener("error",Ge),$t.removeEventListener("abort",Ge),$t.removeEventListener("load",ye),$t.removeEventListener("timeout",Ge),be.reportProgress&&($t.removeEventListener("progress",xe),null!==pe&&$t.upload&&$t.upload.removeEventListener("progress",fe)),$t.readyState!==$t.DONE&&$t.abort()}})}}return De.\u0275fac=function(be){return new(be||De)(y.LFG(w.JF))},De.\u0275prov=y.Yz7({token:De,factory:De.\u0275fac}),De})();const ue=new y.OlP("XSRF_ENABLED"),xt=new y.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Vt=new y.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class An{}let Fn=(()=>{class De{constructor(be,wt,$t){this.doc=be,this.platform=wt,this.cookieName=$t,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const be=this.doc.cookie||"";return be!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,w.Mx)(be,this.cookieName),this.lastCookieString=be),this.lastToken}}return De.\u0275fac=function(be){return new(be||De)(y.LFG(w.K0),y.LFG(y.Lbi),y.LFG(xt))},De.\u0275prov=y.Yz7({token:De,factory:De.\u0275fac}),De})();function Mn(De,oe){const be=De.url.toLowerCase();if(!(0,y.f3M)(ue)||"GET"===De.method||"HEAD"===De.method||be.startsWith("http://")||be.startsWith("https://"))return oe(De);const wt=(0,y.f3M)(An).getToken(),$t=(0,y.f3M)(Vt);return null!=wt&&!De.headers.has($t)&&(De=De.clone({headers:De.headers.set($t,wt)})),oe(De)}var Ae=(()=>((Ae=Ae||{})[Ae.Interceptors=0]="Interceptors",Ae[Ae.LegacyInterceptors=1]="LegacyInterceptors",Ae[Ae.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Ae[Ae.NoXsrfProtection=3]="NoXsrfProtection",Ae[Ae.JsonpSupport=4]="JsonpSupport",Ae[Ae.RequestsMadeViaParent=5]="RequestsMadeViaParent",Ae))();function Qt(De,oe){return{\u0275kind:De,\u0275providers:oe}}function Dn(...De){const oe=[Nn,dn,Jt,{provide:Ce,useExisting:Jt},{provide:Fe,useExisting:dn},{provide:nn,useValue:Mn,multi:!0},{provide:ue,useValue:!0},{provide:An,useClass:Fn}];for(const be of De)oe.push(...be.\u0275providers);return(0,y.MR2)(oe)}const mi=new y.OlP("LEGACY_INTERCEPTOR_FN");let _t=(()=>{class De{}return De.\u0275fac=function(be){return new(be||De)},De.\u0275mod=y.oAB({type:De}),De.\u0275inj=y.cJS({providers:[Dn(Qt(Ae.LegacyInterceptors,[{provide:mi,useFactory:Ct},{provide:nn,useExisting:mi,multi:!0}]))]}),De})()},4650:(Yn,kt,L)=>{"use strict";L.d(kt,{$8M:()=>On,$WT:()=>pn,$Z:()=>Ym,AFp:()=>d0,ALo:()=>Iv,AaK:()=>Ce,AsE:()=>vn,BQk:()=>np,CHM:()=>ws,CRH:()=>Vv,CZH:()=>Wg,CqO:()=>wg,D6c:()=>Mw,DdM:()=>wv,EJc:()=>Ux,EiD:()=>ym,EpF:()=>bg,F$t:()=>ih,F4k:()=>xg,FYo:()=>Im,FiY:()=>Be,G48:()=>aw,Gf:()=>zv,GfV:()=>Ih,Gpc:()=>at,Hsn:()=>Sf,Ikx:()=>Jc,JOm:()=>Oo,JVY:()=>pm,JZr:()=>ft,KtG:()=>nl,L6k:()=>fm,LAX:()=>Ap,LFG:()=>_t,LSH:()=>wh,Lbi:()=>Fx,Lck:()=>Fb,MAs:()=>ep,MGl:()=>rh,MMx:()=>ry,MR2:()=>Cm,NdJ:()=>rp,O4$:()=>Aa,OlP:()=>or,Oqu:()=>Un,P3R:()=>Eh,PXZ:()=>tw,Q6J:()=>xc,QGY:()=>ku,QbO:()=>Bx,Qsj:()=>Gp,R0b:()=>Ec,RDi:()=>Dp,Rgc:()=>qf,SBq:()=>Xu,Sil:()=>jx,Suo:()=>Uv,TTD:()=>fs,TgZ:()=>nh,Tol:()=>E,Udp:()=>d,VKq:()=>Ev,W1O:()=>$v,WFA:()=>Tf,WLB:()=>Cv,X6Q:()=>sw,XFs:()=>ue,Xpm:()=>Qn,Xts:()=>Ch,Y36:()=>Mu,YKP:()=>pv,YNc:()=>vg,Yjl:()=>ir,Yz7:()=>ve,Z0I:()=>me,ZZ4:()=>Ay,_Bn:()=>hv,_UZ:()=>Df,_Vd:()=>wu,_c5:()=>Ew,_uU:()=>Ln,aQg:()=>Iy,c2e:()=>Nx,cJS:()=>Tt,cg1:()=>lh,d8E:()=>Fu,dDg:()=>Xx,dqk:()=>Fn,eBb:()=>Wl,eFA:()=>C0,eJc:()=>py,ekj:()=>f,eoX:()=>b0,f3M:()=>Ut,g9A:()=>p0,h0i:()=>lp,hGG:()=>Cw,hij:()=>Zn,iGM:()=>Nv,ifc:()=>ye,ip1:()=>u0,jDz:()=>mv,kL8:()=>zf,lG2:()=>Yi,lcZ:()=>Pv,lqb:()=>xu,lri:()=>y0,mCW:()=>Td,n5z:()=>Oe,n_E:()=>jg,oAB:()=>Vi,oxw:()=>ec,pB0:()=>fu,q3G:()=>ls,qLn:()=>kd,qOj:()=>Lc,qZA:()=>Ru,qzn:()=>Ac,rWj:()=>v0,s9C:()=>op,sBO:()=>lw,s_b:()=>Gg,soG:()=>qg,tb:()=>w0,tp0:()=>Ie,uIk:()=>Iu,vHH:()=>et,vpe:()=>iu,wAp:()=>tr,xi3:()=>Ov,xp6:()=>Bd,ynx:()=>tp,z2F:()=>Yg,z3N:()=>Sc,zSh:()=>Pc,zs3:()=>Eu});var w=L(7579),y=L(727),j=L(9751),a=L(6451),de=L(3099);function Qe(r){for(let o in r)if(r[o]===Qe)return o;throw Error("Could not find renamed property on target object.")}function it(r,o){for(const c in o)o.hasOwnProperty(c)&&!r.hasOwnProperty(c)&&(r[c]=o[c])}function Ce(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(Ce).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const c=o.indexOf("\n");return-1===c?o:o.substring(0,c)}function Fe(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const $e=Qe({__forward_ref__:Qe});function at(r){return r.__forward_ref__=at,r.toString=function(){return Ce(this())},r}function qe(r){return Ve(r)?r():r}function Ve(r){return"function"==typeof r&&r.hasOwnProperty($e)&&r.__forward_ref__===at}function tt(r){return r&&!!r.\u0275providers}const ft="https://g.co/ng/security#xss";class et extends Error{constructor(o,c){super(ht(o,c)),this.code=o}}function ht(r,o){return`NG0${Math.abs(r)}${o?": "+o.trim():""}`}function Gt(r){return"string"==typeof r?r:null==r?"":String(r)}function mt(r,o){throw new et(-201,!1)}function nn(r,o){null==r&&function Ct(r,o,c,h){throw new Error(`ASSERTION ERROR: ${r}`+(null==h?"":` [Expected=> ${c} ${h} ${o} <=Actual]`))}(o,r,null,"!=")}function ve(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Tt(r){return{providers:r.providers||[],imports:r.imports||[]}}function fn(r){return Rt(r,jn)||Rt(r,Bi)}function me(r){return null!==fn(r)}function Rt(r,o){return r.hasOwnProperty(o)?r[o]:null}function vt(r){return r&&(r.hasOwnProperty(li)||r.hasOwnProperty(dn))?r[li]:null}const jn=Qe({\u0275prov:Qe}),li=Qe({\u0275inj:Qe}),Bi=Qe({ngInjectableDef:Qe}),dn=Qe({ngInjectorDef:Qe});var ue=(()=>((ue=ue||{})[ue.Default=0]="Default",ue[ue.Host=1]="Host",ue[ue.Self=2]="Self",ue[ue.SkipSelf=4]="SkipSelf",ue[ue.Optional=8]="Optional",ue))();let ke;function lt(r){const o=ke;return ke=r,o}function Vt(r,o,c){const h=fn(r);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:c&ue.Optional?null:void 0!==o?o:void mt(Ce(r))}const Fn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Qt={},Dn="__NG_DI_FLAG__",ln="ngTempTokenPath",mi="ngTokenPath",Li=/\n/gm,Qi="\u0275",Ii="__source";let Ir;function Kt(r){const o=Ir;return Ir=r,o}function Ft(r,o=ue.Default){if(void 0===Ir)throw new et(-203,!1);return null===Ir?Vt(r,void 0,o):Ir.get(r,o&ue.Optional?null:void 0,o)}function _t(r,o=ue.Default){return(function xt(){return ke}()||Ft)(qe(r),o)}function Ut(r,o=ue.Default){return _t(r,De(o))}function De(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function oe(r){const o=[];for(let c=0;c<r.length;c++){const h=qe(r[c]);if(Array.isArray(h)){if(0===h.length)throw new et(900,!1);let g,x=ue.Default;for(let I=0;I<h.length;I++){const B=h[I],H=wt(B);"number"==typeof H?-1===H?g=B.token:x|=H:g=B}o.push(_t(g,x))}else o.push(_t(h))}return o}function be(r,o){return r[Dn]=o,r.prototype[Dn]=o,r}function wt(r){return r[Dn]}function Q(r){return{toString:r}.toString()}var ae=(()=>((ae=ae||{})[ae.OnPush=0]="OnPush",ae[ae.Default=1]="Default",ae))(),ye=(()=>{return(r=ye||(ye={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",ye;var r})();const Ge={},Ye=[],xe=Qe({\u0275cmp:Qe}),fe=Qe({\u0275dir:Qe}),te=Qe({\u0275pipe:Qe}),ge=Qe({\u0275mod:Qe}),ut=Qe({\u0275fac:Qe}),en=Qe({__NG_ELEMENT_ID__:Qe});let Xt=0;function Qn(r){return Q(()=>{const o=Lr(r),c={...o,decls:r.decls,vars:r.vars,template:r.template,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,onPush:r.changeDetection===ae.OnPush,directiveDefs:null,pipeDefs:null,dependencies:o.standalone&&r.dependencies||null,getStandaloneInjector:null,data:r.data||{},encapsulation:r.encapsulation||ye.Emulated,id:"c"+Xt++,styles:r.styles||Ye,_:null,schemas:r.schemas||null,tView:null};Ro(c);const h=r.dependencies;return c.directiveDefs=js(h,!1),c.pipeDefs=js(h,!0),c})}function ci(r){return Ki(r)||kr(r)}function gi(r){return null!==r}function Vi(r){return Q(()=>({type:r.type,bootstrap:r.bootstrap||Ye,declarations:r.declarations||Ye,imports:r.imports||Ye,exports:r.exports||Ye,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function hi(r,o){if(null==r)return Ge;const c={};for(const h in r)if(r.hasOwnProperty(h)){let g=r[h],x=g;Array.isArray(g)&&(x=g[1],g=g[0]),c[g]=h,o&&(o[g]=x)}return c}function Yi(r){return Q(()=>{const o=Lr(r);return Ro(o),o})}function ir(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Ki(r){return r[xe]||null}function kr(r){return r[fe]||null}function Cr(r){return r[te]||null}function pn(r){const o=Ki(r)||kr(r)||Cr(r);return null!==o&&o.standalone}function qr(r,o){const c=r[ge]||null;if(!c&&!0===o)throw new Error(`Type ${Ce(r)} does not have '\u0275mod' property.`);return c}function Lr(r){const o={};return{type:r.type,providersResolver:null,factory:null,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:o,exportAs:r.exportAs||null,standalone:!0===r.standalone,selectors:r.selectors||Ye,viewQuery:r.viewQuery||null,features:r.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:hi(r.inputs,o),outputs:hi(r.outputs)}}function Ro(r){r.features?.forEach(o=>o(r))}function js(r,o){if(!r)return null;const c=o?Cr:ci;return()=>("function"==typeof r?r():r).map(h=>c(h)).filter(gi)}const Pr=0,ii=1,Gi=2,rr=3,Kn=4,Ri=5,bi=6,Fr=7,Ji=8,Pi=9,wo=10,$i=11,Eo=12,Br=13,ur=14,xo=15,to=16,ts=17,Zo=18,Vo=19,Hs=20,hs=21,Dr=22,Gs=1,po=2,Or=7,jo=8,ys=9,dr=10;function Co(r){return Array.isArray(r)&&"object"==typeof r[Gs]}function lo(r){return Array.isArray(r)&&!0===r[Gs]}function jr(r){return 0!=(4&r.flags)}function fo(r){return r.componentOffset>-1}function is(r){return 1==(1&r.flags)}function no(r){return!!r.template}function io(r){return 0!=(256&r[Gi])}function Ur(r,o){return r.hasOwnProperty(ut)?r[ut]:null}class ps{constructor(o,c,h){this.previousValue=o,this.currentValue=c,this.firstChange=h}isFirstChange(){return this.firstChange}}function fs(){return na}function na(r){return r.type.prototype.ngOnChanges&&(r.setInput=ia),ga}function ga(){const r=fr(this),o=r?.current;if(o){const c=r.previous;if(c===Ge)r.previous=o;else for(let h in o)c[h]=o[h];r.current=null,this.ngOnChanges(o)}}function ia(r,o,c,h){const g=this.declaredInputs[c],x=fr(r)||function gl(r,o){return r[ko]=o}(r,{previous:Ge,current:null}),I=x.current||(x.current={}),B=x.previous,H=B[g];I[g]=new ps(H&&H.currentValue,o,B===Ge),r[h]=o}fs.ngInherit=!0;const ko="__ngSimpleChanges__";function fr(r){return r[ko]||null}const co=function(r,o,c){},$s="svg";function Pt(r){for(;Array.isArray(r);)r=r[Pr];return r}function ce(r,o){return Pt(o[r])}function Ke(r,o){return Pt(o[r.index])}function Bn(r,o){return r.data[o]}function xi(r,o){return r[o]}function si(r,o){const c=o[r];return Co(c)?c:c[Pr]}function Vr(r){return 64==(64&r[Gi])}function Mo(r,o){return null==o?null:r[o]}function Rs(r){r[Zo]=0}function _a(r,o){r[Ri]+=o;let c=r,h=r[rr];for(;null!==h&&(1===o&&1===c[Ri]||-1===o&&0===c[Ri]);)h[Ri]+=o,c=h,h=h[rr]}const Ai={lFrame:ll(null),bindingsEnabled:!0};function wn(){return Ai.bindingsEnabled}function Tn(){return Ai.lFrame.lView}function sr(){return Ai.lFrame.tView}function ws(r){return Ai.lFrame.contextLView=r,r[Ji]}function nl(r){return Ai.lFrame.contextLView=null,r}function ro(){let r=Fl();for(;null!==r&&64===r.type;)r=r.parent;return r}function Fl(){return Ai.lFrame.currentTNode}function qo(r,o){const c=Ai.lFrame;c.currentTNode=r,c.isParent=o}function il(){return Ai.lFrame.isParent}function rl(){Ai.lFrame.isParent=!1}function Nr(){const r=Ai.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function Ta(){return Ai.lFrame.bindingIndex++}function Ls(r){const o=Ai.lFrame,c=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,c}function Cc(r,o){const c=Ai.lFrame;c.bindingIndex=c.bindingRootIndex=r,Bl(o)}function Bl(r){Ai.lFrame.currentDirectiveIndex=r}function ol(r){const o=Ai.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}function sl(){return Ai.lFrame.currentQueryIndex}function ra(r){Ai.lFrame.currentQueryIndex=r}function oc(r){const o=r[ii];return 2===o.type?o.declTNode:1===o.type?r[bi]:null}function al(r,o,c){if(c&ue.SkipSelf){let g=o,x=r;for(;!(g=g.parent,null!==g||c&ue.Host||(g=oc(x),null===g||(x=x[xo],10&g.type))););if(null===g)return!1;o=g,r=x}const h=Ai.lFrame=sc();return h.currentTNode=o,h.lView=r,!0}function Sa(r){const o=sc(),c=r[ii];Ai.lFrame=o,o.currentTNode=c.firstChild,o.lView=r,o.tView=c,o.contextLView=r,o.bindingIndex=c.bindingStartIndex,o.inI18n=!1}function sc(){const r=Ai.lFrame,o=null===r?null:r.child;return null===o?ll(r):o}function ll(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function ac(){const r=Ai.lFrame;return Ai.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Nl=ac;function vl(){const r=ac();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Lo(){return Ai.lFrame.selectedIndex}function qs(r){Ai.lFrame.selectedIndex=r}function Sr(){const r=Ai.lFrame;return Bn(r.tView,r.selectedIndex)}function Aa(){Ai.lFrame.currentNamespace=$s}function mr(r,o){for(let c=o.directiveStart,h=o.directiveEnd;c<h;c++){const x=r.data[c].type.prototype,{ngAfterContentInit:I,ngAfterContentChecked:B,ngAfterViewInit:H,ngAfterViewChecked:le,ngOnDestroy:Me}=x;I&&(r.contentHooks??(r.contentHooks=[])).push(-c,I),B&&((r.contentHooks??(r.contentHooks=[])).push(c,B),(r.contentCheckHooks??(r.contentCheckHooks=[])).push(c,B)),H&&(r.viewHooks??(r.viewHooks=[])).push(-c,H),le&&((r.viewHooks??(r.viewHooks=[])).push(c,le),(r.viewCheckHooks??(r.viewCheckHooks=[])).push(c,le)),null!=Me&&(r.destroyHooks??(r.destroyHooks=[])).push(c,Me)}}function Ia(r,o,c){se(r,o,3,c)}function cl(r,o,c,h){(3&r[Gi])===c&&se(r,o,c,h)}function U(r,o){let c=r[Gi];(3&c)===o&&(c&=2047,c+=1,r[Gi]=c)}function se(r,o,c,h){const x=h??-1,I=o.length-1;let B=0;for(let H=void 0!==h?65535&r[Zo]:0;H<I;H++)if("number"==typeof o[H+1]){if(B=o[H],null!=h&&B>=h)break}else o[H]<0&&(r[Zo]+=65536),(B<x||-1==x)&&(Z(r,c,o,H),r[Zo]=(4294901760&r[Zo])+H+2),H++}function Z(r,o,c,h){const g=c[h]<0,x=c[h+1],B=r[g?-c[h]:c[h]];if(g){if(r[Gi]>>11<r[Zo]>>16&&(3&r[Gi])===o){r[Gi]+=2048,co(4,B,x);try{x.call(B)}finally{co(5,B,x)}}}else{co(4,B,x);try{x.call(B)}finally{co(5,B,x)}}}const _e=-1;class pt{constructor(o,c,h){this.factory=o,this.resolving=!1,this.canSeeViewProviders=c,this.injectImpl=h}}function hr(r,o,c){let h=0;for(;h<c.length;){const g=c[h];if("number"==typeof g){if(0!==g)break;h++;const x=c[h++],I=c[h++],B=c[h++];r.setAttribute(o,I,B,x)}else{const x=g,I=c[++h];Kr(x)?r.setProperty(o,x,I):r.setAttribute(o,x,I),h++}}return h}function Hn(r){return 3===r||4===r||6===r}function Kr(r){return 64===r.charCodeAt(0)}function vo(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let c=-1;for(let h=0;h<o.length;h++){const g=o[h];"number"==typeof g?c=g:0===c||Fs(r,c,g,null,-1===c||2===c?o[++h]:null)}}return r}function Fs(r,o,c,h,g){let x=0,I=r.length;if(-1===o)I=-1;else for(;x<r.length;){const B=r[x++];if("number"==typeof B){if(B===o){I=-1;break}if(B>o){I=x-1;break}}}for(;x<r.length;){const B=r[x];if("number"==typeof B)break;if(B===c){if(null===h)return void(null!==g&&(r[x+1]=g));if(h===r[x+1])return void(r[x+2]=g)}x++,null!==h&&x++,null!==g&&x++}-1!==I&&(r.splice(I,0,o),x=I+1),r.splice(x++,0,c),null!==h&&r.splice(x++,0,h),null!==g&&r.splice(x++,0,g)}function Fo(r){return r!==_e}function Go(r){return 32767&r}function Cs(r,o){let c=function oa(r){return r>>16}(r),h=o;for(;c>0;)h=h[xo],c--;return h}let $a=!0;function sa(r){const o=$a;return $a=r,o}const bl=255,ms=5;let ru=0;const ya={};function Pa(r,o){const c=zl(r,o);if(-1!==c)return c;const h=o[ii];h.firstCreatePass&&(r.injectorIndex=o.length,Wa(h.data,r),Wa(o,null),Wa(h.blueprint,null));const g=uc(r,o),x=r.injectorIndex;if(Fo(g)){const I=Go(g),B=Cs(g,o),H=B[ii].data;for(let le=0;le<8;le++)o[x+le]=B[I+le]|H[I+le]}return o[x+8]=g,x}function Wa(r,o){r.push(0,0,0,0,0,0,0,0,o)}function zl(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function uc(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let c=0,h=null,g=o;for(;null!==g;){if(h=hn(g),null===h)return _e;if(c++,g=g[xo],-1!==h.injectorIndex)return h.injectorIndex|c<<16}return _e}function Do(r,o,c){!function Za(r,o,c){let h;"string"==typeof c?h=c.charCodeAt(0)||0:c.hasOwnProperty(en)&&(h=c[en]),null==h&&(h=c[en]=ru++);const g=h&bl;o.data[r+(g>>ms)]|=1<<g}(r,o,c)}function wl(r,o,c){if(c&ue.Optional||void 0!==r)return r;mt()}function El(r,o,c,h){if(c&ue.Optional&&void 0===h&&(h=null),!(c&(ue.Self|ue.Host))){const g=r[Pi],x=lt(void 0);try{return g?g.get(o,h,c&ue.Optional):Vt(o,h,c&ue.Optional)}finally{lt(x)}}return wl(h,0,c)}function Ul(r,o,c,h=ue.Default,g){if(null!==r){if(1024&o[Gi]){const I=function Ot(r,o,c,h,g){let x=r,I=o;for(;null!==x&&null!==I&&1024&I[Gi]&&!(256&I[Gi]);){const B=dc(x,I,c,h|ue.Self,ya);if(B!==ya)return B;let H=x.parent;if(!H){const le=I[hs];if(le){const Me=le.get(c,ya,h);if(Me!==ya)return Me}H=hn(I),I=I[xo]}x=H}return g}(r,o,c,h,ya);if(I!==ya)return I}const x=dc(r,o,c,h,ya);if(x!==ya)return x}return El(o,c,h,g)}function dc(r,o,c,h,g){const x=function K(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(en)?r[en]:void 0;return"number"==typeof o?o>=0?o&bl:ie:o}(c);if("function"==typeof x){if(!al(o,r,h))return h&ue.Host?wl(g,0,h):El(o,c,h,g);try{const I=x(h);if(null!=I||h&ue.Optional)return I;mt()}finally{Nl()}}else if("number"==typeof x){let I=null,B=zl(r,o),H=_e,le=h&ue.Host?o[to][bi]:null;for((-1===B||h&ue.SkipSelf)&&(H=-1===B?uc(r,o):o[B+8],H!==_e&&T(h,!1)?(I=o[ii],B=Go(H),o=Cs(H,o)):B=-1);-1!==B;){const Me=o[ii];if(S(x,B,Me.data)){const rt=hc(B,o,c,I,h,le);if(rt!==ya)return rt}H=o[B+8],H!==_e&&T(h,o[ii].data[B+8]===le)&&S(x,B,o)?(I=Me,B=Go(H),o=Cs(H,o)):B=-1}}return g}function hc(r,o,c,h,g,x){const I=o[ii],B=I.data[r+8],Me=aa(B,I,c,null==h?fo(B)&&$a:h!=I&&0!=(3&B.type),g&ue.Host&&x===B);return null!==Me?Oa(o,I,Me,B):ya}function aa(r,o,c,h,g){const x=r.providerIndexes,I=o.data,B=1048575&x,H=r.directiveStart,Me=x>>20,Ht=g?B+Me:r.directiveEnd;for(let mn=h?B:B+Me;mn<Ht;mn++){const Vn=I[mn];if(mn<H&&c===Vn||mn>=H&&Vn.type===c)return mn}if(g){const mn=I[H];if(mn&&no(mn)&&mn.type===c)return H}return null}function Oa(r,o,c,h){let g=r[c];const x=o.data;if(function En(r){return r instanceof pt}(g)){const I=g;I.resolving&&function ot(r,o){const c=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new et(-200,`Circular dependency in DI detected for ${r}${c}`)}(function an(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Gt(r)}(x[c]));const B=sa(I.canSeeViewProviders);I.resolving=!0;const H=I.injectImpl?lt(I.injectImpl):null;al(r,h,ue.Default);try{g=r[c]=I.factory(void 0,x,r,h),o.firstCreatePass&&c>=h.directiveStart&&function cc(r,o,c){const{ngOnChanges:h,ngOnInit:g,ngDoCheck:x}=o.type.prototype;if(h){const I=na(o);(c.preOrderHooks??(c.preOrderHooks=[])).push(r,I),(c.preOrderCheckHooks??(c.preOrderCheckHooks=[])).push(r,I)}g&&(c.preOrderHooks??(c.preOrderHooks=[])).push(0-r,g),x&&((c.preOrderHooks??(c.preOrderHooks=[])).push(r,x),(c.preOrderCheckHooks??(c.preOrderCheckHooks=[])).push(r,x))}(c,x[c],o)}finally{null!==H&&lt(H),sa(B),I.resolving=!1,Nl()}}return g}function S(r,o,c){return!!(c[o+(r>>ms)]&1<<r)}function T(r,o){return!(r&ue.Self||r&ue.Host&&o)}class V{constructor(o,c){this._tNode=o,this._lView=c}get(o,c,h){return Ul(this._tNode,this._lView,o,De(h),c)}}function ie(){return new V(ro(),Tn())}function Oe(r){return Q(()=>{const o=r.prototype.constructor,c=o[ut]||Je(o),h=Object.prototype;let g=Object.getPrototypeOf(r.prototype).constructor;for(;g&&g!==h;){const x=g[ut]||Je(g);if(x&&x!==c)return x;g=Object.getPrototypeOf(g)}return x=>new x})}function Je(r){return Ve(r)?()=>{const o=Je(qe(r));return o&&o()}:Ur(r)}function hn(r){const o=r[ii],c=o.type;return 2===c?o.declTNode:1===c?r[bi]:null}function On(r){return function xl(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const c=r.attrs;if(c){const h=c.length;let g=0;for(;g<h;){const x=c[g];if(Hn(x))break;if(0===x)g+=2;else if("number"==typeof x)for(g++;g<h&&"string"==typeof c[g];)g++;else{if(x===o)return c[g+1];g+=2}}}return null}(ro(),r)}const ui="__parameters__";function Zi(r,o,c){return Q(()=>{const h=function Ti(r){return function(...c){if(r){const h=r(...c);for(const g in h)this[g]=h[g]}}}(o);function g(...x){if(this instanceof g)return h.apply(this,x),this;const I=new g(...x);return B.annotation=I,B;function B(H,le,Me){const rt=H.hasOwnProperty(ui)?H[ui]:Object.defineProperty(H,ui,{value:[]})[ui];for(;rt.length<=Me;)rt.push(null);return(rt[Me]=rt[Me]||[]).push(I),H}}return c&&(g.prototype=Object.create(c.prototype)),g.prototype.ngMetadataName=r,g.annotationCls=g,g})}class or{constructor(o,c){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof c?this.__NG_ELEMENT_ID__=c:void 0!==c&&(this.\u0275prov=ve({token:this,providedIn:c.providedIn||"root",factory:c.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ni(r,o){r.forEach(c=>Array.isArray(c)?Ni(c,o):o(c))}function Mr(r,o,c){o>=r.length?r.push(c):r.splice(o,0,c)}function So(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function P(r,o){const c=[];for(let h=0;h<r;h++)c.push(o);return c}function u(r,o,c){let h=l(r,o);return h>=0?r[1|h]=c:(h=~h,function z(r,o,c,h){let g=r.length;if(g==o)r.push(c,h);else if(1===g)r.push(h,r[0]),r[0]=c;else{for(g--,r.push(r[g-1],r[g]);g>o;)r[g]=r[g-2],g--;r[o]=c,r[o+1]=h}}(r,h,o,c)),h}function t(r,o){const c=l(r,o);if(c>=0)return r[1|c]}function l(r,o){return function _(r,o,c){let h=0,g=r.length>>c;for(;g!==h;){const x=h+(g-h>>1),I=r[x<<c];if(o===I)return x<<c;I>o?g=x:h=x+1}return~(g<<c)}(r,o,1)}const Be=be(Zi("Optional"),8),Ie=be(Zi("SkipSelf"),4);var Oo=(()=>((Oo=Oo||{})[Oo.Important=1]="Important",Oo[Oo.DashCase=2]="DashCase",Oo))();const Xa=new Map;let Dl=0;const dh="__ngContext__";function ca(r,o){Co(o)?(r[dh]=o[Hs],function jc(r){Xa.set(r[Hs],r)}(o)):r[dh]=o}let hh;function mp(r,o){return hh(r,o)}function Uu(r){const o=r[rr];return lo(o)?o[rr]:o}function Gl(r){return _p(r[Br])}function Vu(r){return _p(r[Kn])}function _p(r){for(;null!==r&&!lo(r);)r=r[Kn];return r}function lu(r,o,c,h,g){if(null!=h){let x,I=!1;lo(h)?x=h:Co(h)&&(I=!0,h=h[Pr]);const B=Pt(h);0===r&&null!==c?null==g?rm(o,c,B):cu(o,c,B,g||null,!0):1===r&&null!==c?cu(o,c,B,g||null,!0):2===r?function gh(r,o,c){const h=du(r,o);h&&function qi(r,o,c,h){r.removeChild(o,c,h)}(r,h,o,c)}(o,B,I):3===r&&o.destroyNode(B),null!=x&&function n_(r,o,c,h,g){const x=c[Or];x!==Pt(c)&&lu(o,r,h,x,g);for(let B=dr;B<c.length;B++){const H=c[B];hu(H[ii],H,r,o,h,x)}}(o,r,x,c,g)}}function Cd(r,o,c){return r.createElement(o,c)}function $c(r,o){const c=r[ys],h=c.indexOf(o),g=o[rr];512&o[Gi]&&(o[Gi]&=-513,_a(g,-1)),c.splice(h,1)}function vp(r,o){if(r.length<=dr)return;const c=dr+o,h=r[c];if(h){const g=h[ts];null!==g&&g!==r&&$c(g,h),o>0&&(r[c-1][Kn]=h[Kn]);const x=So(r,dr+o);!function Md(r,o){hu(r,o,o[$i],2,null,null),o[Pr]=null,o[bi]=null}(h[ii],h);const I=x[Vo];null!==I&&I.detachView(x[ii]),h[rr]=null,h[Kn]=null,h[Gi]&=-65}return h}function nm(r,o){if(!(128&o[Gi])){const c=o[$i];c.destroyNode&&hu(r,o,c,3,null,null),function $l(r){let o=r[Br];if(!o)return bp(r[ii],r);for(;o;){let c=null;if(Co(o))c=o[Br];else{const h=o[dr];h&&(c=h)}if(!c){for(;o&&!o[Kn]&&o!==r;)Co(o)&&bp(o[ii],o),o=o[rr];null===o&&(o=r),Co(o)&&bp(o[ii],o),c=o&&o[Kn]}o=c}}(o)}}function bp(r,o){if(!(128&o[Gi])){o[Gi]&=-65,o[Gi]|=128,function im(r,o){let c;if(null!=r&&null!=(c=r.destroyHooks))for(let h=0;h<c.length;h+=2){const g=o[c[h]];if(!(g instanceof pt)){const x=c[h+1];if(Array.isArray(x))for(let I=0;I<x.length;I+=2){const B=g[x[I]],H=x[I+1];co(4,B,H);try{H.call(B)}finally{co(5,B,H)}}else{co(4,g,x);try{x.call(g)}finally{co(5,g,x)}}}}}(r,o),function t_(r,o){const c=r.cleanup,h=o[Fr];let g=-1;if(null!==c)for(let x=0;x<c.length-1;x+=2)if("string"==typeof c[x]){const I=c[x+3];I>=0?h[g=I]():h[g=-I].unsubscribe(),x+=2}else{const I=h[g=c[x+1]];c[x].call(I)}if(null!==h){for(let x=g+1;x<h.length;x++)(0,h[x])();o[Fr]=null}}(r,o),1===o[ii].type&&o[$i].destroy();const c=o[ts];if(null!==c&&lo(o[rr])){c!==o[rr]&&$c(c,o);const h=o[Vo];null!==h&&h.detachView(r)}!function wd(r){Xa.delete(r[Hs])}(o)}}function Dd(r,o,c){return function Tl(r,o,c){let h=o;for(;null!==h&&40&h.type;)h=(o=h).parent;if(null===h)return c[Pr];{const{componentOffset:g}=h;if(g>-1){const{encapsulation:x}=r.data[h.directiveStart+g];if(x===ye.None||x===ye.Emulated)return null}return Ke(h,c)}}(r,o.parent,c)}function cu(r,o,c,h,g){r.insertBefore(o,c,h,g)}function rm(r,o,c){r.appendChild(o,c)}function Yo(r,o,c,h,g){null!==h?cu(r,o,c,h,g):rm(r,o,c)}function du(r,o){return r.parentNode(o)}function xp(r,o,c){return Zl(r,o,c)}let Sl,fc,Mp,Gu,Zl=function mh(r,o,c){return 40&r.type?Ke(r,c):null};function ba(r,o,c,h){const g=Dd(r,h,o),x=o[$i],B=xp(h.parent||o[bi],h,o);if(null!=g)if(Array.isArray(c))for(let H=0;H<c.length;H++)Yo(x,g,c[H],B,!1);else Yo(x,g,c,B,!1);void 0!==Sl&&Sl(x,h,o,c,g)}function _s(r,o){if(null!==o){const c=o.type;if(3&c)return Ke(o,r);if(4&c)return Al(-1,r[o.index]);if(8&c){const h=o.child;if(null!==h)return _s(r,h);{const g=r[o.index];return lo(g)?Al(-1,g):Pt(g)}}if(32&c)return mp(o,r)()||Pt(r[o.index]);{const h=wp(r,o);return null!==h?Array.isArray(h)?h[0]:_s(Uu(r[to]),h):_s(r,o.next)}}return null}function wp(r,o){return null!==o?r[to][bi].projection[o.projection]:null}function Al(r,o){const c=dr+r+1;if(c<o.length){const h=o[c],g=h[ii].firstChild;if(null!==g)return _s(h,g)}return o[Or]}function Zc(r,o,c,h,g,x,I){for(;null!=c;){const B=h[c.index],H=c.type;if(I&&0===o&&(B&&ca(Pt(B),h),c.flags|=2),32!=(32&c.flags))if(8&H)Zc(r,o,c.child,h,g,x,!1),lu(o,r,g,B,x);else if(32&H){const le=mp(c,h);let Me;for(;Me=le();)lu(o,r,g,Me,x);lu(o,r,g,B,x)}else 16&H?_h(r,o,h,c,g,x):lu(o,r,g,B,x);c=I?c.projectionNext:c.next}}function hu(r,o,c,h,g,x){Zc(c,h,r.firstChild,o,g,x,!1)}function _h(r,o,c,h,g,x){const I=c[to],H=I[bi].projection[h.projection];if(Array.isArray(H))for(let le=0;le<H.length;le++)lu(o,r,g,H[le],x);else Zc(r,o,H,I[rr],g,x,!0)}function am(r,o,c){""===c?r.removeAttribute(o,"class"):r.setAttribute(o,"class",c)}function pc(r,o,c){const{mergedAttrs:h,classes:g,styles:x}=c;null!==h&&hr(r,o,h),null!==g&&am(r,o,g),null!==x&&function sm(r,o,c){r.setAttribute(o,"style",c)}(r,o,x)}function Tc(r){return function Hu(){if(void 0===fc&&(fc=null,Fn.trustedTypes))try{fc=Fn.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return fc}()?.createHTML(r)||r}function Dp(r){Mp=r}function Sp(r){return function yh(){if(void 0===Gu&&(Gu=null,Fn.trustedTypes))try{Gu=Fn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Gu}()?.createScriptURL(r)||r}class pu{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ft})`}}class $u extends pu{getTypeName(){return"HTML"}}class vh extends pu{getTypeName(){return"Style"}}class dm extends pu{getTypeName(){return"Script"}}class hm extends pu{getTypeName(){return"URL"}}class i_ extends pu{getTypeName(){return"ResourceURL"}}function Sc(r){return r instanceof pu?r.changingThisBreaksApplicationSecurity:r}function Ac(r,o){const c=function Qa(r){return r instanceof pu&&r.getTypeName()||null}(r);if(null!=c&&c!==o){if("ResourceURL"===c&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${c} (see ${ft})`)}return c===o}function pm(r){return new $u(r)}function fm(r){return new vh(r)}function Wl(r){return new dm(r)}function Ap(r){return new hm(r)}function fu(r){return new i_(r)}class mu{constructor(o){this.inertDocumentHelper=o}getInertBodyElement(o){o="<body><remove></remove>"+o;try{const c=(new window.DOMParser).parseFromString(Tc(o),"text/html").body;return null===c?this.inertDocumentHelper.getInertBodyElement(o):(c.removeChild(c.firstChild),c)}catch{return null}}}class Ip{constructor(o){this.defaultDoc=o,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(o){const c=this.inertDocument.createElement("template");return c.innerHTML=Tc(o),c}}const mm=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Td(r){return(r=String(r)).match(mm)?r:"unsafe:"+r}function Ic(r){const o={};for(const c of r.split(","))o[c]=!0;return o}function gu(...r){const o={};for(const c of r)for(const h in c)c.hasOwnProperty(h)&&(o[h]=!0);return o}const Pp=Ic("area,br,col,hr,img,wbr"),Wu=Ic("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),_u=Ic("rp,rt"),yu=gu(Pp,gu(Wu,Ic("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),gu(_u,Ic("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),gu(_u,Wu)),vu=Ic("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ua=gu(vu,Ic("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ic("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Pl=Ic("script,style,template");class Op{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(o){let c=o.firstChild,h=!0;for(;c;)if(c.nodeType===Node.ELEMENT_NODE?h=this.startElement(c):c.nodeType===Node.TEXT_NODE?this.chars(c.nodeValue):this.sanitizedSomething=!0,h&&c.firstChild)c=c.firstChild;else for(;c;){c.nodeType===Node.ELEMENT_NODE&&this.endElement(c);let g=this.checkClobberedElement(c,c.nextSibling);if(g){c=g;break}c=this.checkClobberedElement(c,c.parentNode)}return this.buf.join("")}startElement(o){const c=o.nodeName.toLowerCase();if(!yu.hasOwnProperty(c))return this.sanitizedSomething=!0,!Pl.hasOwnProperty(c);this.buf.push("<"),this.buf.push(c);const h=o.attributes;for(let g=0;g<h.length;g++){const x=h.item(g),I=x.name,B=I.toLowerCase();if(!ua.hasOwnProperty(B)){this.sanitizedSomething=!0;continue}let H=x.value;vu[B]&&(H=Td(H)),this.buf.push(" ",I,'="',qu(H),'"')}return this.buf.push(">"),!0}endElement(o){const c=o.nodeName.toLowerCase();yu.hasOwnProperty(c)&&!Pp.hasOwnProperty(c)&&(this.buf.push("</"),this.buf.push(c),this.buf.push(">"))}chars(o){this.buf.push(qu(o))}checkClobberedElement(o,c){if(c&&(o.compareDocumentPosition(c)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${o.outerHTML}`);return c}}const $o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_m=/([^\#-~ |!])/g;function qu(r){return r.replace(/&/g,"&amp;").replace($o,function(o){return"&#"+(1024*(o.charCodeAt(0)-55296)+(o.charCodeAt(1)-56320)+65536)+";"}).replace(_m,function(o){return"&#"+o.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ja;function ym(r,o){let c=null;try{Ja=Ja||function Zu(r){const o=new Ip(r);return function bh(){try{return!!(new window.DOMParser).parseFromString(Tc(""),"text/html")}catch{return!1}}()?new mu(o):o}(r);let h=o?String(o):"";c=Ja.getInertBodyElement(h);let g=5,x=h;do{if(0===g)throw new Error("Failed to sanitize html because the input is unstable");g--,h=x,x=c.innerHTML,c=Ja.getInertBodyElement(h)}while(h!==x);return Tc((new Op).sanitizeChildren(Rp(c)||c))}finally{if(c){const h=Rp(c)||c;for(;h.firstChild;)h.removeChild(h.firstChild)}}}function Rp(r){return"content"in r&&function vm(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var ls=(()=>((ls=ls||{})[ls.NONE=0]="NONE",ls[ls.HTML=1]="HTML",ls[ls.STYLE=2]="STYLE",ls[ls.SCRIPT=3]="SCRIPT",ls[ls.URL=4]="URL",ls[ls.RESOURCE_URL=5]="RESOURCE_URL",ls))();function wh(r){const o=Sd();return o?o.sanitize(ls.URL,r)||"":Ac(r,"URL")?Sc(r):Td(Gt(r))}function kp(r){const o=Sd();if(o)return Sp(o.sanitize(ls.RESOURCE_URL,r)||"");if(Ac(r,"ResourceURL"))return Sp(Sc(r));throw new et(904,!1)}function Eh(r,o,c){return function Fp(r,o){return"src"===o&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===o&&("base"===r||"link"===r)?kp:wh}(o,c)(r)}function Sd(){const r=Tn();return r&&r[Eo]}const Ch=new or("ENVIRONMENT_INITIALIZER"),wm=new or("INJECTOR",-1),Em=new or("INJECTOR_DEF_TYPES");class Bp{get(o,c=Qt){if(c===Qt){const h=new Error(`NullInjectorError: No provider for ${Ce(o)}!`);throw h.name="NullInjectorError",h}return c}}function Cm(r){return{\u0275providers:r}}function Mm(...r){return{\u0275providers:Mh(0,r),\u0275fromNgModule:!0}}function Mh(r,...o){const c=[],h=new Set;let g;return Ni(o,x=>{const I=x;xa(I,c,[],h)&&(g||(g=[]),g.push(I))}),void 0!==g&&mc(g,c),c}function mc(r,o){for(let c=0;c<r.length;c++){const{providers:g}=r[c];Ad(g,x=>{o.push(x)})}}function xa(r,o,c,h){if(!(r=qe(r)))return!1;let g=null,x=vt(r);const I=!x&&Ki(r);if(x||I){if(I&&!I.standalone)return!1;g=r}else{const H=r.ngModule;if(x=vt(H),!x)return!1;g=H}const B=h.has(g);if(I){if(B)return!1;if(h.add(g),I.dependencies){const H="function"==typeof I.dependencies?I.dependencies():I.dependencies;for(const le of H)xa(le,o,c,h)}}else{if(!x)return!1;{if(null!=x.imports&&!B){let le;h.add(g);try{Ni(x.imports,Me=>{xa(Me,o,c,h)&&(le||(le=[]),le.push(Me))})}finally{}void 0!==le&&mc(le,o)}if(!B){const le=Ur(g)||(()=>new g);o.push({provide:g,useFactory:le,deps:Ye},{provide:Em,useValue:g,multi:!0},{provide:Ch,useValue:()=>_t(g),multi:!0})}const H=x.providers;null==H||B||Ad(H,Me=>{o.push(Me)})}}return g!==r&&void 0!==r.providers}function Ad(r,o){for(let c of r)tt(c)&&(c=c.\u0275providers),Array.isArray(c)?Ad(c,o):o(c)}const a_=Qe({provide:String,useValue:Qe});function Np(r){return null!==r&&"object"==typeof r&&a_ in r}function gc(r){return"function"==typeof r}const Pc=new or("Set Injector scope."),Yc={},l_={};let zp;function Dh(){return void 0===zp&&(zp=new Bp),zp}class xu{}class Sm extends xu{get destroyed(){return this._destroyed}constructor(o,c,h,g){super(),this.parent=c,this.source=h,this.scopes=g,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Sh(o,I=>this.processProvider(I)),this.records.set(wm,ql(void 0,this)),g.has("environment")&&this.records.set(xu,ql(void 0,this));const x=this.records.get(Pc);null!=x&&"string"==typeof x.value&&this.scopes.add(x.value),this.injectorDefTypes=new Set(this.get(Em.multi,Ye,ue.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const c=Kt(this),h=lt(void 0);try{return o()}finally{Kt(c),lt(h)}}get(o,c=Qt,h=ue.Default){this.assertNotDestroyed(),h=De(h);const g=Kt(this),x=lt(void 0);try{if(!(h&ue.SkipSelf)){let B=this.records.get(o);if(void 0===B){const H=function Th(r){return"function"==typeof r||"object"==typeof r&&r instanceof or}(o)&&fn(o);B=H&&this.injectableDefInScope(H)?ql(Up(o),Yc):null,this.records.set(o,B)}if(null!=B)return this.hydrate(o,B)}return(h&ue.Self?Dh():this.parent).get(o,c=h&ue.Optional&&c===Qt?null:c)}catch(I){if("NullInjectorError"===I.name){if((I[ln]=I[ln]||[]).unshift(Ce(o)),g)throw I;return function $t(r,o,c,h){const g=r[ln];throw o[Ii]&&g.unshift(o[Ii]),r.message=function pe(r,o,c,h=null){r=r&&"\n"===r.charAt(0)&&r.charAt(1)==Qi?r.slice(2):r;let g=Ce(o);if(Array.isArray(o))g=o.map(Ce).join(" -> ");else if("object"==typeof o){let x=[];for(let I in o)if(o.hasOwnProperty(I)){let B=o[I];x.push(I+":"+("string"==typeof B?JSON.stringify(B):Ce(B)))}g=`{${x.join(", ")}}`}return`${c}${h?"("+h+")":""}[${g}]: ${r.replace(Li,"\n  ")}`}("\n"+r.message,g,c,h),r[mi]=g,r[ln]=null,r}(I,o,"R3InjectorError",this.source)}throw I}finally{lt(x),Kt(g)}}resolveInjectorInitializers(){const o=Kt(this),c=lt(void 0);try{const h=this.get(Ch.multi,Ye,ue.Self);for(const g of h)g()}finally{Kt(o),lt(c)}}toString(){const o=[],c=this.records;for(const h of c.keys())o.push(Ce(h));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new et(205,!1)}processProvider(o){let c=gc(o=qe(o))?o:qe(o&&o.provide);const h=function Vp(r){return Np(r)?ql(void 0,r.useValue):ql(Am(r),Yc)}(o);if(gc(o)||!0!==o.multi)this.records.get(c);else{let g=this.records.get(c);g||(g=ql(void 0,Yc,!0),g.factory=()=>oe(g.multi),this.records.set(c,g)),c=o,g.multi.push(o)}this.records.set(c,h)}hydrate(o,c){return c.value===Yc&&(c.value=l_,c.value=c.factory()),"object"==typeof c.value&&c.value&&function Ko(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(c.value)&&this._ngOnDestroyHooks.add(c.value),c.value}injectableDefInScope(o){if(!o.providedIn)return!1;const c=qe(o.providedIn);return"string"==typeof c?"any"===c||this.scopes.has(c):this.injectorDefTypes.has(c)}}function Up(r){const o=fn(r),c=null!==o?o.factory:Ur(r);if(null!==c)return c;if(r instanceof or)throw new et(204,!1);if(r instanceof Function)return function c_(r){const o=r.length;if(o>0)throw P(o,"?"),new et(204,!1);const c=function Se(r){return r&&(r[jn]||r[Bi])||null}(r);return null!==c?()=>c.factory(r):()=>new r}(r);throw new et(204,!1)}function Am(r,o,c){let h;if(gc(r)){const g=qe(r);return Ur(g)||Up(g)}if(Np(r))h=()=>qe(r.useValue);else if(function Yu(r){return!(!r||!r.useFactory)}(r))h=()=>r.useFactory(...oe(r.deps||[]));else if(function Dm(r){return!(!r||!r.useExisting)}(r))h=()=>_t(qe(r.useExisting));else{const g=qe(r&&(r.useClass||r.provide));if(!function u_(r){return!!r.deps}(r))return Ur(g)||Up(g);h=()=>new g(...oe(r.deps))}return h}function ql(r,o,c=!1){return{factory:r,value:o,multi:c?[]:void 0}}function Sh(r,o){for(const c of r)Array.isArray(c)?Sh(c,o):c&&tt(c)?Sh(c.\u0275providers,o):o(c)}class Ah{}class Id{}class Od{resolveComponentFactory(o){throw function Pd(r){const o=Error(`No component factory found for ${Ce(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let wu=(()=>{class r{}return r.NULL=new Od,r})();function Hp(){return Ku(ro(),Tn())}function Ku(r,o){return new Xu(Ke(r,o))}let Xu=(()=>{class r{constructor(c){this.nativeElement=c}}return r.__NG_ELEMENT_ID__=Hp,r})();function Rd(r){return r instanceof Xu?r.nativeElement:r}class Im{}let Gp=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function h_(){const r=Tn(),c=si(ro().index,r);return(Co(c)?c:r)[$i]}(),r})(),$p=(()=>{class r{}return r.\u0275prov=ve({token:r,providedIn:"root",factory:()=>null}),r})();class Ih{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Ph=new Ih("15.2.9"),Zp={},Wp="ngOriginalError";function qp(r){return r[Wp]}class kd{constructor(){this._console=console}handleError(o){const c=this._findOriginalError(o);this._console.error("ERROR",o),c&&this._console.error("ORIGINAL ERROR",c)}_findOriginalError(o){let c=o&&qp(o);for(;c&&qp(c);)c=qp(c);return c||null}}function _c(r){return r instanceof Function?r():r}function Ld(r,o,c){let h=r.length;for(;;){const g=r.indexOf(o,c);if(-1===g)return g;if(0===g||r.charCodeAt(g-1)<=32){const x=o.length;if(g+x===h||r.charCodeAt(g+x)<=32)return g}c=g+1}}const Rm="ng-template";function v_(r,o,c){let h=0,g=!0;for(;h<r.length;){let x=r[h++];if("string"==typeof x&&g){const I=r[h++];if(c&&"class"===x&&-1!==Ld(I.toLowerCase(),o,0))return!0}else{if(1===x){for(;h<r.length&&"string"==typeof(x=r[h++]);)if(x.toLowerCase()===o)return!0;return!1}"number"==typeof x&&(g=!1)}}return!1}function ed(r){return 4===r.type&&r.value!==Rm}function Fd(r,o,c){return o===(4!==r.type||c?r.value:Rm)}function km(r,o,c){let h=4;const g=r.attrs||[],x=function Nm(r){for(let o=0;o<r.length;o++)if(Hn(r[o]))return o;return r.length}(g);let I=!1;for(let B=0;B<o.length;B++){const H=o[B];if("number"!=typeof H){if(!I)if(4&h){if(h=2|1&h,""!==H&&!Fd(r,H,c)||""===H&&1===o.length){if(za(h))return!1;I=!0}}else{const le=8&h?H:o[++B];if(8&h&&null!==r.attrs){if(!v_(r.attrs,le,c)){if(za(h))return!1;I=!0}continue}const rt=Lm(8&h?"class":H,g,ed(r),c);if(-1===rt){if(za(h))return!1;I=!0;continue}if(""!==le){let Ht;Ht=rt>x?"":g[rt+1].toLowerCase();const mn=8&h?Ht:null;if(mn&&-1!==Ld(mn,le,0)||2&h&&le!==Ht){if(za(h))return!1;I=!0}}}}else{if(!I&&!za(h)&&!za(H))return!1;if(I&&za(H))continue;I=!1,h=H|1&h}}return za(h)||I}function za(r){return 0==(1&r)}function Lm(r,o,c,h){if(null===o)return-1;let g=0;if(h||!c){let x=!1;for(;g<o.length;){const I=o[g];if(I===r)return g;if(3===I||6===I)x=!0;else{if(1===I||2===I){let B=o[++g];for(;"string"==typeof B;)B=o[++g];continue}if(4===I)break;if(0===I){g+=4;continue}}g+=x?1:2}return-1}return function zm(r,o){let c=r.indexOf(4);if(c>-1)for(c++;c<r.length;){const h=r[c];if("number"==typeof h)return-1;if(h===o)return c;c++}return-1}(o,r)}function Fm(r,o,c=!1){for(let h=0;h<o.length;h++)if(km(r,o[h],c))return!0;return!1}function Um(r,o){e:for(let c=0;c<o.length;c++){const h=o[c];if(r.length===h.length){for(let g=0;g<r.length;g++)if(r[g]!==h[g])continue e;return!0}}return!1}function Kp(r,o){return r?":not("+o.trim()+")":o}function Vm(r){let o=r[0],c=1,h=2,g="",x=!1;for(;c<r.length;){let I=r[c];if("string"==typeof I)if(2&h){const B=r[++c];g+="["+I+(B.length>0?'="'+B+'"':"")+"]"}else 8&h?g+="."+I:4&h&&(g+=" "+I);else""!==g&&!za(I)&&(o+=Kp(x,g),g=""),h=I,x=x||!za(h);c++}return""!==g&&(o+=Kp(x,g)),o}const gr={};function Bd(r){Xp(sr(),Tn(),Lo()+r,!1)}function Xp(r,o,c,h){if(!h)if(3==(3&o[Gi])){const x=r.preOrderCheckHooks;null!==x&&Ia(o,x,c)}else{const x=r.preOrderHooks;null!==x&&cl(o,x,0,c)}qs(c)}function Hm(r,o=null,c=null,h){const g=Gm(r,o,c,h);return g.resolveInjectorInitializers(),g}function Gm(r,o=null,c=null,h,g=new Set){const x=[c||Ye,Mm(r)];return h=h||("object"==typeof r?void 0:Ce(r)),new Sm(x,o||Dh(),h||null,g)}let Eu=(()=>{class r{static create(c,h){if(Array.isArray(c))return Hm({name:""},h,c,"");{const g=c.name??"";return Hm({name:g},c.parent,c.providers,g)}}}return r.THROW_IF_NOT_FOUND=Qt,r.NULL=new Bp,r.\u0275prov=ve({token:r,providedIn:"any",factory:()=>_t(wm)}),r.__NG_ELEMENT_ID__=-1,r})();function Mu(r,o=ue.Default){const c=Tn();return null===c?_t(r,o):Ul(ro(),c,qe(r),o)}function Ym(){throw new Error("invalid")}function Km(r,o){const c=r.contentQueries;if(null!==c)for(let h=0;h<c.length;h+=2){const x=c[h+1];if(-1!==x){const I=r.data[x];ra(c[h]),I.contentQueries(2,o[x],x)}}}function Nh(r,o,c,h,g,x,I,B,H,le,Me){const rt=o.blueprint.slice();return rt[Pr]=g,rt[Gi]=76|h,(null!==Me||r&&1024&r[Gi])&&(rt[Gi]|=1024),Rs(rt),rt[rr]=rt[xo]=r,rt[Ji]=c,rt[wo]=I||r&&r[wo],rt[$i]=B||r&&r[$i],rt[Eo]=H||r&&r[Eo]||null,rt[Pi]=le||r&&r[Pi]||null,rt[bi]=x,rt[Hs]=function su(){return Dl++}(),rt[hs]=Me,rt[to]=2==o.type?r[to]:rt,rt}function sd(r,o,c,h,g){let x=r.data[o];if(null===x)x=function tf(r,o,c,h,g){const x=Fl(),I=il(),H=r.data[o]=function cd(r,o,c,h,g,x){return{type:c,index:h,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:g,attrs:x,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,I?x:x&&x.parent,c,o,h,g);return null===r.firstChild&&(r.firstChild=H),null!==x&&(I?null==x.child&&null!==H.parent&&(x.child=H):null===x.next&&(x.next=H,H.prev=x)),H}(r,o,c,h,g),function _l(){return Ai.lFrame.inI18n}()&&(x.flags|=32);else if(64&x.type){x.type=c,x.value=h,x.attrs=g;const I=function os(){const r=Ai.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();x.injectorIndex=null===I?-1:I.injectorIndex}return qo(x,!0),x}function jd(r,o,c,h){if(0===c)return-1;const g=o.length;for(let x=0;x<c;x++)o.push(h),r.blueprint.push(h),r.data.push(null);return g}function ad(r,o,c){Sa(o);try{const h=r.viewQuery;null!==h&&qd(1,h,c);const g=r.template;null!==g&&nf(r,o,g,1,c),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Km(r,o),r.staticViewQueries&&qd(2,r.viewQuery,c);const x=r.components;null!==x&&function R_(r,o){for(let c=0;c<o.length;c++)U_(r,o[c])}(o,x)}catch(h){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),h}finally{o[Gi]&=-5,vl()}}function Rc(r,o,c,h){const g=o[Gi];if(128!=(128&g)){Sa(o);try{Rs(o),function ks(r){return Ai.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==c&&nf(r,o,c,2,h);const I=3==(3&g);if(I){const le=r.preOrderCheckHooks;null!==le&&Ia(o,le,null)}else{const le=r.preOrderHooks;null!==le&&cl(o,le,0,null),U(o,0)}if(function og(r){for(let o=Gl(r);null!==o;o=Vu(o)){if(!o[po])continue;const c=o[ys];for(let h=0;h<c.length;h++){const g=c[h];512&g[Gi]||_a(g[rr],1),g[Gi]|=512}}}(o),function Hh(r){for(let o=Gl(r);null!==o;o=Vu(o))for(let c=dr;c<o.length;c++){const h=o[c],g=h[ii];Vr(h)&&Rc(g,h,g.template,h[Ji])}}(o),null!==r.contentQueries&&Km(r,o),I){const le=r.contentCheckHooks;null!==le&&Ia(o,le)}else{const le=r.contentHooks;null!==le&&cl(o,le,1),U(o,1)}!function P_(r,o){const c=r.hostBindingOpCodes;if(null!==c)try{for(let h=0;h<c.length;h++){const g=c[h];if(g<0)qs(~g);else{const x=g,I=c[++h],B=c[++h];Cc(I,x),B(2,o[x])}}}finally{qs(-1)}}(r,o);const B=r.components;null!==B&&function O_(r,o){for(let c=0;c<o.length;c++)Gh(r,o[c])}(o,B);const H=r.viewQuery;if(null!==H&&qd(2,H,h),I){const le=r.viewCheckHooks;null!==le&&Ia(o,le)}else{const le=r.viewHooks;null!==le&&cl(o,le,2),U(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),o[Gi]&=-41,512&o[Gi]&&(o[Gi]&=-513,_a(o[rr],-1))}finally{vl()}}}function nf(r,o,c,h,g){const x=Lo(),I=2&h;try{qs(-1),I&&o.length>Dr&&Xp(r,o,Dr,!1),co(I?2:0,g),c(h,g)}finally{qs(x),co(I?3:1,g)}}function rf(r,o,c){if(jr(o)){const g=o.directiveEnd;for(let x=o.directiveStart;x<g;x++){const I=r.data[x];I.contentQueries&&I.contentQueries(1,c[x],x)}}}function sf(r,o,c){wn()&&(function kc(r,o,c,h){const g=c.directiveStart,x=c.directiveEnd;fo(c)&&function Zd(r,o,c){const h=Ke(o,r),g=zh(c),x=r[wo],I=$h(r,Nh(r,g,null,c.onPush?32:16,h,o,x,x.createRenderer(h,c),null,null,null));r[o.index]=I}(o,c,r.data[g+c.componentOffset]),r.firstCreatePass||Pa(c,o),ca(h,o);const I=c.initialInputs;for(let B=g;B<x;B++){const H=r.data[B],le=Oa(o,r,B,c);ca(le,o),null!==I&&uf(0,B-g,le,H,0,I),no(H)&&(si(c.index,o)[Ji]=Oa(o,r,B,c))}}(r,o,c,Ke(c,o)),64==(64&c.flags)&&cf(r,o,c))}function af(r,o,c=Ke){const h=o.localNames;if(null!==h){let g=o.index+1;for(let x=0;x<h.length;x+=2){const I=h[x+1],B=-1===I?c(o,r):r[I];r[g++]=B}}}function zh(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=Hd(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function Hd(r,o,c,h,g,x,I,B,H,le){const Me=Dr+h,rt=Me+g,Ht=function Xm(r,o){const c=[];for(let h=0;h<o;h++)c.push(h<r?null:gr);return c}(Me,rt),mn="function"==typeof le?le():le;return Ht[ii]={type:r,blueprint:Ht,template:c,queries:null,viewQuery:B,declTNode:o,data:Ht.slice().fill(null,Me),bindingStartIndex:Me,expandoStartIndex:rt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof x?x():x,pipeRegistry:"function"==typeof I?I():I,firstChild:null,schemas:H,consts:mn,incompleteFirstPass:!1}}function ld(r,o,c,h){const g=hf(o);null===c?g.push(h):(g.push(c),r.firstCreatePass&&sg(r).push(h,g.length-1))}function Uh(r,o,c,h){for(let g in r)if(r.hasOwnProperty(g)){c=null===c?{}:c;const x=r[g];null===h?Gd(c,o,g,x):h.hasOwnProperty(g)&&Gd(c,o,h[g],x)}return c}function Gd(r,o,c,h){r.hasOwnProperty(c)?r[c].push(o,h):r[c]=[o,h]}function el(r,o,c,h,g,x,I,B){const H=Ke(o,c);let Me,le=o.inputs;!B&&null!=le&&(Me=le[h])?(yc(r,c,Me,h,g),fo(o)&&function L_(r,o){const c=si(o,r);16&c[Gi]||(c[Gi]|=32)}(c,o.index)):3&o.type&&(h=function Qm(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(h),g=null!=I?I(g,o.value||"",h):g,x.setProperty(H,h,g))}function $d(r,o,c,h){if(wn()){const g=null===h?null:{"":-1},x=function ng(r,o){const c=r.directiveRegistry;let h=null,g=null;if(c)for(let x=0;x<c.length;x++){const I=c[x];if(Fm(o,I.selectors,!1))if(h||(h=[]),no(I))if(null!==I.findHostDirectiveDefs){const B=[];g=g||new Map,I.findHostDirectiveDefs(I,B,g),h.unshift(...B,I),Vh(r,o,B.length)}else h.unshift(I),Vh(r,o,0);else g=g||new Map,I.findHostDirectiveDefs?.(I,h,g),h.push(I)}return null===h?null:[h,g]}(r,c);let I,B;null===x?I=B=null:[I,B]=x,null!==I&&lf(r,o,c,I,g,B),g&&function N_(r,o,c){if(o){const h=r.localNames=[];for(let g=0;g<o.length;g+=2){const x=c[o[g+1]];if(null==x)throw new et(-301,!1);h.push(o[g],x)}}}(c,h,g)}c.mergedAttrs=vo(c.mergedAttrs,c.attrs)}function lf(r,o,c,h,g,x){for(let le=0;le<h.length;le++)Do(Pa(c,o),r,h[le].type);!function ig(r,o,c){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+c,r.providerIndexes=o}(c,r.data.length,h.length);for(let le=0;le<h.length;le++){const Me=h[le];Me.providersResolver&&Me.providersResolver(Me)}let I=!1,B=!1,H=jd(r,o,h.length,null);for(let le=0;le<h.length;le++){const Me=h[le];c.mergedAttrs=vo(c.mergedAttrs,Me.hostAttrs),rg(r,c,o,H,Me),z_(H,Me,g),null!==Me.contentQueries&&(c.flags|=4),(null!==Me.hostBindings||null!==Me.hostAttrs||0!==Me.hostVars)&&(c.flags|=64);const rt=Me.type.prototype;!I&&(rt.ngOnChanges||rt.ngOnInit||rt.ngDoCheck)&&((r.preOrderHooks??(r.preOrderHooks=[])).push(c.index),I=!0),!B&&(rt.ngOnChanges||rt.ngDoCheck)&&((r.preOrderCheckHooks??(r.preOrderCheckHooks=[])).push(c.index),B=!0),H++}!function k_(r,o,c){const g=o.directiveEnd,x=r.data,I=o.attrs,B=[];let H=null,le=null;for(let Me=o.directiveStart;Me<g;Me++){const rt=x[Me],Ht=c?c.get(rt):null,Vn=Ht?Ht.outputs:null;H=Uh(rt.inputs,Me,H,Ht?Ht.inputs:null),le=Uh(rt.outputs,Me,le,Vn);const ai=null===H||null===I||ed(o)?null:ud(H,Me,I);B.push(ai)}null!==H&&(H.hasOwnProperty("class")&&(o.flags|=8),H.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=B,o.inputs=H,o.outputs=le}(r,c,x)}function cf(r,o,c){const h=c.directiveStart,g=c.directiveEnd,x=c.index,I=function yl(){return Ai.lFrame.currentDirectiveIndex}();try{qs(x);for(let B=h;B<g;B++){const H=r.data[B],le=o[B];Bl(B),(null!==H.hostBindings||0!==H.hostVars||null!==H.hostAttrs)&&tg(H,le)}}finally{qs(-1),Bl(I)}}function tg(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function Vh(r,o,c){o.componentOffset=c,(r.components??(r.components=[])).push(o.index)}function z_(r,o,c){if(c){if(o.exportAs)for(let h=0;h<o.exportAs.length;h++)c[o.exportAs[h]]=r;no(o)&&(c[""]=r)}}function rg(r,o,c,h,g){r.data[h]=g;const x=g.factory||(g.factory=Ur(g.type)),I=new pt(x,no(g),Mu);r.blueprint[h]=I,c[h]=I,function B_(r,o,c,h,g){const x=g.hostBindings;if(x){let I=r.hostBindingOpCodes;null===I&&(I=r.hostBindingOpCodes=[]);const B=~o.index;(function eg(r){let o=r.length;for(;o>0;){const c=r[--o];if("number"==typeof c&&c<0)return c}return 0})(I)!=B&&I.push(B),I.push(c,h,x)}}(r,o,h,jd(r,c,g.hostVars,gr),g)}function Kl(r,o,c,h,g,x){const I=Ke(r,o);!function jh(r,o,c,h,g,x,I){if(null==x)r.removeAttribute(o,g,c);else{const B=null==I?Gt(x):I(x,h||"",g);r.setAttribute(o,g,B,c)}}(o[$i],I,x,r.value,c,h,g)}function uf(r,o,c,h,g,x){const I=x[o];if(null!==I){const B=h.setInput;for(let H=0;H<I.length;){const le=I[H++],Me=I[H++],rt=I[H++];null!==B?h.setInput(c,rt,le,Me):c[Me]=rt}}}function ud(r,o,c){let h=null,g=0;for(;g<c.length;){const x=c[g];if(0!==x)if(5!==x){if("number"==typeof x)break;if(r.hasOwnProperty(x)){null===h&&(h=[]);const I=r[x];for(let B=0;B<I.length;B+=2)if(I[B]===o){h.push(x,I[B+1],c[g+1]);break}}g+=2}else g+=2;else g+=4}return h}function df(r,o,c,h){return[r,!0,!1,o,null,0,h,c,null,null]}function Gh(r,o){const c=si(o,r);if(Vr(c)){const h=c[ii];48&c[Gi]?Rc(h,c,h.template,c[Ji]):c[Ri]>0&&dd(c)}}function dd(r){for(let h=Gl(r);null!==h;h=Vu(h))for(let g=dr;g<h.length;g++){const x=h[g];if(Vr(x))if(512&x[Gi]){const I=x[ii];Rc(I,x,I.template,x[Ji])}else x[Ri]>0&&dd(x)}const c=r[ii].components;if(null!==c)for(let h=0;h<c.length;h++){const g=si(c[h],r);Vr(g)&&g[Ri]>0&&dd(g)}}function U_(r,o){const c=si(o,r),h=c[ii];(function V_(r,o){for(let c=o.length;c<r.blueprint.length;c++)o.push(r.blueprint[c])})(h,c),ad(h,c,c[Ji])}function $h(r,o){return r[Br]?r[ur][Kn]=o:r[Br]=o,r[ur]=o,o}function Zh(r){for(;r;){r[Gi]|=32;const o=Uu(r);if(io(r)&&!o)return r;r=o}return null}function Wh(r,o,c,h=!0){const g=o[wo];g.begin&&g.begin();try{Rc(r,o,r.template,c)}catch(I){throw h&&ag(o,I),I}finally{g.end&&g.end()}}function qd(r,o,c){ra(0),o(r,c)}function hf(r){return r[Fr]||(r[Fr]=[])}function sg(r){return r.cleanup||(r.cleanup=[])}function qh(r,o,c){return(null===r||no(r))&&(c=function bt(r){for(;Array.isArray(r);){if("object"==typeof r[Gs])return r;r=r[Pr]}return null}(c[o.index])),c[$i]}function ag(r,o){const c=r[Pi],h=c?c.get(kd,null):null;h&&h.handleError(o)}function yc(r,o,c,h,g){for(let x=0;x<c.length;){const I=c[x++],B=c[x++],H=o[I],le=r.data[I];null!==le.setInput?le.setInput(H,g,h,B):H[B]=g}}function vc(r,o,c){const h=ce(o,r);!function tm(r,o,c){r.setValue(o,c)}(r[$i],h,c)}function Yd(r,o,c){let h=c?r.styles:null,g=c?r.classes:null,x=0;if(null!==o)for(let I=0;I<o.length;I++){const B=o[I];"number"==typeof B?x=B:1==x?g=Fe(g,B):2==x&&(h=Fe(h,B+": "+o[++I]+";"))}c?r.styles=h:r.stylesWithoutHost=h,c?r.classes=g:r.classesWithoutHost=g}function Du(r,o,c,h,g=!1){for(;null!==c;){const x=o[c.index];if(null!==x&&h.push(Pt(x)),lo(x))for(let B=dr;B<x.length;B++){const H=x[B],le=H[ii].firstChild;null!==le&&Du(H[ii],H,le,h)}const I=c.type;if(8&I)Du(r,o,c.child,h);else if(32&I){const B=mp(c,o);let H;for(;H=B();)h.push(H)}else if(16&I){const B=wp(o,c);if(Array.isArray(B))h.push(...B);else{const H=Uu(o[to]);Du(H[ii],H,B,h,!0)}}c=g?c.projectionNext:c.next}return h}class Tu{get rootNodes(){const o=this._lView,c=o[ii];return Du(c,o,c.firstChild,[])}constructor(o,c){this._lView=o,this._cdRefInjectingView=c,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ji]}set context(o){this._lView[Ji]=o}get destroyed(){return 128==(128&this._lView[Gi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[rr];if(lo(o)){const c=o[jo],h=c?c.indexOf(this):-1;h>-1&&(vp(o,h),So(c,h))}this._attachedToViewContainer=!1}nm(this._lView[ii],this._lView)}onDestroy(o){ld(this._lView[ii],this._lView,null,o)}markForCheck(){Zh(this._cdRefInjectingView||this._lView)}detach(){this._lView[Gi]&=-65}reattach(){this._lView[Gi]|=64}detectChanges(){Wh(this._lView[ii],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new et(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Dc(r,o){hu(r,o,o[$i],2,null,null)}(this._lView[ii],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new et(902,!1);this._appRef=o}}class j_ extends Tu{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Wh(o[ii],o,o[Ji],!1)}checkNoChanges(){}get context(){return null}}class lg extends wu{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const c=Ki(o);return new pl(c,this.ngModule)}}function pf(r){const o=[];for(let c in r)r.hasOwnProperty(c)&&o.push({propName:r[c],templateName:c});return o}class Kd{constructor(o,c){this.injector=o,this.parentInjector=c}get(o,c,h){h=De(h);const g=this.injector.get(o,Zp,h);return g!==Zp||c===Zp?g:this.parentInjector.get(o,c,h)}}class pl extends Id{get inputs(){return pf(this.componentDef.inputs)}get outputs(){return pf(this.componentDef.outputs)}constructor(o,c){super(),this.componentDef=o,this.ngModule=c,this.componentType=o.type,this.selector=function b_(r){return r.map(Vm).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!c}create(o,c,h,g){let x=(g=g||this.ngModule)instanceof xu?g:g?.injector;x&&null!==this.componentDef.getStandaloneInjector&&(x=this.componentDef.getStandaloneInjector(x)||x);const I=x?new Kd(o,x):o,B=I.get(Im,null);if(null===B)throw new et(407,!1);const H=I.get($p,null),le=B.createRenderer(null,this.componentDef),Me=this.componentDef.selectors[0][0]||"div",rt=h?function hl(r,o,c){return r.selectRootElement(o,c===ye.ShadowDom)}(le,h,this.componentDef.encapsulation):Cd(le,Me,function cg(r){const o=r.toLowerCase();return"svg"===o?$s:"math"===o?"math":null}(Me)),Ht=this.componentDef.onPush?288:272,mn=Hd(0,null,null,1,0,null,null,null,null,null),Vn=Nh(null,mn,null,Ht,null,null,B,le,H,I,null);let ai,Ei;Sa(Vn);try{const zi=this.componentDef;let lr,Jn=null;zi.findHostDirectiveDefs?(lr=[],Jn=new Map,zi.findHostDirectiveDefs(zi,lr,Jn),lr.push(zi)):lr=[zi];const wr=function hd(r,o){const c=r[ii],h=Dr;return r[h]=o,sd(c,h,2,"#host",null)}(Vn,rt),ds=function Ol(r,o,c,h,g,x,I,B){const H=g[ii];!function Rl(r,o,c,h){for(const g of r)o.mergedAttrs=vo(o.mergedAttrs,g.hostAttrs);null!==o.mergedAttrs&&(Yd(o,o.mergedAttrs,!0),null!==c&&pc(h,c,o))}(h,r,o,I);const le=x.createRenderer(o,c),Me=Nh(g,zh(c),null,c.onPush?32:16,g[r.index],r,x,le,B||null,null,null);return H.firstCreatePass&&Vh(H,r,h.length-1),$h(g,Me),g[r.index]=Me}(wr,rt,zi,lr,Vn,B,le);Ei=Bn(mn,Dr),rt&&function ug(r,o,c,h){if(h)hr(r,c,["ng-version",Ph.full]);else{const{attrs:g,classes:x}=function x_(r){const o=[],c=[];let h=1,g=2;for(;h<r.length;){let x=r[h];if("string"==typeof x)2===g?""!==x&&o.push(x,r[++h]):8===g&&c.push(x);else{if(!za(g))break;g=x}h++}return{attrs:o,classes:c}}(o.selectors[0]);g&&hr(r,c,g),x&&x.length>0&&am(r,c,x.join(" "))}}(le,zi,rt,h),void 0!==c&&function G_(r,o,c){const h=r.projection=[];for(let g=0;g<o.length;g++){const x=c[g];h.push(null!=x?Array.from(x):null)}}(Ei,this.ngContentSelectors,c),ai=function H_(r,o,c,h,g,x){const I=ro(),B=g[ii],H=Ke(I,g);lf(B,g,I,c,null,h);for(let Me=0;Me<c.length;Me++)ca(Oa(g,B,I.directiveStart+Me,I),g);cf(B,g,I),H&&ca(H,g);const le=Oa(g,B,I.directiveStart+I.componentOffset,I);if(r[Ji]=g[Ji]=le,null!==x)for(const Me of x)Me(le,o);return rf(B,I,r),le}(ds,zi,lr,Jn,Vn,[mf]),ad(mn,Vn,null)}finally{vl()}return new ff(this.componentType,ai,Ku(Ei,Vn),Vn,Ei)}}class ff extends Ah{constructor(o,c,h,g,x){super(),this.location=h,this._rootLView=g,this._tNode=x,this.instance=c,this.hostView=this.changeDetectorRef=new j_(g),this.componentType=o}setInput(o,c){const h=this._tNode.inputs;let g;if(null!==h&&(g=h[o])){const x=this._rootLView;yc(x[ii],x,g,o,c),Zh(si(this._tNode.index,x))}}get injector(){return new V(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function mf(){const r=ro();mr(Tn()[ii],r)}function Lc(r){let o=function Xl(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),c=!0;const h=[r];for(;o;){let g;if(no(r))g=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new et(903,!1);g=o.\u0275dir}if(g){if(c){h.push(g);const I=r;I.inputs=Yh(r.inputs),I.declaredInputs=Yh(r.declaredInputs),I.outputs=Yh(r.outputs);const B=g.hostBindings;B&&gf(r,B);const H=g.viewQuery,le=g.contentQueries;if(H&&$_(r,H),le&&Kh(r,le),it(r.inputs,g.inputs),it(r.declaredInputs,g.declaredInputs),it(r.outputs,g.outputs),no(g)&&g.data.animation){const Me=r.data;Me.animation=(Me.animation||[]).concat(g.data.animation)}}const x=g.features;if(x)for(let I=0;I<x.length;I++){const B=x[I];B&&B.ngInherit&&B(r),B===Lc&&(c=!1)}}o=Object.getPrototypeOf(o)}!function dg(r){let o=0,c=null;for(let h=r.length-1;h>=0;h--){const g=r[h];g.hostVars=o+=g.hostVars,g.hostAttrs=vo(g.hostAttrs,c=vo(c,g.hostAttrs))}}(h)}function Yh(r){return r===Ge?{}:r===Ye?[]:r}function $_(r,o){const c=r.viewQuery;r.viewQuery=c?(h,g)=>{o(h,g),c(h,g)}:o}function Kh(r,o){const c=r.contentQueries;r.contentQueries=c?(h,g,x)=>{o(h,g,x),c(h,g,x)}:o}function gf(r,o){const c=r.hostBindings;r.hostBindings=c?(h,g)=>{o(h,g),c(h,g)}:o}function md(r){return!!vf(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function vf(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function wa(r,o,c){return r[o]=c}function Xo(r,o,c){return!Object.is(r[o],c)&&(r[o]=c,!0)}function Au(r,o,c,h){const g=Xo(r,o,c);return Xo(r,o+1,h)||g}function Iu(r,o,c,h){const g=Tn();return Xo(g,Ta(),o)&&(sr(),Kl(Sr(),g,r,o,c,h)),Iu}function Fc(r,o,c,h){return Xo(r,Ta(),c)?o+Gt(c)+h:gr}function gd(r,o,c,h,g,x){const B=Au(r,function ss(){return Ai.lFrame.bindingIndex}(),c,g);return Ls(2),B?o+Gt(c)+h+Gt(g)+x:gr}function vg(r,o,c,h,g,x,I,B){const H=Tn(),le=sr(),Me=r+Dr,rt=le.firstCreatePass?function Jh(r,o,c,h,g,x,I,B,H){const le=o.consts,Me=sd(o,r,4,I||null,Mo(le,B));$d(o,c,Me,Mo(le,H)),mr(o,Me);const rt=Me.tView=Hd(2,Me,h,g,x,o.directiveRegistry,o.pipeRegistry,null,o.schemas,le);return null!==o.queries&&(o.queries.template(o,Me),rt.queries=o.queries.embeddedTView(Me)),Me}(Me,le,H,o,c,h,g,x,I):le.data[Me];qo(rt,!1);const Ht=H[$i].createComment("");ba(le,H,Ht,rt),ca(Ht,H),$h(H,H[Me]=df(Ht,H,Ht,rt)),is(rt)&&sf(le,H,rt),null!=I&&af(H,rt,B)}function ep(r){return xi(function Vc(){return Ai.lFrame.contextLView}(),Dr+r)}function xc(r,o,c){const h=Tn();return Xo(h,Ta(),o)&&el(sr(),Sr(),h,r,o,h[$i],c,!1),xc}function Cf(r,o,c,h,g){const I=g?"class":"style";yc(r,c,o.inputs[I],I,h)}function nh(r,o,c,h){const g=Tn(),x=sr(),I=Dr+r,B=g[$i],H=x.firstCreatePass?function Mf(r,o,c,h,g,x){const I=o.consts,H=sd(o,r,2,h,Mo(I,g));return $d(o,c,H,Mo(I,x)),null!==H.attrs&&Yd(H,H.attrs,!1),null!==H.mergedAttrs&&Yd(H,H.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,H),H}(I,x,g,o,c,h):x.data[I],le=g[I]=Cd(B,o,function Ga(){return Ai.lFrame.currentNamespace}()),Me=is(H);return qo(H,!0),pc(B,le,H),32!=(32&H.flags)&&ba(x,g,le,H),0===function Y(){return Ai.lFrame.elementDepthCount}()&&ca(le,g),function G(){Ai.lFrame.elementDepthCount++}(),Me&&(sf(x,g,H),rf(x,H,g)),null!==h&&af(g,H),nh}function Ru(){let r=ro();il()?rl():(r=r.parent,qo(r,!1));const o=r;!function Ee(){Ai.lFrame.elementDepthCount--}();const c=sr();return c.firstCreatePass&&(mr(c,r),jr(r)&&c.queries.elementEnd(r)),null!=o.classesWithoutHost&&function xr(r){return 0!=(8&r.flags)}(o)&&Cf(c,o,Tn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Er(r){return 0!=(16&r.flags)}(o)&&Cf(c,o,Tn(),o.stylesWithoutHost,!1),Ru}function Df(r,o,c,h){return nh(r,o,c,h),Ru(),Df}function tp(r,o,c){const h=Tn(),g=sr(),x=r+Dr,I=g.firstCreatePass?function Y_(r,o,c,h,g){const x=o.consts,I=Mo(x,h),B=sd(o,r,8,"ng-container",I);return null!==I&&Yd(B,I,!0),$d(o,c,B,Mo(x,g)),null!==o.queries&&o.queries.elementStart(o,B),B}(x,g,h,o,c):g.data[x];qo(I,!0);const B=h[x]=h[$i].createComment("");return ba(g,h,B,I),ca(B,h),is(I)&&(sf(g,h,I),rf(g,I,h)),null!=c&&af(h,I),tp}function np(){let r=ro();const o=sr();return il()?rl():(r=r.parent,qo(r,!1)),o.firstCreatePass&&(mr(o,r),jr(r)&&o.queries.elementEnd(r)),np}function bg(){return Tn()}function ku(r){return!!r&&"function"==typeof r.then}function xg(r){return!!r&&"function"==typeof r.subscribe}const wg=xg;function rp(r,o,c,h){const g=Tn(),x=sr(),I=ro();return fl(x,g,g[$i],I,r,o,h),rp}function Tf(r,o){const c=ro(),h=Tn(),g=sr();return fl(g,h,qh(ol(g.data),c,h),c,r,o),Tf}function fl(r,o,c,h,g,x,I){const B=is(h),le=r.firstCreatePass&&sg(r),Me=o[Ji],rt=hf(o);let Ht=!0;if(3&h.type||I){const ai=Ke(h,o),Ei=I?I(ai):ai,zi=rt.length,lr=I?wr=>I(Pt(wr[h.index])):h.index;let Jn=null;if(!I&&B&&(Jn=function Eg(r,o,c,h){const g=r.cleanup;if(null!=g)for(let x=0;x<g.length-1;x+=2){const I=g[x];if(I===c&&g[x+1]===h){const B=o[Fr],H=g[x+2];return B.length>H?B[H]:null}"string"==typeof I&&(x+=2)}return null}(r,o,g,h.index)),null!==Jn)(Jn.__ngLastListenerFn__||Jn).__ngNextListenerFn__=x,Jn.__ngLastListenerFn__=x,Ht=!1;else{x=Nc(h,o,Me,x,!1);const wr=c.listen(Ei,g,x);rt.push(x,wr),le&&le.push(g,lr,zi,zi+1)}}else x=Nc(h,o,Me,x,!1);const mn=h.outputs;let Vn;if(Ht&&null!==mn&&(Vn=mn[g])){const ai=Vn.length;if(ai)for(let Ei=0;Ei<ai;Ei+=2){const ds=o[Vn[Ei]][Vn[Ei+1]].subscribe(x),Vs=rt.length;rt.push(x,ds),le&&le.push(g,h.index,Vs,-(Vs+1))}}}function Jl(r,o,c,h){try{return co(6,o,c),!1!==c(h)}catch(g){return ag(r,g),!1}finally{co(7,o,c)}}function Nc(r,o,c,h,g){return function x(I){if(I===Function)return h;Zh(r.componentOffset>-1?si(r.index,o):o);let H=Jl(o,c,h,I),le=x.__ngNextListenerFn__;for(;le;)H=Jl(o,c,le,I)&&H,le=le.__ngNextListenerFn__;return g&&!1===H&&(I.preventDefault(),I.returnValue=!1),H}}function ec(r=1){return function Ws(r){return(Ai.lFrame.contextLView=function Mc(r,o){for(;r>0;)o=o[xo],r--;return o}(r,Ai.lFrame.contextLView))[Ji]}(r)}function Xc(r,o){let c=null;const h=function Bm(r){const o=r.attrs;if(null!=o){const c=o.indexOf(5);if(!(1&c))return o[c+1]}return null}(r);for(let g=0;g<o.length;g++){const x=o[g];if("*"!==x){if(null===h?Fm(r,x,!0):Um(h,x))return g}else c=g}return c}function ih(r){const o=Tn()[to][bi];if(!o.projection){const h=o.projection=P(r?r.length:1,null),g=h.slice();let x=o.child;for(;null!==x;){const I=r?Xc(x,r):0;null!==I&&(g[I]?g[I].projectionNext=x:h[I]=x,g[I]=x),x=x.next}}}function Sf(r,o=0,c){const h=Tn(),g=sr(),x=sd(g,Dr+r,16,null,c||null);null===x.projection&&(x.projection=o),rl(),32!=(32&x.flags)&&function om(r,o,c){_h(o[$i],0,o,c,Dd(r,c,o),xp(c.parent||o[bi],c,o))}(g,h,x)}function op(r,o,c){return rh(r,"",o,"",c),op}function rh(r,o,c,h,g){const x=Tn(),I=Fc(x,o,c,h);return I!==gr&&el(sr(),Sr(),x,r,I,x[$i],g,!1),rh}function oh(r,o){return r<<17|o<<2}function Ua(r){return r>>17&32767}function Lf(r){return 2|r}function kl(r){return(131068&r)>>2}function sh(r,o){return-131069&r|o<<2}function Ll(r){return 1|r}function Bf(r,o,c,h,g){const x=r[c+1],I=null===o;let B=h?Ua(x):kl(x),H=!1;for(;0!==B&&(!1===H||I);){const Me=r[B+1];Sg(r[B],o)&&(H=!0,r[B+1]=h?Ll(Me):Lf(Me)),B=h?Ua(Me):kl(Me)}H&&(r[c+1]=h?Lf(x):Ll(x))}function Sg(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&l(r,o)>=0}const Qo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ah(r){return r.substring(Qo.key,Qo.keyEnd)}function Pg(r,o){const c=Qo.textEnd;return c===o?-1:(o=Qo.keyEnd=function kg(r,o,c){for(;o<c&&r.charCodeAt(o)>32;)o++;return o}(r,Qo.key=o,c),Qc(r,o,c))}function Qc(r,o,c){for(;o<c&&r.charCodeAt(o)<=32;)o++;return o}function d(r,o,c){return R(r,o,c,!1),d}function f(r,o){return R(r,o,null,!0),f}function E(r){!function N(r,o,c,h){const g=sr(),x=Ls(2);g.firstUpdatePass&&X(g,null,x,h);const I=Tn();if(c!==gr&&Xo(I,x,c)){const B=g.data[Lo()];if(Rn(B,h)&&!$(g,x)){let H=h?B.classesWithoutHost:B.stylesWithoutHost;null!==H&&(c=Fe(H,c||"")),Cf(g,B,I,c,h)}else!function cn(r,o,c,h,g,x,I,B){g===gr&&(g=Ye);let H=0,le=0,Me=0<g.length?g[0]:null,rt=0<x.length?x[0]:null;for(;null!==Me||null!==rt;){const Ht=H<g.length?g[H+1]:void 0,mn=le<x.length?x[le+1]:void 0;let ai,Vn=null;Me===rt?(H+=2,le+=2,Ht!==mn&&(Vn=rt,ai=mn)):null===rt||null!==Me&&Me<rt?(H+=2,Vn=Me):(le+=2,Vn=rt,ai=mn),null!==Vn&&on(r,o,c,h,Vn,ai,I,B),Me=H<g.length?g[H]:null,rt=le<x.length?x[le]:null}}(g,B,I,I[$i],I[x+1],I[x+1]=function dt(r,o,c){if(null==c||""===c)return Ye;const h=[],g=Sc(c);if(Array.isArray(g))for(let x=0;x<g.length;x++)r(h,g[x],!0);else if("object"==typeof g)for(const x in g)g.hasOwnProperty(x)&&r(h,x,g[x]);else"string"==typeof g&&o(h,g);return h}(r,o,c),h,x)}}(yt,C,r,!0)}function C(r,o){for(let c=function Ig(r){return function Rg(r){Qo.key=0,Qo.keyEnd=0,Qo.value=0,Qo.valueEnd=0,Qo.textEnd=r.length}(r),Pg(r,Qc(r,0,Qo.textEnd))}(o);c>=0;c=Pg(o,c))u(r,ah(o),!0)}function R(r,o,c,h){const g=Tn(),x=sr(),I=Ls(2);x.firstUpdatePass&&X(x,r,I,h),o!==gr&&Xo(g,I,o)&&on(x,x.data[Lo()],g,g[$i],r,g[I+1]=function yn(r,o){return null==r||""===r||("string"==typeof o?r+=o:"object"==typeof r&&(r=Ce(Sc(r)))),r}(o,c),h,I)}function $(r,o){return o>=r.expandoStartIndex}function X(r,o,c,h){const g=r.data;if(null===g[c+1]){const x=g[Lo()],I=$(r,c);Rn(x,h)&&null===o&&!I&&(o=!1),o=function ne(r,o,c,h){const g=ol(r);let x=h?o.residualClasses:o.residualStyles;if(null===g)0===(h?o.classBindings:o.styleBindings)&&(c=We(c=gt(null,r,o,c,h),o.attrs,h),x=null);else{const I=o.directiveStylingLast;if(-1===I||r[I]!==g)if(c=gt(g,r,o,c,h),null===x){let H=function he(r,o,c){const h=c?o.classBindings:o.styleBindings;if(0!==kl(h))return r[Ua(h)]}(r,o,h);void 0!==H&&Array.isArray(H)&&(H=gt(null,r,o,H[1],h),H=We(H,o.attrs,h),function Pe(r,o,c,h){r[Ua(c?o.classBindings:o.styleBindings)]=h}(r,o,h,H))}else x=function Xe(r,o,c){let h;const g=o.directiveEnd;for(let x=1+o.directiveStylingLast;x<g;x++)h=We(h,r[x].hostAttrs,c);return We(h,o.attrs,c)}(r,o,h)}return void 0!==x&&(h?o.residualClasses=x:o.residualStyles=x),c}(g,x,o,h),function tc(r,o,c,h,g,x){let I=x?o.classBindings:o.styleBindings,B=Ua(I),H=kl(I);r[h]=c;let Me,le=!1;if(Array.isArray(c)?(Me=c[1],(null===Me||l(c,Me)>0)&&(le=!0)):Me=c,g)if(0!==H){const Ht=Ua(r[B+1]);r[h+1]=oh(Ht,B),0!==Ht&&(r[Ht+1]=sh(r[Ht+1],h)),r[B+1]=function ap(r,o){return 131071&r|o<<17}(r[B+1],h)}else r[h+1]=oh(B,0),0!==B&&(r[B+1]=sh(r[B+1],h)),B=h;else r[h+1]=oh(H,0),0===B?B=h:r[H+1]=sh(r[H+1],h),H=h;le&&(r[h+1]=Lf(r[h+1])),Bf(r,Me,h,!0),Bf(r,Me,h,!1),function Lu(r,o,c,h,g){const x=g?r.residualClasses:r.residualStyles;null!=x&&"string"==typeof o&&l(x,o)>=0&&(c[h+1]=Ll(c[h+1]))}(o,Me,r,h,x),I=oh(B,H),x?o.classBindings=I:o.styleBindings=I}(g,x,o,c,I,h)}}function gt(r,o,c,h,g){let x=null;const I=c.directiveEnd;let B=c.directiveStylingLast;for(-1===B?B=c.directiveStart:B++;B<I&&(x=o[B],h=We(h,x.hostAttrs,g),x!==r);)B++;return null!==r&&(c.directiveStylingLast=B),h}function We(r,o,c){const h=c?1:2;let g=-1;if(null!==o)for(let x=0;x<o.length;x++){const I=o[x];"number"==typeof I?g=I:g===h&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),u(r,I,!!c||o[++x]))}return void 0===r?null:r}function yt(r,o,c){const h=String(o);""!==h&&!h.includes(" ")&&u(r,h,c)}function on(r,o,c,h,g,x,I,B){if(!(3&o.type))return;const H=r.data,le=H[B+1],Me=function Ff(r){return 1==(1&r)}(le)?Sn(H,o,c,g,kl(le),I):void 0;Gn(Me)||(Gn(x)||function Mg(r){return 2==(2&r)}(le)&&(x=Sn(H,null,c,g,B,I)),function Ep(r,o,c,h,g){if(o)g?r.addClass(c,h):r.removeClass(c,h);else{let x=-1===h.indexOf("-")?void 0:Oo.DashCase;null==g?r.removeStyle(c,h,x):("string"==typeof g&&g.endsWith("!important")&&(g=g.slice(0,-10),x|=Oo.Important),r.setStyle(c,h,g,x))}}(h,I,ce(Lo(),c),g,x))}function Sn(r,o,c,h,g,x){const I=null===o;let B;for(;g>0;){const H=r[g],le=Array.isArray(H),Me=le?H[1]:H,rt=null===Me;let Ht=c[g+1];Ht===gr&&(Ht=rt?Ye:void 0);let mn=rt?t(Ht,h):Me===h?Ht:void 0;if(le&&!Gn(mn)&&(mn=t(H,h)),Gn(mn)&&(B=mn,I))return B;const Vn=r[g+1];g=I?Ua(Vn):kl(Vn)}if(null!==o){let H=x?o.residualClasses:o.residualStyles;null!=H&&(B=t(H,h))}return B}function Gn(r){return void 0!==r}function Rn(r,o){return 0!=(r.flags&(o?8:16))}function Ln(r,o=""){const c=Tn(),h=sr(),g=r+Dr,x=h.firstCreatePass?sd(h,g,1,o,null):h.data[g],I=c[g]=function yp(r,o){return r.createText(o)}(c[$i],o);ba(h,c,I,x),qo(x,!1)}function Un(r){return Zn("",r,""),Un}function Zn(r,o,c){const h=Tn(),g=Fc(h,r,o,c);return g!==gr&&vc(h,Lo(),g),Zn}function vn(r,o,c,h,g){const x=Tn(),I=gd(x,r,o,c,h,g);return I!==gr&&vc(x,Lo(),I),vn}function Jc(r,o,c){const h=Tn();return Xo(h,Ta(),o)&&el(sr(),Sr(),h,r,o,h[$i],c,!0),Jc}function Fu(r,o,c){const h=Tn();if(Xo(h,Ta(),o)){const x=sr(),I=Sr();el(x,I,h,r,o,qh(ol(x.data),I,h),c,!0)}return Fu}const nc=void 0;var Bg=["en",[["a","p"],["AM","PM"],nc],[["AM","PM"],nc,nc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],nc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],nc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",nc,"{1} 'at' {0}",nc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Fg(r){const c=Math.floor(Math.abs(r)),h=r.toString().replace(/^[^.]*\.?/,"").length;return 1===c&&0===h?1:5}];let Bu={};function lh(r){const o=function tu(r){return r.toLowerCase().replace(/_/g,"-")}(r);let c=eu(o);if(c)return c;const h=o.split("-")[0];if(c=eu(h),c)return c;if("en"===h)return Bg;throw new et(701,!1)}function zf(r){return lh(r)[tr.PluralCase]}function eu(r){return r in Bu||(Bu[r]=Fn.ng&&Fn.ng.common&&Fn.ng.common.locales&&Fn.ng.common.locales[r]),Bu[r]}var tr=(()=>((tr=tr||{})[tr.LocaleId=0]="LocaleId",tr[tr.DayPeriodsFormat=1]="DayPeriodsFormat",tr[tr.DayPeriodsStandalone=2]="DayPeriodsStandalone",tr[tr.DaysFormat=3]="DaysFormat",tr[tr.DaysStandalone=4]="DaysStandalone",tr[tr.MonthsFormat=5]="MonthsFormat",tr[tr.MonthsStandalone=6]="MonthsStandalone",tr[tr.Eras=7]="Eras",tr[tr.FirstDayOfWeek=8]="FirstDayOfWeek",tr[tr.WeekendRange=9]="WeekendRange",tr[tr.DateFormat=10]="DateFormat",tr[tr.TimeFormat=11]="TimeFormat",tr[tr.DateTimeFormat=12]="DateTimeFormat",tr[tr.NumberSymbols=13]="NumberSymbols",tr[tr.NumberFormats=14]="NumberFormats",tr[tr.CurrencyCode=15]="CurrencyCode",tr[tr.CurrencySymbol=16]="CurrencySymbol",tr[tr.CurrencyName=17]="CurrencyName",tr[tr.Currencies=18]="Currencies",tr[tr.Directionality=19]="Directionality",tr[tr.PluralCase=20]="PluralCase",tr[tr.ExtraData=21]="ExtraData",tr))();const Us="en-US";let Uy=Us;function J_(r,o,c,h,g){if(r=qe(r),Array.isArray(r))for(let x=0;x<r.length;x++)J_(r[x],o,c,h,g);else{const x=sr(),I=Tn();let B=gc(r)?r:qe(r.provide),H=Am(r);const le=ro(),Me=1048575&le.providerIndexes,rt=le.directiveStart,Ht=le.providerIndexes>>20;if(gc(r)||!r.multi){const mn=new pt(H,g,Mu),Vn=ty(B,o,g?Me:Me+Ht,rt);-1===Vn?(Do(Pa(le,I),x,B),ey(x,r,o.length),o.push(B),le.directiveStart++,le.directiveEnd++,g&&(le.providerIndexes+=1048576),c.push(mn),I.push(mn)):(c[Vn]=mn,I[Vn]=mn)}else{const mn=ty(B,o,Me+Ht,rt),Vn=ty(B,o,Me,Me+Ht),Ei=Vn>=0&&c[Vn];if(g&&!Ei||!g&&!(mn>=0&&c[mn])){Do(Pa(le,I),x,B);const zi=function Lb(r,o,c,h,g){const x=new pt(r,c,Mu);return x.multi=[],x.index=o,x.componentProviders=0,dv(x,g,h&&!c),x}(g?kb:Rb,c.length,g,h,H);!g&&Ei&&(c[Vn].providerFactory=zi),ey(x,r,o.length,0),o.push(B),le.directiveStart++,le.directiveEnd++,g&&(le.providerIndexes+=1048576),c.push(zi),I.push(zi)}else ey(x,r,mn>-1?mn:Vn,dv(c[g?Vn:mn],H,!g&&h));!g&&h&&Ei&&c[Vn].componentProviders++}}}function ey(r,o,c,h){const g=gc(o),x=function Tm(r){return!!r.useClass}(o);if(g||x){const H=(x?qe(o.useClass):o).prototype.ngOnDestroy;if(H){const le=r.destroyHooks||(r.destroyHooks=[]);if(!g&&o.multi){const Me=le.indexOf(c);-1===Me?le.push(c,[h,H]):le[Me+1].push(h,H)}else le.push(c,H)}}}function dv(r,o,c){return c&&r.componentProviders++,r.multi.push(o)-1}function ty(r,o,c,h){for(let g=c;g<h;g++)if(o[g]===r)return g;return-1}function Rb(r,o,c,h){return ny(this.multi,[])}function kb(r,o,c,h){const g=this.multi;let x;if(this.providerFactory){const I=this.providerFactory.componentProviders,B=Oa(c,c[ii],this.providerFactory.index,h);x=B.slice(0,I),ny(g,x);for(let H=I;H<B.length;H++)x.push(B[H])}else x=[],ny(g,x);return x}function ny(r,o){for(let c=0;c<r.length;c++)o.push((0,r[c])());return o}function hv(r,o=[]){return c=>{c.providersResolver=(h,g)=>function Ob(r,o,c){const h=sr();if(h.firstCreatePass){const g=no(r);J_(c,h.data,h.blueprint,g,!0),J_(o,h.data,h.blueprint,g,!1)}}(h,g?g(r):r,o)}}class lp{}class pv{}function Fb(r,o){return new fv(r,o??null)}class fv extends lp{constructor(o,c){super(),this._parent=c,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new lg(this);const h=qr(o);this._bootstrapComponents=_c(h.bootstrap),this._r3Injector=Gm(o,c,[{provide:lp,useValue:this},{provide:wu,useValue:this.componentFactoryResolver}],Ce(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(c=>c()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class iy extends pv{constructor(o){super(),this.moduleType=o}create(o){return new fv(this.moduleType,o)}}class Bb extends lp{constructor(o,c,h){super(),this.componentFactoryResolver=new lg(this),this.instance=null;const g=new Sm([...o,{provide:lp,useValue:this},{provide:wu,useValue:this.componentFactoryResolver}],c||Dh(),h,new Set(["environment"]));this.injector=g,g.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function ry(r,o,c=null){return new Bb(r,o,c).injector}let Nb=(()=>{class r{constructor(c){this._injector=c,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(c){if(!c.standalone)return null;if(!this.cachedInjectors.has(c.id)){const h=Mh(0,c.type),g=h.length>0?ry([h],this._injector,`Standalone[${c.type.name}]`):null;this.cachedInjectors.set(c.id,g)}return this.cachedInjectors.get(c.id)}ngOnDestroy(){try{for(const c of this.cachedInjectors.values())null!==c&&c.destroy()}finally{this.cachedInjectors.clear()}}}return r.\u0275prov=ve({token:r,providedIn:"environment",factory:()=>new r(_t(xu))}),r})();function mv(r){r.getStandaloneInjector=o=>o.get(Nb).getOrCreateStandaloneInjector(r)}function wv(r,o,c){const h=Nr()+r,g=Tn();return g[h]===gr?wa(g,h,c?o.call(c):o()):function eh(r,o){return r[o]}(g,h)}function Ev(r,o,c,h){return Mv(Tn(),Nr(),r,o,c,h)}function Cv(r,o,c,h,g){return Dv(Tn(),Nr(),r,o,c,h,g)}function Zf(r,o){const c=r[o];return c===gr?void 0:c}function Mv(r,o,c,h,g,x){const I=o+c;return Xo(r,I,g)?wa(r,I+1,x?h.call(x,g):h(g)):Zf(r,I+1)}function Dv(r,o,c,h,g,x,I){const B=o+c;return Au(r,B,g,x)?wa(r,B+2,I?h.call(I,g,x):h(g,x)):Zf(r,B+2)}function Iv(r,o){const c=sr();let h;const g=r+Dr;c.firstCreatePass?(h=function ex(r,o){if(o)for(let c=o.length-1;c>=0;c--){const h=o[c];if(r===h.name)return h}}(o,c.pipeRegistry),c.data[g]=h,h.onDestroy&&(c.destroyHooks??(c.destroyHooks=[])).push(g,h.onDestroy)):h=c.data[g];const x=h.factory||(h.factory=Ur(h.type)),I=lt(Mu);try{const B=sa(!1),H=x();return sa(B),function Ef(r,o,c,h){c>=r.data.length&&(r.data[c]=null,r.blueprint[c]=null),o[c]=h}(c,Tn(),g,H),H}finally{lt(I)}}function Pv(r,o,c){const h=r+Dr,g=Tn(),x=xi(g,h);return Wf(g,h)?Mv(g,Nr(),o,x.transform,c,x):x.transform(c)}function Ov(r,o,c,h){const g=r+Dr,x=Tn(),I=xi(x,g);return Wf(x,g)?Dv(x,Nr(),o,I.transform,c,h,I):I.transform(c,h)}function Wf(r,o){return r[ii].data[o].pure}function sy(r){return o=>{setTimeout(r,void 0,o)}}const iu=class rx extends w.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,c,h){let g=o,x=c||(()=>null),I=h;if(o&&"object"==typeof o){const H=o;g=H.next?.bind(H),x=H.error?.bind(H),I=H.complete?.bind(H)}this.__isAsync&&(x=sy(x),g&&(g=sy(g)),I&&(I=sy(I)));const B=super.subscribe({next:g,error:x,complete:I});return o instanceof y.w0&&o.add(B),B}};function ox(){return this._results[Symbol.iterator]()}class jg{get changes(){return this._changes||(this._changes=new iu)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const c=jg.prototype;c[Symbol.iterator]||(c[Symbol.iterator]=ox)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,c){return this._results.reduce(o,c)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,c){const h=this;h.dirty=!1;const g=function Di(r){return r.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Si(r,o,c){if(r.length!==o.length)return!1;for(let h=0;h<r.length;h++){let g=r[h],x=o[h];if(c&&(g=c(g),x=c(x)),x!==g)return!1}return!0}(h._results,g,c))&&(h._results=g,h.length=g.length,h.last=g[this.length-1],h.first=g[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let qf=(()=>{class r{}return r.__NG_ELEMENT_ID__=lx,r})();const sx=qf,ax=class extends sx{constructor(o,c,h){super(),this._declarationLView=o,this._declarationTContainer=c,this.elementRef=h}createEmbeddedView(o,c){const h=this._declarationTContainer.tView,g=Nh(this._declarationLView,h,o,16,null,h.declTNode,null,null,null,null,c||null);g[ts]=this._declarationLView[this._declarationTContainer.index];const I=this._declarationLView[Vo];return null!==I&&(g[Vo]=I.createEmbeddedView(h)),ad(h,g,o),new Tu(g)}};function lx(){return Hg(ro(),Tn())}function Hg(r,o){return 4&r.type?new ax(o,r,Ku(r,o)):null}let Gg=(()=>{class r{}return r.__NG_ELEMENT_ID__=cx,r})();function cx(){return Lv(ro(),Tn())}const ux=Gg,Rv=class extends ux{constructor(o,c,h){super(),this._lContainer=o,this._hostTNode=c,this._hostLView=h}get element(){return Ku(this._hostTNode,this._hostLView)}get injector(){return new V(this._hostTNode,this._hostLView)}get parentInjector(){const o=uc(this._hostTNode,this._hostLView);if(Fo(o)){const c=Cs(o,this._hostLView),h=Go(o);return new V(c[ii].data[h+8],c)}return new V(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const c=kv(this._lContainer);return null!==c&&c[o]||null}get length(){return this._lContainer.length-dr}createEmbeddedView(o,c,h){let g,x;"number"==typeof h?g=h:null!=h&&(g=h.index,x=h.injector);const I=o.createEmbeddedView(c||{},x);return this.insert(I,g),I}createComponent(o,c,h,g,x){const I=o&&!function Ya(r){return"function"==typeof r}(o);let B;if(I)B=c;else{const rt=c||{};B=rt.index,h=rt.injector,g=rt.projectableNodes,x=rt.environmentInjector||rt.ngModuleRef}const H=I?o:new pl(Ki(o)),le=h||this.parentInjector;if(!x&&null==H.ngModule){const Ht=(I?le:this.parentInjector).get(xu,null);Ht&&(x=Ht)}const Me=H.create(le,g,void 0,x);return this.insert(Me.hostView,B),Me}insert(o,c){const h=o._lView,g=h[ii];if(function Ho(r){return lo(r[rr])}(h)){const Me=this.indexOf(o);if(-1!==Me)this.detach(Me);else{const rt=h[rr],Ht=new Rv(rt,rt[bi],rt[rr]);Ht.detach(Ht.indexOf(o))}}const x=this._adjustIndex(c),I=this._lContainer;!function Hc(r,o,c,h){const g=dr+h,x=c.length;h>0&&(c[g-1][Kn]=o),h<x-dr?(o[Kn]=c[g],Mr(c,dr+h,o)):(c.push(o),o[Kn]=null),o[rr]=c;const I=o[ts];null!==I&&c!==I&&function Gc(r,o){const c=r[ys];o[to]!==o[rr][rr][to]&&(r[po]=!0),null===c?r[ys]=[o]:c.push(o)}(I,o);const B=o[Vo];null!==B&&B.insertView(r),o[Gi]|=64}(g,h,I,x);const B=Al(x,I),H=h[$i],le=du(H,I[Or]);return null!==le&&function ju(r,o,c,h,g,x){h[Pr]=g,h[bi]=o,hu(r,h,c,1,g,x)}(g,I[bi],H,h,le,B),o.attachToViewContainerRef(),Mr(ay(I),x,o),o}move(o,c){return this.insert(o,c)}indexOf(o){const c=kv(this._lContainer);return null!==c?c.indexOf(o):-1}remove(o){const c=this._adjustIndex(o,-1),h=vp(this._lContainer,c);h&&(So(ay(this._lContainer),c),nm(h[ii],h))}detach(o){const c=this._adjustIndex(o,-1),h=vp(this._lContainer,c);return h&&null!=So(ay(this._lContainer),c)?new Tu(h):null}_adjustIndex(o,c=0){return o??this.length+c}};function kv(r){return r[jo]}function ay(r){return r[jo]||(r[jo]=[])}function Lv(r,o){let c;const h=o[r.index];if(lo(h))c=h;else{let g;if(8&r.type)g=Pt(h);else{const x=o[$i];g=x.createComment("");const I=Ke(r,o);cu(x,du(x,I),g,function Ar(r,o){return r.nextSibling(o)}(x,I),!1)}o[r.index]=c=df(h,o,g,r),$h(o,c)}return new Rv(c,r,o)}class ly{constructor(o){this.queryList=o,this.matches=null}clone(){return new ly(this.queryList)}setDirty(){this.queryList.setDirty()}}class cy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const c=o.queries;if(null!==c){const h=null!==o.contentQueries?o.contentQueries[0]:c.length,g=[];for(let x=0;x<h;x++){const I=c.getByIndex(x);g.push(this.queries[I.indexInDeclarationView].clone())}return new cy(g)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let c=0;c<this.queries.length;c++)null!==Gv(o,c).matches&&this.queries[c].setDirty()}}class Fv{constructor(o,c,h=null){this.predicate=o,this.flags=c,this.read=h}}class uy{constructor(o=[]){this.queries=o}elementStart(o,c){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(o,c)}elementEnd(o){for(let c=0;c<this.queries.length;c++)this.queries[c].elementEnd(o)}embeddedTView(o){let c=null;for(let h=0;h<this.length;h++){const g=null!==c?c.length:0,x=this.getByIndex(h).embeddedTView(o,g);x&&(x.indexInDeclarationView=h,null!==c?c.push(x):c=[x])}return null!==c?new uy(c):null}template(o,c){for(let h=0;h<this.queries.length;h++)this.queries[h].template(o,c)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class dy{constructor(o,c=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=c}elementStart(o,c){this.isApplyingToNode(c)&&this.matchTNode(o,c)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,c){this.elementStart(o,c)}embeddedTView(o,c){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,c),new dy(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const c=this._declarationNodeIndex;let h=o.parent;for(;null!==h&&8&h.type&&h.index!==c;)h=h.parent;return c===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(o,c){const h=this.metadata.predicate;if(Array.isArray(h))for(let g=0;g<h.length;g++){const x=h[g];this.matchTNodeWithReadOption(o,c,dx(c,x)),this.matchTNodeWithReadOption(o,c,aa(c,o,x,!1,!1))}else h===qf?4&c.type&&this.matchTNodeWithReadOption(o,c,-1):this.matchTNodeWithReadOption(o,c,aa(c,o,h,!1,!1))}matchTNodeWithReadOption(o,c,h){if(null!==h){const g=this.metadata.read;if(null!==g)if(g===Xu||g===Gg||g===qf&&4&c.type)this.addMatch(c.index,-2);else{const x=aa(c,o,g,!1,!1);null!==x&&this.addMatch(c.index,x)}else this.addMatch(c.index,h)}}addMatch(o,c){null===this.matches?this.matches=[o,c]:this.matches.push(o,c)}}function dx(r,o){const c=r.localNames;if(null!==c)for(let h=0;h<c.length;h+=2)if(c[h]===o)return c[h+1];return null}function px(r,o,c,h){return-1===c?function hx(r,o){return 11&r.type?Ku(r,o):4&r.type?Hg(r,o):null}(o,r):-2===c?function fx(r,o,c){return c===Xu?Ku(o,r):c===qf?Hg(o,r):c===Gg?Lv(o,r):void 0}(r,o,h):Oa(r,r[ii],c,o)}function Bv(r,o,c,h){const g=o[Vo].queries[h];if(null===g.matches){const x=r.data,I=c.matches,B=[];for(let H=0;H<I.length;H+=2){const le=I[H];B.push(le<0?null:px(o,x[le],I[H+1],c.metadata.read))}g.matches=B}return g.matches}function hy(r,o,c,h){const g=r.queries.getByIndex(c),x=g.matches;if(null!==x){const I=Bv(r,o,g,c);for(let B=0;B<x.length;B+=2){const H=x[B];if(H>0)h.push(I[B/2]);else{const le=x[B+1],Me=o[-H];for(let rt=dr;rt<Me.length;rt++){const Ht=Me[rt];Ht[ts]===Ht[rr]&&hy(Ht[ii],Ht,le,h)}if(null!==Me[ys]){const rt=Me[ys];for(let Ht=0;Ht<rt.length;Ht++){const mn=rt[Ht];hy(mn[ii],mn,le,h)}}}}}return h}function Nv(r){const o=Tn(),c=sr(),h=sl();ra(h+1);const g=Gv(c,h);if(r.dirty&&function pi(r){return 4==(4&r[Gi])}(o)===(2==(2&g.metadata.flags))){if(null===g.matches)r.reset([]);else{const x=g.crossesNgTemplate?hy(c,o,h,[]):Bv(c,o,g,h);r.reset(x,Rd),r.notifyOnChanges()}return!0}return!1}function zv(r,o,c){const h=sr();h.firstCreatePass&&(Hv(h,new Fv(r,o,c),-1),2==(2&o)&&(h.staticViewQueries=!0)),jv(h,Tn(),o)}function Uv(r,o,c,h){const g=sr();if(g.firstCreatePass){const x=ro();Hv(g,new Fv(o,c,h),x.index),function gx(r,o){const c=r.contentQueries||(r.contentQueries=[]);o!==(c.length?c[c.length-1]:-1)&&c.push(r.queries.length-1,o)}(g,r),2==(2&c)&&(g.staticContentQueries=!0)}jv(g,Tn(),c)}function Vv(){return function mx(r,o){return r[Vo].queries[o].queryList}(Tn(),sl())}function jv(r,o,c){const h=new jg(4==(4&c));ld(r,o,h,h.destroy),null===o[Vo]&&(o[Vo]=new cy),o[Vo].queries.push(new ly(h))}function Hv(r,o,c){null===r.queries&&(r.queries=new uy),r.queries.track(new dy(o,c))}function Gv(r,o){return r.queries.getByIndex(o)}function $v(r,o){return Hg(r,o)}function py(r){return!!qr(r)}function Zg(...r){}const u0=new or("Application Initializer");let Wg=(()=>{class r{constructor(c){this.appInits=c,this.resolve=Zg,this.reject=Zg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((h,g)=>{this.resolve=h,this.reject=g})}runInitializers(){if(this.initialized)return;const c=[],h=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let g=0;g<this.appInits.length;g++){const x=this.appInits[g]();if(ku(x))c.push(x);else if(wg(x)){const I=new Promise((B,H)=>{x.subscribe({complete:B,error:H})});c.push(I)}}Promise.all(c).then(()=>{h()}).catch(g=>{this.reject(g)}),0===c.length&&h(),this.initialized=!0}}return r.\u0275fac=function(c){return new(c||r)(_t(u0,8))},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const d0=new or("AppId",{providedIn:"root",factory:function h0(){return`${yy()}${yy()}${yy()}`}});function yy(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const p0=new or("Platform Initializer"),Fx=new or("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),Bx=new or("AnimationModuleType");let Nx=(()=>{class r{log(c){console.log(c)}warn(c){console.warn(c)}}return r.\u0275fac=function(c){return new(c||r)},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const qg=new or("LocaleId",{providedIn:"root",factory:()=>Ut(qg,ue.Optional|ue.SkipSelf)||function zx(){return typeof $localize<"u"&&$localize.locale||Us}()}),Ux=new or("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Vx{constructor(o,c){this.ngModuleFactory=o,this.componentFactories=c}}let jx=(()=>{class r{compileModuleSync(c){return new iy(c)}compileModuleAsync(c){return Promise.resolve(this.compileModuleSync(c))}compileModuleAndAllComponentsSync(c){const h=this.compileModuleSync(c),x=_c(qr(c).declarations).reduce((I,B)=>{const H=Ki(B);return H&&I.push(new pl(H)),I},[]);return new Vx(h,x)}compileModuleAndAllComponentsAsync(c){return Promise.resolve(this.compileModuleAndAllComponentsSync(c))}clearCache(){}clearCacheFor(c){}getModuleId(c){}}return r.\u0275fac=function(c){return new(c||r)},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const $x=(()=>Promise.resolve(0))();function vy(r){typeof Zone>"u"?$x.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class Ec{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:c=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new iu(!1),this.onMicrotaskEmpty=new iu(!1),this.onStable=new iu(!1),this.onError=new iu(!1),typeof Zone>"u")throw new et(908,!1);Zone.assertZonePatched();const g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!h&&c,g.shouldCoalesceRunChangeDetection=h,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function Zx(){let r=Fn.requestAnimationFrame,o=Fn.cancelAnimationFrame;if(typeof Zone<"u"&&r&&o){const c=r[Zone.__symbol__("OriginalDelegate")];c&&(r=c);const h=o[Zone.__symbol__("OriginalDelegate")];h&&(o=h)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Yx(r){const o=()=>{!function qx(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(Fn,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,xy(r),r.isCheckStableRunning=!0,by(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),xy(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(c,h,g,x,I,B)=>{try{return g0(r),c.invokeTask(g,x,I,B)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===x.type||r.shouldCoalesceRunChangeDetection)&&o(),_0(r)}},onInvoke:(c,h,g,x,I,B,H)=>{try{return g0(r),c.invoke(g,x,I,B,H)}finally{r.shouldCoalesceRunChangeDetection&&o(),_0(r)}},onHasTask:(c,h,g,x)=>{c.hasTask(g,x),h===g&&("microTask"==x.change?(r._hasPendingMicrotasks=x.microTask,xy(r),by(r)):"macroTask"==x.change&&(r.hasPendingMacrotasks=x.macroTask))},onHandleError:(c,h,g,x)=>(c.handleError(g,x),r.runOutsideAngular(()=>r.onError.emit(x)),!1)})}(g)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ec.isInAngularZone())throw new et(909,!1)}static assertNotInAngularZone(){if(Ec.isInAngularZone())throw new et(909,!1)}run(o,c,h){return this._inner.run(o,c,h)}runTask(o,c,h,g){const x=this._inner,I=x.scheduleEventTask("NgZoneEvent: "+g,o,Wx,Zg,Zg);try{return x.runTask(I,c,h)}finally{x.cancelTask(I)}}runGuarded(o,c,h){return this._inner.runGuarded(o,c,h)}runOutsideAngular(o){return this._outer.run(o)}}const Wx={};function by(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function xy(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function g0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function _0(r){r._nesting--,by(r)}class Kx{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new iu,this.onMicrotaskEmpty=new iu,this.onStable=new iu,this.onError=new iu}run(o,c,h){return o.apply(c,h)}runGuarded(o,c,h){return o.apply(c,h)}runOutsideAngular(o){return o()}runTask(o,c,h,g){return o.apply(c,h)}}const y0=new or(""),v0=new or("");let wy,Xx=(()=>{class r{constructor(c,h,g){this._ngZone=c,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,wy||(function Qx(r){wy=r}(g),g.addToWindow(h)),this._watchAngularEvents(),c.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ec.assertNotInAngularZone(),vy(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())vy(()=>{for(;0!==this._callbacks.length;){let c=this._callbacks.pop();clearTimeout(c.timeoutId),c.doneCb(this._didWork)}this._didWork=!1});else{let c=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(c)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(c=>({source:c.source,creationLocation:c.creationLocation,data:c.data})):[]}addCallback(c,h,g){let x=-1;h&&h>0&&(x=setTimeout(()=>{this._callbacks=this._callbacks.filter(I=>I.timeoutId!==x),c(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:c,timeoutId:x,updateCb:g})}whenStable(c,h,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(c,h,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(c){this.registry.registerApplication(c,this)}unregisterApplication(c){this.registry.unregisterApplication(c)}findProviders(c,h,g){return[]}}return r.\u0275fac=function(c){return new(c||r)(_t(Ec),_t(b0),_t(v0))},r.\u0275prov=ve({token:r,factory:r.\u0275fac}),r})(),b0=(()=>{class r{constructor(){this._applications=new Map}registerApplication(c,h){this._applications.set(c,h)}unregisterApplication(c){this._applications.delete(c)}unregisterAllApplications(){this._applications.clear()}getTestability(c){return this._applications.get(c)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(c,h=!0){return wy?.findTestabilityInTree(this,c,h)??null}}return r.\u0275fac=function(c){return new(c||r)},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const Nu=!1;let xd=null;const x0=new or("AllowMultipleToken"),Ey=new or("PlatformDestroyListeners"),w0=new or("appBootstrapListener");class tw{constructor(o,c){this.name=o,this.token=c}}function C0(r,o,c=[]){const h=`Platform: ${o}`,g=new or(h);return(x=[])=>{let I=Cy();if(!I||I.injector.get(x0,!1)){const B=[...c,...x,{provide:g,useValue:!0}];r?r(B):function nw(r){if(xd&&!xd.get(x0,!1))throw new et(400,!1);xd=r;const o=r.get(D0);(function E0(r){const o=r.get(p0,null);o&&o.forEach(c=>c())})(r)}(function M0(r=[],o){return Eu.create({name:o,providers:[{provide:Pc,useValue:"platform"},{provide:Ey,useValue:new Set([()=>xd=null])},...r]})}(B,h))}return function rw(r){const o=Cy();if(!o)throw new et(401,!1);return o}()}}function Cy(){return xd?.get(D0)??null}let D0=(()=>{class r{constructor(c){this._injector=c,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(c,h){const g=function S0(r,o){let c;return c="noop"===r?new Kx:("zone.js"===r?void 0:r)||new Ec(o),c}(h?.ngZone,function T0(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!r||!r.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!r||!r.ngZoneRunCoalescing)||!1}}(h)),x=[{provide:Ec,useValue:g}];return g.run(()=>{const I=Eu.create({providers:x,parent:this.injector,name:c.moduleType.name}),B=c.create(I),H=B.injector.get(kd,null);if(!H)throw new et(402,!1);return g.runOutsideAngular(()=>{const le=g.onError.subscribe({next:Me=>{H.handleError(Me)}});B.onDestroy(()=>{Kg(this._modules,B),le.unsubscribe()})}),function A0(r,o,c){try{const h=c();return ku(h)?h.catch(g=>{throw o.runOutsideAngular(()=>r.handleError(g)),g}):h}catch(h){throw o.runOutsideAngular(()=>r.handleError(h)),h}}(H,g,()=>{const le=B.injector.get(Wg);return le.runInitializers(),le.donePromise.then(()=>(function Vy(r){nn(r,"Expected localeId to be defined"),"string"==typeof r&&(Uy=r.toLowerCase().replace(/_/g,"-"))}(B.injector.get(qg,Us)||Us),this._moduleDoBootstrap(B),B))})})}bootstrapModule(c,h=[]){const g=I0({},h);return function Jx(r,o,c){const h=new iy(c);return Promise.resolve(h)}(0,0,c).then(x=>this.bootstrapModuleFactory(x,g))}_moduleDoBootstrap(c){const h=c.injector.get(Yg);if(c._bootstrapComponents.length>0)c._bootstrapComponents.forEach(g=>h.bootstrap(g));else{if(!c.instance.ngDoBootstrap)throw new et(-403,!1);c.instance.ngDoBootstrap(h)}this._modules.push(c)}onDestroy(c){this._destroyListeners.push(c)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new et(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const c=this._injector.get(Ey,null);c&&(c.forEach(h=>h()),c.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(c){return new(c||r)(_t(Eu))},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function I0(r,o){return Array.isArray(o)?o.reduce(I0,r):{...r,...o}}let Yg=(()=>{class r{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(c,h,g){this._zone=c,this._injector=h,this._exceptionHandler=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const x=new j.y(B=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{B.next(this._stable),B.complete()})}),I=new j.y(B=>{let H;this._zone.runOutsideAngular(()=>{H=this._zone.onStable.subscribe(()=>{Ec.assertNotInAngularZone(),vy(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,B.next(!0))})})});const le=this._zone.onUnstable.subscribe(()=>{Ec.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{B.next(!1)}))});return()=>{H.unsubscribe(),le.unsubscribe()}});this.isStable=(0,a.T)(x,I.pipe((0,de.B)()))}bootstrap(c,h){const g=c instanceof Id;if(!this._injector.get(Wg).done){!g&&pn(c);throw new et(405,Nu)}let I;I=g?c:this._injector.get(wu).resolveComponentFactory(c),this.componentTypes.push(I.componentType);const B=function ew(r){return r.isBoundToModule}(I)?void 0:this._injector.get(lp),le=I.create(Eu.NULL,[],h||I.selector,B),Me=le.location.nativeElement,rt=le.injector.get(y0,null);return rt?.registerApplication(Me),le.onDestroy(()=>{this.detachView(le.hostView),Kg(this.components,le),rt?.unregisterApplication(Me)}),this._loadComponent(le),le}tick(){if(this._runningTick)throw new et(101,!1);try{this._runningTick=!0;for(let c of this._views)c.detectChanges()}catch(c){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(c))}finally{this._runningTick=!1}}attachView(c){const h=c;this._views.push(h),h.attachToAppRef(this)}detachView(c){const h=c;Kg(this._views,h),h.detachFromAppRef()}_loadComponent(c){this.attachView(c.hostView),this.tick(),this.components.push(c);const h=this._injector.get(w0,[]);h.push(...this._bootstrapListeners),h.forEach(g=>g(c))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(c=>c()),this._views.slice().forEach(c=>c.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(c){return this._destroyListeners.push(c),()=>Kg(this._destroyListeners,c)}destroy(){if(this._destroyed)throw new et(406,!1);const c=this._injector;c.destroy&&!c.destroyed&&c.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return r.\u0275fac=function(c){return new(c||r)(_t(Ec),_t(xu),_t(kd))},r.\u0275prov=ve({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Kg(r,o){const c=r.indexOf(o);c>-1&&r.splice(c,1)}function sw(){return!1}function aw(){}let lw=(()=>{class r{}return r.__NG_ELEMENT_ID__=cw,r})();function cw(r){return function uw(r,o,c){if(fo(r)&&!c){const h=si(r.index,o);return new Tu(h,h)}return 47&r.type?new Tu(o[to],o):null}(ro(),Tn(),16==(16&r))}class L0{constructor(){}supports(o){return md(o)}create(o){return new gw(o)}}const mw=(r,o)=>o;class gw{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||mw}forEachItem(o){let c;for(c=this._itHead;null!==c;c=c._next)o(c)}forEachOperation(o){let c=this._itHead,h=this._removalsHead,g=0,x=null;for(;c||h;){const I=!h||c&&c.currentIndex<B0(h,g,x)?c:h,B=B0(I,g,x),H=I.currentIndex;if(I===h)g--,h=h._nextRemoved;else if(c=c._next,null==I.previousIndex)g++;else{x||(x=[]);const le=B-g,Me=H-g;if(le!=Me){for(let Ht=0;Ht<le;Ht++){const mn=Ht<x.length?x[Ht]:x[Ht]=0,Vn=mn+Ht;Me<=Vn&&Vn<le&&(x[Ht]=mn+1)}x[I.previousIndex]=Me-le}}B!==H&&o(I,B,H)}}forEachPreviousItem(o){let c;for(c=this._previousItHead;null!==c;c=c._nextPrevious)o(c)}forEachAddedItem(o){let c;for(c=this._additionsHead;null!==c;c=c._nextAdded)o(c)}forEachMovedItem(o){let c;for(c=this._movesHead;null!==c;c=c._nextMoved)o(c)}forEachRemovedItem(o){let c;for(c=this._removalsHead;null!==c;c=c._nextRemoved)o(c)}forEachIdentityChange(o){let c;for(c=this._identityChangesHead;null!==c;c=c._nextIdentityChange)o(c)}diff(o){if(null==o&&(o=[]),!md(o))throw new et(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let g,x,I,c=this._itHead,h=!1;if(Array.isArray(o)){this.length=o.length;for(let B=0;B<this.length;B++)x=o[B],I=this._trackByFn(B,x),null!==c&&Object.is(c.trackById,I)?(h&&(c=this._verifyReinsertion(c,x,I,B)),Object.is(c.item,x)||this._addIdentityChange(c,x)):(c=this._mismatch(c,x,I,B),h=!0),c=c._next}else g=0,function q_(r,o){if(Array.isArray(r))for(let c=0;c<r.length;c++)o(r[c]);else{const c=r[Symbol.iterator]();let h;for(;!(h=c.next()).done;)o(h.value)}}(o,B=>{I=this._trackByFn(g,B),null!==c&&Object.is(c.trackById,I)?(h&&(c=this._verifyReinsertion(c,B,I,g)),Object.is(c.item,B)||this._addIdentityChange(c,B)):(c=this._mismatch(c,B,I,g),h=!0),c=c._next,g++}),this.length=g;return this._truncate(c),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,c,h,g){let x;return null===o?x=this._itTail:(x=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(o.item,c)||this._addIdentityChange(o,c),this._reinsertAfter(o,x,g)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(h,g))?(Object.is(o.item,c)||this._addIdentityChange(o,c),this._moveAfter(o,x,g)):o=this._addAfter(new _w(c,h),x,g),o}_verifyReinsertion(o,c,h,g){let x=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==x?o=this._reinsertAfter(x,o._prev,g):o.currentIndex!=g&&(o.currentIndex=g,this._addToMoves(o,g)),o}_truncate(o){for(;null!==o;){const c=o._next;this._addToRemovals(this._unlink(o)),o=c}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,c,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const g=o._prevRemoved,x=o._nextRemoved;return null===g?this._removalsHead=x:g._nextRemoved=x,null===x?this._removalsTail=g:x._prevRemoved=g,this._insertAfter(o,c,h),this._addToMoves(o,h),o}_moveAfter(o,c,h){return this._unlink(o),this._insertAfter(o,c,h),this._addToMoves(o,h),o}_addAfter(o,c,h){return this._insertAfter(o,c,h),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,c,h){const g=null===c?this._itHead:c._next;return o._next=g,o._prev=c,null===g?this._itTail=o:g._prev=o,null===c?this._itHead=o:c._next=o,null===this._linkedRecords&&(this._linkedRecords=new F0),this._linkedRecords.put(o),o.currentIndex=h,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const c=o._prev,h=o._next;return null===c?this._itHead=h:c._next=h,null===h?this._itTail=c:h._prev=c,o}_addToMoves(o,c){return o.previousIndex===c||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new F0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,c){return o.item=c,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class _w{constructor(o,c){this.item=o,this.trackById=c,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class yw{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,c){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===c||c<=h.currentIndex)&&Object.is(h.trackById,o))return h;return null}remove(o){const c=o._prevDup,h=o._nextDup;return null===c?this._head=h:c._nextDup=h,null===h?this._tail=c:h._prevDup=c,null===this._head}}class F0{constructor(){this.map=new Map}put(o){const c=o.trackById;let h=this.map.get(c);h||(h=new yw,this.map.set(c,h)),h.add(o)}get(o,c){const g=this.map.get(o);return g?g.get(o,c):null}remove(o){const c=o.trackById;return this.map.get(c).remove(o)&&this.map.delete(c),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function B0(r,o,c){const h=r.previousIndex;if(null===h)return h;let g=0;return c&&h<c.length&&(g=c[h]),h+o+g}class N0{constructor(){}supports(o){return o instanceof Map||vf(o)}create(){return new vw}}class vw{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let c;for(c=this._mapHead;null!==c;c=c._next)o(c)}forEachPreviousItem(o){let c;for(c=this._previousMapHead;null!==c;c=c._nextPrevious)o(c)}forEachChangedItem(o){let c;for(c=this._changesHead;null!==c;c=c._nextChanged)o(c)}forEachAddedItem(o){let c;for(c=this._additionsHead;null!==c;c=c._nextAdded)o(c)}forEachRemovedItem(o){let c;for(c=this._removalsHead;null!==c;c=c._nextRemoved)o(c)}diff(o){if(o){if(!(o instanceof Map||vf(o)))throw new et(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let c=this._mapHead;if(this._appendAfter=null,this._forEach(o,(h,g)=>{if(c&&c.key===g)this._maybeAddToChanges(c,h),this._appendAfter=c,c=c._next;else{const x=this._getOrCreateRecordForKey(g,h);c=this._insertBeforeOrAppend(c,x)}}),c){c._prev&&(c._prev._next=null),this._removalsHead=c;for(let h=c;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,c){if(o){const h=o._prev;return c._next=o,c._prev=h,o._prev=c,h&&(h._next=c),o===this._mapHead&&(this._mapHead=c),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=c,c._prev=this._appendAfter):this._mapHead=c,this._appendAfter=c,null}_getOrCreateRecordForKey(o,c){if(this._records.has(o)){const g=this._records.get(o);this._maybeAddToChanges(g,c);const x=g._prev,I=g._next;return x&&(x._next=I),I&&(I._prev=x),g._next=null,g._prev=null,g}const h=new bw(o);return this._records.set(o,h),h.currentValue=c,this._addToAdditions(h),h}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,c){Object.is(c,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=c,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,c){o instanceof Map?o.forEach(c):Object.keys(o).forEach(h=>c(o[h],h))}}class bw{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function z0(){return new Ay([new L0])}let Ay=(()=>{class r{constructor(c){this.factories=c}static create(c,h){if(null!=h){const g=h.factories.slice();c=c.concat(g)}return new r(c)}static extend(c){return{provide:r,useFactory:h=>r.create(c,h||z0()),deps:[[r,new Ie,new Be]]}}find(c){const h=this.factories.find(g=>g.supports(c));if(null!=h)return h;throw new et(901,!1)}}return r.\u0275prov=ve({token:r,providedIn:"root",factory:z0}),r})();function U0(){return new Iy([new N0])}let Iy=(()=>{class r{constructor(c){this.factories=c}static create(c,h){if(h){const g=h.factories.slice();c=c.concat(g)}return new r(c)}static extend(c){return{provide:r,useFactory:h=>r.create(c,h||U0()),deps:[[r,new Ie,new Be]]}}find(c){const h=this.factories.find(g=>g.supports(c));if(h)return h;throw new et(901,!1)}}return r.\u0275prov=ve({token:r,providedIn:"root",factory:U0}),r})();const Ew=C0(null,"core",[]);let Cw=(()=>{class r{constructor(c){}}return r.\u0275fac=function(c){return new(c||r)(_t(Yg))},r.\u0275mod=Vi({type:r}),r.\u0275inj=Tt({}),r})();function Mw(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}},4006:(Yn,kt,L)=>{"use strict";L.d(kt,{EJ:()=>Ps,F:()=>bi,Fj:()=>tt,JJ:()=>dn,JL:()=>ue,JU:()=>Ce,Kr:()=>ma,On:()=>hs,Q7:()=>ko,UX:()=>Zs,Wl:()=>$e,YN:()=>Os,_:()=>dr,_Y:()=>Dr,a5:()=>vt,kI:()=>ot,qu:()=>Ho,sg:()=>no,u:()=>Ca,u5:()=>Ai,wV:()=>Gs});var w=L(4650),y=L(6895),j=L(2076),a=L(4128),de=L(4004);let Qe=(()=>{class J{constructor(G,Ee){this._renderer=G,this._elementRef=Ee,this.onChange=wn=>{},this.onTouched=()=>{}}setProperty(G,Ee){this._renderer.setProperty(this._elementRef.nativeElement,G,Ee)}registerOnTouched(G){this.onTouched=G}registerOnChange(G){this.onChange=G}setDisabledState(G){this.setProperty("disabled",G)}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(w.Qsj),w.Y36(w.SBq))},J.\u0275dir=w.lG2({type:J}),J})(),it=(()=>{class J extends Qe{}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,features:[w.qOj]}),J})();const Ce=new w.OlP("NgValueAccessor"),Fe={provide:Ce,useExisting:(0,w.Gpc)(()=>$e),multi:!0};let $e=(()=>{class J extends it{writeValue(G){this.setProperty("checked",G)}}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("change",function(Mi){return Ee.onChange(Mi.target.checked)})("blur",function(){return Ee.onTouched()})},features:[w._Bn([Fe]),w.qOj]}),J})();const at={provide:Ce,useExisting:(0,w.Gpc)(()=>tt),multi:!0},Ve=new w.OlP("CompositionEventMode");let tt=(()=>{class J extends Qe{constructor(G,Ee,wn){super(G,Ee),this._compositionMode=wn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function qe(){const J=(0,y.q)()?(0,y.q)().getUserAgent():"";return/android (\d+)/.test(J.toLowerCase())}())}writeValue(G){this.setProperty("value",G??"")}_handleInput(G){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(G)}_compositionStart(){this._composing=!0}_compositionEnd(G){this._composing=!1,this._compositionMode&&this.onChange(G)}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(Ve,8))},J.\u0275dir=w.lG2({type:J,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("input",function(Mi){return Ee._handleInput(Mi.target.value)})("blur",function(){return Ee.onTouched()})("compositionstart",function(){return Ee._compositionStart()})("compositionend",function(Mi){return Ee._compositionEnd(Mi.target.value)})},features:[w._Bn([at]),w.qOj]}),J})();const Re=!1;function ft(J){return null==J||("string"==typeof J||Array.isArray(J))&&0===J.length}function et(J){return null!=J&&"number"==typeof J.length}const ht=new w.OlP("NgValidators"),Gt=new w.OlP("NgAsyncValidators"),an=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class ot{static min(Y){return function Te(J){return Y=>{if(ft(Y.value)||ft(J))return null;const G=parseFloat(Y.value);return!isNaN(G)&&G<J?{min:{min:J,actual:Y.value}}:null}}(Y)}static max(Y){return function Ne(J){return Y=>{if(ft(Y.value)||ft(J))return null;const G=parseFloat(Y.value);return!isNaN(G)&&G>J?{max:{max:J,actual:Y.value}}:null}}(Y)}static required(Y){return mt(Y)}static requiredTrue(Y){return function It(J){return!0===J.value?null:{required:!0}}(Y)}static email(Y){return function sn(J){return ft(J.value)||an.test(J.value)?null:{email:!0}}(Y)}static minLength(Y){return function Cn(J){return Y=>ft(Y.value)||!et(Y.value)?null:Y.value.length<J?{minlength:{requiredLength:J,actualLength:Y.value.length}}:null}(Y)}static maxLength(Y){return function Yt(J){return Y=>et(Y.value)&&Y.value.length>J?{maxlength:{requiredLength:J,actualLength:Y.value.length}}:null}(Y)}static pattern(Y){return function nt(J){if(!J)return Et;let Y,G;return"string"==typeof J?(G="","^"!==J.charAt(0)&&(G+="^"),G+=J,"$"!==J.charAt(J.length-1)&&(G+="$"),Y=new RegExp(G)):(G=J.toString(),Y=J),Ee=>{if(ft(Ee.value))return null;const wn=Ee.value;return Y.test(wn)?null:{pattern:{requiredPattern:G,actualValue:wn}}}}(Y)}static nullValidator(Y){return null}static compose(Y){return Zt(Y)}static composeAsync(Y){return Ct(Y)}}function mt(J){return ft(J.value)?{required:!0}:null}function Et(J){return null}function ct(J){return null!=J}function Pn(J){const Y=(0,w.QGY)(J)?(0,j.D)(J):J;if(Re&&!(0,w.CqO)(Y)){let G="Expected async validator to return Promise or Observable.";throw"object"==typeof J&&(G+=" Are you using a synchronous validator where an async validator is expected?"),new w.vHH(-1101,G)}return Y}function Nn(J){let Y={};return J.forEach(G=>{Y=null!=G?{...Y,...G}:Y}),0===Object.keys(Y).length?null:Y}function fi(J,Y){return Y.map(G=>G(J))}function Bt(J){return J.map(Y=>function Ci(J){return!J.validate}(Y)?Y:G=>Y.validate(G))}function Zt(J){if(!J)return null;const Y=J.filter(ct);return 0==Y.length?null:function(G){return Nn(fi(G,Y))}}function nn(J){return null!=J?Zt(Bt(J)):null}function Ct(J){if(!J)return null;const Y=J.filter(ct);return 0==Y.length?null:function(G){const Ee=fi(G,Y).map(Pn);return(0,a.D)(Ee).pipe((0,de.U)(Nn))}}function Jt(J){return null!=J?Ct(Bt(J)):null}function ze(J,Y){return null===J?[Y]:Array.isArray(J)?[...J,Y]:[J,Y]}function zt(J){return J._rawValidators}function ve(J){return J._rawAsyncValidators}function Lt(J){return J?Array.isArray(J)?J:[J]:[]}function Tt(J,Y){return Array.isArray(J)?J.includes(Y):J===Y}function fn(J,Y){const G=Lt(Y);return Lt(J).forEach(wn=>{Tt(G,wn)||G.push(wn)}),G}function me(J,Y){return Lt(Y).filter(G=>!Tt(J,G))}class Rt{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(Y){this._rawValidators=Y||[],this._composedValidatorFn=nn(this._rawValidators)}_setAsyncValidators(Y){this._rawAsyncValidators=Y||[],this._composedAsyncValidatorFn=Jt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(Y){this._onDestroyCallbacks.push(Y)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(Y=>Y()),this._onDestroyCallbacks=[]}reset(Y){this.control&&this.control.reset(Y)}hasError(Y,G){return!!this.control&&this.control.hasError(Y,G)}getError(Y,G){return this.control?this.control.getError(Y,G):null}}class Se extends Rt{get formDirective(){return null}get path(){return null}}class vt extends Rt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class jn{constructor(Y){this._cd=Y}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let dn=(()=>{class J extends jn{constructor(G){super(G)}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(vt,2))},J.\u0275dir=w.lG2({type:J,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(G,Ee){2&G&&w.ekj("ng-untouched",Ee.isUntouched)("ng-touched",Ee.isTouched)("ng-pristine",Ee.isPristine)("ng-dirty",Ee.isDirty)("ng-valid",Ee.isValid)("ng-invalid",Ee.isInvalid)("ng-pending",Ee.isPending)},features:[w.qOj]}),J})(),ue=(()=>{class J extends jn{constructor(G){super(G)}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(Se,10))},J.\u0275dir=w.lG2({type:J,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(G,Ee){2&G&&w.ekj("ng-untouched",Ee.isUntouched)("ng-touched",Ee.isTouched)("ng-pristine",Ee.isPristine)("ng-dirty",Ee.isDirty)("ng-valid",Ee.isValid)("ng-invalid",Ee.isInvalid)("ng-pending",Ee.isPending)("ng-submitted",Ee.isSubmitted)},features:[w.qOj]}),J})();function Li(J,Y){return J?`with name: '${Y}'`:`at index: ${Y}`}const Kt=!1,Ft="VALID",_t="INVALID",bn="PENDING",Ut="DISABLED";function De(J){return($t(J)?J.validators:J)||null}function be(J,Y){return($t(Y)?Y.asyncValidators:J)||null}function $t(J){return null!=J&&!Array.isArray(J)&&"object"==typeof J}function pe(J,Y,G){const Ee=J.controls;if(!(Y?Object.keys(Ee):Ee).length)throw new w.vHH(1e3,Kt?function Qi(J){return`\n    There are no form controls registered with this ${J?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(Y):"");if(!Ee[G])throw new w.vHH(1001,Kt?function Ii(J,Y){return`Cannot find form control ${Li(J,Y)}`}(Y,G):"")}function Q(J,Y,G){J._forEachChild((Ee,wn)=>{if(void 0===G[wn])throw new w.vHH(1002,Kt?function Ir(J,Y){return`Must supply a value for form control ${Li(J,Y)}`}(Y,wn):"")})}class ae{constructor(Y,G){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(Y),this._assignAsyncValidators(G)}get validator(){return this._composedValidatorFn}set validator(Y){this._rawValidators=this._composedValidatorFn=Y}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(Y){this._rawAsyncValidators=this._composedAsyncValidatorFn=Y}get parent(){return this._parent}get valid(){return this.status===Ft}get invalid(){return this.status===_t}get pending(){return this.status==bn}get disabled(){return this.status===Ut}get enabled(){return this.status!==Ut}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(Y){this._assignValidators(Y)}setAsyncValidators(Y){this._assignAsyncValidators(Y)}addValidators(Y){this.setValidators(fn(Y,this._rawValidators))}addAsyncValidators(Y){this.setAsyncValidators(fn(Y,this._rawAsyncValidators))}removeValidators(Y){this.setValidators(me(Y,this._rawValidators))}removeAsyncValidators(Y){this.setAsyncValidators(me(Y,this._rawAsyncValidators))}hasValidator(Y){return Tt(this._rawValidators,Y)}hasAsyncValidator(Y){return Tt(this._rawAsyncValidators,Y)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(Y={}){this.touched=!0,this._parent&&!Y.onlySelf&&this._parent.markAsTouched(Y)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(Y=>Y.markAllAsTouched())}markAsUntouched(Y={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(G=>{G.markAsUntouched({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}markAsDirty(Y={}){this.pristine=!1,this._parent&&!Y.onlySelf&&this._parent.markAsDirty(Y)}markAsPristine(Y={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(G=>{G.markAsPristine({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}markAsPending(Y={}){this.status=bn,!1!==Y.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!Y.onlySelf&&this._parent.markAsPending(Y)}disable(Y={}){const G=this._parentMarkedDirty(Y.onlySelf);this.status=Ut,this.errors=null,this._forEachChild(Ee=>{Ee.disable({...Y,onlySelf:!0})}),this._updateValue(),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...Y,skipPristineCheck:G}),this._onDisabledChange.forEach(Ee=>Ee(!0))}enable(Y={}){const G=this._parentMarkedDirty(Y.onlySelf);this.status=Ft,this._forEachChild(Ee=>{Ee.enable({...Y,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent}),this._updateAncestors({...Y,skipPristineCheck:G}),this._onDisabledChange.forEach(Ee=>Ee(!1))}_updateAncestors(Y){this._parent&&!Y.onlySelf&&(this._parent.updateValueAndValidity(Y),Y.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(Y){this._parent=Y}getRawValue(){return this.value}updateValueAndValidity(Y={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ft||this.status===bn)&&this._runAsyncValidator(Y.emitEvent)),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!Y.onlySelf&&this._parent.updateValueAndValidity(Y)}_updateTreeValidity(Y={emitEvent:!0}){this._forEachChild(G=>G._updateTreeValidity(Y)),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Ut:Ft}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(Y){if(this.asyncValidator){this.status=bn,this._hasOwnPendingAsyncValidator=!0;const G=Pn(this.asyncValidator(this));this._asyncValidationSubscription=G.subscribe(Ee=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ee,{emitEvent:Y})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(Y,G={}){this.errors=Y,this._updateControlsErrors(!1!==G.emitEvent)}get(Y){let G=Y;return null==G||(Array.isArray(G)||(G=G.split(".")),0===G.length)?null:G.reduce((Ee,wn)=>Ee&&Ee._find(wn),this)}getError(Y,G){const Ee=G?this.get(G):this;return Ee&&Ee.errors?Ee.errors[Y]:null}hasError(Y,G){return!!this.getError(Y,G)}get root(){let Y=this;for(;Y._parent;)Y=Y._parent;return Y}_updateControlsErrors(Y){this.status=this._calculateStatus(),Y&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(Y)}_initObservables(){this.valueChanges=new w.vpe,this.statusChanges=new w.vpe}_calculateStatus(){return this._allControlsDisabled()?Ut:this.errors?_t:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(bn)?bn:this._anyControlsHaveStatus(_t)?_t:Ft}_anyControlsHaveStatus(Y){return this._anyControls(G=>G.status===Y)}_anyControlsDirty(){return this._anyControls(Y=>Y.dirty)}_anyControlsTouched(){return this._anyControls(Y=>Y.touched)}_updatePristine(Y={}){this.pristine=!this._anyControlsDirty(),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}_updateTouched(Y={}){this.touched=this._anyControlsTouched(),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}_registerOnCollectionChange(Y){this._onCollectionChange=Y}_setUpdateStrategy(Y){$t(Y)&&null!=Y.updateOn&&(this._updateOn=Y.updateOn)}_parentMarkedDirty(Y){return!Y&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(Y){return null}_assignValidators(Y){this._rawValidators=Array.isArray(Y)?Y.slice():Y,this._composedValidatorFn=function oe(J){return Array.isArray(J)?nn(J):J||null}(this._rawValidators)}_assignAsyncValidators(Y){this._rawAsyncValidators=Array.isArray(Y)?Y.slice():Y,this._composedAsyncValidatorFn=function wt(J){return Array.isArray(J)?Jt(J):J||null}(this._rawAsyncValidators)}}class ye extends ae{constructor(Y,G,Ee){super(De(G),be(Ee,G)),this.controls=Y,this._initObservables(),this._setUpdateStrategy(G),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(Y,G){return this.controls[Y]?this.controls[Y]:(this.controls[Y]=G,G.setParent(this),G._registerOnCollectionChange(this._onCollectionChange),G)}addControl(Y,G,Ee={}){this.registerControl(Y,G),this.updateValueAndValidity({emitEvent:Ee.emitEvent}),this._onCollectionChange()}removeControl(Y,G={}){this.controls[Y]&&this.controls[Y]._registerOnCollectionChange(()=>{}),delete this.controls[Y],this.updateValueAndValidity({emitEvent:G.emitEvent}),this._onCollectionChange()}setControl(Y,G,Ee={}){this.controls[Y]&&this.controls[Y]._registerOnCollectionChange(()=>{}),delete this.controls[Y],G&&this.registerControl(Y,G),this.updateValueAndValidity({emitEvent:Ee.emitEvent}),this._onCollectionChange()}contains(Y){return this.controls.hasOwnProperty(Y)&&this.controls[Y].enabled}setValue(Y,G={}){Q(this,!0,Y),Object.keys(Y).forEach(Ee=>{pe(this,!0,Ee),this.controls[Ee].setValue(Y[Ee],{onlySelf:!0,emitEvent:G.emitEvent})}),this.updateValueAndValidity(G)}patchValue(Y,G={}){null!=Y&&(Object.keys(Y).forEach(Ee=>{const wn=this.controls[Ee];wn&&wn.patchValue(Y[Ee],{onlySelf:!0,emitEvent:G.emitEvent})}),this.updateValueAndValidity(G))}reset(Y={},G={}){this._forEachChild((Ee,wn)=>{Ee.reset(Y[wn],{onlySelf:!0,emitEvent:G.emitEvent})}),this._updatePristine(G),this._updateTouched(G),this.updateValueAndValidity(G)}getRawValue(){return this._reduceChildren({},(Y,G,Ee)=>(Y[Ee]=G.getRawValue(),Y))}_syncPendingControls(){let Y=this._reduceChildren(!1,(G,Ee)=>!!Ee._syncPendingControls()||G);return Y&&this.updateValueAndValidity({onlySelf:!0}),Y}_forEachChild(Y){Object.keys(this.controls).forEach(G=>{const Ee=this.controls[G];Ee&&Y(Ee,G)})}_setUpControls(){this._forEachChild(Y=>{Y.setParent(this),Y._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(Y){for(const[G,Ee]of Object.entries(this.controls))if(this.contains(G)&&Y(Ee))return!0;return!1}_reduceValue(){return this._reduceChildren({},(G,Ee,wn)=>((Ee.enabled||this.disabled)&&(G[wn]=Ee.value),G))}_reduceChildren(Y,G){let Ee=Y;return this._forEachChild((wn,Mi)=>{Ee=G(Ee,wn,Mi)}),Ee}_allControlsDisabled(){for(const Y of Object.keys(this.controls))if(this.controls[Y].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(Y){return this.controls.hasOwnProperty(Y)?this.controls[Y]:null}}class xe extends ye{}const te=new w.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>ge}),ge="always";function ut(J,Y){return[...Y.path,J]}function en(J,Y,G=ge){ci(J,Y),Y.valueAccessor.writeValue(J.value),(J.disabled||"always"===G)&&Y.valueAccessor.setDisabledState?.(J.disabled),function Vi(J,Y){Y.valueAccessor.registerOnChange(G=>{J._pendingValue=G,J._pendingChange=!0,J._pendingDirty=!0,"change"===J.updateOn&&hi(J,Y)})}(J,Y),function Yi(J,Y){const G=(Ee,wn)=>{Y.valueAccessor.writeValue(Ee),wn&&Y.viewToModelUpdate(Ee)};J.registerOnChange(G),Y._registerOnDestroy(()=>{J._unregisterOnChange(G)})}(J,Y),function ji(J,Y){Y.valueAccessor.registerOnTouched(()=>{J._pendingTouched=!0,"blur"===J.updateOn&&J._pendingChange&&hi(J,Y),"submit"!==J.updateOn&&J.markAsTouched()})}(J,Y),function ei(J,Y){if(Y.valueAccessor.setDisabledState){const G=Ee=>{Y.valueAccessor.setDisabledState(Ee)};J.registerOnDisabledChange(G),Y._registerOnDestroy(()=>{J._unregisterOnDisabledChange(G)})}}(J,Y)}function Xt(J,Y,G=!0){const Ee=()=>{};Y.valueAccessor&&(Y.valueAccessor.registerOnChange(Ee),Y.valueAccessor.registerOnTouched(Ee)),gi(J,Y),J&&(Y._invokeOnDestroyCallbacks(),J._registerOnCollectionChange(()=>{}))}function Qn(J,Y){J.forEach(G=>{G.registerOnValidatorChange&&G.registerOnValidatorChange(Y)})}function ci(J,Y){const G=zt(J);null!==Y.validator?J.setValidators(ze(G,Y.validator)):"function"==typeof G&&J.setValidators([G]);const Ee=ve(J);null!==Y.asyncValidator?J.setAsyncValidators(ze(Ee,Y.asyncValidator)):"function"==typeof Ee&&J.setAsyncValidators([Ee]);const wn=()=>J.updateValueAndValidity();Qn(Y._rawValidators,wn),Qn(Y._rawAsyncValidators,wn)}function gi(J,Y){let G=!1;if(null!==J){if(null!==Y.validator){const wn=zt(J);if(Array.isArray(wn)&&wn.length>0){const Mi=wn.filter(uo=>uo!==Y.validator);Mi.length!==wn.length&&(G=!0,J.setValidators(Mi))}}if(null!==Y.asyncValidator){const wn=ve(J);if(Array.isArray(wn)&&wn.length>0){const Mi=wn.filter(uo=>uo!==Y.asyncValidator);Mi.length!==wn.length&&(G=!0,J.setAsyncValidators(Mi))}}}const Ee=()=>{};return Qn(Y._rawValidators,Ee),Qn(Y._rawAsyncValidators,Ee),G}function hi(J,Y){J._pendingDirty&&J.markAsDirty(),J.setValue(J._pendingValue,{emitModelToViewChange:!1}),Y.viewToModelUpdate(J._pendingValue),J._pendingChange=!1}function ir(J,Y){ci(J,Y)}function Ro(J,Y){if(!J.hasOwnProperty("model"))return!1;const G=J.model;return!!G.isFirstChange()||!Object.is(Y,G.currentValue)}function Pr(J,Y){J._syncPendingControls(),Y.forEach(G=>{const Ee=G.control;"submit"===Ee.updateOn&&Ee._pendingChange&&(G.viewToModelUpdate(Ee._pendingValue),Ee._pendingChange=!1)})}function ii(J,Y){if(!Y)return null;let G,Ee,wn;return Array.isArray(Y),Y.forEach(Mi=>{Mi.constructor===tt?G=Mi:function js(J){return Object.getPrototypeOf(J.constructor)===it}(Mi)?Ee=Mi:wn=Mi}),wn||Ee||G||null}const Kn={provide:Se,useExisting:(0,w.Gpc)(()=>bi)},Ri=(()=>Promise.resolve())();let bi=(()=>{class J extends Se{constructor(G,Ee,wn){super(),this.callSetDisabledState=wn,this.submitted=!1,this._directives=new Set,this.ngSubmit=new w.vpe,this.form=new ye({},nn(G),Jt(Ee))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(G){Ri.then(()=>{const Ee=this._findContainer(G.path);G.control=Ee.registerControl(G.name,G.control),en(G.control,G,this.callSetDisabledState),G.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(G)})}getControl(G){return this.form.get(G.path)}removeControl(G){Ri.then(()=>{const Ee=this._findContainer(G.path);Ee&&Ee.removeControl(G.name),this._directives.delete(G)})}addFormGroup(G){Ri.then(()=>{const Ee=this._findContainer(G.path),wn=new ye({});ir(wn,G),Ee.registerControl(G.name,wn),wn.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(G){Ri.then(()=>{const Ee=this._findContainer(G.path);Ee&&Ee.removeControl(G.name)})}getFormGroup(G){return this.form.get(G.path)}updateModel(G,Ee){Ri.then(()=>{this.form.get(G.path).setValue(Ee)})}setValue(G){this.control.setValue(G)}onSubmit(G){return this.submitted=!0,Pr(this.form,this._directives),this.ngSubmit.emit(G),"dialog"===G?.target?.method}onReset(){this.resetForm()}resetForm(G){this.form.reset(G),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(G){return G.pop(),G.length?this.form.get(G):this.form}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(ht,10),w.Y36(Gt,10),w.Y36(te,8))},J.\u0275dir=w.lG2({type:J,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("submit",function(Mi){return Ee.onSubmit(Mi)})("reset",function(){return Ee.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[w._Bn([Kn]),w.qOj]}),J})();function Fr(J,Y){const G=J.indexOf(Y);G>-1&&J.splice(G,1)}function Ji(J){return"object"==typeof J&&null!==J&&2===Object.keys(J).length&&"value"in J&&"disabled"in J}const Pi=class extends ae{constructor(Y=null,G,Ee){super(De(G),be(Ee,G)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(Y),this._setUpdateStrategy(G),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$t(G)&&(G.nonNullable||G.initialValueIsDefault)&&(this.defaultValue=Ji(Y)?Y.value:Y)}setValue(Y,G={}){this.value=this._pendingValue=Y,this._onChange.length&&!1!==G.emitModelToViewChange&&this._onChange.forEach(Ee=>Ee(this.value,!1!==G.emitViewToModelChange)),this.updateValueAndValidity(G)}patchValue(Y,G={}){this.setValue(Y,G)}reset(Y=this.defaultValue,G={}){this._applyFormState(Y),this.markAsPristine(G),this.markAsUntouched(G),this.setValue(this.value,G),this._pendingChange=!1}_updateValue(){}_anyControls(Y){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(Y){this._onChange.push(Y)}_unregisterOnChange(Y){Fr(this._onChange,Y)}registerOnDisabledChange(Y){this._onDisabledChange.push(Y)}_unregisterOnDisabledChange(Y){Fr(this._onDisabledChange,Y)}_forEachChild(Y){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(Y){Ji(Y)?(this.value=this._pendingValue=Y.value,Y.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=Y}},Vo={provide:vt,useExisting:(0,w.Gpc)(()=>hs)},Hs=(()=>Promise.resolve())();let hs=(()=>{class J extends vt{constructor(G,Ee,wn,Mi,uo,Tn){super(),this._changeDetectorRef=uo,this.callSetDisabledState=Tn,this.control=new Pi,this._registered=!1,this.update=new w.vpe,this._parent=G,this._setValidators(Ee),this._setAsyncValidators(wn),this.valueAccessor=ii(0,Mi)}ngOnChanges(G){if(this._checkForErrors(),!this._registered||"name"in G){if(this._registered&&(this._checkName(),this.formDirective)){const Ee=G.name.previousValue;this.formDirective.removeControl({name:Ee,path:this._getPath(Ee)})}this._setUpControl()}"isDisabled"in G&&this._updateDisabled(G),Ro(G,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(G){this.viewModel=G,this.update.emit(G)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){en(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(G){Hs.then(()=>{this.control.setValue(G,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(G){const Ee=G.isDisabled.currentValue,wn=0!==Ee&&(0,w.D6c)(Ee);Hs.then(()=>{wn&&!this.control.disabled?this.control.disable():!wn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(G){return this._parent?ut(G,this._parent):[G]}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(Se,9),w.Y36(ht,10),w.Y36(Gt,10),w.Y36(Ce,10),w.Y36(w.sBO,8),w.Y36(te,8))},J.\u0275dir=w.lG2({type:J,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[w._Bn([Vo]),w.qOj,w.TTD]}),J})(),Dr=(()=>{class J{}return J.\u0275fac=function(G){return new(G||J)},J.\u0275dir=w.lG2({type:J,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),J})();const Io={provide:Ce,useExisting:(0,w.Gpc)(()=>Gs),multi:!0};let Gs=(()=>{class J extends it{writeValue(G){this.setProperty("value",G??"")}registerOnChange(G){this.onChange=Ee=>{G(""==Ee?null:parseFloat(Ee))}}}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("input",function(Mi){return Ee.onChange(Mi.target.value)})("blur",function(){return Ee.onTouched()})},features:[w._Bn([Io]),w.qOj]}),J})();const po={provide:Ce,useExisting:(0,w.Gpc)(()=>dr),multi:!0};let jo=(()=>{class J{}return J.\u0275fac=function(G){return new(G||J)},J.\u0275mod=w.oAB({type:J}),J.\u0275inj=w.cJS({}),J})(),ys=(()=>{class J{constructor(){this._accessors=[]}add(G,Ee){this._accessors.push([G,Ee])}remove(G){for(let Ee=this._accessors.length-1;Ee>=0;--Ee)if(this._accessors[Ee][1]===G)return void this._accessors.splice(Ee,1)}select(G){this._accessors.forEach(Ee=>{this._isSameGroup(Ee,G)&&Ee[1]!==G&&Ee[1].fireUncheck(G.value)})}_isSameGroup(G,Ee){return!!G[0].control&&G[0]._parent===Ee._control._parent&&G[1].name===Ee.name}}return J.\u0275fac=function(G){return new(G||J)},J.\u0275prov=w.Yz7({token:J,factory:J.\u0275fac,providedIn:jo}),J})(),dr=(()=>{class J extends it{constructor(G,Ee,wn,Mi){super(G,Ee),this._registry=wn,this._injector=Mi,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=(0,w.f3M)(te,{optional:!0})??ge}ngOnInit(){this._control=this._injector.get(vt),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(G){this._state=G===this.value,this.setProperty("checked",this._state)}registerOnChange(G){this._fn=G,this.onChange=()=>{G(this.value),this._registry.select(this)}}setDisabledState(G){(this.setDisabledStateFired||G||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",G),this.setDisabledStateFired=!0}fireUncheck(G){this.writeValue(G)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(ys),w.Y36(w.zs3))},J.\u0275dir=w.lG2({type:J,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("change",function(){return Ee.onChange()})("blur",function(){return Ee.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[w._Bn([po]),w.qOj]}),J})();const lo=new w.OlP("NgModelWithFormControlWarning"),is={provide:Se,useExisting:(0,w.Gpc)(()=>no)};let no=(()=>{class J extends Se{constructor(G,Ee,wn){super(),this.callSetDisabledState=wn,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new w.vpe,this._setValidators(G),this._setAsyncValidators(Ee)}ngOnChanges(G){this._checkFormPresent(),G.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(gi(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(G){const Ee=this.form.get(G.path);return en(Ee,G,this.callSetDisabledState),Ee.updateValueAndValidity({emitEvent:!1}),this.directives.push(G),Ee}getControl(G){return this.form.get(G.path)}removeControl(G){Xt(G.control||null,G,!1),function Gi(J,Y){const G=J.indexOf(Y);G>-1&&J.splice(G,1)}(this.directives,G)}addFormGroup(G){this._setUpFormContainer(G)}removeFormGroup(G){this._cleanUpFormContainer(G)}getFormGroup(G){return this.form.get(G.path)}addFormArray(G){this._setUpFormContainer(G)}removeFormArray(G){this._cleanUpFormContainer(G)}getFormArray(G){return this.form.get(G.path)}updateModel(G,Ee){this.form.get(G.path).setValue(Ee)}onSubmit(G){return this.submitted=!0,Pr(this.form,this.directives),this.ngSubmit.emit(G),"dialog"===G?.target?.method}onReset(){this.resetForm()}resetForm(G){this.form.reset(G),this.submitted=!1}_updateDomValue(){this.directives.forEach(G=>{const Ee=G.control,wn=this.form.get(G.path);Ee!==wn&&(Xt(Ee||null,G),(J=>J instanceof Pi)(wn)&&(en(wn,G,this.callSetDisabledState),G.control=wn))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(G){const Ee=this.form.get(G.path);ir(Ee,G),Ee.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(G){if(this.form){const Ee=this.form.get(G.path);Ee&&function Ki(J,Y){return gi(J,Y)}(Ee,G)&&Ee.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){ci(this.form,this),this._oldForm&&gi(this._oldForm,this)}_checkFormPresent(){}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(ht,10),w.Y36(Gt,10),w.Y36(te,8))},J.\u0275dir=w.lG2({type:J,selectors:[["","formGroup",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("submit",function(Mi){return Ee.onSubmit(Mi)})("reset",function(){return Ee.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[w._Bn([is]),w.qOj,w.TTD]}),J})();const Qs={provide:vt,useExisting:(0,w.Gpc)(()=>Ca)};let Ca=(()=>{class J extends vt{set isDisabled(G){}constructor(G,Ee,wn,Mi,uo){super(),this._ngModelWarningConfig=uo,this._added=!1,this.update=new w.vpe,this._ngModelWarningSent=!1,this._parent=G,this._setValidators(Ee),this._setAsyncValidators(wn),this.valueAccessor=ii(0,Mi)}ngOnChanges(G){this._added||this._setUpControl(),Ro(G,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(G){this.viewModel=G,this.update.emit(G)}get path(){return ut(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return J._ngModelWarningSentOnce=!1,J.\u0275fac=function(G){return new(G||J)(w.Y36(Se,13),w.Y36(ht,10),w.Y36(Gt,10),w.Y36(Ce,10),w.Y36(lo,8))},J.\u0275dir=w.lG2({type:J,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[w._Bn([Qs]),w.qOj,w.TTD]}),J})();const Ma={provide:Ce,useExisting:(0,w.Gpc)(()=>Ps),multi:!0};function Is(J,Y){return null==J?`${Y}`:(Y&&"object"==typeof Y&&(Y="Object"),`${J}: ${Y}`.slice(0,50))}let Ps=(()=>{class J extends it{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(G){this._compareWith=G}writeValue(G){this.value=G;const wn=Is(this._getOptionId(G),G);this.setProperty("value",wn)}registerOnChange(G){this.onChange=Ee=>{this.value=this._getOptionValue(Ee),G(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(G){for(const Ee of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Ee),G))return Ee;return null}_getOptionValue(G){const Ee=function Js(J){return J.split(":")[0]}(G);return this._optionMap.has(Ee)?this._optionMap.get(Ee):G}}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("change",function(Mi){return Ee.onChange(Mi.target.value)})("blur",function(){return Ee.onTouched()})},inputs:{compareWith:"compareWith"},features:[w._Bn([Ma]),w.qOj]}),J})(),Os=(()=>{class J{constructor(G,Ee,wn){this._element=G,this._renderer=Ee,this._select=wn,this._select&&(this.id=this._select._registerOption())}set ngValue(G){null!=this._select&&(this._select._optionMap.set(this.id,G),this._setElementValue(Is(this.id,G)),this._select.writeValue(this._select.value))}set value(G){this._setElementValue(G),this._select&&this._select.writeValue(this._select.value)}_setElementValue(G){this._renderer.setProperty(this._element.nativeElement,"value",G)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(Ps,9))},J.\u0275dir=w.lG2({type:J,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),J})();const rs={provide:Ce,useExisting:(0,w.Gpc)(()=>vs),multi:!0};function Va(J,Y){return null==J?`${Y}`:("string"==typeof Y&&(Y=`'${Y}'`),Y&&"object"==typeof Y&&(Y="Object"),`${J}: ${Y}`.slice(0,50))}let vs=(()=>{class J extends it{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(G){this._compareWith=G}writeValue(G){let Ee;if(this.value=G,Array.isArray(G)){const wn=G.map(Mi=>this._getOptionId(Mi));Ee=(Mi,uo)=>{Mi._setSelected(wn.indexOf(uo.toString())>-1)}}else Ee=(wn,Mi)=>{wn._setSelected(!1)};this._optionMap.forEach(Ee)}registerOnChange(G){this.onChange=Ee=>{const wn=[],Mi=Ee.selectedOptions;if(void 0!==Mi){const uo=Mi;for(let Tn=0;Tn<uo.length;Tn++){const ws=this._getOptionValue(uo[Tn].value);wn.push(ws)}}else{const uo=Ee.options;for(let Tn=0;Tn<uo.length;Tn++){const sr=uo[Tn];if(sr.selected){const ws=this._getOptionValue(sr.value);wn.push(ws)}}}this.value=wn,G(wn)}}_registerOption(G){const Ee=(this._idCounter++).toString();return this._optionMap.set(Ee,G),Ee}_getOptionId(G){for(const Ee of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Ee)._value,G))return Ee;return null}_getOptionValue(G){const Ee=function yo(J){return J.split(":")[0]}(G);return this._optionMap.has(Ee)?this._optionMap.get(Ee)._value:G}}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(G,Ee){1&G&&w.NdJ("change",function(Mi){return Ee.onChange(Mi.target)})("blur",function(){return Ee.onTouched()})},inputs:{compareWith:"compareWith"},features:[w._Bn([rs]),w.qOj]}),J})(),ma=(()=>{class J{constructor(G,Ee,wn){this._element=G,this._renderer=Ee,this._select=wn,this._select&&(this.id=this._select._registerOption(this))}set ngValue(G){null!=this._select&&(this._value=G,this._setElementValue(Va(this.id,G)),this._select.writeValue(this._select.value))}set value(G){this._select?(this._value=G,this._setElementValue(Va(this.id,G)),this._select.writeValue(this._select.value)):this._setElementValue(G)}_setElementValue(G){this._renderer.setProperty(this._element.nativeElement,"value",G)}_setSelected(G){this._renderer.setProperty(this._element.nativeElement,"selected",G)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return J.\u0275fac=function(G){return new(G||J)(w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(vs,9))},J.\u0275dir=w.lG2({type:J,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),J})(),ta=(()=>{class J{constructor(){this._validator=Et}ngOnChanges(G){if(this.inputName in G){const Ee=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(Ee),this._validator=this._enabled?this.createValidator(Ee):Et,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}}return J.\u0275fac=function(G){return new(G||J)},J.\u0275dir=w.lG2({type:J,features:[w.TTD]}),J})();const ga={provide:ht,useExisting:(0,w.Gpc)(()=>ko),multi:!0};let ko=(()=>{class J extends ta{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=w.D6c,this.createValidator=G=>mt}enabled(G){return G}}return J.\u0275fac=function(){let Y;return function(Ee){return(Y||(Y=w.n5z(J)))(Ee||J)}}(),J.\u0275dir=w.lG2({type:J,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(G,Ee){2&G&&w.uIk("required",Ee._enabled?"":null)},inputs:{required:"required"},features:[w._Bn([ga]),w.qOj]}),J})(),Bn=(()=>{class J{}return J.\u0275fac=function(G){return new(G||J)},J.\u0275mod=w.oAB({type:J}),J.\u0275inj=w.cJS({imports:[jo]}),J})();class xi extends ae{constructor(Y,G,Ee){super(De(G),be(Ee,G)),this.controls=Y,this._initObservables(),this._setUpdateStrategy(G),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(Y){return this.controls[this._adjustIndex(Y)]}push(Y,G={}){this.controls.push(Y),this._registerControl(Y),this.updateValueAndValidity({emitEvent:G.emitEvent}),this._onCollectionChange()}insert(Y,G,Ee={}){this.controls.splice(Y,0,G),this._registerControl(G),this.updateValueAndValidity({emitEvent:Ee.emitEvent})}removeAt(Y,G={}){let Ee=this._adjustIndex(Y);Ee<0&&(Ee=0),this.controls[Ee]&&this.controls[Ee]._registerOnCollectionChange(()=>{}),this.controls.splice(Ee,1),this.updateValueAndValidity({emitEvent:G.emitEvent})}setControl(Y,G,Ee={}){let wn=this._adjustIndex(Y);wn<0&&(wn=0),this.controls[wn]&&this.controls[wn]._registerOnCollectionChange(()=>{}),this.controls.splice(wn,1),G&&(this.controls.splice(wn,0,G),this._registerControl(G)),this.updateValueAndValidity({emitEvent:Ee.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(Y,G={}){Q(this,!1,Y),Y.forEach((Ee,wn)=>{pe(this,!1,wn),this.at(wn).setValue(Ee,{onlySelf:!0,emitEvent:G.emitEvent})}),this.updateValueAndValidity(G)}patchValue(Y,G={}){null!=Y&&(Y.forEach((Ee,wn)=>{this.at(wn)&&this.at(wn).patchValue(Ee,{onlySelf:!0,emitEvent:G.emitEvent})}),this.updateValueAndValidity(G))}reset(Y=[],G={}){this._forEachChild((Ee,wn)=>{Ee.reset(Y[wn],{onlySelf:!0,emitEvent:G.emitEvent})}),this._updatePristine(G),this._updateTouched(G),this.updateValueAndValidity(G)}getRawValue(){return this.controls.map(Y=>Y.getRawValue())}clear(Y={}){this.controls.length<1||(this._forEachChild(G=>G._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:Y.emitEvent}))}_adjustIndex(Y){return Y<0?Y+this.length:Y}_syncPendingControls(){let Y=this.controls.reduce((G,Ee)=>!!Ee._syncPendingControls()||G,!1);return Y&&this.updateValueAndValidity({onlySelf:!0}),Y}_forEachChild(Y){this.controls.forEach((G,Ee)=>{Y(G,Ee)})}_updateValue(){this.value=this.controls.filter(Y=>Y.enabled||this.disabled).map(Y=>Y.value)}_anyControls(Y){return this.controls.some(G=>G.enabled&&Y(G))}_setUpControls(){this._forEachChild(Y=>this._registerControl(Y))}_allControlsDisabled(){for(const Y of this.controls)if(Y.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(Y){Y.setParent(this),Y._registerOnCollectionChange(this._onCollectionChange)}_find(Y){return this.at(Y)??null}}function Vr(J){return!!J&&(void 0!==J.asyncValidators||void 0!==J.validators||void 0!==J.updateOn)}let Ho=(()=>{class J{constructor(){this.useNonNullable=!1}get nonNullable(){const G=new J;return G.useNonNullable=!0,G}group(G,Ee=null){const wn=this._reduceControls(G);let Mi={};return Vr(Ee)?Mi=Ee:null!==Ee&&(Mi.validators=Ee.validator,Mi.asyncValidators=Ee.asyncValidator),new ye(wn,Mi)}record(G,Ee=null){const wn=this._reduceControls(G);return new xe(wn,Ee)}control(G,Ee,wn){let Mi={};return this.useNonNullable?(Vr(Ee)?Mi=Ee:(Mi.validators=Ee,Mi.asyncValidators=wn),new Pi(G,{...Mi,nonNullable:!0})):new Pi(G,Ee,wn)}array(G,Ee,wn){const Mi=G.map(uo=>this._createControl(uo));return new xi(Mi,Ee,wn)}_reduceControls(G){const Ee={};return Object.keys(G).forEach(wn=>{Ee[wn]=this._createControl(G[wn])}),Ee}_createControl(G){return G instanceof Pi||G instanceof ae?G:Array.isArray(G)?this.control(G[0],G.length>1?G[1]:null,G.length>2?G[2]:null):this.control(G)}}return J.\u0275fac=function(G){return new(G||J)},J.\u0275prov=w.Yz7({token:J,factory:J.\u0275fac,providedIn:"root"}),J})(),Ai=(()=>{class J{static withConfig(G){return{ngModule:J,providers:[{provide:te,useValue:G.callSetDisabledState??ge}]}}}return J.\u0275fac=function(G){return new(G||J)},J.\u0275mod=w.oAB({type:J}),J.\u0275inj=w.cJS({imports:[Bn]}),J})(),Zs=(()=>{class J{static withConfig(G){return{ngModule:J,providers:[{provide:lo,useValue:G.warnOnNgModelWithFormControl??"always"},{provide:te,useValue:G.callSetDisabledState??ge}]}}}return J.\u0275fac=function(G){return new(G||J)},J.\u0275mod=w.oAB({type:J}),J.\u0275inj=w.cJS({imports:[Bn]}),J})()},7957:(Yn,kt,L)=>{"use strict";L.d(kt,{Bb:()=>fn,XC:()=>Bt,ZL:()=>Tt});var w=L(2687),y=L(1281),j=L(3353),a=L(4650),de=L(3238),Qe=L(727),it=L(7579),Ce=L(9770),Fe=L(6451),$e=L(9646),at=L(4968),qe=L(6895),Ve=L(8184),tt=L(8605),Re=L(445),ft=L(9521),et=L(4080),ht=L(4006),Gt=L(9549),an=L(8675),ot=L(3900),Te=L(5698),Ne=L(9300),mt=L(4004),It=L(8505),sn=L(1005);const Cn=["panel"];function Yt(me,Rt){if(1&me&&(a.TgZ(0,"div",0,1),a.Hsn(2),a.qZA()),2&me){const Se=Rt.id,vt=a.oxw();a.Q6J("id",vt.id)("ngClass",vt._classList),a.uIk("aria-label",vt.ariaLabel||null)("aria-labelledby",vt._getPanelAriaLabelledby(Se))}}const nt=["*"];let Et=0;class ct{constructor(Rt,Se){this.source=Rt,this.option=Se}}const Pn=(0,de.Kr)(class{}),Nn=new a.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function fi(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1}}});let Ci=(()=>{class me extends Pn{constructor(Se,vt,jn,li){super(),this._changeDetectorRef=Se,this._elementRef=vt,this._activeOptionChanges=Qe.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new a.vpe,this.opened=new a.vpe,this.closed=new a.vpe,this.optionActivated=new a.vpe,this._classList={},this.id="mat-autocomplete-"+Et++,this.inertGroups=li?.SAFARI||!1,this._autoActiveFirstOption=!!jn.autoActiveFirstOption,this._autoSelectActiveOption=!!jn.autoSelectActiveOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(Se){this._autoActiveFirstOption=(0,y.Ig)(Se)}get autoSelectActiveOption(){return this._autoSelectActiveOption}set autoSelectActiveOption(Se){this._autoSelectActiveOption=(0,y.Ig)(Se)}set classList(Se){this._classList=Se&&Se.length?(0,y.du)(Se).reduce((vt,jn)=>(vt[jn]=!0,vt),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new w.s1(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(Se=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[Se]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(Se){this.panel&&(this.panel.nativeElement.scrollTop=Se)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(Se){const vt=new ct(this,Se);this.optionSelected.emit(vt)}_getPanelAriaLabelledby(Se){return this.ariaLabel?null:this.ariaLabelledby?(Se?Se+" ":"")+this.ariaLabelledby:Se}_setVisibilityClasses(Se){Se[this._visibleClass]=this.showPanel,Se[this._hiddenClass]=!this.showPanel}}return me.\u0275fac=function(Se){return new(Se||me)(a.Y36(a.sBO),a.Y36(a.SBq),a.Y36(Nn),a.Y36(j.t4))},me.\u0275dir=a.lG2({type:me,viewQuery:function(Se,vt){if(1&Se&&(a.Gf(a.Rgc,7),a.Gf(Cn,5)),2&Se){let jn;a.iGM(jn=a.CRH())&&(vt.template=jn.first),a.iGM(jn=a.CRH())&&(vt.panel=jn.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[a.qOj]}),me})(),Bt=(()=>{class me extends Ci{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return me.\u0275fac=function(){let Rt;return function(vt){return(Rt||(Rt=a.n5z(me)))(vt||me)}}(),me.\u0275cmp=a.Xpm({type:me,selectors:[["mat-autocomplete"]],contentQueries:function(Se,vt,jn){if(1&Se&&(a.Suo(jn,de.K7,5),a.Suo(jn,de.ey,5)),2&Se){let li;a.iGM(li=a.CRH())&&(vt.optionGroups=li),a.iGM(li=a.CRH())&&(vt.options=li)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[a._Bn([{provide:de.HF,useExisting:me}]),a.qOj],ngContentSelectors:nt,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(Se,vt){1&Se&&(a.F$t(),a.YNc(0,Yt,3,4,"ng-template"))},dependencies:[qe.mk],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}"],encapsulation:2,changeDetection:0}),me})();const Ct=new a.OlP("mat-autocomplete-scroll-strategy"),ze={provide:Ct,deps:[Ve.aV],useFactory:function Jt(me){return()=>me.scrollStrategies.reposition()}},zt={provide:ht.JU,useExisting:(0,a.Gpc)(()=>Tt),multi:!0};let Lt=(()=>{class me{constructor(Se,vt,jn,li,Bi,dn,ue,ke,xt,lt,Vt){this._element=Se,this._overlay=vt,this._viewContainerRef=jn,this._zone=li,this._changeDetectorRef=Bi,this._dir=ue,this._formField=ke,this._document=xt,this._viewportRuler=lt,this._defaults=Vt,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Qe.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new it.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,Ce.P)(()=>{const An=this.autocomplete?this.autocomplete.options:null;return An?An.changes.pipe((0,an.O)(An),(0,ot.w)(()=>(0,Fe.T)(...An.map(Fn=>Fn.onSelectionChange)))):this._zone.onStable.pipe((0,Te.q)(1),(0,ot.w)(()=>this.optionSelections))}),this._scrollStrategy=dn}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(Se){this._autocompleteDisabled=(0,y.Ig)(Se)}ngAfterViewInit(){const Se=this._getWindow();typeof Se<"u"&&this._zone.runOutsideAngular(()=>Se.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(Se){Se.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const Se=this._getWindow();typeof Se<"u"&&Se.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,Fe.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,Ne.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,Ne.h)(()=>this._overlayAttached)):(0,$e.of)()).pipe((0,mt.U)(Se=>Se instanceof de.rN?Se:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,Fe.T)((0,at.R)(this._document,"click"),(0,at.R)(this._document,"auxclick"),(0,at.R)(this._document,"touchend")).pipe((0,Ne.h)(Se=>{const vt=(0,j.sA)(Se),jn=this._formField?this._formField._elementRef.nativeElement:null,li=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&vt!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!jn||!jn.contains(vt))&&(!li||!li.contains(vt))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(vt)}))}writeValue(Se){Promise.resolve(null).then(()=>this._assignOptionValue(Se))}registerOnChange(Se){this._onChange=Se}registerOnTouched(Se){this._onTouched=Se}setDisabledState(Se){this._element.nativeElement.disabled=Se}_handleKeydown(Se){const vt=Se.keyCode,jn=(0,ft.Vb)(Se);if(vt===ft.hY&&!jn&&Se.preventDefault(),this.activeOption&&vt===ft.K5&&this.panelOpen&&!jn)this.activeOption._selectViaInteraction(),this._resetActiveItem(),Se.preventDefault();else if(this.autocomplete){const li=this.autocomplete._keyManager.activeItem,Bi=vt===ft.LH||vt===ft.JH;vt===ft.Mf||Bi&&!jn&&this.panelOpen?this.autocomplete._keyManager.onKeydown(Se):Bi&&this._canOpen()&&this.openPanel(),(Bi||this.autocomplete._keyManager.activeItem!==li)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(Se){let vt=Se.target,jn=vt.value;"number"===vt.type&&(jn=""==jn?null:parseFloat(jn)),this._previousValue!==jn&&(this._previousValue=jn,this._pendingAutoselectedOption=null,this._onChange(jn),this._canOpen()&&this._document.activeElement===Se.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(Se=!1){this._formField&&"auto"===this._formField.floatLabel&&(Se?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const Se=this._zone.onStable.pipe((0,Te.q)(1)),vt=this.autocomplete.options.changes.pipe((0,It.b)(()=>this._positionStrategy.reapplyLastPosition()),(0,sn.g)(0));return(0,Fe.T)(Se,vt).pipe((0,ot.w)(()=>(this._zone.run(()=>{const jn=this.panelOpen;this._resetActiveItem(),this.autocomplete._setVisibility(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),jn!==this.panelOpen&&(this.panelOpen?this.autocomplete.opened.emit():this.autocomplete.closed.emit())}),this.panelClosingActions)),(0,Te.q)(1)).subscribe(jn=>this._setValueAndClose(jn))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_assignOptionValue(Se){const vt=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(Se):Se;this._updateNativeInputValue(vt??"")}_updateNativeInputValue(Se){this._formField?this._formField._control.value=Se:this._element.nativeElement.value=Se,this._previousValue=Se}_setValueAndClose(Se){const vt=Se?Se.source:this._pendingAutoselectedOption;vt&&(this._clearPreviousSelectedOption(vt),this._assignOptionValue(vt.value),this._onChange(vt.value),this.autocomplete._emitSelectEvent(vt),this._element.nativeElement.focus()),this.closePanel()}_clearPreviousSelectedOption(Se){this.autocomplete.options.forEach(vt=>{vt!==Se&&vt.selected&&vt.deselect()})}_attachOverlay(){let Se=this._overlayRef;Se?(this._positionStrategy.setOrigin(this._getConnectedElement()),Se.updateSize({width:this._getPanelWidth()})):(this._portal=new et.UE(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),Se=this._overlay.create(this._getOverlayConfig()),this._overlayRef=Se,this._handleOverlayEvents(Se),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&Se&&Se.updateSize({width:this._getPanelWidth()})})),Se&&!Se.hasAttached()&&(Se.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const vt=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&vt!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){return new Ve.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const Se=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(Se),this._positionStrategy=Se,Se}_setStrategyPositions(Se){const vt=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],jn=this._aboveClass,li=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:jn},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:jn}];let Bi;Bi="above"===this.position?li:"below"===this.position?vt:[...vt,...li],Se.withPositions(Bi)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const Se=this.autocomplete;Se.autoActiveFirstOption?Se._keyManager.setFirstItemActive():Se._keyManager.setActiveItem(-1)}_canOpen(){const Se=this._element.nativeElement;return!Se.readOnly&&!Se.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(Se){const vt=this.autocomplete,jn=(0,de.CB)(Se,vt.options,vt.optionGroups);if(0===Se&&1===jn)vt._setScrollTop(0);else if(vt.panel){const li=vt.options.toArray()[Se];if(li){const Bi=li._getHostElement(),dn=(0,de.jH)(Bi.offsetTop,Bi.offsetHeight,vt._getScrollTop(),vt.panel.nativeElement.offsetHeight);vt._setScrollTop(dn)}}}_handleOverlayEvents(Se){Se.keydownEvents().subscribe(vt=>{(vt.keyCode===ft.hY&&!(0,ft.Vb)(vt)||vt.keyCode===ft.LH&&(0,ft.Vb)(vt,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),vt.stopPropagation(),vt.preventDefault())}),Se.outsidePointerEvents().subscribe()}}return me.\u0275fac=function(Se){return new(Se||me)(a.Y36(a.SBq),a.Y36(Ve.aV),a.Y36(a.s_b),a.Y36(a.R0b),a.Y36(a.sBO),a.Y36(Ct),a.Y36(Re.Is,8),a.Y36(Gt.G_,9),a.Y36(qe.K0,8),a.Y36(tt.rL),a.Y36(Nn,8))},me.\u0275dir=a.lG2({type:me,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[a.TTD]}),me})(),Tt=(()=>{class me extends Lt{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return me.\u0275fac=function(){let Rt;return function(vt){return(Rt||(Rt=a.n5z(me)))(vt||me)}}(),me.\u0275dir=a.lG2({type:me,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(Se,vt){1&Se&&a.NdJ("focusin",function(){return vt._handleFocus()})("blur",function(){return vt._onTouched()})("input",function(li){return vt._handleInput(li)})("keydown",function(li){return vt._handleKeydown(li)})("click",function(){return vt._handleClick()}),2&Se&&a.uIk("autocomplete",vt.autocompleteAttribute)("role",vt.autocompleteDisabled?null:"combobox")("aria-autocomplete",vt.autocompleteDisabled?null:"list")("aria-activedescendant",vt.panelOpen&&vt.activeOption?vt.activeOption.id:null)("aria-expanded",vt.autocompleteDisabled?null:vt.panelOpen.toString())("aria-owns",vt.autocompleteDisabled||!vt.panelOpen||null==vt.autocomplete?null:vt.autocomplete.id)("aria-haspopup",vt.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[a._Bn([zt]),a.qOj]}),me})(),fn=(()=>{class me{}return me.\u0275fac=function(Se){return new(Se||me)},me.\u0275mod=a.oAB({type:me}),me.\u0275inj=a.cJS({providers:[ze],imports:[Ve.U8,de.Ng,de.BQ,qe.ez,tt.ZD,de.Ng,de.BQ]}),me})()},4859:(Yn,kt,L)=>{"use strict";L.d(kt,{lW:()=>$e,ot:()=>qe});var w=L(4650),y=L(3238),j=L(2687);const a=["mat-button",""],de=["*"],Ce=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],Fe=(0,y.pj)((0,y.Id)((0,y.Kr)(class{constructor(Ve){this._elementRef=Ve}})));let $e=(()=>{class Ve extends Fe{constructor(Re,ft,et){super(Re),this._focusMonitor=ft,this._animationMode=et,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const ht of Ce)this._hasHostAttributes(ht)&&this._getHostElement().classList.add(ht);Re.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(Re,ft){Re?this._focusMonitor.focusVia(this._getHostElement(),Re,ft):this._getHostElement().focus(ft)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...Re){return Re.some(ft=>this._getHostElement().hasAttribute(ft))}}return Ve.\u0275fac=function(Re){return new(Re||Ve)(w.Y36(w.SBq),w.Y36(j.tE),w.Y36(w.QbO,8))},Ve.\u0275cmp=w.Xpm({type:Ve,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(Re,ft){if(1&Re&&w.Gf(y.wG,5),2&Re){let et;w.iGM(et=w.CRH())&&(ft.ripple=et.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(Re,ft){2&Re&&(w.uIk("disabled",ft.disabled||null),w.ekj("_mat-animation-noopable","NoopAnimations"===ft._animationMode)("mat-button-disabled",ft.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[w.qOj],attrs:a,ngContentSelectors:de,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(Re,ft){1&Re&&(w.F$t(),w.TgZ(0,"span",0),w.Hsn(1),w.qZA(),w._UZ(2,"span",1)(3,"span",2)),2&Re&&(w.xp6(2),w.ekj("mat-button-ripple-round",ft.isRoundButton||ft.isIconButton),w.Q6J("matRippleDisabled",ft._isRippleDisabled())("matRippleCentered",ft.isIconButton)("matRippleTrigger",ft._getHostElement()))},dependencies:[y.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}.mat-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0);display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.mat-flat-button::before,.mat-raised-button::before,.mat-fab::before,.mat-mini-fab::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px) * -1)}.mat-stroked-button::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px) * -1)}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}"],encapsulation:2,changeDetection:0}),Ve})(),qe=(()=>{class Ve{}return Ve.\u0275fac=function(Re){return new(Re||Ve)},Ve.\u0275mod=w.oAB({type:Ve}),Ve.\u0275inj=w.cJS({imports:[y.si,y.BQ,y.BQ]}),Ve})()},3238:(Yn,kt,L)=>{"use strict";L.d(kt,{rD:()=>zt,K7:()=>Ae,HF:()=>An,BQ:()=>ot,X2:()=>ve,uc:()=>fn,ey:()=>Li,Ng:()=>Ir,rN:()=>ln,nP:()=>lt,us:()=>Vt,wG:()=>ke,si:()=>xt,CB:()=>Qi,jH:()=>Ii,pj:()=>sn,Kr:()=>Cn,Id:()=>It,FD:()=>nt,sb:()=>Yt,E0:()=>Lt});var w=L(4650),y=L(2687),j=L(445),de=L(6895),Qe=L(3353),it=L(1281),Ce=L(7579),Fe=L(8675),$e=L(9521);function Ve(Kt,Ft){if(1&Kt&&w._UZ(0,"mat-pseudo-checkbox",4),2&Kt){const _t=w.oxw();w.Q6J("state",_t.selected?"checked":"unchecked")("disabled",_t.disabled)}}function tt(Kt,Ft){if(1&Kt&&(w.TgZ(0,"span",5),w._uU(1),w.qZA()),2&Kt){const _t=w.oxw();w.xp6(1),w.hij("(",_t.group.label,")")}}const Re=["*"],an=new w.OlP("mat-sanity-checks",{providedIn:"root",factory:function Gt(){return!0}});let ot=(()=>{class Kt{constructor(_t,bn,Ut){this._sanityChecks=bn,this._document=Ut,this._hasDoneGlobalChecks=!1,_t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(_t){return!(0,Qe.Oy)()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[_t])}}return Kt.\u0275fac=function(_t){return new(_t||Kt)(w.LFG(y.qm),w.LFG(an,8),w.LFG(de.K0))},Kt.\u0275mod=w.oAB({type:Kt}),Kt.\u0275inj=w.cJS({imports:[j.vT,j.vT]}),Kt})();function It(Kt){return class extends Kt{constructor(...Ft){super(...Ft),this._disabled=!1}get disabled(){return this._disabled}set disabled(Ft){this._disabled=(0,it.Ig)(Ft)}}}function sn(Kt,Ft){return class extends Kt{constructor(..._t){super(..._t),this.defaultColor=Ft,this.color=Ft}get color(){return this._color}set color(_t){const bn=_t||this.defaultColor;bn!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),bn&&this._elementRef.nativeElement.classList.add(`mat-${bn}`),this._color=bn)}}}function Cn(Kt){return class extends Kt{constructor(...Ft){super(...Ft),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(Ft){this._disableRipple=(0,it.Ig)(Ft)}}}function Yt(Kt,Ft=0){return class extends Kt{constructor(..._t){super(..._t),this._tabIndex=Ft,this.defaultTabIndex=Ft}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(_t){this._tabIndex=null!=_t?(0,it.su)(_t):this.defaultTabIndex}}}function nt(Kt){return class extends Kt{constructor(...Ft){super(...Ft),this.errorState=!1}updateErrorState(){const Ft=this.errorState,De=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);De!==Ft&&(this.errorState=De,this.stateChanges.next())}}}let zt=(()=>{class Kt{isErrorState(_t,bn){return!!(_t&&_t.invalid&&(_t.touched||bn&&bn.submitted))}}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275prov=w.Yz7({token:Kt,factory:Kt.\u0275fac,providedIn:"root"}),Kt})(),ve=(()=>{class Kt{}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275dir=w.lG2({type:Kt,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),Kt})();function Lt(Kt,Ft,_t="mat"){Kt.changes.pipe((0,Fe.O)(Kt)).subscribe(({length:bn})=>{Tt(Ft,`${_t}-2-line`,!1),Tt(Ft,`${_t}-3-line`,!1),Tt(Ft,`${_t}-multi-line`,!1),2===bn||3===bn?Tt(Ft,`${_t}-${bn}-line`,!0):bn>3&&Tt(Ft,`${_t}-multi-line`,!0)})}function Tt(Kt,Ft,_t){Kt.nativeElement.classList.toggle(Ft,_t)}let fn=(()=>{class Kt{}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275mod=w.oAB({type:Kt}),Kt.\u0275inj=w.cJS({imports:[ot,ot]}),Kt})();class me{constructor(Ft,_t,bn,Ut=!1){this._renderer=Ft,this.element=_t,this.config=bn,this._animationForciblyDisabledThroughCss=Ut,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const Rt={enterDuration:225,exitDuration:150},vt=(0,Qe.i$)({passive:!0}),jn=["mousedown","touchstart"],li=["mouseup","mouseleave","touchend","touchcancel"];class Bi{constructor(Ft,_t,bn,Ut){this._target=Ft,this._ngZone=_t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,Ut.isBrowser&&(this._containerElement=(0,it.fI)(bn))}fadeInRipple(Ft,_t,bn={}){const Ut=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),De={...Rt,...bn.animation};bn.centered&&(Ft=Ut.left+Ut.width/2,_t=Ut.top+Ut.height/2);const oe=bn.radius||function dn(Kt,Ft,_t){const bn=Math.max(Math.abs(Kt-_t.left),Math.abs(Kt-_t.right)),Ut=Math.max(Math.abs(Ft-_t.top),Math.abs(Ft-_t.bottom));return Math.sqrt(bn*bn+Ut*Ut)}(Ft,_t,Ut),be=Ft-Ut.left,wt=_t-Ut.top,$t=De.enterDuration,pe=document.createElement("div");pe.classList.add("mat-ripple-element"),pe.style.left=be-oe+"px",pe.style.top=wt-oe+"px",pe.style.height=2*oe+"px",pe.style.width=2*oe+"px",null!=bn.color&&(pe.style.backgroundColor=bn.color),pe.style.transitionDuration=`${$t}ms`,this._containerElement.appendChild(pe);const Q=window.getComputedStyle(pe),ye=Q.transitionDuration,Ge="none"===Q.transitionProperty||"0s"===ye||"0s, 0s"===ye,Ye=new me(this,pe,bn,Ge);pe.style.transform="scale3d(1, 1, 1)",Ye.state=0,bn.persistent||(this._mostRecentTransientRipple=Ye);let xe=null;return!Ge&&($t||De.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const fe=()=>this._finishRippleTransition(Ye),te=()=>this._destroyRipple(Ye);pe.addEventListener("transitionend",fe),pe.addEventListener("transitioncancel",te),xe={onTransitionEnd:fe,onTransitionCancel:te}}),this._activeRipples.set(Ye,xe),(Ge||!$t)&&this._finishRippleTransition(Ye),Ye}fadeOutRipple(Ft){if(2===Ft.state||3===Ft.state)return;const _t=Ft.element,bn={...Rt,...Ft.config.animation};_t.style.transitionDuration=`${bn.exitDuration}ms`,_t.style.opacity="0",Ft.state=2,(Ft._animationForciblyDisabledThroughCss||!bn.exitDuration)&&this._finishRippleTransition(Ft)}fadeOutAll(){this._getActiveRipples().forEach(Ft=>Ft.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(Ft=>{Ft.config.persistent||Ft.fadeOut()})}setupTriggerEvents(Ft){const _t=(0,it.fI)(Ft);!_t||_t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=_t,this._registerEvents(jn))}handleEvent(Ft){"mousedown"===Ft.type?this._onMousedown(Ft):"touchstart"===Ft.type?this._onTouchStart(Ft):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(li),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(Ft){0===Ft.state?this._startFadeOutTransition(Ft):2===Ft.state&&this._destroyRipple(Ft)}_startFadeOutTransition(Ft){const _t=Ft===this._mostRecentTransientRipple,{persistent:bn}=Ft.config;Ft.state=1,!bn&&(!_t||!this._isPointerDown)&&Ft.fadeOut()}_destroyRipple(Ft){const _t=this._activeRipples.get(Ft)??null;this._activeRipples.delete(Ft),this._activeRipples.size||(this._containerRect=null),Ft===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),Ft.state=3,null!==_t&&(Ft.element.removeEventListener("transitionend",_t.onTransitionEnd),Ft.element.removeEventListener("transitioncancel",_t.onTransitionCancel)),Ft.element.remove()}_onMousedown(Ft){const _t=(0,y.X6)(Ft),bn=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!_t&&!bn&&(this._isPointerDown=!0,this.fadeInRipple(Ft.clientX,Ft.clientY,this._target.rippleConfig))}_onTouchStart(Ft){if(!this._target.rippleDisabled&&!(0,y.yG)(Ft)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const _t=Ft.changedTouches;for(let bn=0;bn<_t.length;bn++)this.fadeInRipple(_t[bn].clientX,_t[bn].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(Ft=>{!Ft.config.persistent&&(1===Ft.state||Ft.config.terminateOnPointerUp&&0===Ft.state)&&Ft.fadeOut()}))}_registerEvents(Ft){this._ngZone.runOutsideAngular(()=>{Ft.forEach(_t=>{this._triggerElement.addEventListener(_t,this,vt)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(jn.forEach(Ft=>{this._triggerElement.removeEventListener(Ft,this,vt)}),this._pointerUpEventsRegistered&&li.forEach(Ft=>{this._triggerElement.removeEventListener(Ft,this,vt)}))}}const ue=new w.OlP("mat-ripple-global-options");let ke=(()=>{class Kt{constructor(_t,bn,Ut,De,oe){this._elementRef=_t,this._animationMode=oe,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=De||{},this._rippleRenderer=new Bi(this,bn,_t,Ut)}get disabled(){return this._disabled}set disabled(_t){_t&&this.fadeOutAllNonPersistent(),this._disabled=_t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(_t){this._trigger=_t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(_t,bn=0,Ut){return"number"==typeof _t?this._rippleRenderer.fadeInRipple(_t,bn,{...this.rippleConfig,...Ut}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,..._t})}}return Kt.\u0275fac=function(_t){return new(_t||Kt)(w.Y36(w.SBq),w.Y36(w.R0b),w.Y36(Qe.t4),w.Y36(ue,8),w.Y36(w.QbO,8))},Kt.\u0275dir=w.lG2({type:Kt,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(_t,bn){2&_t&&w.ekj("mat-ripple-unbounded",bn.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),Kt})(),xt=(()=>{class Kt{}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275mod=w.oAB({type:Kt}),Kt.\u0275inj=w.cJS({imports:[ot,ot]}),Kt})(),lt=(()=>{class Kt{constructor(_t){this._animationMode=_t,this.state="unchecked",this.disabled=!1}}return Kt.\u0275fac=function(_t){return new(_t||Kt)(w.Y36(w.QbO,8))},Kt.\u0275cmp=w.Xpm({type:Kt,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(_t,bn){2&_t&&w.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===bn.state)("mat-pseudo-checkbox-checked","checked"===bn.state)("mat-pseudo-checkbox-disabled",bn.disabled)("_mat-animation-noopable","NoopAnimations"===bn._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(_t,bn){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}'],encapsulation:2,changeDetection:0}),Kt})(),Vt=(()=>{class Kt{}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275mod=w.oAB({type:Kt}),Kt.\u0275inj=w.cJS({imports:[ot]}),Kt})();const An=new w.OlP("MAT_OPTION_PARENT_COMPONENT"),Ae=new w.OlP("MatOptgroup");let Dn=0;class ln{constructor(Ft,_t=!1){this.source=Ft,this.isUserInput=_t}}let mi=(()=>{class Kt{constructor(_t,bn,Ut,De){this._element=_t,this._changeDetectorRef=bn,this._parent=Ut,this.group=De,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Dn++,this.onSelectionChange=new w.vpe,this._stateChanges=new Ce.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(_t){this._disabled=(0,it.Ig)(_t)}get disableRipple(){return!(!this._parent||!this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(_t,bn){const Ut=this._getHostElement();"function"==typeof Ut.focus&&Ut.focus(bn)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(_t){(_t.keyCode===$e.K5||_t.keyCode===$e.L_)&&!(0,$e.Vb)(_t)&&(this._selectViaInteraction(),_t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const _t=this.viewValue;_t!==this._mostRecentViewValue&&(this._mostRecentViewValue=_t,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(_t=!1){this.onSelectionChange.emit(new ln(this,_t))}}return Kt.\u0275fac=function(_t){w.$Z()},Kt.\u0275dir=w.lG2({type:Kt,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),Kt})(),Li=(()=>{class Kt extends mi{constructor(_t,bn,Ut,De){super(_t,bn,Ut,De)}}return Kt.\u0275fac=function(_t){return new(_t||Kt)(w.Y36(w.SBq),w.Y36(w.sBO),w.Y36(An,8),w.Y36(Ae,8))},Kt.\u0275cmp=w.Xpm({type:Kt,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(_t,bn){1&_t&&w.NdJ("click",function(){return bn._selectViaInteraction()})("keydown",function(De){return bn._handleKeydown(De)}),2&_t&&(w.Ikx("id",bn.id),w.uIk("tabindex",bn._getTabIndex())("aria-selected",bn._getAriaSelected())("aria-disabled",bn.disabled.toString()),w.ekj("mat-selected",bn.selected)("mat-option-multiple",bn.multiple)("mat-active",bn.active)("mat-option-disabled",bn.disabled))},exportAs:["matOption"],features:[w.qOj],ngContentSelectors:Re,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(_t,bn){1&_t&&(w.F$t(),w.YNc(0,Ve,1,2,"mat-pseudo-checkbox",0),w.TgZ(1,"span",1),w.Hsn(2),w.qZA(),w.YNc(3,tt,2,1,"span",2),w._UZ(4,"div",3)),2&_t&&(w.Q6J("ngIf",bn.multiple),w.xp6(3),w.Q6J("ngIf",bn.group&&bn.group._inert),w.xp6(1),w.Q6J("matRippleTrigger",bn._getHostElement())("matRippleDisabled",bn.disabled||bn.disableRipple))},dependencies:[ke,de.O5,lt],styles:['.mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.mat-option.mat-active::before{content:""}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .cdk-high-contrast-active .mat-option.mat-selected:not(.mat-option-multiple)::after{right:auto;left:16px}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}'],encapsulation:2,changeDetection:0}),Kt})();function Qi(Kt,Ft,_t){if(_t.length){let bn=Ft.toArray(),Ut=_t.toArray(),De=0;for(let oe=0;oe<Kt+1;oe++)bn[oe].group&&bn[oe].group===Ut[De]&&De++;return De}return 0}function Ii(Kt,Ft,_t,bn){return Kt<_t?Kt:Kt+Ft>_t+bn?Math.max(0,Kt-bn+Ft):_t}let Ir=(()=>{class Kt{}return Kt.\u0275fac=function(_t){return new(_t||Kt)},Kt.\u0275mod=w.oAB({type:Kt}),Kt.\u0275inj=w.cJS({imports:[xt,de.ez,ot,Vt]}),Kt})()},7084:(Yn,kt,L)=>{"use strict";L.d(kt,{pp:()=>Tt,To:()=>fn,ib:()=>nn,yz:()=>zt,yK:()=>Lt});var w=L(4650),y=L(5017),j=L(1281),a=L(7579),de=L(727);let Qe=0;const it=new w.OlP("CdkAccordion");let Ce=(()=>{class me{constructor(){this._stateChanges=new a.x,this._openCloseAllActions=new a.x,this.id="cdk-accordion-"+Qe++,this._multi=!1}get multi(){return this._multi}set multi(Se){this._multi=(0,j.Ig)(Se)}openAll(){this._multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(Se){this._stateChanges.next(Se)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}}return me.\u0275fac=function(Se){return new(Se||me)},me.\u0275dir=w.lG2({type:me,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[w._Bn([{provide:it,useExisting:me}]),w.TTD]}),me})(),Fe=0,$e=(()=>{class me{constructor(Se,vt,jn){this.accordion=Se,this._changeDetectorRef=vt,this._expansionDispatcher=jn,this._openCloseAllSubscription=de.w0.EMPTY,this.closed=new w.vpe,this.opened=new w.vpe,this.destroyed=new w.vpe,this.expandedChange=new w.vpe,this.id="cdk-accordion-child-"+Fe++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=jn.listen((li,Bi)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===Bi&&this.id!==li&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(Se){Se=(0,j.Ig)(Se),this._expanded!==Se&&(this._expanded=Se,this.expandedChange.emit(Se),Se?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(Se){this._disabled=(0,j.Ig)(Se)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(Se=>{this.disabled||(this.expanded=Se)})}}return me.\u0275fac=function(Se){return new(Se||me)(w.Y36(it,12),w.Y36(w.sBO),w.Y36(y.A8))},me.\u0275dir=w.lG2({type:me,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[w._Bn([{provide:it,useValue:void 0}])]}),me})(),at=(()=>{class me{}return me.\u0275fac=function(Se){return new(Se||me)},me.\u0275mod=w.oAB({type:me}),me.\u0275inj=w.cJS({}),me})();var qe=L(4080),Ve=L(6895),tt=L(3238),Re=L(2687),ft=L(1884),et=L(8675),ht=L(9300),Gt=L(5698),an=L(9521),ot=L(515),Te=L(6451),Ne=L(7340);const mt=["body"];function It(me,Rt){}const sn=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],Cn=["mat-expansion-panel-header","*","mat-action-row"];function Yt(me,Rt){if(1&me&&w._UZ(0,"span",2),2&me){const Se=w.oxw();w.Q6J("@indicatorRotate",Se._getExpandedState())}}const nt=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Et=["mat-panel-title","mat-panel-description","*"],ct=new w.OlP("MAT_ACCORDION"),Pn="225ms cubic-bezier(0.4,0.0,0.2,1)",Nn={indicatorRotate:(0,Ne.X$)("indicatorRotate",[(0,Ne.SB)("collapsed, void",(0,Ne.oB)({transform:"rotate(0deg)"})),(0,Ne.SB)("expanded",(0,Ne.oB)({transform:"rotate(180deg)"})),(0,Ne.eR)("expanded <=> collapsed, void => collapsed",(0,Ne.jt)(Pn))]),bodyExpansion:(0,Ne.X$)("bodyExpansion",[(0,Ne.SB)("collapsed, void",(0,Ne.oB)({height:"0px",visibility:"hidden"})),(0,Ne.SB)("expanded",(0,Ne.oB)({height:"*",visibility:"visible"})),(0,Ne.eR)("expanded <=> collapsed, void => collapsed",(0,Ne.jt)(Pn))])},fi=new w.OlP("MAT_EXPANSION_PANEL");let Ci=(()=>{class me{constructor(Se,vt){this._template=Se,this._expansionPanel=vt}}return me.\u0275fac=function(Se){return new(Se||me)(w.Y36(w.Rgc),w.Y36(fi,8))},me.\u0275dir=w.lG2({type:me,selectors:[["ng-template","matExpansionPanelContent",""]]}),me})(),Bt=0;const Zt=new w.OlP("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let nn=(()=>{class me extends $e{constructor(Se,vt,jn,li,Bi,dn,ue){super(Se,vt,jn),this._viewContainerRef=li,this._animationMode=dn,this._hideToggle=!1,this.afterExpand=new w.vpe,this.afterCollapse=new w.vpe,this._inputChanges=new a.x,this._headerId="mat-expansion-panel-header-"+Bt++,this._bodyAnimationDone=new a.x,this.accordion=Se,this._document=Bi,this._bodyAnimationDone.pipe((0,ft.x)((ke,xt)=>ke.fromState===xt.fromState&&ke.toState===xt.toState)).subscribe(ke=>{"void"!==ke.fromState&&("expanded"===ke.toState?this.afterExpand.emit():"collapsed"===ke.toState&&this.afterCollapse.emit())}),ue&&(this.hideToggle=ue.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(Se){this._hideToggle=(0,j.Ig)(Se)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(Se){this._togglePosition=Se}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe((0,et.O)(null),(0,ht.h)(()=>this.expanded&&!this._portal),(0,Gt.q)(1)).subscribe(()=>{this._portal=new qe.UE(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(Se){this._inputChanges.next(Se)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const Se=this._document.activeElement,vt=this._body.nativeElement;return Se===vt||vt.contains(Se)}return!1}}return me.\u0275fac=function(Se){return new(Se||me)(w.Y36(ct,12),w.Y36(w.sBO),w.Y36(y.A8),w.Y36(w.s_b),w.Y36(Ve.K0),w.Y36(w.QbO,8),w.Y36(Zt,8))},me.\u0275cmp=w.Xpm({type:me,selectors:[["mat-expansion-panel"]],contentQueries:function(Se,vt,jn){if(1&Se&&w.Suo(jn,Ci,5),2&Se){let li;w.iGM(li=w.CRH())&&(vt._lazyContent=li.first)}},viewQuery:function(Se,vt){if(1&Se&&w.Gf(mt,5),2&Se){let jn;w.iGM(jn=w.CRH())&&(vt._body=jn.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(Se,vt){2&Se&&w.ekj("mat-expanded",vt.expanded)("_mat-animation-noopable","NoopAnimations"===vt._animationMode)("mat-expansion-panel-spacing",vt._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[w._Bn([{provide:ct,useValue:void 0},{provide:fi,useExisting:me}]),w.qOj,w.TTD],ngContentSelectors:Cn,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(Se,vt){1&Se&&(w.F$t(sn),w.Hsn(0),w.TgZ(1,"div",0,1),w.NdJ("@bodyExpansion.done",function(li){return vt._bodyAnimationDone.next(li)}),w.TgZ(3,"div",2),w.Hsn(4,1),w.YNc(5,It,0,0,"ng-template",3),w.qZA(),w.Hsn(6,2),w.qZA()),2&Se&&(w.xp6(1),w.Q6J("@bodyExpansion",vt._getExpandedState())("id",vt.id),w.uIk("aria-labelledby",vt._headerId),w.xp6(4),w.Q6J("cdkPortalOutlet",vt._portal))},dependencies:[qe.Pl],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[Nn.bodyExpansion]},changeDetection:0}),me})();class Jt{}const ze=(0,tt.sb)(Jt);let zt=(()=>{class me extends ze{constructor(Se,vt,jn,li,Bi,dn,ue){super(),this.panel=Se,this._element=vt,this._focusMonitor=jn,this._changeDetectorRef=li,this._animationMode=dn,this._parentChangeSubscription=de.w0.EMPTY;const ke=Se.accordion?Se.accordion._stateChanges.pipe((0,ht.h)(xt=>!(!xt.hideToggle&&!xt.togglePosition))):ot.E;this.tabIndex=parseInt(ue||"")||0,this._parentChangeSubscription=(0,Te.T)(Se.opened,Se.closed,ke,Se._inputChanges.pipe((0,ht.h)(xt=>!!(xt.hideToggle||xt.disabled||xt.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),Se.closed.pipe((0,ht.h)(()=>Se._containsFocus())).subscribe(()=>jn.focusVia(vt,"program")),Bi&&(this.expandedHeight=Bi.expandedHeight,this.collapsedHeight=Bi.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const Se=this._isExpanded();return Se&&this.expandedHeight?this.expandedHeight:!Se&&this.collapsedHeight?this.collapsedHeight:null}_keydown(Se){switch(Se.keyCode){case an.L_:case an.K5:(0,an.Vb)(Se)||(Se.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(Se))}}focus(Se,vt){Se?this._focusMonitor.focusVia(this._element,Se,vt):this._element.nativeElement.focus(vt)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(Se=>{Se&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return me.\u0275fac=function(Se){return new(Se||me)(w.Y36(nn,1),w.Y36(w.SBq),w.Y36(Re.tE),w.Y36(w.sBO),w.Y36(Zt,8),w.Y36(w.QbO,8),w.$8M("tabindex"))},me.\u0275cmp=w.Xpm({type:me,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(Se,vt){1&Se&&w.NdJ("click",function(){return vt._toggle()})("keydown",function(li){return vt._keydown(li)}),2&Se&&(w.uIk("id",vt.panel._headerId)("tabindex",vt.tabIndex)("aria-controls",vt._getPanelId())("aria-expanded",vt._isExpanded())("aria-disabled",vt.panel.disabled),w.Udp("height",vt._getHeaderHeight()),w.ekj("mat-expanded",vt._isExpanded())("mat-expansion-toggle-indicator-after","after"===vt._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===vt._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===vt._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[w.qOj],ngContentSelectors:Et,decls:5,vars:3,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(Se,vt){1&Se&&(w.F$t(nt),w.TgZ(0,"span",0),w.Hsn(1),w.Hsn(2,1),w.Hsn(3,2),w.qZA(),w.YNc(4,Yt,1,1,"span",1)),2&Se&&(w.ekj("mat-content-hide-toggle",!vt._showToggle()),w.xp6(4),w.Q6J("ngIf",vt._showToggle()))},dependencies:[Ve.O5],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[Nn.indicatorRotate]},changeDetection:0}),me})(),Lt=(()=>{class me{}return me.\u0275fac=function(Se){return new(Se||me)},me.\u0275dir=w.lG2({type:me,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),me})(),Tt=(()=>{class me extends Ce{constructor(){super(...arguments),this._ownHeaders=new w.n_E,this._hideToggle=!1,this.displayMode="default",this.togglePosition="after"}get hideToggle(){return this._hideToggle}set hideToggle(Se){this._hideToggle=(0,j.Ig)(Se)}ngAfterContentInit(){this._headers.changes.pipe((0,et.O)(this._headers)).subscribe(Se=>{this._ownHeaders.reset(Se.filter(vt=>vt.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new Re.Em(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(Se){this._keyManager.onKeydown(Se)}_handleHeaderFocus(Se){this._keyManager.updateActiveItem(Se)}ngOnDestroy(){super.ngOnDestroy(),this._ownHeaders.destroy()}}return me.\u0275fac=function(){let Rt;return function(vt){return(Rt||(Rt=w.n5z(me)))(vt||me)}}(),me.\u0275dir=w.lG2({type:me,selectors:[["mat-accordion"]],contentQueries:function(Se,vt,jn){if(1&Se&&w.Suo(jn,zt,5),2&Se){let li;w.iGM(li=w.CRH())&&(vt._headers=li)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(Se,vt){2&Se&&w.ekj("mat-accordion-multi",vt.multi)},inputs:{multi:"multi",hideToggle:"hideToggle",displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],features:[w._Bn([{provide:ct,useExisting:me}]),w.qOj]}),me})(),fn=(()=>{class me{}return me.\u0275fac=function(Se){return new(Se||me)},me.\u0275mod=w.oAB({type:me}),me.\u0275inj=w.cJS({imports:[Ve.ez,tt.BQ,at,qe.eL]}),me})()},9549:(Yn,kt,L)=>{"use strict";L.d(kt,{Eo:()=>Ci,G_:()=>Bi,KE:()=>dn,hX:()=>zt,lN:()=>ue});var w=L(9643),y=L(6895),j=L(4650),a=L(3238),de=L(445),Qe=L(1281),it=L(7579),Ce=L(6451),Fe=L(4968),$e=L(8675),at=L(2722),qe=L(5698),Ve=L(7340),tt=L(3353);const Re=["connectionContainer"],ft=["inputContainer"],et=["label"];function ht(ke,xt){1&ke&&(j.ynx(0),j.TgZ(1,"div",14),j._UZ(2,"div",15)(3,"div",16)(4,"div",17),j.qZA(),j.TgZ(5,"div",18),j._UZ(6,"div",15)(7,"div",16)(8,"div",17),j.qZA(),j.BQk())}function Gt(ke,xt){if(1&ke){const lt=j.EpF();j.TgZ(0,"div",19),j.NdJ("cdkObserveContent",function(){j.CHM(lt);const An=j.oxw();return j.KtG(An.updateOutlineGap())}),j.Hsn(1,1),j.qZA()}if(2&ke){const lt=j.oxw();j.Q6J("cdkObserveContentDisabled","outline"!=lt.appearance)}}function an(ke,xt){if(1&ke&&(j.ynx(0),j.Hsn(1,2),j.TgZ(2,"span"),j._uU(3),j.qZA(),j.BQk()),2&ke){const lt=j.oxw(2);j.xp6(3),j.Oqu(lt._control.placeholder)}}function ot(ke,xt){1&ke&&j.Hsn(0,3,["*ngSwitchCase","true"])}function Te(ke,xt){1&ke&&(j.TgZ(0,"span",23),j._uU(1," *"),j.qZA())}function Ne(ke,xt){if(1&ke){const lt=j.EpF();j.TgZ(0,"label",20,21),j.NdJ("cdkObserveContent",function(){j.CHM(lt);const An=j.oxw();return j.KtG(An.updateOutlineGap())}),j.YNc(2,an,4,1,"ng-container",12),j.YNc(3,ot,1,0,"ng-content",12),j.YNc(4,Te,2,0,"span",22),j.qZA()}if(2&ke){const lt=j.oxw();j.ekj("mat-empty",lt._control.empty&&!lt._shouldAlwaysFloat())("mat-form-field-empty",lt._control.empty&&!lt._shouldAlwaysFloat())("mat-accent","accent"==lt.color)("mat-warn","warn"==lt.color),j.Q6J("cdkObserveContentDisabled","outline"!=lt.appearance)("id",lt._labelId)("ngSwitch",lt._hasLabel()),j.uIk("for",lt._control.id)("aria-owns",lt._control.id),j.xp6(2),j.Q6J("ngSwitchCase",!1),j.xp6(1),j.Q6J("ngSwitchCase",!0),j.xp6(1),j.Q6J("ngIf",!lt.hideRequiredMarker&&lt._control.required&&!lt._control.disabled)}}function mt(ke,xt){1&ke&&(j.TgZ(0,"div",24),j.Hsn(1,4),j.qZA())}function It(ke,xt){if(1&ke&&(j.TgZ(0,"div",25),j._UZ(1,"span",26),j.qZA()),2&ke){const lt=j.oxw();j.xp6(1),j.ekj("mat-accent","accent"==lt.color)("mat-warn","warn"==lt.color)}}function sn(ke,xt){if(1&ke&&(j.TgZ(0,"div"),j.Hsn(1,5),j.qZA()),2&ke){const lt=j.oxw();j.Q6J("@transitionMessages",lt._subscriptAnimationState)}}function Cn(ke,xt){if(1&ke&&(j.TgZ(0,"div",30),j._uU(1),j.qZA()),2&ke){const lt=j.oxw(2);j.Q6J("id",lt._hintLabelId),j.xp6(1),j.Oqu(lt.hintLabel)}}function Yt(ke,xt){if(1&ke&&(j.TgZ(0,"div",27),j.YNc(1,Cn,2,2,"div",28),j.Hsn(2,6),j._UZ(3,"div",29),j.Hsn(4,7),j.qZA()),2&ke){const lt=j.oxw();j.Q6J("@transitionMessages",lt._subscriptAnimationState),j.xp6(1),j.Q6J("ngIf",lt.hintLabel)}}const nt=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Et=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],Pn=new j.OlP("MatError"),fi={transitionMessages:(0,Ve.X$)("transitionMessages",[(0,Ve.SB)("enter",(0,Ve.oB)({opacity:1,transform:"translateY(0%)"})),(0,Ve.eR)("void => enter",[(0,Ve.oB)({opacity:0,transform:"translateY(-5px)"}),(0,Ve.jt)("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Ci=(()=>{class ke{}return ke.\u0275fac=function(lt){return new(lt||ke)},ke.\u0275dir=j.lG2({type:ke}),ke})();const Jt=new j.OlP("MatHint");let zt=(()=>{class ke{}return ke.\u0275fac=function(lt){return new(lt||ke)},ke.\u0275dir=j.lG2({type:ke,selectors:[["mat-label"]]}),ke})(),ve=(()=>{class ke{}return ke.\u0275fac=function(lt){return new(lt||ke)},ke.\u0275dir=j.lG2({type:ke,selectors:[["mat-placeholder"]]}),ke})();const Lt=new j.OlP("MatPrefix"),fn=new j.OlP("MatSuffix");let Rt=0;const jn=(0,a.pj)(class{constructor(ke){this._elementRef=ke}},"primary"),li=new j.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),Bi=new j.OlP("MatFormField");let dn=(()=>{class ke extends jn{constructor(lt,Vt,An,Fn,Mn,At,Ae){super(lt),this._changeDetectorRef=Vt,this._dir=An,this._defaults=Fn,this._platform=Mn,this._ngZone=At,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new it.x,this._hideRequiredMarker=!1,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+Rt++,this._labelId="mat-form-field-label-"+Rt++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==Ae,this.appearance=Fn?.appearance||"legacy",Fn&&(this._hideRequiredMarker=Boolean(Fn.hideRequiredMarker),Fn.color&&(this.color=this.defaultColor=Fn.color))}get appearance(){return this._appearance}set appearance(lt){const Vt=this._appearance;this._appearance=lt||this._defaults?.appearance||"legacy","outline"===this._appearance&&Vt!==lt&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(lt){this._hideRequiredMarker=(0,Qe.Ig)(lt)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(lt){this._hintLabel=lt,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(lt){lt!==this._floatLabel&&(this._floatLabel=lt||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(lt){this._explicitFormFieldControl=lt}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const lt=this._control;lt.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${lt.controlType}`),lt.stateChanges.pipe((0,$e.O)(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),lt.ngControl&&lt.ngControl.valueChanges&&lt.ngControl.valueChanges.pipe((0,at.R)(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,at.R)(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,Ce.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe((0,$e.O)(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe((0,$e.O)(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe((0,at.R)(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(lt){const Vt=this._control?this._control.ngControl:null;return Vt&&Vt[lt]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,(0,Fe.R)(this._label.nativeElement,"transitionend").pipe((0,qe.q)(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let lt=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&lt.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const Vt=this._hintChildren?this._hintChildren.find(Fn=>"start"===Fn.align):null,An=this._hintChildren?this._hintChildren.find(Fn=>"end"===Fn.align):null;Vt?lt.push(Vt.id):this._hintLabel&&lt.push(this._hintLabelId),An&&lt.push(An.id)}else this._errorChildren&&lt.push(...this._errorChildren.map(Vt=>Vt.id));this._control.setDescribedByIds(lt)}}_validateControlChild(){}updateOutlineGap(){const lt=this._label?this._label.nativeElement:null,Vt=this._connectionContainerRef.nativeElement,An=".mat-form-field-outline-start",Fn=".mat-form-field-outline-gap";if("outline"!==this.appearance||!this._platform.isBrowser)return;if(!lt||!lt.children.length||!lt.textContent.trim()){const Dn=Vt.querySelectorAll(`${An}, ${Fn}`);for(let ln=0;ln<Dn.length;ln++)Dn[ln].style.width="0";return}if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let Mn=0,At=0;const Ae=Vt.querySelectorAll(An),Qt=Vt.querySelectorAll(Fn);if(this._label&&this._label.nativeElement.children.length){const Dn=Vt.getBoundingClientRect();if(0===Dn.width&&0===Dn.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const ln=this._getStartEnd(Dn),mi=lt.children,Li=this._getStartEnd(mi[0].getBoundingClientRect());let Qi=0;for(let Ii=0;Ii<mi.length;Ii++)Qi+=mi[Ii].offsetWidth;Mn=Math.abs(Li-ln)-5,At=Qi>0?.75*Qi+10:0}for(let Dn=0;Dn<Ae.length;Dn++)Ae[Dn].style.width=`${Mn}px`;for(let Dn=0;Dn<Qt.length;Dn++)Qt[Dn].style.width=`${At}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(lt){return this._dir&&"rtl"===this._dir.value?lt.right:lt.left}_isAttachedToDOM(){const lt=this._elementRef.nativeElement;if(lt.getRootNode){const Vt=lt.getRootNode();return Vt&&Vt!==lt}return document.documentElement.contains(lt)}}return ke.\u0275fac=function(lt){return new(lt||ke)(j.Y36(j.SBq),j.Y36(j.sBO),j.Y36(de.Is,8),j.Y36(li,8),j.Y36(tt.t4),j.Y36(j.R0b),j.Y36(j.QbO,8))},ke.\u0275cmp=j.Xpm({type:ke,selectors:[["mat-form-field"]],contentQueries:function(lt,Vt,An){if(1&lt&&(j.Suo(An,Ci,5),j.Suo(An,Ci,7),j.Suo(An,zt,5),j.Suo(An,zt,7),j.Suo(An,ve,5),j.Suo(An,Pn,5),j.Suo(An,Jt,5),j.Suo(An,Lt,5),j.Suo(An,fn,5)),2&lt){let Fn;j.iGM(Fn=j.CRH())&&(Vt._controlNonStatic=Fn.first),j.iGM(Fn=j.CRH())&&(Vt._controlStatic=Fn.first),j.iGM(Fn=j.CRH())&&(Vt._labelChildNonStatic=Fn.first),j.iGM(Fn=j.CRH())&&(Vt._labelChildStatic=Fn.first),j.iGM(Fn=j.CRH())&&(Vt._placeholderChild=Fn.first),j.iGM(Fn=j.CRH())&&(Vt._errorChildren=Fn),j.iGM(Fn=j.CRH())&&(Vt._hintChildren=Fn),j.iGM(Fn=j.CRH())&&(Vt._prefixChildren=Fn),j.iGM(Fn=j.CRH())&&(Vt._suffixChildren=Fn)}},viewQuery:function(lt,Vt){if(1&lt&&(j.Gf(Re,7),j.Gf(ft,5),j.Gf(et,5)),2&lt){let An;j.iGM(An=j.CRH())&&(Vt._connectionContainerRef=An.first),j.iGM(An=j.CRH())&&(Vt._inputContainerRef=An.first),j.iGM(An=j.CRH())&&(Vt._label=An.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(lt,Vt){2&lt&&j.ekj("mat-form-field-appearance-standard","standard"==Vt.appearance)("mat-form-field-appearance-fill","fill"==Vt.appearance)("mat-form-field-appearance-outline","outline"==Vt.appearance)("mat-form-field-appearance-legacy","legacy"==Vt.appearance)("mat-form-field-invalid",Vt._control.errorState)("mat-form-field-can-float",Vt._canLabelFloat())("mat-form-field-should-float",Vt._shouldLabelFloat())("mat-form-field-has-label",Vt._hasFloatingLabel())("mat-form-field-hide-placeholder",Vt._hideControlPlaceholder())("mat-form-field-disabled",Vt._control.disabled)("mat-form-field-autofilled",Vt._control.autofilled)("mat-focused",Vt._control.focused)("ng-untouched",Vt._shouldForward("untouched"))("ng-touched",Vt._shouldForward("touched"))("ng-pristine",Vt._shouldForward("pristine"))("ng-dirty",Vt._shouldForward("dirty"))("ng-valid",Vt._shouldForward("valid"))("ng-invalid",Vt._shouldForward("invalid"))("ng-pending",Vt._shouldForward("pending"))("_mat-animation-noopable",!Vt._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[j._Bn([{provide:Bi,useExisting:ke}]),j.qOj],ngContentSelectors:Et,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix",3,"cdkObserveContentDisabled","cdkObserveContent"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(lt,Vt){1&lt&&(j.F$t(nt),j.TgZ(0,"div",0)(1,"div",1,2),j.NdJ("click",function(Fn){return Vt._control.onContainerClick&&Vt._control.onContainerClick(Fn)}),j.YNc(3,ht,9,0,"ng-container",3),j.YNc(4,Gt,2,1,"div",4),j.TgZ(5,"div",5,6),j.Hsn(7),j.TgZ(8,"span",7),j.YNc(9,Ne,5,16,"label",8),j.qZA()(),j.YNc(10,mt,2,0,"div",9),j.qZA(),j.YNc(11,It,2,4,"div",10),j.TgZ(12,"div",11),j.YNc(13,sn,2,1,"div",12),j.YNc(14,Yt,5,2,"div",13),j.qZA()()),2&lt&&(j.xp6(3),j.Q6J("ngIf","outline"==Vt.appearance),j.xp6(1),j.Q6J("ngIf",Vt._prefixChildren.length),j.xp6(5),j.Q6J("ngIf",Vt._hasFloatingLabel()),j.xp6(1),j.Q6J("ngIf",Vt._suffixChildren.length),j.xp6(1),j.Q6J("ngIf","outline"!=Vt.appearance),j.xp6(1),j.Q6J("ngSwitch",Vt._getDisplayedMessages()),j.xp6(1),j.Q6J("ngSwitchCase","error"),j.xp6(1),j.Q6J("ngSwitchCase","hint"))},dependencies:[y.O5,y.RF,y.n9,w.wD],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.cdk-high-contrast-active .mat-form-field-disabled .mat-form-field-label{color:GrayText}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-form-field-disabled .mat-form-field-flex{outline-color:GrayText}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}','.mat-input-element{font:inherit;background:rgba(0,0,0,0);color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:rgba(0,0,0,0) !important;-webkit-text-fill-color:rgba(0,0,0,0);transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}._mat-animation-noopable .mat-input-element::placeholder{transition:none}._mat-animation-noopable .mat-input-element::-moz-placeholder{transition:none}._mat-animation-noopable .mat-input-element::-webkit-input-placeholder{transition:none}._mat-animation-noopable .mat-input-element:-ms-input-placeholder{transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px;border-top-color:GrayText}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:rgba(0,0,0,0)}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-form-field-disabled .mat-form-field-outline{color:GrayText}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:rgba(0,0,0,0)}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}"],encapsulation:2,data:{animation:[fi.transitionMessages]},changeDetection:0}),ke})(),ue=(()=>{class ke{}return ke.\u0275fac=function(lt){return new(lt||ke)},ke.\u0275mod=j.oAB({type:ke}),ke.\u0275inj=j.cJS({imports:[y.ez,a.BQ,w.Q8,a.BQ]}),ke})()},782:(Yn,kt,L)=>{"use strict";L.d(kt,{DX:()=>qe,Il:()=>It,N6:()=>sn});var w=L(4650),y=L(3238),j=L(1281),a=L(445);const de=["*"];class Fe{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const nt=Math.max(...this.tracker);return nt>1?this.rowCount+nt-1:this.rowCount}update(nt,Et){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(nt),this.tracker.fill(0,0,this.tracker.length),this.positions=Et.map(ct=>this._trackTile(ct))}_trackTile(nt){const Et=this._findMatchingGap(nt.colspan);return this._markTilePosition(Et,nt),this.columnIndex=Et+nt.colspan,new $e(this.rowIndex,Et)}_findMatchingGap(nt){let Et=-1,ct=-1;do{this.columnIndex+nt>this.tracker.length?(this._nextRow(),Et=this.tracker.indexOf(0,this.columnIndex),ct=this._findGapEndIndex(Et)):(Et=this.tracker.indexOf(0,this.columnIndex),-1!=Et?(ct=this._findGapEndIndex(Et),this.columnIndex=Et+1):(this._nextRow(),Et=this.tracker.indexOf(0,this.columnIndex),ct=this._findGapEndIndex(Et)))}while(ct-Et<nt||0==ct);return Math.max(Et,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let nt=0;nt<this.tracker.length;nt++)this.tracker[nt]=Math.max(0,this.tracker[nt]-1)}_findGapEndIndex(nt){for(let Et=nt+1;Et<this.tracker.length;Et++)if(0!=this.tracker[Et])return Et;return this.tracker.length}_markTilePosition(nt,Et){for(let ct=0;ct<Et.colspan;ct++)this.tracker[nt+ct]=Et.rowspan}}class $e{constructor(nt,Et){this.row=nt,this.col=Et}}const at=new w.OlP("MAT_GRID_LIST");let qe=(()=>{class Yt{constructor(Et,ct){this._element=Et,this._gridList=ct,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(Et){this._rowspan=Math.round((0,j.su)(Et))}get colspan(){return this._colspan}set colspan(Et){this._colspan=Math.round((0,j.su)(Et))}_setStyle(Et,ct){this._element.nativeElement.style[Et]=ct}}return Yt.\u0275fac=function(Et){return new(Et||Yt)(w.Y36(w.SBq),w.Y36(at,8))},Yt.\u0275cmp=w.Xpm({type:Yt,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(Et,ct){2&Et&&w.uIk("rowspan",ct.rowspan)("colspan",ct.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:de,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(Et,ct){1&Et&&(w.F$t(),w.TgZ(0,"div",0),w.Hsn(1),w.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0}),Yt})();const et=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class ht{constructor(){this._rows=0,this._rowspan=0}init(nt,Et,ct,Pn){this._gutterSize=Ne(nt),this._rows=Et.rowCount,this._rowspan=Et.rowspan,this._cols=ct,this._direction=Pn}getBaseTileSize(nt,Et){return`(${nt}% - (${this._gutterSize} * ${Et}))`}getTilePosition(nt,Et){return 0===Et?"0":Te(`(${nt} + ${this._gutterSize}) * ${Et}`)}getTileSize(nt,Et){return`(${nt} * ${Et}) + (${Et-1} * ${this._gutterSize})`}setStyle(nt,Et,ct){let Pn=100/this._cols,Nn=(this._cols-1)/this._cols;this.setColStyles(nt,ct,Pn,Nn),this.setRowStyles(nt,Et,Pn,Nn)}setColStyles(nt,Et,ct,Pn){let Nn=this.getBaseTileSize(ct,Pn);nt._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(Nn,Et)),nt._setStyle("width",Te(this.getTileSize(Nn,nt.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(nt){return`${this._rowspan} * ${this.getTileSize(nt,1)}`}getComputedHeight(){return null}}class Gt extends ht{constructor(nt){super(),this.fixedRowHeight=nt}init(nt,Et,ct,Pn){super.init(nt,Et,ct,Pn),this.fixedRowHeight=Ne(this.fixedRowHeight),et.test(this.fixedRowHeight)}setRowStyles(nt,Et){nt._setStyle("top",this.getTilePosition(this.fixedRowHeight,Et)),nt._setStyle("height",Te(this.getTileSize(this.fixedRowHeight,nt.rowspan)))}getComputedHeight(){return["height",Te(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(nt){nt._setListStyle(["height",null]),nt._tiles&&nt._tiles.forEach(Et=>{Et._setStyle("top",null),Et._setStyle("height",null)})}}class an extends ht{constructor(nt){super(),this._parseRatio(nt)}setRowStyles(nt,Et,ct,Pn){this.baseTileHeight=this.getBaseTileSize(ct/this.rowHeightRatio,Pn),nt._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,Et)),nt._setStyle("paddingTop",Te(this.getTileSize(this.baseTileHeight,nt.rowspan)))}getComputedHeight(){return["paddingBottom",Te(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(nt){nt._setListStyle(["paddingBottom",null]),nt._tiles.forEach(Et=>{Et._setStyle("marginTop",null),Et._setStyle("paddingTop",null)})}_parseRatio(nt){const Et=nt.split(":");this.rowHeightRatio=parseFloat(Et[0])/parseFloat(Et[1])}}class ot extends ht{setRowStyles(nt,Et){let Nn=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);nt._setStyle("top",this.getTilePosition(Nn,Et)),nt._setStyle("height",Te(this.getTileSize(Nn,nt.rowspan)))}reset(nt){nt._tiles&&nt._tiles.forEach(Et=>{Et._setStyle("top",null),Et._setStyle("height",null)})}}function Te(Yt){return`calc(${Yt})`}function Ne(Yt){return Yt.match(/([A-Za-z%]+)$/)?Yt:`${Yt}px`}let It=(()=>{class Yt{constructor(Et,ct){this._element=Et,this._dir=ct,this._gutter="1px"}get cols(){return this._cols}set cols(Et){this._cols=Math.max(1,Math.round((0,j.su)(Et)))}get gutterSize(){return this._gutter}set gutterSize(Et){this._gutter=`${Et??""}`}get rowHeight(){return this._rowHeight}set rowHeight(Et){const ct=`${Et??""}`;ct!==this._rowHeight&&(this._rowHeight=ct,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(Et){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===Et?new ot:Et&&Et.indexOf(":")>-1?new an(Et):new Gt(Et)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new Fe);const Et=this._tileCoordinator,ct=this._tiles.filter(Nn=>!Nn._gridList||Nn._gridList===this),Pn=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,ct),this._tileStyler.init(this.gutterSize,Et,this.cols,Pn),ct.forEach((Nn,fi)=>{const Ci=Et.positions[fi];this._tileStyler.setStyle(Nn,Ci.row,Ci.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(Et){Et&&(this._element.nativeElement.style[Et[0]]=Et[1])}}return Yt.\u0275fac=function(Et){return new(Et||Yt)(w.Y36(w.SBq),w.Y36(a.Is,8))},Yt.\u0275cmp=w.Xpm({type:Yt,selectors:[["mat-grid-list"]],contentQueries:function(Et,ct,Pn){if(1&Et&&w.Suo(Pn,qe,5),2&Et){let Nn;w.iGM(Nn=w.CRH())&&(ct._tiles=Nn)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(Et,ct){2&Et&&w.uIk("cols",ct.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[w._Bn([{provide:at,useExisting:Yt}])],ngContentSelectors:de,decls:2,vars:0,template:function(Et,ct){1&Et&&(w.F$t(),w.TgZ(0,"div"),w.Hsn(1),w.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}"],encapsulation:2,changeDetection:0}),Yt})(),sn=(()=>{class Yt{}return Yt.\u0275fac=function(Et){return new(Et||Yt)},Yt.\u0275mod=w.oAB({type:Yt}),Yt.\u0275inj=w.cJS({imports:[y.uc,y.BQ,y.uc,y.BQ]}),Yt})()},7392:(Yn,kt,L)=>{"use strict";L.d(kt,{Hw:()=>Ct,Ps:()=>Jt});var w=L(4650),y=L(3238),j=L(1281),a=L(6895),de=L(9646),Qe=L(2843),it=L(4128),Ce=L(727),Fe=L(8505),$e=L(4004),at=L(262),qe=L(8746),Ve=L(3099),tt=L(5698),Re=L(529),ft=L(1481);const et=["*"];let ht;function an(ze){return function Gt(){if(void 0===ht&&(ht=null,typeof window<"u")){const ze=window;void 0!==ze.trustedTypes&&(ht=ze.trustedTypes.createPolicy("angular#components",{createHTML:zt=>zt}))}return ht}()?.createHTML(ze)||ze}function ot(ze){return Error(`Unable to find icon with the name "${ze}"`)}function Ne(ze){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${ze}".`)}function mt(ze){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${ze}".`)}class It{constructor(zt,ve,Lt){this.url=zt,this.svgText=ve,this.options=Lt}}let sn=(()=>{class ze{constructor(ve,Lt,Tt,fn){this._httpClient=ve,this._sanitizer=Lt,this._errorHandler=fn,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=Tt}addSvgIcon(ve,Lt,Tt){return this.addSvgIconInNamespace("",ve,Lt,Tt)}addSvgIconLiteral(ve,Lt,Tt){return this.addSvgIconLiteralInNamespace("",ve,Lt,Tt)}addSvgIconInNamespace(ve,Lt,Tt,fn){return this._addSvgIconConfig(ve,Lt,new It(Tt,null,fn))}addSvgIconResolver(ve){return this._resolvers.push(ve),this}addSvgIconLiteralInNamespace(ve,Lt,Tt,fn){const me=this._sanitizer.sanitize(w.q3G.HTML,Tt);if(!me)throw mt(Tt);const Rt=an(me);return this._addSvgIconConfig(ve,Lt,new It("",Rt,fn))}addSvgIconSet(ve,Lt){return this.addSvgIconSetInNamespace("",ve,Lt)}addSvgIconSetLiteral(ve,Lt){return this.addSvgIconSetLiteralInNamespace("",ve,Lt)}addSvgIconSetInNamespace(ve,Lt,Tt){return this._addSvgIconSetConfig(ve,new It(Lt,null,Tt))}addSvgIconSetLiteralInNamespace(ve,Lt,Tt){const fn=this._sanitizer.sanitize(w.q3G.HTML,Lt);if(!fn)throw mt(Lt);const me=an(fn);return this._addSvgIconSetConfig(ve,new It("",me,Tt))}registerFontClassAlias(ve,Lt=ve){return this._fontCssClassesByAlias.set(ve,Lt),this}classNameForFontAlias(ve){return this._fontCssClassesByAlias.get(ve)||ve}setDefaultFontSetClass(...ve){return this._defaultFontSetClass=ve,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(ve){const Lt=this._sanitizer.sanitize(w.q3G.RESOURCE_URL,ve);if(!Lt)throw Ne(ve);const Tt=this._cachedIconsByUrl.get(Lt);return Tt?(0,de.of)(nt(Tt)):this._loadSvgIconFromConfig(new It(ve,null)).pipe((0,Fe.b)(fn=>this._cachedIconsByUrl.set(Lt,fn)),(0,$e.U)(fn=>nt(fn)))}getNamedSvgIcon(ve,Lt=""){const Tt=Et(Lt,ve);let fn=this._svgIconConfigs.get(Tt);if(fn)return this._getSvgFromConfig(fn);if(fn=this._getIconConfigFromResolvers(Lt,ve),fn)return this._svgIconConfigs.set(Tt,fn),this._getSvgFromConfig(fn);const me=this._iconSetConfigs.get(Lt);return me?this._getSvgFromIconSetConfigs(ve,me):(0,Qe._)(ot(Tt))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(ve){return ve.svgText?(0,de.of)(nt(this._svgElementFromConfig(ve))):this._loadSvgIconFromConfig(ve).pipe((0,$e.U)(Lt=>nt(Lt)))}_getSvgFromIconSetConfigs(ve,Lt){const Tt=this._extractIconWithNameFromAnySet(ve,Lt);if(Tt)return(0,de.of)(Tt);const fn=Lt.filter(me=>!me.svgText).map(me=>this._loadSvgIconSetFromConfig(me).pipe((0,at.K)(Rt=>{const vt=`Loading icon set URL: ${this._sanitizer.sanitize(w.q3G.RESOURCE_URL,me.url)} failed: ${Rt.message}`;return this._errorHandler.handleError(new Error(vt)),(0,de.of)(null)})));return(0,it.D)(fn).pipe((0,$e.U)(()=>{const me=this._extractIconWithNameFromAnySet(ve,Lt);if(!me)throw ot(ve);return me}))}_extractIconWithNameFromAnySet(ve,Lt){for(let Tt=Lt.length-1;Tt>=0;Tt--){const fn=Lt[Tt];if(fn.svgText&&fn.svgText.toString().indexOf(ve)>-1){const me=this._svgElementFromConfig(fn),Rt=this._extractSvgIconFromSet(me,ve,fn.options);if(Rt)return Rt}}return null}_loadSvgIconFromConfig(ve){return this._fetchIcon(ve).pipe((0,Fe.b)(Lt=>ve.svgText=Lt),(0,$e.U)(()=>this._svgElementFromConfig(ve)))}_loadSvgIconSetFromConfig(ve){return ve.svgText?(0,de.of)(null):this._fetchIcon(ve).pipe((0,Fe.b)(Lt=>ve.svgText=Lt))}_extractSvgIconFromSet(ve,Lt,Tt){const fn=ve.querySelector(`[id="${Lt}"]`);if(!fn)return null;const me=fn.cloneNode(!0);if(me.removeAttribute("id"),"svg"===me.nodeName.toLowerCase())return this._setSvgAttributes(me,Tt);if("symbol"===me.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(me),Tt);const Rt=this._svgElementFromString(an("<svg></svg>"));return Rt.appendChild(me),this._setSvgAttributes(Rt,Tt)}_svgElementFromString(ve){const Lt=this._document.createElement("DIV");Lt.innerHTML=ve;const Tt=Lt.querySelector("svg");if(!Tt)throw Error("<svg> tag not found");return Tt}_toSvgElement(ve){const Lt=this._svgElementFromString(an("<svg></svg>")),Tt=ve.attributes;for(let fn=0;fn<Tt.length;fn++){const{name:me,value:Rt}=Tt[fn];"id"!==me&&Lt.setAttribute(me,Rt)}for(let fn=0;fn<ve.childNodes.length;fn++)ve.childNodes[fn].nodeType===this._document.ELEMENT_NODE&&Lt.appendChild(ve.childNodes[fn].cloneNode(!0));return Lt}_setSvgAttributes(ve,Lt){return ve.setAttribute("fit",""),ve.setAttribute("height","100%"),ve.setAttribute("width","100%"),ve.setAttribute("preserveAspectRatio","xMidYMid meet"),ve.setAttribute("focusable","false"),Lt&&Lt.viewBox&&ve.setAttribute("viewBox",Lt.viewBox),ve}_fetchIcon(ve){const{url:Lt,options:Tt}=ve,fn=Tt?.withCredentials??!1;if(!this._httpClient)throw function Te(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==Lt)throw Error(`Cannot fetch icon from URL "${Lt}".`);const me=this._sanitizer.sanitize(w.q3G.RESOURCE_URL,Lt);if(!me)throw Ne(Lt);const Rt=this._inProgressUrlFetches.get(me);if(Rt)return Rt;const Se=this._httpClient.get(me,{responseType:"text",withCredentials:fn}).pipe((0,$e.U)(vt=>an(vt)),(0,qe.x)(()=>this._inProgressUrlFetches.delete(me)),(0,Ve.B)());return this._inProgressUrlFetches.set(me,Se),Se}_addSvgIconConfig(ve,Lt,Tt){return this._svgIconConfigs.set(Et(ve,Lt),Tt),this}_addSvgIconSetConfig(ve,Lt){const Tt=this._iconSetConfigs.get(ve);return Tt?Tt.push(Lt):this._iconSetConfigs.set(ve,[Lt]),this}_svgElementFromConfig(ve){if(!ve.svgElement){const Lt=this._svgElementFromString(ve.svgText);this._setSvgAttributes(Lt,ve.options),ve.svgElement=Lt}return ve.svgElement}_getIconConfigFromResolvers(ve,Lt){for(let Tt=0;Tt<this._resolvers.length;Tt++){const fn=this._resolvers[Tt](Lt,ve);if(fn)return ct(fn)?new It(fn.url,null,fn.options):new It(fn,null)}}}return ze.\u0275fac=function(ve){return new(ve||ze)(w.LFG(Re.eN,8),w.LFG(ft.H7),w.LFG(a.K0,8),w.LFG(w.qLn))},ze.\u0275prov=w.Yz7({token:ze,factory:ze.\u0275fac,providedIn:"root"}),ze})();function nt(ze){return ze.cloneNode(!0)}function Et(ze,zt){return ze+":"+zt}function ct(ze){return!(!ze.url||!ze.options)}const Pn=(0,y.pj)(class{constructor(ze){this._elementRef=ze}}),Nn=new w.OlP("MAT_ICON_DEFAULT_OPTIONS"),fi=new w.OlP("mat-icon-location",{providedIn:"root",factory:function Ci(){const ze=(0,w.f3M)(a.K0),zt=ze?ze.location:null;return{getPathname:()=>zt?zt.pathname+zt.search:""}}}),Bt=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Zt=Bt.map(ze=>`[${ze}]`).join(", "),nn=/^url\(['"]?#(.*?)['"]?\)$/;let Ct=(()=>{class ze extends Pn{constructor(ve,Lt,Tt,fn,me,Rt){super(ve),this._iconRegistry=Lt,this._location=fn,this._errorHandler=me,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Ce.w0.EMPTY,Rt&&(Rt.color&&(this.color=this.defaultColor=Rt.color),Rt.fontSet&&(this.fontSet=Rt.fontSet)),Tt||ve.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(ve){this._inline=(0,j.Ig)(ve)}get svgIcon(){return this._svgIcon}set svgIcon(ve){ve!==this._svgIcon&&(ve?this._updateSvgIcon(ve):this._svgIcon&&this._clearSvgElement(),this._svgIcon=ve)}get fontSet(){return this._fontSet}set fontSet(ve){const Lt=this._cleanupFontValue(ve);Lt!==this._fontSet&&(this._fontSet=Lt,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(ve){const Lt=this._cleanupFontValue(ve);Lt!==this._fontIcon&&(this._fontIcon=Lt,this._updateFontIconClasses())}_splitIconName(ve){if(!ve)return["",""];const Lt=ve.split(":");switch(Lt.length){case 1:return["",Lt[0]];case 2:return Lt;default:throw Error(`Invalid icon name: "${ve}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const ve=this._elementsWithExternalReferences;if(ve&&ve.size){const Lt=this._location.getPathname();Lt!==this._previousPath&&(this._previousPath=Lt,this._prependPathToReferences(Lt))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(ve){this._clearSvgElement();const Lt=this._location.getPathname();this._previousPath=Lt,this._cacheChildrenWithExternalReferences(ve),this._prependPathToReferences(Lt),this._elementRef.nativeElement.appendChild(ve)}_clearSvgElement(){const ve=this._elementRef.nativeElement;let Lt=ve.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();Lt--;){const Tt=ve.childNodes[Lt];(1!==Tt.nodeType||"svg"===Tt.nodeName.toLowerCase())&&Tt.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const ve=this._elementRef.nativeElement,Lt=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(Tt=>Tt.length>0);this._previousFontSetClass.forEach(Tt=>ve.classList.remove(Tt)),Lt.forEach(Tt=>ve.classList.add(Tt)),this._previousFontSetClass=Lt,this.fontIcon!==this._previousFontIconClass&&!Lt.includes("mat-ligature-font")&&(this._previousFontIconClass&&ve.classList.remove(this._previousFontIconClass),this.fontIcon&&ve.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(ve){return"string"==typeof ve?ve.trim().split(" ")[0]:ve}_prependPathToReferences(ve){const Lt=this._elementsWithExternalReferences;Lt&&Lt.forEach((Tt,fn)=>{Tt.forEach(me=>{fn.setAttribute(me.name,`url('${ve}#${me.value}')`)})})}_cacheChildrenWithExternalReferences(ve){const Lt=ve.querySelectorAll(Zt),Tt=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let fn=0;fn<Lt.length;fn++)Bt.forEach(me=>{const Rt=Lt[fn],Se=Rt.getAttribute(me),vt=Se?Se.match(nn):null;if(vt){let jn=Tt.get(Rt);jn||(jn=[],Tt.set(Rt,jn)),jn.push({name:me,value:vt[1]})}})}_updateSvgIcon(ve){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),ve){const[Lt,Tt]=this._splitIconName(ve);Lt&&(this._svgNamespace=Lt),Tt&&(this._svgName=Tt),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(Tt,Lt).pipe((0,tt.q)(1)).subscribe(fn=>this._setSvgElement(fn),fn=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${Lt}:${Tt}! ${fn.message}`))})}}}return ze.\u0275fac=function(ve){return new(ve||ze)(w.Y36(w.SBq),w.Y36(sn),w.$8M("aria-hidden"),w.Y36(fi),w.Y36(w.qLn),w.Y36(Nn,8))},ze.\u0275cmp=w.Xpm({type:ze,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:8,hostBindings:function(ve,Lt){2&ve&&(w.uIk("data-mat-icon-type",Lt._usingFontIcon()?"font":"svg")("data-mat-icon-name",Lt._svgName||Lt.fontIcon)("data-mat-icon-namespace",Lt._svgNamespace||Lt.fontSet)("fontIcon",Lt._usingFontIcon()?Lt.fontIcon:null),w.ekj("mat-icon-inline",Lt.inline)("mat-icon-no-color","primary"!==Lt.color&&"accent"!==Lt.color&&"warn"!==Lt.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[w.qOj],ngContentSelectors:et,decls:1,vars:0,template:function(ve,Lt){1&ve&&(w.F$t(),w.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),ze})(),Jt=(()=>{class ze{}return ze.\u0275fac=function(ve){return new(ve||ze)},ze.\u0275mod=w.oAB({type:ze}),ze.\u0275inj=w.cJS({imports:[y.BQ,y.BQ]}),ze})()},4144:(Yn,kt,L)=>{"use strict";L.d(kt,{Nt:()=>Gt,c:()=>an});var w=L(1281),y=L(3353),j=L(4650),a=L(515),de=L(7579);const Qe=(0,y.i$)({passive:!0});let it=(()=>{class ot{constructor(Ne,mt){this._platform=Ne,this._ngZone=mt,this._monitoredElements=new Map}monitor(Ne){if(!this._platform.isBrowser)return a.E;const mt=(0,w.fI)(Ne),It=this._monitoredElements.get(mt);if(It)return It.subject;const sn=new de.x,Cn="cdk-text-field-autofilled",Yt=nt=>{"cdk-text-field-autofill-start"!==nt.animationName||mt.classList.contains(Cn)?"cdk-text-field-autofill-end"===nt.animationName&&mt.classList.contains(Cn)&&(mt.classList.remove(Cn),this._ngZone.run(()=>sn.next({target:nt.target,isAutofilled:!1}))):(mt.classList.add(Cn),this._ngZone.run(()=>sn.next({target:nt.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{mt.addEventListener("animationstart",Yt,Qe),mt.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(mt,{subject:sn,unlisten:()=>{mt.removeEventListener("animationstart",Yt,Qe)}}),sn}stopMonitoring(Ne){const mt=(0,w.fI)(Ne),It=this._monitoredElements.get(mt);It&&(It.unlisten(),It.subject.complete(),mt.classList.remove("cdk-text-field-autofill-monitored"),mt.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(mt))}ngOnDestroy(){this._monitoredElements.forEach((Ne,mt)=>this.stopMonitoring(mt))}}return ot.\u0275fac=function(Ne){return new(Ne||ot)(j.LFG(y.t4),j.LFG(j.R0b))},ot.\u0275prov=j.Yz7({token:ot,factory:ot.\u0275fac,providedIn:"root"}),ot})(),$e=(()=>{class ot{}return ot.\u0275fac=function(Ne){return new(Ne||ot)},ot.\u0275mod=j.oAB({type:ot}),ot.\u0275inj=j.cJS({}),ot})();var at=L(4006),qe=L(3238),Ve=L(9549);const Re=new j.OlP("MAT_INPUT_VALUE_ACCESSOR"),ft=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let et=0;const ht=(0,qe.FD)(class{constructor(ot,Te,Ne,mt){this._defaultErrorStateMatcher=ot,this._parentForm=Te,this._parentFormGroup=Ne,this.ngControl=mt,this.stateChanges=new de.x}});let Gt=(()=>{class ot extends ht{constructor(Ne,mt,It,sn,Cn,Yt,nt,Et,ct,Pn){super(Yt,sn,Cn,It),this._elementRef=Ne,this._platform=mt,this._autofillMonitor=Et,this._formField=Pn,this._uid="mat-input-"+et++,this.focused=!1,this.stateChanges=new de.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(Ci=>(0,y.qK)().has(Ci)),this._iOSKeyupListener=Ci=>{const Bt=Ci.target;!Bt.value&&0===Bt.selectionStart&&0===Bt.selectionEnd&&(Bt.setSelectionRange(1,1),Bt.setSelectionRange(0,0))};const Nn=this._elementRef.nativeElement,fi=Nn.nodeName.toLowerCase();this._inputValueAccessor=nt||Nn,this._previousNativeValue=this.value,this.id=this.id,mt.IOS&&ct.runOutsideAngular(()=>{Ne.nativeElement.addEventListener("keyup",this._iOSKeyupListener)}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===fi,this._isTextarea="textarea"===fi,this._isInFormField=!!Pn,this._isNativeSelect&&(this.controlType=Nn.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(Ne){this._disabled=(0,w.Ig)(Ne),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(Ne){this._id=Ne||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(at.kI.required)??!1}set required(Ne){this._required=(0,w.Ig)(Ne)}get type(){return this._type}set type(Ne){this._type=Ne||"text",this._validateType(),!this._isTextarea&&(0,y.qK)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(Ne){Ne!==this.value&&(this._inputValueAccessor.value=Ne,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(Ne){this._readonly=(0,w.Ig)(Ne)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(Ne=>{this.autofilled=Ne.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._platform.IOS&&this._elementRef.nativeElement.removeEventListener("keyup",this._iOSKeyupListener)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(Ne){this._elementRef.nativeElement.focus(Ne)}_focusChanged(Ne){Ne!==this.focused&&(this.focused=Ne,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const Ne=this._formField,mt=Ne&&"legacy"===Ne.appearance&&!Ne._hasLabel?.()?null:this.placeholder;if(mt!==this._previousPlaceholder){const It=this._elementRef.nativeElement;this._previousPlaceholder=mt,mt?It.setAttribute("placeholder",mt):It.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const Ne=this._elementRef.nativeElement.value;this._previousNativeValue!==Ne&&(this._previousNativeValue=Ne,this.stateChanges.next())}_validateType(){ft.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let Ne=this._elementRef.nativeElement.validity;return Ne&&Ne.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const Ne=this._elementRef.nativeElement,mt=Ne.options[0];return this.focused||Ne.multiple||!this.empty||!!(Ne.selectedIndex>-1&&mt&&mt.label)}return this.focused||!this.empty}setDescribedByIds(Ne){Ne.length?this._elementRef.nativeElement.setAttribute("aria-describedby",Ne.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const Ne=this._elementRef.nativeElement;return this._isNativeSelect&&(Ne.multiple||Ne.size>1)}}return ot.\u0275fac=function(Ne){return new(Ne||ot)(j.Y36(j.SBq),j.Y36(y.t4),j.Y36(at.a5,10),j.Y36(at.F,8),j.Y36(at.sg,8),j.Y36(qe.rD),j.Y36(Re,10),j.Y36(it),j.Y36(j.R0b),j.Y36(Ve.G_,8))},ot.\u0275dir=j.lG2({type:ot,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:12,hostBindings:function(Ne,mt){1&Ne&&j.NdJ("focus",function(){return mt._focusChanged(!0)})("blur",function(){return mt._focusChanged(!1)})("input",function(){return mt._onInput()}),2&Ne&&(j.Ikx("disabled",mt.disabled)("required",mt.required),j.uIk("id",mt.id)("data-placeholder",mt.placeholder)("name",mt.name||null)("readonly",mt.readonly&&!mt._isNativeSelect||null)("aria-invalid",mt.empty&&mt.required?null:mt.errorState)("aria-required",mt.required),j.ekj("mat-input-server",mt._isServer)("mat-native-select-inline",mt._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[j._Bn([{provide:Ve.Eo,useExisting:ot}]),j.qOj,j.TTD]}),ot})(),an=(()=>{class ot{}return ot.\u0275fac=function(Ne){return new(Ne||ot)},ot.\u0275mod=j.oAB({type:ot}),ot.\u0275inj=j.cJS({providers:[qe.rD],imports:[$e,Ve.lN,qe.BQ,$e,Ve.lN]}),ot})()},4633:(Yn,kt,L)=>{"use strict";L.d(kt,{Tg:()=>ct,ie:()=>nn});var w=L(6895),y=L(4650),j=L(3238),a=L(1281),de=L(7579),Qe=L(2722);L(8675),L(2687),L(5017),L(9521),L(4006);let Ve=(()=>{class Ct{}return Ct.\u0275fac=function(ze){return new(ze||Ct)},Ct.\u0275mod=y.oAB({type:Ct}),Ct.\u0275inj=y.cJS({imports:[j.BQ,j.BQ]}),Ct})();const ft=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],et=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],Ne=(0,j.Kr)(class{}),mt=new y.OlP("MatList"),It=new y.OlP("MatNavList");let Yt=(()=>{class Ct{}return Ct.\u0275fac=function(ze){return new(ze||Ct)},Ct.\u0275dir=y.lG2({type:Ct,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),Ct})(),nt=(()=>{class Ct{}return Ct.\u0275fac=function(ze){return new(ze||Ct)},Ct.\u0275dir=y.lG2({type:Ct,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),Ct})(),ct=(()=>{class Ct extends Ne{constructor(ze,zt,ve,Lt){super(),this._element=ze,this._isInteractiveList=!1,this._destroyed=new de.x,this._disabled=!1,this._isInteractiveList=!!(ve||Lt&&"action-list"===Lt._getListType()),this._list=ve||Lt;const Tt=this._getHostElement();"button"===Tt.nodeName.toLowerCase()&&!Tt.hasAttribute("type")&&Tt.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe((0,Qe.R)(this._destroyed)).subscribe(()=>{zt.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(ze){this._disabled=(0,a.Ig)(ze)}ngAfterContentInit(){(0,j.E0)(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return Ct.\u0275fac=function(ze){return new(ze||Ct)(y.Y36(y.SBq),y.Y36(y.sBO),y.Y36(It,8),y.Y36(mt,8))},Ct.\u0275cmp=y.Xpm({type:Ct,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(ze,zt,ve){if(1&ze&&(y.Suo(ve,Yt,5),y.Suo(ve,nt,5),y.Suo(ve,j.X2,5)),2&ze){let Lt;y.iGM(Lt=y.CRH())&&(zt._avatar=Lt.first),y.iGM(Lt=y.CRH())&&(zt._icon=Lt.first),y.iGM(Lt=y.CRH())&&(zt._lines=Lt)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:4,hostBindings:function(ze,zt){2&ze&&y.ekj("mat-list-item-disabled",zt.disabled)("mat-list-item-with-avatar",zt._avatar||zt._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[y.qOj],ngContentSelectors:et,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(ze,zt){1&ze&&(y.F$t(ft),y.TgZ(0,"span",0),y._UZ(1,"span",1),y.Hsn(2),y.TgZ(3,"span",2),y.Hsn(4,1),y.qZA(),y.Hsn(5,2),y.qZA()),2&ze&&(y.xp6(1),y.Q6J("matRippleTrigger",zt._getHostElement())("matRippleDisabled",zt._isRippleDisabled()))},dependencies:[j.wG],encapsulation:2,changeDetection:0}),Ct})(),nn=(()=>{class Ct{}return Ct.\u0275fac=function(ze){return new(ze||Ct)},Ct.\u0275mod=y.oAB({type:Ct}),Ct.\u0275inj=y.cJS({imports:[j.uc,j.si,j.BQ,j.us,w.ez,j.uc,j.BQ,j.us,Ve]}),Ct})()},7717:(Yn,kt,L)=>{"use strict";L.d(kt,{Cq:()=>et,Ou:()=>ft});var w=L(1281),y=L(3353),j=L(8605),a=L(6895),de=L(4650),Qe=L(3238),it=L(727);function Ce(Gt,an){if(1&Gt&&(de.O4$(),de._UZ(0,"circle",4)),2&Gt){const ot=de.oxw(),Te=de.MAs(1);de.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+ot._spinnerAnimationLabel)("stroke-dashoffset",ot._getStrokeDashOffset(),"px")("stroke-dasharray",ot._getStrokeCircumference(),"px")("stroke-width",ot._getCircleStrokeWidth(),"%")("transform-origin",ot._getCircleTransformOrigin(Te)),de.uIk("r",ot._getCircleRadius())}}function Fe(Gt,an){if(1&Gt&&(de.O4$(),de._UZ(0,"circle",4)),2&Gt){const ot=de.oxw(),Te=de.MAs(1);de.Udp("stroke-dashoffset",ot._getStrokeDashOffset(),"px")("stroke-dasharray",ot._getStrokeCircumference(),"px")("stroke-width",ot._getCircleStrokeWidth(),"%")("transform-origin",ot._getCircleTransformOrigin(Te)),de.uIk("r",ot._getCircleRadius())}}const qe=(0,Qe.pj)(class{constructor(Gt){this._elementRef=Gt}},"primary"),Ve=new de.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function tt(){return{diameter:100}}});class ft extends qe{constructor(an,ot,Te,Ne,mt,It,sn,Cn){super(an),this._document=Te,this._diameter=100,this._value=0,this._resizeSubscription=it.w0.EMPTY,this.mode="determinate";const Yt=ft._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),Yt.has(Te.head)||Yt.set(Te.head,new Set([100])),this._noopAnimations="NoopAnimations"===Ne&&!!mt&&!mt._forceAnimations,"mat-spinner"===an.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),mt&&(mt.color&&(this.color=this.defaultColor=mt.color),mt.diameter&&(this.diameter=mt.diameter),mt.strokeWidth&&(this.strokeWidth=mt.strokeWidth)),ot.isBrowser&&ot.SAFARI&&sn&&It&&Cn&&(this._resizeSubscription=sn.change(150).subscribe(()=>{"indeterminate"===this.mode&&Cn.run(()=>It.markForCheck())}))}get diameter(){return this._diameter}set diameter(an){this._diameter=(0,w.su)(an),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(an){this._strokeWidth=(0,w.su)(an)}get value(){return"determinate"===this.mode?this._value:0}set value(an){this._value=Math.max(0,Math.min(100,(0,w.su)(an)))}ngOnInit(){const an=this._elementRef.nativeElement;this._styleRoot=(0,y.kV)(an)||this._document.head,this._attachStyleNode(),an.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const an=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${an} ${an}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(an){const ot=50*(an.currentScale??1);return`${ot}% ${ot}%`}_attachStyleNode(){const an=this._styleRoot,ot=this._diameter,Te=ft._diameters;let Ne=Te.get(an);if(!Ne||!Ne.has(ot)){const mt=this._document.createElement("style");mt.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),mt.textContent=this._getAnimationText(),an.appendChild(mt),Ne||(Ne=new Set,Te.set(an,Ne)),Ne.add(ot)}}_getAnimationText(){const an=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*an).replace(/END_VALUE/g,""+.2*an).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}ft._diameters=new WeakMap,ft.\u0275fac=function(an){return new(an||ft)(de.Y36(de.SBq),de.Y36(y.t4),de.Y36(a.K0,8),de.Y36(de.QbO,8),de.Y36(Ve),de.Y36(de.sBO),de.Y36(j.rL),de.Y36(de.R0b))},ft.\u0275cmp=de.Xpm({type:ft,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(an,ot){2&an&&(de.uIk("aria-valuemin","determinate"===ot.mode?0:null)("aria-valuemax","determinate"===ot.mode?100:null)("aria-valuenow","determinate"===ot.mode?ot.value:null)("mode",ot.mode),de.Udp("width",ot.diameter,"px")("height",ot.diameter,"px"),de.ekj("_mat-animation-noopable",ot._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[de.qOj],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(an,ot){1&an&&(de.O4$(),de.TgZ(0,"svg",0,1),de.YNc(2,Ce,1,11,"circle",2),de.YNc(3,Fe,1,9,"circle",3),de.qZA()),2&an&&(de.Udp("width",ot.diameter,"px")("height",ot.diameter,"px"),de.Q6J("ngSwitch","indeterminate"===ot.mode),de.uIk("viewBox",ot._getViewBox()),de.xp6(2),de.Q6J("ngSwitchCase",!0),de.xp6(1),de.Q6J("ngSwitchCase",!1))},dependencies:[a.RF,a.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:rgba(0,0,0,0);transition:stroke-dashoffset 225ms linear}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}.mat-progress-spinner[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}.mat-progress-spinner._mat-animation-noopable svg,.mat-progress-spinner._mat-animation-noopable circle{animation:none;transition:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}"],encapsulation:2,changeDetection:0});let et=(()=>{class Gt{}return Gt.\u0275fac=function(ot){return new(ot||Gt)},Gt.\u0275mod=de.oAB({type:Gt}),Gt.\u0275inj=de.cJS({imports:[Qe.BQ,a.ez,Qe.BQ]}),Gt})()},3267:(Yn,kt,L)=>{"use strict";L.d(kt,{LW:()=>nn,SJ:()=>Lt,jA:()=>Ct,kh:()=>Jt});var w=L(8605),y=L(6895),j=L(4650),a=L(3238),de=L(2687),Qe=L(445),it=L(1281),Ce=L(9521),Fe=L(3353),$e=L(7579),at=L(4968),qe=L(6451),Ve=L(9300),tt=L(4004),Re=L(9718),ft=L(2722),et=L(1884),ht=L(5698),Gt=L(8675),an=L(8372),ot=L(7340);const Te=["*"],Ne=["content"];function mt(Tt,fn){if(1&Tt){const me=j.EpF();j.TgZ(0,"div",2),j.NdJ("click",function(){j.CHM(me);const Se=j.oxw();return j.KtG(Se._onBackdropClicked())}),j.qZA()}if(2&Tt){const me=j.oxw();j.ekj("mat-drawer-shown",me._isShowingBackdrop())}}function It(Tt,fn){1&Tt&&(j.TgZ(0,"mat-drawer-content"),j.Hsn(1,2),j.qZA())}const sn=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Cn=["mat-drawer","mat-drawer-content","*"],Nn={transformDrawer:(0,ot.X$)("transform",[(0,ot.SB)("open, open-instant",(0,ot.oB)({transform:"none",visibility:"visible"})),(0,ot.SB)("void",(0,ot.oB)({"box-shadow":"none",visibility:"hidden"})),(0,ot.eR)("void => open-instant",(0,ot.jt)("0ms")),(0,ot.eR)("void <=> open, open-instant => void",(0,ot.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},Ci=new j.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function Zt(){return!1}}),Bt=new j.OlP("MAT_DRAWER_CONTAINER");let nn=(()=>{class Tt extends w.PQ{constructor(me,Rt,Se,vt,jn){super(Se,vt,jn),this._changeDetectorRef=me,this._container=Rt}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return Tt.\u0275fac=function(me){return new(me||Tt)(j.Y36(j.sBO),j.Y36((0,j.Gpc)(()=>Jt)),j.Y36(j.SBq),j.Y36(w.mF),j.Y36(j.R0b))},Tt.\u0275cmp=j.Xpm({type:Tt,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(me,Rt){2&me&&j.Udp("margin-left",Rt._container._contentMargins.left,"px")("margin-right",Rt._container._contentMargins.right,"px")},features:[j._Bn([{provide:w.PQ,useExisting:Tt}]),j.qOj],ngContentSelectors:Te,decls:1,vars:0,template:function(me,Rt){1&me&&(j.F$t(),j.Hsn(0))},encapsulation:2,changeDetection:0}),Tt})(),Ct=(()=>{class Tt{constructor(me,Rt,Se,vt,jn,li,Bi,dn){this._elementRef=me,this._focusTrapFactory=Rt,this._focusMonitor=Se,this._platform=vt,this._ngZone=jn,this._interactivityChecker=li,this._doc=Bi,this._container=dn,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new $e.x,this._animationEnd=new $e.x,this._animationState="void",this.openedChange=new j.vpe(!0),this._openedStream=this.openedChange.pipe((0,Ve.h)(ue=>ue),(0,tt.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,Ve.h)(ue=>ue.fromState!==ue.toState&&0===ue.toState.indexOf("open")),(0,Re.h)(void 0)),this._closedStream=this.openedChange.pipe((0,Ve.h)(ue=>!ue),(0,tt.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,Ve.h)(ue=>ue.fromState!==ue.toState&&"void"===ue.toState),(0,Re.h)(void 0)),this._destroyed=new $e.x,this.onPositionChanged=new j.vpe,this._modeChanged=new $e.x,this.openedChange.subscribe(ue=>{ue?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,at.R)(this._elementRef.nativeElement,"keydown").pipe((0,Ve.h)(ue=>ue.keyCode===Ce.hY&&!this.disableClose&&!(0,Ce.Vb)(ue)),(0,ft.R)(this._destroyed)).subscribe(ue=>this._ngZone.run(()=>{this.close(),ue.stopPropagation(),ue.preventDefault()}))}),this._animationEnd.pipe((0,et.x)((ue,ke)=>ue.fromState===ke.fromState&&ue.toState===ke.toState)).subscribe(ue=>{const{fromState:ke,toState:xt}=ue;(0===xt.indexOf("open")&&"void"===ke||"void"===xt&&0===ke.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(me){(me="end"===me?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(me),this._position=me,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(me){this._mode=me,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(me){this._disableClose=(0,it.Ig)(me)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(me){("true"===me||"false"===me||null==me)&&(me=(0,it.Ig)(me)),this._autoFocus=me}get opened(){return this._opened}set opened(me){this.toggle((0,it.Ig)(me))}_forceFocus(me,Rt){this._interactivityChecker.isFocusable(me)||(me.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const Se=()=>{me.removeEventListener("blur",Se),me.removeEventListener("mousedown",Se),me.removeAttribute("tabindex")};me.addEventListener("blur",Se),me.addEventListener("mousedown",Se)})),me.focus(Rt)}_focusByCssSelector(me,Rt){let Se=this._elementRef.nativeElement.querySelector(me);Se&&this._forceFocus(Se,Rt)}_takeFocus(){if(!this._focusTrap)return;const me=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(Rt=>{!Rt&&"function"==typeof this._elementRef.nativeElement.focus&&me.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(me){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,me):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const me=this._doc.activeElement;return!!me&&this._elementRef.nativeElement.contains(me)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(me){return this.toggle(!0,me)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(me=!this.opened,Rt){me&&Rt&&(this._openedVia=Rt);const Se=this._setOpen(me,!me&&this._isFocusWithinDrawer(),this._openedVia||"program");return me||(this._openedVia=null),Se}_setOpen(me,Rt,Se){return this._opened=me,me?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",Rt&&this._restoreFocus(Se)),this._updateFocusTrapState(),new Promise(vt=>{this.openedChange.pipe((0,ht.q)(1)).subscribe(jn=>vt(jn?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(me){const Rt=this._elementRef.nativeElement,Se=Rt.parentNode;"end"===me?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),Se.insertBefore(this._anchor,Rt)),Se.appendChild(Rt)):this._anchor&&this._anchor.parentNode.insertBefore(Rt,this._anchor)}}return Tt.\u0275fac=function(me){return new(me||Tt)(j.Y36(j.SBq),j.Y36(de.qV),j.Y36(de.tE),j.Y36(Fe.t4),j.Y36(j.R0b),j.Y36(de.ic),j.Y36(y.K0,8),j.Y36(Bt,8))},Tt.\u0275cmp=j.Xpm({type:Tt,selectors:[["mat-drawer"]],viewQuery:function(me,Rt){if(1&me&&j.Gf(Ne,5),2&me){let Se;j.iGM(Se=j.CRH())&&(Rt._content=Se.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(me,Rt){1&me&&j.WFA("@transform.start",function(vt){return Rt._animationStarted.next(vt)})("@transform.done",function(vt){return Rt._animationEnd.next(vt)}),2&me&&(j.uIk("align",null),j.d8E("@transform",Rt._animationState),j.ekj("mat-drawer-end","end"===Rt.position)("mat-drawer-over","over"===Rt.mode)("mat-drawer-push","push"===Rt.mode)("mat-drawer-side","side"===Rt.mode)("mat-drawer-opened",Rt.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Te,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(me,Rt){1&me&&(j.F$t(),j.TgZ(0,"div",0,1),j.Hsn(2),j.qZA())},dependencies:[w.PQ],encapsulation:2,data:{animation:[Nn.transformDrawer]},changeDetection:0}),Tt})(),Jt=(()=>{class Tt{constructor(me,Rt,Se,vt,jn,li=!1,Bi){this._dir=me,this._element=Rt,this._ngZone=Se,this._changeDetectorRef=vt,this._animationMode=Bi,this._drawers=new j.n_E,this.backdropClick=new j.vpe,this._destroyed=new $e.x,this._doCheckSubject=new $e.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new $e.x,me&&me.change.pipe((0,ft.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),jn.change().pipe((0,ft.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=li}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(me){this._autosize=(0,it.Ig)(me)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(me){this._backdropOverride=null==me?null:(0,it.Ig)(me)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,Gt.O)(this._allDrawers),(0,ft.R)(this._destroyed)).subscribe(me=>{this._drawers.reset(me.filter(Rt=>!Rt._container||Rt._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,Gt.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(me=>{this._watchDrawerToggle(me),this._watchDrawerPosition(me),this._watchDrawerMode(me)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,an.b)(10),(0,ft.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(me=>me.open())}close(){this._drawers.forEach(me=>me.close())}updateContentMargins(){let me=0,Rt=0;if(this._left&&this._left.opened)if("side"==this._left.mode)me+=this._left._getWidth();else if("push"==this._left.mode){const Se=this._left._getWidth();me+=Se,Rt-=Se}if(this._right&&this._right.opened)if("side"==this._right.mode)Rt+=this._right._getWidth();else if("push"==this._right.mode){const Se=this._right._getWidth();Rt+=Se,me-=Se}me=me||null,Rt=Rt||null,(me!==this._contentMargins.left||Rt!==this._contentMargins.right)&&(this._contentMargins={left:me,right:Rt},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(me){me._animationStarted.pipe((0,Ve.h)(Rt=>Rt.fromState!==Rt.toState),(0,ft.R)(this._drawers.changes)).subscribe(Rt=>{"open-instant"!==Rt.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==me.mode&&me.openedChange.pipe((0,ft.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(me.opened))}_watchDrawerPosition(me){me&&me.onPositionChanged.pipe((0,ft.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,ht.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(me){me&&me._modeChanged.pipe((0,ft.R)((0,qe.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(me){const Rt=this._element.nativeElement.classList,Se="mat-drawer-container-has-open";me?Rt.add(Se):Rt.remove(Se)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(me=>{"end"==me.position?this._end=me:this._start=me}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(me=>me&&!me.disableClose&&this._canHaveBackdrop(me)).forEach(me=>me._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(me){return"side"!==me.mode||!!this._backdropOverride}_isDrawerOpen(me){return null!=me&&me.opened}}return Tt.\u0275fac=function(me){return new(me||Tt)(j.Y36(Qe.Is,8),j.Y36(j.SBq),j.Y36(j.R0b),j.Y36(j.sBO),j.Y36(w.rL),j.Y36(Ci),j.Y36(j.QbO,8))},Tt.\u0275cmp=j.Xpm({type:Tt,selectors:[["mat-drawer-container"]],contentQueries:function(me,Rt,Se){if(1&me&&(j.Suo(Se,nn,5),j.Suo(Se,Ct,5)),2&me){let vt;j.iGM(vt=j.CRH())&&(Rt._content=vt.first),j.iGM(vt=j.CRH())&&(Rt._allDrawers=vt)}},viewQuery:function(me,Rt){if(1&me&&j.Gf(nn,5),2&me){let Se;j.iGM(Se=j.CRH())&&(Rt._userContent=Se.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(me,Rt){2&me&&j.ekj("mat-drawer-container-explicit-backdrop",Rt._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[j._Bn([{provide:Bt,useExisting:Tt}])],ngContentSelectors:Cn,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(me,Rt){1&me&&(j.F$t(sn),j.YNc(0,mt,1,2,"div",0),j.Hsn(1),j.Hsn(2,1),j.YNc(3,It,2,0,"mat-drawer-content",1)),2&me&&(j.Q6J("ngIf",Rt.hasBackdrop),j.xp6(3),j.Q6J("ngIf",!Rt._content))},dependencies:[y.O5,nn],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),Tt})(),Lt=(()=>{class Tt{}return Tt.\u0275fac=function(me){return new(me||Tt)},Tt.\u0275mod=j.oAB({type:Tt}),Tt.\u0275inj=j.cJS({imports:[y.ez,a.BQ,w.ZD,w.ZD,a.BQ]}),Tt})()},7009:(Yn,kt,L)=>{"use strict";L.d(kt,{ZX:()=>mt,ux:()=>Yt});var w=L(8184),y=L(4080),j=L(6895),a=L(4650),de=L(3238),Qe=L(4859),it=L(7579),Ce=L(3353),Fe=L(5698),$e=L(2722),at=L(7340),qe=L(2687),Ve=L(2289);function tt(nt,Et){if(1&nt){const ct=a.EpF();a.TgZ(0,"div",2)(1,"button",3),a.NdJ("click",function(){a.CHM(ct);const Nn=a.oxw();return a.KtG(Nn.action())}),a._uU(2),a.qZA()()}if(2&nt){const ct=a.oxw();a.xp6(2),a.Oqu(ct.data.action)}}function Re(nt,Et){}const ft=new a.OlP("MatSnackBarData");class et{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const ht=Math.pow(2,31)-1;class Gt{constructor(Et,ct){this._overlayRef=ct,this._afterDismissed=new it.x,this._afterOpened=new it.x,this._onAction=new it.x,this._dismissedByAction=!1,this.containerInstance=Et,Et._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(Et){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(Et,ht))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let an=(()=>{class nt{constructor(ct,Pn){this.snackBarRef=ct,this.data=Pn}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return nt.\u0275fac=function(ct){return new(ct||nt)(a.Y36(Gt),a.Y36(ft))},nt.\u0275cmp=a.Xpm({type:nt,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[[1,"mat-simple-snack-bar-content"],["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(ct,Pn){1&ct&&(a.TgZ(0,"span",0),a._uU(1),a.qZA(),a.YNc(2,tt,3,1,"div",1)),2&ct&&(a.xp6(1),a.Oqu(Pn.data.message),a.xp6(1),a.Q6J("ngIf",Pn.hasAction))},dependencies:[j.O5,Qe.lW],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}.mat-simple-snack-bar-content{overflow:hidden;text-overflow:ellipsis}"],encapsulation:2,changeDetection:0}),nt})();const ot={snackBarState:(0,at.X$)("state",[(0,at.SB)("void, hidden",(0,at.oB)({transform:"scale(0.8)",opacity:0})),(0,at.SB)("visible",(0,at.oB)({transform:"scale(1)",opacity:1})),(0,at.eR)("* => visible",(0,at.jt)("150ms cubic-bezier(0, 0, 0.2, 1)")),(0,at.eR)("* => void, * => hidden",(0,at.jt)("75ms cubic-bezier(0.4, 0.0, 1, 1)",(0,at.oB)({opacity:0})))])};let Te=(()=>{class nt extends y.en{constructor(ct,Pn,Nn,fi,Ci){super(),this._ngZone=ct,this._elementRef=Pn,this._changeDetectorRef=Nn,this._platform=fi,this.snackBarConfig=Ci,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new it.x,this._onExit=new it.x,this._onEnter=new it.x,this._animationState="void",this.attachDomPortal=Bt=>{this._assertNotAttached();const Zt=this._portalOutlet.attachDomPortal(Bt);return this._afterPortalAttached(),Zt},this._live="assertive"!==Ci.politeness||Ci.announcementMessage?"off"===Ci.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(ct){this._assertNotAttached();const Pn=this._portalOutlet.attachComponentPortal(ct);return this._afterPortalAttached(),Pn}attachTemplatePortal(ct){this._assertNotAttached();const Pn=this._portalOutlet.attachTemplatePortal(ct);return this._afterPortalAttached(),Pn}onAnimationEnd(ct){const{fromState:Pn,toState:Nn}=ct;if(("void"===Nn&&"void"!==Pn||"hidden"===Nn)&&this._completeExit(),"visible"===Nn){const fi=this._onEnter;this._ngZone.run(()=>{fi.next(),fi.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe((0,Fe.q)(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_afterPortalAttached(){const ct=this._elementRef.nativeElement,Pn=this.snackBarConfig.panelClass;Pn&&(Array.isArray(Pn)?Pn.forEach(Nn=>ct.classList.add(Nn)):ct.classList.add(Pn))}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const ct=this._elementRef.nativeElement.querySelector("[aria-hidden]"),Pn=this._elementRef.nativeElement.querySelector("[aria-live]");if(ct&&Pn){let Nn=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&ct.contains(document.activeElement)&&(Nn=document.activeElement),ct.removeAttribute("aria-hidden"),Pn.appendChild(ct),Nn?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return nt.\u0275fac=function(ct){return new(ct||nt)(a.Y36(a.R0b),a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Ce.t4),a.Y36(et))},nt.\u0275dir=a.lG2({type:nt,viewQuery:function(ct,Pn){if(1&ct&&a.Gf(y.Pl,7),2&ct){let Nn;a.iGM(Nn=a.CRH())&&(Pn._portalOutlet=Nn.first)}},features:[a.qOj]}),nt})(),Ne=(()=>{class nt extends Te{_afterPortalAttached(){super._afterPortalAttached(),"center"===this.snackBarConfig.horizontalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&this._elementRef.nativeElement.classList.add("mat-snack-bar-top")}}return nt.\u0275fac=function(){let Et;return function(Pn){return(Et||(Et=a.n5z(nt)))(Pn||nt)}}(),nt.\u0275cmp=a.Xpm({type:nt,selectors:[["snack-bar-container"]],hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(ct,Pn){1&ct&&a.WFA("@state.done",function(fi){return Pn.onAnimationEnd(fi)}),2&ct&&a.d8E("@state",Pn._animationState)},features:[a.qOj],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(ct,Pn){1&ct&&(a.TgZ(0,"div",0),a.YNc(1,Re,0,0,"ng-template",1),a.qZA(),a._UZ(2,"div")),2&ct&&(a.xp6(2),a.uIk("aria-live",Pn._live)("role",Pn._role))},dependencies:[y.Pl],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}"],encapsulation:2,data:{animation:[ot.snackBarState]}}),nt})(),mt=(()=>{class nt{}return nt.\u0275fac=function(ct){return new(ct||nt)},nt.\u0275mod=a.oAB({type:nt}),nt.\u0275inj=a.cJS({imports:[w.U8,y.eL,j.ez,Qe.ot,de.BQ,de.BQ]}),nt})();const It=new a.OlP("mat-snack-bar-default-options",{providedIn:"root",factory:function sn(){return new et}});let Cn=(()=>{class nt{constructor(ct,Pn,Nn,fi,Ci,Bt){this._overlay=ct,this._live=Pn,this._injector=Nn,this._breakpointObserver=fi,this._parentSnackBar=Ci,this._defaultConfig=Bt,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const ct=this._parentSnackBar;return ct?ct._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(ct){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=ct:this._snackBarRefAtThisLevel=ct}openFromComponent(ct,Pn){return this._attach(ct,Pn)}openFromTemplate(ct,Pn){return this._attach(ct,Pn)}open(ct,Pn="",Nn){const fi={...this._defaultConfig,...Nn};return fi.data={message:ct,action:Pn},fi.announcementMessage===ct&&(fi.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,fi)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(ct,Pn){const fi=a.zs3.create({parent:Pn&&Pn.viewContainerRef&&Pn.viewContainerRef.injector||this._injector,providers:[{provide:et,useValue:Pn}]}),Ci=new y.C5(this.snackBarContainerComponent,Pn.viewContainerRef,fi),Bt=ct.attach(Ci);return Bt.instance.snackBarConfig=Pn,Bt.instance}_attach(ct,Pn){const Nn={...new et,...this._defaultConfig,...Pn},fi=this._createOverlay(Nn),Ci=this._attachSnackBarContainer(fi,Nn),Bt=new Gt(Ci,fi);if(ct instanceof a.Rgc){const Zt=new y.UE(ct,null,{$implicit:Nn.data,snackBarRef:Bt});Bt.instance=Ci.attachTemplatePortal(Zt)}else{const Zt=this._createInjector(Nn,Bt),nn=new y.C5(ct,void 0,Zt),Ct=Ci.attachComponentPortal(nn);Bt.instance=Ct.instance}return this._breakpointObserver.observe(Ve.u3.HandsetPortrait).pipe((0,$e.R)(fi.detachments())).subscribe(Zt=>{fi.overlayElement.classList.toggle(this.handsetCssClass,Zt.matches)}),Nn.announcementMessage&&Ci._onAnnounce.subscribe(()=>{this._live.announce(Nn.announcementMessage,Nn.politeness)}),this._animateSnackBar(Bt,Nn),this._openedSnackBarRef=Bt,this._openedSnackBarRef}_animateSnackBar(ct,Pn){ct.afterDismissed().subscribe(()=>{this._openedSnackBarRef==ct&&(this._openedSnackBarRef=null),Pn.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{ct.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):ct.containerInstance.enter(),Pn.duration&&Pn.duration>0&&ct.afterOpened().subscribe(()=>ct._dismissAfter(Pn.duration))}_createOverlay(ct){const Pn=new w.X_;Pn.direction=ct.direction;let Nn=this._overlay.position().global();const fi="rtl"===ct.direction,Ci="left"===ct.horizontalPosition||"start"===ct.horizontalPosition&&!fi||"end"===ct.horizontalPosition&&fi,Bt=!Ci&&"center"!==ct.horizontalPosition;return Ci?Nn.left("0"):Bt?Nn.right("0"):Nn.centerHorizontally(),"top"===ct.verticalPosition?Nn.top("0"):Nn.bottom("0"),Pn.positionStrategy=Nn,this._overlay.create(Pn)}_createInjector(ct,Pn){return a.zs3.create({parent:ct&&ct.viewContainerRef&&ct.viewContainerRef.injector||this._injector,providers:[{provide:Gt,useValue:Pn},{provide:ft,useValue:ct.data}]})}}return nt.\u0275fac=function(ct){return new(ct||nt)(a.LFG(w.aV),a.LFG(qe.Kd),a.LFG(a.zs3),a.LFG(Ve.Yg),a.LFG(nt,12),a.LFG(It))},nt.\u0275prov=a.Yz7({token:nt,factory:nt.\u0275fac}),nt})(),Yt=(()=>{class nt extends Cn{constructor(ct,Pn,Nn,fi,Ci,Bt){super(ct,Pn,Nn,fi,Ci,Bt),this.simpleSnackBarComponent=an,this.snackBarContainerComponent=Ne,this.handsetCssClass="mat-snack-bar-handset"}}return nt.\u0275fac=function(ct){return new(ct||nt)(a.LFG(w.aV),a.LFG(qe.Kd),a.LFG(a.zs3),a.LFG(Ve.Yg),a.LFG(nt,12),a.LFG(It))},nt.\u0275prov=a.Yz7({token:nt,factory:nt.\u0275fac,providedIn:mt}),nt})()},1481:(Yn,kt,L)=>{"use strict";L.d(kt,{Dx:()=>Mn,H7:()=>ae,b2:()=>xt,q6:()=>Bi,se:()=>ct});var w=L(6895),y=L(4650);class j extends w.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class a extends j{static makeCurrent(){(0,w.HT)(new a)}onAndCancel(fe,te,ge){return fe.addEventListener(te,ge,!1),()=>{fe.removeEventListener(te,ge,!1)}}dispatchEvent(fe,te){fe.dispatchEvent(te)}remove(fe){fe.parentNode&&fe.parentNode.removeChild(fe)}createElement(fe,te){return(te=te||this.getDefaultDocument()).createElement(fe)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(fe){return fe.nodeType===Node.ELEMENT_NODE}isShadowRoot(fe){return fe instanceof DocumentFragment}getGlobalEventTarget(fe,te){return"window"===te?window:"document"===te?fe:"body"===te?fe.body:null}getBaseHref(fe){const te=function Qe(){return de=de||document.querySelector("base"),de?de.getAttribute("href"):null}();return null==te?null:function Ce(xe){it=it||document.createElement("a"),it.setAttribute("href",xe);const fe=it.pathname;return"/"===fe.charAt(0)?fe:`/${fe}`}(te)}resetBaseElement(){de=null}getUserAgent(){return window.navigator.userAgent}getCookie(fe){return(0,w.Mx)(document.cookie,fe)}}let it,de=null;const Fe=new y.OlP("TRANSITION_ID"),at=[{provide:y.ip1,useFactory:function $e(xe,fe,te){return()=>{te.get(y.CZH).donePromise.then(()=>{const ge=(0,w.q)(),ut=fe.querySelectorAll(`style[ng-transition="${xe}"]`);for(let en=0;en<ut.length;en++)ge.remove(ut[en])})}},deps:[Fe,w.K0,y.zs3],multi:!0}];let Ve=(()=>{class xe{build(){return new XMLHttpRequest}}return xe.\u0275fac=function(te){return new(te||xe)},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();const tt=new y.OlP("EventManagerPlugins");let Re=(()=>{class xe{constructor(te,ge){this._zone=ge,this._eventNameToPlugin=new Map,te.forEach(ut=>{ut.manager=this}),this._plugins=te.slice().reverse()}addEventListener(te,ge,ut){return this._findPluginFor(ge).addEventListener(te,ge,ut)}addGlobalEventListener(te,ge,ut){return this._findPluginFor(ge).addGlobalEventListener(te,ge,ut)}getZone(){return this._zone}_findPluginFor(te){const ge=this._eventNameToPlugin.get(te);if(ge)return ge;const ut=this._plugins;for(let en=0;en<ut.length;en++){const Xt=ut[en];if(Xt.supports(te))return this._eventNameToPlugin.set(te,Xt),Xt}throw new Error(`No event manager plugin found for event ${te}`)}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(tt),y.LFG(y.R0b))},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();class ft{constructor(fe){this._doc=fe}addGlobalEventListener(fe,te,ge){const ut=(0,w.q)().getGlobalEventTarget(this._doc,fe);if(!ut)throw new Error(`Unsupported event target ${ut} for event ${te}`);return this.addEventListener(ut,te,ge)}}let et=(()=>{class xe{constructor(){this.usageCount=new Map}addStyles(te){for(const ge of te)1===this.changeUsageCount(ge,1)&&this.onStyleAdded(ge)}removeStyles(te){for(const ge of te)0===this.changeUsageCount(ge,-1)&&this.onStyleRemoved(ge)}onStyleRemoved(te){}onStyleAdded(te){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(te,ge){const ut=this.usageCount;let en=ut.get(te)??0;return en+=ge,en>0?ut.set(te,en):ut.delete(te),en}ngOnDestroy(){for(const te of this.getAllStyles())this.onStyleRemoved(te);this.usageCount.clear()}}return xe.\u0275fac=function(te){return new(te||xe)},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})(),ht=(()=>{class xe extends et{constructor(te){super(),this.doc=te,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(te){for(const ge of this.hostNodes)this.addStyleToHost(ge,te)}onStyleRemoved(te){const ge=this.styleRef;ge.get(te)?.forEach(en=>en.remove()),ge.delete(te)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(te){this.hostNodes.add(te);for(const ge of this.getAllStyles())this.addStyleToHost(te,ge)}removeHost(te){this.hostNodes.delete(te)}addStyleToHost(te,ge){const ut=this.doc.createElement("style");ut.textContent=ge,te.appendChild(ut);const en=this.styleRef.get(ge);en?en.push(ut):this.styleRef.set(ge,[ut])}resetHostNodes(){const te=this.hostNodes;te.clear(),te.add(this.doc.head)}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(w.K0))},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();const Gt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},an=/%COMP%/g,sn=new y.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function nt(xe,fe){return fe.flat(100).map(te=>te.replace(an,xe))}function Et(xe){return fe=>{if("__ngUnwrap__"===fe)return xe;!1===xe(fe)&&(fe.preventDefault(),fe.returnValue=!1)}}let ct=(()=>{class xe{constructor(te,ge,ut,en){this.eventManager=te,this.sharedStylesHost=ge,this.appId=ut,this.removeStylesOnCompDestory=en,this.rendererByCompId=new Map,this.defaultRenderer=new Pn(te)}createRenderer(te,ge){if(!te||!ge)return this.defaultRenderer;const ut=this.getOrCreateRenderer(te,ge);return ut instanceof nn?ut.applyToHost(te):ut instanceof Zt&&ut.applyStyles(),ut}getOrCreateRenderer(te,ge){const ut=this.rendererByCompId;let en=ut.get(ge.id);if(!en){const Xt=this.eventManager,Qn=this.sharedStylesHost,ei=this.removeStylesOnCompDestory;switch(ge.encapsulation){case y.ifc.Emulated:en=new nn(Xt,Qn,ge,this.appId,ei);break;case y.ifc.ShadowDom:return new Bt(Xt,Qn,te,ge);default:en=new Zt(Xt,Qn,ge,ei)}en.onDestroy=()=>ut.delete(ge.id),ut.set(ge.id,en)}return en}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(Re),y.LFG(ht),y.LFG(y.AFp),y.LFG(sn))},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();class Pn{constructor(fe){this.eventManager=fe,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(fe,te){return te?document.createElementNS(Gt[te]||te,fe):document.createElement(fe)}createComment(fe){return document.createComment(fe)}createText(fe){return document.createTextNode(fe)}appendChild(fe,te){(Ci(fe)?fe.content:fe).appendChild(te)}insertBefore(fe,te,ge){fe&&(Ci(fe)?fe.content:fe).insertBefore(te,ge)}removeChild(fe,te){fe&&fe.removeChild(te)}selectRootElement(fe,te){let ge="string"==typeof fe?document.querySelector(fe):fe;if(!ge)throw new Error(`The selector "${fe}" did not match any elements`);return te||(ge.textContent=""),ge}parentNode(fe){return fe.parentNode}nextSibling(fe){return fe.nextSibling}setAttribute(fe,te,ge,ut){if(ut){te=ut+":"+te;const en=Gt[ut];en?fe.setAttributeNS(en,te,ge):fe.setAttribute(te,ge)}else fe.setAttribute(te,ge)}removeAttribute(fe,te,ge){if(ge){const ut=Gt[ge];ut?fe.removeAttributeNS(ut,te):fe.removeAttribute(`${ge}:${te}`)}else fe.removeAttribute(te)}addClass(fe,te){fe.classList.add(te)}removeClass(fe,te){fe.classList.remove(te)}setStyle(fe,te,ge,ut){ut&(y.JOm.DashCase|y.JOm.Important)?fe.style.setProperty(te,ge,ut&y.JOm.Important?"important":""):fe.style[te]=ge}removeStyle(fe,te,ge){ge&y.JOm.DashCase?fe.style.removeProperty(te):fe.style[te]=""}setProperty(fe,te,ge){fe[te]=ge}setValue(fe,te){fe.nodeValue=te}listen(fe,te,ge){return"string"==typeof fe?this.eventManager.addGlobalEventListener(fe,te,Et(ge)):this.eventManager.addEventListener(fe,te,Et(ge))}}function Ci(xe){return"TEMPLATE"===xe.tagName&&void 0!==xe.content}class Bt extends Pn{constructor(fe,te,ge,ut){super(fe),this.sharedStylesHost=te,this.hostEl=ge,this.shadowRoot=ge.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const en=nt(ut.id,ut.styles);for(const Xt of en){const Qn=document.createElement("style");Qn.textContent=Xt,this.shadowRoot.appendChild(Qn)}}nodeOrShadowRoot(fe){return fe===this.hostEl?this.shadowRoot:fe}appendChild(fe,te){return super.appendChild(this.nodeOrShadowRoot(fe),te)}insertBefore(fe,te,ge){return super.insertBefore(this.nodeOrShadowRoot(fe),te,ge)}removeChild(fe,te){return super.removeChild(this.nodeOrShadowRoot(fe),te)}parentNode(fe){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(fe)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Zt extends Pn{constructor(fe,te,ge,ut,en=ge.id){super(fe),this.sharedStylesHost=te,this.removeStylesOnCompDestory=ut,this.rendererUsageCount=0,this.styles=nt(en,ge.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class nn extends Zt{constructor(fe,te,ge,ut,en){const Xt=ut+"-"+ge.id;super(fe,te,ge,en,Xt),this.contentAttr=function Cn(xe){return"_ngcontent-%COMP%".replace(an,xe)}(Xt),this.hostAttr=function Yt(xe){return"_nghost-%COMP%".replace(an,xe)}(Xt)}applyToHost(fe){this.applyStyles(),this.setAttribute(fe,this.hostAttr,"")}createElement(fe,te){const ge=super.createElement(fe,te);return super.setAttribute(ge,this.contentAttr,""),ge}}let Ct=(()=>{class xe extends ft{constructor(te){super(te)}supports(te){return!0}addEventListener(te,ge,ut){return te.addEventListener(ge,ut,!1),()=>this.removeEventListener(te,ge,ut)}removeEventListener(te,ge,ut){return te.removeEventListener(ge,ut)}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(w.K0))},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();const Jt=["alt","control","meta","shift"],ze={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},zt={alt:xe=>xe.altKey,control:xe=>xe.ctrlKey,meta:xe=>xe.metaKey,shift:xe=>xe.shiftKey};let ve=(()=>{class xe extends ft{constructor(te){super(te)}supports(te){return null!=xe.parseEventName(te)}addEventListener(te,ge,ut){const en=xe.parseEventName(ge),Xt=xe.eventCallback(en.fullKey,ut,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,w.q)().onAndCancel(te,en.domEventName,Xt))}static parseEventName(te){const ge=te.toLowerCase().split("."),ut=ge.shift();if(0===ge.length||"keydown"!==ut&&"keyup"!==ut)return null;const en=xe._normalizeKey(ge.pop());let Xt="",Qn=ge.indexOf("code");if(Qn>-1&&(ge.splice(Qn,1),Xt="code."),Jt.forEach(ci=>{const gi=ge.indexOf(ci);gi>-1&&(ge.splice(gi,1),Xt+=ci+".")}),Xt+=en,0!=ge.length||0===en.length)return null;const ei={};return ei.domEventName=ut,ei.fullKey=Xt,ei}static matchEventFullKeyCode(te,ge){let ut=ze[te.key]||te.key,en="";return ge.indexOf("code.")>-1&&(ut=te.code,en="code."),!(null==ut||!ut)&&(ut=ut.toLowerCase()," "===ut?ut="space":"."===ut&&(ut="dot"),Jt.forEach(Xt=>{Xt!==ut&&(0,zt[Xt])(te)&&(en+=Xt+".")}),en+=ut,en===ge)}static eventCallback(te,ge,ut){return en=>{xe.matchEventFullKeyCode(en,te)&&ut.runGuarded(()=>ge(en))}}static _normalizeKey(te){return"esc"===te?"escape":te}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(w.K0))},xe.\u0275prov=y.Yz7({token:xe,factory:xe.\u0275fac}),xe})();const Bi=(0,y.eFA)(y._c5,"browser",[{provide:y.Lbi,useValue:w.bD},{provide:y.g9A,useValue:function Se(){a.makeCurrent()},multi:!0},{provide:w.K0,useFactory:function jn(){return(0,y.RDi)(document),document},deps:[]}]),dn=new y.OlP(""),ue=[{provide:y.rWj,useClass:class qe{addToWindow(fe){y.dqk.getAngularTestability=(ge,ut=!0)=>{const en=fe.findTestabilityInTree(ge,ut);if(null==en)throw new Error("Could not find testability for element.");return en},y.dqk.getAllAngularTestabilities=()=>fe.getAllTestabilities(),y.dqk.getAllAngularRootElements=()=>fe.getAllRootElements(),y.dqk.frameworkStabilizers||(y.dqk.frameworkStabilizers=[]),y.dqk.frameworkStabilizers.push(ge=>{const ut=y.dqk.getAllAngularTestabilities();let en=ut.length,Xt=!1;const Qn=function(ei){Xt=Xt||ei,en--,0==en&&ge(Xt)};ut.forEach(function(ei){ei.whenStable(Qn)})})}findTestabilityInTree(fe,te,ge){return null==te?null:fe.getTestability(te)??(ge?(0,w.q)().isShadowRoot(te)?this.findTestabilityInTree(fe,te.host,!0):this.findTestabilityInTree(fe,te.parentElement,!0):null)}},deps:[]},{provide:y.lri,useClass:y.dDg,deps:[y.R0b,y.eoX,y.rWj]},{provide:y.dDg,useClass:y.dDg,deps:[y.R0b,y.eoX,y.rWj]}],ke=[{provide:y.zSh,useValue:"root"},{provide:y.qLn,useFactory:function vt(){return new y.qLn},deps:[]},{provide:tt,useClass:Ct,multi:!0,deps:[w.K0,y.R0b,y.Lbi]},{provide:tt,useClass:ve,multi:!0,deps:[w.K0]},{provide:ct,useClass:ct,deps:[Re,ht,y.AFp,sn]},{provide:y.FYo,useExisting:ct},{provide:et,useExisting:ht},{provide:ht,useClass:ht,deps:[w.K0]},{provide:Re,useClass:Re,deps:[tt,y.R0b]},{provide:w.JF,useClass:Ve,deps:[]},[]];let xt=(()=>{class xe{constructor(te){}static withServerTransition(te){return{ngModule:xe,providers:[{provide:y.AFp,useValue:te.appId},{provide:Fe,useExisting:y.AFp},at]}}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(dn,12))},xe.\u0275mod=y.oAB({type:xe}),xe.\u0275inj=y.cJS({providers:[...ke,...ue],imports:[w.ez,y.hGG]}),xe})(),Mn=(()=>{class xe{constructor(te){this._doc=te}getTitle(){return this._doc.title}setTitle(te){this._doc.title=te||""}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(w.K0))},xe.\u0275prov=y.Yz7({token:xe,factory:function(te){let ge=null;return ge=te?new te:function Fn(){return new Mn((0,y.LFG)(w.K0))}(),ge},providedIn:"root"}),xe})();typeof window<"u"&&window;let ae=(()=>{class xe{}return xe.\u0275fac=function(te){return new(te||xe)},xe.\u0275prov=y.Yz7({token:xe,factory:function(te){let ge=null;return ge=te?new(te||xe):y.LFG(Ge),ge},providedIn:"root"}),xe})(),Ge=(()=>{class xe extends ae{constructor(te){super(),this._doc=te}sanitize(te,ge){if(null==ge)return null;switch(te){case y.q3G.NONE:return ge;case y.q3G.HTML:return(0,y.qzn)(ge,"HTML")?(0,y.z3N)(ge):(0,y.EiD)(this._doc,String(ge)).toString();case y.q3G.STYLE:return(0,y.qzn)(ge,"Style")?(0,y.z3N)(ge):ge;case y.q3G.SCRIPT:if((0,y.qzn)(ge,"Script"))return(0,y.z3N)(ge);throw new Error("unsafe value used in a script context");case y.q3G.URL:return(0,y.qzn)(ge,"URL")?(0,y.z3N)(ge):(0,y.mCW)(String(ge));case y.q3G.RESOURCE_URL:if((0,y.qzn)(ge,"ResourceURL"))return(0,y.z3N)(ge);throw new Error(`unsafe value used in a resource URL context (see ${y.JZr})`);default:throw new Error(`Unexpected SecurityContext ${te} (see ${y.JZr})`)}}bypassSecurityTrustHtml(te){return(0,y.JVY)(te)}bypassSecurityTrustStyle(te){return(0,y.L6k)(te)}bypassSecurityTrustScript(te){return(0,y.eBb)(te)}bypassSecurityTrustUrl(te){return(0,y.LAX)(te)}bypassSecurityTrustResourceUrl(te){return(0,y.pB0)(te)}}return xe.\u0275fac=function(te){return new(te||xe)(y.LFG(w.K0))},xe.\u0275prov=y.Yz7({token:xe,factory:function(te){let ge=null;return ge=te?new te:function ye(xe){return new Ge(xe.get(w.K0))}(y.LFG(y.zs3)),ge},providedIn:"root"}),xe})()},8996:(Yn,kt,L)=>{"use strict";L.d(kt,{gz:()=>As,wm:()=>hc,F0:()=>Do,rH:()=>wl,Od:()=>El,Bz:()=>qa,lC:()=>fs});var w=L(4650),y=L(2076),j=L(9646),a=L(1135);const Qe=(0,L(3888).d)(P=>function(){P(this),this.name="EmptyError",this.message="no elements in sequence"});var it=L(9841),Ce=L(7272),Fe=L(9770),$e=L(9635),at=L(2843),qe=L(9751),Ve=L(515),tt=L(4033),Re=L(7579),ft=L(6895),et=L(4004),ht=L(3900),Gt=L(5698),an=L(8675),ot=L(9300),Te=L(5577),Ne=L(4482),mt=L(5403);function It(P){return(0,Ne.e)((k,D)=>{let z=!1;k.subscribe((0,mt.x)(D,ee=>{z=!0,D.next(ee)},()=>{z||D.next(P),D.complete()}))})}function sn(P=Cn){return(0,Ne.e)((k,D)=>{let z=!1;k.subscribe((0,mt.x)(D,ee=>{z=!0,D.next(ee)},()=>z?D.complete():D.error(P())))})}function Cn(){return new Qe}var Yt=L(4671);function nt(P,k){const D=arguments.length>=2;return z=>z.pipe(P?(0,ot.h)((ee,u)=>P(ee,u,z)):Yt.y,(0,Gt.q)(1),D?It(k):sn(()=>new Qe))}var Et=L(4351),ct=L(8505),Pn=L(262);function fi(P,k){return(0,Ne.e)(function Nn(P,k,D,z,ee){return(u,t)=>{let l=D,p=k,_=0;u.subscribe((0,mt.x)(t,b=>{const M=_++;p=l?P(p,b,M):(l=!0,b),z&&t.next(p)},ee&&(()=>{l&&t.next(p),t.complete()})))}}(P,k,arguments.length>=2,!0))}function Ci(P){return P<=0?()=>Ve.E:(0,Ne.e)((k,D)=>{let z=[];k.subscribe((0,mt.x)(D,ee=>{z.push(ee),P<z.length&&z.shift()},()=>{for(const ee of z)D.next(ee);D.complete()},void 0,()=>{z=null}))})}function Bt(P,k){const D=arguments.length>=2;return z=>z.pipe(P?(0,ot.h)((ee,u)=>P(ee,u,z)):Yt.y,Ci(1),D?It(k):sn(()=>new Qe))}var nn=L(9718),Ct=L(8746),Jt=L(8343),ze=L(8189),zt=L(1481);const ve="primary",Lt=Symbol("RouteTitle");class Tt{constructor(k){this.params=k||{}}has(k){return Object.prototype.hasOwnProperty.call(this.params,k)}get(k){if(this.has(k)){const D=this.params[k];return Array.isArray(D)?D[0]:D}return null}getAll(k){if(this.has(k)){const D=this.params[k];return Array.isArray(D)?D:[D]}return[]}get keys(){return Object.keys(this.params)}}function fn(P){return new Tt(P)}function me(P,k,D){const z=D.path.split("/");if(z.length>P.length||"full"===D.pathMatch&&(k.hasChildren()||z.length<P.length))return null;const ee={};for(let u=0;u<z.length;u++){const t=z[u],l=P[u];if(t.startsWith(":"))ee[t.substring(1)]=l;else if(t!==l.path)return null}return{consumed:P.slice(0,z.length),posParams:ee}}function Se(P,k){const D=P?Object.keys(P):void 0,z=k?Object.keys(k):void 0;if(!D||!z||D.length!=z.length)return!1;let ee;for(let u=0;u<D.length;u++)if(ee=D[u],!vt(P[ee],k[ee]))return!1;return!0}function vt(P,k){if(Array.isArray(P)&&Array.isArray(k)){if(P.length!==k.length)return!1;const D=[...P].sort(),z=[...k].sort();return D.every((ee,u)=>z[u]===ee)}return P===k}function jn(P){return Array.prototype.concat.apply([],P)}function li(P){return P.length>0?P[P.length-1]:null}function dn(P,k){for(const D in P)P.hasOwnProperty(D)&&k(P[D],D)}function ue(P){return(0,w.CqO)(P)?P:(0,w.QGY)(P)?(0,y.D)(Promise.resolve(P)):(0,j.of)(P)}const ke=!1,xt={exact:function Fn(P,k,D){if(!Qi(P.segments,k.segments)||!Qt(P.segments,k.segments,D)||P.numberOfChildren!==k.numberOfChildren)return!1;for(const z in k.children)if(!P.children[z]||!Fn(P.children[z],k.children[z],D))return!1;return!0},subset:At},lt={exact:function An(P,k){return Se(P,k)},subset:function Mn(P,k){return Object.keys(k).length<=Object.keys(P).length&&Object.keys(k).every(D=>vt(P[D],k[D]))},ignored:()=>!0};function Vt(P,k,D){return xt[D.paths](P.root,k.root,D.matrixParams)&&lt[D.queryParams](P.queryParams,k.queryParams)&&!("exact"===D.fragment&&P.fragment!==k.fragment)}function At(P,k,D){return Ae(P,k,k.segments,D)}function Ae(P,k,D,z){if(P.segments.length>D.length){const ee=P.segments.slice(0,D.length);return!(!Qi(ee,D)||k.hasChildren()||!Qt(ee,D,z))}if(P.segments.length===D.length){if(!Qi(P.segments,D)||!Qt(P.segments,D,z))return!1;for(const ee in k.children)if(!P.children[ee]||!At(P.children[ee],k.children[ee],z))return!1;return!0}{const ee=D.slice(0,P.segments.length),u=D.slice(P.segments.length);return!!(Qi(P.segments,ee)&&Qt(P.segments,ee,z)&&P.children[ve])&&Ae(P.children[ve],k,u,z)}}function Qt(P,k,D){return k.every((z,ee)=>lt[D](P[ee].parameters,z.parameters))}class Dn{constructor(k=new ln([],{}),D={},z=null){this.root=k,this.queryParams=D,this.fragment=z}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fn(this.queryParams)),this._queryParamMap}toString(){return Ft.serialize(this)}}class ln{constructor(k,D){this.segments=k,this.children=D,this.parent=null,dn(D,(z,ee)=>z.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return _t(this)}}class mi{constructor(k,D){this.path=k,this.parameters=D}get parameterMap(){return this._parameterMap||(this._parameterMap=fn(this.parameters)),this._parameterMap}toString(){return pe(this)}}function Qi(P,k){return P.length===k.length&&P.every((D,z)=>D.path===k[z].path)}let Ir=(()=>{class P{}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:function(){return new Kt},providedIn:"root"}),P})();class Kt{parse(k){const D=new ge(k);return new Dn(D.parseRootSegment(),D.parseQueryParams(),D.parseFragment())}serialize(k){const D=`/${bn(k.root,!0)}`,z=function ae(P){const k=Object.keys(P).map(D=>{const z=P[D];return Array.isArray(z)?z.map(ee=>`${De(D)}=${De(ee)}`).join("&"):`${De(D)}=${De(z)}`}).filter(D=>!!D);return k.length?`?${k.join("&")}`:""}(k.queryParams);return`${D}${z}${"string"==typeof k.fragment?`#${function oe(P){return encodeURI(P)}(k.fragment)}`:""}`}}const Ft=new Kt;function _t(P){return P.segments.map(k=>pe(k)).join("/")}function bn(P,k){if(!P.hasChildren())return _t(P);if(k){const D=P.children[ve]?bn(P.children[ve],!1):"",z=[];return dn(P.children,(ee,u)=>{u!==ve&&z.push(`${u}:${bn(ee,!1)}`)}),z.length>0?`${D}(${z.join("//")})`:D}{const D=function Ii(P,k){let D=[];return dn(P.children,(z,ee)=>{ee===ve&&(D=D.concat(k(z,ee)))}),dn(P.children,(z,ee)=>{ee!==ve&&(D=D.concat(k(z,ee)))}),D}(P,(z,ee)=>ee===ve?[bn(P.children[ve],!1)]:[`${ee}:${bn(z,!1)}`]);return 1===Object.keys(P.children).length&&null!=P.children[ve]?`${_t(P)}/${D[0]}`:`${_t(P)}/(${D.join("//")})`}}function Ut(P){return encodeURIComponent(P).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function De(P){return Ut(P).replace(/%3B/gi,";")}function be(P){return Ut(P).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function wt(P){return decodeURIComponent(P)}function $t(P){return wt(P.replace(/\+/g,"%20"))}function pe(P){return`${be(P.path)}${function Q(P){return Object.keys(P).map(k=>`;${be(k)}=${be(P[k])}`).join("")}(P.parameters)}`}const ye=/^[^\/()?;=#]+/;function Ge(P){const k=P.match(ye);return k?k[0]:""}const Ye=/^[^=?&#]+/,fe=/^[^&#]+/;class ge{constructor(k){this.url=k,this.remaining=k}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ln([],{}):new ln([],this.parseChildren())}parseQueryParams(){const k={};if(this.consumeOptional("?"))do{this.parseQueryParam(k)}while(this.consumeOptional("&"));return k}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const k=[];for(this.peekStartsWith("(")||k.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),k.push(this.parseSegment());let D={};this.peekStartsWith("/(")&&(this.capture("/"),D=this.parseParens(!0));let z={};return this.peekStartsWith("(")&&(z=this.parseParens(!1)),(k.length>0||Object.keys(D).length>0)&&(z[ve]=new ln(k,D)),z}parseSegment(){const k=Ge(this.remaining);if(""===k&&this.peekStartsWith(";"))throw new w.vHH(4009,ke);return this.capture(k),new mi(wt(k),this.parseMatrixParams())}parseMatrixParams(){const k={};for(;this.consumeOptional(";");)this.parseParam(k);return k}parseParam(k){const D=Ge(this.remaining);if(!D)return;this.capture(D);let z="";if(this.consumeOptional("=")){const ee=Ge(this.remaining);ee&&(z=ee,this.capture(z))}k[wt(D)]=wt(z)}parseQueryParam(k){const D=function xe(P){const k=P.match(Ye);return k?k[0]:""}(this.remaining);if(!D)return;this.capture(D);let z="";if(this.consumeOptional("=")){const t=function te(P){const k=P.match(fe);return k?k[0]:""}(this.remaining);t&&(z=t,this.capture(z))}const ee=$t(D),u=$t(z);if(k.hasOwnProperty(ee)){let t=k[ee];Array.isArray(t)||(t=[t],k[ee]=t),t.push(u)}else k[ee]=u}parseParens(k){const D={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const z=Ge(this.remaining),ee=this.remaining[z.length];if("/"!==ee&&")"!==ee&&";"!==ee)throw new w.vHH(4010,ke);let u;z.indexOf(":")>-1?(u=z.slice(0,z.indexOf(":")),this.capture(u),this.capture(":")):k&&(u=ve);const t=this.parseChildren();D[u]=1===Object.keys(t).length?t[ve]:new ln([],t),this.consumeOptional("//")}return D}peekStartsWith(k){return this.remaining.startsWith(k)}consumeOptional(k){return!!this.peekStartsWith(k)&&(this.remaining=this.remaining.substring(k.length),!0)}capture(k){if(!this.consumeOptional(k))throw new w.vHH(4011,ke)}}function ut(P){return P.segments.length>0?new ln([],{[ve]:P}):P}function en(P){const k={};for(const z of Object.keys(P.children)){const u=en(P.children[z]);(u.segments.length>0||u.hasChildren())&&(k[z]=u)}return function Xt(P){if(1===P.numberOfChildren&&P.children[ve]){const k=P.children[ve];return new ln(P.segments.concat(k.segments),k.children)}return P}(new ln(P.segments,k))}function Qn(P){return P instanceof Dn}const ei=!1;function ji(P,k,D,z,ee){if(0===D.length)return ir(k.root,k.root,k.root,z,ee);const u=function Cr(P){if("string"==typeof P[0]&&1===P.length&&"/"===P[0])return new kr(!0,0,P);let k=0,D=!1;const z=P.reduce((ee,u,t)=>{if("object"==typeof u&&null!=u){if(u.outlets){const l={};return dn(u.outlets,(p,_)=>{l[_]="string"==typeof p?p.split("/"):p}),[...ee,{outlets:l}]}if(u.segmentPath)return[...ee,u.segmentPath]}return"string"!=typeof u?[...ee,u]:0===t?(u.split("/").forEach((l,p)=>{0==p&&"."===l||(0==p&&""===l?D=!0:".."===l?k++:""!=l&&ee.push(l))}),ee):[...ee,u]},[]);return new kr(D,k,z)}(D);return u.toRoot()?ir(k.root,k.root,new ln([],{}),z,ee):function t(p){const _=function Lr(P,k,D,z){if(P.isAbsolute)return new pn(k.root,!0,0);if(-1===z)return new pn(D,D===k.root,0);return function Ro(P,k,D){let z=P,ee=k,u=D;for(;u>ee;){if(u-=ee,z=z.parent,!z)throw new w.vHH(4005,ei&&"Invalid number of '../'");ee=z.segments.length}return new pn(z,!1,ee-u)}(D,z+(hi(P.commands[0])?0:1),P.numberOfDoubleDots)}(u,k,P.snapshot?._urlSegment,p),b=_.processChildren?ii(_.segmentGroup,_.index,u.commands):Pr(_.segmentGroup,_.index,u.commands);return ir(k.root,_.segmentGroup,b,z,ee)}(P.snapshot?._lastPathIndex)}function hi(P){return"object"==typeof P&&null!=P&&!P.outlets&&!P.segmentPath}function Yi(P){return"object"==typeof P&&null!=P&&P.outlets}function ir(P,k,D,z,ee){let t,u={};z&&dn(z,(p,_)=>{u[_]=Array.isArray(p)?p.map(b=>`${b}`):`${p}`}),t=P===k?D:Ki(P,k,D);const l=ut(en(t));return new Dn(l,u,ee)}function Ki(P,k,D){const z={};return dn(P.children,(ee,u)=>{z[u]=ee===k?D:Ki(ee,k,D)}),new ln(P.segments,z)}class kr{constructor(k,D,z){if(this.isAbsolute=k,this.numberOfDoubleDots=D,this.commands=z,k&&z.length>0&&hi(z[0]))throw new w.vHH(4003,ei&&"Root segment cannot have matrix parameters");const ee=z.find(Yi);if(ee&&ee!==li(z))throw new w.vHH(4004,ei&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class pn{constructor(k,D,z){this.segmentGroup=k,this.processChildren=D,this.index=z}}function Pr(P,k,D){if(P||(P=new ln([],{})),0===P.segments.length&&P.hasChildren())return ii(P,k,D);const z=function Gi(P,k,D){let z=0,ee=k;const u={match:!1,pathIndex:0,commandIndex:0};for(;ee<P.segments.length;){if(z>=D.length)return u;const t=P.segments[ee],l=D[z];if(Yi(l))break;const p=`${l}`,_=z<D.length-1?D[z+1]:null;if(ee>0&&void 0===p)break;if(p&&_&&"object"==typeof _&&void 0===_.outlets){if(!bi(p,_,t))return u;z+=2}else{if(!bi(p,{},t))return u;z++}ee++}return{match:!0,pathIndex:ee,commandIndex:z}}(P,k,D),ee=D.slice(z.commandIndex);if(z.match&&z.pathIndex<P.segments.length){const u=new ln(P.segments.slice(0,z.pathIndex),{});return u.children[ve]=new ln(P.segments.slice(z.pathIndex),P.children),ii(u,0,ee)}return z.match&&0===ee.length?new ln(P.segments,{}):z.match&&!P.hasChildren()?rr(P,k,D):z.match?ii(P,0,ee):rr(P,k,D)}function ii(P,k,D){if(0===D.length)return new ln(P.segments,{});{const z=function js(P){return Yi(P[0])?P[0].outlets:{[ve]:P}}(D),ee={};if(!z[ve]&&P.children[ve]&&1===P.numberOfChildren&&0===P.children[ve].segments.length){const u=ii(P.children[ve],k,D);return new ln(P.segments,u.children)}return dn(z,(u,t)=>{"string"==typeof u&&(u=[u]),null!==u&&(ee[t]=Pr(P.children[t],k,u))}),dn(P.children,(u,t)=>{void 0===z[t]&&(ee[t]=u)}),new ln(P.segments,ee)}}function rr(P,k,D){const z=P.segments.slice(0,k);let ee=0;for(;ee<D.length;){const u=D[ee];if(Yi(u)){const p=Kn(u.outlets);return new ln(z,p)}if(0===ee&&hi(D[0])){z.push(new mi(P.segments[k].path,Ri(D[0]))),ee++;continue}const t=Yi(u)?u.outlets[ve]:`${u}`,l=ee<D.length-1?D[ee+1]:null;t&&l&&hi(l)?(z.push(new mi(t,Ri(l))),ee+=2):(z.push(new mi(t,{})),ee++)}return new ln(z,{})}function Kn(P){const k={};return dn(P,(D,z)=>{"string"==typeof D&&(D=[D]),null!==D&&(k[z]=rr(new ln([],{}),0,D))}),k}function Ri(P){const k={};return dn(P,(D,z)=>k[z]=`${D}`),k}function bi(P,k,D){return P==D.path&&Se(k,D.parameters)}const Fr="imperative";class Ji{constructor(k,D){this.id=k,this.url=D}}class Pi extends Ji{constructor(k,D,z="imperative",ee=null){super(k,D),this.type=0,this.navigationTrigger=z,this.restoredState=ee}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class wo extends Ji{constructor(k,D,z){super(k,D),this.urlAfterRedirects=z,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class $i extends Ji{constructor(k,D,z,ee){super(k,D),this.reason=z,this.code=ee,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Eo extends Ji{constructor(k,D,z,ee){super(k,D),this.reason=z,this.code=ee,this.type=16}}class Br extends Ji{constructor(k,D,z,ee){super(k,D),this.error=z,this.target=ee,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ur extends Ji{constructor(k,D,z,ee){super(k,D),this.urlAfterRedirects=z,this.state=ee,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xo extends Ji{constructor(k,D,z,ee){super(k,D),this.urlAfterRedirects=z,this.state=ee,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class to extends Ji{constructor(k,D,z,ee,u){super(k,D),this.urlAfterRedirects=z,this.state=ee,this.shouldActivate=u,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class ts extends Ji{constructor(k,D,z,ee){super(k,D),this.urlAfterRedirects=z,this.state=ee,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zo extends Ji{constructor(k,D,z,ee){super(k,D),this.urlAfterRedirects=z,this.state=ee,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Vo{constructor(k){this.route=k,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Hs{constructor(k){this.route=k,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class hs{constructor(k){this.snapshot=k,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Dr{constructor(k){this.snapshot=k,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Io{constructor(k){this.snapshot=k,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gs{constructor(k){this.snapshot=k,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class po{constructor(k,D,z){this.routerEvent=k,this.position=D,this.anchor=z,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let ys=(()=>{class P{createUrlTree(D,z,ee,u,t,l){return ji(D||z.root,ee,u,t,l)}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})(),ns=(()=>{class P{}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:function(k){return ys.\u0275fac(k)},providedIn:"root"}),P})();class Co{constructor(k){this._root=k}get root(){return this._root.value}parent(k){const D=this.pathFromRoot(k);return D.length>1?D[D.length-2]:null}children(k){const D=lo(k,this._root);return D?D.children.map(z=>z.value):[]}firstChild(k){const D=lo(k,this._root);return D&&D.children.length>0?D.children[0].value:null}siblings(k){const D=jr(k,this._root);return D.length<2?[]:D[D.length-2].children.map(ee=>ee.value).filter(ee=>ee!==k)}pathFromRoot(k){return jr(k,this._root).map(D=>D.value)}}function lo(P,k){if(P===k.value)return k;for(const D of k.children){const z=lo(P,D);if(z)return z}return null}function jr(P,k){if(P===k.value)return[k];for(const D of k.children){const z=jr(P,D);if(z.length)return z.unshift(k),z}return[]}class fo{constructor(k,D){this.value=k,this.children=D}toString(){return`TreeNode(${this.value})`}}function is(P){const k={};return P&&P.children.forEach(D=>k[D.value.outlet]=D),k}class no extends Co{constructor(k,D){super(k),this.snapshot=D,Ma(this,k)}toString(){return this.snapshot.toString()}}function io(P,k){const D=function Ss(P,k){const t=new Qs([],{},{},"",{},ve,k,null,P.root,-1,{});return new Ca("",new fo(t,[]))}(P,k),z=new a.X([new mi("",{})]),ee=new a.X({}),u=new a.X({}),t=new a.X({}),l=new a.X(""),p=new As(z,ee,t,l,u,ve,k,D.root);return p.snapshot=D.root,new no(new fo(p,[]),D)}class As{constructor(k,D,z,ee,u,t,l,p){this.url=k,this.params=D,this.queryParams=z,this.fragment=ee,this.data=u,this.outlet=t,this.component=l,this.title=this.data?.pipe((0,et.U)(_=>_[Lt]))??(0,j.of)(void 0),this._futureSnapshot=p}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,et.U)(k=>fn(k)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,et.U)(k=>fn(k)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Wo(P,k="emptyOnly"){const D=P.pathFromRoot;let z=0;if("always"!==k)for(z=D.length-1;z>=1;){const ee=D[z],u=D[z-1];if(ee.routeConfig&&""===ee.routeConfig.path)z--;else{if(u.component)break;z--}}return function pa(P){return P.reduce((k,D)=>({params:{...k.params,...D.params},data:{...k.data,...D.data},resolve:{...D.data,...k.resolve,...D.routeConfig?.data,...D._resolvedData}}),{params:{},data:{},resolve:{}})}(D.slice(z))}class Qs{get title(){return this.data?.[Lt]}constructor(k,D,z,ee,u,t,l,p,_,b,M){this.url=k,this.params=D,this.queryParams=z,this.fragment=ee,this.data=u,this.outlet=t,this.component=l,this.routeConfig=p,this._urlSegment=_,this._lastPathIndex=b,this._resolve=M}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=fn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=fn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(z=>z.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ca extends Co{constructor(k,D){super(D),this.url=k,Ma(this,D)}toString(){return Is(this._root)}}function Ma(P,k){k.value._routerState=P,k.children.forEach(D=>Ma(P,D))}function Is(P){const k=P.children.length>0?` { ${P.children.map(Is).join(", ")} } `:"";return`${P.value}${k}`}function Js(P){if(P.snapshot){const k=P.snapshot,D=P._futureSnapshot;P.snapshot=D,Se(k.queryParams,D.queryParams)||P.queryParams.next(D.queryParams),k.fragment!==D.fragment&&P.fragment.next(D.fragment),Se(k.params,D.params)||P.params.next(D.params),function Rt(P,k){if(P.length!==k.length)return!1;for(let D=0;D<P.length;++D)if(!Se(P[D],k[D]))return!1;return!0}(k.url,D.url)||P.url.next(D.url),Se(k.data,D.data)||P.data.next(D.data)}else P.snapshot=P._futureSnapshot,P.data.next(P._futureSnapshot.data)}function Ps(P,k){const D=Se(P.params,k.params)&&function Li(P,k){return Qi(P,k)&&P.every((D,z)=>Se(D.parameters,k[z].parameters))}(P.url,k.url);return D&&!(!P.parent!=!k.parent)&&(!P.parent||Ps(P.parent,k.parent))}function rs(P,k,D){if(D&&P.shouldReuseRoute(k.value,D.value.snapshot)){const z=D.value;z._futureSnapshot=k.value;const ee=function Va(P,k,D){return k.children.map(z=>{for(const ee of D.children)if(P.shouldReuseRoute(z.value,ee.value.snapshot))return rs(P,z,ee);return rs(P,z)})}(P,k,D);return new fo(z,ee)}{if(P.shouldAttach(k.value)){const u=P.retrieve(k.value);if(null!==u){const t=u.route;return t.value._futureSnapshot=k.value,t.children=k.children.map(l=>rs(P,l)),t}}const z=function yo(P){return new As(new a.X(P.url),new a.X(P.params),new a.X(P.queryParams),new a.X(P.fragment),new a.X(P.data),P.outlet,P.component,P)}(k.value),ee=k.children.map(u=>rs(P,u));return new fo(z,ee)}}const fa="ngNavigationCancelingError";function vs(P,k){const{redirectTo:D,navigationBehaviorOptions:z}=Qn(k)?{redirectTo:k,navigationBehaviorOptions:void 0}:k,ee=ma(!1,0,k);return ee.url=D,ee.navigationBehaviorOptions=z,ee}function ma(P,k,D){const z=new Error("NavigationCancelingError: "+(P||""));return z[fa]=!0,z.cancellationCode=k,D&&(z.url=D),z}function ja(P){return ea(P)&&Qn(P.url)}function ea(P){return P&&P[fa]}class ta{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ur,this.attachRef=null}}let Ur=(()=>{class P{constructor(){this.contexts=new Map}onChildOutletCreated(D,z){const ee=this.getOrCreateContext(D);ee.outlet=z,this.contexts.set(D,ee)}onChildOutletDestroyed(D){const z=this.getContext(D);z&&(z.outlet=null,z.attachRef=null)}onOutletDeactivated(){const D=this.contexts;return this.contexts=new Map,D}onOutletReAttached(D){this.contexts=D}getOrCreateContext(D){let z=this.getContext(D);return z||(z=new ta,this.contexts.set(D,z)),z}getContext(D){return this.contexts.get(D)||null}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const ps=!1;let fs=(()=>{class P{constructor(){this.activated=null,this._activatedRoute=null,this.name=ve,this.activateEvents=new w.vpe,this.deactivateEvents=new w.vpe,this.attachEvents=new w.vpe,this.detachEvents=new w.vpe,this.parentContexts=(0,w.f3M)(Ur),this.location=(0,w.f3M)(w.s_b),this.changeDetector=(0,w.f3M)(w.sBO),this.environmentInjector=(0,w.f3M)(w.lqb)}ngOnChanges(D){if(D.name){const{firstChange:z,previousValue:ee}=D.name;if(z)return;this.isTrackedInParentContexts(ee)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(ee)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(D){return this.parentContexts.getContext(D)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const D=this.parentContexts.getContext(this.name);D?.route&&(D.attachRef?this.attach(D.attachRef,D.route):this.activateWith(D.route,D.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new w.vHH(4012,ps);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new w.vHH(4012,ps);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new w.vHH(4012,ps);this.location.detach();const D=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(D.instance),D}attach(D,z){this.activated=D,this._activatedRoute=z,this.location.insert(D.hostView),this.attachEvents.emit(D.instance)}deactivate(){if(this.activated){const D=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(D)}}activateWith(D,z){if(this.isActivated)throw new w.vHH(4013,ps);this._activatedRoute=D;const ee=this.location,t=D.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,p=new na(D,l,ee.injector);if(z&&function ga(P){return!!P.resolveComponentFactory}(z)){const _=z.resolveComponentFactory(t);this.activated=ee.createComponent(_,ee.length,p)}else this.activated=ee.createComponent(t,{index:ee.length,injector:p,environmentInjector:z??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275dir=w.lG2({type:P,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[w.TTD]}),P})();class na{constructor(k,D,z){this.route=k,this.childContexts=D,this.parent=z}get(k,D){return k===As?this.route:k===Ur?this.childContexts:this.parent.get(k,D)}}let ia=(()=>{class P{}return P.\u0275fac=function(D){return new(D||P)},P.\u0275cmp=w.Xpm({type:P,selectors:[["ng-component"]],standalone:!0,features:[w.jDz],decls:1,vars:0,template:function(D,z){1&D&&w._UZ(0,"router-outlet")},dependencies:[fs],encapsulation:2}),P})();function ko(P,k){return P.providers&&!P._injector&&(P._injector=(0,w.MMx)(P.providers,k,`Route: ${P.path}`)),P._injector??k}function bt(P){const k=P.children&&P.children.map(bt),D=k?{...P,children:k}:{...P};return!D.component&&!D.loadComponent&&(k||D.loadChildren)&&D.outlet&&D.outlet!==ve&&(D.component=ia),D}function ce(P){return P.outlet||ve}function Ke(P,k){const D=P.filter(z=>ce(z)===k);return D.push(...P.filter(z=>ce(z)!==k)),D}function Nt(P){if(!P)return null;if(P.routeConfig?._injector)return P.routeConfig._injector;for(let k=P.parent;k;k=k.parent){const D=k.routeConfig;if(D?._loadedInjector)return D._loadedInjector;if(D?._injector)return D._injector}return null}class xi{constructor(k,D,z,ee){this.routeReuseStrategy=k,this.futureState=D,this.currState=z,this.forwardEvent=ee}activate(k){const D=this.futureState._root,z=this.currState?this.currState._root:null;this.deactivateChildRoutes(D,z,k),Js(this.futureState.root),this.activateChildRoutes(D,z,k)}deactivateChildRoutes(k,D,z){const ee=is(D);k.children.forEach(u=>{const t=u.value.outlet;this.deactivateRoutes(u,ee[t],z),delete ee[t]}),dn(ee,(u,t)=>{this.deactivateRouteAndItsChildren(u,z)})}deactivateRoutes(k,D,z){const ee=k.value,u=D?D.value:null;if(ee===u)if(ee.component){const t=z.getContext(ee.outlet);t&&this.deactivateChildRoutes(k,D,t.children)}else this.deactivateChildRoutes(k,D,z);else u&&this.deactivateRouteAndItsChildren(D,z)}deactivateRouteAndItsChildren(k,D){k.value.component&&this.routeReuseStrategy.shouldDetach(k.value.snapshot)?this.detachAndStoreRouteSubtree(k,D):this.deactivateRouteAndOutlet(k,D)}detachAndStoreRouteSubtree(k,D){const z=D.getContext(k.value.outlet),ee=z&&k.value.component?z.children:D,u=is(k);for(const t of Object.keys(u))this.deactivateRouteAndItsChildren(u[t],ee);if(z&&z.outlet){const t=z.outlet.detach(),l=z.children.onOutletDeactivated();this.routeReuseStrategy.store(k.value.snapshot,{componentRef:t,route:k,contexts:l})}}deactivateRouteAndOutlet(k,D){const z=D.getContext(k.value.outlet),ee=z&&k.value.component?z.children:D,u=is(k);for(const t of Object.keys(u))this.deactivateRouteAndItsChildren(u[t],ee);z&&(z.outlet&&(z.outlet.deactivate(),z.children.onOutletDeactivated()),z.attachRef=null,z.resolver=null,z.route=null)}activateChildRoutes(k,D,z){const ee=is(D);k.children.forEach(u=>{this.activateRoutes(u,ee[u.value.outlet],z),this.forwardEvent(new Gs(u.value.snapshot))}),k.children.length&&this.forwardEvent(new Dr(k.value.snapshot))}activateRoutes(k,D,z){const ee=k.value,u=D?D.value:null;if(Js(ee),ee===u)if(ee.component){const t=z.getOrCreateContext(ee.outlet);this.activateChildRoutes(k,D,t.children)}else this.activateChildRoutes(k,D,z);else if(ee.component){const t=z.getOrCreateContext(ee.outlet);if(this.routeReuseStrategy.shouldAttach(ee.snapshot)){const l=this.routeReuseStrategy.retrieve(ee.snapshot);this.routeReuseStrategy.store(ee.snapshot,null),t.children.onOutletReAttached(l.contexts),t.attachRef=l.componentRef,t.route=l.route.value,t.outlet&&t.outlet.attach(l.componentRef,l.route.value),Js(l.route.value),this.activateChildRoutes(k,null,t.children)}else{const l=Nt(ee.snapshot),p=l?.get(w._Vd)??null;t.attachRef=null,t.route=ee,t.resolver=p,t.injector=l,t.outlet&&t.outlet.activateWith(ee,t.injector),this.activateChildRoutes(k,null,t.children)}}else this.activateChildRoutes(k,null,z)}}class si{constructor(k){this.path=k,this.route=this.path[this.path.length-1]}}class pi{constructor(k,D){this.component=k,this.route=D}}function Vr(P,k,D){const z=P._root;return Rs(z,k?k._root:null,D,[z.value])}function Mo(P,k){const D=Symbol(),z=k.get(P,D);return z===D?"function"!=typeof P||(0,w.Z0I)(P)?k.get(P):P:z}function Rs(P,k,D,z,ee={canDeactivateChecks:[],canActivateChecks:[]}){const u=is(k);return P.children.forEach(t=>{(function _a(P,k,D,z,ee={canDeactivateChecks:[],canActivateChecks:[]}){const u=P.value,t=k?k.value:null,l=D?D.getContext(P.value.outlet):null;if(t&&u.routeConfig===t.routeConfig){const p=function Ai(P,k,D){if("function"==typeof D)return D(P,k);switch(D){case"pathParamsChange":return!Qi(P.url,k.url);case"pathParamsOrQueryParamsChange":return!Qi(P.url,k.url)||!Se(P.queryParams,k.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ps(P,k)||!Se(P.queryParams,k.queryParams);default:return!Ps(P,k)}}(t,u,u.routeConfig.runGuardsAndResolvers);p?ee.canActivateChecks.push(new si(z)):(u.data=t.data,u._resolvedData=t._resolvedData),Rs(P,k,u.component?l?l.children:null:D,z,ee),p&&l&&l.outlet&&l.outlet.isActivated&&ee.canDeactivateChecks.push(new pi(l.outlet.component,t))}else t&&Zs(k,l,ee),ee.canActivateChecks.push(new si(z)),Rs(P,null,u.component?l?l.children:null:D,z,ee)})(t,u[t.value.outlet],D,z.concat([t.value]),ee),delete u[t.value.outlet]}),dn(u,(t,l)=>Zs(t,D.getContext(l),ee)),ee}function Zs(P,k,D){const z=is(P),ee=P.value;dn(z,(u,t)=>{Zs(u,ee.component?k?k.children.getContext(t):null:k,D)}),D.canDeactivateChecks.push(new pi(ee.component&&k&&k.outlet&&k.outlet.isActivated?k.outlet.component:null,ee))}function J(P){return"function"==typeof P}function ws(P){return P instanceof Qe||"EmptyError"===P?.name}const nl=Symbol("INITIAL_VALUE");function ro(){return(0,ht.w)(P=>(0,it.a)(P.map(k=>k.pipe((0,Gt.q)(1),(0,an.O)(nl)))).pipe((0,et.U)(k=>{for(const D of k)if(!0!==D){if(D===nl)return nl;if(!1===D||D instanceof Dn)return D}return!0}),(0,ot.h)(k=>k!==nl),(0,Gt.q)(1)))}function ss(P){return(0,$e.z)((0,ct.b)(k=>{if(Qn(k))throw vs(0,k)}),(0,et.U)(k=>!0===k))}const Ta={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ls(P,k,D,z,ee){const u=_l(P,k,D);return u.matched?function ks(P,k,D,z){const ee=k.canMatch;if(!ee||0===ee.length)return(0,j.of)(!0);const u=ee.map(t=>{const l=Mo(t,P);return ue(function uo(P){return P&&J(P.canMatch)}(l)?l.canMatch(k,D):P.runInContext(()=>l(k,D)))});return(0,j.of)(u).pipe(ro(),ss())}(z=ko(k,z),k,D).pipe((0,et.U)(t=>!0===t?u:{...Ta})):(0,j.of)(u)}function _l(P,k,D){if(""===k.path)return"full"===k.pathMatch&&(P.hasChildren()||D.length>0)?{...Ta}:{matched:!0,consumedSegments:[],remainingSegments:D,parameters:{},positionalParamSegments:{}};const ee=(k.matcher||me)(D,P,k);if(!ee)return{...Ta};const u={};dn(ee.posParams,(l,p)=>{u[p]=l.path});const t=ee.consumed.length>0?{...u,...ee.consumed[ee.consumed.length-1].parameters}:u;return{matched:!0,consumedSegments:ee.consumed,remainingSegments:D.slice(ee.consumed.length),parameters:t,positionalParamSegments:ee.posParams??{}}}function Es(P,k,D,z){if(D.length>0&&function Bl(P,k,D){return D.some(z=>sl(P,k,z)&&ce(z)!==ve)}(P,D,z)){const u=new ln(k,function yl(P,k,D,z){const ee={};ee[ve]=z,z._sourceSegment=P,z._segmentIndexShift=k.length;for(const u of D)if(""===u.path&&ce(u)!==ve){const t=new ln([],{});t._sourceSegment=P,t._segmentIndexShift=k.length,ee[ce(u)]=t}return ee}(P,k,z,new ln(D,P.children)));return u._sourceSegment=P,u._segmentIndexShift=k.length,{segmentGroup:u,slicedSegments:[]}}if(0===D.length&&function ol(P,k,D){return D.some(z=>sl(P,k,z))}(P,D,z)){const u=new ln(P.segments,function Cc(P,k,D,z,ee){const u={};for(const t of z)if(sl(P,D,t)&&!ee[ce(t)]){const l=new ln([],{});l._sourceSegment=P,l._segmentIndexShift=k.length,u[ce(t)]=l}return{...ee,...u}}(P,k,D,z,P.children));return u._sourceSegment=P,u._segmentIndexShift=k.length,{segmentGroup:u,slicedSegments:D}}const ee=new ln(P.segments,P.children);return ee._sourceSegment=P,ee._segmentIndexShift=k.length,{segmentGroup:ee,slicedSegments:D}}function sl(P,k,D){return(!(P.hasChildren()||k.length>0)||"full"!==D.pathMatch)&&""===D.path}function ra(P,k,D,z){return!!(ce(P)===z||z!==ve&&sl(k,D,P))&&("**"===P.path||_l(k,P,D).matched)}function oc(P,k,D){return 0===k.length&&!P.children[D]}const al=!1;class Sa{constructor(k){this.segmentGroup=k||null}}class sc{constructor(k){this.urlTree=k}}function ll(P){return(0,at._)(new Sa(P))}function ac(P){return(0,at._)(new sc(P))}class Mc{constructor(k,D,z,ee,u){this.injector=k,this.configLoader=D,this.urlSerializer=z,this.urlTree=ee,this.config=u,this.allowRedirects=!0}apply(){const k=Es(this.urlTree.root,[],[],this.config).segmentGroup,D=new ln(k.segments,k.children);return this.expandSegmentGroup(this.injector,this.config,D,ve).pipe((0,et.U)(u=>this.createUrlTree(en(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,Pn.K)(u=>{if(u instanceof sc)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof Sa?this.noMatchError(u):u}))}match(k){return this.expandSegmentGroup(this.injector,this.config,k.root,ve).pipe((0,et.U)(ee=>this.createUrlTree(en(ee),k.queryParams,k.fragment))).pipe((0,Pn.K)(ee=>{throw ee instanceof Sa?this.noMatchError(ee):ee}))}noMatchError(k){return new w.vHH(4002,al)}createUrlTree(k,D,z){const ee=ut(k);return new Dn(ee,D,z)}expandSegmentGroup(k,D,z,ee){return 0===z.segments.length&&z.hasChildren()?this.expandChildren(k,D,z).pipe((0,et.U)(u=>new ln([],u))):this.expandSegment(k,z,D,z.segments,ee,!0)}expandChildren(k,D,z){const ee=[];for(const u of Object.keys(z.children))"primary"===u?ee.unshift(u):ee.push(u);return(0,y.D)(ee).pipe((0,Et.b)(u=>{const t=z.children[u],l=Ke(D,u);return this.expandSegmentGroup(k,l,t,u).pipe((0,et.U)(p=>({segment:p,outlet:u})))}),fi((u,t)=>(u[t.outlet]=t.segment,u),{}),Bt())}expandSegment(k,D,z,ee,u,t){return(0,y.D)(z).pipe((0,Et.b)(l=>this.expandSegmentAgainstRoute(k,D,z,l,ee,u,t).pipe((0,Pn.K)(_=>{if(_ instanceof Sa)return(0,j.of)(null);throw _}))),nt(l=>!!l),(0,Pn.K)((l,p)=>{if(ws(l))return oc(D,ee,u)?(0,j.of)(new ln([],{})):ll(D);throw l}))}expandSegmentAgainstRoute(k,D,z,ee,u,t,l){return ra(ee,D,u,t)?void 0===ee.redirectTo?this.matchSegmentAgainstRoute(k,D,ee,u,t):l&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(k,D,z,ee,u,t):ll(D):ll(D)}expandSegmentAgainstRouteUsingRedirect(k,D,z,ee,u,t){return"**"===ee.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(k,z,ee,t):this.expandRegularSegmentAgainstRouteUsingRedirect(k,D,z,ee,u,t)}expandWildCardWithParamsAgainstRouteUsingRedirect(k,D,z,ee){const u=this.applyRedirectCommands([],z.redirectTo,{});return z.redirectTo.startsWith("/")?ac(u):this.lineralizeSegments(z,u).pipe((0,Te.z)(t=>{const l=new ln(t,{});return this.expandSegment(k,l,D,t,ee,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(k,D,z,ee,u,t){const{matched:l,consumedSegments:p,remainingSegments:_,positionalParamSegments:b}=_l(D,ee,u);if(!l)return ll(D);const M=this.applyRedirectCommands(p,ee.redirectTo,b);return ee.redirectTo.startsWith("/")?ac(M):this.lineralizeSegments(ee,M).pipe((0,Te.z)(O=>this.expandSegment(k,D,z,O.concat(_),t,!1)))}matchSegmentAgainstRoute(k,D,z,ee,u){return"**"===z.path?(k=ko(z,k),z.loadChildren?(z._loadedRoutes?(0,j.of)({routes:z._loadedRoutes,injector:z._loadedInjector}):this.configLoader.loadChildren(k,z)).pipe((0,et.U)(l=>(z._loadedRoutes=l.routes,z._loadedInjector=l.injector,new ln(ee,{})))):(0,j.of)(new ln(ee,{}))):Ls(D,z,ee,k).pipe((0,ht.w)(({matched:t,consumedSegments:l,remainingSegments:p})=>t?this.getChildConfig(k=z._injector??k,z,ee).pipe((0,Te.z)(b=>{const M=b.injector??k,O=b.routes,{segmentGroup:F,slicedSegments:q}=Es(D,l,p,O),W=new ln(F.segments,F.children);if(0===q.length&&W.hasChildren())return this.expandChildren(M,O,W).pipe((0,et.U)(Be=>new ln(l,Be)));if(0===O.length&&0===q.length)return(0,j.of)(new ln(l,{}));const re=ce(z)===u;return this.expandSegment(M,W,O,q,re?ve:u,!0).pipe((0,et.U)(Ue=>new ln(l.concat(Ue.segments),Ue.children)))})):ll(D)))}getChildConfig(k,D,z){return D.children?(0,j.of)({routes:D.children,injector:k}):D.loadChildren?void 0!==D._loadedRoutes?(0,j.of)({routes:D._loadedRoutes,injector:D._loadedInjector}):function Nr(P,k,D,z){const ee=k.canLoad;if(void 0===ee||0===ee.length)return(0,j.of)(!0);const u=ee.map(t=>{const l=Mo(t,P);return ue(function G(P){return P&&J(P.canLoad)}(l)?l.canLoad(k,D):P.runInContext(()=>l(k,D)))});return(0,j.of)(u).pipe(ro(),ss())}(k,D,z).pipe((0,Te.z)(ee=>ee?this.configLoader.loadChildren(k,D).pipe((0,ct.b)(u=>{D._loadedRoutes=u.routes,D._loadedInjector=u.injector})):function vl(P){return(0,at._)(ma(al,3))}())):(0,j.of)({routes:[],injector:k})}lineralizeSegments(k,D){let z=[],ee=D.root;for(;;){if(z=z.concat(ee.segments),0===ee.numberOfChildren)return(0,j.of)(z);if(ee.numberOfChildren>1||!ee.children[ve])return k.redirectTo,(0,at._)(new w.vHH(4e3,al));ee=ee.children[ve]}}applyRedirectCommands(k,D,z){return this.applyRedirectCreateUrlTree(D,this.urlSerializer.parse(D),k,z)}applyRedirectCreateUrlTree(k,D,z,ee){const u=this.createSegmentGroup(k,D.root,z,ee);return new Dn(u,this.createQueryParams(D.queryParams,this.urlTree.queryParams),D.fragment)}createQueryParams(k,D){const z={};return dn(k,(ee,u)=>{if("string"==typeof ee&&ee.startsWith(":")){const l=ee.substring(1);z[u]=D[l]}else z[u]=ee}),z}createSegmentGroup(k,D,z,ee){const u=this.createSegments(k,D.segments,z,ee);let t={};return dn(D.children,(l,p)=>{t[p]=this.createSegmentGroup(k,l,z,ee)}),new ln(u,t)}createSegments(k,D,z,ee){return D.map(u=>u.path.startsWith(":")?this.findPosParam(k,u,ee):this.findOrReturn(u,z))}findPosParam(k,D,z){const ee=z[D.path.substring(1)];if(!ee)throw new w.vHH(4001,al);return ee}findOrReturn(k,D){let z=0;for(const ee of D){if(ee.path===k.path)return D.splice(z),ee;z++}return k}}class Sr{}class as{constructor(k,D,z,ee,u,t,l){this.injector=k,this.rootComponentType=D,this.config=z,this.urlTree=ee,this.url=u,this.paramsInheritanceStrategy=t,this.urlSerializer=l}recognize(){const k=Es(this.urlTree.root,[],[],this.config.filter(D=>void 0===D.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,k,ve).pipe((0,et.U)(D=>{if(null===D)return null;const z=new Qs([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ve,this.rootComponentType,null,this.urlTree.root,-1,{}),ee=new fo(z,D),u=new Ca(this.url,ee);return this.inheritParamsAndData(u._root),u}))}inheritParamsAndData(k){const D=k.value,z=Wo(D,this.paramsInheritanceStrategy);D.params=Object.freeze(z.params),D.data=Object.freeze(z.data),k.children.forEach(ee=>this.inheritParamsAndData(ee))}processSegmentGroup(k,D,z,ee){return 0===z.segments.length&&z.hasChildren()?this.processChildren(k,D,z):this.processSegment(k,D,z,z.segments,ee)}processChildren(k,D,z){return(0,y.D)(Object.keys(z.children)).pipe((0,Et.b)(ee=>{const u=z.children[ee],t=Ke(D,ee);return this.processSegmentGroup(k,t,u,ee)}),fi((ee,u)=>ee&&u?(ee.push(...u),ee):null),function Zt(P,k=!1){return(0,Ne.e)((D,z)=>{let ee=0;D.subscribe((0,mt.x)(z,u=>{const t=P(u,ee++);(t||k)&&z.next(u),!t&&z.complete()}))})}(ee=>null!==ee),It(null),Bt(),(0,et.U)(ee=>{if(null===ee)return null;const u=mr(ee);return function Ha(P){P.sort((k,D)=>k.value.outlet===ve?-1:D.value.outlet===ve?1:k.value.outlet.localeCompare(D.value.outlet))}(u),u}))}processSegment(k,D,z,ee,u){return(0,y.D)(D).pipe((0,Et.b)(t=>this.processSegmentAgainstRoute(t._injector??k,t,z,ee,u)),nt(t=>!!t),(0,Pn.K)(t=>{if(ws(t))return oc(z,ee,u)?(0,j.of)([]):(0,j.of)(null);throw t}))}processSegmentAgainstRoute(k,D,z,ee,u){if(D.redirectTo||!ra(D,z,ee,u))return(0,j.of)(null);let t;if("**"===D.path){const l=ee.length>0?li(ee).parameters:{},p=U(z)+ee.length,_=new Qs(ee,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z(D),ce(D),D.component??D._loadedComponent??null,D,cl(z),p,_e(D));t=(0,j.of)({snapshot:_,consumedSegments:[],remainingSegments:[]})}else t=Ls(z,D,ee,k).pipe((0,et.U)(({matched:l,consumedSegments:p,remainingSegments:_,parameters:b})=>{if(!l)return null;const M=U(z)+p.length;return{snapshot:new Qs(p,b,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z(D),ce(D),D.component??D._loadedComponent??null,D,cl(z),M,_e(D)),consumedSegments:p,remainingSegments:_}}));return t.pipe((0,ht.w)(l=>{if(null===l)return(0,j.of)(null);const{snapshot:p,consumedSegments:_,remainingSegments:b}=l;k=D._injector??k;const M=D._loadedInjector??k,O=function Ga(P){return P.children?P.children:P.loadChildren?P._loadedRoutes:[]}(D),{segmentGroup:F,slicedSegments:q}=Es(z,_,b,O.filter(re=>void 0===re.redirectTo));if(0===q.length&&F.hasChildren())return this.processChildren(M,O,F).pipe((0,et.U)(re=>null===re?null:[new fo(p,re)]));if(0===O.length&&0===q.length)return(0,j.of)([new fo(p,[])]);const W=ce(D)===u;return this.processSegment(M,O,F,q,W?ve:u).pipe((0,et.U)(re=>null===re?null:[new fo(p,re)]))}))}}function cc(P){const k=P.value.routeConfig;return k&&""===k.path&&void 0===k.redirectTo}function mr(P){const k=[],D=new Set;for(const z of P){if(!cc(z)){k.push(z);continue}const ee=k.find(u=>z.value.routeConfig===u.value.routeConfig);void 0!==ee?(ee.children.push(...z.children),D.add(ee)):k.push(z)}for(const z of D){const ee=mr(z.children);k.push(new fo(z.value,ee))}return k.filter(z=>!D.has(z))}function cl(P){let k=P;for(;k._sourceSegment;)k=k._sourceSegment;return k}function U(P){let k=P,D=k._segmentIndexShift??0;for(;k._sourceSegment;)k=k._sourceSegment,D+=k._segmentIndexShift??0;return D-1}function Z(P){return P.data||{}}function _e(P){return P.resolve||{}}function Er(P){return"string"==typeof P.title||null===P.title}function Xi(P){return(0,ht.w)(k=>{const D=P(k);return D?(0,y.D)(D).pipe((0,et.U)(()=>k)):(0,j.of)(k)})}const hr=new w.OlP("ROUTES");let Hn=(()=>{class P{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,w.f3M)(w.Sil)}loadComponent(D){if(this.componentLoaders.get(D))return this.componentLoaders.get(D);if(D._loadedComponent)return(0,j.of)(D._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(D);const z=ue(D.loadComponent()).pipe((0,et.U)(vo),(0,ct.b)(u=>{this.onLoadEndListener&&this.onLoadEndListener(D),D._loadedComponent=u}),(0,Ct.x)(()=>{this.componentLoaders.delete(D)})),ee=new tt.c(z,()=>new Re.x).pipe((0,Jt.x)());return this.componentLoaders.set(D,ee),ee}loadChildren(D,z){if(this.childrenLoaders.get(z))return this.childrenLoaders.get(z);if(z._loadedRoutes)return(0,j.of)({routes:z._loadedRoutes,injector:z._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(z);const u=this.loadModuleFactoryOrRoutes(z.loadChildren).pipe((0,et.U)(l=>{this.onLoadEndListener&&this.onLoadEndListener(z);let p,_,b=!1;Array.isArray(l)?_=l:(p=l.create(D).injector,_=jn(p.get(hr,[],w.XFs.Self|w.XFs.Optional)));return{routes:_.map(bt),injector:p}}),(0,Ct.x)(()=>{this.childrenLoaders.delete(z)})),t=new tt.c(u,()=>new Re.x).pipe((0,Jt.x)());return this.childrenLoaders.set(z,t),t}loadModuleFactoryOrRoutes(D){return ue(D()).pipe((0,et.U)(vo),(0,Te.z)(z=>z instanceof w.YKP||Array.isArray(z)?(0,j.of)(z):(0,y.D)(this.compiler.compileModuleAsync(z))))}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function vo(P){return function Kr(P){return P&&"object"==typeof P&&"default"in P}(P)?P.default:P}let Fo=(()=>{class P{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Re.x,this.configLoader=(0,w.f3M)(Hn),this.environmentInjector=(0,w.f3M)(w.lqb),this.urlSerializer=(0,w.f3M)(Ir),this.rootContexts=(0,w.f3M)(Ur),this.navigationId=0,this.afterPreactivation=()=>(0,j.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=ee=>this.events.next(new Hs(ee)),this.configLoader.onLoadStartListener=ee=>this.events.next(new Vo(ee))}complete(){this.transitions?.complete()}handleNavigationRequest(D){const z=++this.navigationId;this.transitions?.next({...this.transitions.value,...D,id:z})}setupNavigations(D){return this.transitions=new a.X({id:0,targetPageId:0,currentUrlTree:D.currentUrlTree,currentRawUrl:D.currentUrlTree,extractedUrl:D.urlHandlingStrategy.extract(D.currentUrlTree),urlAfterRedirects:D.urlHandlingStrategy.extract(D.currentUrlTree),rawUrl:D.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Fr,restoredState:null,currentSnapshot:D.routerState.snapshot,targetSnapshot:null,currentRouterState:D.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,ot.h)(z=>0!==z.id),(0,et.U)(z=>({...z,extractedUrl:D.urlHandlingStrategy.extract(z.rawUrl)})),(0,ht.w)(z=>{let ee=!1,u=!1;return(0,j.of)(z).pipe((0,ct.b)(t=>{this.currentNavigation={id:t.id,initialUrl:t.rawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ht.w)(t=>{const l=D.browserUrlTree.toString(),p=!D.navigated||t.extractedUrl.toString()!==l||l!==D.currentUrlTree.toString();if(!p&&"reload"!==(t.extras.onSameUrlNavigation??D.onSameUrlNavigation)){const b="";return this.events.next(new Eo(t.id,D.serializeUrl(z.rawUrl),b,0)),D.rawUrlTree=t.rawUrl,t.resolve(null),Ve.E}if(D.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Go(t.source)&&(D.browserUrlTree=t.extractedUrl),(0,j.of)(t).pipe((0,ht.w)(b=>{const M=this.transitions?.getValue();return this.events.next(new Pi(b.id,this.urlSerializer.serialize(b.extractedUrl),b.source,b.restoredState)),M!==this.transitions?.getValue()?Ve.E:Promise.resolve(b)}),function Lo(P,k,D,z){return(0,ht.w)(ee=>function Ws(P,k,D,z,ee){return new Mc(P,k,D,z,ee).apply()}(P,k,D,ee.extractedUrl,z).pipe((0,et.U)(u=>({...ee,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,D.config),(0,ct.b)(b=>{this.currentNavigation={...this.currentNavigation,finalUrl:b.urlAfterRedirects},z.urlAfterRedirects=b.urlAfterRedirects}),function pt(P,k,D,z,ee){return(0,Te.z)(u=>function lc(P,k,D,z,ee,u,t="emptyOnly"){return new as(P,k,D,z,ee,t,u).recognize().pipe((0,ht.w)(l=>null===l?function Aa(P){return new qe.y(k=>k.error(P))}(new Sr):(0,j.of)(l)))}(P,k,D,u.urlAfterRedirects,z.serialize(u.urlAfterRedirects),z,ee).pipe((0,et.U)(t=>({...u,targetSnapshot:t}))))}(this.environmentInjector,this.rootComponentType,D.config,this.urlSerializer,D.paramsInheritanceStrategy),(0,ct.b)(b=>{if(z.targetSnapshot=b.targetSnapshot,"eager"===D.urlUpdateStrategy){if(!b.extras.skipLocationChange){const O=D.urlHandlingStrategy.merge(b.urlAfterRedirects,b.rawUrl);D.setBrowserUrl(O,b)}D.browserUrlTree=b.urlAfterRedirects}const M=new ur(b.id,this.urlSerializer.serialize(b.extractedUrl),this.urlSerializer.serialize(b.urlAfterRedirects),b.targetSnapshot);this.events.next(M)}));if(p&&D.urlHandlingStrategy.shouldProcessUrl(D.rawUrlTree)){const{id:b,extractedUrl:M,source:O,restoredState:F,extras:q}=t,W=new Pi(b,this.urlSerializer.serialize(M),O,F);this.events.next(W);const re=io(M,this.rootComponentType).snapshot;return z={...t,targetSnapshot:re,urlAfterRedirects:M,extras:{...q,skipLocationChange:!1,replaceUrl:!1}},(0,j.of)(z)}{const b="";return this.events.next(new Eo(t.id,D.serializeUrl(z.extractedUrl),b,1)),D.rawUrlTree=t.rawUrl,t.resolve(null),Ve.E}}),(0,ct.b)(t=>{const l=new xo(t.id,this.urlSerializer.serialize(t.extractedUrl),this.urlSerializer.serialize(t.urlAfterRedirects),t.targetSnapshot);this.events.next(l)}),(0,et.U)(t=>z={...t,guards:Vr(t.targetSnapshot,t.currentSnapshot,this.rootContexts)}),function Fl(P,k){return(0,Te.z)(D=>{const{targetSnapshot:z,currentSnapshot:ee,guards:{canActivateChecks:u,canDeactivateChecks:t}}=D;return 0===t.length&&0===u.length?(0,j.of)({...D,guardsResult:!0}):function os(P,k,D,z){return(0,y.D)(P).pipe((0,Te.z)(ee=>function rc(P,k,D,z,ee){const u=k&&k.routeConfig?k.routeConfig.canDeactivate:null;if(!u||0===u.length)return(0,j.of)(!0);const t=u.map(l=>{const p=Nt(k)??ee,_=Mo(l,p);return ue(function Mi(P){return P&&J(P.canDeactivate)}(_)?_.canDeactivate(P,k,D,z):p.runInContext(()=>_(P,k,D,z))).pipe(nt())});return(0,j.of)(t).pipe(ro())}(ee.component,ee.route,D,k,z)),nt(ee=>!0!==ee,!0))}(t,z,ee,P).pipe((0,Te.z)(l=>l&&function Y(P){return"boolean"==typeof P}(l)?function qo(P,k,D,z){return(0,y.D)(k).pipe((0,Et.b)(ee=>(0,Ce.z)(function rl(P,k){return null!==P&&k&&k(new hs(P)),(0,j.of)(!0)}(ee.route.parent,z),function il(P,k){return null!==P&&k&&k(new Io(P)),(0,j.of)(!0)}(ee.route,z),function ic(P,k,D){const z=k[k.length-1],u=k.slice(0,k.length-1).reverse().map(t=>function Ho(P){const k=P.routeConfig?P.routeConfig.canActivateChild:null;return k&&0!==k.length?{node:P,guards:k}:null}(t)).filter(t=>null!==t).map(t=>(0,Fe.P)(()=>{const l=t.guards.map(p=>{const _=Nt(t.node)??D,b=Mo(p,_);return ue(function wn(P){return P&&J(P.canActivateChild)}(b)?b.canActivateChild(z,P):_.runInContext(()=>b(z,P))).pipe(nt())});return(0,j.of)(l).pipe(ro())}));return(0,j.of)(u).pipe(ro())}(P,ee.path,D),function Vc(P,k,D){const z=k.routeConfig?k.routeConfig.canActivate:null;if(!z||0===z.length)return(0,j.of)(!0);const ee=z.map(u=>(0,Fe.P)(()=>{const t=Nt(k)??D,l=Mo(u,t);return ue(function Ee(P){return P&&J(P.canActivate)}(l)?l.canActivate(k,P):t.runInContext(()=>l(k,P))).pipe(nt())}));return(0,j.of)(ee).pipe(ro())}(P,ee.route,D))),nt(ee=>!0!==ee,!0))}(z,u,P,k):(0,j.of)(l)),(0,et.U)(l=>({...D,guardsResult:l})))})}(this.environmentInjector,t=>this.events.next(t)),(0,ct.b)(t=>{if(z.guardsResult=t.guardsResult,Qn(t.guardsResult))throw vs(0,t.guardsResult);const l=new to(t.id,this.urlSerializer.serialize(t.extractedUrl),this.urlSerializer.serialize(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.events.next(l)}),(0,ot.h)(t=>!!t.guardsResult||(D.restoreHistory(t),this.cancelNavigationTransition(t,"",3),!1)),Xi(t=>{if(t.guards.canActivateChecks.length)return(0,j.of)(t).pipe((0,ct.b)(l=>{const p=new ts(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(p)}),(0,ht.w)(l=>{let p=!1;return(0,j.of)(l).pipe(function En(P,k){return(0,Te.z)(D=>{const{targetSnapshot:z,guards:{canActivateChecks:ee}}=D;if(!ee.length)return(0,j.of)(D);let u=0;return(0,y.D)(ee).pipe((0,Et.b)(t=>function kn(P,k,D,z){const ee=P.routeConfig,u=P._resolve;return void 0!==ee?.title&&!Er(ee)&&(u[Lt]=ee.title),function wi(P,k,D,z){const ee=function br(P){return[...Object.keys(P),...Object.getOwnPropertySymbols(P)]}(P);if(0===ee.length)return(0,j.of)({});const u={};return(0,y.D)(ee).pipe((0,Te.z)(t=>function xr(P,k,D,z){const ee=Nt(k)??z,u=Mo(P,ee);return ue(u.resolve?u.resolve(k,D):ee.runInContext(()=>u(k,D)))}(P[t],k,D,z).pipe(nt(),(0,ct.b)(l=>{u[t]=l}))),Ci(1),(0,nn.h)(u),(0,Pn.K)(t=>ws(t)?Ve.E:(0,at._)(t)))}(u,P,k,z).pipe((0,et.U)(t=>(P._resolvedData=t,P.data=Wo(P,D).resolve,ee&&Er(ee)&&(P.data[Lt]=ee.title),null)))}(t.route,z,P,k)),(0,ct.b)(()=>u++),Ci(1),(0,Te.z)(t=>u===ee.length?(0,j.of)(D):Ve.E))})}(D.paramsInheritanceStrategy,this.environmentInjector),(0,ct.b)({next:()=>p=!0,complete:()=>{p||(D.restoreHistory(l),this.cancelNavigationTransition(l,"",2))}}))}),(0,ct.b)(l=>{const p=new Zo(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(p)}))}),Xi(t=>{const l=p=>{const _=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&_.push(this.configLoader.loadComponent(p.routeConfig).pipe((0,ct.b)(b=>{p.component=b}),(0,et.U)(()=>{})));for(const b of p.children)_.push(...l(b));return _};return(0,it.a)(l(t.targetSnapshot.root)).pipe(It(),(0,Gt.q)(1))}),Xi(()=>this.afterPreactivation()),(0,et.U)(t=>{const l=function Os(P,k,D){const z=rs(P,k._root,D?D._root:void 0);return new no(z,k)}(D.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return z={...t,targetRouterState:l}}),(0,ct.b)(t=>{D.currentUrlTree=t.urlAfterRedirects,D.rawUrlTree=D.urlHandlingStrategy.merge(t.urlAfterRedirects,t.rawUrl),D.routerState=t.targetRouterState,"deferred"===D.urlUpdateStrategy&&(t.extras.skipLocationChange||D.setBrowserUrl(D.rawUrlTree,t),D.browserUrlTree=t.urlAfterRedirects)}),((P,k,D)=>(0,et.U)(z=>(new xi(k,z.targetRouterState,z.currentRouterState,D).activate(P),z)))(this.rootContexts,D.routeReuseStrategy,t=>this.events.next(t)),(0,Gt.q)(1),(0,ct.b)({next:t=>{ee=!0,this.lastSuccessfulNavigation=this.currentNavigation,D.navigated=!0,this.events.next(new wo(t.id,this.urlSerializer.serialize(t.extractedUrl),this.urlSerializer.serialize(D.currentUrlTree))),D.titleStrategy?.updateTitle(t.targetRouterState.snapshot),t.resolve(!0)},complete:()=>{ee=!0}}),(0,Ct.x)(()=>{ee||u||this.cancelNavigationTransition(z,"",1),this.currentNavigation?.id===z.id&&(this.currentNavigation=null)}),(0,Pn.K)(t=>{if(u=!0,ea(t)){ja(t)||(D.navigated=!0,D.restoreHistory(z,!0));const l=new $i(z.id,this.urlSerializer.serialize(z.extractedUrl),t.message,t.cancellationCode);if(this.events.next(l),ja(t)){const p=D.urlHandlingStrategy.merge(t.url,D.rawUrlTree),_={skipLocationChange:z.extras.skipLocationChange,replaceUrl:"eager"===D.urlUpdateStrategy||Go(z.source)};D.scheduleNavigation(p,Fr,null,_,{resolve:z.resolve,reject:z.reject,promise:z.promise})}else z.resolve(!1)}else{D.restoreHistory(z,!0);const l=new Br(z.id,this.urlSerializer.serialize(z.extractedUrl),t,z.targetSnapshot??void 0);this.events.next(l);try{z.resolve(D.errorHandler(t))}catch(p){z.reject(p)}}return Ve.E}))}))}cancelNavigationTransition(D,z,ee){const u=new $i(D.id,this.urlSerializer.serialize(D.extractedUrl),z,ee);this.events.next(u),D.resolve(!1)}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function Go(P){return P!==Fr}let oa=(()=>{class P{buildTitle(D){let z,ee=D.root;for(;void 0!==ee;)z=this.getResolvedTitleForRoute(ee)??z,ee=ee.children.find(u=>u.outlet===ve);return z}getResolvedTitleForRoute(D){return D.data[Lt]}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:function(){return(0,w.f3M)(Cs)},providedIn:"root"}),P})(),Cs=(()=>{class P extends oa{constructor(D){super(),this.title=D}updateTitle(D){const z=this.buildTitle(D);void 0!==z&&this.title.setTitle(z)}}return P.\u0275fac=function(D){return new(D||P)(w.LFG(zt.Dx))},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),$a=(()=>{class P{}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:function(){return(0,w.f3M)(Bs)},providedIn:"root"}),P})();class sa{shouldDetach(k){return!1}store(k,D){}shouldAttach(k){return!1}retrieve(k){return null}shouldReuseRoute(k,D){return k.routeConfig===D.routeConfig}}let Bs=(()=>{class P extends sa{}return P.\u0275fac=function(){let k;return function(z){return(k||(k=w.n5z(P)))(z||P)}}(),P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const ms=new w.OlP("",{providedIn:"root",factory:()=>({})});let ru=(()=>{class P{}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:function(){return(0,w.f3M)(ya)},providedIn:"root"}),P})(),ya=(()=>{class P{shouldProcessUrl(D){return!0}extract(D){return D}merge(D,z){return D}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function Pa(P){throw P}function Wa(P,k,D){return k.parse("/")}const zl={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},uc={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Do=(()=>{class P{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,w.f3M)(w.c2e),this.isNgZoneEnabled=!1,this.options=(0,w.f3M)(ms,{optional:!0})||{},this.errorHandler=this.options.errorHandler||Pa,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Wa,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,w.f3M)(ru),this.routeReuseStrategy=(0,w.f3M)($a),this.urlCreationStrategy=(0,w.f3M)(ns),this.titleStrategy=(0,w.f3M)(oa),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=jn((0,w.f3M)(hr,{optional:!0})??[]),this.navigationTransitions=(0,w.f3M)(Fo),this.urlSerializer=(0,w.f3M)(Ir),this.location=(0,w.f3M)(ft.Ye),this.isNgZoneEnabled=(0,w.f3M)(w.R0b)instanceof w.R0b&&w.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Dn,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=io(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(D=>{this.lastSuccessfulId=D.id,this.currentPageId=this.browserPageId??0},D=>{this.console.warn(`Unhandled Navigation Error: ${D}`)})}resetRootComponentType(D){this.routerState.root.component=D,this.navigationTransitions.rootComponentType=D}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const D=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Fr,D)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(D=>{const z="popstate"===D.type?"popstate":"hashchange";"popstate"===z&&setTimeout(()=>{this.navigateToSyncWithBrowser(D.url,z,D.state)},0)}))}navigateToSyncWithBrowser(D,z,ee){const u={replaceUrl:!0},t=ee?.navigationId?ee:null;if(ee){const p={...ee};delete p.navigationId,delete p.\u0275routerPageId,0!==Object.keys(p).length&&(u.state=p)}const l=this.parseUrl(D);this.scheduleNavigation(l,z,t,u)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(D){this.config=D.map(bt),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(D,z={}){const{relativeTo:ee,queryParams:u,fragment:t,queryParamsHandling:l,preserveFragment:p}=z,_=p?this.currentUrlTree.fragment:t;let b=null;switch(l){case"merge":b={...this.currentUrlTree.queryParams,...u};break;case"preserve":b=this.currentUrlTree.queryParams;break;default:b=u||null}return null!==b&&(b=this.removeEmptyProps(b)),this.urlCreationStrategy.createUrlTree(ee,this.routerState,this.currentUrlTree,D,b,_??null)}navigateByUrl(D,z={skipLocationChange:!1}){const ee=Qn(D)?D:this.parseUrl(D),u=this.urlHandlingStrategy.merge(ee,this.rawUrlTree);return this.scheduleNavigation(u,Fr,null,z)}navigate(D,z={skipLocationChange:!1}){return function xl(P){for(let k=0;k<P.length;k++){const D=P[k];if(null==D)throw new w.vHH(4008,false)}}(D),this.navigateByUrl(this.createUrlTree(D,z),z)}serializeUrl(D){return this.urlSerializer.serialize(D)}parseUrl(D){let z;try{z=this.urlSerializer.parse(D)}catch(ee){z=this.malformedUriErrorHandler(ee,this.urlSerializer,D)}return z}isActive(D,z){let ee;if(ee=!0===z?{...zl}:!1===z?{...uc}:z,Qn(D))return Vt(this.currentUrlTree,D,ee);const u=this.parseUrl(D);return Vt(this.currentUrlTree,u,ee)}removeEmptyProps(D){return Object.keys(D).reduce((z,ee)=>{const u=D[ee];return null!=u&&(z[ee]=u),z},{})}scheduleNavigation(D,z,ee,u,t){if(this.disposed)return Promise.resolve(!1);let l,p,_,b;return t?(l=t.resolve,p=t.reject,_=t.promise):_=new Promise((M,O)=>{l=M,p=O}),b="computed"===this.canceledNavigationResolution?ee&&ee.\u0275routerPageId?ee.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:b,source:z,restoredState:ee,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:D,extras:u,resolve:l,reject:p,promise:_,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_.catch(M=>Promise.reject(M))}setBrowserUrl(D,z){const ee=this.urlSerializer.serialize(D);if(this.location.isCurrentPathEqualTo(ee)||z.extras.replaceUrl){const t={...z.extras.state,...this.generateNgRouterState(z.id,this.browserPageId)};this.location.replaceState(ee,"",t)}else{const u={...z.extras.state,...this.generateNgRouterState(z.id,z.targetPageId)};this.location.go(ee,"",u)}}restoreHistory(D,z=!1){if("computed"===this.canceledNavigationResolution){const u=this.currentPageId-(this.browserPageId??this.currentPageId);0!==u?this.location.historyGo(u):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===u&&(this.resetState(D),this.browserUrlTree=D.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(z&&this.resetState(D),this.resetUrlToCurrentUrlTree())}resetState(D){this.routerState=D.currentRouterState,this.currentUrlTree=D.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,D.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(D,z){return"computed"===this.canceledNavigationResolution?{navigationId:D,\u0275routerPageId:z}:{navigationId:D}}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),wl=(()=>{class P{constructor(D,z,ee,u,t,l){this.router=D,this.route=z,this.tabIndexAttribute=ee,this.renderer=u,this.el=t,this.locationStrategy=l,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new Re.x;const p=t.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===p||"area"===p,this.isAnchorElement?this.subscription=D.events.subscribe(_=>{_ instanceof wo&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(D){this._preserveFragment=(0,w.D6c)(D)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(D){this._skipLocationChange=(0,w.D6c)(D)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(D){this._replaceUrl=(0,w.D6c)(D)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(D){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",D)}ngOnChanges(D){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(D){null!=D?(this.commands=Array.isArray(D)?D:[D],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(D,z,ee,u,t){return!!(null===this.urlTree||this.isAnchorElement&&(0!==D||z||ee||u||t||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const D=null===this.href?null:(0,w.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",D)}applyAttributeValue(D,z){const ee=this.renderer,u=this.el.nativeElement;null!==z?ee.setAttribute(u,D,z):ee.removeAttribute(u,D)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return P.\u0275fac=function(D){return new(D||P)(w.Y36(Do),w.Y36(As),w.$8M("tabindex"),w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(ft.S$))},P.\u0275dir=w.lG2({type:P,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(D,z){1&D&&w.NdJ("click",function(u){return z.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&D&&w.uIk("target",z.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[w.TTD]}),P})(),El=(()=>{class P{get isActive(){return this._isActive}constructor(D,z,ee,u,t){this.router=D,this.element=z,this.renderer=ee,this.cdr=u,this.link=t,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new w.vpe,this.routerEventsSubscription=D.events.subscribe(l=>{l instanceof wo&&this.update()})}ngAfterContentInit(){(0,j.of)(this.links.changes,(0,j.of)(null)).pipe((0,ze.J)()).subscribe(D=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const D=[...this.links.toArray(),this.link].filter(z=>!!z).map(z=>z.onChanges);this.linkInputChangesSubscription=(0,y.D)(D).pipe((0,ze.J)()).subscribe(z=>{this._isActive!==this.isLinkActive(this.router)(z)&&this.update()})}set routerLinkActive(D){const z=Array.isArray(D)?D:D.split(" ");this.classes=z.filter(ee=>!!ee)}ngOnChanges(D){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||Promise.resolve().then(()=>{const D=this.hasActiveLinks();this._isActive!==D&&(this._isActive=D,this.cdr.markForCheck(),this.classes.forEach(z=>{D?this.renderer.addClass(this.element.nativeElement,z):this.renderer.removeClass(this.element.nativeElement,z)}),D&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(D))})}isLinkActive(D){const z=function Ul(P){return!!P.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return ee=>!!ee.urlTree&&D.isActive(ee.urlTree,z)}hasActiveLinks(){const D=this.isLinkActive(this.router);return this.link&&D(this.link)||this.links.some(D)}}return P.\u0275fac=function(D){return new(D||P)(w.Y36(Do),w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(w.sBO),w.Y36(wl,8))},P.\u0275dir=w.lG2({type:P,selectors:[["","routerLinkActive",""]],contentQueries:function(D,z,ee){if(1&D&&w.Suo(ee,wl,5),2&D){let u;w.iGM(u=w.CRH())&&(z.links=u)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[w.TTD]}),P})();class dc{}let hc=(()=>{class P{preload(D,z){return z().pipe((0,Pn.K)(()=>(0,j.of)(null)))}}return P.\u0275fac=function(D){return new(D||P)},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),Oa=(()=>{class P{constructor(D,z,ee,u,t){this.router=D,this.injector=ee,this.preloadingStrategy=u,this.loader=t}setUpPreloading(){this.subscription=this.router.events.pipe((0,ot.h)(D=>D instanceof wo),(0,Et.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(D,z){const ee=[];for(const u of z){u.providers&&!u._injector&&(u._injector=(0,w.MMx)(u.providers,D,`Route: ${u.path}`));const t=u._injector??D,l=u._loadedInjector??t;(u.loadChildren&&!u._loadedRoutes&&void 0===u.canLoad||u.loadComponent&&!u._loadedComponent)&&ee.push(this.preloadConfig(t,u)),(u.children||u._loadedRoutes)&&ee.push(this.processRoutes(l,u.children??u._loadedRoutes))}return(0,y.D)(ee).pipe((0,ze.J)())}preloadConfig(D,z){return this.preloadingStrategy.preload(z,()=>{let ee;ee=z.loadChildren&&void 0===z.canLoad?this.loader.loadChildren(D,z):(0,j.of)(null);const u=ee.pipe((0,Te.z)(t=>null===t?(0,j.of)(void 0):(z._loadedRoutes=t.routes,z._loadedInjector=t.injector,this.processRoutes(t.injector??D,t.routes))));if(z.loadComponent&&!z._loadedComponent){const t=this.loader.loadComponent(z);return(0,y.D)([u,t]).pipe((0,ze.J)())}return u})}}return P.\u0275fac=function(D){return new(D||P)(w.LFG(Do),w.LFG(w.Sil),w.LFG(w.lqb),w.LFG(dc),w.LFG(Hn))},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const K=new w.OlP("");let S=(()=>{class P{constructor(D,z,ee,u,t={}){this.urlSerializer=D,this.transitions=z,this.viewportScroller=ee,this.zone=u,this.options=t,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},t.scrollPositionRestoration=t.scrollPositionRestoration||"disabled",t.anchorScrolling=t.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(D=>{D instanceof Pi?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=D.navigationTrigger,this.restoredId=D.restoredState?D.restoredState.navigationId:0):D instanceof wo&&(this.lastId=D.id,this.scheduleScrollEvent(D,this.urlSerializer.parse(D.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(D=>{D instanceof po&&(D.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(D.position):D.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(D.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(D,z){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new po(D,"popstate"===this.lastSource?this.store[this.restoredId]:null,z))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return P.\u0275fac=function(D){w.$Z()},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac}),P})();var T=(()=>((T=T||{})[T.COMPLETE=0]="COMPLETE",T[T.FAILED=1]="FAILED",T[T.REDIRECTING=2]="REDIRECTING",T))();const ie=!1;function Ot(P,k){return{\u0275kind:P,\u0275providers:k}}const hn=new w.OlP("",{providedIn:"root",factory:()=>!1});function ar(){const P=(0,w.f3M)(w.zs3);return k=>{const D=P.get(w.z2F);if(k!==D.components[0])return;const z=P.get(Do),ee=P.get(nr);1===P.get(Ti)&&z.initialNavigation(),P.get(or,null,w.XFs.Optional)?.setUpPreloading(),P.get(K,null,w.XFs.Optional)?.init(),z.resetRootComponentType(D.componentTypes[0]),ee.closed||(ee.next(),ee.complete(),ee.unsubscribe())}}const nr=new w.OlP(ie?"bootstrap done indicator":"",{factory:()=>new Re.x}),Ti=new w.OlP(ie?"initial navigation":"",{providedIn:"root",factory:()=>1});function Xr(){let P=[];return P=ie?[{provide:w.Xts,multi:!0,useFactory:()=>{const k=(0,w.f3M)(Do);return()=>k.events.subscribe(D=>{console.group?.(`Router Event: ${D.constructor.name}`),console.log(function Or(P){if(!("type"in P))return`Unknown Router Event: ${P.constructor.name}`;switch(P.type){case 14:return`ActivationEnd(path: '${P.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${P.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${P.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${P.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}', state: ${P.state}, shouldActivate: ${P.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}', state: ${P.state})`;case 2:return`NavigationCancel(id: ${P.id}, url: '${P.url}')`;case 16:return`NavigationSkipped(id: ${P.id}, url: '${P.url}')`;case 1:return`NavigationEnd(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${P.id}, url: '${P.url}', error: ${P.error})`;case 0:return`NavigationStart(id: ${P.id}, url: '${P.url}')`;case 6:return`ResolveEnd(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}', state: ${P.state})`;case 5:return`ResolveStart(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}', state: ${P.state})`;case 10:return`RouteConfigLoadEnd(path: ${P.route.path})`;case 9:return`RouteConfigLoadStart(path: ${P.route.path})`;case 4:return`RoutesRecognized(id: ${P.id}, url: '${P.url}', urlAfterRedirects: '${P.urlAfterRedirects}', state: ${P.state})`;case 15:return`Scroll(anchor: '${P.anchor}', position: '${P.position?`${P.position[0]}, ${P.position[1]}`:null}')`}}(D)),console.log(D),console.groupEnd?.()})}}]:[],Ot(1,P)}const or=new w.OlP(ie?"router preloader":"");function To(P){return Ot(0,[{provide:or,useExisting:Oa},{provide:dc,useExisting:P}])}const Po=!1,la=new w.OlP(Po?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),gs=[ft.Ye,{provide:Ir,useClass:Kt},Do,Ur,{provide:As,useFactory:function Je(P){return P.routerState.root},deps:[Do]},Hn,Po?{provide:hn,useValue:!0}:[]];function Ml(){return new w.PXZ("Router",Do)}let qa=(()=>{class P{constructor(D){}static forRoot(D,z){return{ngModule:P,providers:[gs,Po&&z?.enableTracing?Xr().\u0275providers:[],{provide:hr,multi:!0,useValue:D},{provide:la,useFactory:Si,deps:[[Do,new w.FiY,new w.tp0]]},{provide:ms,useValue:z||{}},z?.useHash?{provide:ft.S$,useClass:ft.Do}:{provide:ft.S$,useClass:ft.b0},{provide:K,useFactory:()=>{const P=(0,w.f3M)(ft.EM),k=(0,w.f3M)(w.R0b),D=(0,w.f3M)(ms),z=(0,w.f3M)(Fo),ee=(0,w.f3M)(Ir);return D.scrollOffset&&P.setOffset(D.scrollOffset),new S(ee,z,P,k,D)}},z?.preloadingStrategy?To(z.preloadingStrategy).\u0275providers:[],{provide:w.PXZ,multi:!0,useFactory:Ml},z?.initialNavigation?Di(z):[],[{provide:Ni,useFactory:ar},{provide:w.tb,multi:!0,useExisting:Ni}]]}}static forChild(D){return{ngModule:P,providers:[{provide:hr,multi:!0,useValue:D}]}}}return P.\u0275fac=function(D){return new(D||P)(w.LFG(la,8))},P.\u0275mod=w.oAB({type:P}),P.\u0275inj=w.cJS({imports:[ia]}),P})();function Si(P){if(Po&&P)throw new w.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Di(P){return["disabled"===P.initialNavigation?Ot(3,[{provide:w.ip1,multi:!0,useFactory:()=>{const k=(0,w.f3M)(Do);return()=>{k.setUpLocationChangeListener()}}},{provide:Ti,useValue:2}]).\u0275providers:[],"enabledBlocking"===P.initialNavigation?Ot(2,[{provide:Ti,useValue:0},{provide:w.ip1,multi:!0,deps:[w.zs3],useFactory:k=>{const D=k.get(ft.V_,Promise.resolve());return()=>D.then(()=>new Promise(z=>{const ee=k.get(Do),u=k.get(nr);(function V(P,k){P.events.pipe((0,ot.h)(D=>D instanceof wo||D instanceof $i||D instanceof Br||D instanceof Eo),(0,et.U)(D=>D instanceof wo||D instanceof Eo?T.COMPLETE:D instanceof $i&&(0===D.code||1===D.code)?T.REDIRECTING:T.FAILED),(0,ot.h)(D=>D!==T.REDIRECTING),(0,Gt.q)(1)).subscribe(()=>{k()})})(ee,()=>{z(!0)}),k.get(Fo).afterPreactivation=()=>(z(!0),u.closed?(0,j.of)(void 0):u),ee.initialNavigation()}))}}]).\u0275providers:[]]}const Ni=new w.OlP(Po?"Router Initializer":"")},2965:(Yn,kt,L)=>{"use strict";L.d(kt,{Tm:()=>$e,i3:()=>Ce});var w=L(4650),y=L(6895);const j=["video"],a=["canvas"];function de(Ve,tt){if(1&Ve){const Re=w.EpF();w.TgZ(0,"div",6),w.NdJ("click",function(){w.CHM(Re);const et=w.oxw();return w.KtG(et.rotateVideoInput(!0))}),w.qZA()}}class Qe{constructor(tt,Re,ft){this._mimeType=null,this._imageAsBase64=null,this._imageAsDataUrl=null,this._imageData=null,this._mimeType=Re,this._imageAsDataUrl=tt,this._imageData=ft}static getDataFromDataUrl(tt,Re){return tt.replace(`data:${Re};base64,`,"")}get imageAsBase64(){return this._imageAsBase64?this._imageAsBase64:this._imageAsBase64=Qe.getDataFromDataUrl(this._imageAsDataUrl,this._mimeType)}get imageAsDataUrl(){return this._imageAsDataUrl}get imageData(){return this._imageData}}class it{static getAvailableVideoInputs(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?new Promise((tt,Re)=>{navigator.mediaDevices.enumerateDevices().then(ft=>{tt(ft.filter(et=>"videoinput"===et.kind))}).catch(ft=>{Re(ft.message||ft)})}):Promise.reject("enumerateDevices() not supported.")}}let Ce=(()=>{class Ve{constructor(){this.width=640,this.height=480,this.videoOptions=Ve.DEFAULT_VIDEO_OPTIONS,this.allowCameraSwitch=!0,this.captureImageData=!1,this.imageType=Ve.DEFAULT_IMAGE_TYPE,this.imageQuality=Ve.DEFAULT_IMAGE_QUALITY,this.imageCapture=new w.vpe,this.initError=new w.vpe,this.imageClick=new w.vpe,this.cameraSwitched=new w.vpe,this.availableVideoInputs=[],this.videoInitialized=!1,this.activeVideoInputIndex=-1,this.mediaStream=null,this.activeVideoSettings=null}set trigger(Re){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.triggerSubscription=Re.subscribe(()=>{this.takeSnapshot()})}set switchCamera(Re){this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe(),this.switchCameraSubscription=Re.subscribe(ft=>{"string"==typeof ft?this.switchToVideoInput(ft):this.rotateVideoInput(!1!==ft)})}static getMediaConstraintsForDevice(Re,ft){const et=ft||this.DEFAULT_VIDEO_OPTIONS;return Re&&(et.deviceId={exact:Re}),et}static getDeviceIdFromMediaStreamTrack(Re){if(Re.getSettings&&Re.getSettings()&&Re.getSettings().deviceId)return Re.getSettings().deviceId;if(Re.getConstraints&&Re.getConstraints()&&Re.getConstraints().deviceId){const ft=Re.getConstraints().deviceId;return Ve.getValueFromConstrainDOMString(ft)}}static getFacingModeFromMediaStreamTrack(Re){if(Re){if(Re.getSettings&&Re.getSettings()&&Re.getSettings().facingMode)return Re.getSettings().facingMode;if(Re.getConstraints&&Re.getConstraints()&&Re.getConstraints().facingMode){const ft=Re.getConstraints().facingMode;return Ve.getValueFromConstrainDOMString(ft)}}}static isUserFacing(Re){const ft=Ve.getFacingModeFromMediaStreamTrack(Re);return!!ft&&"user"===ft.toLowerCase()}static getValueFromConstrainDOMString(Re){if(Re){if(Re instanceof String)return String(Re);if(Array.isArray(Re)&&Array(Re).length>0)return String(Re[0]);if("object"==typeof Re){if(Re.exact)return String(Re.exact);if(Re.ideal)return String(Re.ideal)}}return null}ngAfterViewInit(){this.detectAvailableDevices().then(()=>{this.switchToVideoInput(null)}).catch(Re=>{this.initError.next({message:Re}),this.switchToVideoInput(null)})}ngOnDestroy(){this.stopMediaTracks(),this.unsubscribeFromSubscriptions()}takeSnapshot(){const Re=this.nativeVideoElement,ft={width:this.width,height:this.height};Re.videoWidth&&(ft.width=Re.videoWidth,ft.height=Re.videoHeight);const et=this.canvas.nativeElement;et.width=ft.width,et.height=ft.height;const ht=et.getContext("2d");ht.drawImage(Re,0,0);const Gt=this.imageType?this.imageType:Ve.DEFAULT_IMAGE_TYPE,ot=et.toDataURL(Gt,this.imageQuality?this.imageQuality:Ve.DEFAULT_IMAGE_QUALITY);let Te=null;this.captureImageData&&(Te=ht.getImageData(0,0,et.width,et.height)),this.imageCapture.next(new Qe(ot,Gt,Te))}rotateVideoInput(Re){this.availableVideoInputs&&this.availableVideoInputs.length>1&&this.switchToVideoInput(this.availableVideoInputs[(this.activeVideoInputIndex+(Re?1:this.availableVideoInputs.length-1))%this.availableVideoInputs.length].deviceId)}switchToVideoInput(Re){this.videoInitialized=!1,this.stopMediaTracks(),this.initWebcam(Re,this.videoOptions)}videoResize(){}get videoWidth(){const Re=this.getVideoAspectRatio();return Math.min(this.width,this.height*Re)}get videoHeight(){const Re=this.getVideoAspectRatio();return Math.min(this.height,this.width/Re)}get videoStyleClasses(){let Re="";return this.isMirrorImage()&&(Re+="mirrored "),Re.trim()}get nativeVideoElement(){return this.video.nativeElement}getVideoAspectRatio(){const Re=this.nativeVideoElement;return Re.videoWidth&&Re.videoWidth>0&&Re.videoHeight&&Re.videoHeight>0?Re.videoWidth/Re.videoHeight:this.width/this.height}initWebcam(Re,ft){const et=this.nativeVideoElement;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const ht=Ve.getMediaConstraintsForDevice(Re,ft);navigator.mediaDevices.getUserMedia({video:ht}).then(Gt=>{this.mediaStream=Gt,et.srcObject=Gt,et.play(),this.activeVideoSettings=Gt.getVideoTracks()[0].getSettings();const an=Ve.getDeviceIdFromMediaStreamTrack(Gt.getVideoTracks()[0]);this.cameraSwitched.next(an),this.detectAvailableDevices().then(()=>{this.activeVideoInputIndex=an?this.availableVideoInputs.findIndex(ot=>ot.deviceId===an):-1,this.videoInitialized=!0}).catch(()=>{this.activeVideoInputIndex=-1,this.videoInitialized=!0})}).catch(Gt=>{this.initError.next({message:Gt.message,mediaStreamError:Gt})})}else this.initError.next({message:"Cannot read UserMedia from MediaDevices."})}getActiveVideoTrack(){return this.mediaStream?this.mediaStream.getVideoTracks()[0]:null}isMirrorImage(){if(!this.getActiveVideoTrack())return!1;{let Re="auto";switch(this.mirrorImage&&("string"==typeof this.mirrorImage?Re=String(this.mirrorImage).toLowerCase():this.mirrorImage.x&&(Re=this.mirrorImage.x.toLowerCase())),Re){case"always":return!0;case"never":return!1}}return Ve.isUserFacing(this.getActiveVideoTrack())}stopMediaTracks(){this.mediaStream&&this.mediaStream.getTracks&&(this.nativeVideoElement.pause(),this.mediaStream.getTracks().forEach(Re=>Re.stop()))}unsubscribeFromSubscriptions(){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe()}detectAvailableDevices(){return new Promise((Re,ft)=>{it.getAvailableVideoInputs().then(et=>{this.availableVideoInputs=et,Re(et)}).catch(et=>{this.availableVideoInputs=[],ft(et)})})}}return Ve.DEFAULT_VIDEO_OPTIONS={facingMode:"environment"},Ve.DEFAULT_IMAGE_TYPE="image/jpeg",Ve.DEFAULT_IMAGE_QUALITY=.92,Ve.\u0275fac=function(Re){return new(Re||Ve)},Ve.\u0275cmp=w.Xpm({type:Ve,selectors:[["webcam"]],viewQuery:function(Re,ft){if(1&Re&&(w.Gf(j,7),w.Gf(a,7)),2&Re){let et;w.iGM(et=w.CRH())&&(ft.video=et.first),w.iGM(et=w.CRH())&&(ft.canvas=et.first)}},inputs:{width:"width",height:"height",videoOptions:"videoOptions",allowCameraSwitch:"allowCameraSwitch",mirrorImage:"mirrorImage",captureImageData:"captureImageData",imageType:"imageType",imageQuality:"imageQuality",trigger:"trigger",switchCamera:"switchCamera"},outputs:{imageCapture:"imageCapture",initError:"initError",imageClick:"imageClick",cameraSwitched:"cameraSwitched"},decls:6,vars:7,consts:[[1,"webcam-wrapper",3,"click"],["autoplay","","muted","","playsinline","",3,"width","height","resize"],["video",""],["class","camera-switch",3,"click",4,"ngIf"],[3,"width","height"],["canvas",""],[1,"camera-switch",3,"click"]],template:function(Re,ft){1&Re&&(w.TgZ(0,"div",0),w.NdJ("click",function(){return ft.imageClick.next()}),w.TgZ(1,"video",1,2),w.NdJ("resize",function(){return ft.videoResize()}),w.qZA(),w.YNc(3,de,1,0,"div",3),w._UZ(4,"canvas",4,5),w.qZA()),2&Re&&(w.xp6(1),w.Tol(ft.videoStyleClasses),w.Q6J("width",ft.videoWidth)("height",ft.videoHeight),w.xp6(2),w.Q6J("ngIf",ft.allowCameraSwitch&&ft.availableVideoInputs.length>1&&ft.videoInitialized),w.xp6(1),w.Q6J("width",ft.width)("height",ft.height))},dependencies:[y.O5],styles:[".webcam-wrapper[_ngcontent-%COMP%]{display:inline-block;position:relative;line-height:0}.webcam-wrapper[_ngcontent-%COMP%]   video.mirrored[_ngcontent-%COMP%]{transform:scaleX(-1)}.webcam-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:none}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]{background-color:#0000001a;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAE9UlEQVR42u2aT2hdRRTGf+cRQqghSqihdBFDkRISK2KDfzDWxHaRQHEhaINKqa1gKQhd6EZLN+IidCH+Q0oWIkVRC21BQxXRitVaSbKoJSGtYGoK2tQ/tU1jY5v0c5F54Xl7b/KSO/PyEt+3e5f75p7zzZwzZ74zUEIJJfyfYaEGllQGVAGZlENdBy6Z2cSiYFTSKkkfS/pH/nBF0kFJdUW9AiRVASeAukD8DgNrzOySrwEzng18KaDzALXuG8W3AiStAvqBisBRNg40mtlPxbYCOgvgPO4bncWW+JpVeDQXRQhIygDfA00F5r0XuNfMrgclQFI98DDQCNQA5ZFXqoCWBVp8XwHRHeEqcN7loy/NbHBesyqpQ1KfFj/6nC+ZvFaApFrgPaCZpYVvgCfNbDiRAElNwGFg+RIt/X8H2s2s9wYCJDUAR4HqJX7++RN40MwGpgmQVAH0AQ2BPz4AHHPl8nBOAqtyFWQjsA6oL4Ada81sPDv7uwImod8kvSJp9RyS8O2SXnb/DYVd2Y9VSroQ4ANXJO2WVJmixqh0kzMWwL4LkiqRtDnA4D1zmfE8j9g9AezcnAHaPcfXdbfdnPZ2Yps6+DwAvO/Z1naTdApY7Xng48BDZnY1MpMVQBuw3iXc5Tnb0wBwBPjUzP6eoezuArZ6svM0geJLkvZEYnl3nkntoqROSbckSW2Suj3ZOIangc7GPJuUtNGdFIfmMeavktoSSKiW9LMPw30Q8JqkekmjCbOZRhuclLQjgYSNxUBAj6RyZ9ATgUJpUtJTCSR8vpAEXHAyWK5BXYFIGHOlepSAloUk4NEYgyoknQhEwhFJ0e8h6VSaQeerCb5uZgdi9utxYBNwOUD93hIVXswM4INCi6K9wAszFC2DwLOBDjHbYp59karIUnRdzYy/3ClqVklaUhfwTICj7K25OqA7a4wWagVsm4Me/xzwg2cCqqONFzO7DPxSCAJi436GUBgHHguQD2oTlJ55oSzP9ybccsttSJw1szdjFOSnI/8dTCGZHwcORp4Nx7y3B1iZ8/sm4MW8/Euxg5wIsS/HaAp3zeP4/G7obRDXI4jiTIA22H7Xdc7X+S3A5lC7QBQ357aq3VAjCeSkwUfAJrfvz+R8A9ADLAtZB+TinpjC5JMA+//jwPZZnF8G7J+L8z4IWB/zbG+gIujVWfLBW/NStVMmqaG4POJRsIjix7h8IGnLQuoBbQki5sVAJHyYm7YkNaRRtXwQ8G1cHpX0iKRrgUjYno17Sf0LrQhJUkdCeHWkVITGJI0k1QeS3ikGSUzOyJUJJNznYneuOCnpTldcxa2kP3xJYqOeSDjqZG8ShJLnE8TTuMS6Iyu1BW7djZqkfo9N0QOuYJmYQddfB7RG+gLTNzqAY9FrL+5/nwEbvDdJJe3zzOrhNP3AWRqmk55t3ZcBuj3b2gb0Sbrbo/NNzk7fFzu7s/E5EiC+rrmeQU0Kx2skvRFoOx2ZzlmSdgbsw49JetvtBpk8nM64d/cGbNtJ0s7cGyJlwHeEv+t3nqnLSgPAUOSGyG3AHUxdzqoJbEcvcL+ZTeTeEapzJKxgaeOcc/7Mf06D7kFrguS0VDAMtGadv+E47DT9tcChJej8ISfpD+abgTe45uOkFi8mnQ+JBVQ+d4VXuOptjavcyot8pq86mfwk8LWZnaOEEkoooYQSSojDv8AhQNeGfe0jAAAAAElFTkSuQmCC);background-repeat:no-repeat;border-radius:5px;position:absolute;right:13px;top:10px;height:48px;width:48px;background-size:80%;cursor:pointer;background-position:center;transition:background-color .2s ease}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]:hover{background-color:#0000002e}"]}),Ve})(),$e=(()=>{class Ve{}return Ve.\u0275fac=function(Re){return new(Re||Ve)},Ve.\u0275mod=w.oAB({type:Ve}),Ve.\u0275inj=w.cJS({imports:[[y.ez]]}),Ve})()},7582:(Yn,kt,L)=>{"use strict";function qe(Bt,Zt,nn,Ct){return new(nn||(nn=Promise))(function(ze,zt){function ve(fn){try{Tt(Ct.next(fn))}catch(me){zt(me)}}function Lt(fn){try{Tt(Ct.throw(fn))}catch(me){zt(me)}}function Tt(fn){fn.done?ze(fn.value):function Jt(ze){return ze instanceof nn?ze:new nn(function(zt){zt(ze)})}(fn.value).then(ve,Lt)}Tt((Ct=Ct.apply(Bt,Zt||[])).next())})}function ot(Bt){return this instanceof ot?(this.v=Bt,this):new ot(Bt)}function Te(Bt,Zt,nn){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Jt,Ct=nn.apply(Bt,Zt||[]),ze=[];return Jt={},zt("next"),zt("throw"),zt("return"),Jt[Symbol.asyncIterator]=function(){return this},Jt;function zt(Rt){Ct[Rt]&&(Jt[Rt]=function(Se){return new Promise(function(vt,jn){ze.push([Rt,Se,vt,jn])>1||ve(Rt,Se)})})}function ve(Rt,Se){try{!function Lt(Rt){Rt.value instanceof ot?Promise.resolve(Rt.value.v).then(Tt,fn):me(ze[0][2],Rt)}(Ct[Rt](Se))}catch(vt){me(ze[0][3],vt)}}function Tt(Rt){ve("next",Rt)}function fn(Rt){ve("throw",Rt)}function me(Rt,Se){Rt(Se),ze.shift(),ze.length&&ve(ze[0][0],ze[0][1])}}function mt(Bt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var nn,Zt=Bt[Symbol.asyncIterator];return Zt?Zt.call(Bt):(Bt=function ft(Bt){var Zt="function"==typeof Symbol&&Symbol.iterator,nn=Zt&&Bt[Zt],Ct=0;if(nn)return nn.call(Bt);if(Bt&&"number"==typeof Bt.length)return{next:function(){return Bt&&Ct>=Bt.length&&(Bt=void 0),{value:Bt&&Bt[Ct++],done:!Bt}}};throw new TypeError(Zt?"Object is not iterable.":"Symbol.iterator is not defined.")}(Bt),nn={},Ct("next"),Ct("throw"),Ct("return"),nn[Symbol.asyncIterator]=function(){return this},nn);function Ct(ze){nn[ze]=Bt[ze]&&function(zt){return new Promise(function(ve,Lt){!function Jt(ze,zt,ve,Lt){Promise.resolve(Lt).then(function(Tt){ze({value:Tt,done:ve})},zt)}(ve,Lt,(zt=Bt[ze](zt)).done,zt.value)})}}}L.d(kt,{FC:()=>Te,KL:()=>mt,mG:()=>qe,qq:()=>ot}),"function"==typeof SuppressedError&&SuppressedError}},Yn=>{Yn(Yn.s=816)}]);