(self.webpackChunksolf=self.webpackChunksolf||[]).push([[179],{1572:(ti,Vt,B)=>{"use strict";B.d(Vt,{i:()=>rt});var w=B(4004),_=B(262),pe=B(8505),a=B(9646),de=B(2340),ut=B(3200),it=B(4650),Le=B(529),ke=B(9197);let rt=(()=>{class ft{constructor(dt,wt,tt){this.http=dt,this.router=wt,this.ngZone=tt,this.baseUrl=de.N.base_url}get token(){return localStorage.getItem("token")||""}get role(){return this.usuario.role}get uid(){return this.usuario.uid||""}get headers(){return{headers:{"x-token":this.token}}}guardarLocalStorage(dt,wt,tt=""){localStorage.setItem("token",dt),localStorage.setItem("menu",JSON.stringify(wt)),""!==tt&&localStorage.setItem("aud",tt)}logout(){this.usuario.google?google.accounts.id.revoke(this.usuario.email,()=>{this.ngZone.run(()=>{localStorage.removeItem("menu"),localStorage.removeItem("token"),this.router.navigateByUrl("auth/login")})}):(localStorage.removeItem("token"),localStorage.removeItem("menu"))}validarToken(){return google.accounts.id.initialize({client_id:localStorage.getItem("aud")}),this.http.get(`${this.baseUrl}/login/renew`,{headers:{"x-token":this.token}}).pipe((0,w.U)(dt=>{const{apellidoM:wt,apellidoP:tt,email:Wt,google:kt,img:Qe="",nombre:Hn,role:Ln,status:Ye,uid:Ce}=dt.usuario;return this.usuario=new ut.b(Hn,tt,wt,Wt,"",Qe,kt,Ln,Ye,Ce),this.guardarLocalStorage(dt.token,dt.menu),!0}),(0,_.K)(dt=>(0,a.of)(!1)))}crearUsuario(dt){return this.http.post(`${this.baseUrl}/usuarios`,dt).pipe((0,pe.b)(wt=>{this.guardarLocalStorage(wt.token,wt.menu)}))}login(dt){return this.http.post(`${this.baseUrl}/login`,dt).pipe((0,pe.b)(wt=>{this.guardarLocalStorage(wt.token,wt.menu)}))}loginGoogle(dt){return this.http.post(`${this.baseUrl}/login/google`,{token:dt}).pipe((0,pe.b)(wt=>{console.log(wt),this.guardarLocalStorage(wt.token,wt.menu,wt.aud)}))}actualizarPerfil(dt){return dt={...dt,role:this.usuario.role||"USER_ROLE",status:this.usuario.status||!1},this.http.put(`${this.baseUrl}/usuarios/${this.uid}`,dt,this.headers)}cargarUsuarios(dt=0){return this.http.get(`${this.baseUrl}/usuarios?desde=${dt}`,this.headers).pipe((0,w.U)(tt=>{const Wt=tt.usuarios.map(kt=>new ut.b(kt.nombre,kt.apellidoP,kt.apellidoM,kt.email,"",kt.img,kt.google,kt.role,kt.status,kt.uid));return{total:tt.total,usuarios:Wt}}))}desactivarUsuario(dt){return this.http.put(`${this.baseUrl}/usuarios/desactivar/${dt.uid}`,{status:!1},this.headers)}activarUsuario(dt){return this.http.put(`${this.baseUrl}/usuarios/desactivar/${dt.uid}`,{status:!0},this.headers)}cambiarRolUsuario(dt){return this.http.put(`${this.baseUrl}/usuarios/${dt.uid}`,dt,this.headers)}}return ft.\u0275fac=function(dt){return new(dt||ft)(it.LFG(Le.eN),it.LFG(ke.F0),it.LFG(it.R0b))},ft.\u0275prov=it.Yz7({token:ft,factory:ft.\u0275fac,providedIn:"root"}),ft})()},2311:(ti,Vt,B)=>{"use strict";B.d(Vt,{O:()=>de});var w=B(4004),_=B(2340),pe=B(4650),a=B(529);let de=(()=>{class ut{constructor(Le){this.http=Le,this.baseUrl=_.N.base_url,this._categorias=["libre","primaria","intersecundaria","prepa","veterano","relampago","femenil"],this._juegos=["fut7","futsalad","fut11"]}get categorias(){return[...this._categorias]}get juegos(){return[...this._juegos]}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}getLigas(){return this.http.get(`${this.baseUrl}/ligas`,this.headers).pipe((0,w.U)(ke=>ke.ligas))}getLigasStatusTrue(){return this.http.get(`${this.baseUrl}/ligas/statusTrue`,this.headers).pipe((0,w.U)(ke=>ke.ligas))}getLigasStatusFalse(){return this.http.get(`${this.baseUrl}/ligas/statusFalse`,this.headers).pipe((0,w.U)(ke=>ke.ligas))}smallgetLigas(){return this.http.get(`${this.baseUrl}/ligas?limite=3`,this.headers).pipe((0,w.U)(ke=>ke.ligas))}getLigaPorId(Le){return this.http.get(`${this.baseUrl}/ligas/${Le}`,this.headers).pipe((0,w.U)(rt=>rt.liga))}getLigaPorBusqueda(Le,ke,rt){return this.http.get(""!==rt&&""!==ke?`${this.baseUrl}/ligas/nombre/${Le}?limite=6&tipocategoria=${ke}&tipojuego=${rt}`:""!==rt&&""===ke?`${this.baseUrl}/ligas/nombre/${Le}?limite=6&tipojuego=${rt}`:""===rt&&""!==ke?`${this.baseUrl}/ligas/nombre/${Le}?limite=6&tipocategoria=${ke}`:`${this.baseUrl}/ligas/nombre/${Le}?limite=6`)}agregarLiga(Le){return this.http.post(`${this.baseUrl}/ligas`,Le,this.headers)}actualizarLiga(Le){return this.http.put(`${this.baseUrl}/ligas/${Le._id}`,Le,this.headers)}desactivarLiga(Le){return this.http.put(`${this.baseUrl}/ligas/desactivar/${Le._id}`,{status:!1},this.headers)}activarLiga(Le){return this.http.put(`${this.baseUrl}/ligas/desactivar/${Le._id}`,{status:!0},this.headers)}getCategoriasJuegos(){return this.getLigas().pipe((0,w.U)(Le=>{let ke=Le.map(({...ft})=>ft.tipoCategoria),rt=Le.map(({...ft})=>ft.tipoJuego);return ke=[...new Set(ke)],rt=[...new Set(rt)],{cat:ke,jue:rt}}))}}return ut.\u0275fac=function(Le){return new(Le||ut)(pe.LFG(a.eN))},ut.\u0275prov=pe.Yz7({token:ut,factory:ut.\u0275fac,providedIn:"root"}),ut})()},9563:(ti,Vt,B)=>{"use strict";B.d(Vt,{q:()=>gs});var w=B(3267),_=B(4650),pe=B(3238);let rt=(()=>{class kn{}return kn.\u0275fac=function(Ie){return new(Ie||kn)},kn.\u0275mod=_.oAB({type:kn}),kn.\u0275inj=_.cJS({imports:[[pe.BQ],pe.BQ]}),kn})();var ft=B(4859),Et=B(7392),dt=B(4633);let ii=(()=>{class kn{}return kn.\u0275fac=function(Ie){return new(Ie||kn)},kn.\u0275mod=_.oAB({type:kn}),kn.\u0275inj=_.cJS({imports:[[pe.BQ],pe.BQ]}),kn})();var vi=B(782),wi=B(7717),Nn=B(7957),Bi=B(7676),Jn=B(4144),fn=B(8184),Tt=B(6895),Ge=B(8605),Fe=B(7340);const ni={provide:new _.OlP("mat-select-scroll-strategy"),deps:[fn.aV],useFactory:function Ht(kn){return()=>kn.scrollStrategies.reposition()}};let lt=(()=>{class kn{}return kn.\u0275fac=function(Ie){return new(Ie||kn)},kn.\u0275mod=_.oAB({type:kn}),kn.\u0275inj=_.cJS({providers:[ni],imports:[[Tt.ez,fn.U8,pe.Ng,pe.BQ],Ge.ZD,Bi.lN,pe.Ng,pe.BQ]}),kn})();var nn=B(6046),_i=B(4080),Qt=B(445),xt=B(7579),pt=B(9770),Yt=B(727),bn=B(9646),ri=B(9300),Ee=B(5698),ee=B(8675),oe=B(2687),Me=B(3353),Ve=B(9521);function ct(kn,hn){}class Lt{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0}}const Ft={dialogContainer:(0,Fe.X$)("dialogContainer",[(0,Fe.SB)("void, exit",(0,Fe.oB)({opacity:0,transform:"scale(0.7)"})),(0,Fe.SB)("enter",(0,Fe.oB)({transform:"none"})),(0,Fe.eR)("* => enter",(0,Fe.jt)("150ms cubic-bezier(0, 0, 0.2, 1)",(0,Fe.oB)({transform:"none",opacity:1}))),(0,Fe.eR)("* => void, * => exit",(0,Fe.jt)("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",(0,Fe.oB)({opacity:0})))])};let le=(()=>{class kn extends _i.en{constructor(Ie,Gt,Fn,hi,Ti,mi,Ki,vr){super(),this._elementRef=Ie,this._focusTrapFactory=Gt,this._changeDetectorRef=Fn,this._config=Ti,this._interactivityChecker=mi,this._ngZone=Ki,this._focusMonitor=vr,this._animationStateChanged=new _.vpe,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=to=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(to)),this._ariaLabelledBy=Ti.ariaLabelledBy||null,this._document=hi}_initializeWithAttachedContent(){this._setupFocusTrap(),this._capturePreviouslyFocusedElement()}attachComponentPortal(Ie){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(Ie)}attachTemplatePortal(Ie){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(Ie)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(Ie,Gt){this._interactivityChecker.isFocusable(Ie)||(Ie.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{Ie.addEventListener("blur",()=>Ie.removeAttribute("tabindex")),Ie.addEventListener("mousedown",()=>Ie.removeAttribute("tabindex"))})),Ie.focus(Gt)}_focusByCssSelector(Ie,Gt){let Fn=this._elementRef.nativeElement.querySelector(Ie);Fn&&this._forceFocus(Fn,Gt)}_trapFocus(){const Ie=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||Ie.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(Gt=>{Gt||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const Ie=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&Ie&&"function"==typeof Ie.focus){const Gt=(0,Me.ht)(),Fn=this._elementRef.nativeElement;(!Gt||Gt===this._document.body||Gt===Fn||Fn.contains(Gt))&&(this._focusMonitor?(this._focusMonitor.focusVia(Ie,this._closeInteractionType),this._closeInteractionType=null):Ie.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)}_capturePreviouslyFocusedElement(){this._document&&(this._elementFocusedBeforeDialogWasOpened=(0,Me.ht)())}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const Ie=this._elementRef.nativeElement,Gt=(0,Me.ht)();return Ie===Gt||Ie.contains(Gt)}}return kn.\u0275fac=function(Ie){return new(Ie||kn)(_.Y36(_.SBq),_.Y36(oe.qV),_.Y36(_.sBO),_.Y36(Tt.K0,8),_.Y36(Lt),_.Y36(oe.ic),_.Y36(_.R0b),_.Y36(oe.tE))},kn.\u0275dir=_.lG2({type:kn,viewQuery:function(Ie,Gt){if(1&Ie&&_.Gf(_i.Pl,7),2&Ie){let Fn;_.iGM(Fn=_.CRH())&&(Gt._portalOutlet=Fn.first)}},features:[_.qOj]}),kn})(),_e=(()=>{class kn extends le{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:Ie,totalTime:Gt}){"enter"===Ie?(this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:Gt})):"exit"===Ie&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:Gt}))}_onAnimationStart({toState:Ie,totalTime:Gt}){"enter"===Ie?this._animationStateChanged.next({state:"opening",totalTime:Gt}):("exit"===Ie||"void"===Ie)&&this._animationStateChanged.next({state:"closing",totalTime:Gt})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return kn.\u0275fac=function(){let hn;return function(Gt){return(hn||(hn=_.n5z(kn)))(Gt||kn)}}(),kn.\u0275cmp=_.Xpm({type:kn,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(Ie,Gt){1&Ie&&_.WFA("@dialogContainer.start",function(hi){return Gt._onAnimationStart(hi)})("@dialogContainer.done",function(hi){return Gt._onAnimationDone(hi)}),2&Ie&&(_.Ikx("id",Gt._id),_.uIk("role",Gt._config.role)("aria-labelledby",Gt._config.ariaLabel?null:Gt._ariaLabelledBy)("aria-label",Gt._config.ariaLabel)("aria-describedby",Gt._config.ariaDescribedBy||null),_.d8E("@dialogContainer",Gt._state))},features:[_.qOj],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(Ie,Gt){1&Ie&&_.YNc(0,ct,0,0,"ng-template",0)},dependencies:[_i.Pl],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Ft.dialogContainer]}}),kn})(),he=0;class Ue{constructor(hn,Ie,Gt="mat-dialog-"+he++){this._overlayRef=hn,this._containerInstance=Ie,this.id=Gt,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new xt.x,this._afterClosed=new xt.x,this._beforeClosed=new xt.x,this._state=0,Ie._id=Gt,Ie._animationStateChanged.pipe((0,ri.h)(Fn=>"opened"===Fn.state),(0,Ee.q)(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),Ie._animationStateChanged.pipe((0,ri.h)(Fn=>"closed"===Fn.state),(0,Ee.q)(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),hn.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),hn.keydownEvents().pipe((0,ri.h)(Fn=>Fn.keyCode===Ve.hY&&!this.disableClose&&!(0,Ve.Vb)(Fn))).subscribe(Fn=>{Fn.preventDefault(),Zt(this,"keyboard")}),hn.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():Zt(this,"mouse")})}close(hn){this._result=hn,this._containerInstance._animationStateChanged.pipe((0,ri.h)(Ie=>"closing"===Ie.state),(0,Ee.q)(1)).subscribe(Ie=>{this._beforeClosed.next(hn),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),Ie.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(hn){let Ie=this._getPositionStrategy();return hn&&(hn.left||hn.right)?hn.left?Ie.left(hn.left):Ie.right(hn.right):Ie.centerHorizontally(),hn&&(hn.top||hn.bottom)?hn.top?Ie.top(hn.top):Ie.bottom(hn.bottom):Ie.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(hn="",Ie=""){return this._overlayRef.updateSize({width:hn,height:Ie}),this._overlayRef.updatePosition(),this}addPanelClass(hn){return this._overlayRef.addPanelClass(hn),this}removePanelClass(hn){return this._overlayRef.removePanelClass(hn),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function Zt(kn,hn,Ie){return void 0!==kn._containerInstance&&(kn._containerInstance._closeInteractionType=hn),kn.close(Ie)}const Tn=new _.OlP("MatDialogData"),jn=new _.OlP("mat-dialog-default-options"),Xn=new _.OlP("mat-dialog-scroll-strategy"),Gn={provide:Xn,deps:[fn.aV],useFactory:function Ri(kn){return()=>kn.scrollStrategies.block()}};let er=(()=>{class kn{constructor(Ie,Gt,Fn,hi,Ti,mi,Ki,vr,to,Br){this._overlay=Ie,this._injector=Gt,this._defaultOptions=Fn,this._parentDialog=hi,this._overlayContainer=Ti,this._dialogRefConstructor=Ki,this._dialogContainerType=vr,this._dialogDataToken=to,this._animationMode=Br,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new xt.x,this._afterOpenedAtThisLevel=new xt.x,this._ariaHiddenElements=new Map,this._dialogAnimatingOpen=!1,this.afterAllClosed=(0,pt.P)(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe((0,ee.O)(void 0))),this._scrollStrategy=mi}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const Ie=this._parentDialog;return Ie?Ie._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(Ie,Gt){if(Gt=function fo(kn,hn){return{...hn,...kn}}(Gt,this._defaultOptions||new Lt),Gt.id&&this.getDialogById(Gt.id),this._dialogAnimatingOpen)return this._lastDialogRef;const Fn=this._createOverlay(Gt),hi=this._attachDialogContainer(Fn,Gt);if("NoopAnimations"!==this._animationMode){const mi=hi._animationStateChanged.subscribe(Ki=>{"opening"===Ki.state&&(this._dialogAnimatingOpen=!0),"opened"===Ki.state&&(this._dialogAnimatingOpen=!1,mi.unsubscribe())});this._animationStateSubscriptions||(this._animationStateSubscriptions=new Yt.w0),this._animationStateSubscriptions.add(mi)}const Ti=this._attachDialogContent(Ie,hi,Fn,Gt);return this._lastDialogRef=Ti,this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(Ti),Ti.afterClosed().subscribe(()=>this._removeOpenDialog(Ti)),this.afterOpened.next(Ti),hi._initializeWithAttachedContent(),Ti}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(Ie){return this.openDialogs.find(Gt=>Gt.id===Ie)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._animationStateSubscriptions&&this._animationStateSubscriptions.unsubscribe()}_createOverlay(Ie){const Gt=this._getOverlayConfig(Ie);return this._overlay.create(Gt)}_getOverlayConfig(Ie){const Gt=new fn.X_({positionStrategy:this._overlay.position().global(),scrollStrategy:Ie.scrollStrategy||this._scrollStrategy(),panelClass:Ie.panelClass,hasBackdrop:Ie.hasBackdrop,direction:Ie.direction,minWidth:Ie.minWidth,minHeight:Ie.minHeight,maxWidth:Ie.maxWidth,maxHeight:Ie.maxHeight,disposeOnNavigation:Ie.closeOnNavigation});return Ie.backdropClass&&(Gt.backdropClass=Ie.backdropClass),Gt}_attachDialogContainer(Ie,Gt){const hi=_.zs3.create({parent:Gt&&Gt.viewContainerRef&&Gt.viewContainerRef.injector||this._injector,providers:[{provide:Lt,useValue:Gt}]}),Ti=new _i.C5(this._dialogContainerType,Gt.viewContainerRef,hi,Gt.componentFactoryResolver);return Ie.attach(Ti).instance}_attachDialogContent(Ie,Gt,Fn,hi){const Ti=new this._dialogRefConstructor(Fn,Gt,hi.id);if(Ie instanceof _.Rgc)Gt.attachTemplatePortal(new _i.UE(Ie,null,{$implicit:hi.data,dialogRef:Ti}));else{const mi=this._createInjector(hi,Ti,Gt),Ki=Gt.attachComponentPortal(new _i.C5(Ie,hi.viewContainerRef,mi));Ti.componentInstance=Ki.instance}return Ti.updateSize(hi.width,hi.height).updatePosition(hi.position),Ti}_createInjector(Ie,Gt,Fn){const hi=Ie&&Ie.viewContainerRef&&Ie.viewContainerRef.injector,Ti=[{provide:this._dialogContainerType,useValue:Fn},{provide:this._dialogDataToken,useValue:Ie.data},{provide:this._dialogRefConstructor,useValue:Gt}];return Ie.direction&&(!hi||!hi.get(Qt.Is,null,_.XFs.Optional))&&Ti.push({provide:Qt.Is,useValue:{value:Ie.direction,change:(0,bn.of)()}}),_.zs3.create({parent:hi||this._injector,providers:Ti})}_removeOpenDialog(Ie){const Gt=this.openDialogs.indexOf(Ie);Gt>-1&&(this.openDialogs.splice(Gt,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((Fn,hi)=>{Fn?hi.setAttribute("aria-hidden",Fn):hi.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const Ie=this._overlayContainer.getContainerElement();if(Ie.parentElement){const Gt=Ie.parentElement.children;for(let Fn=Gt.length-1;Fn>-1;Fn--){let hi=Gt[Fn];hi!==Ie&&"SCRIPT"!==hi.nodeName&&"STYLE"!==hi.nodeName&&!hi.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(hi,hi.getAttribute("aria-hidden")),hi.setAttribute("aria-hidden","true"))}}}_closeDialogs(Ie){let Gt=Ie.length;for(;Gt--;)Ie[Gt].close()}}return kn.\u0275fac=function(Ie){_.$Z()},kn.\u0275dir=_.lG2({type:kn}),kn})(),qi=(()=>{class kn extends er{constructor(Ie,Gt,Fn,hi,Ti,mi,Ki,vr){super(Ie,Gt,hi,mi,Ki,Ti,Ue,_e,Tn,vr)}}return kn.\u0275fac=function(Ie){return new(Ie||kn)(_.LFG(fn.aV),_.LFG(_.zs3),_.LFG(Tt.Ye,8),_.LFG(jn,8),_.LFG(Xn),_.LFG(kn,12),_.LFG(fn.Xj),_.LFG(_.QbO,8))},kn.\u0275prov=_.Yz7({token:kn,factory:kn.\u0275fac}),kn})(),wa=(()=>{class kn{}return kn.\u0275fac=function(Ie){return new(Ie||kn)},kn.\u0275mod=_.oAB({type:kn}),kn.\u0275inj=_.cJS({providers:[qi,Gn],imports:[[fn.U8,_i.eL,pe.BQ],pe.BQ]}),kn})();var Yi=B(7084);let gs=(()=>{class kn{}return kn.\u0275fac=function(Ie){return new(Ie||kn)},kn.\u0275mod=_.oAB({type:kn}),kn.\u0275inj=_.cJS({imports:[w.SJ,rt,ft.ot,Et.Ps,dt.ie,ii,vi.N6,wi.Cq,Nn.Bb,Bi.lN,Jn.c,nn.ZX,lt,wa,Yi.To]}),kn})()},3200:(ti,Vt,B)=>{"use strict";B.d(Vt,{b:()=>pe});const _=B(2340).N.base_url;class pe{constructor(de,ut,it,Le,ke,rt,ft,Et,dt,wt){this.nombre=de,this.apellidoP=ut,this.apellidoM=it,this.email=Le,this.password=ke,this.img=rt,this.google=ft,this.role=Et,this.status=dt,this.uid=wt}get imagenUrl(){return this.img?this.img?.includes("https")?this.img:this.img?`${_}/upload/usuarios/${this.img}`:`${_}/upload/usuarios/no-img-usuario`:`${_}/upload/usuarios/no-img-usuario`}}},646:(ti,Vt,B)=>{"use strict";B.d(Vt,{$:()=>a});var w=B(2340),_=B(4650);const pe=w.N.base_url;let a=(()=>{class de{transform(it,Le){return it?it?.includes("https")?it:it?`${pe}/upload/${Le}/${it}`:`${pe}/upload/usuarios/no-image`:`${pe}/upload/usuarios/no-image`}}return de.\u0275fac=function(it){return new(it||de)},de.\u0275pipe=_.Yjl({name:"imagen",type:de,pure:!0}),de})()},5503:(ti,Vt,B)=>{"use strict";B.d(Vt,{D:()=>pe});var w=B(6895),_=B(4650);let pe=(()=>{class a{}return a.\u0275fac=function(ut){return new(ut||a)},a.\u0275mod=_.oAB({type:a}),a.\u0275inj=_.cJS({imports:[w.ez]}),a})()},2340:(ti,Vt,B)=>{"use strict";B.d(Vt,{N:()=>w});const w={production:!0,mapboxToken:"pk.eyJ1Ijoic2VpbmVudGVuIiwiYSI6ImNsZGRiam42eTAyMG8zcHA1d3Fnd3Fob3YifQ.n-Kz1QaIGkAkRZ4TP6rNYg",base_url:"https://solf.onrender.com/api"}},9895:(ti,Vt,B)=>{"use strict";var w=B(1481),_=B(4650),pe=B(529),a=B(7340);function ut(X){return new _.vHH(3e3,!1)}function Fe(){return typeof window<"u"&&typeof window.document<"u"}function ht(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Xe(X){switch(X.length){case 0:return new a.ZN;case 1:return X[0];default:return new a.ZE(X)}}function ce(X,M,S,$,ue=new Map,Re=new Map){const It=[],Ot=[];let sn=-1,zn=null;if($.forEach(di=>{const Mi=di.get("offset"),ur=Mi==sn,Xi=ur&&zn||new Map;di.forEach((Vi,In)=>{let ir=In,Mr=Vi;if("offset"!==In)switch(ir=M.normalizePropertyName(ir,It),Mr){case a.k1:Mr=ue.get(In);break;case a.l3:Mr=Re.get(In);break;default:Mr=M.normalizeStyleValue(In,ir,Mr,It)}Xi.set(ir,Mr)}),ur||Ot.push(Xi),zn=Xi,sn=Mi}),It.length)throw function He(X){return new _.vHH(3502,!1)}();return Ot}function ot(X,M,S,$){switch(M){case"start":X.onStart(()=>$(S&&Se(S,"start",X)));break;case"done":X.onDone(()=>$(S&&Se(S,"done",X)));break;case"destroy":X.onDestroy(()=>$(S&&Se(S,"destroy",X)))}}function Se(X,M,S){const Re=St(X.element,X.triggerName,X.fromState,X.toState,M||X.phaseName,S.totalTime??X.totalTime,!!S.disabled),It=X._data;return null!=It&&(Re._data=It),Re}function St(X,M,S,$,ue="",Re=0,It){return{element:X,triggerName:M,fromState:S,toState:$,phaseName:ue,totalTime:Re,disabled:!!It}}function tn(X,M,S){let $=X.get(M);return $||X.set(M,$=S),$}function li(X){const M=X.indexOf(":");return[X.substring(1,M),X.slice(M+1)]}let Wi=(X,M)=>!1,Mn=(X,M,S)=>[],ae=null;function $e(X){const M=X.parentNode||X.host;return M===ae?null:M}(ht()||typeof Element<"u")&&(Fe()?(ae=(()=>document.documentElement)(),Wi=(X,M)=>{for(;M;){if(M===X)return!0;M=$e(M)}return!1}):Wi=(X,M)=>X.contains(M),Mn=(X,M,S)=>{if(S)return Array.from(X.querySelectorAll(M));const $=X.querySelector(M);return $?[$]:[]});let jt=null,Bt=!1;const te=Wi,nt=Mn;let Rn=(()=>{class X{validateStyleProperty(S){return function Je(X){jt||(jt=function fe(){return typeof document<"u"?document.body:null}()||{},Bt=!!jt.style&&"WebkitAppearance"in jt.style);let M=!0;return jt.style&&!function on(X){return"ebkit"==X.substring(1,6)}(X)&&(M=X in jt.style,!M&&Bt&&(M="Webkit"+X.charAt(0).toUpperCase()+X.slice(1)in jt.style)),M}(S)}matchesElement(S,$){return!1}containsElement(S,$){return te(S,$)}getParentElement(S){return $e(S)}query(S,$,ue){return nt(S,$,ue)}computeStyle(S,$,ue){return ue||""}animate(S,$,ue,Re,It,Ot=[],sn){return new a.ZN(ue,Re)}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275prov=_.Yz7({token:X,factory:X.\u0275fac}),X})(),ni=(()=>{class X{}return X.NOOP=new Rn,X})();const Hi="ng-enter",un="ng-leave",Pt="ng-trigger",lt=".ng-trigger",nn="ng-animating",_i=".ng-animating";function Qt(X){if("number"==typeof X)return X;const M=X.match(/^(-?[\.\d]+)(m?s)/);return!M||M.length<2?0:xt(parseFloat(M[1]),M[2])}function xt(X,M){return"s"===M?1e3*X:X}function pt(X,M,S){return X.hasOwnProperty("duration")?X:function Yt(X,M,S){let ue,Re=0,It="";if("string"==typeof X){const Ot=X.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===Ot)return M.push(ut()),{duration:0,delay:0,easing:""};ue=xt(parseFloat(Ot[1]),Ot[2]);const sn=Ot[3];null!=sn&&(Re=xt(parseFloat(sn),Ot[4]));const zn=Ot[5];zn&&(It=zn)}else ue=X;if(!S){let Ot=!1,sn=M.length;ue<0&&(M.push(function it(){return new _.vHH(3100,!1)}()),Ot=!0),Re<0&&(M.push(function Le(){return new _.vHH(3101,!1)}()),Ot=!0),Ot&&M.splice(sn,0,ut())}return{duration:ue,delay:Re,easing:It}}(X,M,S)}function bn(X,M={}){return Object.keys(X).forEach(S=>{M[S]=X[S]}),M}function ri(X){const M=new Map;return Object.keys(X).forEach(S=>{M.set(S,X[S])}),M}function oe(X,M=new Map,S){if(S)for(let[$,ue]of S)M.set($,ue);for(let[$,ue]of X)M.set($,ue);return M}function Me(X,M,S){return S?M+":"+S+";":""}function Ve(X){let M="";for(let S=0;S<X.style.length;S++){const $=X.style.item(S);M+=Me(0,$,X.style.getPropertyValue($))}for(const S in X.style)X.style.hasOwnProperty(S)&&!S.startsWith("_")&&(M+=Me(0,jn(S),X.style[S]));X.setAttribute("style",M)}function ct(X,M,S){X.style&&(M.forEach(($,ue)=>{const Re=Tn(ue);S&&!S.has(ue)&&S.set(ue,X.style[Re]),X.style[Re]=$}),ht()&&Ve(X))}function Lt(X,M){X.style&&(M.forEach((S,$)=>{const ue=Tn($);X.style[ue]=""}),ht()&&Ve(X))}function Ft(X){return Array.isArray(X)?1==X.length?X[0]:(0,a.vP)(X):X}const le=new RegExp("{{\\s*(.+?)\\s*}}","g");function _e(X){let M=[];if("string"==typeof X){let S;for(;S=le.exec(X);)M.push(S[1]);le.lastIndex=0}return M}function he(X,M,S){const $=X.toString(),ue=$.replace(le,(Re,It)=>{let Ot=M[It];return null==Ot&&(S.push(function rt(X){return new _.vHH(3003,!1)}()),Ot=""),Ot.toString()});return ue==$?X:ue}function Ue(X){const M=[];let S=X.next();for(;!S.done;)M.push(S.value),S=X.next();return M}const Zt=/-+([a-z0-9])/g;function Tn(X){return X.replace(Zt,(...M)=>M[1].toUpperCase())}function jn(X){return X.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Ri(X,M,S){switch(M.type){case 7:return X.visitTrigger(M,S);case 0:return X.visitState(M,S);case 1:return X.visitTransition(M,S);case 2:return X.visitSequence(M,S);case 3:return X.visitGroup(M,S);case 4:return X.visitAnimate(M,S);case 5:return X.visitKeyframes(M,S);case 6:return X.visitStyle(M,S);case 8:return X.visitReference(M,S);case 9:return X.visitAnimateChild(M,S);case 10:return X.visitAnimateRef(M,S);case 11:return X.visitQuery(M,S);case 12:return X.visitStagger(M,S);default:throw function ft(X){return new _.vHH(3004,!1)}()}}function Gn(X,M){return window.getComputedStyle(X)[M]}function Ao(X,M){const S=[];return"string"==typeof X?X.split(/\s*,\s*/).forEach($=>function wa(X,M,S){if(":"==X[0]){const sn=function Yi(X,M){switch(X){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(S,$)=>parseFloat($)>parseFloat(S);case":decrement":return(S,$)=>parseFloat($)<parseFloat(S);default:return M.push(function Jt(X){return new _.vHH(3016,!1)}()),"* => *"}}(X,S);if("function"==typeof sn)return void M.push(sn);X=sn}const $=X.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==$||$.length<4)return S.push(function zt(X){return new _.vHH(3015,!1)}()),M;const ue=$[1],Re=$[2],It=$[3];M.push(hn(ue,It));"<"==Re[0]&&!("*"==ue&&"*"==It)&&M.push(hn(It,ue))}($,S,M)):S.push(X),S}const gs=new Set(["true","1"]),kn=new Set(["false","0"]);function hn(X,M){const S=gs.has(X)||kn.has(X),$=gs.has(M)||kn.has(M);return(ue,Re)=>{let It="*"==X||X==ue,Ot="*"==M||M==Re;return!It&&S&&"boolean"==typeof ue&&(It=ue?gs.has(X):kn.has(X)),!Ot&&$&&"boolean"==typeof Re&&(Ot=Re?gs.has(M):kn.has(M)),It&&Ot}}const Gt=new RegExp("s*:selfs*,?","g");function Fn(X,M,S,$){return new Ti(X).build(M,S,$)}class Ti{constructor(M){this._driver=M}build(M,S,$){const ue=new vr(S);return this._resetContextStyleTimingState(ue),Ri(this,Ft(M),ue)}_resetContextStyleTimingState(M){M.currentQuerySelector="",M.collectedStyles=new Map,M.collectedStyles.set("",new Map),M.currentTime=0}visitTrigger(M,S){let $=S.queryCount=0,ue=S.depCount=0;const Re=[],It=[];return"@"==M.name.charAt(0)&&S.errors.push(function dt(){return new _.vHH(3006,!1)}()),M.definitions.forEach(Ot=>{if(this._resetContextStyleTimingState(S),0==Ot.type){const sn=Ot,zn=sn.name;zn.toString().split(/\s*,\s*/).forEach(di=>{sn.name=di,Re.push(this.visitState(sn,S))}),sn.name=zn}else if(1==Ot.type){const sn=this.visitTransition(Ot,S);$+=sn.queryCount,ue+=sn.depCount,It.push(sn)}else S.errors.push(function wt(){return new _.vHH(3007,!1)}())}),{type:7,name:M.name,states:Re,transitions:It,queryCount:$,depCount:ue,options:null}}visitState(M,S){const $=this.visitStyle(M.styles,S),ue=M.options&&M.options.params||null;if($.containsDynamicStyles){const Re=new Set,It=ue||{};$.styles.forEach(Ot=>{Ot instanceof Map&&Ot.forEach(sn=>{_e(sn).forEach(zn=>{It.hasOwnProperty(zn)||Re.add(zn)})})}),Re.size&&(Ue(Re.values()),S.errors.push(function tt(X,M){return new _.vHH(3008,!1)}()))}return{type:0,name:M.name,style:$,options:ue?{params:ue}:null}}visitTransition(M,S){S.queryCount=0,S.depCount=0;const $=Ri(this,Ft(M.animation),S);return{type:1,matchers:Ao(M.expr,S.errors),animation:$,queryCount:S.queryCount,depCount:S.depCount,options:pr(M.options)}}visitSequence(M,S){return{type:2,steps:M.steps.map($=>Ri(this,$,S)),options:pr(M.options)}}visitGroup(M,S){const $=S.currentTime;let ue=0;const Re=M.steps.map(It=>{S.currentTime=$;const Ot=Ri(this,It,S);return ue=Math.max(ue,S.currentTime),Ot});return S.currentTime=ue,{type:3,steps:Re,options:pr(M.options)}}visitAnimate(M,S){const $=function Br(X,M){if(X.hasOwnProperty("duration"))return X;if("number"==typeof X)return Zr(pt(X,M).duration,0,"");const S=X;if(S.split(/\s+/).some(Re=>"{"==Re.charAt(0)&&"{"==Re.charAt(1))){const Re=Zr(0,0,"");return Re.dynamic=!0,Re.strValue=S,Re}const ue=pt(S,M);return Zr(ue.duration,ue.delay,ue.easing)}(M.timings,S.errors);S.currentAnimateTimings=$;let ue,Re=M.styles?M.styles:(0,a.oB)({});if(5==Re.type)ue=this.visitKeyframes(Re,S);else{let It=M.styles,Ot=!1;if(!It){Ot=!0;const zn={};$.easing&&(zn.easing=$.easing),It=(0,a.oB)(zn)}S.currentTime+=$.duration+$.delay;const sn=this.visitStyle(It,S);sn.isEmptyStep=Ot,ue=sn}return S.currentAnimateTimings=null,{type:4,timings:$,style:ue,options:null}}visitStyle(M,S){const $=this._makeStyleAst(M,S);return this._validateStyleAst($,S),$}_makeStyleAst(M,S){const $=[],ue=Array.isArray(M.styles)?M.styles:[M.styles];for(let Ot of ue)"string"==typeof Ot?Ot===a.l3?$.push(Ot):S.errors.push(new _.vHH(3002,!1)):$.push(ri(Ot));let Re=!1,It=null;return $.forEach(Ot=>{if(Ot instanceof Map&&(Ot.has("easing")&&(It=Ot.get("easing"),Ot.delete("easing")),!Re))for(let sn of Ot.values())if(sn.toString().indexOf("{{")>=0){Re=!0;break}}),{type:6,styles:$,easing:It,offset:M.offset,containsDynamicStyles:Re,options:null}}_validateStyleAst(M,S){const $=S.currentAnimateTimings;let ue=S.currentTime,Re=S.currentTime;$&&Re>0&&(Re-=$.duration+$.delay),M.styles.forEach(It=>{"string"!=typeof It&&It.forEach((Ot,sn)=>{const zn=S.collectedStyles.get(S.currentQuerySelector),di=zn.get(sn);let Mi=!0;di&&(Re!=ue&&Re>=di.startTime&&ue<=di.endTime&&(S.errors.push(function Qe(X,M,S,$,ue){return new _.vHH(3010,!1)}()),Mi=!1),Re=di.startTime),Mi&&zn.set(sn,{startTime:Re,endTime:ue}),S.options&&function Mt(X,M,S){const $=M.params||{},ue=_e(X);ue.length&&ue.forEach(Re=>{$.hasOwnProperty(Re)||S.push(function ke(X){return new _.vHH(3001,!1)}())})}(Ot,S.options,S.errors)})})}visitKeyframes(M,S){const $={type:5,styles:[],options:null};if(!S.currentAnimateTimings)return S.errors.push(function Hn(){return new _.vHH(3011,!1)}()),$;let Re=0;const It=[];let Ot=!1,sn=!1,zn=0;const di=M.steps.map(Mr=>{const vo=this._makeStyleAst(Mr,S);let ko=null!=vo.offset?vo.offset:function to(X){if("string"==typeof X)return null;let M=null;if(Array.isArray(X))X.forEach(S=>{if(S instanceof Map&&S.has("offset")){const $=S;M=parseFloat($.get("offset")),$.delete("offset")}});else if(X instanceof Map&&X.has("offset")){const S=X;M=parseFloat(S.get("offset")),S.delete("offset")}return M}(vo.styles),ro=0;return null!=ko&&(Re++,ro=vo.offset=ko),sn=sn||ro<0||ro>1,Ot=Ot||ro<zn,zn=ro,It.push(ro),vo});sn&&S.errors.push(function Ln(){return new _.vHH(3012,!1)}()),Ot&&S.errors.push(function Ye(){return new _.vHH(3200,!1)}());const Mi=M.steps.length;let ur=0;Re>0&&Re<Mi?S.errors.push(function Ce(){return new _.vHH(3202,!1)}()):0==Re&&(ur=1/(Mi-1));const Xi=Mi-1,Vi=S.currentTime,In=S.currentAnimateTimings,ir=In.duration;return di.forEach((Mr,vo)=>{const ko=ur>0?vo==Xi?1:ur*vo:It[vo],ro=ko*ir;S.currentTime=Vi+In.delay+ro,In.duration=ro,this._validateStyleAst(Mr,S),Mr.offset=ko,$.styles.push(Mr)}),$}visitReference(M,S){return{type:8,animation:Ri(this,Ft(M.animation),S),options:pr(M.options)}}visitAnimateChild(M,S){return S.depCount++,{type:9,options:pr(M.options)}}visitAnimateRef(M,S){return{type:10,animation:this.visitReference(M.animation,S),options:pr(M.options)}}visitQuery(M,S){const $=S.currentQuerySelector,ue=M.options||{};S.queryCount++,S.currentQuery=M;const[Re,It]=function mi(X){const M=!!X.split(/\s*,\s*/).find(S=>":self"==S);return M&&(X=X.replace(Gt,"")),X=X.replace(/@\*/g,lt).replace(/@\w+/g,S=>lt+"-"+S.slice(1)).replace(/:animating/g,_i),[X,M]}(M.selector);S.currentQuerySelector=$.length?$+" "+Re:Re,tn(S.collectedStyles,S.currentQuerySelector,new Map);const Ot=Ri(this,Ft(M.animation),S);return S.currentQuery=null,S.currentQuerySelector=$,{type:11,selector:Re,limit:ue.limit||0,optional:!!ue.optional,includeSelf:It,animation:Ot,originalSelector:M.selector,options:pr(M.options)}}visitStagger(M,S){S.currentQuery||S.errors.push(function we(){return new _.vHH(3013,!1)}());const $="full"===M.timings?{duration:0,delay:0,easing:"full"}:pt(M.timings,S.errors,!0);return{type:12,animation:Ri(this,Ft(M.animation),S),timings:$,options:null}}}class vr{constructor(M){this.errors=M,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function pr(X){return X?(X=bn(X)).params&&(X.params=function Ki(X){return X?bn(X):null}(X.params)):X={},X}function Zr(X,M,S){return{duration:X,delay:M,easing:S}}function Ds(X,M,S,$,ue,Re,It=null,Ot=!1){return{type:1,element:X,keyframes:M,preStyleProps:S,postStyleProps:$,duration:ue,delay:Re,totalTime:ue+Re,easing:It,subTimeline:Ot}}class Ts{constructor(){this._map=new Map}get(M){return this._map.get(M)||[]}append(M,S){let $=this._map.get(M);$||this._map.set(M,$=[]),$.push(...S)}has(M){return this._map.has(M)}clear(){this._map.clear()}}const Fl=new RegExp(":enter","g"),Ha=new RegExp(":leave","g");function Ga(X,M,S,$,ue,Re=new Map,It=new Map,Ot,sn,zn=[]){return(new nl).buildKeyframes(X,M,S,$,ue,Re,It,Ot,sn,zn)}class nl{buildKeyframes(M,S,$,ue,Re,It,Ot,sn,zn,di=[]){zn=zn||new Ts;const Mi=new kr(M,S,zn,ue,Re,di,[]);Mi.options=sn;const ur=sn.delay?Qt(sn.delay):0;Mi.currentTimeline.delayNextStep(ur),Mi.currentTimeline.setStyles([It],null,Mi.errors,sn),Ri(this,$,Mi);const Xi=Mi.timelines.filter(Vi=>Vi.containsAnimation());if(Xi.length&&Ot.size){let Vi;for(let In=Xi.length-1;In>=0;In--){const ir=Xi[In];if(ir.element===S){Vi=ir;break}}Vi&&!Vi.allowOnlyTimelineStyles()&&Vi.setStyles([Ot],null,Mi.errors,sn)}return Xi.length?Xi.map(Vi=>Vi.buildKeyframes()):[Ds(S,[],[],[],0,ur,"",!1)]}visitTrigger(M,S){}visitState(M,S){}visitTransition(M,S){}visitAnimateChild(M,S){const $=S.subInstructions.get(S.element);if($){const ue=S.createSubContext(M.options),Re=S.currentTimeline.currentTime,It=this._visitSubInstructions($,ue,ue.options);Re!=It&&S.transformIntoNewTimeline(It)}S.previousNode=M}visitAnimateRef(M,S){const $=S.createSubContext(M.options);$.transformIntoNewTimeline(),this._applyAnimationRefDelays([M.options,M.animation.options],S,$),this.visitReference(M.animation,$),S.transformIntoNewTimeline($.currentTimeline.currentTime),S.previousNode=M}_applyAnimationRefDelays(M,S,$){for(const ue of M){const Re=ue?.delay;if(Re){const It="number"==typeof Re?Re:Qt(he(Re,ue?.params??{},S.errors));$.delayNextStep(It)}}}_visitSubInstructions(M,S,$){let Re=S.currentTimeline.currentTime;const It=null!=$.duration?Qt($.duration):null,Ot=null!=$.delay?Qt($.delay):null;return 0!==It&&M.forEach(sn=>{const zn=S.appendInstructionToTimeline(sn,It,Ot);Re=Math.max(Re,zn.duration+zn.delay)}),Re}visitReference(M,S){S.updateOptions(M.options,!0),Ri(this,M.animation,S),S.previousNode=M}visitSequence(M,S){const $=S.subContextCount;let ue=S;const Re=M.options;if(Re&&(Re.params||Re.delay)&&(ue=S.createSubContext(Re),ue.transformIntoNewTimeline(),null!=Re.delay)){6==ue.previousNode.type&&(ue.currentTimeline.snapshotCurrentStyles(),ue.previousNode=Io);const It=Qt(Re.delay);ue.delayNextStep(It)}M.steps.length&&(M.steps.forEach(It=>Ri(this,It,ue)),ue.currentTimeline.applyStylesToKeyframe(),ue.subContextCount>$&&ue.transformIntoNewTimeline()),S.previousNode=M}visitGroup(M,S){const $=[];let ue=S.currentTimeline.currentTime;const Re=M.options&&M.options.delay?Qt(M.options.delay):0;M.steps.forEach(It=>{const Ot=S.createSubContext(M.options);Re&&Ot.delayNextStep(Re),Ri(this,It,Ot),ue=Math.max(ue,Ot.currentTimeline.currentTime),$.push(Ot.currentTimeline)}),$.forEach(It=>S.currentTimeline.mergeTimelineCollectedStyles(It)),S.transformIntoNewTimeline(ue),S.previousNode=M}_visitTiming(M,S){if(M.dynamic){const $=M.strValue;return pt(S.params?he($,S.params,S.errors):$,S.errors)}return{duration:M.duration,delay:M.delay,easing:M.easing}}visitAnimate(M,S){const $=S.currentAnimateTimings=this._visitTiming(M.timings,S),ue=S.currentTimeline;$.delay&&(S.incrementTime($.delay),ue.snapshotCurrentStyles());const Re=M.style;5==Re.type?this.visitKeyframes(Re,S):(S.incrementTime($.duration),this.visitStyle(Re,S),ue.applyStylesToKeyframe()),S.currentAnimateTimings=null,S.previousNode=M}visitStyle(M,S){const $=S.currentTimeline,ue=S.currentAnimateTimings;!ue&&$.hasCurrentStyleProperties()&&$.forwardFrame();const Re=ue&&ue.easing||M.easing;M.isEmptyStep?$.applyEmptyStep(Re):$.setStyles(M.styles,Re,S.errors,S.options),S.previousNode=M}visitKeyframes(M,S){const $=S.currentAnimateTimings,ue=S.currentTimeline.duration,Re=$.duration,Ot=S.createSubContext().currentTimeline;Ot.easing=$.easing,M.styles.forEach(sn=>{Ot.forwardTime((sn.offset||0)*Re),Ot.setStyles(sn.styles,sn.easing,S.errors,S.options),Ot.applyStylesToKeyframe()}),S.currentTimeline.mergeTimelineCollectedStyles(Ot),S.transformIntoNewTimeline(ue+Re),S.previousNode=M}visitQuery(M,S){const $=S.currentTimeline.currentTime,ue=M.options||{},Re=ue.delay?Qt(ue.delay):0;Re&&(6===S.previousNode.type||0==$&&S.currentTimeline.hasCurrentStyleProperties())&&(S.currentTimeline.snapshotCurrentStyles(),S.previousNode=Io);let It=$;const Ot=S.invokeQuery(M.selector,M.originalSelector,M.limit,M.includeSelf,!!ue.optional,S.errors);S.currentQueryTotal=Ot.length;let sn=null;Ot.forEach((zn,di)=>{S.currentQueryIndex=di;const Mi=S.createSubContext(M.options,zn);Re&&Mi.delayNextStep(Re),zn===S.element&&(sn=Mi.currentTimeline),Ri(this,M.animation,Mi),Mi.currentTimeline.applyStylesToKeyframe(),It=Math.max(It,Mi.currentTimeline.currentTime)}),S.currentQueryIndex=0,S.currentQueryTotal=0,S.transformIntoNewTimeline(It),sn&&(S.currentTimeline.mergeTimelineCollectedStyles(sn),S.currentTimeline.snapshotCurrentStyles()),S.previousNode=M}visitStagger(M,S){const $=S.parentContext,ue=S.currentTimeline,Re=M.timings,It=Math.abs(Re.duration),Ot=It*(S.currentQueryTotal-1);let sn=It*S.currentQueryIndex;switch(Re.duration<0?"reverse":Re.easing){case"reverse":sn=Ot-sn;break;case"full":sn=$.currentStaggerTime}const di=S.currentTimeline;sn&&di.delayNextStep(sn);const Mi=di.currentTime;Ri(this,M.animation,S),S.previousNode=M,$.currentStaggerTime=ue.currentTime-Mi+(ue.startTime-$.currentTimeline.startTime)}}const Io={};class kr{constructor(M,S,$,ue,Re,It,Ot,sn){this._driver=M,this.element=S,this.subInstructions=$,this._enterClassName=ue,this._leaveClassName=Re,this.errors=It,this.timelines=Ot,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Io,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=sn||new Fs(this._driver,S,0),Ot.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(M,S){if(!M)return;const $=M;let ue=this.options;null!=$.duration&&(ue.duration=Qt($.duration)),null!=$.delay&&(ue.delay=Qt($.delay));const Re=$.params;if(Re){let It=ue.params;It||(It=this.options.params={}),Object.keys(Re).forEach(Ot=>{(!S||!It.hasOwnProperty(Ot))&&(It[Ot]=he(Re[Ot],It,this.errors))})}}_copyOptions(){const M={};if(this.options){const S=this.options.params;if(S){const $=M.params={};Object.keys(S).forEach(ue=>{$[ue]=S[ue]})}}return M}createSubContext(M=null,S,$){const ue=S||this.element,Re=new kr(this._driver,ue,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(ue,$||0));return Re.previousNode=this.previousNode,Re.currentAnimateTimings=this.currentAnimateTimings,Re.options=this._copyOptions(),Re.updateOptions(M),Re.currentQueryIndex=this.currentQueryIndex,Re.currentQueryTotal=this.currentQueryTotal,Re.parentContext=this,this.subContextCount++,Re}transformIntoNewTimeline(M){return this.previousNode=Io,this.currentTimeline=this.currentTimeline.fork(this.element,M),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(M,S,$){const ue={duration:S??M.duration,delay:this.currentTimeline.currentTime+($??0)+M.delay,easing:""},Re=new Ea(this._driver,M.element,M.keyframes,M.preStyleProps,M.postStyleProps,ue,M.stretchStartingKeyframe);return this.timelines.push(Re),ue}incrementTime(M){this.currentTimeline.forwardTime(this.currentTimeline.duration+M)}delayNextStep(M){M>0&&this.currentTimeline.delayNextStep(M)}invokeQuery(M,S,$,ue,Re,It){let Ot=[];if(ue&&Ot.push(this.element),M.length>0){M=(M=M.replace(Fl,"."+this._enterClassName)).replace(Ha,"."+this._leaveClassName);let zn=this._driver.query(this.element,M,1!=$);0!==$&&(zn=$<0?zn.slice(zn.length+$,zn.length):zn.slice(0,$)),Ot.push(...zn)}return!Re&&0==Ot.length&&It.push(function At(X){return new _.vHH(3014,!1)}()),Ot}}class Fs{constructor(M,S,$,ue){this._driver=M,this.element=S,this.startTime=$,this._elementTimelineStylesLookup=ue,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(S),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(S,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(M){const S=1===this._keyframes.size&&this._pendingStyles.size;this.duration||S?(this.forwardTime(this.currentTime+M),S&&this.snapshotCurrentStyles()):this.startTime+=M}fork(M,S){return this.applyStylesToKeyframe(),new Fs(this._driver,M,S||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(M){this.applyStylesToKeyframe(),this.duration=M,this._loadKeyframe()}_updateStyle(M,S){this._localTimelineStyles.set(M,S),this._globalTimelineStyles.set(M,S),this._styleSummary.set(M,{time:this.currentTime,value:S})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(M){M&&this._previousKeyframe.set("easing",M);for(let[S,$]of this._globalTimelineStyles)this._backFill.set(S,$||a.l3),this._currentKeyframe.set(S,a.l3);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(M,S,$,ue){S&&this._previousKeyframe.set("easing",S);const Re=ue&&ue.params||{},It=function mo(X,M){const S=new Map;let $;return X.forEach(ue=>{if("*"===ue){$=$||M.keys();for(let Re of $)S.set(Re,a.l3)}else oe(ue,S)}),S}(M,this._globalTimelineStyles);for(let[Ot,sn]of It){const zn=he(sn,Re,$);this._pendingStyles.set(Ot,zn),this._localTimelineStyles.has(Ot)||this._backFill.set(Ot,this._globalTimelineStyles.get(Ot)??a.l3),this._updateStyle(Ot,zn)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((M,S)=>{this._currentKeyframe.set(S,M)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((M,S)=>{this._currentKeyframe.has(S)||this._currentKeyframe.set(S,M)}))}snapshotCurrentStyles(){for(let[M,S]of this._localTimelineStyles)this._pendingStyles.set(M,S),this._updateStyle(M,S)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const M=[];for(let S in this._currentKeyframe)M.push(S);return M}mergeTimelineCollectedStyles(M){M._styleSummary.forEach((S,$)=>{const ue=this._styleSummary.get($);(!ue||S.time>ue.time)&&this._updateStyle($,S.value)})}buildKeyframes(){this.applyStylesToKeyframe();const M=new Set,S=new Set,$=1===this._keyframes.size&&0===this.duration;let ue=[];this._keyframes.forEach((Ot,sn)=>{const zn=oe(Ot,new Map,this._backFill);zn.forEach((di,Mi)=>{di===a.k1?M.add(Mi):di===a.l3&&S.add(Mi)}),$||zn.set("offset",sn/this.duration),ue.push(zn)});const Re=M.size?Ue(M.values()):[],It=S.size?Ue(S.values()):[];if($){const Ot=ue[0],sn=new Map(Ot);Ot.set("offset",0),sn.set("offset",1),ue=[Ot,sn]}return Ds(this.element,ue,Re,It,this.duration,this.startTime,this.easing,!1)}}class Ea extends Fs{constructor(M,S,$,ue,Re,It,Ot=!1){super(M,S,It.delay),this.keyframes=$,this.preStyleProps=ue,this.postStyleProps=Re,this._stretchStartingKeyframe=Ot,this.timings={duration:It.duration,delay:It.delay,easing:It.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let M=this.keyframes,{delay:S,duration:$,easing:ue}=this.timings;if(this._stretchStartingKeyframe&&S){const Re=[],It=$+S,Ot=S/It,sn=oe(M[0]);sn.set("offset",0),Re.push(sn);const zn=oe(M[0]);zn.set("offset",Qr(Ot)),Re.push(zn);const di=M.length-1;for(let Mi=1;Mi<=di;Mi++){let ur=oe(M[Mi]);const Xi=ur.get("offset");ur.set("offset",Qr((S+Xi*$)/It)),Re.push(ur)}$=It,S=0,ue="",M=Re}return Ds(this.element,M,this.preStyleProps,this.postStyleProps,$,S,ue,!0)}}function Qr(X,M=3){const S=Math.pow(10,M-1);return Math.round(X*S)/S}class ca{}const ua=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Bo extends ca{normalizePropertyName(M,S){return Tn(M)}normalizeStyleValue(M,S,$,ue){let Re="";const It=$.toString().trim();if(ua.has(S)&&0!==$&&"0"!==$)if("number"==typeof $)Re="px";else{const Ot=$.match(/^[+-]?[\d\.]+([a-z]*)$/);Ot&&0==Ot[1].length&&ue.push(function Et(X,M){return new _.vHH(3005,!1)}())}return It+Re}}function da(X,M,S,$,ue,Re,It,Ot,sn,zn,di,Mi,ur){return{type:0,element:X,triggerName:M,isRemovalTransition:ue,fromState:S,fromStyles:Re,toState:$,toStyles:It,timelines:Ot,queriedElements:sn,preStyleProps:zn,postStyleProps:di,totalTime:Mi,errors:ur}}const no={};class _s{constructor(M,S,$){this._triggerName=M,this.ast=S,this._stateStyles=$}match(M,S,$,ue){return function Ho(X,M,S,$,ue){return X.some(Re=>Re(M,S,$,ue))}(this.ast.matchers,M,S,$,ue)}buildStyles(M,S,$){let ue=this._stateStyles.get("*");return void 0!==M&&(ue=this._stateStyles.get(M?.toString())||ue),ue?ue.buildStyles(S,$):new Map}build(M,S,$,ue,Re,It,Ot,sn,zn,di){const Mi=[],ur=this.ast.options&&this.ast.options.params||no,Vi=this.buildStyles($,Ot&&Ot.params||no,Mi),In=sn&&sn.params||no,ir=this.buildStyles(ue,In,Mi),Mr=new Set,vo=new Map,ko=new Map,ro="void"===ue,ma={params:Ls(In,ur),delay:this.ast.options?.delay},Jo=di?[]:Ga(M,S,this.ast.animation,Re,It,Vi,ir,ma,zn,Mi);let Po=0;if(Jo.forEach(xo=>{Po=Math.max(xo.duration+xo.delay,Po)}),Mi.length)return da(S,this._triggerName,$,ue,ro,Vi,ir,[],[],vo,ko,Po,Mi);Jo.forEach(xo=>{const bs=xo.element,ll=tn(vo,bs,new Set);xo.preStyleProps.forEach(Ur=>ll.add(Ur));const Ra=tn(ko,bs,new Set);xo.postStyleProps.forEach(Ur=>Ra.add(Ur)),bs!==S&&Mr.add(bs)});const es=Ue(Mr.values());return da(S,this._triggerName,$,ue,ro,Vi,ir,Jo,es,vo,ko,Po)}}function Ls(X,M){const S=bn(M);for(const $ in X)X.hasOwnProperty($)&&null!=X[$]&&(S[$]=X[$]);return S}class Bs{constructor(M,S,$){this.styles=M,this.defaultParams=S,this.normalizer=$}buildStyles(M,S){const $=new Map,ue=bn(this.defaultParams);return Object.keys(M).forEach(Re=>{const It=M[Re];null!==It&&(ue[Re]=It)}),this.styles.styles.forEach(Re=>{"string"!=typeof Re&&Re.forEach((It,Ot)=>{It&&(It=he(It,ue,S));const sn=this.normalizer.normalizePropertyName(Ot,S);It=this.normalizer.normalizeStyleValue(Ot,sn,It,S),$.set(sn,It)})}),$}}class Ns{constructor(M,S,$){this.name=M,this.ast=S,this._normalizer=$,this.transitionFactories=[],this.states=new Map,S.states.forEach(ue=>{this.states.set(ue.name,new Bs(ue.style,ue.options&&ue.options.params||{},$))}),Ma(this.states,"true","1"),Ma(this.states,"false","0"),S.transitions.forEach(ue=>{this.transitionFactories.push(new _s(M,ue,this.states))}),this.fallbackTransition=function Go(X,M,S){return new _s(X,{type:1,animation:{type:2,steps:[],options:null},matchers:[(It,Ot)=>!0],options:null,queryCount:0,depCount:0},M)}(M,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(M,S,$,ue){return this.transitionFactories.find(It=>It.match(M,S,$,ue))||null}matchStyles(M,S,$){return this.fallbackTransition.buildStyles(M,S,$)}}function Ma(X,M,S){X.has(M)?X.has(S)||X.set(S,X.get(M)):X.has(S)&&X.set(M,X.get(S))}const il=new Ts;class rs{constructor(M,S,$){this.bodyNode=M,this._driver=S,this._normalizer=$,this._animations=new Map,this._playersById=new Map,this.players=[]}register(M,S){const $=[],Re=Fn(this._driver,S,$,[]);if($.length)throw function _t(X){return new _.vHH(3503,!1)}();this._animations.set(M,Re)}_buildPlayer(M,S,$){const ue=M.element,Re=ce(0,this._normalizer,0,M.keyframes,S,$);return this._driver.animate(ue,Re,M.duration,M.delay,M.easing,[],!0)}create(M,S,$={}){const ue=[],Re=this._animations.get(M);let It;const Ot=new Map;if(Re?(It=Ga(this._driver,S,Re,Hi,un,new Map,new Map,$,il,ue),It.forEach(di=>{const Mi=tn(Ot,di.element,new Map);di.postStyleProps.forEach(ur=>Mi.set(ur,null))})):(ue.push(function Dn(){return new _.vHH(3300,!1)}()),It=[]),ue.length)throw function Xt(X){return new _.vHH(3504,!1)}();Ot.forEach((di,Mi)=>{di.forEach((ur,Xi)=>{di.set(Xi,this._driver.computeStyle(Mi,Xi,a.l3))})});const zn=Xe(It.map(di=>{const Mi=Ot.get(di.element);return this._buildPlayer(di,new Map,Mi)}));return this._playersById.set(M,zn),zn.onDestroy(()=>this.destroy(M)),this.players.push(zn),zn}destroy(M){const S=this._getPlayer(M);S.destroy(),this._playersById.delete(M);const $=this.players.indexOf(S);$>=0&&this.players.splice($,1)}_getPlayer(M){const S=this._playersById.get(M);if(!S)throw function ii(X){return new _.vHH(3301,!1)}();return S}listen(M,S,$,ue){const Re=St(S,"","","");return ot(this._getPlayer(M),$,Re,ue),()=>{}}command(M,S,$,ue){if("register"==$)return void this.register(M,ue[0]);if("create"==$)return void this.create(M,S,ue[0]||{});const Re=this._getPlayer(M);switch($){case"play":Re.play();break;case"pause":Re.pause();break;case"reset":Re.reset();break;case"restart":Re.restart();break;case"finish":Re.finish();break;case"init":Re.init();break;case"setPosition":Re.setPosition(parseFloat(ue[0]));break;case"destroy":this.destroy(M)}}}const Ss="ng-animate-queued",Wr="ng-animate-disabled",rl=[],Fr={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},ml={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Fo="__ng_removed";class $o{constructor(M,S=""){this.namespaceId=S;const $=M&&M.hasOwnProperty("value");if(this.value=function zs(X){return X??null}($?M.value:M),$){const Re=bn(M);delete Re.value,this.options=Re}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(M){const S=M.params;if(S){const $=this.options.params;Object.keys(S).forEach(ue=>{null==$[ue]&&($[ue]=S[ue])})}}}const go="void",$a=new $o(go);class Ys{constructor(M,S,$){this.id=M,this.hostElement=S,this._engine=$,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+M,Mo(S,this._hostClassName)}listen(M,S,$,ue){if(!this._triggers.has(S))throw function vi(X,M){return new _.vHH(3302,!1)}();if(null==$||0==$.length)throw function wi(X){return new _.vHH(3303,!1)}();if(!function ss(X){return"start"==X||"done"==X}($))throw function Nn(X,M){return new _.vHH(3400,!1)}();const Re=tn(this._elementListeners,M,[]),It={name:S,phase:$,callback:ue};Re.push(It);const Ot=tn(this._engine.statesByElement,M,new Map);return Ot.has(S)||(Mo(M,Pt),Mo(M,Pt+"-"+S),Ot.set(S,$a)),()=>{this._engine.afterFlush(()=>{const sn=Re.indexOf(It);sn>=0&&Re.splice(sn,1),this._triggers.has(S)||Ot.delete(S)})}}register(M,S){return!this._triggers.has(M)&&(this._triggers.set(M,S),!0)}_getTrigger(M){const S=this._triggers.get(M);if(!S)throw function Bi(X){return new _.vHH(3401,!1)}();return S}trigger(M,S,$,ue=!0){const Re=this._getTrigger(S),It=new cr(this.id,S,M);let Ot=this._engine.statesByElement.get(M);Ot||(Mo(M,Pt),Mo(M,Pt+"-"+S),this._engine.statesByElement.set(M,Ot=new Map));let sn=Ot.get(S);const zn=new $o($,this.id);if(!($&&$.hasOwnProperty("value"))&&sn&&zn.absorbOptions(sn.options),Ot.set(S,zn),sn||(sn=$a),zn.value!==go&&sn.value===zn.value){if(!function As(X,M){const S=Object.keys(X),$=Object.keys(M);if(S.length!=$.length)return!1;for(let ue=0;ue<S.length;ue++){const Re=S[ue];if(!M.hasOwnProperty(Re)||X[Re]!==M[Re])return!1}return!0}(sn.params,zn.params)){const In=[],ir=Re.matchStyles(sn.value,sn.params,In),Mr=Re.matchStyles(zn.value,zn.params,In);In.length?this._engine.reportError(In):this._engine.afterFlush(()=>{Lt(M,ir),ct(M,Mr)})}return}const ur=tn(this._engine.playersByElement,M,[]);ur.forEach(In=>{In.namespaceId==this.id&&In.triggerName==S&&In.queued&&In.destroy()});let Xi=Re.matchTransition(sn.value,zn.value,M,zn.params),Vi=!1;if(!Xi){if(!ue)return;Xi=Re.fallbackTransition,Vi=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:M,triggerName:S,transition:Xi,fromState:sn,toState:zn,player:It,isFallbackTransition:Vi}),Vi||(Mo(M,Ss),It.onStart(()=>{Da(M,Ss)})),It.onDone(()=>{let In=this.players.indexOf(It);In>=0&&this.players.splice(In,1);const ir=this._engine.playersByElement.get(M);if(ir){let Mr=ir.indexOf(It);Mr>=0&&ir.splice(Mr,1)}}),this.players.push(It),ur.push(It),It}deregister(M){this._triggers.delete(M),this._engine.statesByElement.forEach(S=>S.delete(M)),this._elementListeners.forEach((S,$)=>{this._elementListeners.set($,S.filter(ue=>ue.name!=M))})}clearElementCache(M){this._engine.statesByElement.delete(M),this._elementListeners.delete(M);const S=this._engine.playersByElement.get(M);S&&(S.forEach($=>$.destroy()),this._engine.playersByElement.delete(M))}_signalRemovalForInnerTriggers(M,S){const $=this._engine.driver.query(M,lt,!0);$.forEach(ue=>{if(ue[Fo])return;const Re=this._engine.fetchNamespacesByElement(ue);Re.size?Re.forEach(It=>It.triggerLeaveAnimation(ue,S,!1,!0)):this.clearElementCache(ue)}),this._engine.afterFlushAnimationsDone(()=>$.forEach(ue=>this.clearElementCache(ue)))}triggerLeaveAnimation(M,S,$,ue){const Re=this._engine.statesByElement.get(M),It=new Map;if(Re){const Ot=[];if(Re.forEach((sn,zn)=>{if(It.set(zn,sn.value),this._triggers.has(zn)){const di=this.trigger(M,zn,go,ue);di&&Ot.push(di)}}),Ot.length)return this._engine.markElementAsRemoved(this.id,M,!0,S,It),$&&Xe(Ot).onDone(()=>this._engine.processLeaveNode(M)),!0}return!1}prepareLeaveAnimationListeners(M){const S=this._elementListeners.get(M),$=this._engine.statesByElement.get(M);if(S&&$){const ue=new Set;S.forEach(Re=>{const It=Re.name;if(ue.has(It))return;ue.add(It);const sn=this._triggers.get(It).fallbackTransition,zn=$.get(It)||$a,di=new $o(go),Mi=new cr(this.id,It,M);this._engine.totalQueuedPlayers++,this._queue.push({element:M,triggerName:It,transition:sn,fromState:zn,toState:di,player:Mi,isFallbackTransition:!0})})}}removeNode(M,S){const $=this._engine;if(M.childElementCount&&this._signalRemovalForInnerTriggers(M,S),this.triggerLeaveAnimation(M,S,!0))return;let ue=!1;if($.totalAnimations){const Re=$.players.length?$.playersByQueriedElement.get(M):[];if(Re&&Re.length)ue=!0;else{let It=M;for(;It=It.parentNode;)if($.statesByElement.get(It)){ue=!0;break}}}if(this.prepareLeaveAnimationListeners(M),ue)$.markElementAsRemoved(this.id,M,!1,S);else{const Re=M[Fo];(!Re||Re===Fr)&&($.afterFlush(()=>this.clearElementCache(M)),$.destroyInnerAnimations(M),$._onRemovalComplete(M,S))}}insertNode(M,S){Mo(M,this._hostClassName)}drainQueuedTransitions(M){const S=[];return this._queue.forEach($=>{const ue=$.player;if(ue.destroyed)return;const Re=$.element,It=this._elementListeners.get(Re);It&&It.forEach(Ot=>{if(Ot.name==$.triggerName){const sn=St(Re,$.triggerName,$.fromState.value,$.toState.value);sn._data=M,ot($.player,Ot.phase,sn,Ot.callback)}}),ue.markedForDestroy?this._engine.afterFlush(()=>{ue.destroy()}):S.push($)}),this._queue=[],S.sort(($,ue)=>{const Re=$.transition.ast.depCount,It=ue.transition.ast.depCount;return 0==Re||0==It?Re-It:this._engine.driver.containsElement($.element,ue.element)?1:-1})}destroy(M){this.players.forEach(S=>S.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,M)}elementContainsData(M){let S=!1;return this._elementListeners.has(M)&&(S=!0),S=!!this._queue.find($=>$.element===M)||S,S}}class pa{constructor(M,S,$){this.bodyNode=M,this.driver=S,this._normalizer=$,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(ue,Re)=>{}}_onRemovalComplete(M,S){this.onRemovalComplete(M,S)}get queuedPlayers(){const M=[];return this._namespaceList.forEach(S=>{S.players.forEach($=>{$.queued&&M.push($)})}),M}createNamespace(M,S){const $=new Ys(M,S,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,S)?this._balanceNamespaceList($,S):(this.newHostElements.set(S,$),this.collectEnterElement(S)),this._namespaceLookup[M]=$}_balanceNamespaceList(M,S){const $=this._namespaceList,ue=this.namespacesByHostElement;if($.length-1>=0){let It=!1,Ot=this.driver.getParentElement(S);for(;Ot;){const sn=ue.get(Ot);if(sn){const zn=$.indexOf(sn);$.splice(zn+1,0,M),It=!0;break}Ot=this.driver.getParentElement(Ot)}It||$.unshift(M)}else $.push(M);return ue.set(S,M),M}register(M,S){let $=this._namespaceLookup[M];return $||($=this.createNamespace(M,S)),$}registerTrigger(M,S,$){let ue=this._namespaceLookup[M];ue&&ue.register(S,$)&&this.totalAnimations++}destroy(M,S){if(!M)return;const $=this._fetchNamespace(M);this.afterFlush(()=>{this.namespacesByHostElement.delete($.hostElement),delete this._namespaceLookup[M];const ue=this._namespaceList.indexOf($);ue>=0&&this._namespaceList.splice(ue,1)}),this.afterFlushAnimationsDone(()=>$.destroy(S))}_fetchNamespace(M){return this._namespaceLookup[M]}fetchNamespacesByElement(M){const S=new Set,$=this.statesByElement.get(M);if($)for(let ue of $.values())if(ue.namespaceId){const Re=this._fetchNamespace(ue.namespaceId);Re&&S.add(Re)}return S}trigger(M,S,$,ue){if(Ks(S)){const Re=this._fetchNamespace(M);if(Re)return Re.trigger(S,$,ue),!0}return!1}insertNode(M,S,$,ue){if(!Ks(S))return;const Re=S[Fo];if(Re&&Re.setForRemoval){Re.setForRemoval=!1,Re.setForMove=!0;const It=this.collectedLeaveElements.indexOf(S);It>=0&&this.collectedLeaveElements.splice(It,1)}if(M){const It=this._fetchNamespace(M);It&&It.insertNode(S,$)}ue&&this.collectEnterElement(S)}collectEnterElement(M){this.collectedEnterElements.push(M)}markElementAsDisabled(M,S){S?this.disabledNodes.has(M)||(this.disabledNodes.add(M),Mo(M,Wr)):this.disabledNodes.has(M)&&(this.disabledNodes.delete(M),Da(M,Wr))}removeNode(M,S,$,ue){if(Ks(S)){const Re=M?this._fetchNamespace(M):null;if(Re?Re.removeNode(S,ue):this.markElementAsRemoved(M,S,!1,ue),$){const It=this.namespacesByHostElement.get(S);It&&It.id!==M&&It.removeNode(S,ue)}}else this._onRemovalComplete(S,ue)}markElementAsRemoved(M,S,$,ue,Re){this.collectedLeaveElements.push(S),S[Fo]={namespaceId:M,setForRemoval:ue,hasAnimation:$,removedBeforeQueried:!1,previousTriggersValues:Re}}listen(M,S,$,ue,Re){return Ks(S)?this._fetchNamespace(M).listen(S,$,ue,Re):()=>{}}_buildInstruction(M,S,$,ue,Re){return M.transition.build(this.driver,M.element,M.fromState.value,M.toState.value,$,ue,M.fromState.options,M.toState.options,S,Re)}destroyInnerAnimations(M){let S=this.driver.query(M,lt,!0);S.forEach($=>this.destroyActiveAnimationsForElement($)),0!=this.playersByQueriedElement.size&&(S=this.driver.query(M,_i,!0),S.forEach($=>this.finishActiveQueriedAnimationOnElement($)))}destroyActiveAnimationsForElement(M){const S=this.playersByElement.get(M);S&&S.forEach($=>{$.queued?$.markedForDestroy=!0:$.destroy()})}finishActiveQueriedAnimationOnElement(M){const S=this.playersByQueriedElement.get(M);S&&S.forEach($=>$.finish())}whenRenderingDone(){return new Promise(M=>{if(this.players.length)return Xe(this.players).onDone(()=>M());M()})}processLeaveNode(M){const S=M[Fo];if(S&&S.setForRemoval){if(M[Fo]=Fr,S.namespaceId){this.destroyInnerAnimations(M);const $=this._fetchNamespace(S.namespaceId);$&&$.clearElementCache(M)}this._onRemovalComplete(M,S.setForRemoval)}M.classList?.contains(Wr)&&this.markElementAsDisabled(M,!1),this.driver.query(M,".ng-animate-disabled",!0).forEach($=>{this.markElementAsDisabled($,!1)})}flush(M=-1){let S=[];if(this.newHostElements.size&&(this.newHostElements.forEach(($,ue)=>this._balanceNamespaceList($,ue)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let $=0;$<this.collectedEnterElements.length;$++)Mo(this.collectedEnterElements[$],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const $=[];try{S=this._flushAnimations($,M)}finally{for(let ue=0;ue<$.length;ue++)$[ue]()}}else for(let $=0;$<this.collectedLeaveElements.length;$++)this.processLeaveNode(this.collectedLeaveElements[$]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach($=>$()),this._flushFns=[],this._whenQuietFns.length){const $=this._whenQuietFns;this._whenQuietFns=[],S.length?Xe(S).onDone(()=>{$.forEach(ue=>ue())}):$.forEach(ue=>ue())}}reportError(M){throw function Jn(X){return new _.vHH(3402,!1)}()}_flushAnimations(M,S){const $=new Ts,ue=[],Re=new Map,It=[],Ot=new Map,sn=new Map,zn=new Map,di=new Set;this.disabledNodes.forEach(Di=>{di.add(Di);const Ii=this.driver.query(Di,".ng-animate-queued",!0);for(let Zi=0;Zi<Ii.length;Zi++)di.add(Ii[Zi])});const Mi=this.bodyNode,ur=Array.from(this.statesByElement.keys()),Xi=Gi(ur,this.collectedEnterElements),Vi=new Map;let In=0;Xi.forEach((Di,Ii)=>{const Zi=Hi+In++;Vi.set(Ii,Zi),Di.forEach(br=>Mo(br,Zi))});const ir=[],Mr=new Set,vo=new Set;for(let Di=0;Di<this.collectedLeaveElements.length;Di++){const Ii=this.collectedLeaveElements[Di],Zi=Ii[Fo];Zi&&Zi.setForRemoval&&(ir.push(Ii),Mr.add(Ii),Zi.hasAnimation?this.driver.query(Ii,".ng-star-inserted",!0).forEach(br=>Mr.add(br)):vo.add(Ii))}const ko=new Map,ro=Gi(ur,Array.from(Mr));ro.forEach((Di,Ii)=>{const Zi=un+In++;ko.set(Ii,Zi),Di.forEach(br=>Mo(br,Zi))}),M.push(()=>{Xi.forEach((Di,Ii)=>{const Zi=Vi.get(Ii);Di.forEach(br=>Da(br,Zi))}),ro.forEach((Di,Ii)=>{const Zi=ko.get(Ii);Di.forEach(br=>Da(br,Zi))}),ir.forEach(Di=>{this.processLeaveNode(Di)})});const ma=[],Jo=[];for(let Di=this._namespaceList.length-1;Di>=0;Di--)this._namespaceList[Di].drainQueuedTransitions(S).forEach(Zi=>{const br=Zi.player,oo=Zi.element;if(ma.push(br),this.collectedEnterElements.length){const Uo=oo[Fo];if(Uo&&Uo.setForMove){if(Uo.previousTriggersValues&&Uo.previousTriggersValues.has(Zi.triggerName)){const ea=Uo.previousTriggersValues.get(Zi.triggerName),bo=this.statesByElement.get(Zi.element);if(bo&&bo.has(Zi.triggerName)){const _l=bo.get(Zi.triggerName);_l.value=ea,bo.set(Zi.triggerName,_l)}}return void br.destroy()}}const ga=!Mi||!this.driver.containsElement(Mi,oo),us=ko.get(oo),Gs=Vi.get(oo),Or=this._buildInstruction(Zi,$,Gs,us,ga);if(Or.errors&&Or.errors.length)return void Jo.push(Or);if(ga)return br.onStart(()=>Lt(oo,Or.fromStyles)),br.onDestroy(()=>ct(oo,Or.toStyles)),void ue.push(br);if(Zi.isFallbackTransition)return br.onStart(()=>Lt(oo,Or.fromStyles)),br.onDestroy(()=>ct(oo,Or.toStyles)),void ue.push(br);const Js=[];Or.timelines.forEach(Uo=>{Uo.stretchStartingKeyframe=!0,this.disabledNodes.has(Uo.element)||Js.push(Uo)}),Or.timelines=Js,$.append(oo,Or.timelines),It.push({instruction:Or,player:br,element:oo}),Or.queriedElements.forEach(Uo=>tn(Ot,Uo,[]).push(br)),Or.preStyleProps.forEach((Uo,ea)=>{if(Uo.size){let bo=sn.get(ea);bo||sn.set(ea,bo=new Set),Uo.forEach((_l,Vl)=>bo.add(Vl))}}),Or.postStyleProps.forEach((Uo,ea)=>{let bo=zn.get(ea);bo||zn.set(ea,bo=new Set),Uo.forEach((_l,Vl)=>bo.add(Vl))})});if(Jo.length){const Di=[];Jo.forEach(Ii=>{Di.push(function Tt(X,M){return new _.vHH(3505,!1)}())}),ma.forEach(Ii=>Ii.destroy()),this.reportError(Di)}const Po=new Map,es=new Map;It.forEach(Di=>{const Ii=Di.element;$.has(Ii)&&(es.set(Ii,Ii),this._beforeAnimationBuild(Di.player.namespaceId,Di.instruction,Po))}),ue.forEach(Di=>{const Ii=Di.element;this._getPreviousPlayers(Ii,!1,Di.namespaceId,Di.triggerName,null).forEach(br=>{tn(Po,Ii,[]).push(br),br.destroy()})});const xo=ir.filter(Di=>Sa(Di,sn,zn)),bs=new Map;_o(bs,this.driver,vo,zn,a.l3).forEach(Di=>{Sa(Di,sn,zn)&&xo.push(Di)});const Ra=new Map;Xi.forEach((Di,Ii)=>{_o(Ra,this.driver,new Set(Di),sn,a.k1)}),xo.forEach(Di=>{const Ii=bs.get(Di),Zi=Ra.get(Di);bs.set(Di,new Map([...Array.from(Ii?.entries()??[]),...Array.from(Zi?.entries()??[])]))});const Ur=[],xc=[],ka={};It.forEach(Di=>{const{element:Ii,player:Zi,instruction:br}=Di;if($.has(Ii)){if(di.has(Ii))return Zi.onDestroy(()=>ct(Ii,br.toStyles)),Zi.disabled=!0,Zi.overrideTotalTime(br.totalTime),void ue.push(Zi);let oo=ka;if(es.size>1){let us=Ii;const Gs=[];for(;us=us.parentNode;){const Or=es.get(us);if(Or){oo=Or;break}Gs.push(us)}Gs.forEach(Or=>es.set(Or,oo))}const ga=this._buildAnimation(Zi.namespaceId,br,Po,Re,Ra,bs);if(Zi.setRealPlayer(ga),oo===ka)Ur.push(Zi);else{const us=this.playersByElement.get(oo);us&&us.length&&(Zi.parentPlayer=Xe(us)),ue.push(Zi)}}else Lt(Ii,br.fromStyles),Zi.onDestroy(()=>ct(Ii,br.toStyles)),xc.push(Zi),di.has(Ii)&&ue.push(Zi)}),xc.forEach(Di=>{const Ii=Re.get(Di.element);if(Ii&&Ii.length){const Zi=Xe(Ii);Di.setRealPlayer(Zi)}}),ue.forEach(Di=>{Di.parentPlayer?Di.syncPlayerEvents(Di.parentPlayer):Di.destroy()});for(let Di=0;Di<ir.length;Di++){const Ii=ir[Di],Zi=Ii[Fo];if(Da(Ii,un),Zi&&Zi.hasAnimation)continue;let br=[];if(Ot.size){let ga=Ot.get(Ii);ga&&ga.length&&br.push(...ga);let us=this.driver.query(Ii,_i,!0);for(let Gs=0;Gs<us.length;Gs++){let Or=Ot.get(us[Gs]);Or&&Or.length&&br.push(...Or)}}const oo=br.filter(ga=>!ga.destroyed);oo.length?Ta(this,Ii,oo):this.processLeaveNode(Ii)}return ir.length=0,Ur.forEach(Di=>{this.players.push(Di),Di.onDone(()=>{Di.destroy();const Ii=this.players.indexOf(Di);this.players.splice(Ii,1)}),Di.play()}),Ur}elementContainsData(M,S){let $=!1;const ue=S[Fo];return ue&&ue.setForRemoval&&($=!0),this.playersByElement.has(S)&&($=!0),this.playersByQueriedElement.has(S)&&($=!0),this.statesByElement.has(S)&&($=!0),this._fetchNamespace(M).elementContainsData(S)||$}afterFlush(M){this._flushFns.push(M)}afterFlushAnimationsDone(M){this._whenQuietFns.push(M)}_getPreviousPlayers(M,S,$,ue,Re){let It=[];if(S){const Ot=this.playersByQueriedElement.get(M);Ot&&(It=Ot)}else{const Ot=this.playersByElement.get(M);if(Ot){const sn=!Re||Re==go;Ot.forEach(zn=>{zn.queued||!sn&&zn.triggerName!=ue||It.push(zn)})}}return($||ue)&&(It=It.filter(Ot=>!($&&$!=Ot.namespaceId||ue&&ue!=Ot.triggerName))),It}_beforeAnimationBuild(M,S,$){const Re=S.element,It=S.isRemovalTransition?void 0:M,Ot=S.isRemovalTransition?void 0:S.triggerName;for(const sn of S.timelines){const zn=sn.element,di=zn!==Re,Mi=tn($,zn,[]);this._getPreviousPlayers(zn,di,It,Ot,S.toState).forEach(Xi=>{const Vi=Xi.getRealPlayer();Vi.beforeDestroy&&Vi.beforeDestroy(),Xi.destroy(),Mi.push(Xi)})}Lt(Re,S.fromStyles)}_buildAnimation(M,S,$,ue,Re,It){const Ot=S.triggerName,sn=S.element,zn=[],di=new Set,Mi=new Set,ur=S.timelines.map(Vi=>{const In=Vi.element;di.add(In);const ir=In[Fo];if(ir&&ir.removedBeforeQueried)return new a.ZN(Vi.duration,Vi.delay);const Mr=In!==sn,vo=function Us(X){const M=[];return as(X,M),M}(($.get(In)||rl).map(Po=>Po.getRealPlayer())).filter(Po=>!!Po.element&&Po.element===In),ko=Re.get(In),ro=It.get(In),ma=ce(0,this._normalizer,0,Vi.keyframes,ko,ro),Jo=this._buildPlayer(Vi,ma,vo);if(Vi.subTimeline&&ue&&Mi.add(In),Mr){const Po=new cr(M,Ot,In);Po.setRealPlayer(Jo),zn.push(Po)}return Jo});zn.forEach(Vi=>{tn(this.playersByQueriedElement,Vi.element,[]).push(Vi),Vi.onDone(()=>function fr(X,M,S){let $=X.get(M);if($){if($.length){const ue=$.indexOf(S);$.splice(ue,1)}0==$.length&&X.delete(M)}return $}(this.playersByQueriedElement,Vi.element,Vi))}),di.forEach(Vi=>Mo(Vi,nn));const Xi=Xe(ur);return Xi.onDestroy(()=>{di.forEach(Vi=>Da(Vi,nn)),ct(sn,S.toStyles)}),Mi.forEach(Vi=>{tn(ue,Vi,[]).push(Xi)}),Xi}_buildPlayer(M,S,$){return S.length>0?this.driver.animate(M.element,S,M.duration,M.delay,M.easing,$):new a.ZN(M.duration,M.delay)}}class cr{constructor(M,S,$){this.namespaceId=M,this.triggerName=S,this.element=$,this._player=new a.ZN,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(M){this._containsRealPlayer||(this._player=M,this._queuedCallbacks.forEach((S,$)=>{S.forEach(ue=>ot(M,$,void 0,ue))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(M.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(M){this.totalTime=M}syncPlayerEvents(M){const S=this._player;S.triggerCallback&&M.onStart(()=>S.triggerCallback("start")),M.onDone(()=>this.finish()),M.onDestroy(()=>this.destroy())}_queueEvent(M,S){tn(this._queuedCallbacks,M,[]).push(S)}onDone(M){this.queued&&this._queueEvent("done",M),this._player.onDone(M)}onStart(M){this.queued&&this._queueEvent("start",M),this._player.onStart(M)}onDestroy(M){this.queued&&this._queueEvent("destroy",M),this._player.onDestroy(M)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(M){this.queued||this._player.setPosition(M)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(M){const S=this._player;S.triggerCallback&&S.triggerCallback(M)}}function Ks(X){return X&&1===X.nodeType}function vs(X,M){const S=X.style.display;return X.style.display=M??"none",S}function _o(X,M,S,$,ue){const Re=[];S.forEach(sn=>Re.push(vs(sn)));const It=[];$.forEach((sn,zn)=>{const di=new Map;sn.forEach(Mi=>{const ur=M.computeStyle(zn,Mi,ue);di.set(Mi,ur),(!ur||0==ur.length)&&(zn[Fo]=ml,It.push(zn))}),X.set(zn,di)});let Ot=0;return S.forEach(sn=>vs(sn,Re[Ot++])),It}function Gi(X,M){const S=new Map;if(X.forEach(Ot=>S.set(Ot,[])),0==M.length)return S;const ue=new Set(M),Re=new Map;function It(Ot){if(!Ot)return 1;let sn=Re.get(Ot);if(sn)return sn;const zn=Ot.parentNode;return sn=S.has(zn)?zn:ue.has(zn)?1:It(zn),Re.set(Ot,sn),sn}return M.forEach(Ot=>{const sn=It(Ot);1!==sn&&S.get(sn).push(Ot)}),S}function Mo(X,M){X.classList?.add(M)}function Da(X,M){X.classList?.remove(M)}function Ta(X,M,S){Xe(S).onDone(()=>X.processLeaveNode(M))}function as(X,M){for(let S=0;S<X.length;S++){const $=X[S];$ instanceof a.ZE?as($.players,M):M.push($)}}function Sa(X,M,S){const $=S.get(X);if(!$)return!1;let ue=M.get(X);return ue?$.forEach(Re=>ue.add(Re)):M.set(X,$),S.delete(X),!0}class ls{constructor(M,S,$){this.bodyNode=M,this._driver=S,this._normalizer=$,this._triggerCache={},this.onRemovalComplete=(ue,Re)=>{},this._transitionEngine=new pa(M,S,$),this._timelineEngine=new rs(M,S,$),this._transitionEngine.onRemovalComplete=(ue,Re)=>this.onRemovalComplete(ue,Re)}registerTrigger(M,S,$,ue,Re){const It=M+"-"+ue;let Ot=this._triggerCache[It];if(!Ot){const sn=[],di=Fn(this._driver,Re,sn,[]);if(sn.length)throw function Ne(X,M){return new _.vHH(3404,!1)}();Ot=function Ca(X,M,S){return new Ns(X,M,S)}(ue,di,this._normalizer),this._triggerCache[It]=Ot}this._transitionEngine.registerTrigger(S,ue,Ot)}register(M,S){this._transitionEngine.register(M,S)}destroy(M,S){this._transitionEngine.destroy(M,S)}onInsert(M,S,$,ue){this._transitionEngine.insertNode(M,S,$,ue)}onRemove(M,S,$,ue){this._transitionEngine.removeNode(M,S,ue||!1,$)}disableAnimations(M,S){this._transitionEngine.markElementAsDisabled(M,S)}process(M,S,$,ue){if("@"==$.charAt(0)){const[Re,It]=li($);this._timelineEngine.command(Re,S,It,ue)}else this._transitionEngine.trigger(M,S,$,ue)}listen(M,S,$,ue,Re){if("@"==$.charAt(0)){const[It,Ot]=li($);return this._timelineEngine.listen(It,S,Ot,Re)}return this._transitionEngine.listen(M,S,$,ue,Re)}flush(M=-1){this._transitionEngine.flush(M)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let ar=(()=>{class X{constructor(S,$,ue){this._element=S,this._startStyles=$,this._endStyles=ue,this._state=0;let Re=X.initialStylesByElement.get(S);Re||X.initialStylesByElement.set(S,Re=new Map),this._initialStyles=Re}start(){this._state<1&&(this._startStyles&&ct(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ct(this._element,this._initialStyles),this._endStyles&&(ct(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(X.initialStylesByElement.delete(this._element),this._startStyles&&(Lt(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Lt(this._element,this._endStyles),this._endStyles=null),ct(this._element,this._initialStyles),this._state=3)}}return X.initialStylesByElement=new WeakMap,X})();function Za(X){let M=null;return X.forEach((S,$)=>{(function fa(X){return"display"===X||"position"===X})($)&&(M=M||new Map,M.set($,S))}),M}class zr{constructor(M,S,$,ue){this.element=M,this.keyframes=S,this.options=$,this._specialStyles=ue,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=$.duration,this._delay=$.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(M=>M()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const M=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,M,this.options),this._finalKeyframe=M.length?M[M.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(M){const S=[];return M.forEach($=>{S.push(Object.fromEntries($))}),S}_triggerWebAnimation(M,S,$){return M.animate(this._convertKeyframesToObject(S),$)}onStart(M){this._originalOnStartFns.push(M),this._onStartFns.push(M)}onDone(M){this._originalOnDoneFns.push(M),this._onDoneFns.push(M)}onDestroy(M){this._onDestroyFns.push(M)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(M=>M()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(M=>M()),this._onDestroyFns=[])}setPosition(M){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=M*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const M=new Map;this.hasStarted()&&this._finalKeyframe.forEach(($,ue)=>{"offset"!==ue&&M.set(ue,this._finished?$:Gn(this.element,ue))}),this.currentSnapshot=M}triggerCallback(M){const S="start"===M?this._onStartFns:this._onDoneFns;S.forEach($=>$()),S.length=0}}class Q{validateStyleProperty(M){return!0}validateAnimatableStyleProperty(M){return!0}matchesElement(M,S){return!1}containsElement(M,S){return te(M,S)}getParentElement(M){return $e(M)}query(M,S,$){return nt(M,S,$)}computeStyle(M,S,$){return window.getComputedStyle(M)[S]}animate(M,S,$,ue,Re,It=[]){const sn={duration:$,delay:ue,fill:0==ue?"both":"forwards"};Re&&(sn.easing=Re);const zn=new Map,di=It.filter(Xi=>Xi instanceof zr);(function Xn(X,M){return 0===X||0===M})($,ue)&&di.forEach(Xi=>{Xi.currentSnapshot.forEach((Vi,In)=>zn.set(In,Vi))});let Mi=function Ee(X){return X.length?X[0]instanceof Map?X:X.map(M=>ri(M)):[]}(S).map(Xi=>oe(Xi));Mi=function Ai(X,M,S){if(S.size&&M.length){let $=M[0],ue=[];if(S.forEach((Re,It)=>{$.has(It)||ue.push(It),$.set(It,Re)}),ue.length)for(let Re=1;Re<M.length;Re++){let It=M[Re];ue.forEach(Ot=>It.set(Ot,Gn(X,Ot)))}}return M}(M,Mi,zn);const ur=function wn(X,M){let S=null,$=null;return Array.isArray(M)&&M.length?(S=Za(M[0]),M.length>1&&($=Za(M[M.length-1]))):M instanceof Map&&(S=Za(M)),S||$?new ar(X,S,$):null}(M,Mi);return new zr(M,Mi,sn,ur)}}var q=B(6895);let j=(()=>{class X extends a._j{constructor(S,$){super(),this._nextAnimationId=0,this._renderer=S.createRenderer($.body,{id:"0",encapsulation:_.ifc.None,styles:[],data:{animation:[]}})}build(S){const $=this._nextAnimationId.toString();this._nextAnimationId++;const ue=Array.isArray(S)?(0,a.vP)(S):S;return bi(this._renderer,null,$,"register",[ue]),new be($,this._renderer)}}return X.\u0275fac=function(S){return new(S||X)(_.LFG(_.FYo),_.LFG(q.K0))},X.\u0275prov=_.Yz7({token:X,factory:X.\u0275fac}),X})();class be extends a.LC{constructor(M,S){super(),this._id=M,this._renderer=S}create(M,S){return new En(this._id,M,S||{},this._renderer)}}class En{constructor(M,S,$,ue){this.id=M,this.element=S,this._renderer=ue,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",$)}_listen(M,S){return this._renderer.listen(this.element,`@@${this.id}:${M}`,S)}_command(M,...S){return bi(this._renderer,this.element,this.id,M,S)}onDone(M){this._listen("done",M)}onStart(M){this._listen("start",M)}onDestroy(M){this._listen("destroy",M)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(M){this._command("setPosition",M)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function bi(X,M,S,$,ue){return X.setProperty(M,`@@${S}:${$}`,ue)}const Is="@.disabled";let xs=(()=>{class X{constructor(S,$,ue){this.delegate=S,this.engine=$,this._zone=ue,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),$.onRemovalComplete=(Re,It)=>{const Ot=It?.parentNode(Re);Ot&&It.removeChild(Ot,Re)}}createRenderer(S,$){const Re=this.delegate.createRenderer(S,$);if(!(S&&$&&$.data&&$.data.animation)){let di=this._rendererCache.get(Re);return di||(di=new Lr("",Re,this.engine,()=>this._rendererCache.delete(Re)),this._rendererCache.set(Re,di)),di}const It=$.id,Ot=$.id+"-"+this._currentId;this._currentId++,this.engine.register(Ot,S);const sn=di=>{Array.isArray(di)?di.forEach(sn):this.engine.registerTrigger(It,Ot,S,di.name,di)};return $.data.animation.forEach(sn),new Zo(this,Ot,Re,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(S,$,ue){S>=0&&S<this._microtaskId?this._zone.run(()=>$(ue)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(Re=>{const[It,Ot]=Re;It(Ot)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([$,ue]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return X.\u0275fac=function(S){return new(S||X)(_.LFG(_.FYo),_.LFG(ls),_.LFG(_.R0b))},X.\u0275prov=_.Yz7({token:X,factory:X.\u0275fac}),X})();class Lr{constructor(M,S,$,ue){this.namespaceId=M,this.delegate=S,this.engine=$,this._onDestroy=ue,this.destroyNode=this.delegate.destroyNode?Re=>S.destroyNode(Re):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(M,S){return this.delegate.createElement(M,S)}createComment(M){return this.delegate.createComment(M)}createText(M){return this.delegate.createText(M)}appendChild(M,S){this.delegate.appendChild(M,S),this.engine.onInsert(this.namespaceId,S,M,!1)}insertBefore(M,S,$,ue=!0){this.delegate.insertBefore(M,S,$),this.engine.onInsert(this.namespaceId,S,M,ue)}removeChild(M,S,$){this.engine.onRemove(this.namespaceId,S,this.delegate,$)}selectRootElement(M,S){return this.delegate.selectRootElement(M,S)}parentNode(M){return this.delegate.parentNode(M)}nextSibling(M){return this.delegate.nextSibling(M)}setAttribute(M,S,$,ue){this.delegate.setAttribute(M,S,$,ue)}removeAttribute(M,S,$){this.delegate.removeAttribute(M,S,$)}addClass(M,S){this.delegate.addClass(M,S)}removeClass(M,S){this.delegate.removeClass(M,S)}setStyle(M,S,$,ue){this.delegate.setStyle(M,S,$,ue)}removeStyle(M,S,$){this.delegate.removeStyle(M,S,$)}setProperty(M,S,$){"@"==S.charAt(0)&&S==Is?this.disableAnimations(M,!!$):this.delegate.setProperty(M,S,$)}setValue(M,S){this.delegate.setValue(M,S)}listen(M,S,$){return this.delegate.listen(M,S,$)}disableAnimations(M,S){this.engine.disableAnimations(M,S)}}class Zo extends Lr{constructor(M,S,$,ue,Re){super(S,$,ue,Re),this.factory=M,this.namespaceId=S}setProperty(M,S,$){"@"==S.charAt(0)?"."==S.charAt(1)&&S==Is?this.disableAnimations(M,$=void 0===$||!!$):this.engine.process(this.namespaceId,M,S.slice(1),$):this.delegate.setProperty(M,S,$)}listen(M,S,$){if("@"==S.charAt(0)){const ue=function Aa(X){switch(X){case"body":return document.body;case"document":return document;case"window":return window;default:return X}}(M);let Re=S.slice(1),It="";return"@"!=Re.charAt(0)&&([Re,It]=function Vs(X){const M=X.indexOf(".");return[X.substring(0,M),X.slice(M+1)]}(Re)),this.engine.listen(this.namespaceId,ue,Re,It,Ot=>{this.factory.scheduleListenerCallback(Ot._data||-1,$,Ot)})}return this.delegate.listen(M,S,$)}}const js=[{provide:a._j,useClass:j},{provide:ca,useFactory:function Ll(){return new Bo}},{provide:ls,useClass:(()=>{class X extends ls{constructor(S,$,ue,Re){super(S.body,$,ue)}ngOnDestroy(){this.flush()}}return X.\u0275fac=function(S){return new(S||X)(_.LFG(q.K0),_.LFG(ni),_.LFG(ca),_.LFG(_.z2F))},X.\u0275prov=_.Yz7({token:X,factory:X.\u0275fac}),X})()},{provide:_.FYo,useFactory:function Bl(X,M,S){return new xs(X,M,S)},deps:[w.se,ls,_.R0b]}],ol=[{provide:ni,useFactory:()=>new Q},{provide:_.QbO,useValue:"BrowserAnimations"},...js],sl=[{provide:ni,useClass:Rn},{provide:_.QbO,useValue:"NoopAnimations"},...js];let Wa=(()=>{class X{static withConfig(S){return{ngModule:X,providers:S.disableAnimations?sl:ol}}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275mod=_.oAB({type:X}),X.\u0275inj=_.cJS({providers:ol,imports:[w.b2]}),X})();var Xo=B(9197);let al=(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-avisopriv"]],decls:326,vars:0,consts:[[1,"migas"],["routerLink","/inicio"],[1,"fa","fa-angle-right"],["routerLink","/aviso_privacidad"],[1,"container"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","normal","text-align","center"],[2,"font-size","20px","font-family",'"Actor",serif'],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","normal","text-align","justify"],[2,"font-family",'"Actor",serif',"color","#515151","background","white"],[2,"font-family",'"Actor",serif',"color","black","background","white"],[2,"font-family",'"Actor",serif',"color","#515151"],[2,"background","white"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","0cm","line-height","normal","text-align","justify"],[2,"list-style-type","undefined"],[2,"margin-top","0cm","margin-right","0cm","margin-bottom","8.0pt","margin-left","0cm","line-height","107%","font-size","15px","font-family",'"Calibri",sans-serif'],[2,"margin-bottom","0cm","list-style-type","undefined"],[2,"font-family",'"Actor",serif'],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","107%","text-align","justify","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#4472C4"],[2,"font-size","15px","font-family",'"Actor",serif',"color","black","background","white"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","6.75pt","line-height","107%","text-align","justify"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#525252"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#515151","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#4472C4","background","white"],[2,"font-size","15px","font-family",'"Actor",serif',"color","#515151"],[2,"list-style-type","disc","margin-left","26px"],[2,"font-family",'"Actor",serif',"font-size","11.0pt","color","#515151"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","6.75pt","line-height","normal","text-align","justify","background","white"],[2,"font-family",'"Actor",serif',"color","#525252"],[2,"color","blue","text-decoration","underline"],[2,"font-family",'"Actor",serif',"color","black","text-decoration","none"],[2,"font-family",'"Actor",serif',"color","black"],[2,"margin-right","0cm","margin-left","0cm","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","8.0pt","line-height","107%","margin","0cm","text-align","justify","background","white"],[2,"font-family",'"Actor",serif',"font-size","11.0pt","color","#525252"],[2,"margin-right","0cm","margin-left","36.0pt","font-size","15px","font-family",'"Calibri",sans-serif',"margin-top","0cm","margin-bottom","5.0pt","line-height","107%","text-align","justify","vertical-align","baseline"]],template:function(S,$){1&S&&(_._UZ(0,"br")(1,"br"),_.TgZ(2,"div",0)(3,"span")(4,"a",1),_._uU(5,"Inicio "),_.qZA(),_._UZ(6,"i",2),_.TgZ(7,"a",3),_._uU(8," Aviso de Privacidad "),_.qZA()()(),_.TgZ(9,"div",4)(10,"p",5)(11,"span",6),_._uU(12,"Aviso de privacidad:"),_.qZA()(),_.TgZ(13,"p",7)(14,"span",8),_._uU(15,"En El Sistema para el \xe1rea de futbol de la COMUDE, la informaci\xf3n y datos personales de los beneficiarios, colaboradores, asociados, empleados y proveedores, es tratada de forma estrictamente confidencial y con la secrec\xeda necesaria para lograr los fines de la organizaci\xf3n, por lo que hacemos un esfuerzo permanente para salvaguardarla, de conformidad con los art\xedculos 8, 15, 16 y 36 de la Ley Federal de Protecci\xf3n de Datos Personales en Posesi\xf3n de los Particulares."),_.qZA()(),_.TgZ(16,"p",7)(17,"strong")(18,"span",9),_._uU(19,"1._Responsable de Protecci\xf3n de Datos"),_.qZA()()(),_.TgZ(20,"p",7)(21,"span",8),_._uU(22,"En El Sistema para el \xe1rea de futbol de la COMUDE, es una aplicaci\xf3n civil sin fines de lucro, con el fin de optimizar el rendimiento de los encargados de las ligas de futbol de la mejorando sus recursos t\xe9cnicos a la hora de levantar las ligas y su conducta t\xe1ctica. en funci\xf3n del planteamiento t\xe1ctico del juego del equipo, el rol del jugador, las caracter\xedsticas de la competici\xf3n y las condiciones medioambientales, con el objetivo de estructurar adecuadamente los partidos."),_.qZA()(),_.TgZ(23,"p",7)(24,"span",10),_._UZ(25,"br"),_.TgZ(26,"span",11),_._uU(27,"En concordancia con el derecho a la protecci\xf3n de datos personales en posesi\xf3n de particulares consagrado en el art\xedculo 6\xb0 de la Constituci\xf3n Pol\xedtica de los Estados Unidos Mexicanos, as\xed como en cumplimiento a las disposiciones de la Ley Federal de Protecci\xf3n de Datos Personales en Posesi\xf3n de los Particulares, y en base a los principios de licitud, consentimiento, informaci\xf3n, calidad, finalidad, lealtad, proporcionalidad y responsabilidad; El Sistema para el \xe1rea de futbol de la COMUDE, con domicilio en Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo. Es responsable de recabar y proteger los datos personales, as\xed como del uso que se le d\xe9 a los mismos."),_._UZ(28,"br"),_._uU(29,"\xa0"),_.qZA(),_._UZ(30,"br"),_.TgZ(31,"span",11),_._uU(32,"Si el titular de los datos personales no acepta en forma absoluta y completa los t\xe9rminos y condiciones de este aviso, deber\xe1 abstenerse de compartir cualquier tipo de informaci\xf3n por cualquier medio f\xedsico, \xf3ptico y/o electr\xf3nico."),_.qZA()()(),_.TgZ(33,"p",12)(34,"strong")(35,"span",9),_._uU(36,"2._ Datos personales recabados"),_.qZA()()(),_.TgZ(37,"ol",13)(38,"li")(39,"span",10),_._uU(40,"Nombre"),_.qZA()(),_.TgZ(41,"li")(42,"span",10),_._uU(43,"Edad"),_.qZA()(),_.TgZ(44,"li")(45,"span",10),_._uU(46,"Correo electr\xf3nico\xa0"),_.qZA()(),_.TgZ(47,"li")(48,"span",10),_._uU(49,"N\xfamero de tel\xe9fono\xa0"),_.qZA()()(),_.TgZ(50,"p",12)(51,"span",10),_._uU(52,"\xa0"),_.qZA()(),_.TgZ(53,"p",12)(54,"span",10),_._uU(55,"El\xa0"),_.qZA(),_.TgZ(56,"span",8),_._uU(57,"Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(58,"span",10),_._uU(59,", recaba los siguientes datos personales sensibles, ya que forman parte del registro de los jugadores:\xa0"),_.qZA()(),_.TgZ(60,"p",12)(61,"span",10),_._uU(62,"\xa0"),_.qZA()(),_.TgZ(63,"div",14)(64,"ol",15)(65,"li",14)(66,"span",10),_._uU(67,"CURP."),_.qZA()()()(),_.TgZ(68,"p",12)(69,"span",10),_._uU(70,"\xa0"),_.qZA()(),_.TgZ(71,"p",12)(72,"strong")(73,"span",16),_._uU(74,"3._Finalidades:"),_.qZA()()(),_.TgZ(75,"p",7)(76,"span",10),_._uU(77,"Tratamos los datos personales que nos facilitan los interesados con la finalidad de mantener, desarrollar y controlar nuestra relaci\xf3n comercial para el uso de nuestra plataforma web de gesti\xf3n de competiciones y entidades deportivas, lo que incluye la atenci\xf3n a sus consultas o solicitudes de informaci\xf3n o documentaci\xf3n. Dentro de este tratamiento de datos puede incluirse datos relativos a la navegaci\xf3n en nuestra web cuando Ud. act\xfaa como usuario registrado, el uso de esta informaci\xf3n es necesario para poder darle un servicio de soporte adecuado, as\xed como para gestionar posibles incidencias en nuestra p\xe1gina web. Para ello obtenemos y conservamos datos relativos a las partes de la plataforma por la que Ud. navega, el tiempo de conexi\xf3n a la mismas, aquellos lugares donde puedan surgir errores o pueda requerir nuestro soporte. En ning\xfan caso, los datos de navegaci\xf3n se utilizan para generar perfiles, segmentaciones, estudios de mercado, ni para el env\xedo de comunicaciones comerciales ya sean propias o de terceros."),_.qZA()(),_.TgZ(78,"p",7)(79,"span",10),_._uU(80,"Igualmente, los datos facilitados tambi\xe9n ser\xe1n tratados para remitirle informaci\xf3n comercial sobre nuestros bienes y servicios, por correo electr\xf3nico, as\xed como para realizar segmentaciones y/o elaboraci\xf3n de perfiles con id\xe9ntica finalidad, distintos de mercadotecnia interna."),_.qZA()(),_.TgZ(81,"p",7)(82,"span",10),_._uU(83,"\xa0"),_.qZA()(),_.TgZ(84,"p",7)(85,"span",10),_._uU(86,"Igualmente, podemos tratar sus datos como persona de contacto dentro de una organizaci\xf3n o entidad que organiza/gestiona una competici\xf3n deportiva. Esta informaci\xf3n sobre su persona, \xfanicamente la utilizaremos para poder relacionarnos con Ud. como consecuencia de la relaci\xf3n jur\xeddica que nos une con la organizaci\xf3n o entidad cliente de la plataforma. No utilizaremos su informaci\xf3n para ning\xfan tipo de finalidad diferente."),_.qZA()(),_.TgZ(87,"p",7)(88,"span",10),_._uU(89,"\xa0"),_.qZA()(),_.TgZ(90,"p",7)(91,"span",10),_._uU(92,"Si Ud. Lo desea puede subir una imagen en su fotograf\xeda de perfil. Este tratamiento de datos es voluntario y \xfanicamente servir\xe1 para identificarle como usuario en la plataforma."),_.qZA()(),_.TgZ(93,"p",17)(94,"strong")(95,"span",18),_._uU(96,"\xa0"),_.qZA()()(),_.TgZ(97,"p",17)(98,"strong")(99,"span",19),_._uU(100,"4.-Datos personales:"),_.qZA()()(),_.TgZ(101,"p",20)(102,"span",21),_._uU(103,"La base legal para el tratamiento de sus datos es la ejecuci\xf3n de la relaci\xf3n comercial en la que Usted es parte, de manera que podamos gestionar, desarrollar y controlar la correspondiente relaci\xf3n contractual, incluido el tratamiento de su imagen de perfil."),_.qZA()(),_.TgZ(104,"p",20)(105,"span",21),_._uU(106,"En relaci\xf3n con el env\xedo de comunicaciones comerciales, la base legal es el consentimiento que se le solicita y Usted otorga libremente. En caso de no obtener el consentimiento"),_.qZA(),_.TgZ(107,"span",22),_._uU(108,"\xa0El Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(109,"span",21),_._uU(110,"\xa0se compromete a no realizarle env\xedos de comunicaciones comerciales fuera del \xe1mbito de la relaci\xf3n contractual."),_.qZA()(),_.TgZ(111,"p",20)(112,"span",21),_._uU(113,"Igualmente podremos tratar sus datos como persona de contacto de una organizaci\xf3n o entidad que organiza/gestiona competiciones deportivas con base al inter\xe9s leg\xedtimo de\xa0"),_.qZA(),_.TgZ(114,"span",22),_._uU(115,"El Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(116,"span",21),_._uU(117,"."),_.qZA()(),_.TgZ(118,"p",20)(119,"strong")(120,"span",23),_._UZ(121,"br"),_._uU(122,"\xa0"),_.qZA()(),_.TgZ(123,"span",22),_._uU(124,"El Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(125,"span",24),_._uU(126,"\xa0no suministrar\xe1 ning\xfan dato a terceros, excepto cuando exista obligaci\xf3n legal de hacerlo:"),_.qZA()(),_.TgZ(127,"ul",25)(128,"li")(129,"span",26),_._uU(130,"A Jueces y Tribunales, en cumplimiento de requerimientos, obligaciones legales o en el marco de un procedimiento judicial;"),_.qZA()(),_.TgZ(131,"li")(132,"span",26),_._uU(133,"A la Agencia Tributaria, para el cumplimiento de las obligaciones fiscales;"),_.qZA()(),_.TgZ(134,"li")(135,"span",26),_._uU(136,"A Auditores Financieros para el cumplimiento de las obligaciones financieras;"),_.qZA()()(),_.TgZ(137,"p",17)(138,"span",24),_._uU(139,"y a cualesquiera otros terceros a quienes, en virtud de la normativa vigente aplicable en cada caso, sea necesario llevar a cabo la cesi\xf3n, tal como \xf3rganos de la Administraci\xf3n competentes por motivos de control, registro e inspecci\xf3n."),_.qZA()(),_.TgZ(140,"p",17)(141,"span",24),_._uU(142,"No obstante, si en alg\xfan momento de la relaci\xf3n comercial fuera necesario comunicar sus datos a terceros, dicha comunicaci\xf3n se realizar\xe1 cuando\xa0"),_.qZA(),_.TgZ(143,"span",8),_._uU(144,"E"),_.qZA(),_.TgZ(145,"span",22),_._uU(146,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(147,"span",24),_._uU(148,"\xa0cuente con su consentimiento previo para ello y en la forma legalmente exigida."),_.qZA(),_.TgZ(149,"strong")(150,"span",23),_._UZ(151,"br"),_._uU(152,"\xa0"),_.qZA()(),_.TgZ(153,"span",21),_._UZ(154,"br"),_._uU(155,"\xa0"),_.qZA()(),_.TgZ(156,"p",7)(157,"strong")(158,"span",9),_._uU(159,"5._ Medios para ejercer los derechos de acceso, rectificaci\xf3n, cancelaci\xf3n y oposici\xf3n"),_.qZA()()(),_.TgZ(160,"p",27)(161,"span",28),_._uU(162,"Usted tendr\xe1 el derecho, en todo momento, de acceder a sus datos personales, rectificarlos en caso de que \xe9stos sean inexactos o est\xe9n incompletos; instruirnos a cancelarlos cuando considere que son excesivos o innecesarios para las finalidades que justificaron su obtenci\xf3n o haya finalizado la relaci\xf3n contractual; as\xed como a oponerse por causa leg\xedtima al tratamiento de sus datos personales."),_.qZA()(),_.TgZ(163,"p",27)(164,"span",28),_._uU(165,"A efecto de ejercer los derechos de acceso, rectificaci\xf3n, cancelaci\xf3n y oposici\xf3n (los \u201cDerechos"),_.qZA(),_.TgZ(166,"span",29)(167,"span",30),_._uU(168,"\xa0"),_.qZA()(),_.TgZ(169,"span",28),_._uU(170,"ARCO\u201d) antes referidos, se deber\xe1 enviar la solicitud respectiva a nuestra al responsable de Privacidad a la siguiente direcci\xf3n de correo electr\xf3nico:\xa0comude@gmail.com"),_.qZA()(),_.TgZ(171,"p",27)(172,"span",28),_._uU(173,"En este sentido, puede informarse sobre los procedimientos, requisitos y plazos para el ejercicio de sus Derechos ARCO y/o revocaci\xf3n del consentimiento en nuestra p\xe1gina de internet"),_.qZA(),_.TgZ(174,"span",31),_._uU(175,"\xa0"),_.qZA(),_.TgZ(176,"span",28),_._uU(177,"http://ecomude.com"),_.qZA()(),_.TgZ(178,"p",7)(179,"strong")(180,"span",9),_._uU(181,"6._ Procedimiento ARCO y revocaci\xf3n del consentimiento."),_.qZA()()(),_.TgZ(182,"p",17)(183,"span",21),_._uU(184,"Para el ejercicio de sus Derechos ARCO y/o la revocaci\xf3n de su consentimiento para el tratamiento de sus datos personales por\xa0"),_.qZA(),_.TgZ(185,"span",8),_._uU(186,"E"),_.qZA(),_.TgZ(187,"span",22),_._uU(188,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(189,"span",21),_._uU(190,", agradeceremos presente una solicitud (\u201cSolicitud de Ejercicio de Derechos ARCO\u201d), al correo electr\xf3nico comude@gmail.com, acompa\xf1ando la siguiente informaci\xf3n:"),_.qZA()(),_.TgZ(191,"p",7)(192,"span",28),_._uU(193,"1. Nombre y datos de contacto como domicilio completo (calle, n\xfamero interior y/o exterior, colonia, c\xf3digo postal, ciudad y estado) y/o correo electr\xf3nico;"),_._UZ(194,"br"),_._uU(195,"\xa02. Identificaci\xf3n con la que acredite su personalidad (credencial para votar, pasaporte vigente, c\xe9dula profesional o documento migratorio)."),_._UZ(196,"br"),_._uU(197,"\xa03. En caso de no ser el titular quien presente la solicitud, el documento que acredite la existencia de la representaci\xf3n, es decir, instrumento p\xfablico o carta poder firmada ante dos testigos, junto con identificaci\xf3n del titular, del representante y de los testigos (credencial para votar, pasaporte vigente, c\xe9dula profesional o documento migratorio)."),_.qZA(),_.TgZ(198,"span",10),_._UZ(199,"br"),_._uU(200,"\xa0"),_.qZA()(),_.TgZ(201,"p",32)(202,"span",21),_._uU(203,"El Comit\xe9 de privacidad\xa0"),_.qZA(),_.TgZ(204,"span",8),_._uU(205,"E"),_.qZA(),_.TgZ(206,"span",22),_._uU(207,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(208,"span",21),_._uU(209,"\xa0tiene a su disposici\xf3n los formatos que se recomiendan para el ejercicio de Derechos ARCO, por lo que el correspondiente a su petici\xf3n se le proporcionar\xe1 al momento en que Usted lo solicite al Comit\xe9, por cualquier medio. El Comit\xe9 responder\xe1 su Solicitud mediante el correo electr\xf3nico\xa0"),_.qZA(),_.TgZ(210,"span",21),_._uU(211,"comude@gmail.com o personalmente,"),_.qZA(),_.TgZ(212,"span",22),_._uU(213,"\xa0Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo.\xa0"),_.qZA(),_.TgZ(214,"span",21),_._uU(215,"Conforme a la Ley, se cuenta con un t\xe9rmino de 20 (veinte) d\xedas h\xe1biles contados a partir de su solicitud, para informarle si su solicitud es procedente y, en caso de serlo, se cuenta con 15 (quince) d\xedas h\xe1biles para hacer efectivo el Derecho ARCO. Las respuestas podr\xe1n enviarse v\xeda correo electr\xf3nico o entregarse de forma personal. El Comit\xe9 de privacidad del"),_.qZA(),_.TgZ(216,"span",22),_._uU(217,"\xa0Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(218,"span",21),_._uU(219,"\xa0podr\xe1 solicitarle informaci\xf3n o documentaci\xf3n adicional, as\xed como el cotejo de los documentos que sustentan su solicitud, dentro de los cinco (5) d\xedas h\xe1biles siguientes a que la haya recibido y, en caso de que no haya respuesta a dicha petici\xf3n dentro de los 10 (diez) d\xedas h\xe1biles siguientes a que se haya emitido, se tendr\xe1 por no presentada la solicitud."),_._UZ(220,"br"),_._uU(221,"\xa0Para hacer efectivo el Derecho ARCO, el plazo podr\xe1 prorrogarse una sola vez por un periodo igual en caso de ser necesario, lo cual se har\xe1 de su conocimiento."),_._UZ(222,"br"),_._uU(223,"\xa0"),_.qZA(),_.TgZ(224,"span",8),_._uU(225,"E"),_.qZA(),_.TgZ(226,"span",22),_._uU(227,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(228,"span",21),_._uU(229,"\xa0podr\xe1 negar el ejercicio de los Derechos ARCO, en los siguientes supuestos:"),_._UZ(230,"br"),_._uU(231,"\xa0\u2013 Cuando el solicitante no sea el titular de los datos personales, o no pueda acreditar la representaci\xf3n del titular;"),_._UZ(232,"br"),_._uU(233,"\xa0\u2013 Cuando sus datos personales no obren en la base de datos del"),_.qZA(),_.TgZ(234,"span",22),_._uU(235,"\xa0Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(236,"span",21),_._uU(237,";"),_._UZ(238,"br"),_._uU(239,"\xa0\u2013 Cuando se lesionen los derechos de un tercero;"),_._UZ(240,"br"),_._uU(241,"\xa0\u2013 Cuando exista un impedimento legal o la resoluci\xf3n de una autoridad competente, que restrinja sus Derechos ARCO;"),_._UZ(242,"br"),_._uU(243,"\xa0\u2013 En caso de cancelaci\xf3n, cuando los datos personales sean objeto de tratamiento para la prevenci\xf3n o para el diagn\xf3stico m\xe9dico o la gesti\xf3n de servicios de salud; y,"),_._UZ(244,"br"),_._uU(245,"\xa0\u2013 Cuando la rectificaci\xf3n, cancelaci\xf3n u oposici\xf3n haya sido previamente realizada."),_._UZ(246,"br"),_._uU(247,"\xa0La Negativa podr\xe1 ser parcial, en cuyo caso el\xa0"),_.qZA(),_.TgZ(248,"span",22),_._uU(249,"Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(250,"span",21),_._uU(251,"\xa0efectuara\u0301 el acceso, rectificaci\xf3n, cancelaci\xf3n u oposici\xf3n en la parte procedente."),_._UZ(252,"br"),_._uU(253,"\xa0El ejercicio de los \u201cDerechos ARCO\u201d ser\xe1 gratuito, pero en caso de que en un periodo menor a doce meses se presenten dos solicitudes o m\xe1s, el Centro M\xe9dico podr\xe1 realizar cobros por la emisi\xf3n de copias de documentos. En caso de que el Solicitante requiera de la certificaci\xf3n de documentos, deber\xe1 hacer previamente el pago correspondiente conforme a las indicaciones que al efecto se le den a conocer. El solicitante deber\xe1 cubrir los gastos justificados de env\xedo o el costo de reproducci\xf3n en copias u otros formatos."),_.qZA()(),_.TgZ(254,"p",7)(255,"span",28),_._uU(256,"\xa0"),_.qZA()(),_.TgZ(257,"p",7)(258,"strong")(259,"span",9),_._uU(260,"7._ Cookies y Beacons."),_.qZA()()(),_.TgZ(261,"p",17)(262,"span",8),_._uU(263,"E"),_.qZA(),_.TgZ(264,"span",22),_._uU(265,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(266,"span",21),_._uU(267,"\xa0le informa que sus aplicaciones y/o sitio web, utilizan cookies, web beacons y otras tecnolog\xedas a trav\xe9s de las cuales es posible monitorear el comportamiento del Titular como usuario de Internet, con la finalidad de brindar un mejor servicio y/o experiencia al Titular al navegar en las mismas."),_._UZ(268,"br"),_._uU(269,"\xa0Los Datos Personales que se podr\xe1n obtener de Usted, de manera enunciativa m\xe1s no limitativa, son los siguientes:"),_._UZ(270,"br"),_._uU(271,"\xa0"),_.qZA()(),_.TgZ(272,"ul",25)(273,"li")(274,"span",33),_._uU(275,"Datos Generales,"),_.qZA()(),_.TgZ(276,"li")(277,"span",33),_._uU(278,"Datos de Contacto,"),_.qZA()(),_.TgZ(279,"li")(280,"span",33),_._uU(281,"Horario y Tiempo de Navegaci\xf3n,"),_.qZA()(),_.TgZ(282,"li")(283,"span",33),_._uU(284,"Sitios web y Secciones consultadas, y;"),_.qZA()(),_.TgZ(285,"li")(286,"span",33),_._uU(287,"Ubicaci\xf3n."),_.qZA()()(),_.TgZ(288,"p",34)(289,"span",21),_._uU(290,"\xa0"),_.qZA()(),_.TgZ(291,"p",7)(292,"strong")(293,"span",9),_._uU(294,"8._ Cambios al aviso de privacidad para empleados."),_.qZA()()(),_.TgZ(295,"p",32)(296,"span",21),_._uU(297,"El presente Aviso de Privacidad podr\xe1 sufrir modificaciones para cumplir con requerimientos legales o con disposiciones internas de\xa0"),_.qZA(),_.TgZ(298,"span",8),_._uU(299,"E"),_.qZA(),_.TgZ(300,"span",22),_._uU(301,"l Sistema para el \xe1rea de futbol de la COMUDE"),_.qZA(),_.TgZ(302,"span",21),_._uU(303,", por lo que nos comprometemos a poner a su disposici\xf3n en nuestra app."),_.qZA()(),_.TgZ(304,"p",7)(305,"span",28),_._uU(306,"\xa0"),_.qZA()(),_.TgZ(307,"p",7)(308,"strong")(309,"span",9),_._uU(310,"9._ Consentimiento."),_.qZA()()(),_.TgZ(311,"p",32)(312,"span",21),_._uU(313,"En caso de que Usted desee revocar o negar su consentimiento para que sus datos personales sean usados para las finalidades secundarias, le solicitamos nos lo haga saber a trav\xe9s del correo electr\xf3nico\xa0"),_.qZA(),_.TgZ(314,"span",21),_._uU(315,"comude@gmail.com,"),_.qZA(),_.TgZ(316,"span",21),_._uU(317,"\xa0dentro de un plazo de cinco d\xedas h\xe1biles."),_._UZ(318,"br"),_._uU(319,"\xa0"),_.qZA()(),_.TgZ(320,"p",32)(321,"span",21),_._uU(322,"Fecha de actualizaci\xf3n: Octubre, 2022."),_.qZA()()(),_._UZ(323,"br")(324,"br")(325,"br"))},dependencies:[Xo.yS],encapsulation:2}),X})();var Ia=B(2311);let vc=(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-carrusel"]],decls:16,vars:0,consts:[["id","carouselExampleControls","data-bs-ride","carousel",1,"carousel","slide"],[1,"carousel-inner","bgsec"],[1,"carousel-item","active"],["src","../../../assets/c5.jpg","alt","...",1,"d-block","w-100"],["type","button","data-bs-target","#carouselExampleControls","data-bs-slide","prev",1,"carousel-control-prev"],["aria-hidden","true",1,"carousel-control-prev-icon"],[1,"visually-hidden"],["type","button","data-bs-target","#carouselExampleControls","data-bs-slide","next",1,"carousel-control-next"],["aria-hidden","true",1,"carousel-control-next-icon"]],template:function(S,$){1&S&&(_.TgZ(0,"div",0)(1,"div",1)(2,"div",2),_._UZ(3,"img",3),_.qZA(),_.TgZ(4,"div",2),_._UZ(5,"img",3),_.qZA(),_.TgZ(6,"div",2),_._UZ(7,"img",3),_.qZA()(),_.TgZ(8,"button",4),_._UZ(9,"span",5),_.TgZ(10,"span",6),_._uU(11,"Previous"),_.qZA()(),_.TgZ(12,"button",7),_._UZ(13,"span",8),_.TgZ(14,"span",6),_._uU(15,"Next"),_.qZA()()())},encapsulation:2}),X})(),zl=(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-galeria"]],decls:26,vars:0,consts:[[1,"con"],[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"intento"],[1,"row"],[1,"col-lg-4","col-md-12","mb-4","mb-lg-0"],["data-ripple-color","light",1,"bg-image","hover-overlay","ripple","shadow-1-strong","rounded"],["src","../../../assets/gale1.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal1"],[1,"mask",2,"background-color","rgba(251, 251, 251, 0.2)"],[1,"col-lg-4","mb-4","mb-lg-0"],["src","../../../assets/gale2.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal2"],["src","../../../assets/gale3.jpg",1,"w-100","img-thumbnail"],["href","#!","data-mdb-toggle","modal","data-mdb-target","#exampleModal3"]],template:function(S,$){1&S&&(_.TgZ(0,"div",0)(1,"header",1)(2,"div",2)(3,"h1",3),_._uU(4,"Galeria"),_.qZA()()(),_.TgZ(5,"section",2),_._UZ(6,"br"),_.TgZ(7,"section",4)(8,"div",5)(9,"div",6)(10,"div",7),_._UZ(11,"img",8),_.TgZ(12,"a",9),_._UZ(13,"div",10),_.qZA()()(),_.TgZ(14,"div",11)(15,"div",7),_._UZ(16,"img",12),_.TgZ(17,"a",13),_._UZ(18,"div",10),_.qZA()()(),_.TgZ(19,"div",11)(20,"div",7),_._UZ(21,"img",14),_.TgZ(22,"a",15),_._UZ(23,"div",10),_.qZA()()()()()(),_._UZ(24,"br")(25,"br"),_.qZA())},styles:[".tigal[_ngcontent-%COMP%]{text-align:center}.con[_ngcontent-%COMP%]{background-color:#dfd2b0}.row[_ngcontent-%COMP%]{align-items:center}"]}),X})();var z=B(7392);let re=(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-correo"]],decls:39,vars:0,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"row","px-3"],[1,"col-lg-10","col-xl-9","card","flex-row","mx-auto","px-0"],[1,"card-body"],[1,"card-title"],["action",""],[1,"form-floating","mb-3"],["id","nombre","type","text","name","matricula","placeholder","nombre",1,"form-control"],["for","inputFirstName",1,"flex"],["id","correo","type","email","name","correo","placeholder","Correo",1,"form-control"],["id","asunto","type","text","name","asunto","placeholder","Asunto",1,"form-control"],["name","mensaje","id","mensaje","cols","30","rows","10","placeholder","Mensaje",1,"form-control"],[1,"envcor"],[1,"btn","btn-primary","flex"]],template:function(S,$){1&S&&(_.TgZ(0,"header",0)(1,"div",1)(2,"h1",2),_._uU(3,"Dejanos una sugerencia"),_.qZA()()(),_.TgZ(4,"div",1)(5,"div",3)(6,"div",4)(7,"div",5),_._UZ(8,"h1",6),_.TgZ(9,"form",7)(10,"div",8),_._UZ(11,"input",9),_.TgZ(12,"label",10)(13,"mat-icon"),_._uU(14,"person"),_.qZA(),_._uU(15,"Nombre"),_.qZA()(),_.TgZ(16,"div",8),_._UZ(17,"input",11),_.TgZ(18,"label",10)(19,"mat-icon"),_._uU(20,"mail"),_.qZA(),_._uU(21,"Correo"),_.qZA()(),_.TgZ(22,"div",8),_._UZ(23,"input",12),_.TgZ(24,"label",10)(25,"mat-icon"),_._uU(26,"inbox"),_.qZA(),_._uU(27,"Asunto"),_.qZA()(),_.TgZ(28,"div",8),_._UZ(29,"textarea",13),_.TgZ(30,"label",10)(31,"mat-icon"),_._uU(32,"chat_bubble"),_.qZA(),_._uU(33,"Mensaje"),_.qZA()(),_.TgZ(34,"div",14)(35,"button",15),_._uU(36," Enviar "),_.TgZ(37,"mat-icon"),_._uU(38,"send"),_.qZA()()()()()()()())},dependencies:[z.Hw],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%;font-size:18px}.envcor[_ngcontent-%COMP%]{display:flex;justify-content:space-around}mat-icon[_ngcontent-%COMP%]{font-size:20px}.card-title[_ngcontent-%COMP%]{text-align:center}.flex[_ngcontent-%COMP%]{display:flex}"]}),X})();var G=B(646);const ye=function(X){return["/ligas",X]};let yt=(()=>{class X{}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-liga-tarjetas"]],inputs:{liga:"liga"},decls:12,vars:11,consts:[[1,"card-deck","mt-3"],[1,"card","text-center"],[1,"logo-liga",3,"src"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-primary","mx-2",3,"routerLink"]],template:function(S,$){1&S&&(_.TgZ(0,"div",0)(1,"div",1),_._UZ(2,"img",2),_.ALo(3,"imagen"),_.TgZ(4,"div",3)(5,"h4",4),_._uU(6),_.ALo(7,"titlecase"),_.qZA(),_.TgZ(8,"p",5),_._uU(9),_.qZA(),_.TgZ(10,"a",6),_._uU(11,"Entrar"),_.qZA()()()()),2&S&&(_.xp6(2),_.Q6J("src",_.xi3(3,4,$.liga.img,"ligas"),_.LSH),_.xp6(4),_.Oqu(_.lcZ(7,7,$.liga.nombre)),_.xp6(3),_.hij(" ",$.liga.descripcion,""),_.xp6(1),_.Q6J("routerLink",_.VKq(9,ye,$.liga._id)))},dependencies:[Xo.yS,q.rS,G.$],encapsulation:2}),X})();function vn(X,M){if(1&X&&(_.TgZ(0,"div",5)(1,"div",6),_._UZ(2,"img",7),_.TgZ(3,"div",8)(4,"h3",9),_._uU(5),_.qZA(),_.TgZ(6,"div",10),_._uU(7),_.qZA(),_.TgZ(8,"div",10),_._uU(9),_.qZA()()()()),2&X){const S=M.$implicit;_.xp6(2),_.s9C("src",S.image,_.LSH),_.xp6(3),_.Oqu(S.nombre),_.xp6(2),_.Oqu(S.roll),_.xp6(2),_.Oqu(S.roll2)}}let On=(()=>{class X{constructor(){this.equipo=[{nombre:"Fernando Vega",roll:"Dise\xf1ador",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/fer.jpg"},{nombre:"Denisse San Juan",roll:"Documentadora",roll2:"Analista de datos",image:"../../../assets/fotos EQUIPO/dennise.jpg"},{nombre:"Gustavo Trejo",roll:"Tester",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/trejo.jpg"},{nombre:"Jorge Flores ",roll:"Analista",roll2:"Desarrollador",image:"../../../assets/fotos EQUIPO/jorge.jpg"}]}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-team"]],decls:7,vars:1,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"row"],["class","col-xl-3 col-md-6 mb-4",4,"ngFor","ngForOf"],[1,"col-xl-3","col-md-6","mb-4"],[1,"card","border-0","shadow"],["alt","...",1,"card-img-top",3,"src"],[1,"card-body","text-center"],[1,"card-title","mb-0"],[1,"card-text","text-black-50"]],template:function(S,$){1&S&&(_.TgZ(0,"header",0)(1,"div",1)(2,"h1",2),_._uU(3,"Equipo de desarrollo"),_.qZA()()(),_.TgZ(4,"div",1)(5,"div",3),_.YNc(6,vn,10,4,"div",4),_.qZA()()),2&S&&(_.xp6(6),_.Q6J("ngForOf",$.equipo))},dependencies:[q.sg],encapsulation:2}),X})();function yi(X,M){if(1&X&&(_.TgZ(0,"div"),_._UZ(1,"app-liga-tarjetas",5),_.qZA()),2&X){const S=M.$implicit;_.xp6(1),_.Q6J("liga",S)}}let mr=(()=>{class X{constructor(S){this.ligasService=S,this.ligas=[]}ngOnInit(){this.ligasService.smallgetLigas().subscribe(S=>this.ligas=S)}}return X.\u0275fac=function(S){return new(S||X)(_.Y36(Ia.O))},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-inicio"]],decls:16,vars:1,consts:[[1,"bg","text-center","py-5","mb-4"],[1,"container"],[1,"fw-light","text-white"],[1,"grid"],[4,"ngFor","ngForOf"],[3,"liga"]],template:function(S,$){1&S&&(_._UZ(0,"app-carrusel"),_.TgZ(1,"header",0)(2,"div",1)(3,"h1",2),_._uU(4,"Ligas"),_.qZA()()(),_.TgZ(5,"div",1)(6,"div",3),_.YNc(7,yi,2,1,"div",4),_.qZA()(),_._UZ(8,"br")(9,"app-galeria")(10,"app-team")(11,"br")(12,"app-correo")(13,"br")(14,"br")(15,"br")),2&S&&(_.xp6(7),_.Q6J("ngForOf",$.ligas))},dependencies:[q.sg,vc,zl,re,yt,On],styles:[".grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1rem}"]}),X})();const xr=[{path:"auth",loadChildren:()=>Promise.all([B.e(226),B.e(324)]).then(B.bind(B,324)).then(X=>X.AuthModule)},{path:"gestor",loadChildren:()=>Promise.all([B.e(226),B.e(849)]).then(B.bind(B,2849)).then(X=>X.GestorModule)},{path:"ligas",loadChildren:()=>B.e(926).then(B.bind(B,1926)).then(X=>X.LigasModule)},{path:"inicio",component:mr,pathMatch:"full"},{path:"jugador",component:(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-jugador"]],decls:2,vars:0,template:function(S,$){1&S&&(_.TgZ(0,"p"),_._uU(1,"jugador works!"),_.qZA())}}),X})()},{path:"aviso_privacidad",component:al},{path:"404",component:(()=>{class X{constructor(){}ngOnInit(){}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-error-page"]],decls:9,vars:0,consts:[[1,"bgsec"],["routerLink","/inicio","src","../../../assets/mensajeerror.png","alt","",1,"d-block",2,"display","block","margin-left","auto","margin-right","auto","width","750px"]],template:function(S,$){1&S&&(_.TgZ(0,"body",0),_._UZ(1,"br")(2,"br")(3,"br"),_.TgZ(4,"a"),_._UZ(5,"img",1),_.qZA(),_._UZ(6,"br")(7,"br")(8,"br"),_.qZA())},dependencies:[Xo.rH],encapsulation:2}),X})()},{path:"",component:mr},{path:"**",redirectTo:"404"}];let yo=(()=>{class X{}return X.\u0275fac=function(S){return new(S||X)},X.\u0275mod=_.oAB({type:X}),X.\u0275inj=_.cJS({imports:[Xo.Bz.forRoot(xr),Xo.Bz]}),X})();var Ir=B(2340),eo=B(9898);const Wo=["mapa"];let cs=(()=>{class X{constructor(){this.lngLat=[0,0]}ngAfterViewInit(){const S=new eo.Map({container:this.divMapa.nativeElement,style:"mapbox://styles/mapbox/streets-v11",center:this.lngLat,zoom:15});(new eo.Marker).setLngLat(this.lngLat).addTo(S)}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-mini-mapa"]],viewQuery:function(S,$){if(1&S&&_.Gf(Wo,5),2&S){let ue;_.iGM(ue=_.CRH())&&($.divMapa=ue.first)}},inputs:{lngLat:"lngLat"},decls:2,vars:0,consts:[["mapa",""]],template:function(S,$){1&S&&_._UZ(0,"div",null,0)},styles:["div[_ngcontent-%COMP%]{width:100%;height:150px;margin:0}"]}),X})();function Qs(X,M){if(1&X&&(_.TgZ(0,"div",11),_._UZ(1,"app-mini-mapa",12),_.TgZ(2,"div",13)(3,"h5",14),_._uU(4),_.qZA(),_.TgZ(5,"p",15),_._uU(6),_.qZA()()()),2&X){const S=M.$implicit;_.xp6(1),_.Q6J("lngLat",S.lngLat),_.xp6(3),_.hij(" ",S.titulo,""),_.xp6(2),_.Oqu(S.descripcion)}}let Hs=(()=>{class X{constructor(){this.propiedades=[{titulo:"Presidencia municipal, Huejutla",descripcion:"Pl. de la Revoluci\xf3n Mexicana SN, Centro, 43000 Huejutla, Hgo.",lngLat:[-98.42047711680699,21.139670643115895]}]}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-footer"]],decls:30,vars:1,consts:[[1,"pie-pagina","bg"],[1,"grupo-1"],[1,"box"],["href","#"],["src","../../../assets/lgn.png","alt","Logo de SLee Dw"],[1,"red-social"],["href","https://www.facebook.com/presidenciahuejutla2024","target","_blank",1,"fa","fa-facebook"],["href","https://www.instagram.com/?hl=es-la","target","_blank",1,"fa","fa-instagram"],["href","https://www.facebook.com/presidenciahuejutla2024","target","_blank",1,"fa","fa-whatsapp"],["class","card mapita",4,"ngFor","ngForOf"],[1,"grupo-2"],[1,"card","mapita"],[1,"card-img-top",3,"lngLat"],[1,"card-body"],[1,"card-title"],[1,"card-text","direc"]],template:function(S,$){1&S&&(_.TgZ(0,"footer",0)(1,"div",1)(2,"div",2)(3,"figure")(4,"a",3),_._UZ(5,"img",4),_.qZA()()(),_.TgZ(6,"div",2)(7,"h2"),_._uU(8,"SOBRE NOSOTROS"),_.qZA(),_.TgZ(9,"p"),_._uU(10,"SOLF es un sistema la cual funcionara para la organizacion de ligas de futbol"),_.qZA(),_.TgZ(11,"p"),_._uU(12,"Contamos con una gran experiencia y sabemos lo que necesita una organizacion"),_.qZA()(),_.TgZ(13,"div",2)(14,"h2"),_._uU(15,"Nuestras Redes Solciales"),_.qZA(),_.TgZ(16,"div",5),_._UZ(17,"a",6)(18,"a",7)(19,"a",8),_.qZA(),_.TgZ(20,"h2"),_._uU(21,"Ubicaciones de oficinas"),_.qZA(),_.TgZ(22,"div",5),_.YNc(23,Qs,7,3,"div",9),_.qZA()()(),_.TgZ(24,"div",10)(25,"small"),_._uU(26,"\xa9 2022 "),_.TgZ(27,"b"),_._uU(28,"SOLF"),_.qZA(),_._uU(29," - Todos los Derechos Reservados."),_.qZA()()()),2&S&&(_.xp6(23),_.Q6J("ngForOf",$.propiedades))},dependencies:[q.sg,cs],styles:[".pie-pagina[_ngcontent-%COMP%]{width:100%}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:auto;display:grid;grid-template-columns:repeat(3,1fr);grid-gap:50px;padding:45px 0}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;text-decoration:none}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#fff;margin-bottom:25px;font-size:20px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#efefef;margin-bottom:10px}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .red-social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-block;text-decoration:none;width:45px;height:45px;line-height:45px;color:#000;margin-right:10px;background-color:#dfd2b0;text-align:center;transition:all .3s ease}.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]   .red-social[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#521a49}.pie-pagina[_ngcontent-%COMP%]   .grupo-2[_ngcontent-%COMP%]{background-color:#dfd2;padding:15px 10px;text-align:center;color:#fff}.pie-pagina[_ngcontent-%COMP%]   .grupo-2[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:15px}.direc[_ngcontent-%COMP%]{color:#000}@media screen and (max-width:800px){.pie-pagina[_ngcontent-%COMP%]   .grupo-1[_ngcontent-%COMP%]{width:90%;grid-template-columns:repeat(1,1fr);grid-gap:30px;padding:35px 0}}"]}),X})();var Qo=B(1572);function No(X,M){1&X&&(_.TgZ(0,"li",13)(1,"a",18),_._uU(2," Usuario "),_.qZA(),_.TgZ(3,"ul",19)(4,"li")(5,"a",20),_._uU(6,"Inicio de sesion"),_.qZA()(),_.TgZ(7,"li")(8,"a",21),_._uU(9,"Registro"),_.qZA()()()())}function qa(X,M){if(1&X){const S=_.EpF();_.TgZ(0,"li",13)(1,"a",18),_._uU(2," Cuenta "),_.qZA(),_.TgZ(3,"ul",19)(4,"li")(5,"a",22),_._uU(6,"Inicio"),_.qZA()(),_.TgZ(7,"li")(8,"a",23),_.NdJ("click",function(){_.CHM(S);const ue=_.oxw();return _.KtG(ue.logout())}),_._uU(9,"Cerrar sesion"),_.qZA()()()()}}let Vc=(()=>{class X{constructor(S,$){this.usuarioService=S,this.router=$}ngOnInit(){}hayToken(){return 0!==this.usuarioService.token.length}logout(){this.usuarioService.logout(),this.router.navigateByUrl("/auth/login")}}return X.\u0275fac=function(S){return new(S||X)(_.Y36(Qo.i),_.Y36(Xo.F0))},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-navbar"]],decls:26,vars:2,consts:[["id","headerNav",1,"navbar","navbar-expand-lg","navbar-dark","p-3","bg"],[1,"container-fluid"],["href","#",1,"navbar-brand","d-block","d-lg-none"],["src","../../../../assets/lgn.png","height","80"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown","aria-controls","navbarNavDropdown","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNavDropdown",1,"collapse","navbar-collapse"],[1,"navbar-nav","mx-auto"],[1,"nav-item"],["aria-current","page","routerLink","/inicio","routerLinkActive","active",1,"nav-link","mx-2"],["routerLink","/ligas/listadoLigas","routerLinkActive","active",1,"nav-link","mx-2"],[1,"nav-item","d-none","d-lg-block"],["href","/inicio",1,"nav-link","mx-2"],[1,"nav-item","dropdown"],["href","#","id","navbarDropdownMenuLink1","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","mx-2","dropdown-toggle"],["aria-labelledby","navbarDropdownMenuLink1",1,"dropdown-menu","bgnav"],["routerLink","../aviso_privacidad","routerLinkActive","selec",1,"dropdown-item"],["class","nav-item dropdown",4,"ngIf"],["href","#","id","navbarDropdownMenuLink","role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","mx-2","dropdown-toggle"],["aria-labelledby","navbarDropdownMenuLink",1,"dropdown-menu","bgnav"],["routerLink","/auth/login","routerLinkActive","selec",1,"dropdown-item"],["routerLink","/auth/registro","routerLinkActive","selec",1,"dropdown-item"],["routerLink","/gestor/inicio","routerLinkActive","selec",1,"dropdown-item"],[1,"dropdown-item","cursor",3,"click"]],template:function(S,$){1&S&&(_.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),_._UZ(3,"img",3),_.qZA(),_.TgZ(4,"button",4),_._UZ(5,"span",5),_.qZA(),_.TgZ(6,"div",6)(7,"ul",7)(8,"li",8)(9,"a",9),_._uU(10,"Inicio"),_.qZA()(),_.TgZ(11,"li",8)(12,"a",10),_._uU(13,"Ligas"),_.qZA()(),_.TgZ(14,"li",11)(15,"a",12),_._UZ(16,"img",3),_.qZA()(),_.TgZ(17,"li",13)(18,"a",14),_._uU(19," Acerca de "),_.qZA(),_.TgZ(20,"ul",15)(21,"li")(22,"a",16),_._uU(23,"Aviso de privacidad"),_.qZA()()()(),_.YNc(24,No,10,0,"li",17),_.YNc(25,qa,10,0,"li",17),_.qZA()()()()),2&S&&(_.xp6(24),_.Q6J("ngIf",!$.hayToken()),_.xp6(1),_.Q6J("ngIf",$.hayToken()))},dependencies:[q.O5,Xo.yS,Xo.Od],styles:["*[_ngcontent-%COMP%]{font-size:14pt}@media screen and (min-width:992px){.nav-item[_ngcontent-%COMP%]{line-height:80px}}.nav-link[_ngcontent-%COMP%]:hover{color:#0ff}"]}),X})(),zo=(()=>{class X{constructor(){this.title="solf"}ngOnInit(){eo.accessToken=Ir.N.mapboxToken}}return X.\u0275fac=function(S){return new(S||X)},X.\u0275cmp=_.Xpm({type:X,selectors:[["app-root"]],decls:3,vars:0,template:function(S,$){1&S&&_._UZ(0,"app-navbar")(1,"router-outlet")(2,"app-footer")},dependencies:[Xo.lC,Hs,Vc]}),X})();var Pa=B(9563);let Oa=(()=>{class X{}return X.\u0275fac=function(S){return new(S||X)},X.\u0275mod=_.oAB({type:X}),X.\u0275inj=_.cJS({imports:[q.ez,yo,Xo.Bz,Pa.q]}),X})();var tc=B(5503);let Dr=(()=>{class X{}return X.\u0275fac=function(S){return new(S||X)},X.\u0275mod=_.oAB({type:X}),X.\u0275inj=_.cJS({imports:[q.ez,Oa,yo,tc.D]}),X})(),Ul=(()=>{class X{}return X.\u0275fac=function(S){return new(S||X)},X.\u0275mod=_.oAB({type:X,bootstrap:[zo]}),X.\u0275inj=_.cJS({imports:[pe.JF,w.b2,yo,Oa,Dr,Wa]}),X})();Ir.N.production&&(0,_.G48)(),w.q6().bootstrapModule(Ul).catch(X=>console.error(X))},9898:function(ti){ti.exports=function(){"use strict";var Vt,B,w;function _(a,de){if(Vt)if(B){var ut="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Vt+")(sharedChunk); ("+B+")(sharedChunk); self.onerror = null;",it={};Vt(it),w=de(it),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(w.workerUrl=window.URL.createObjectURL(new Blob([ut],{type:"text/javascript"})))}else B=de;else Vt=de}return _(0,function(a){var de=typeof self<"u"?self:{},ut="2.12.0";let it;const Le={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==it){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{it=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch{it=t}}return it},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ke={supported:!1,testSupport:function(t){!Et&&ft&&(dt?wt(t):rt=t)}};let rt,ft,Et=!1,dt=!1;function wt(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,ft),t.isContextLost())return;ke.supported=!0}catch{}t.deleteTexture(e),Et=!0}de.document&&(ft=de.document.createElement("img"),ft.onload=function(){rt&&wt(rt),rt=null,dt=!0},ft.onerror=function(){Et=!0,rt=null},ft.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tt="01";var Wt=kt;function kt(t,e,n,s){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=s}kt.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,s=0;s<8;s++){var u=this.sampleCurveX(n)-t;if(Math.abs(u)<e)return n;var p=this.sampleCurveDerivativeX(n);if(Math.abs(p)<1e-6)break;n-=u/p}var m=0,v=1;for(n=t,s=0;s<20&&(u=this.sampleCurveX(n),!(Math.abs(u-t)<e));s++)t>u?m=n:v=n,n=.5*(v-m)+m;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var Qe=Hn;function Hn(t,e){this.x=t,this.y=e}Hn.prototype={clone:function(){return new Hn(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),s=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=s,this},_rotateAround:function(t,e){var n=Math.cos(t),s=Math.sin(t),u=e.y+s*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-s*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Hn.convert=function(t){return t instanceof Hn?t:Array.isArray(t)?new Hn(t[0],t[1]):t};const Ln=Math.PI/180,Ye=180/Math.PI;function Ce(t){return t*Ln}function we(t){return t*Ye}const At=[[0,0],[1,0],[1,1],[0,1]];function zt(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Jt(t,e,n,s){const u=new Wt(t,e,n,s);return function(p){return u.solve(p)}}const Cn=Jt(.25,.1,.25,1);function Ke(t,e,n){return Math.min(n,Math.max(e,t))}function Ne(t,e,n){return(n=Ke((n-t)/(e-t),0,1))*n*(3-2*n)}function He(t,e,n){const s=n-e,u=((t-e)%s+s)%s+e;return u===e?n:u}function _t(t,e,n){if(!t.length)return n(null,[]);let s=t.length;const u=new Array(t.length);let p=null;t.forEach((m,v)=>{e(m,(E,C)=>{E&&(p=E),u[v]=C,0==--s&&n(p,u)})})}function Dn(t){const e=[];for(const n in t)e.push(t[n]);return e}function Xt(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}let ii=1;function vi(){return ii++}function wi(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Nn(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Bi(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Jn(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function fn(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Tt(t,e,n){const s={};for(const u in t)s[u]=e.call(n||this,t[u],u,t);return s}function Ge(t,e,n){const s={};for(const u in t)e.call(n||this,t[u],u,t)&&(s[u]=t[u]);return s}function Fe(t){return Array.isArray(t)?t.map(Fe):"object"==typeof t&&t?Tt(t,Fe):t}const ht={};function Xe(t){ht[t]||(typeof console<"u"&&console.warn(t),ht[t]=!0)}function ce(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function ot(t){let e=0;for(let n,s,u=0,p=t.length,m=p-1;u<p;m=u++)n=t[u],s=t[m],e+=(s.x-n.x)*(n.y+s.y);return e}function Se(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function St(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,u,p)=>{const m=u||p;return e[s]=!m||m.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let tn=null;function li(t){if(null==tn){const e=t.navigator?t.navigator.userAgent:null;tn=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return tn}function Wi(t){try{const e=de[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Mn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const ae="mapbox-tiles";let $e,Rt,on=500,jt=50;function Bt(){try{return de.caches}catch{}}function Je(){Bt()&&!$e&&($e=de.caches.open(ae))}function ge(t){const e=t.indexOf("?");if(e<0)return t;const s=function(u){const p=u.indexOf("?");return p>0?u.slice(p+1).split("&"):[]}(t).filter(u=>{const p=u.split("=");return"language"===p[0]||"worldview"===p[0]});return s.length?`${t.slice(0,e)}?${s.join("&")}`:t.slice(0,e)}let fe=1/0;const te={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(te);class nt extends Error{constructor(e,n,s){401===n&&nn(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ht=Se()?()=>self.worker&&self.worker.referrer:()=>("blob:"===de.location.protocol?de.parent:de).location.href,Rn=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Ht())&&!/^\w+:/.test(n))){if(de.fetch&&de.Request&&de.AbortController&&de.Request.prototype.hasOwnProperty("signal"))return function(s,u){const p=new de.AbortController,m=new de.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Ht(),signal:p.signal});let v=!1,E=!1;const C=(R=m.url).indexOf("sku=")>0&&nn(R);var R;"json"===s.type&&m.headers.set("Accept","application/json");const N=(K,J,se)=>{if(E)return;if(K&&"SecurityError"!==K.message&&Xe(K),J&&se)return H(J);const De=Date.now();de.fetch(m).then(We=>{if(We.ok){const gt=C?We.clone():null;return H(We,gt,De)}return u(new nt(We.statusText,We.status,s.url))}).catch(We=>{20!==We.code&&u(new Error(We.message))})},H=(K,J,se)=>{("arrayBuffer"===s.type?K.arrayBuffer():"json"===s.type?K.json():K.text()).then(De=>{E||(J&&se&&function(We,gt,Ze){if(Je(),!$e)return;const at={status:gt.status,statusText:gt.statusText,headers:new de.Headers};gt.headers.forEach((an,en)=>at.headers.set(en,an));const Ct=St(gt.headers.get("Cache-Control")||"");if(Ct["no-store"])return;Ct["max-age"]&&at.headers.set("Expires",new Date(Ze+1e3*Ct["max-age"]).toUTCString());const mt=at.headers.get("Expires");mt&&(new Date(mt).getTime()-Ze<42e4||function(an,en){if(void 0===Rt)try{new Response(new ReadableStream),Rt=!0}catch{Rt=!1}Rt?en(an.body):an.blob().then(en)}(gt,an=>{const en=new de.Response(an,at);Je(),$e&&$e.then(An=>An.put(ge(We.url),en)).catch(An=>Xe(An.message))}))}(m,J,se),v=!0,u(null,De,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(De=>{E||u(new Error(De.message))})};return C?function(K,J){if(Je(),!$e)return J(null);const se=ge(K.url);$e.then(De=>{De.match(se).then(We=>{const gt=function(Ze){if(!Ze)return!1;const at=new Date(Ze.headers.get("Expires")||0),Ct=St(Ze.headers.get("Cache-Control")||"");return at>Date.now()&&!Ct["no-cache"]}(We);De.delete(se),gt&&De.put(se,We.clone()),J(null,We,gt)}).catch(J)}).catch(J)}(m,N):N(null,null),{cancel:()=>{E=!0,v||p.abort()}}}(t,e);if(Se()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(s,u){const p=new de.XMLHttpRequest;p.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(p.responseType="arraybuffer");for(const m in s.headers)p.setRequestHeader(m,s.headers[m]);return"json"===s.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===s.credentials,p.onerror=()=>{u(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){let m=p.response;if("json"===s.type)try{m=JSON.parse(p.response)}catch(v){return u(v)}u(null,m,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else u(new nt(p.statusText,p.status,s.url))},p.send(s.body),{cancel:()=>p.abort()}}(t,e)},ni=function(t,e){return Rn(Xt(t,{type:"arrayBuffer"}),e)};function Oi(t){const e=de.document.createElement("a");return e.href=t,e.protocol===de.document.location.protocol&&e.host===de.document.location.host}const xn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ji,Hi;Ji=[],Hi=0;const un=function(t,e){if(ke.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Hi>=Le.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return Ji.push(p),p}Hi++;let n=!1;const s=()=>{if(!n)for(n=!0,Hi--;Ji.length&&Hi<Le.MAX_PARALLEL_IMAGE_REQUESTS;){const p=Ji.shift(),{requestParameters:m,callback:v,cancelled:E}=p;E||(p.cancel=un(m,v).cancel)}},u=ni(t,(p,m,v,E)=>{s(),p?e(p):m&&(de.createImageBitmap?function(C,R){const N=new de.Blob([new Uint8Array(C)],{type:"image/png"});de.createImageBitmap(N).then(H=>{R(null,H)}).catch(H=>{R(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(C,R)=>e(C,R,v,E)):function(C,R){const N=new de.Image,H=de.URL;N.onload=()=>{R(null,N),H.revokeObjectURL(N.src),N.onload=null,de.requestAnimationFrame(()=>{N.src=xn})},N.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new de.Blob([new Uint8Array(C)],{type:"image/png"});N.src=C.byteLength?H.createObjectURL(K):xn}(m,(C,R)=>e(C,R,v,E)))});return{cancel:()=>{u.cancel(),s()}}},Pt="NO_ACCESS_TOKEN";function lt(t){return 0===t.indexOf("mapbox:")}function nn(t){return Le.API_URL_REGEX.test(t)}function _i(t){return Le.API_CDN_URL_REGEX.test(t)}function Qt(t){return Le.API_STYLE_REGEX.test(t)&&!xt(t)}function xt(t){return Le.API_SPRITE_REGEX.test(t)}const pt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Yt(t){const e=t.match(pt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function bn(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function ri(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(de.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ee{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=ri(Le.ACCESS_TOKEN);let s="";return s=n&&n.u?de.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(u,p)=>String.fromCharCode(Number("0x"+p)))):Le.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=Wi("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const u=de.localStorage.getItem(n);u&&(this.eventData=JSON.parse(u));const p=de.localStorage.getItem(s);p&&(this.anonId=p)}catch{Xe("Unable to read from LocalStorage")}}saveEventData(){const e=Wi("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{de.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&de.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{Xe("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,s,u){if(!Le.EVENTS_URL)return;const p=Yt(Le.EVENTS_URL);p.params.push(`access_token=${u||Le.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(e).toISOString()},v=n?Xt(m,n):m,E={url:bn(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};var R;this.pendingRequest=(R=C=>{this.pendingRequest=null,s(C),this.saveEventData(),this.processRequests(u)},Rn(Xt(E,{method:"POST"}),R))}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const ee=new class extends Ee{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){Le.EVENTS_URL&&Le.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>lt(n)||nn(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=ri(Le.ACCESS_TOKEN),n=e?e.u:Le.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;Bi(this.anonId)||(this.anonId=wi(),s=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),m=new Date(u),v=(u-this.eventData.lastSuccess)/864e5;s=s||v>=1||v<-1||p.getDate()!==m.getDate()}else s=!0;s?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ut,skuId:tt,"enabled.telemetry":!1,userId:this.anonId},p=>{p||(this.eventData.lastSuccess=u,this.eventData.tokenU=n)},t):this.processRequests()}},oe=ee.postTurnstileEvent.bind(ee),Me=new class extends Ee{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,s){this.skuToken=e,this.errorCb=s,Le.EVENTS_URL&&(n||Le.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Pt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Bi(this.anonId)||(this.anonId=wi()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ut,skuId:tt,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}},Ve=Me.postMapLoadEvent.bind(Me),ct=new class extends Ee{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){Le.EVENTS_URL&&(t||Le.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:n}=this.queue.shift(),s=function(u){const p=de.performance.getEntriesByType("resource"),m=de.performance.getEntriesByType("mark"),v=function(H){const K={};if(H)for(const J in H)if("other"!==J)for(const se of H[J]){const De=`${J}ResolveRangeMin`,We=`${J}ResolveRangeMax`,gt=`${J}RequestCount`,Ze=`${J}RequestCachedCount`;K[De]=Math.min(K[De]||1/0,se.startTime),K[We]=Math.max(K[We]||-1/0,se.responseEnd);const at=Ct=>{void 0===K[Ct]&&(K[Ct]=0),++K[Ct]};void 0!==se.transferSize&&0===se.transferSize&&at(Ze),at(gt)}return K}(function(H,K){const J={};if(H)for(const se of H){const De=K(se);void 0===J[De]&&(J[De]=[]),J[De].push(se)}return J}(p,Ue)),E=de.devicePixelRatio,C=de.navigator.connection||de.navigator.mozConnection||de.navigator.webkitConnection,R={counters:[],metadata:[],attributes:[]},N=(H,K,J)=>{null!=J&&H.push({name:K,value:J.toString()})};for(const H in v)N(R.counters,H,v[H]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(N(R.counters,"interactionRangeMin",u.interactionRange[0]),N(R.counters,"interactionRangeMax",u.interactionRange[1])),m)for(const H of Object.keys(_e)){const K=_e[H],J=m.find(se=>se.name===K);J&&N(R.counters,K,J.startTime)}return N(R.counters,"visibilityHidden",u.visibilityHidden),N(R.attributes,"style",function(H){if(H)for(const K of H){const J=K.name.split("?")[0];if(Qt(J)){const se=J.split("/").slice(-2);if(2===se.length)return`mapbox://styles/${se[0]}/${se[1]}`}}}(p)),N(R.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),N(R.attributes,"fogEnabled",u.fogEnabled?"true":"false"),N(R.attributes,"projection",u.projection),N(R.attributes,"zoom",u.zoom),N(R.metadata,"devicePixelRatio",E),N(R.metadata,"connectionEffectiveType",C?C.effectiveType:void 0),N(R.metadata,"navigatorUserAgent",de.navigator.userAgent),N(R.metadata,"screenWidth",de.screen.width),N(R.metadata,"screenHeight",de.screen.height),N(R.metadata,"windowWidth",de.innerWidth),N(R.metadata,"windowHeight",de.innerHeight),N(R.metadata,"mapWidth",u.width/E),N(R.metadata,"mapHeight",u.height/E),N(R.metadata,"webglRenderer",u.renderer),N(R.metadata,"webglVendor",u.vendor),N(R.metadata,"sdkVersion",ut),N(R.metadata,"sdkIdentifier","mapbox-gl-js"),R}(n);for(const u of s.metadata);for(const u of s.counters);for(const u of s.attributes);this.postEvent(e,s,()=>{},t)}},Lt=ct.postPerformanceEvent.bind(ct),Ft=new class extends Ee{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,s){if(!Le.API_URL||!Le.SESSION_PATH)return;const u=Yt(Le.API_URL+Le.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${s||Le.ACCESS_TOKEN||""}`);const p={url:bn(u),headers:{"Content-Type":"text/plain"}};var v;this.pendingRequest=(v=m=>{this.pendingRequest=null,n(m),this.saveEventData(),this.processRequests(s)},Rn(Xt(p,{method:"GET"}),v))}getSessionAPI(t,e,n,s){this.skuToken=e,this.errorCb=s,Le.SESSION_PATH&&Le.API_URL&&(n||Le.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Pt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}},Mt=Ft.getSessionAPI.bind(Ft),le=new Set,_e={create:"create",load:"load",fullLoad:"fullLoad"},he={mark(t){de.performance.mark(t)},measure(t,e,n){de.performance.measure(t,e,n)}};function Ue(t){const e=t.name.split("?")[0];return _i(e)&&e.includes("mapbox-gl.js")?"javascript":_i(e)&&e.includes("mapbox-gl.css")?"css":Le.API_FONTS_REGEX.test(e)?"fontRange":xt(e)?"sprite":Qt(e)?"style":Le.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Zt=de.performance;function Tn(t){const e=t?t.url.toString():void 0;return Zt.getEntriesByName(e)}let jn,Xn,Ai,Ri;const Gn={now:()=>void 0!==Ai?Ai:de.performance.now(),setNow(t){Ai=t},restoreNow(){Ai=void 0},frame(t){const e=de.requestAnimationFrame(t);return{cancel:()=>de.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:s}=t;Ri||(Ri=de.document.createElement("canvas"));const u=Ri.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(n>Ri.width||s>Ri.height)&&(Ri.width=n,Ri.height=s),u.clearRect(-e,-e,n+2*e,s+2*e),u.drawImage(t,0,0,n,s),u.getImageData(-e,-e,n+2*e,s+2*e)},resolveURL:t=>(jn||(jn=de.document.createElement("a")),jn.href=t,jn.href),get devicePixelRatio(){return de.devicePixelRatio},get prefersReducedMotion(){return!!de.matchMedia&&(null==Xn&&(Xn=de.matchMedia("(prefers-reduced-motion: reduce)")),Xn.matches)}};function er(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function qi(t,e,n){if(n&&n[t]){const s=n[t].indexOf(e);-1!==s&&n[t].splice(s,1)}}class fo{constructor(e,n={}){Xt(this,n),this.type=e}}class Xr extends fo{constructor(e,n={}){super("error",Xt({error:e},n))}}class Cr{on(e,n){return this._listeners=this._listeners||{},er(e,n,this._listeners),this}off(e,n){return qi(e,n,this._listeners),qi(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},er(e,n,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,n){"string"==typeof e&&(e=new fo(e,n||{}));const s=e.type;if(this.listens(s)){e.target=this;const u=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of u)v.call(this,e);const p=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of p)qi(s,v,this._oneTimeListeners),v.call(this,e);const m=this._eventedParent;m&&(Xt(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),m.fire(e))}else e instanceof Xr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var _n=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function So(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}function tr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ao(t){if(Array.isArray(t))return t.map(Ao);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=Ao(t[n]);return e}return tr(t)}class wa extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var Yi=wa;class gs{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[s,u]of n)this.bindings[s]=u}concat(e){return new gs(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var kn=gs;const hn={kind:"null"},Ie={kind:"number"},Gt={kind:"string"},Fn={kind:"boolean"},hi={kind:"color"},Ti={kind:"object"},mi={kind:"value"},Ki={kind:"collator"},vr={kind:"formatted"},to={kind:"resolvedImage"};function Br(t,e){return{kind:"array",itemType:t,N:e}}function pr(t){if("array"===t.kind){const e=pr(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Zr=[hn,Ie,Gt,Fn,hi,vr,Ti,Br(mi),to];function Ds(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Ds(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const n of Zr)if(!Ds(n,e))return null}return`Expected ${pr(t)} but found ${pr(e)} instead.`}function Ts(t,e){return e.some(n=>n.kind===t.kind)}function is(t,e){return e.some(n=>"null"===n?null===t:"array"===n?Array.isArray(t):"object"===n?t&&!Array.isArray(t)&&"object"==typeof t:n===typeof t)}var ks,Fl={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Eo(t){return(t=Math.round(t))<0?0:t>255?255:t}function Ha(t){return Eo("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Ga(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function nl(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{ks={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Fl)return Fl[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=n.indexOf("("),u=n.indexOf(")");if(-1!==s&&u+1===n.length){var p=n.substr(0,s),m=n.substr(s+1,u-(s+1)).split(","),v=1;switch(p){case"rgba":if(4!==m.length)return null;v=Ga(m.pop());case"rgb":return 3!==m.length?null:[Ha(m[0]),Ha(m[1]),Ha(m[2]),v];case"hsla":if(4!==m.length)return null;v=Ga(m.pop());case"hsl":if(3!==m.length)return null;var E=(parseFloat(m[0])%360+360)%360/360,C=Ga(m[1]),R=Ga(m[2]),N=R<=.5?R*(C+1):R+C-R*C,H=2*R-N;return[Eo(255*nl(H,N,E+1/3)),Eo(255*nl(H,N,E)),Eo(255*nl(H,N,E-1/3)),v];default:return null}}return null}}catch{}class Io{constructor(e,n,s,u=1){this.r=e,this.g=n,this.b=s,this.a=u}static parse(e){if(!e)return;if(e instanceof Io)return e;if("string"!=typeof e)return;const n=ks(e);return n?new Io(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,s,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(s)},${u})`}toArray(){const{r:e,g:n,b:s,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*n/u,255*s/u,u]}toArray01(){const{r:e,g:n,b:s,a:u}=this;return 0===u?[0,0,0,0]:[e/u,n/u,s/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:s,a:u}=this;return[e,n,s,u]}}Io.black=new Io(0,0,0,1),Io.white=new Io(1,1,1,1),Io.transparent=new Io(0,0,0,0),Io.red=new Io(1,0,0,1),Io.blue=new Io(0,0,1,1);var kr=Io;class Fs{constructor(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ea{constructor(e,n,s,u,p){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=s,this.fontStack=u,this.textColor=p}}class Qr{constructor(e){this.sections=e}static fromString(e){return new Qr([new Ea(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Qr?e:Qr.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const s={};n.fontStack&&(s["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(s["font-scale"]=n.scale),n.textColor&&(s["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(s)}return e}}class mo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new mo({name:e,available:!1}):null}serialize(){return["image",this.name]}}function la(t,e,n,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[t,e,n,s]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ca(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof kr||t instanceof Fs||t instanceof Qr||t instanceof mo)return!0;if(Array.isArray(t)){for(const e of t)if(!ca(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!ca(t[e]))return!1;return!0}return!1}function Jr(t){if(null===t)return hn;if("string"==typeof t)return Gt;if("boolean"==typeof t)return Fn;if("number"==typeof t)return Ie;if(t instanceof kr)return hi;if(t instanceof Fs)return Ki;if(t instanceof Qr)return vr;if(t instanceof mo)return to;if(Array.isArray(t)){const e=t.length;let n;for(const s of t){const u=Jr(s);if(n){if(n===u)continue;n=mi;break}n=u}return Br(n||mi,e)}return Ti}function ua(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof kr||t instanceof Qr||t instanceof mo?t.toString():JSON.stringify(t)}class Bo{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(2!==e.length)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ca(e[1]))return n.error("invalid value");const s=e[1];let u=Jr(s);const p=n.expectedType;return"array"!==u.kind||0!==u.N||!p||"array"!==p.kind||"number"==typeof p.N&&0!==p.N||(u=p),new Bo(u,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof kr?["rgba"].concat(this.value.toArray()):this.value instanceof Qr?this.value.serialize():this.value}}var da=Bo,no=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const _s={string:Gt,number:Ie,boolean:Fn,object:Ti};class ys{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s,u=1;const p=e[0];if("array"===p){let v,E;if(e.length>2){const C=e[1];if("string"!=typeof C||!(C in _s)||"object"===C)return n.error('The item type argument of "array" must be one of string, number, boolean',1);v=_s[C],u++}else v=mi;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);E=e[2],u++}s=Br(v,E)}else s=_s[p];const m=[];for(;u<e.length;u++){const v=n.parse(e[u],u,mi);if(!v)return null;m.push(v)}return new ys(s,m)}evaluate(e){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(e);if(!Ds(this.type,Jr(s)))return s;if(n===this.args.length-1)throw new no(`Expected value to be of type ${pr(this.type)}, but found ${pr(Jr(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){n.push(s.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&n.push(u)}}return n.concat(this.args.map(s=>s.serialize()))}}var Ho=ys;class Ls{constructor(e){this.type=vr,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return n.error("First argument must be an image or text section.");const u=[];let p=!1;for(let m=1;m<=e.length-1;++m){const v=e[m];if(p&&"object"==typeof v&&!Array.isArray(v)){p=!1;let E=null;if(v["font-scale"]&&(E=n.parse(v["font-scale"],1,Ie),!E))return null;let C=null;if(v["text-font"]&&(C=n.parse(v["text-font"],1,Br(Gt)),!C))return null;let R=null;if(v["text-color"]&&(R=n.parse(v["text-color"],1,hi),!R))return null;const N=u[u.length-1];N.scale=E,N.font=C,N.textColor=R}else{const E=n.parse(e[m],1,mi);if(!E)return null;const C=E.type.kind;if("string"!==C&&"value"!==C&&"null"!==C&&"resolvedImage"!==C)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,u.push({content:E,scale:null,font:null,textColor:null})}}return new Ls(u)}evaluate(e){return new Qr(this.sections.map(n=>{const s=n.content.evaluate(e);return Jr(s)===to?new Ea("",s,null,null,null):new Ea(ua(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const s={};n.scale&&(s["font-scale"]=n.scale.serialize()),n.font&&(s["text-font"]=n.font.serialize()),n.textColor&&(s["text-color"]=n.textColor.serialize()),e.push(s)}return e}}class Bs{constructor(e){this.type=to,this.input=e}static parse(e,n){if(2!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Gt);return s?new Bs(s):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),s=mo.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ca={"to-boolean":Fn,"to-color":hi,"to-number":Ie,"to-string":Gt};class Ns{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return n.error("Expected one argument.");const u=Ca[s],p=[];for(let m=1;m<e.length;m++){const v=n.parse(e[m],m,mi);if(!v)return null;p.push(v)}return new Ns(u,p)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let n,s;for(const u of this.args){if(n=u.evaluate(e),s=null,n instanceof kr)return n;if("string"==typeof n){const p=e.parseColor(n);if(p)return p}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:la(n[0],n[1],n[2],n[3]),!s))return new kr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new no(s||`Could not parse color from value '${"string"==typeof n?n:String(JSON.stringify(n))}'`)}if("number"===this.type.kind){let n=null;for(const s of this.args){if(n=s.evaluate(e),null===n)return 0;const u=Number(n);if(!isNaN(u))return u}throw new no(`Could not convert ${JSON.stringify(n)} to number.`)}return"formatted"===this.type.kind?Qr.fromString(ua(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?mo.fromString(ua(this.args[0].evaluate(e))):ua(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ls([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Bs(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Go=Ns;const Ma=["Unknown","Point","LineString","Polygon"];var il=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ma[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(s*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=kr.parse(t)),e}};class rs{constructor(e,n,s,u){this.name=e,this.type=n,this._evaluate=s,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const s=e[0],u=rs.definitions[s];if(!u)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,v=m.filter(([C])=>!Array.isArray(C)||C.length===e.length-1);let E=null;for(const[C,R]of v){E=new Us(n.registry,n.path,null,n.scope);const N=[];let H=!1;for(let K=1;K<e.length;K++){const J=e[K],se=Array.isArray(C)?C[K-1]:C.type,De=E.parse(J,1+N.length,se);if(!De){H=!0;break}N.push(De)}if(!H)if(Array.isArray(C)&&C.length!==N.length)E.error(`Expected ${C.length} arguments, but found ${N.length} instead.`);else{for(let K=0;K<N.length;K++){const J=Array.isArray(C)?C[K]:C.type,se=N[K];E.concat(K+1).checkSubtype(J,se.type)}if(0===E.errors.length)return new rs(s,p,R,N)}}if(1===v.length)n.errors.push(...E.errors);else{const C=(v.length?v:m).map(([N])=>{return H=N,Array.isArray(H)?`(${H.map(pr).join(", ")})`:`(${pr(H.type)}...)`;var H}).join(" | "),R=[];for(let N=1;N<e.length;N++){const H=n.parse(e[N],1+R.length);if(!H)return null;R.push(pr(H.type))}n.error(`Expected arguments of type ${C}, but found (${R.join(", ")}) instead.`)}return null}static register(e,n){rs.definitions=n;for(const s in n)e[s]=rs}}var Ss=rs;class Co{constructor(e,n,s){this.type=Ki,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(2!==e.length)return n.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return n.error("Collator options argument must be an object.");const u=n.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Fn);if(!u)return null;const p=n.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Fn);if(!p)return null;let m=null;return s.locale&&(m=n.parse(s.locale,1,Gt),!m)?null:new Co(u,p,m)}evaluate(e){return new Fs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Wr=8192;function ha(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function qs(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function os(t,e){const n=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(n*u*Wr),Math.round(s*u*Wr)]}function rl(t,e,n){const s=t[0]-e[0],u=t[1]-e[1],p=t[0]-n[0],m=t[1]-n[1];return s*m-p*u==0&&s*p<=0&&u*m<=0}function Fr(t,e){let n=!1;for(let m=0,v=e.length;m<v;m++){const E=e[m];for(let C=0,R=E.length;C<R-1;C++){if(rl(t,E[C],E[C+1]))return!1;(u=E[C])[1]>(s=t)[1]!=(p=E[C+1])[1]>s[1]&&s[0]<(p[0]-u[0])*(s[1]-u[1])/(p[1]-u[1])+u[0]&&(n=!n)}}var s,u,p;return n}function ml(t,e){for(let n=0;n<e.length;n++)if(Fr(t,e[n]))return!0;return!1}function Fo(t,e,n,s){const u=s[0]-n[0],p=s[1]-n[1],m=(t[0]-n[0])*p-u*(t[1]-n[1]),v=(e[0]-n[0])*p-u*(e[1]-n[1]);return m>0&&v<0||m<0&&v>0}function $o(t,e,n){for(const C of n)for(let R=0;R<C.length-1;++R)if((v=[(m=C[R+1])[0]-(p=C[R])[0],m[1]-p[1]])[0]*(E=[(u=e)[0]-(s=t)[0],u[1]-s[1]])[1]-v[1]*E[0]!=0&&Fo(s,u,p,m)&&Fo(p,m,s,u))return!0;var s,u,p,m,v,E;return!1}function go(t,e){for(let n=0;n<t.length;++n)if(!Fr(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if($o(t[n],t[n+1],e))return!1;return!0}function $a(t,e){for(let n=0;n<e.length;n++)if(go(t,e[n]))return!0;return!1}function Ys(t,e,n){const s=[];for(let u=0;u<t.length;u++){const p=[];for(let m=0;m<t[u].length;m++){const v=os(t[u][m],n);ha(e,v),p.push(v)}s.push(p)}return s}function pa(t,e,n){const s=[];for(let u=0;u<t.length;u++){const p=Ys(t[u],e,n);s.push(p)}return s}function cr(t,e,n,s){if(t[0]<n[0]||t[0]>n[2]){const u=.5*s;let p=t[0]-n[0]>u?-s:n[0]-t[0]>u?s:0;0===p&&(p=t[0]-n[2]>u?-s:n[2]-t[0]>u?s:0),t[0]+=p}ha(e,t)}function fr(t,e,n,s){const u=Math.pow(2,s.z)*Wr,p=[s.x*Wr,s.y*Wr],m=[];if(!t)return m;for(const v of t)for(const E of v){const C=[E.x+p[0],E.y+p[1]];cr(C,e,n,u),m.push(C)}return m}function zs(t,e,n,s){const u=Math.pow(2,s.z)*Wr,p=[s.x*Wr,s.y*Wr],m=[];if(!t)return m;for(const E of t){const C=[];for(const R of E){const N=[R.x+p[0],R.y+p[1]];ha(e,N),C.push(N)}m.push(C)}if(e[2]-e[0]<=u/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const E of m)for(const C of E)cr(C,e,n,u)}var v;return m}class Ks{constructor(e,n){this.type=Fn,this.geojson=e,this.geometries=n}static parse(e,n){if(2!==e.length)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ca(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let u=0;u<s.features.length;++u){const p=s.features[u].geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Ks(s,s.features[u].geometry)}else if("Feature"===s.type){const u=s.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new Ks(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new Ks(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(n,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if("Polygon"===s.type){const v=Ys(s.coordinates,p,m),E=fr(n.geometry(),u,p,m);if(!qs(u,p))return!1;for(const C of E)if(!Fr(C,v))return!1}if("MultiPolygon"===s.type){const v=pa(s.coordinates,p,m),E=fr(n.geometry(),u,p,m);if(!qs(u,p))return!1;for(const C of E)if(!ml(C,v))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(n,s){const u=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],m=n.canonicalID();if(!m)return!1;if("Polygon"===s.type){const v=Ys(s.coordinates,p,m),E=zs(n.geometry(),u,p,m);if(!qs(u,p))return!1;for(const C of E)if(!go(C,v))return!1}if("MultiPolygon"===s.type){const v=pa(s.coordinates,p,m),E=zs(n.geometry(),u,p,m);if(!qs(u,p))return!1;for(const C of E)if(!$a(C,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ss=Ks;function vs(t){if(t instanceof Ss&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof ss)return!1;let e=!0;return t.eachChild(n=>{e&&!vs(n)&&(e=!1)}),e}function _o(t){if(t instanceof Ss&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(n=>{e&&!_o(n)&&(e=!1)}),e}function Gi(t,e){if(t instanceof Ss&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(s=>{n&&!Gi(s,e)&&(n=!1)}),n}class Mo{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(2!==e.length||"string"!=typeof e[1])return n.error("'var' expression requires exactly one string literal argument.");const s=e[1];return n.scope.has(s)?new Mo(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Da=Mo;class Ta{constructor(e,n=[],s,u=new kn,p=[]){this.registry=e,this.path=n,this.key=n.map(m=>`[${m}]`).join(""),this.scope=u,this.errors=p,this.expectedType=s}parse(e,n,s,u,p={}){return n?this.concat(n,s,u)._parse(e,p):this._parse(e,p)}_parse(e,n){function s(u,p,m){return"assert"===m?new Ho(p,[u]):"coerce"===m?new Go(p,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[u];if(p){let m=p.parse(e,this);if(!m)return null;if(this.expectedType){const v=this.expectedType,E=m.type;if("string"!==v.kind&&"number"!==v.kind&&"boolean"!==v.kind&&"object"!==v.kind&&"array"!==v.kind||"value"!==E.kind)if("color"!==v.kind&&"formatted"!==v.kind&&"resolvedImage"!==v.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(v,E))return null}else m=s(m,v,n.typeAnnotation||"coerce");else m=s(m,v,n.typeAnnotation||"assert")}if(!(m instanceof da)&&"resolvedImage"!==m.type.kind&&as(m)){const v=new il;try{m=new da(m.type,m.evaluate(v))}catch(E){return this.error(E.message),null}}return m}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,s){const u="number"==typeof e?this.path.concat(e):this.path,p=s?this.scope.concat(s):this.scope;return new Ta(this.registry,u,n||null,p,this.errors)}error(e,...n){const s=`${this.key}${n.map(u=>`[${u}]`).join("")}`;this.errors.push(new Yi(s,e))}checkSubtype(e,n){const s=Ds(e,n);return s&&this.error(s),s}}var Us=Ta;function as(t){if(t instanceof Da)return as(t.boundExpression);if(t instanceof Ss&&"error"===t.name||t instanceof Co||t instanceof ss)return!1;const e=t instanceof Go||t instanceof Ho;let n=!0;return t.eachChild(s=>{n=e?n&&as(s):n&&s instanceof da}),!!n&&vs(t)&&Gi(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function As(t,e){const n=t.length-1;let s,u,p=0,m=n,v=0;for(;p<=m;)if(v=Math.floor((p+m)/2),s=t[v],u=t[v+1],s<=e){if(v===n||e<u)return v;p=v+1}else{if(!(s>e))throw new no("Input is not a number.");m=v-1}return 0}class Sa{constructor(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[u,p]of s)this.labels.push(u),this.outputs.push(p)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(e[1],1,Ie);if(!s)return null;const u=[];let p=null;n.expectedType&&"value"!==n.expectedType.kind&&(p=n.expectedType);for(let m=1;m<e.length;m+=2){const v=1===m?-1/0:e[m],E=e[m+1],C=m,R=m+1;if("number"!=typeof v)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(u.length&&u[u.length-1][0]>=v)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const N=n.parse(E,R,p);if(!N)return null;p=p||N.type,u.push([v,N])}return new Sa(p,s,u)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return s[0].evaluate(e);const p=n.length;return u>=n[p-1]?s[p-1].evaluate(e):s[As(n,u)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var ls=Sa;function wn(t,e,n){return t*(1-n)+e*n}var ar=Object.freeze({__proto__:null,number:wn,color:function(t,e,n){return new kr(wn(t.r,e.r,n),wn(t.g,e.g,n),wn(t.b,e.b,n),wn(t.a,e.a,n))},array:function(t,e,n){return t.map((s,u)=>wn(s,e[u],n))}});const zr=4/29,Q=6/29,q=3*Q*Q,j=Math.PI/180,be=180/Math.PI;function En(t){return t>.008856451679035631?Math.pow(t,1/3):t/q+zr}function bi(t){return t>Q?t*t*t:q*(t-zr)}function io(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Is(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function xs(t){const e=Is(t.r),n=Is(t.g),s=Is(t.b),u=En((.4124564*e+.3575761*n+.1804375*s)/.95047),p=En((.2126729*e+.7151522*n+.072175*s)/1);return{l:116*p-16,a:500*(u-p),b:200*(p-En((.0193339*e+.119192*n+.9503041*s)/1.08883)),alpha:t.a}}function Lr(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*bi(e),n=.95047*bi(n),s=1.08883*bi(s),new kr(io(3.2404542*n-1.5371385*e-.4985314*s),io(-.969266*n+1.8760108*e+.041556*s),io(.0556434*n-.2040259*e+1.0572252*s),t.alpha)}function Zo(t,e,n){const s=e-t;return t+n*(s>180||s<-180?s-360*Math.round(s/360):s)}const Aa={forward:xs,reverse:Lr,interpolate:function(t,e,n){return{l:wn(t.l,e.l,n),a:wn(t.a,e.a,n),b:wn(t.b,e.b,n),alpha:wn(t.alpha,e.alpha,n)}}},Vs={forward:function(t){const{l:e,a:n,b:s}=xs(t),u=Math.atan2(s,n)*be;return{h:u<0?u+360:u,c:Math.sqrt(n*n+s*s),l:e,alpha:t.a}},reverse:function(t){const e=t.h*j,n=t.c;return Lr({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:Zo(t.h,e.h,n),c:wn(t.c,e.c,n),l:wn(t.l,e.l,n),alpha:wn(t.alpha,e.alpha,n)}}};var Xs=Object.freeze({__proto__:null,lab:Aa,hcl:Vs});class Ll{constructor(e,n,s,u,p){this.type=e,this.operator=n,this.interpolation=s,this.input=u,this.labels=[],this.outputs=[];for(const[m,v]of p)this.labels.push(m),this.outputs.push(v)}static interpolationFactor(e,n,s,u){let p=0;if("exponential"===e.name)p=Bl(n,e.base,s,u);else if("linear"===e.name)p=Bl(n,1,s,u);else if("cubic-bezier"===e.name){const m=e.controlPoints;p=new Wt(m[0],m[1],m[2],m[3]).solve(Bl(n,1,s,u))}return p}static parse(e,n){let[s,u,p,...m]=e;if(!Array.isArray(u)||0===u.length)return n.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const C=u[1];if("number"!=typeof C)return n.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:C}}else{if("cubic-bezier"!==u[0])return n.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const C=u.slice(1);if(4!==C.length||C.some(R=>"number"!=typeof R||R<0||R>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:C}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(p=n.parse(p,2,Ie),!p)return null;const v=[];let E=null;"interpolate-hcl"===s||"interpolate-lab"===s?E=hi:n.expectedType&&"value"!==n.expectedType.kind&&(E=n.expectedType);for(let C=0;C<m.length;C+=2){const R=m[C],N=m[C+1],H=C+3,K=C+4;if("number"!=typeof R)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(v.length&&v[v.length-1][0]>=R)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const J=n.parse(N,K,E);if(!J)return null;E=E||J.type,v.push([R,J])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Ll(E,s,u,p,v):n.error(`Type ${pr(E)} is not interpolatable.`)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const u=this.input.evaluate(e);if(u<=n[0])return s[0].evaluate(e);const p=n.length;if(u>=n[p-1])return s[p-1].evaluate(e);const m=As(n,u),v=Ll.interpolationFactor(this.interpolation,u,n[m],n[m+1]),E=s[m].evaluate(e),C=s[m+1].evaluate(e);return"interpolate"===this.operator?ar[this.type.kind.toLowerCase()](E,C,v):"interpolate-hcl"===this.operator?Vs.reverse(Vs.interpolate(Vs.forward(E),Vs.forward(C),v)):Aa.reverse(Aa.interpolate(Aa.forward(E),Aa.forward(C),v))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)n.push(this.labels[s],this.outputs[s].serialize());return n}}function Bl(t,e,n,s){const u=s-n,p=t-n;return 0===u?0:1===e?p/u:(Math.pow(e,p)-1)/(Math.pow(e,u)-1)}var js=Ll;class ol{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let s=null;const u=n.expectedType;u&&"value"!==u.kind&&(s=u);const p=[];for(const v of e.slice(1)){const E=n.parse(v,1+p.length,s,void 0,{typeAnnotation:"omit"});if(!E)return null;s=s||E.type,p.push(E)}const m=u&&p.some(v=>Ds(u,v.type));return new ol(m?mi:s,p)}evaluate(e){let n,s=null,u=0;for(const p of this.args){if(u++,s=p.evaluate(e),s&&s instanceof mo&&!s.available&&(n||(n=s),s=null,u===this.args.length))return n;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var sl=ol;class Wa{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let p=1;p<e.length-1;p+=2){const m=e[p];if("string"!=typeof m)return n.error(`Expected string, but found ${typeof m} instead.`,p);if(/[^a-zA-Z0-9_]/.test(m))return n.error("Variable names must contain only alphanumeric characters or '_'.",p);const v=n.parse(e[p+1],p+1);if(!v)return null;s.push([m,v])}const u=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return u?new Wa(s,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,s]of this.bindings)e.push(n,s.serialize());return e.push(this.result.serialize()),e}}var ec=Wa;class gl{constructor(e,n,s){this.type=e,this.index=n,this.input=s}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,Ie),u=n.parse(e[2],2,Br(n.expectedType||mi));return s&&u?new gl(u.type.itemType,s,u):null}evaluate(e){const n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new no(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new no(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new no(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Nl=gl;class Xo{constructor(e,n){this.type=Fn,this.needle=e,this.haystack=n}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,mi),u=n.parse(e[2],2,mi);return s&&u?Ts(s.type,[Fn,Gt,Ie,hn,mi])?new Xo(s,u):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${pr(s.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!is(n,["boolean","string","number","null"]))throw new no(`Expected first argument to be of type boolean, string, number or null, but found ${pr(Jr(n))} instead.`);if(!is(s,["string","array"]))throw new no(`Expected second argument to be of type array or string, but found ${pr(Jr(s))} instead.`);return s.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var al=Xo;class Ia{constructor(e,n,s){this.type=Ie,this.needle=e,this.haystack=n,this.fromIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,mi),u=n.parse(e[2],2,mi);if(!s||!u)return null;if(!Ts(s.type,[Fn,Gt,Ie,hn,mi]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${pr(s.type)} instead`);if(4===e.length){const p=n.parse(e[3],3,Ie);return p?new Ia(s,u,p):null}return new Ia(s,u)}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!is(n,["boolean","string","number","null"]))throw new no(`Expected first argument to be of type boolean, string, number or null, but found ${pr(Jr(n))} instead.`);if(!is(s,["string","array"]))throw new no(`Expected second argument to be of type array or string, but found ${pr(Jr(s))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return s.indexOf(n,u)}return s.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var vc=Ia;class zl{constructor(e,n,s,u,p,m){this.inputType=e,this.type=n,this.input=s,this.cases=u,this.outputs=p,this.otherwise=m}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let s,u;n.expectedType&&"value"!==n.expectedType.kind&&(u=n.expectedType);const p={},m=[];for(let C=2;C<e.length-1;C+=2){let R=e[C];const N=e[C+1];Array.isArray(R)||(R=[R]);const H=n.concat(C);if(0===R.length)return H.error("Expected at least one branch label.");for(const J of R){if("number"!=typeof J&&"string"!=typeof J)return H.error("Branch labels must be numbers or strings.");if("number"==typeof J&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof J&&Math.floor(J)!==J)return H.error("Numeric branch labels must be integer values.");if(s){if(H.checkSubtype(s,Jr(J)))return null}else s=Jr(J);if(void 0!==p[String(J)])return H.error("Branch labels must be unique.");p[String(J)]=m.length}const K=n.parse(N,C,u);if(!K)return null;u=u||K.type,m.push(K)}const v=n.parse(e[1],1,mi);if(!v)return null;const E=n.parse(e[e.length-1],e.length-1,u);return E?"value"!==v.type.kind&&n.concat(1).checkSubtype(s,v.type)?null:new zl(s,u,v,p,m,E):null}evaluate(e){const n=this.input.evaluate(e);return(Jr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),s=[],u={};for(const m of n){const v=u[this.cases[m]];void 0===v?(u[this.cases[m]]=s.length,s.push([this.cases[m],[m]])):s[v][1].push(m)}const p=m=>"number"===this.inputType.kind?Number(m):m;for(const[m,v]of s)e.push(1===v.length?p(v[0]):v.map(p)),e.push(this.outputs[m].serialize());return e.push(this.otherwise.serialize()),e}}var z=zl;class re{constructor(e,n,s){this.type=e,this.branches=n,this.otherwise=s}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&"value"!==n.expectedType.kind&&(s=n.expectedType);const u=[];for(let m=1;m<e.length-1;m+=2){const v=n.parse(e[m],m,Fn);if(!v)return null;const E=n.parse(e[m+1],m+1,s);if(!E)return null;u.push([v,E]),s=s||E.type}const p=n.parse(e[e.length-1],e.length-1,s);return p?new re(s,u,p):null}evaluate(e){for(const[n,s]of this.branches)if(n.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,s]of this.branches)e(n),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var G=re;class ye{constructor(e,n,s,u){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=u}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,mi),u=n.parse(e[2],2,Ie);if(!s||!u)return null;if(!Ts(s.type,[Br(mi),Gt,mi]))return n.error(`Expected first argument to be of type array or string, but found ${pr(s.type)} instead`);if(4===e.length){const p=n.parse(e[3],3,Ie);return p?new ye(s.type,s,u,p):null}return new ye(s.type,s,u)}evaluate(e){const n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!is(n,["string","array"]))throw new no(`Expected first argument to be of type array or string, but found ${pr(Jr(n))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return n.slice(s,u)}return n.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var yt=ye;function vn(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function On(t,e,n,s){return 0===s.compare(e,n)}function yi(t,e,n){const s="=="!==t&&"!="!==t;return class yx{constructor(p,m,v){this.type=Fn,this.lhs=p,this.rhs=m,this.collator=v,this.hasUntypedArgument="value"===p.type.kind||"value"===m.type.kind}static parse(p,m){if(3!==p.length&&4!==p.length)return m.error("Expected two or three arguments.");const v=p[0];let E=m.parse(p[1],1,mi);if(!E)return null;if(!vn(v,E.type))return m.concat(1).error(`"${v}" comparisons are not supported for type '${pr(E.type)}'.`);let C=m.parse(p[2],2,mi);if(!C)return null;if(!vn(v,C.type))return m.concat(2).error(`"${v}" comparisons are not supported for type '${pr(C.type)}'.`);if(E.type.kind!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return m.error(`Cannot compare types '${pr(E.type)}' and '${pr(C.type)}'.`);s&&("value"===E.type.kind&&"value"!==C.type.kind?E=new Ho(C.type,[E]):"value"!==E.type.kind&&"value"===C.type.kind&&(C=new Ho(E.type,[C])));let R=null;if(4===p.length){if("string"!==E.type.kind&&"string"!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return m.error("Cannot use collator to compare non-string types.");if(R=m.parse(p[3],3,Ki),!R)return null}return new yx(E,C,R)}evaluate(p){const m=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){const E=Jr(m),C=Jr(v);if(E.kind!==C.kind||"string"!==E.kind&&"number"!==E.kind)throw new no(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${E.kind}, ${C.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const E=Jr(m),C=Jr(v);if("string"!==E.kind||"string"!==C.kind)return e(p,m,v)}return this.collator?n(p,m,v,this.collator.evaluate(p)):e(p,m,v)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[t];return this.eachChild(m=>{p.push(m.serialize())}),p}}}const mr=yi("==",function(t,e,n){return e===n},On),Sr=yi("!=",function(t,e,n){return e!==n},function(t,e,n,s){return!On(0,e,n,s)}),Ar=yi("<",function(t,e,n){return e<n},function(t,e,n,s){return s.compare(e,n)<0}),xr=yi(">",function(t,e,n){return e>n},function(t,e,n,s){return s.compare(e,n)>0}),yo=yi("<=",function(t,e,n){return e<=n},function(t,e,n,s){return s.compare(e,n)<=0}),Ir=yi(">=",function(t,e,n){return e>=n},function(t,e,n,s){return s.compare(e,n)>=0});class eo{constructor(e,n,s,u,p,m){this.type=Gt,this.number=e,this.locale=n,this.currency=s,this.unit=u,this.minFractionDigits=p,this.maxFractionDigits=m}static parse(e,n){if(3!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,Ie);if(!s)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return n.error("NumberFormat options argument must be an object.");let p=null;if(u.locale&&(p=n.parse(u.locale,1,Gt),!p))return null;let m=null;if(u.currency&&(m=n.parse(u.currency,1,Gt),!m))return null;let v=null;if(u.unit&&(v=n.parse(u.unit,1,Gt),!v))return null;let E=null;if(u["min-fraction-digits"]&&(E=n.parse(u["min-fraction-digits"],1,Ie),!E))return null;let C=null;return u["max-fraction-digits"]&&(C=n.parse(u["max-fraction-digits"],1,Ie),!C)?null:new eo(s,p,m,v,E,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Wo{constructor(e){this.type=Ie,this.input=e}static parse(e,n){if(2!==e.length)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=n.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?n.error(`Expected argument of type string or array, but found ${pr(s.type)} instead.`):new Wo(s):null}evaluate(e){const n=this.input.evaluate(e);if("string"==typeof n||Array.isArray(n))return n.length;throw new no(`Expected value to be of type string or array, but found ${pr(Jr(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const cs={"==":mr,"!=":Sr,">":xr,"<":Ar,">=":Ir,"<=":yo,array:Ho,at:Nl,boolean:Ho,case:G,coalesce:sl,collator:Co,format:Ls,image:Bs,in:al,"index-of":vc,interpolate:js,"interpolate-hcl":js,"interpolate-lab":js,length:Wo,let:ec,literal:da,match:z,number:Ho,"number-format":eo,object:Ho,slice:yt,step:ls,string:Ho,"to-boolean":Go,"to-color":Go,"to-number":Go,"to-string":Go,var:Da,within:ss};function Qs(t,[e,n,s,u]){e=e.evaluate(t),n=n.evaluate(t),s=s.evaluate(t);const p=u?u.evaluate(t):1,m=la(e,n,s,p);if(m)throw new no(m);return new kr(e/255*p,n/255*p,s/255*p,p)}function Hs(t,e){return t in e}function Qo(t,e){const n=e[t];return void 0===n?null:n}function No(t){return{type:t}}Ss.register(cs,{error:[{kind:"error"},[Gt],(t,[e])=>{throw new no(e.evaluate(t))}],typeof:[Gt,[mi],(t,[e])=>pr(Jr(e.evaluate(t)))],"to-rgba":[Br(Ie,4),[hi],(t,[e])=>e.evaluate(t).toArray()],rgb:[hi,[Ie,Ie,Ie],Qs],rgba:[hi,[Ie,Ie,Ie,Ie],Qs],has:{type:Fn,overloads:[[[Gt],(t,[e])=>Hs(e.evaluate(t),t.properties())],[[Gt,Ti],(t,[e,n])=>Hs(e.evaluate(t),n.evaluate(t))]]},get:{type:mi,overloads:[[[Gt],(t,[e])=>Qo(e.evaluate(t),t.properties())],[[Gt,Ti],(t,[e,n])=>Qo(e.evaluate(t),n.evaluate(t))]]},"feature-state":[mi,[Gt],(t,[e])=>Qo(e.evaluate(t),t.featureState||{})],properties:[Ti,[],t=>t.properties()],"geometry-type":[Gt,[],t=>t.geometryType()],id:[mi,[],t=>t.id()],zoom:[Ie,[],t=>t.globals.zoom],pitch:[Ie,[],t=>t.globals.pitch||0],"distance-from-center":[Ie,[],t=>t.distanceFromCenter()],"heatmap-density":[Ie,[],t=>t.globals.heatmapDensity||0],"line-progress":[Ie,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Ie,[],t=>t.globals.skyRadialProgress||0],accumulated:[mi,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Ie,No(Ie),(t,e)=>{let n=0;for(const s of e)n+=s.evaluate(t);return n}],"*":[Ie,No(Ie),(t,e)=>{let n=1;for(const s of e)n*=s.evaluate(t);return n}],"-":{type:Ie,overloads:[[[Ie,Ie],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[Ie],(t,[e])=>-e.evaluate(t)]]},"/":[Ie,[Ie,Ie],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[Ie,[Ie,Ie],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[Ie,[],()=>Math.LN2],pi:[Ie,[],()=>Math.PI],e:[Ie,[],()=>Math.E],"^":[Ie,[Ie,Ie],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[Ie,[Ie],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Ie,[Ie],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Ie,[Ie],(t,[e])=>Math.log(e.evaluate(t))],log2:[Ie,[Ie],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Ie,[Ie],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Ie,[Ie],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Ie,[Ie],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Ie,[Ie],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Ie,[Ie],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Ie,[Ie],(t,[e])=>Math.atan(e.evaluate(t))],min:[Ie,No(Ie),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[Ie,No(Ie),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[Ie,[Ie],(t,[e])=>Math.abs(e.evaluate(t))],round:[Ie,[Ie],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[Ie,[Ie],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Ie,[Ie],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Fn,[Gt,mi],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[Fn,[mi],(t,[e])=>t.id()===e.value],"filter-type-==":[Fn,[Gt],(t,[e])=>t.geometryType()===e.value],"filter-<":[Fn,[Gt,mi],(t,[e,n])=>{const s=t.properties()[e.value],u=n.value;return typeof s==typeof u&&s<u}],"filter-id-<":[Fn,[mi],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<s}],"filter->":[Fn,[Gt,mi],(t,[e,n])=>{const s=t.properties()[e.value],u=n.value;return typeof s==typeof u&&s>u}],"filter-id->":[Fn,[mi],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>s}],"filter-<=":[Fn,[Gt,mi],(t,[e,n])=>{const s=t.properties()[e.value],u=n.value;return typeof s==typeof u&&s<=u}],"filter-id-<=":[Fn,[mi],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<=s}],"filter->=":[Fn,[Gt,mi],(t,[e,n])=>{const s=t.properties()[e.value],u=n.value;return typeof s==typeof u&&s>=u}],"filter-id->=":[Fn,[mi],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>=s}],"filter-has":[Fn,[mi],(t,[e])=>e.value in t.properties()],"filter-has-id":[Fn,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Fn,[Br(Gt)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Fn,[Br(mi)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Fn,[Gt,Br(mi)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Fn,[Gt,Br(mi)],(t,[e,n])=>function(s,u,p,m){for(;p<=m;){const v=p+m>>1;if(u[v]===s)return!0;u[v]>s?m=v-1:p=v+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:Fn,overloads:[[[Fn,Fn],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[No(Fn),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:Fn,overloads:[[[Fn,Fn],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[No(Fn),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[Fn,[Fn],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Fn,[Gt],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[Gt,[Gt],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Gt,[Gt],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Gt,No(mi),(t,e)=>e.map(n=>ua(n.evaluate(t))).join("")],"resolved-locale":[Gt,[Ki],(t,[e])=>e.evaluate(t).resolvedLocale()]});var qa=cs;function Vc(t){return{result:"success",value:t}}function zo(t){return{result:"error",value:t}}function Pa(t){return"data-driven"===t["property-type"]}function Oa(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function tc(t){return!!t.expression&&t.expression.interpolated}function Dr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Ul(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function X(t){return t}function M(t,e){const n="color"===e.type,s=t.stops&&"object"==typeof t.stops[0][0],u=s||!(s||void 0!==t.property),p=t.type||(tc(e)?"exponential":"interval");if(n&&((t=So({},t)).stops&&(t.stops=t.stops.map(C=>[C[0],kr.parse(C[1])])),t.default=kr.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!Xs[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let m,v,E;if("exponential"===p)m=Re;else if("interval"===p)m=ue;else if("categorical"===p){m=$,v=Object.create(null);for(const C of t.stops)v[C[0]]=C[1];E=typeof t.stops[0][0]}else{if("identity"!==p)throw new Error(`Unknown function type "${p}"`);m=It}if(s){const C={},R=[];for(let K=0;K<t.stops.length;K++){const J=t.stops[K],se=J[0].zoom;void 0===C[se]&&(C[se]={zoom:se,type:t.type,property:t.property,default:t.default,stops:[]},R.push(se)),C[se].stops.push([J[0].value,J[1]])}const N=[];for(const K of R)N.push([C[K].zoom,M(C[K],e)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:js.interpolationFactor.bind(void 0,H),zoomStops:N.map(K=>K[0]),evaluate:({zoom:K},J)=>Re({stops:N,base:t.base},e,K).evaluate(K,J)}}if(u){const C="exponential"===p?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:js.interpolationFactor.bind(void 0,C),zoomStops:t.stops.map(R=>R[0]),evaluate:({zoom:R})=>m(t,e,R,v,E)}}return{kind:"source",evaluate(C,R){const N=R&&R.properties?R.properties[t.property]:void 0;return void 0===N?S(t.default,e.default):m(t,e,N,v,E)}}}function S(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function $(t,e,n,s,u){return S(typeof n===u?s[n]:void 0,t.default,e.default)}function ue(t,e,n){if("number"!==Dr(n))return S(t.default,e.default);const s=t.stops.length;if(1===s||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];const u=As(t.stops.map(p=>p[0]),n);return t.stops[u][1]}function Re(t,e,n){const s=void 0!==t.base?t.base:1;if("number"!==Dr(n))return S(t.default,e.default);const u=t.stops.length;if(1===u||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[u-1][0])return t.stops[u-1][1];const p=As(t.stops.map(R=>R[0]),n),m=function(R,N,H,K){const J=K-H,se=R-H;return 0===J?0:1===N?se/J:(Math.pow(N,se)-1)/(Math.pow(N,J)-1)}(n,s,t.stops[p][0],t.stops[p+1][0]),v=t.stops[p][1],E=t.stops[p+1][1];let C=ar[e.type]||X;if(t.colorSpace&&"rgb"!==t.colorSpace){const R=Xs[t.colorSpace];C=(N,H)=>R.reverse(R.interpolate(R.forward(N),R.forward(H),m))}return"function"==typeof v.evaluate?{evaluate(...R){const N=v.evaluate.apply(void 0,R),H=E.evaluate.apply(void 0,R);if(void 0!==N&&void 0!==H)return C(N,H,m)}}:C(v,E,m)}function It(t,e,n){return"color"===e.type?n=kr.parse(n):"formatted"===e.type?n=Qr.fromString(n.toString()):"resolvedImage"===e.type?n=mo.fromString(n.toString()):Dr(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),S(n,t.default,e.default)}class Ot{constructor(e,n){var s;this.expression=e,this._warningHistory={},this._evaluator=new il,this._defaultValue=n?"color"===(s=n).type&&(Ul(s.default)||Array.isArray(s.default))?new kr(0,0,0,0):"color"===s.type?kr.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=n&&"enum"===n.type?n.values:null}evaluateWithoutErrorHandling(e,n,s,u,p,m,v,E){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=u||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,s,u,p,m,v,E){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=v||null,this._evaluator.featureDistanceData=E||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new no(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function sn(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in qa}function zn(t,e){const n=new Us(qa,[],e?function(u){const p={color:hi,string:Gt,number:Ie,enum:Gt,boolean:Fn,formatted:vr,resolvedImage:to};return"array"===u.type?Br(p[u.value]||mi,u.length):p[u.type]}(e):void 0),s=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?Vc(new Ot(s,e)):zo(n.errors)}class di{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent="constant"!==e&&!_o(n.expression)}evaluateWithoutErrorHandling(e,n,s,u,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,u,p,m)}evaluate(e,n,s,u,p,m){return this._styleExpression.evaluate(e,n,s,u,p,m)}}class Mi{constructor(e,n,s,u){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent="camera"!==e&&!_o(n.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,n,s,u,p,m){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,u,p,m)}evaluate(e,n,s,u,p,m){return this._styleExpression.evaluate(e,n,s,u,p,m)}interpolationFactor(e,n,s){return this.interpolationType?js.interpolationFactor(this.interpolationType,e,n,s):0}}function ur(t,e){if("error"===(t=zn(t,e)).result)return t;const n=t.value.expression,s=vs(n);if(!s&&!Pa(e))return zo([new Yi("","data expressions not supported")]);const u=Gi(n,["zoom","pitch","distance-from-center"]);if(!u&&!Oa(e))return zo([new Yi("","zoom expressions not supported")]);const p=Vi(n);return p||u?p instanceof Yi?zo([p]):p instanceof js&&!tc(e)?zo([new Yi("",'"interpolate" expressions cannot be used with this property')]):Vc(p?new Mi(s?"camera":"composite",t.value,p.labels,p instanceof js?p.interpolation:void 0):new di(s?"constant":"source",t.value)):zo([new Yi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Xi{constructor(e,n){this._parameters=e,this._specification=n,So(this,M(this._parameters,this._specification))}static deserialize(e){return new Xi(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Vi(t){let e=null;if(t instanceof ec)e=Vi(t.result);else if(t instanceof sl){for(const n of t.args)if(e=Vi(n),e)break}else(t instanceof ls||t instanceof js)&&t.input instanceof Ss&&"zoom"===t.input.name&&(e=t);return e instanceof Yi||t.eachChild(n=>{const s=Vi(n);s instanceof Yi?e=s:!e&&s?e=new Yi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new Yi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class In{constructor(e,n,s,u){this.message=(e?`${e}: `:"")+s,u&&(this.identifier=u),null!=n&&n.__line__&&(this.line=n.__line__)}}function ir(t){const e=t.key,n=t.value,s=t.valueSpec||{},u=t.objectElementValidators||{},p=t.style,m=t.styleSpec;let v=[];const E=Dr(n);if("object"!==E)return[new In(e,n,`object expected, ${E} found`)];for(const C in n){const R=C.split(".")[0],N=s[R]||s["*"];let H;u[R]?H=u[R]:s[R]?H=ds:u["*"]?H=u["*"]:s["*"]&&(H=ds),H?v=v.concat(H({key:(e&&`${e}.`)+C,value:n[C],valueSpec:N,style:p,styleSpec:m,object:n,objectKey:C},n)):v.push(new In(e,n[C],`unknown property "${C}"`))}for(const C in s)u[C]||s[C].required&&void 0===s[C].default&&void 0===n[C]&&v.push(new In(e,n,`missing required property "${C}"`));return v}function Mr(t){const e=t.value,n=t.valueSpec,s=t.style,u=t.styleSpec,p=t.key,m=t.arrayElementValidator||ds;if("array"!==Dr(e))return[new In(p,e,`array expected, ${Dr(e)} found`)];if(n.length&&e.length!==n.length)return[new In(p,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new In(p,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let v={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};u.$version<7&&(v.function=n.function),"object"===Dr(n.value)&&(v=n.value);let E=[];for(let C=0;C<e.length;C++)E=E.concat(m({array:e,arrayIndex:C,value:e[C],valueSpec:v,style:s,styleSpec:u,key:`${p}[${C}]`}));return E}function vo(t){const e=t.key,n=t.value,s=t.valueSpec;let u=Dr(n);if("number"===u&&n!=n&&(u="NaN"),"number"!==u)return[new In(e,n,`number expected, ${u} found`)];if("minimum"in s){let p=s.minimum;if("array"===Dr(s.minimum)&&(p=s.minimum[t.arrayIndex]),n<p)return[new In(e,n,`${n} is less than the minimum value ${p}`)]}if("maximum"in s){let p=s.maximum;if("array"===Dr(s.maximum)&&(p=s.maximum[t.arrayIndex]),n>p)return[new In(e,n,`${n} is greater than the maximum value ${p}`)]}return[]}function ko(t){const e=t.valueSpec,n=tr(t.value.type);let s,u,p,m={};const v="categorical"!==n&&void 0===t.value.property,E=!v,C="array"===Dr(t.value.stops)&&"array"===Dr(t.value.stops[0])&&"object"===Dr(t.value.stops[0][0]),R=ir({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(K){if("identity"===n)return[new In(K.key,K.value,'identity function may not have a "stops" property')];let J=[];const se=K.value;return J=J.concat(Mr({key:K.key,value:se,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:N})),"array"===Dr(se)&&0===se.length&&J.push(new In(K.key,se,"array must have at least one stop")),J},default:function(K){return ds({key:K.key,value:K.value,valueSpec:e,style:K.style,styleSpec:K.styleSpec})}}});return"identity"===n&&v&&R.push(new In(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||R.push(new In(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!tc(t.valueSpec)&&R.push(new In(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(E&&!Pa(t.valueSpec)?R.push(new In(t.key,t.value,"property functions not supported")):v&&!Oa(t.valueSpec)&&R.push(new In(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!C||void 0!==t.value.property||R.push(new In(t.key,t.value,'"property" property is required')),R;function N(K){let J=[];const se=K.value,De=K.key;if("array"!==Dr(se))return[new In(De,se,`array expected, ${Dr(se)} found`)];if(2!==se.length)return[new In(De,se,`array length 2 expected, length ${se.length} found`)];if(C){if("object"!==Dr(se[0]))return[new In(De,se,`object expected, ${Dr(se[0])} found`)];if(void 0===se[0].zoom)return[new In(De,se,"object stop key must have zoom")];if(void 0===se[0].value)return[new In(De,se,"object stop key must have value")];const We=tr(se[0].zoom);if("number"!=typeof We)return[new In(De,se[0].zoom,"stop zoom values must be numbers")];if(p&&p>We)return[new In(De,se[0].zoom,"stop zoom values must appear in ascending order")];We!==p&&(p=We,u=void 0,m={}),J=J.concat(ir({key:`${De}[0]`,value:se[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:vo,value:H}}))}else J=J.concat(H({key:`${De}[0]`,value:se[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},se));return sn(Ao(se[1]))?J.concat([new In(`${De}[1]`,se[1],"expressions are not allowed in function stops.")]):J.concat(ds({key:`${De}[1]`,value:se[1],valueSpec:e,style:K.style,styleSpec:K.styleSpec}))}function H(K,J){const se=Dr(K.value),De=tr(K.value),We=null!==K.value?K.value:J;if(s){if(se!==s)return[new In(K.key,We,`${se} stop domain type must match previous stop domain type ${s}`)]}else s=se;if("number"!==se&&"string"!==se&&"boolean"!==se&&"number"!=typeof De&&"string"!=typeof De&&"boolean"!=typeof De)return[new In(K.key,We,"stop domain value must be a number, string, or boolean")];if("number"!==se&&"categorical"!==n){let gt=`number expected, ${se} found`;return Pa(e)&&void 0===n&&(gt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new In(K.key,We,gt)]}return"categorical"!==n||"number"!==se||"number"==typeof De&&isFinite(De)&&Math.floor(De)===De?"categorical"!==n&&"number"===se&&"number"==typeof De&&"number"==typeof u&&void 0!==u&&De<u?[new In(K.key,We,"stop domain values must appear in ascending order")]:(u=De,"categorical"===n&&De in m?[new In(K.key,We,"stop domain values must be unique")]:(m[De]=!0,[])):[new In(K.key,We,`integer expected, found ${String(De)}`)]}}function ro(t){const e=("property"===t.expressionContext?ur:zn)(Ao(t.value),t.valueSpec);if("error"===e.result)return e.value.map(s=>new In(`${t.key}${s.key}`,t.value,s.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new In(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!_o(n))return[new In(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return ma(n,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Gi(n,["zoom","feature-state"]))return[new In(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!vs(n))return[new In(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ma(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)n.delete(u);if(0===n.size)return[];const s=[];return t instanceof Ss&&n.has(t.name)?[new In(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(u=>{s.push(...ma(u,e))}),s)}function Jo(t){const e=t.key,n=t.value,s=t.valueSpec,u=[];return Array.isArray(s.values)?-1===s.values.indexOf(tr(n))&&u.push(new In(e,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(s.values).indexOf(tr(n))&&u.push(new In(e,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),u}function Po(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Po(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function es(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Po(t)||(t=ka(t));const n=t;let s=!0;try{s=function(C){if(!ll(C))return C;let R=Ao(C);return bs(R),R=xo(R),R}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}const u=_n[`filter_${e}`],p=zn(s,u);let m=null;if("error"===p.result)throw new Error(p.value.map(C=>`${C.key}: ${C.message}`).join(", "));m=(C,R,N)=>p.value.evaluate(C,R,{},N);let v=null,E=null;if(s!==n){const C=zn(n,u);if("error"===C.result)throw new Error(C.value.map(R=>`${R.key}: ${R.message}`).join(", "));v=(R,N,H,K,J)=>C.value.evaluate(R,N,{},H,void 0,void 0,K,J),E=!vs(C.value.expression)}return{filter:m,dynamicFilter:v||void 0,needGeometry:xc(s),needFeature:!!E}}function xo(t){if(!Array.isArray(t))return t;const e=function(n){if(Ra.has(n[0]))for(let s=1;s<n.length;s++)if(ll(n[s]))return!0;return n}(t);return!0===e?e:e.map(n=>xo(n))}function bs(t){let e=!1;const n=[];if("case"===t[0]){for(let s=1;s<t.length-1;s+=2)e=e||ll(t[s]),n.push(t[s+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||ll(t[1]);for(let s=2;s<t.length-1;s+=2)n.push(t[s+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||ll(t[1]);for(let s=1;s<t.length-1;s+=2)n.push(t[s+1])}e&&(t.length=0,t.push("any",...n));for(let s=1;s<t.length;s++)bs(t[s])}function ll(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++)if(ll(t[n]))return!0;return!1}const Ra=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ur(t,e){return t<e?-1:t>e?1:0}function xc(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(xc(t[e]))return!0;return!1}function ka(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Di(t[1],t[2],"=="):"!="===e?br(Di(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Di(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(ka))):"all"===e?["all"].concat(t.slice(1).map(ka)):"none"===e?["all"].concat(t.slice(1).map(ka).map(br)):"in"===e?Ii(t[1],t.slice(2)):"!in"===e?br(Ii(t[1],t.slice(2))):"has"===e?Zi(t[1]):"!has"===e?br(Zi(t[1])):"within"!==e||t;var n}function Di(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Ii(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Ur)]]:["filter-in-small",t,["literal",e]]}}function Zi(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function br(t){return["!",t]}function oo(t){return Po(Ao(t.value))?ro(So({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):ga(t)}function ga(t){const e=t.value,n=t.key;if("array"!==Dr(e))return[new In(n,e,`array expected, ${Dr(e)} found`)];const s=t.styleSpec;let u,p=[];if(e.length<1)return[new In(n,e,"filter array must have at least 1 element")];switch(p=p.concat(Jo({key:`${n}[0]`,value:e[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),tr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===tr(e[1])&&p.push(new In(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&p.push(new In(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Dr(e[1]),"string"!==u&&p.push(new In(`${n}[1]`,e[1],`string expected, ${u} found`)));for(let m=2;m<e.length;m++)u=Dr(e[m]),"$type"===tr(e[1])?p=p.concat(Jo({key:`${n}[${m}]`,value:e[m],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&p.push(new In(`${n}[${m}]`,e[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<e.length;m++)p=p.concat(ga({key:`${n}[${m}]`,value:e[m],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":u=Dr(e[1]),2!==e.length?p.push(new In(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&p.push(new In(`${n}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Dr(e[1]),2!==e.length?p.push(new In(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&p.push(new In(`${n}[1]`,e[1],`object expected, ${u} found`))}return p}function us(t,e){const n=t.key,s=t.style,u=t.styleSpec,p=t.value,m=t.objectKey,v=u[`${e}_${t.layerType}`];if(!v)return[];const E=m.match(/^(.*)-transition$/);if("paint"===e&&E&&v[E[1]]&&v[E[1]].transition)return ds({key:n,value:p,valueSpec:u.transition,style:s,styleSpec:u});const C=t.valueSpec||v[m];if(!C)return[new In(n,p,`unknown property "${m}"`)];let R;if("string"===Dr(p)&&Pa(C)&&!C.tokens&&(R=/^{([^}]+)}$/.exec(p)))return[new In(n,p,`"${m}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const N=[];return"symbol"===t.layerType&&("text-field"===m&&s&&!s.glyphs&&N.push(new In(n,p,'use of "text-field" requires a style "glyphs" property')),"text-font"===m&&Ul(Ao(p))&&"identity"===tr(p.type)&&N.push(new In(n,p,'"text-font" does not support identity functions'))),N.concat(ds({key:t.key,value:p,valueSpec:C,style:s,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:m}))}function Gs(t){return us(t,"paint")}function Or(t){return us(t,"layout")}function Js(t){let e=[];const n=t.value,s=t.key,u=t.style,p=t.styleSpec;n.type||n.ref||e.push(new In(s,n,'either "type" or "ref" is required'));let m=tr(n.type);const v=tr(n.ref);if(n.id){const E=tr(n.id);for(let C=0;C<t.arrayIndex;C++){const R=u.layers[C];tr(R.id)===E&&e.push(new In(s,n.id,`duplicate layer id "${n.id}", previously used at line ${R.id.__line__}`))}}if("ref"in n){let E;["type","source","source-layer","filter","layout"].forEach(C=>{C in n&&e.push(new In(s,n[C],`"${C}" is prohibited for ref layers`))}),u.layers.forEach(C=>{tr(C.id)===v&&(E=C)}),E?E.ref?e.push(new In(s,n.ref,"ref cannot reference another ref layer")):m=tr(E.type):"string"==typeof v&&e.push(new In(s,n.ref,`ref layer "${v}" not found`))}else if("background"!==m&&"sky"!==m)if(n.source){const E=u.sources&&u.sources[n.source],C=E&&tr(E.type);E?"vector"===C&&"raster"===m?e.push(new In(s,n.source,`layer "${n.id}" requires a raster source`)):"raster"===C&&"raster"!==m?e.push(new In(s,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==C||n["source-layer"]?"raster-dem"===C&&"hillshade"!==m?e.push(new In(s,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==m||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===C&&E.lineMetrics||e.push(new In(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new In(s,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new In(s,n.source,`source "${n.source}" not found`))}else e.push(new In(s,n,'missing required property "source"'));return e=e.concat(ir({key:s,value:n,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ds({key:`${s}.type`,value:n.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:E=>oo(So({layerType:m},E)),layout:E=>ir({layer:n,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>Or(So({layerType:m},C))}}),paint:E=>ir({layer:n,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>Gs(So({layerType:m},C))}})}})),e}function qo(t){const e=t.value,n=t.key,s=Dr(e);return"string"!==s?[new In(n,e,`string expected, ${s} found`)]:[]}const Uo={promoteId:function({key:t,value:e}){if("string"===Dr(e))return qo({key:t,value:e});{const n=[];for(const s in e)n.push(...qo({key:`${t}.${s}`,value:e[s]}));return n}}};function ea(t){const e=t.value,n=t.key,s=t.styleSpec,u=t.style;if(!e.type)return[new In(n,e,'"type" is required')];const p=tr(e.type);let m;switch(p){case"vector":case"raster":case"raster-dem":return m=ir({key:n,value:e,valueSpec:s[`source_${p.replace("-","_")}`],style:t.style,styleSpec:s,objectElementValidators:Uo}),m;case"geojson":if(m=ir({key:n,value:e,valueSpec:s.source_geojson,style:u,styleSpec:s,objectElementValidators:Uo}),e.cluster)for(const v in e.clusterProperties){const[E,C]=e.clusterProperties[v],R="string"==typeof E?[E,["accumulated"],["get",v]]:E;m.push(...ro({key:`${n}.${v}.map`,value:C,expressionContext:"cluster-map"})),m.push(...ro({key:`${n}.${v}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return m;case"video":return ir({key:n,value:e,valueSpec:s.source_video,style:u,styleSpec:s});case"image":return ir({key:n,value:e,valueSpec:s.source_image,style:u,styleSpec:s});case"canvas":return[new In(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jo({key:`${n}.type`,value:e.type,valueSpec:{values:bo(s)},style:u,styleSpec:s})}}function bo(t){return t.source.reduce((e,n)=>{const s=t[n];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function _l(t){const e=t.value,n=t.styleSpec,s=n.light,u=t.style;let p=[];const m=Dr(e);if(void 0===e)return p;if("object"!==m)return p=p.concat([new In("light",e,`object expected, ${m} found`)]),p;for(const v in e){const E=v.match(/^(.*)-transition$/);p=p.concat(E&&s[E[1]]&&s[E[1]].transition?ds({key:v,value:e[v],valueSpec:n.transition,style:u,styleSpec:n}):s[v]?ds({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:n}):[new In(v,e[v],`unknown property "${v}"`)])}return p}function Vl(t){const e=t.value,n=t.key,s=t.style,u=t.styleSpec,p=u.terrain;let m=[];const v=Dr(e);if(void 0===e)return m;if("object"!==v)return m=m.concat([new In("terrain",e,`object expected, ${v} found`)]),m;for(const E in e){const C=E.match(/^(.*)-transition$/);m=m.concat(C&&p[C[1]]&&p[C[1]].transition?ds({key:E,value:e[E],valueSpec:u.transition,style:s,styleSpec:u}):p[E]?ds({key:E,value:e[E],valueSpec:p[E],style:s,styleSpec:u}):[new In(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=s.sources&&s.sources[e.source],C=E&&tr(E.type);E?"raster-dem"!==C&&m.push(new In(n,e.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):m.push(new In(n,e.source,`source "${e.source}" not found`))}else m.push(new In(n,e,'terrain is missing required property "source"'));return m}function qr(t){const e=t.value,n=t.style,s=t.styleSpec,u=s.fog;let p=[];const m=Dr(e);if(void 0===e)return p;if("object"!==m)return p=p.concat([new In("fog",e,`object expected, ${m} found`)]),p;for(const v in e){const E=v.match(/^(.*)-transition$/);p=p.concat(E&&u[E[1]]&&u[E[1]].transition?ds({key:v,value:e[v],valueSpec:s.transition,style:n,styleSpec:s}):u[v]?ds({key:v,value:e[v],valueSpec:u[v],style:n,styleSpec:s}):[new In(v,e[v],`unknown property "${v}"`)])}return p}const Pu={"*":()=>[],array:Mr,boolean:function(t){const e=t.value,n=t.key,s=Dr(e);return"boolean"!==s?[new In(n,e,`boolean expected, ${s} found`)]:[]},number:vo,color:function(t){const e=t.key,n=t.value,s=Dr(n);return"string"!==s?[new In(e,n,`color expected, ${s} found`)]:null===ks(n)?[new In(e,n,`color expected, "${n}" found`)]:[]},enum:Jo,filter:oo,function:ko,layer:Js,object:ir,source:ea,light:_l,terrain:Vl,fog:qr,string:qo,formatted:function(t){return 0===qo(t).length?[]:ro(t)},resolvedImage:function(t){return 0===qo(t).length?[]:ro(t)},projection:function(t){const e=t.value,n=t.styleSpec,s=n.projection,u=t.style;let p=[];const m=Dr(e);if("object"===m)for(const v in e)p=p.concat(ds({key:v,value:e[v],valueSpec:s[v],style:u,styleSpec:n}));else"string"!==m&&(p=p.concat([new In("projection",e,`object or string expected, ${m} found`)]));return p}};function ds(t){const e=t.value,n=t.valueSpec,s=t.styleSpec;return n.expression&&Ul(tr(e))?ko(t):n.expression&&sn(Ao(e))?ro(t):n.type&&Pu[n.type]?Pu[n.type](t):ir(So({},t,{valueSpec:n.type?s[n.type]:n}))}function ah(t){const e=t.value,n=t.key,s=qo(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new In(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new In(n,e,'"glyphs" url must include a "{range}" token'))),s}function Ou(t,e=_n){return yl(ds({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:ah,"*":()=>[]}}))}const lh=t=>yl(Gs(t)),dd=t=>yl(Or(t));function yl(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function bc(t,e){let n=!1;if(e&&e.length)for(const s of e)t.fire(new Xr(new Error(s.message))),n=!0;return n}var vl=xl;function xl(t,e,n){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(n=u[2]);for(var p=0;p<this.d*this.d;p++){var m=u[3+p],v=u[3+p+1];s.push(m===v?null:u.subarray(m,v))}var E=u[3+s.length+1];this.keys=u.subarray(u[3+s.length],E),this.bboxes=u.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var C=0;C<this.d*this.d;C++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var R=n/e*t;this.min=-R,this.max=t+R}xl.prototype.insert=function(t,e,n,s,u){this._forEachCell(e,n,s,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(u)},xl.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},xl.prototype._insertCell=function(t,e,n,s,u,p){this.cells[u].push(p)},xl.prototype.query=function(t,e,n,s,u){var p=this.min,m=this.max;if(t<=p&&e<=p&&m<=n&&m<=s&&!u)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,n,s,this._queryCell,v,{},u),v},xl.prototype._queryCell=function(t,e,n,s,u,p,m,v){var E=this.cells[u];if(null!==E)for(var C=this.keys,R=this.bboxes,N=0;N<E.length;N++){var H=E[N];if(void 0===m[H]){var K=4*H;(v?v(R[K+0],R[K+1],R[K+2],R[K+3]):t<=R[K+2]&&e<=R[K+3]&&n>=R[K+0]&&s>=R[K+1])?(m[H]=!0,p.push(C[H])):m[H]=!1}}},xl.prototype._forEachCell=function(t,e,n,s,u,p,m,v){for(var E=this._convertToCellCoord(t),C=this._convertToCellCoord(e),R=this._convertToCellCoord(n),N=this._convertToCellCoord(s),H=E;H<=R;H++)for(var K=C;K<=N;K++){var J=this.d*K+H;if((!v||v(this._convertFromCellCoord(H),this._convertFromCellCoord(K),this._convertFromCellCoord(H+1),this._convertFromCellCoord(K+1)))&&u.call(this,t,e,n,s,J,p,m,v))return}},xl.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},xl.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},xl.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,s=0;s<this.cells.length;s++)n+=this.cells[s].length;var u=new Int32Array(e+n+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var p=e,m=0;m<t.length;m++){var v=t[m];u[3+m]=p,u.set(v,p),p+=v.length}return u[3+t.length]=p,u.set(this.keys,p),u[3+t.length+1]=p+=this.keys.length,u.set(this.bboxes,p),p+=this.bboxes.length,u.buffer};const Oo={};function pi(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Oo[e]={klass:t,omit:n.omit||[]}}pi(Object,"Object"),vl.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},vl.deserialize=function(t){return new vl(t.buffer)},Object.defineProperty(vl,"name",{value:"Grid"}),pi(vl,"Grid"),pi(kr,"Color"),pi(Error,"Error"),pi(nt,"AJAXError"),pi(mo,"ResolvedImage"),pi(Xi,"StylePropertyFunction"),pi(Ot,"StyleExpression",{omit:["_evaluator"]}),pi(Mi,"ZoomDependentExpression"),pi(di,"ZoomConstantExpression"),pi(Ss,"CompoundExpression",{omit:["_evaluate"]});for(const t in qa)Oo[qa[t]._classRegistryKey]||pi(qa[t],`Expression${t}`);function nc(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function hd(t){return de.ImageBitmap&&t instanceof de.ImageBitmap}function bl(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(nc(t)||hd(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof de.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const s of t)n.push(bl(s,e));return n}if("object"==typeof t){const n=t.constructor,s=n._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const u=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const p in t)t.hasOwnProperty(p)&&(Oo[s].omit.indexOf(p)>=0||(u[p]=bl(t[p],e)));t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(u.$name=s),u}throw new Error("can't serialize object of type "+typeof t)}function hs(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||nc(t)||hd(t)||ArrayBuffer.isView(t)||t instanceof de.ImageData)return t;if(Array.isArray(t))return t.map(hs);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=Oo[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const s=Object.create(n.prototype);for(const u of Object.keys(t))"$name"!==u&&(s[u]=hs(t[u]));return s}throw new Error("can't deserialize object of type "+typeof t)}const Fa=t=>t>=1536&&t<=1791,su=t=>t>=1872&&t<=1919,ic=t=>t>=2208&&t<=2303,wl=t=>t>=11904&&t<=12031,jc=t=>t>=12032&&t<=12255,Ru=t=>t>=12272&&t<=12287,O=t=>t>=12288&&t<=12351,k=t=>t>=12352&&t<=12447,I=t=>t>=12448&&t<=12543,V=t=>t>=12544&&t<=12591,Y=t=>t>=12704&&t<=12735,me=t=>t>=12736&&t<=12783,et=t=>t>=12784&&t<=12799,bt=t=>t>=12800&&t<=13055,Sn=t=>t>=13056&&t<=13311,fi=t=>t>=13312&&t<=19903,rr=t=>t>=19968&&t<=40959,Si=t=>t>=40960&&t<=42127,Vr=t=>t>=42128&&t<=42191,ws=t=>t>=44032&&t<=55215,ta=t=>t>=63744&&t<=64255,d=t=>t>=64336&&t<=65023,i=t=>t>=65040&&t<=65055,c=t=>t>=65072&&t<=65103,f=t=>t>=65104&&t<=65135,y=t=>t>=65136&&t<=65279,x=t=>t>=65280&&t<=65519;function D(t){for(const e of t)if(W(e.charCodeAt(0)))return!0;return!1}function P(t){for(const e of t)if(!F(e.charCodeAt(0)))return!1;return!0}function F(t){return!(Fa(t)||su(t)||ic(t)||d(t)||y(t))}function W(t){return!(746!==t&&747!==t&&(t<4352||!(Y(t)||V(t)||c(t)&&!(t>=65097&&t<=65103)||ta(t)||Sn(t)||wl(t)||me(t)||!(!O(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||fi(t)||rr(t)||bt(t)||(e=t,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||ws(t)||k(t)||Ru(t)||(e=>e>=12688&&e<=12703)(t)||jc(t)||et(t)||I(t)&&12540!==t||!(!x(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!f(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||i(t)||(e=>e>=19904&&e<=19967)(t)||Si(t)||Vr(t))));var e}function Z(t){return!(W(t)||(e=t,(n=e)>=128&&n<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(n=>n>=8192&&n<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&9251!==e||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||O(e)||I(e)||(n=>n>=57344&&n<=63743)(e)||c(e)||f(e)||x(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,n}function ie(t){return t>=1424&&t<=2303||d(t)||y(t)}function ve(t,e){return!(!e&&ie(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=t,n>=6016&&n<=6143));var n}function Pe(t){for(const e of t)if(ie(e.charCodeAt(0)))return!0;return!1}const Oe="deferred",Be="loading",Te="loaded";let Ae=null,je="unavailable",ze=null;const st=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(je="error"),Ae&&Ae(t)};function Dt(){vt.fire(new fo("pluginStateChange",{pluginStatus:je,pluginURL:ze}))}const vt=new Cr,Ut=function(){return je},ln=function(){if(je!==Oe||!ze)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");je=Be,Dt(),ze&&ni({url:ze},t=>{t?st(t):(je=Te,Dt())})},rn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>je===Te||null!=rn.applyArabicShaping,isLoading:()=>je===Be,setState(t){je=t.pluginStatus,ze=t.pluginURL},isParsed:()=>null!=rn.applyArabicShaping&&null!=rn.processBidirectionalText&&null!=rn.processStyledBidirectionalText,getPluginURL:()=>ze};class $t{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,s){for(const u of n)if(!ve(u.charCodeAt(0),s))return!1;return!0}(e,rn.isLoaded())}}class qn{constructor(e,n){this.property=e,this.value=n,this.expression=function(s,u){if(Ul(s))return new Xi(s,u);if(sn(s)){const p=ur(s,u);if("error"===p.result)throw new Error(p.value.map(m=>`${m.key}: ${m.message}`).join(", "));return p.value}{let p=s;return"string"==typeof s&&"color"===u.type&&(p=kr.parse(s)),{kind:"constant",evaluate:()=>p}}}(void 0===n?e.specification.default:n,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)}}class Kt{constructor(e){this.property=e,this.value=new qn(e,void 0)}transitioned(e,n){return new mn(this.property,this.value,n,Xt({},e.transition,this.transition),e.now)}untransitioned(){return new mn(this.property,this.value,null,{},0)}}class Pn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Fe(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Kt(this._values[e].property)),this._values[e].value=new qn(this._values[e].property,null===n?void 0:Fe(n))}getTransition(e){return Fe(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new Kt(this._values[e].property)),this._values[e].transition=Fe(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s);const u=this.getTransition(n);void 0!==u&&(e[`${n}-transition`]=u)}return e}transitioned(e,n){const s=new Wn(this._properties);for(const u of Object.keys(this._values))s._values[u]=this._values[u].transitioned(e,n._values[u]);return s}untransitioned(){const e=new Wn(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class mn{constructor(e,n,s,u,p){const m=u.delay||0,v=u.duration||0;p=p||0,this.property=e,this.value=n,this.begin=p+m,this.end=this.begin+v,e.specification.transition&&(u.delay||u.duration)&&(this.prior=s)}possiblyEvaluate(e,n,s){const u=e.now||0,p=this.value.possiblyEvaluate(e,n,s),m=this.prior;if(m){if(u>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(u<this.begin)return m.possiblyEvaluate(e,n,s);{const v=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(e,n,s),p,zt(v))}}return p}}class Wn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,s){const u=new Qn(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,n,s);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class pn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Fe(this._values[e].value)}setValue(e,n){this._values[e]=new qn(this._values[e].property,null===n?void 0:Fe(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s)}return e}possiblyEvaluate(e,n,s){const u=new Qn(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].possiblyEvaluate(e,n,s);return u}}class Un{constructor(e,n,s){this.property=e,this.value=n,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,n,s,u){return this.property.evaluate(this.value,this.parameters,e,n,s,u)}}class Qn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class qt{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,s){const u=ar[this.specification.type];return u?u(e,n,s):e}}class dn{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,s,u){return new Un(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(n,null,{},s,u)}:e.expression,n)}interpolate(e,n,s){if("constant"!==e.value.kind||"constant"!==n.value.kind)return e;if(void 0===e.value.value||void 0===n.value.value)return new Un(this,{kind:"constant",value:void 0},e.parameters);const u=ar[this.specification.type];return u?new Un(this,{kind:"constant",value:u(e.value.value,n.value.value,s)},e.parameters):e}evaluate(e,n,s,u,p,m){return"constant"===e.kind?e.value:e.evaluate(n,s,u,p,m)}}class Ei{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,u){return!!e.expression.evaluate(n,null,{},s,u)}interpolate(){return!1}}class ki{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new $t(0,{});for(const s in e){const u=e[s];u.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new qn(u,void 0),m=this.defaultTransitionablePropertyValues[s]=new Kt(u);this.defaultTransitioningPropertyValues[s]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate(n)}}}function Ci(t,e){return 256*(t=Ke(Math.floor(t),0,255))+Ke(Math.floor(e),0,255)}pi(dn,"DataDrivenProperty"),pi(qt,"DataConstantProperty"),pi(Ei,"ColorRampProperty");const ji={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class or{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function gi(t,e=1){let n=0,s=0;return{members:t.map(u=>{const p=ji[u.type].BYTES_PER_ELEMENT,m=n=jr(n,Math.max(e,p)),v=u.components||1;return s=Math.max(s,p),n+=p*v,{name:u.name,type:u.type,components:v,offset:m}}),size:jr(n,Math.max(s,e)),alignment:e}}function jr(t,e){return Math.ceil(t/e)*e}class Pr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.int16[u+0]=n,this.int16[u+1]=s,e}}Pr.prototype.bytesPerElement=4,pi(Pr,"StructArrayLayout2i4");class so extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const p=3*e;return this.int16[p+0]=n,this.int16[p+1]=s,this.int16[p+2]=u,e}}so.prototype.bytesPerElement=6,pi(so,"StructArrayLayout3i6");class Hr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,u)}emplace(e,n,s,u,p){const m=4*e;return this.int16[m+0]=n,this.int16[m+1]=s,this.int16[m+2]=u,this.int16[m+3]=p,e}}Hr.prototype.bytesPerElement=8,pi(Hr,"StructArrayLayout4i8");class La extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,s,u,p,m,v)}emplace(e,n,s,u,p,m,v,E){const C=6*e,R=12*e,N=3*e;return this.int16[C+0]=n,this.int16[C+1]=s,this.uint8[R+4]=u,this.uint8[R+5]=p,this.uint8[R+6]=m,this.uint8[R+7]=v,this.float32[N+2]=E,e}}La.prototype.bytesPerElement=12,pi(La,"StructArrayLayout2i4ub1f12");class na extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,u)}emplace(e,n,s,u,p){const m=4*e;return this.float32[m+0]=n,this.float32[m+1]=s,this.float32[m+2]=u,this.float32[m+3]=p,e}}na.prototype.bytesPerElement=16,pi(na,"StructArrayLayout4f16");class ia extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,s,u,p)}emplace(e,n,s,u,p,m){const v=6*e,E=3*e;return this.uint16[v+0]=n,this.uint16[v+1]=s,this.uint16[v+2]=u,this.uint16[v+3]=p,this.float32[E+2]=m,e}}ia.prototype.bytesPerElement=12,pi(ia,"StructArrayLayout4ui1f12");class cl extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,u)}emplace(e,n,s,u,p){const m=4*e;return this.uint16[m+0]=n,this.uint16[m+1]=s,this.uint16[m+2]=u,this.uint16[m+3]=p,e}}cl.prototype.bytesPerElement=8,pi(cl,"StructArrayLayout4ui8");class Yr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,p,m)}emplace(e,n,s,u,p,m,v){const E=6*e;return this.int16[E+0]=n,this.int16[E+1]=s,this.int16[E+2]=u,this.int16[E+3]=p,this.int16[E+4]=m,this.int16[E+5]=v,e}}Yr.prototype.bytesPerElement=12,pi(Yr,"StructArrayLayout6i12");class Gr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v,E,C,R,N,H){const K=this.length;return this.resize(K+1),this.emplace(K,e,n,s,u,p,m,v,E,C,R,N,H)}emplace(e,n,s,u,p,m,v,E,C,R,N,H,K){const J=12*e;return this.int16[J+0]=n,this.int16[J+1]=s,this.int16[J+2]=u,this.int16[J+3]=p,this.uint16[J+4]=m,this.uint16[J+5]=v,this.uint16[J+6]=E,this.uint16[J+7]=C,this.int16[J+8]=R,this.int16[J+9]=N,this.int16[J+10]=H,this.int16[J+11]=K,e}}Gr.prototype.bytesPerElement=24,pi(Gr,"StructArrayLayout4i4ui4i24");class wr extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m){const v=this.length;return this.resize(v+1),this.emplace(v,e,n,s,u,p,m)}emplace(e,n,s,u,p,m,v){const E=10*e,C=5*e;return this.int16[E+0]=n,this.int16[E+1]=s,this.int16[E+2]=u,this.float32[C+2]=p,this.float32[C+3]=m,this.float32[C+4]=v,e}}wr.prototype.bytesPerElement=20,pi(wr,"StructArrayLayout3i3f20");class Vo extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}Vo.prototype.bytesPerElement=4,pi(Vo,"StructArrayLayout1ul4");class $s extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v,E,C,R,N,H,K){const J=this.length;return this.resize(J+1),this.emplace(J,e,n,s,u,p,m,v,E,C,R,N,H,K)}emplace(e,n,s,u,p,m,v,E,C,R,N,H,K,J){const se=20*e,De=10*e;return this.int16[se+0]=n,this.int16[se+1]=s,this.int16[se+2]=u,this.int16[se+3]=p,this.int16[se+4]=m,this.float32[De+3]=v,this.float32[De+4]=E,this.float32[De+5]=C,this.float32[De+6]=R,this.int16[se+14]=N,this.uint32[De+8]=H,this.uint16[se+18]=K,this.uint16[se+19]=J,e}}$s.prototype.bytesPerElement=40,pi($s,"StructArrayLayout5i4f1i1ul2ui40");class po extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v){const E=this.length;return this.resize(E+1),this.emplace(E,e,n,s,u,p,m,v)}emplace(e,n,s,u,p,m,v,E){const C=8*e;return this.int16[C+0]=n,this.int16[C+1]=s,this.int16[C+2]=u,this.int16[C+4]=p,this.int16[C+5]=m,this.int16[C+6]=v,this.int16[C+7]=E,e}}po.prototype.bytesPerElement=16,pi(po,"StructArrayLayout3i2i2i16");class Es extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,s,u,p)}emplace(e,n,s,u,p,m){const v=4*e,E=8*e;return this.float32[v+0]=n,this.float32[v+1]=s,this.float32[v+2]=u,this.int16[E+6]=p,this.int16[E+7]=m,e}}Es.prototype.bytesPerElement=16,pi(Es,"StructArrayLayout2f1f2i16");class wc extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,u)}emplace(e,n,s,u,p){const m=12*e,v=3*e;return this.uint8[m+0]=n,this.uint8[m+1]=s,this.float32[v+1]=u,this.float32[v+2]=p,e}}wc.prototype.bytesPerElement=12,pi(wc,"StructArrayLayout2ub2f12");class El extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const p=3*e;return this.float32[p+0]=n,this.float32[p+1]=s,this.float32[p+2]=u,e}}El.prototype.bytesPerElement=12,pi(El,"StructArrayLayout3f12");class Ps extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const u=this.length;return this.resize(u+1),this.emplace(u,e,n,s)}emplace(e,n,s,u){const p=3*e;return this.uint16[p+0]=n,this.uint16[p+1]=s,this.uint16[p+2]=u,e}}Ps.prototype.bytesPerElement=6,pi(Ps,"StructArrayLayout3ui6");class Ba extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct)}emplace(e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct,mt){const an=30*e,en=15*e,An=60*e;return this.int16[an+0]=n,this.int16[an+1]=s,this.int16[an+2]=u,this.float32[en+2]=p,this.float32[en+3]=m,this.uint16[an+8]=v,this.uint16[an+9]=E,this.uint32[en+5]=C,this.uint32[en+6]=R,this.uint32[en+7]=N,this.uint16[an+16]=H,this.uint16[an+17]=K,this.uint16[an+18]=J,this.float32[en+10]=se,this.float32[en+11]=De,this.uint8[An+48]=We,this.uint8[An+49]=gt,this.uint8[An+50]=Ze,this.uint32[en+13]=at,this.int16[an+28]=Ct,this.uint8[An+58]=mt,e}}Ba.prototype.bytesPerElement=60,pi(Ba,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Zs extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct,mt,an,en,An,Yn,gn,Bn,Vn,$n){const Kn=this.length;return this.resize(Kn+1),this.emplace(Kn,e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct,mt,an,en,An,Yn,gn,Bn,Vn,$n)}emplace(e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De,We,gt,Ze,at,Ct,mt,an,en,An,Yn,gn,Bn,Vn,$n,Kn){const yn=38*e,oi=19*e;return this.int16[yn+0]=n,this.int16[yn+1]=s,this.int16[yn+2]=u,this.float32[oi+2]=p,this.float32[oi+3]=m,this.int16[yn+8]=v,this.int16[yn+9]=E,this.int16[yn+10]=C,this.int16[yn+11]=R,this.int16[yn+12]=N,this.int16[yn+13]=H,this.uint16[yn+14]=K,this.uint16[yn+15]=J,this.uint16[yn+16]=se,this.uint16[yn+17]=De,this.uint16[yn+18]=We,this.uint16[yn+19]=gt,this.uint16[yn+20]=Ze,this.uint16[yn+21]=at,this.uint16[yn+22]=Ct,this.uint16[yn+23]=mt,this.uint16[yn+24]=an,this.uint16[yn+25]=en,this.uint16[yn+26]=An,this.uint16[yn+27]=Yn,this.uint16[yn+28]=gn,this.uint32[oi+15]=Bn,this.float32[oi+16]=Vn,this.float32[oi+17]=$n,this.float32[oi+18]=Kn,e}}Zs.prototype.bytesPerElement=76,pi(Zs,"StructArrayLayout3i2f6i15ui1ul3f76");class Cl extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}Cl.prototype.bytesPerElement=4,pi(Cl,"StructArrayLayout1f4");class au extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,u,p){const m=this.length;return this.resize(m+1),this.emplace(m,e,n,s,u,p)}emplace(e,n,s,u,p,m){const v=5*e;return this.float32[v+0]=n,this.float32[v+1]=s,this.float32[v+2]=u,this.float32[v+3]=p,this.float32[v+4]=m,e}}au.prototype.bytesPerElement=20,pi(au,"StructArrayLayout5f20");class Hc extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,n,s,u)}emplace(e,n,s,u,p){const m=6*e;return this.uint32[3*e+0]=n,this.uint16[m+2]=s,this.uint16[m+3]=u,this.uint16[m+4]=p,e}}Hc.prototype.bytesPerElement=12,pi(Hc,"StructArrayLayout1ul3ui12");class Ml extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.uint16[u+0]=n,this.uint16[u+1]=s,e}}Ml.prototype.bytesPerElement=4,pi(Ml,"StructArrayLayout2ui4");class pd extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}pd.prototype.bytesPerElement=2,pi(pd,"StructArrayLayout1ui2");class Dl extends Pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const u=2*e;return this.float32[u+0]=n,this.float32[u+1]=s,e}}Dl.prototype.bytesPerElement=8,pi(Dl,"StructArrayLayout2f8");class lu extends or{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}lu.prototype.size=40;class hp extends $s{get(e){return new lu(this,e)}}pi(hp,"CollisionBoxArray");class Vf extends or{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Vf.prototype.size=60;class jf extends Ba{get(e){return new Vf(this,e)}}pi(jf,"PlacedSymbolArray");class Hf extends or{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Hf.prototype.size=76;class Gf extends Zs{get(e){return new Hf(this,e)}}pi(Gf,"SymbolInstanceArray");class $f extends Cl{getoffsetX(e){return this.float32[1*e+0]}}pi($f,"GlyphOffsetArray");class pp extends Pr{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}pi(pp,"SymbolLineVertexArray");class Zf extends or{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Zf.prototype.size=12;class Wf extends Hc{get(e){return new Zf(this,e)}}pi(Wf,"FeatureIndexArray");class qf extends Ml{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}pi(qf,"FillExtrusionCentroidArray");const Hg=gi([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),ch=gi([{name:"a_dash",components:4,type:"Uint16"}]);var Ya={exports:{}},mp=function(t,e){var n,s,u,p,m,v,E,C;for(s=t.length-(n=3&t.length),u=e,m=3432918353,v=461845907,C=0;C<s;)E=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,u=27492+(65535&(p=5*(65535&(u=(u^=E=(65535&(E=(E=(65535&E)*m+(((E>>>16)*m&65535)<<16)&4294967295)<<15|E>>>17))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(E=0,n){case 3:E^=(255&t.charCodeAt(C+2))<<16;case 2:E^=(255&t.charCodeAt(C+1))<<8;case 1:u^=E=(65535&(E=(E=(65535&(E^=255&t.charCodeAt(C)))*m+(((E>>>16)*m&65535)<<16)&4294967295)<<15|E>>>17))*v+(((E>>>16)*v&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},Yf=function(t,e){for(var n,s=t.length,u=e^s,p=0;s>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(p)|(255&t.charCodeAt(++p))<<8|(255&t.charCodeAt(++p))<<16|(255&t.charCodeAt(++p))<<24))+((1540483477*(n>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),s-=4,++p;switch(s){case 3:u^=(255&t.charCodeAt(p+2))<<16;case 2:u^=(255&t.charCodeAt(p+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(p)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};Ya.exports=mp,Ya.exports.murmur3=mp,Ya.exports.murmur2=Yf;class gp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,s,u){this.ids.push(Gg(e)),this.positions.push(n,s,u)}getPositions(e){const n=Gg(e);let s=0,u=this.ids.length-1;for(;s<u;){const m=s+u>>1;this.ids[m]>=n?u=m:s=m+1}const p=[];for(;this.ids[s]===n;)p.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return p}static serialize(e,n){const s=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Kf(s,u,0,s.length-1),n&&n.push(s.buffer,u.buffer),{ids:s,positions:u}}static deserialize(e){const n=new gp;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function Gg(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ya.exports(String(t))}function Kf(t,e,n,s){for(;n<s;){const u=t[n+s>>1];let p=n-1,m=s+1;for(;;){do{p++}while(t[p]<u);do{m--}while(t[m]>u);if(p>=m)break;Fu(t,p,m),Fu(e,3*p,3*m),Fu(e,3*p+1,3*m+1),Fu(e,3*p+2,3*m+2)}m-n<s-m?(Kf(t,e,n,m),n=m+1):(Kf(t,e,m+1,s),s=m)}}function Fu(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}pi(gp,"FeaturePositionMap");class jl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class _p extends jl{constructor(e){super(e),this.current=0}set(e,n,s){this.fetchUniformLocation(e,n)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class $g extends jl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,s){this.fetchUniformLocation(e,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class yp extends jl{constructor(e){super(e),this.current=kr.transparent}set(e,n,s){this.fetchUniformLocation(e,n)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const Zg=new Float32Array(16),Wg=new Float32Array(9),qg=new Float32Array(4);function vp(t){return[Ci(255*t.r,255*t.g),Ci(255*t.b,255*t.a)]}class Lu{constructor(e,n,s){this.value=e,this.uniformNames=n.map(u=>`u_${u}`),this.type=s}setUniform(e,n,s,u,p){n.set(e,p,u.constantOr(this.value))}getBinding(e,n){return"color"===this.type?new yp(e):new _p(e)}}class Ec{constructor(e,n){this.uniformNames=n.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,s,u,p){const m="u_pattern"===p||"u_dash"===p?this.pattern:"u_pixel_ratio"===p?this.pixelRatio:null;m&&n.set(e,p,m)}getBinding(e,n){return"u_pattern"===n||"u_dash"===n?new $g(e):new _p(e)}}class rc{constructor(e,n,s,u){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,n,s,u,p,m){const v=this.paintVertexArray.length,E=this.expression.evaluate(new $t(0),n,{},p,u,m);this.paintVertexArray.resize(e),this._setPaintValue(v,e,E)}updatePaintArray(e,n,s,u,p){const m=this.expression.evaluate({zoom:0},s,u,void 0,p);this._setPaintValue(e,n,m)}_setPaintValue(e,n,s){if("color"===this.type){const u=vp(s);for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,u[0],u[1])}else{for(let u=e;u<n;u++)this.paintVertexArray.emplace(u,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ul{constructor(e,n,s,u,p,m){this.expression=e,this.uniformNames=n.map(v=>`u_${v}_t`),this.type=s,this.useIntegerZoom=u,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=n.map(v=>({name:`a_${v}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(e,n,s,u,p,m){const v=this.expression.evaluate(new $t(this.zoom),n,{},p,u,m),E=this.expression.evaluate(new $t(this.zoom+1),n,{},p,u,m),C=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(C,e,v,E)}updatePaintArray(e,n,s,u,p){const m=this.expression.evaluate({zoom:this.zoom},s,u,void 0,p),v=this.expression.evaluate({zoom:this.zoom+1},s,u,void 0,p);this._setPaintValue(e,n,m,v)}_setPaintValue(e,n,s,u){if("color"===this.type){const p=vp(s),m=vp(u);for(let v=e;v<n;v++)this.paintVertexArray.emplace(v,p[0],p[1],m[0],m[1])}else{for(let p=e;p<n;p++)this.paintVertexArray.emplace(p,s,u);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,s,u,p){const m=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,v=Ke(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);n.set(e,p,v)}getBinding(e,n){return new _p(e)}}class Gc{constructor(e,n,s,u,p){this.expression=e,this.layerId=p,this.paintVertexAttributes=("array"===s?ch:Hg).members;for(let m=0;m<n.length;++m);this.paintVertexArray=new u}populatePaintArray(e,n,s){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,n.patterns&&n.patterns[this.layerId],s)}updatePaintArray(e,n,s,u,p,m){this._setPaintValues(e,n,s.patterns&&s.patterns[this.layerId],m)}_setPaintValues(e,n,s,u){if(!u||!s)return;const p=u[s];if(!p)return;const{tl:m,br:v,pixelRatio:E}=p;for(let C=e;C<n;C++)this.paintVertexArray.emplace(C,m[0],m[1],v[0],v[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Do{constructor(e,n,s=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const p in e.paint._values){if(!s(p))continue;const m=e.paint.get(p);if(!(m instanceof Un&&Pa(m.property.specification)))continue;const v=xp(p,e.type),E=m.value,C=m.property.specification.type,R=m.property.useIntegerZoom,N="line-dasharray"===p||p.endsWith("pattern"),H="line-dasharray"===p&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==E.kind||H)if("source"===E.kind||H||N){const K=Qf(p,C,"source");this.binders[p]=N?new Gc(E,v,C,K,e.id):new rc(E,v,C,K),u.push(`/a_${p}`)}else{const K=Qf(p,C,"composite");this.binders[p]=new ul(E,v,C,R,n,K),u.push(`/z_${p}`)}else this.binders[p]=N?new Ec(E.value,v):new Lu(E.value,v,C),u.push(`/u_${p}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof rc||n instanceof ul?n.maxValue:0}populatePaintArrays(e,n,s,u,p,m){for(const v in this.binders){const E=this.binders[v];(E instanceof rc||E instanceof ul||E instanceof Gc)&&E.populatePaintArray(e,n,s,u,p,m)}}setConstantPatternPositions(e){for(const n in this.binders){const s=this.binders[n];s instanceof Ec&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,n,s,u,p,m){let v=!1;for(const E in e){const C=n.getPositions(E);for(const R of C){const N=s.feature(R.index);for(const H in this.binders){const K=this.binders[H];if((K instanceof rc||K instanceof ul||K instanceof Gc)&&!0===K.expression.isStateDependent){const J=u.paint.get(H);K.expression=J.value,K.updatePaintArray(R.start,R.end,N,e[E],p,m),v=!0}}}}return v}defines(){const e=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Lu||s instanceof Ec)&&e.push(...s.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof rc||s instanceof ul||s instanceof Gc)for(let u=0;u<s.paintVertexAttributes.length;u++)e.push(s.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof Lu||s instanceof Ec||s instanceof ul)for(const u of s.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Lu||u instanceof Ec||u instanceof ul)for(const p of u.uniformNames)n.push({name:p,property:s,binding:u.getBinding(e,p)})}return n}setUniforms(e,n,s,u,p){for(const{name:m,property:v,binding:E}of s)this.binders[v].setUniform(e,E,p,u.get(v),m)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof rc||n instanceof ul||n instanceof Gc)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const s=this.binders[n];(s instanceof rc||s instanceof ul||s instanceof Gc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof rc||n instanceof ul||n instanceof Gc)&&n.destroy()}}}class cu{constructor(e,n,s=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new Do(u,n,s);this.needsUpload=!1,this._featureMap=new gp,this._bufferOffset=0}populatePaintArrays(e,n,s,u,p,m,v){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,n,u,p,m,v);void 0!==n.id&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,s,u,p){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,n,m,u,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Yg={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xp(t,e){return Yg[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Xf={"line-pattern":{source:ia,composite:ia},"fill-pattern":{source:ia,composite:ia},"fill-extrusion-pattern":{source:ia,composite:ia},"line-dasharray":{source:cl,composite:cl}},Kg={color:{source:Dl,composite:na},number:{source:Cl,composite:Dl}};function Qf(t,e,n){const s=Xf[t];return s&&s[n]||Kg[e][n]}pi(Lu,"ConstantBinder"),pi(Ec,"PatternConstantBinder"),pi(rc,"SourceExpressionBinder"),pi(Gc,"PatternCompositeBinder"),pi(ul,"CompositeExpressionBinder"),pi(Do,"ProgramConfiguration",{omit:["_buffers"]}),pi(cu,"ProgramConfigurationSet");const uh="-transition";class Hl extends Cr{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new pn(n.layout)),n.paint)){this._transitionablePaint=new Pn(n.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Qn(n.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,s={}){null!=n&&this._validate(dd,`layers.${this.id}.layout.${e}`,e,n,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return fn(e,uh)?this._transitionablePaint.getTransition(e.slice(0,-uh.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,s={}){if(null!=n&&this._validate(lh,`layers.${this.id}.paint.${e}`,e,n,s))return!1;if(fn(e,uh))return this._transitionablePaint.setTransition(e.slice(0,-uh.length),n||void 0),!1;{const u=this._transitionablePaint._values[e],p=u.value.isDataDriven(),m=u.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const v=this._transitionablePaint._values[e].value,E=v.isDataDriven(),C=fn(e,"pattern")||"line-dasharray"===e;return E||p||C||this._handleOverridablePaintPropertyUpdate(e,m,v)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ge(e,(n,s)=>!(void 0===n||"layout"===s&&!Object.keys(n).length||"paint"===s&&!Object.keys(n).length))}_validate(e,n,s,u,p={}){return(!p||!1!==p.validate)&&bc(this,e.call(Ou,{key:n,layerType:this.type,objectKey:s,value:u,styleSpec:_n,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof Un&&Pa(n.property.specification)&&("source"===n.value.kind||"composite"===n.value.kind)&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=es(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const Xg=gi([{name:"a_pos",components:2,type:"Int16"}],4),Zy=gi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ps{constructor(e=[]){this.segments=e}prepareSegment(e,n,s,u){let p=this.segments[this.segments.length-1];return e>ps.MAX_VERTEX_ARRAY_LENGTH&&Xe(`Max vertices per segment is ${ps.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!p||p.vertexLength+e>ps.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==u)&&(p={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==u&&(p.sortKey=u),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,s,u){return new ps([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:u,vaos:{},sortKey:0}])}}ps.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pi(ps,"SegmentVector");var Li=8192;class oc{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Tr?new Tr(e.lng,e.lat):Tr.convert(e),this}setSouthWest(e){return this._sw=e instanceof Tr?new Tr(e.lng,e.lat):Tr.convert(e),this}extend(e){const n=this._sw,s=this._ne;let u,p;if(e instanceof Tr)u=e,p=e;else{if(!(e instanceof oc))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(oc.convert(e)):this.extend(Tr.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(Tr.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return n||s?(n.lng=Math.min(u.lng,n.lng),n.lat=Math.min(u.lat,n.lat),s.lng=Math.max(p.lng,s.lng),s.lat=Math.max(p.lat,s.lat)):(this._sw=new Tr(u.lng,u.lat),this._ne=new Tr(p.lng,p.lat)),this}getCenter(){return new Tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Tr(this.getWest(),this.getNorth())}getSouthEast(){return new Tr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:s}=Tr.convert(e);let u=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&u}static convert(e){return!e||e instanceof oc?e:new oc(e)}}const fd=6371008.8;class Tr{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tr(He(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,s=this.lat*n,u=e.lat*n,p=Math.sin(s)*Math.sin(u)+Math.cos(s)*Math.cos(u)*Math.cos((e.lng-this.lng)*n);return fd*Math.acos(Math.min(p,1))}toBounds(e=0){const n=360*e/40075017,s=n/Math.cos(Math.PI/180*this.lat);return new oc(new Tr(this.lng-s,this.lat-n),new Tr(this.lng+s,this.lat+n))}static convert(e){if(e instanceof Tr)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Tr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Tr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const bp=2*Math.PI*fd;function wp(t){return bp*Math.cos(t*Math.PI/180)}function Gl(t){return(180+t)/360}function $l(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Ka(t,e){return t/wp(e)}function Tl(t){return 360*t-180}function Ws(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function dh(t,e){return t*wp(Ws(e))}const Zl=85.051129;function Ep(t){return 1/Math.cos(t*Math.PI/180)}class Sl{constructor(e,n,s=0){this.x=+e,this.y=+n,this.z=+s}static fromLngLat(e,n=0){const s=Tr.convert(e);return new Sl(Gl(s.lng),$l(s.lat),Ka(n,s.lat))}toLngLat(){return new Tr(Tl(this.x),Ws(this.y))}toAltitude(){return dh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/bp*Ep(Ws(this.y))}}function Cp(t,e,n,s,u,p,m,v,E){const C=(e+s)/2,R=(n+u)/2,N=new Qe(C,R);v(N),function(H,K,J,se,De,We){const gt=J-De,Ze=se-We;return Math.abs((se-K)*gt-(J-H)*Ze)/Math.hypot(gt,Ze)}(N.x,N.y,p.x,p.y,m.x,m.y)>=E?(Cp(t,e,n,C,R,p,N,v,E),Cp(t,C,R,s,u,N,m,v,E)):t.push(m)}function hh(t,e,n){let s=t[0],u=s.x,p=s.y;e(s);const m=[s];for(let v=1;v<t.length;v++){const E=t[v],{x:C,y:R}=E;e(E),Cp(m,u,p,C,R,s,E,e,n),u=C,p=R,s=E}return m}function Bu(t,e,n,s){if(s(e,n)){const u=e.add(n)._mult(.5);Bu(t,e,u,s),Bu(t,u,n,s)}else t.push(n)}function Qg(t,e){let n=t[0];const s=[n];for(let u=1;u<t.length;u++){const p=t[u];Bu(s,n,p,e),n=p}return s}const md=Math.pow(2,14)-1,gd=-md-1;function uu(t,e){const n=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=Ke(n,gd,md),t.y=Ke(s,gd,md),(n<t.x||n>t.x+1||s<t.y||s>t.y+1)&&Xe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function sc(t,e,n){const s=t.loadGeometry(),u=t.extent,p=Li/u;if(e&&n&&n.projection.isReprojectedInTileSpace){const m=1<<e.z,{scale:v,x:E,y:C,projection:R}=n,N=H=>{const K=Tl((e.x+H.x/u)/m),J=Ws((e.y+H.y/u)/m),se=R.project(K,J);H.x=(se.x*v-E)*u,H.y=(se.y*v-C)*u};for(let H=0;H<s.length;H++)if(1!==t.type)s[H]=hh(s[H],N,1);else{const K=[];for(const J of s[H])J.x<0||J.x>=u||J.y<0||J.y>=u||(N(J),K.push(J));s[H]=K}}for(const m of s)for(const v of m)uu(v,p);return s}function Cc(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?sc(t):[]}}function ph(t,e,n,s,u){t.emplaceBack(2*e+(s+1)/2,2*n+(u+1)/2)}function fh(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class mh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Pr,this.indexArray=new Ps,this.segments=new ps,this.programConfigurations=new cu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,u){const p=this.layers[0],m=[];let v=null;"circle"===p.type&&(v=p.layout.get("circle-sort-key"));for(const{feature:C,id:R,index:N,sourceLayerIndex:H}of e){const K=this.layers[0]._featureFilter.needGeometry,J=Cc(C,K);if(!this.layers[0]._featureFilter.filter(new $t(this.zoom),J,s))continue;const se=v?v.evaluate(J,{},s):void 0,De={id:R,properties:C.properties,type:C.type,sourceLayerIndex:H,index:N,geometry:K?J.geometry:sc(C,s,u),patterns:{},sortKey:se};m.push(De)}v&&m.sort((C,R)=>C.sortKey-R.sortKey);let E=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new Yr,E=u.projection);for(const C of m){const{geometry:R,index:N,sourceLayerIndex:H}=C,K=e[N].feature;this.addFeature(C,R,N,n.availableImages,s,E),n.featureIndex.insert(K,R,N,H,this.index)}}update(e,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Xg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Zy.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,s,u,p,m){for(const v of n)for(const E of v){const C=E.x,R=E.y;if(C<0||C>=Li||R<0||R>=Li)continue;if(m){const K=m.projectTilePoint(C,R,p),J=m.upVector(p,C,R),se=this.globeExtVertexArray;fh(se,K,J),fh(se,K,J),fh(se,K,J),fh(se,K,J)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),H=N.vertexLength;ph(this.layoutVertexArray,C,R,-1,-1),ph(this.layoutVertexArray,C,R,1,-1),ph(this.layoutVertexArray,C,R,1,1),ph(this.layoutVertexArray,C,R,-1,1),this.indexArray.emplaceBack(H,H+1,H+2),this.indexArray.emplaceBack(H,H+2,H+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},u,p)}}function du(t,e){for(let n=0;n<t.length;n++)if($c(e,t[n]))return!0;for(let n=0;n<e.length;n++)if($c(t,e[n]))return!0;return!!Mp(t,e)}function Jg(t,e,n){return!!$c(t,e)||!!Tp(e,t,n)}function Jf(t,e){if(1===t.length)return em(e,t[0]);for(let n=0;n<e.length;n++){const s=e[n];for(let u=0;u<s.length;u++)if($c(t,s[u]))return!0}for(let n=0;n<t.length;n++)if(em(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(Mp(t,e[n]))return!0;return!1}function e_(t,e,n){if(t.length>1){if(Mp(t,e))return!0;for(let s=0;s<e.length;s++)if(Tp(e[s],t,n))return!0}for(let s=0;s<t.length;s++)if(Tp(t[s],e,n))return!0;return!1}function Mp(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const s=t[n],u=t[n+1];for(let p=0;p<e.length-1;p++)if(Dp(s,u,e[p],e[p+1]))return!0}return!1}function Dp(t,e,n,s){return ce(t,n,s)!==ce(e,n,s)&&ce(t,e,n)!==ce(t,e,s)}function Tp(t,e,n){const s=n*n;if(1===e.length)return t.distSqr(e[0])<s;for(let u=1;u<e.length;u++)if(Sp(t,e[u-1],e[u])<s)return!0;return!1}function Sp(t,e,n){const s=e.distSqr(n);if(0===s)return t.distSqr(e);const u=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return t.distSqr(u<0?e:u>1?n:n.sub(e)._mult(u)._add(e))}function em(t,e){let n,s,u,p=!1;for(let m=0;m<t.length;m++){n=t[m];for(let v=0,E=n.length-1;v<n.length;E=v++)s=n[v],u=n[E],s.y>e.y!=u.y>e.y&&e.x<(u.x-s.x)*(e.y-s.y)/(u.y-s.y)+s.x&&(p=!p)}return p}function $c(t,e){let n=!1;for(let s=0,u=t.length-1;s<t.length;u=s++){const p=t[s],m=t[u];p.y>e.y!=m.y>e.y&&e.x<(m.x-p.x)*(e.y-p.y)/(m.y-p.y)+p.x&&(n=!n)}return n}function t_(t,e,n,s,u){for(const m of t)if(e<=m.x&&n<=m.y&&s>=m.x&&u>=m.y)return!0;const p=[new Qe(e,n),new Qe(e,u),new Qe(s,u),new Qe(s,n)];if(t.length>2)for(const m of p)if($c(t,m))return!0;for(let m=0;m<t.length-1;m++)if(n_(t[m],t[m+1],p))return!0;return!1}function n_(t,e,n){const s=n[0],u=n[2];if(t.x<s.x&&e.x<s.x||t.x>u.x&&e.x>u.x||t.y<s.y&&e.y<s.y||t.y>u.y&&e.y>u.y)return!1;const p=ce(t,e,n[0]);return p!==ce(t,e,n[1])||p!==ce(t,e,n[2])||p!==ce(t,e,n[3])}function ac(t,e,n){const s=e.paint.get(t).value;return"constant"===s.kind?s.value:n.programConfigurations.get(e.id).getMaxValue(t)}function gh(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function hu(t,e,n,s,u){if(!e[0]&&!e[1])return t;const p=Qe.convert(e)._mult(u);"viewport"===n&&p._rotate(-s);const m=[];for(let v=0;v<t.length;v++)m.push(t[v].sub(p));return m}function Nu(t,e,n,s){const u=Qe.convert(t)._mult(s);return"viewport"===e&&u._rotate(-n),u}pi(mh,"CircleBucket",{omit:["layers"]});const i_=new ki({"circle-sort-key":new dn(_n.layout_circle["circle-sort-key"])});var Wy={paint:new ki({"circle-radius":new dn(_n.paint_circle["circle-radius"]),"circle-color":new dn(_n.paint_circle["circle-color"]),"circle-blur":new dn(_n.paint_circle["circle-blur"]),"circle-opacity":new dn(_n.paint_circle["circle-opacity"]),"circle-translate":new qt(_n.paint_circle["circle-translate"]),"circle-translate-anchor":new qt(_n.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qt(_n.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qt(_n.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new dn(_n.paint_circle["circle-stroke-width"]),"circle-stroke-color":new dn(_n.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new dn(_n.paint_circle["circle-stroke-opacity"])}),layout:i_},_d=1e-6,Xa=typeof Float32Array<"u"?Float32Array:Array;function tm(){var t=new Xa(9);return Xa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function nm(t,e,n){var s=e[0],u=e[1],p=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],H=n[0],K=n[1],J=n[2],se=n[3],De=n[4],We=n[5],gt=n[6],Ze=n[7],at=n[8];return t[0]=H*s+K*m+J*C,t[1]=H*u+K*v+J*R,t[2]=H*p+K*E+J*N,t[3]=se*s+De*m+We*C,t[4]=se*u+De*v+We*R,t[5]=se*p+De*E+We*N,t[6]=gt*s+Ze*m+at*C,t[7]=gt*u+Ze*v+at*R,t[8]=gt*p+Ze*E+at*N,t}function Al(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ap(t,e){var n=e[0],s=e[1],u=e[2],p=e[3],m=e[4],v=e[5],E=e[6],C=e[7],R=e[8],N=e[9],H=e[10],K=e[11],J=e[12],se=e[13],De=e[14],We=e[15],gt=n*v-s*m,Ze=n*E-u*m,at=n*C-p*m,Ct=s*E-u*v,mt=s*C-p*v,an=u*C-p*E,en=R*se-N*J,An=R*De-H*J,Yn=R*We-K*J,gn=N*De-H*se,Bn=N*We-K*se,Vn=H*We-K*De,$n=gt*Vn-Ze*Bn+at*gn+Ct*Yn-mt*An+an*en;return $n?(t[0]=(v*Vn-E*Bn+C*gn)*($n=1/$n),t[1]=(u*Bn-s*Vn-p*gn)*$n,t[2]=(se*an-De*mt+We*Ct)*$n,t[3]=(H*mt-N*an-K*Ct)*$n,t[4]=(E*Yn-m*Vn-C*An)*$n,t[5]=(n*Vn-u*Yn+p*An)*$n,t[6]=(De*at-J*an-We*Ze)*$n,t[7]=(R*an-H*at+K*Ze)*$n,t[8]=(m*Bn-v*Yn+C*en)*$n,t[9]=(s*Yn-n*Bn-p*en)*$n,t[10]=(J*mt-se*at+We*gt)*$n,t[11]=(N*at-R*mt-K*gt)*$n,t[12]=(v*An-m*gn-E*en)*$n,t[13]=(n*gn-s*An+u*en)*$n,t[14]=(se*Ze-J*Ct-De*gt)*$n,t[15]=(R*Ct-N*Ze+H*gt)*$n,t):null}function Mc(t,e,n){var s=e[0],u=e[1],p=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],H=e[9],K=e[10],J=e[11],se=e[12],De=e[13],We=e[14],gt=e[15],Ze=n[0],at=n[1],Ct=n[2],mt=n[3];return t[0]=Ze*s+at*v+Ct*N+mt*se,t[1]=Ze*u+at*E+Ct*H+mt*De,t[2]=Ze*p+at*C+Ct*K+mt*We,t[3]=Ze*m+at*R+Ct*J+mt*gt,t[4]=(Ze=n[4])*s+(at=n[5])*v+(Ct=n[6])*N+(mt=n[7])*se,t[5]=Ze*u+at*E+Ct*H+mt*De,t[6]=Ze*p+at*C+Ct*K+mt*We,t[7]=Ze*m+at*R+Ct*J+mt*gt,t[8]=(Ze=n[8])*s+(at=n[9])*v+(Ct=n[10])*N+(mt=n[11])*se,t[9]=Ze*u+at*E+Ct*H+mt*De,t[10]=Ze*p+at*C+Ct*K+mt*We,t[11]=Ze*m+at*R+Ct*J+mt*gt,t[12]=(Ze=n[12])*s+(at=n[13])*v+(Ct=n[14])*N+(mt=n[15])*se,t[13]=Ze*u+at*E+Ct*H+mt*De,t[14]=Ze*p+at*C+Ct*K+mt*We,t[15]=Ze*m+at*R+Ct*J+mt*gt,t}function yd(t,e,n){var s,u,p,m,v,E,C,R,N,H,K,J,se=n[0],De=n[1],We=n[2];return e===t?(t[12]=e[0]*se+e[4]*De+e[8]*We+e[12],t[13]=e[1]*se+e[5]*De+e[9]*We+e[13],t[14]=e[2]*se+e[6]*De+e[10]*We+e[14],t[15]=e[3]*se+e[7]*De+e[11]*We+e[15]):(u=e[1],p=e[2],m=e[3],v=e[4],E=e[5],C=e[6],R=e[7],N=e[8],H=e[9],K=e[10],J=e[11],t[0]=s=e[0],t[1]=u,t[2]=p,t[3]=m,t[4]=v,t[5]=E,t[6]=C,t[7]=R,t[8]=N,t[9]=H,t[10]=K,t[11]=J,t[12]=s*se+v*De+N*We+e[12],t[13]=u*se+E*De+H*We+e[13],t[14]=p*se+C*De+K*We+e[14],t[15]=m*se+R*De+J*We+e[15]),t}function pu(t,e,n){var s=n[0],u=n[1],p=n[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vd(t,e,n){var s=Math.sin(n),u=Math.cos(n),p=e[4],m=e[5],v=e[6],E=e[7],C=e[8],R=e[9],N=e[10],H=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*u+C*s,t[5]=m*u+R*s,t[6]=v*u+N*s,t[7]=E*u+H*s,t[8]=C*u-p*s,t[9]=R*u-m*s,t[10]=N*u-v*s,t[11]=H*u-E*s,t}function Ip(t,e,n){var s=Math.sin(n),u=Math.cos(n),p=e[0],m=e[1],v=e[2],E=e[3],C=e[8],R=e[9],N=e[10],H=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*u-C*s,t[1]=m*u-R*s,t[2]=v*u-N*s,t[3]=E*u-H*s,t[8]=p*s+C*u,t[9]=m*s+R*u,t[10]=v*s+N*u,t[11]=E*s+H*u,t}function r_(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _h(t,e,n){var s,u,p,m=n[0],v=n[1],E=n[2],C=Math.hypot(m,v,E);return C<_d?null:(m*=C=1/C,v*=C,E*=C,s=Math.sin(e),u=Math.cos(e),t[0]=m*m*(p=1-u)+u,t[1]=v*m*p+E*s,t[2]=E*m*p-v*s,t[3]=0,t[4]=m*v*p-E*s,t[5]=v*v*p+u,t[6]=E*v*p+m*s,t[7]=0,t[8]=m*E*p+v*s,t[9]=v*E*p-m*s,t[10]=E*E*p+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var qy=Mc;function im(){var t=new Xa(3);return Xa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o_(t){var e=new Xa(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function yh(t){return Math.hypot(t[0],t[1],t[2])}function xd(t,e,n){var s=new Xa(3);return s[0]=t,s[1]=e,s[2]=n,s}function Dc(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function vh(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function xh(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function zu(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function Uu(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Qa(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function fu(t,e,n,s){return t[0]=e[0]+n[0]*s,t[1]=e[1]+n[1]*s,t[2]=e[2]+n[2]*s,t}function _a(t,e){var n=e[0],s=e[1],u=e[2],p=n*n+s*s+u*u;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t}function Ja(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function mu(t,e,n){var s=e[0],u=e[1],p=e[2],m=n[0],v=n[1],E=n[2];return t[0]=u*E-p*v,t[1]=p*m-s*E,t[2]=s*v-u*m,t}function jo(t,e,n){var s=e[0],u=e[1],p=e[2],m=n[3]*s+n[7]*u+n[11]*p+n[15];return t[0]=(n[0]*s+n[4]*u+n[8]*p+n[12])/(m=m||1),t[1]=(n[1]*s+n[5]*u+n[9]*p+n[13])/m,t[2]=(n[2]*s+n[6]*u+n[10]*p+n[14])/m,t}function rm(t,e,n){var s=n[0],u=n[1],p=n[2],m=e[0],v=e[1],E=e[2],C=u*E-p*v,R=p*m-s*E,N=s*v-u*m,H=u*N-p*R,K=p*C-s*N,J=s*R-u*C,se=2*n[3];return R*=se,N*=se,K*=2,J*=2,t[0]=m+(C*=se)+(H*=2),t[1]=v+R+K,t[2]=E+N+J,t}var bd,Il=vh,s_=xh,a_=yh;function om(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function sm(t,e){var n=e[0],s=e[1],u=e[2],p=e[3],m=n*n+s*s+u*u+p*p;return m>0&&(m=1/Math.sqrt(m)),t[0]=n*m,t[1]=s*m,t[2]=u*m,t[3]=p*m,t}function Tc(t,e,n){var s=e[0],u=e[1],p=e[2],m=e[3];return t[0]=n[0]*s+n[4]*u+n[8]*p+n[12]*m,t[1]=n[1]*s+n[5]*u+n[9]*p+n[13]*m,t[2]=n[2]*s+n[6]*u+n[10]*p+n[14]*m,t[3]=n[3]*s+n[7]*u+n[11]*p+n[15]*m,t}function am(){var t=new Xa(4);return Xa!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function lm(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function cm(t,e,n){n*=.5;var s=e[0],u=e[1],p=e[2],m=e[3],v=Math.sin(n),E=Math.cos(n);return t[0]=s*E+m*v,t[1]=u*E+p*v,t[2]=p*E-u*v,t[3]=m*E-s*v,t}function Pp(t,e,n){n*=.5;var s=e[0],u=e[1],p=e[2],m=e[3],v=Math.sin(n),E=Math.cos(n);return t[0]=s*E-p*v,t[1]=u*E+m*v,t[2]=p*E+s*v,t[3]=m*E-u*v,t}im(),bd=new Xa(4),Xa!=Float32Array&&(bd[0]=0,bd[1]=0,bd[2]=0,bd[3]=0);var l_=sm;im(),xd(1,0,0),xd(0,1,0),am(),am(),tm();class Op{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,s){const u=Ja(n,this.dir);if(Math.abs(u)<1e-6)return!1;const p=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/u;return s[0]=this.pos[0]+this.dir[0]*p,s[1]=this.pos[1]+this.dir[1]*p,s[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(e,n,s){if(se=(K=this.pos)[0],De=K[1],We=K[2],gt=(J=e)[0],Ze=J[1],at=J[2],Math.abs(se-gt)<=_d*Math.max(1,Math.abs(se),Math.abs(gt))&&Math.abs(De-Ze)<=_d*Math.max(1,Math.abs(De),Math.abs(Ze))&&Math.abs(We-at)<=_d*Math.max(1,Math.abs(We),Math.abs(at))||0===n)return s[0]=s[1]=s[2]=0,!1;var K,J,se,De,We,gt,Ze,at;const[u,p,m]=this.dir,v=this.pos[0]-e[0],E=this.pos[1]-e[1],C=this.pos[2]-e[2],R=u*u+p*p+m*m,N=2*(v*u+E*p+C*m),H=N*N-4*R*(v*v+E*E+C*C-n*n);if(H<0){const K=Math.max(-N/2,0),J=v+u*K,se=E+p*K,De=C+m*K,We=Math.hypot(J,se,De);return s[0]=J*n/We,s[1]=se*n/We,s[2]=De*n/We,!1}{const K=(-N-Math.sqrt(H))/(2*R);if(K<0){const J=Math.hypot(v,E,C);return s[0]=v*n/J,s[1]=E*n/J,s[2]=C*n/J,!1}return s[0]=v+u*K,s[1]=E+p*K,s[2]=C+m*K,!0}}}class ra{constructor(e,n,s,u,p){this.TL=e,this.TR=n,this.BR=s,this.BL=u,this.horizon=p}static fromInvProjectionMatrix(e,n,s){const u=[-1,1,1],p=[1,1,1],m=[1,-1,1],v=[-1,-1,1],E=jo(u,u,e),C=jo(p,p,e),R=jo(m,m,e),N=jo(v,v,e);return new ra(E,C,R,N,n/s)}}class wd{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,s,u){const p=Math.pow(2,s),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const C=Tc([],E,e),R=1/C[3]/n*p;return(N=C)[0]=(H=C)[0]*(K=[R,R,u?1/C[3]:R,R])[0],N[1]=H[1]*K[1],N[2]=H[2]*K[2],N[3]=H[3]*K[3],N;var N,H,K}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const C=_a([],mu([],Il([],m[E[0]],m[E[1]]),Il([],m[E[2]],m[E[1]]))),R=-Ja(C,m[E[1]]);return C.concat(R)});return new wd(m,v)}}class oa{static fromPoints(e){const n=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const u of e)zu(n,n,u),Uu(s,s,u);return new oa(n,s)}static applyTransform(e,n){const s=e.getCorners();for(let u=0;u<s.length;++u)jo(s[u],s[u],n);return oa.fromPoints(s)}constructor(e,n){this.min=e,this.max=n,this.center=Qa([],Dc([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],s=o_(this.min),u=o_(this.max);for(let p=0;p<n.length;p++)s[p]=n[p]?this.min[p]:this.center[p],u[p]=n[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new oa(s,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let s=!0;for(let u=0;u<e.planes.length;u++){const p=e.planes[u];let m=0;for(let v=0;v<n.length;v++)m+=Ja(p,n[v])+p[3]>=0;if(0===m)return 0;m!==n.length&&(s=!1)}if(s)return 2;for(let u=0;u<3;u++){let p=Number.MAX_VALUE,m=-Number.MAX_VALUE;for(let v=0;v<e.points.length;v++){const E=e.points[v][u]-this.min[u];p=Math.min(p,E),m=Math.max(m,E)}if(m<0||p>this.max[u]-this.min[u])return 0}return 1}}function bh(t,e,n,s,u,p,m,v,E){if(p&&t.queryGeometry.isAboveHorizon)return!1;p&&(E*=t.pixelToTileUnitsFactor);const C=t.tileID.canonical,R=n.projection.upVectorScale(C,n.center.lat,n.worldSize).metersToTile;for(const N of e)for(const H of N){const K=H.add(v),J=u&&n.elevation?n.elevation.exaggeration()*u.getElevationAt(K.x,K.y,!0):0,se=n.projection.projectTilePoint(K.x,K.y,C);if(J>0){const Ze=n.projection.upVector(C,K.x,K.y);se.x+=Ze[0]*R*J,se.y+=Ze[1]*R*J,se.z+=Ze[2]*R*J}const De=p?K:ya(se.x,se.y,se.z,s),We=p?t.tilespaceRays.map(Ze=>c_(Ze,J)):t.queryGeometry.screenGeometry,gt=Tc([],[se.x,se.y,se.z,1],s);if(!m&&p?E*=gt[3]/n.cameraToCenterDistance:m&&!p&&(E*=n.cameraToCenterDistance/gt[3]),p){const Ze=Ws((H.y/Li+C.y)/(1<<C.z));E/=n.projection.pixelsPerMeter(Ze,1)/Ka(1,Ze)}if(Jg(We,De,E))return!0}return!1}function ya(t,e,n,s){const u=Tc([],[t,e,n,1],s);return new Qe(u[0]/u[3],u[1]/u[3])}const Vu=xd(0,0,0),um=xd(0,0,1);function c_(t,e){const n=im();return Vu[2]=e,t.intersectsPlane(Vu,um,n),new Qe(n[0],n[1])}class dm extends mh{}function Rp(t,{width:e,height:n},s,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*n*s)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*n*s);return t.width=e,t.height=n,t.data=u,t}function hm(t,e,n){const{width:s,height:u}=e;s===t.width&&u===t.height||(wh(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,u)},n),t.width=s,t.height=u,t.data=e.data)}function wh(t,e,n,s,u,p){if(0===u.width||0===u.height)return e;if(u.width>t.width||u.height>t.height||n.x>t.width-u.width||n.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||s.x>e.width-u.width||s.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=t.data,v=e.data;for(let E=0;E<u.height;E++){const C=((n.y+E)*t.width+n.x)*p,R=((s.y+E)*e.width+s.x)*p;for(let N=0;N<u.width*p;N++)v[R+N]=m[C+N]}return e}pi(dm,"HeatmapBucket",{omit:["layers"]});class Sc{constructor(e,n){Rp(this,e,1,n)}resize(e){hm(this,new Sc(e),1)}clone(){return new Sc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,u,p){wh(e,n,s,u,p,1)}}class Na{constructor(e,n){Rp(this,e,4,n)}resize(e){hm(this,new Na(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Na({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,u,p){wh(e,n,s,u,p,4)}}pi(Sc,"AlphaImage"),pi(Na,"RGBAImage");var u_={paint:new ki({"heatmap-radius":new dn(_n.paint_heatmap["heatmap-radius"]),"heatmap-weight":new dn(_n.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qt(_n.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ei(_n.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qt(_n.paint_heatmap["heatmap-opacity"])})};function kp(t){const e={},n=t.resolution||256,s=t.clips?t.clips.length:1,u=t.image||new Na({width:n,height:s}),p=(m,v,E)=>{e[t.evaluationKey]=E;const C=t.expression.evaluate(e);u.data[m+v+0]=Math.floor(255*C.r/C.a),u.data[m+v+1]=Math.floor(255*C.g/C.a),u.data[m+v+2]=Math.floor(255*C.b/C.a),u.data[m+v+3]=Math.floor(255*C.a)};if(t.clips)for(let m=0,v=0;m<s;++m,v+=4*n)for(let E=0,C=0;E<n;E++,C+=4){const R=E/(n-1),{start:N,end:H}=t.clips[m];p(v,C,N*(1-R)+H*R)}else for(let m=0,v=0;m<n;m++,v+=4)p(0,v,m/(n-1));return u}var d_={paint:new ki({"hillshade-illumination-direction":new qt(_n.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new qt(_n.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qt(_n.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qt(_n.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qt(_n.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qt(_n.paint_hillshade["hillshade-accent-color"])})};const h_=gi([{name:"a_pos",components:2,type:"Int16"}],4),{members:p_}=h_;var lc={exports:{}};function Pl(t,e,n){n=n||2;var s,u,p,m,v,E,C,R=e&&e.length,N=R?e[0]*n:t.length,H=pm(t,0,N,n,!0),K=[];if(!H||H.next===H.prev)return K;if(R&&(H=function(se,De,We,gt){var Ze,at,Ct,mt=[];for(Ze=0,at=De.length;Ze<at;Ze++)(Ct=pm(se,De[Ze]*gt,Ze<at-1?De[Ze+1]*gt:se.length,gt,!1))===Ct.next&&(Ct.steiner=!0),mt.push(m_(Ct));for(mt.sort(Fp),Ze=0;Ze<mt.length;Ze++)We=Lp(mt[Ze],We);return We}(t,e,H,n)),t.length>80*n){s=p=t[0],u=m=t[1];for(var J=n;J<N;J+=n)(v=t[J])<s&&(s=v),(E=t[J+1])<u&&(u=E),v>p&&(p=v),E>m&&(m=E);C=0!==(C=Math.max(p-s,m-u))?32767/C:0}return Eh(H,K,n,s,u,C,0),K}function pm(t,e,n,s,u){var p,m;if(u===zp(t,e,n,s)>0)for(p=e;p<n;p+=s)m=Np(p,t[p],t[p+1],m);else for(p=n-s;p>=e;p-=s)m=Np(p,t[p],t[p+1],m);return m&&ju(m,m.next)&&(Cd(m),m=m.next),m}function gu(t,e){if(!t)return t;e||(e=t);var n,s=t;do{if(n=!1,s.steiner||!ju(s,s.next)&&0!==Yo(s.prev,s,s.next))s=s.next;else{if(Cd(s),(s=e=s.prev)===s.next)break;n=!0}}while(n||s!==e);return e}function Eh(t,e,n,s,u,p,m){if(t){!m&&p&&function(R,N,H,K){var J=R;do{0===J.z&&(J.z=Ch(J.x,J.y,N,H,K)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next}while(J!==R);J.prevZ.nextZ=null,J.prevZ=null,function(se){var De,We,gt,Ze,at,Ct,mt,an,en=1;do{for(We=se,se=null,at=null,Ct=0;We;){for(Ct++,gt=We,mt=0,De=0;De<en&&(mt++,gt=gt.nextZ);De++);for(an=en;mt>0||an>0&&gt;)0!==mt&&(0===an||!gt||We.z<=gt.z)?(Ze=We,We=We.nextZ,mt--):(Ze=gt,gt=gt.nextZ,an--),at?at.nextZ=Ze:se=Ze,Ze.prevZ=at,at=Ze;We=gt}at.nextZ=null,en*=2}while(Ct>1)}(J)}(t,s,u,p);for(var v,E,C=t;t.prev!==t.next;)if(v=t.prev,E=t.next,p?fm(t,s,u,p):Yy(t))e.push(v.i/n|0),e.push(t.i/n|0),e.push(E.i/n|0),Cd(t),t=E.next,C=E.next;else if((t=E)===C){m?1===m?Eh(t=Ky(gu(t),e,n),e,n,s,u,p,2):2===m&&cc(t,e,n,s,u,p):Eh(gu(t),e,n,s,u,p,1);break}}}function Yy(t){var e=t.prev,n=t,s=t.next;if(Yo(e,n,s)>=0)return!1;for(var u=e.x,p=n.x,m=s.x,v=e.y,E=n.y,C=s.y,R=u<p?u<m?u:m:p<m?p:m,N=v<E?v<C?v:C:E<C?E:C,H=u>p?u>m?u:m:p>m?p:m,K=v>E?v>C?v:C:E>C?E:C,J=s.next;J!==e;){if(J.x>=R&&J.x<=H&&J.y>=N&&J.y<=K&&uc(u,v,p,E,m,C,J.x,J.y)&&Yo(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function fm(t,e,n,s){var u=t.prev,p=t,m=t.next;if(Yo(u,p,m)>=0)return!1;for(var v=u.x,E=p.x,C=m.x,R=u.y,N=p.y,H=m.y,K=v<E?v<C?v:C:E<C?E:C,J=R<N?R<H?R:H:N<H?N:H,se=v>E?v>C?v:C:E>C?E:C,De=R>N?R>H?R:H:N>H?N:H,We=Ch(K,J,e,n,s),gt=Ch(se,De,e,n,s),Ze=t.prevZ,at=t.nextZ;Ze&&Ze.z>=We&&at&&at.z<=gt;){if(Ze.x>=K&&Ze.x<=se&&Ze.y>=J&&Ze.y<=De&&Ze!==u&&Ze!==m&&uc(v,R,E,N,C,H,Ze.x,Ze.y)&&Yo(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,at.x>=K&&at.x<=se&&at.y>=J&&at.y<=De&&at!==u&&at!==m&&uc(v,R,E,N,C,H,at.x,at.y)&&Yo(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;Ze&&Ze.z>=We;){if(Ze.x>=K&&Ze.x<=se&&Ze.y>=J&&Ze.y<=De&&Ze!==u&&Ze!==m&&uc(v,R,E,N,C,H,Ze.x,Ze.y)&&Yo(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;at&&at.z<=gt;){if(at.x>=K&&at.x<=se&&at.y>=J&&at.y<=De&&at!==u&&at!==m&&uc(v,R,E,N,C,H,at.x,at.y)&&Yo(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function Ky(t,e,n){var s=t;do{var u=s.prev,p=s.next.next;!ju(u,p)&&Mh(u,s,s.next,p)&&dc(u,p)&&dc(p,u)&&(e.push(u.i/n|0),e.push(s.i/n|0),e.push(p.i/n|0),Cd(s),Cd(s.next),s=t=p),s=s.next}while(s!==t);return gu(s)}function cc(t,e,n,s,u,p){var m=t;do{for(var v=m.next.next;v!==m.prev;){if(m.i!==v.i&&g_(m,v)){var E=Dh(m,v);return m=gu(m,m.next),E=gu(E,E.next),Eh(m,e,n,s,u,p,0),void Eh(E,e,n,s,u,p,0)}v=v.next}m=m.next}while(m!==t)}function Fp(t,e){return t.x-e.x}function Lp(t,e){var n=function(u,p){var m,v=p,E=u.x,C=u.y,R=-1/0;do{if(C<=v.y&&C>=v.next.y&&v.next.y!==v.y){var N=v.x+(C-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(N<=E&&N>R&&(R=N,m=v.x<v.next.x?v:v.next,N===E))return m}v=v.next}while(v!==p);if(!m)return null;var H,K=m,J=m.x,se=m.y,De=1/0;v=m;do{E>=v.x&&v.x>=J&&E!==v.x&&uc(C<se?E:R,C,J,se,C<se?R:E,C,v.x,v.y)&&(H=Math.abs(C-v.y)/(E-v.x),dc(v,u)&&(H<De||H===De&&(v.x>m.x||v.x===m.x&&f_(m,v)))&&(m=v,De=H)),v=v.next}while(v!==K);return m}(t,e);if(!n)return e;var s=Dh(n,t);return gu(s,s.next),gu(n,n.next)}function f_(t,e){return Yo(t.prev,t,e.prev)<0&&Yo(e.next,t,t.next)<0}function Ch(t,e,n,s,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m_(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function uc(t,e,n,s,u,p,m,v){return(u-m)*(e-v)>=(t-m)*(p-v)&&(t-m)*(s-v)>=(n-m)*(e-v)&&(n-m)*(p-v)>=(u-m)*(s-v)}function g_(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,s){var u=n;do{if(u.i!==n.i&&u.next.i!==n.i&&u.i!==s.i&&u.next.i!==s.i&&Mh(u,u.next,n,s))return!0;u=u.next}while(u!==n);return!1}(t,e)&&(dc(t,e)&&dc(e,t)&&function(n,s){var u=n,p=!1,m=(n.x+s.x)/2,v=(n.y+s.y)/2;do{u.y>v!=u.next.y>v&&u.next.y!==u.y&&m<(u.next.x-u.x)*(v-u.y)/(u.next.y-u.y)+u.x&&(p=!p),u=u.next}while(u!==n);return p}(t,e)&&(Yo(t.prev,t,e.prev)||Yo(t,e.prev,e))||ju(t,e)&&Yo(t.prev,t,t.next)>0&&Yo(e.prev,e,e.next)>0)}function Yo(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ju(t,e){return t.x===e.x&&t.y===e.y}function Mh(t,e,n,s){var u=Bp(Yo(t,e,n)),p=Bp(Yo(t,e,s)),m=Bp(Yo(n,s,t)),v=Bp(Yo(n,s,e));return u!==p&&m!==v||!(0!==u||!Ed(t,n,e))||!(0!==p||!Ed(t,s,e))||!(0!==m||!Ed(n,t,s))||!(0!==v||!Ed(n,e,s))}function Ed(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Bp(t){return t>0?1:t<0?-1:0}function dc(t,e){return Yo(t.prev,t,t.next)<0?Yo(t,e,t.next)>=0&&Yo(t,t.prev,e)>=0:Yo(t,e,t.prev)<0||Yo(t,t.next,e)<0}function Dh(t,e){var n=new Md(t.i,t.x,t.y),s=new Md(e.i,e.x,e.y),u=t.next,p=e.prev;return t.next=e,e.prev=t,n.next=u,u.prev=n,s.next=n,n.prev=s,p.next=s,s.prev=p,s}function Np(t,e,n,s){var u=new Md(t,e,n);return s?(u.next=s.next,u.prev=s,s.next.prev=u,s.next=u):(u.prev=u,u.next=u),u}function Cd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Md(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function zp(t,e,n,s){for(var u=0,p=e,m=n-s;p<n;p+=s)u+=(t[m]-t[p])*(t[p+1]+t[m+1]),m=p;return u}function __(t,e,n,s,u){mm(t,e,n||0,s||t.length-1,u||y_)}function mm(t,e,n,s,u){for(;s>n;){if(s-n>600){var p=s-n+1,m=e-n+1,v=Math.log(p),E=.5*Math.exp(2*v/3),C=.5*Math.sqrt(v*E*(p-E)/p)*(m-p/2<0?-1:1);mm(t,e,Math.max(n,Math.floor(e-m*E/p+C)),Math.min(s,Math.floor(e+(p-m)*E/p+C)),u)}var R=t[e],N=n,H=s;for(Dd(t,n,e),u(t[s],R)>0&&Dd(t,n,s);N<H;){for(Dd(t,N,H),N++,H--;u(t[N],R)<0;)N++;for(;u(t[H],R)>0;)H--}0===u(t[n],R)?Dd(t,n,H):Dd(t,++H,s),H<=e&&(n=H+1),e<=H&&(s=H-1)}}function Dd(t,e,n){var s=t[e];t[e]=t[n],t[n]=s}function y_(t,e){return t<e?-1:t>e?1:0}function Up(t,e){const n=t.length;if(n<=1)return[t];const s=[];let u,p;for(let m=0;m<n;m++){const v=ot(t[m]);0!==v&&(t[m].area=Math.abs(v),void 0===p&&(p=v<0),p===v<0?(u&&s.push(u),u=[t[m]]):u.push(t[m]))}if(u&&s.push(u),e>1)for(let m=0;m<s.length;m++)s[m].length<=e||(__(s[m],e,1,s[m].length-1,gm),s[m]=s[m].slice(0,e));return s}function gm(t,e){return e.area-t.area}function Td(t,e,n){const s=n.patternDependencies;let u=!1;for(const p of e){const m=p.paint.get(`${t}-pattern`);m.isConstant()||(u=!0);const v=m.constantOr(null);v&&(u=!0,s[v]=!0)}return u}function Th(t,e,n,s,u){const p=u.patternDependencies;for(const m of e){const v=m.paint.get(`${t}-pattern`).value;if("constant"!==v.kind){let E=v.evaluate({zoom:s},n,{},u.availableImages);E=E&&E.name?E.name:E,p[E]=!0,n.patterns[m.id]=E}}return n}lc.exports=Pl,lc.exports.default=Pl,Pl.deviation=function(t,e,n,s){var u=e&&e.length,p=Math.abs(zp(t,0,u?e[0]*n:t.length,n));if(u)for(var m=0,v=e.length;m<v;m++)p-=Math.abs(zp(t,e[m]*n,m<v-1?e[m+1]*n:t.length,n));var E=0;for(m=0;m<s.length;m+=3){var C=s[m]*n,R=s[m+1]*n,N=s[m+2]*n;E+=Math.abs((t[C]-t[N])*(t[R+1]-t[C+1])-(t[C]-t[R])*(t[N+1]-t[C+1]))}return 0===p&&0===E?0:Math.abs((E-p)/p)},Pl.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},s=0,u=0;u<t.length;u++){for(var p=0;p<t[u].length;p++)for(var m=0;m<e;m++)n.vertices.push(t[u][p][m]);u>0&&n.holes.push(s+=t[u-1].length)}return n};class Hu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Pr,this.indexArray=new Ps,this.indexArray2=new Ml,this.programConfigurations=new cu(e.layers,e.zoom),this.segments=new ps,this.segments2=new ps,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,s,u){this.hasPattern=Td("fill",this.layers,n);const p=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:v,id:E,index:C,sourceLayerIndex:R}of e){const N=this.layers[0]._featureFilter.needGeometry,H=Cc(v,N);if(!this.layers[0]._featureFilter.filter(new $t(this.zoom),H,s))continue;const K=p?p.evaluate(H,{},s,n.availableImages):void 0,J={id:E,properties:v.properties,type:v.type,sourceLayerIndex:R,index:C,geometry:N?H.geometry:sc(v,s,u),patterns:{},sortKey:K};m.push(J)}p&&m.sort((v,E)=>v.sortKey-E.sortKey);for(const v of m){const{geometry:E,index:C,sourceLayerIndex:R}=v;if(this.hasPattern){const N=Th("fill",this.layers,v,this.zoom,n);this.patternFeatures.push(N)}else this.addFeature(v,E,C,s,{},n.availableImages);n.featureIndex.insert(e[C].feature,E,C,R,this.index)}}update(e,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,u)}addFeatures(e,n,s,u,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,p_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,s,u,p,m=[]){for(const v of Up(n,500)){let E=0;for(const J of v)E+=J.length;const C=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),R=C.vertexLength,N=[],H=[];for(const J of v){if(0===J.length)continue;J!==v[0]&&H.push(N.length/2);const se=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),De=se.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(De+J.length-1,De),N.push(J[0].x),N.push(J[0].y);for(let We=1;We<J.length;We++)this.layoutVertexArray.emplaceBack(J[We].x,J[We].y),this.indexArray2.emplaceBack(De+We-1,De+We),N.push(J[We].x),N.push(J[We].y);se.vertexLength+=J.length,se.primitiveLength+=J.length}const K=lc.exports(N,H);for(let J=0;J<K.length;J+=3)this.indexArray.emplaceBack(R+K[J],R+K[J+1],R+K[J+2]);C.vertexLength+=E,C.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,m,u)}}pi(Hu,"FillBucket",{omit:["layers","patternFeatures"]});const v_=new ki({"fill-sort-key":new dn(_n.layout_fill["fill-sort-key"])});var x_={paint:new ki({"fill-antialias":new qt(_n.paint_fill["fill-antialias"]),"fill-opacity":new dn(_n.paint_fill["fill-opacity"]),"fill-color":new dn(_n.paint_fill["fill-color"]),"fill-outline-color":new dn(_n.paint_fill["fill-outline-color"]),"fill-translate":new qt(_n.paint_fill["fill-translate"]),"fill-translate-anchor":new qt(_n.paint_fill["fill-translate-anchor"]),"fill-pattern":new dn(_n.paint_fill["fill-pattern"])}),layout:v_};const _m=gi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),ym=gi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),_u=gi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:vm}=_m;var Sd={},b_=Qe,w_=Ac;function Ac(t,e,n,s,u){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=u,t.readFields(E_,this,e)}function E_(t,e,n){1==t?e.id=n.readVarint():2==t?function(s,u){for(var p=s.readVarint()+s.pos;s.pos<p;){var m=u._keys[s.readVarint()],v=u._values[s.readVarint()];u.properties[m]=v}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function xm(t){for(var e,n,s=0,u=0,p=t.length,m=p-1;u<p;m=u++)s+=((n=t[m]).x-(e=t[u]).x)*(e.y+n.y);return s}Ac.types=["Unknown","Point","LineString","Polygon"],Ac.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,s=1,u=0,p=0,m=0,v=[];t.pos<n;){if(u<=0){var E=t.readVarint();s=7&E,u=E>>3}if(u--,1===s||2===s)p+=t.readSVarint(),m+=t.readSVarint(),1===s&&(e&&v.push(e),e=[]),e.push(new b_(p,m));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},Ac.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,s=0,u=0,p=0,m=1/0,v=-1/0,E=1/0,C=-1/0;t.pos<e;){if(s<=0){var R=t.readVarint();n=7&R,s=R>>3}if(s--,1===n||2===n)(u+=t.readSVarint())<m&&(m=u),u>v&&(v=u),(p+=t.readSVarint())<E&&(E=p),p>C&&(C=p);else if(7!==n)throw new Error("unknown command "+n)}return[m,E,v,C]},Ac.prototype.toGeoJSON=function(t,e,n){var s,u,p=this.extent*Math.pow(2,n),m=this.extent*t,v=this.extent*e,E=this.loadGeometry(),C=Ac.types[this.type];function R(K){for(var J=0;J<K.length;J++){var se=K[J];K[J]=[360*(se.x+m)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(s=0;s<E.length;s++)N[s]=E[s][0];R(E=N);break;case 2:for(s=0;s<E.length;s++)R(E[s]);break;case 3:for(E=function(K){var J=K.length;if(J<=1)return[K];for(var se,De,We=[],gt=0;gt<J;gt++){var Ze=xm(K[gt]);0!==Ze&&(void 0===De&&(De=Ze<0),De===Ze<0?(se&&We.push(se),se=[K[gt]]):se.push(K[gt]))}return se&&We.push(se),We}(E),s=0;s<E.length;s++)for(u=0;u<E[s].length;u++)R(E[s][u])}1===E.length?E=E[0]:C="Multi"+C;var H={type:"Feature",geometry:{type:C,coordinates:E},properties:this.properties};return"id"in this&&(H.id=this.id),H};var bm=w_,Vp=Sh;function Sh(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(wm,this,e),this.length=this._features.length}function wm(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(s){for(var u=null,p=s.readVarint()+s.pos;s.pos<p;){var m=s.readVarint()>>3;u=1===m?s.readString():2===m?s.readFloat():3===m?s.readDouble():4===m?s.readVarint64():5===m?s.readVarint():6===m?s.readSVarint():7===m?s.readBoolean():null}return u}(n))}Sh.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new bm(this._pbf,e,this.extent,this._keys,this._values)};var Ah=Vp;function Ih(t,e,n){if(3===t){var s=new Ah(n,n.readVarint()+n.pos);s.length&&(e[s.name]=s)}}var Ph=Sd.VectorTile=function(t,e){this.layers=t.readFields(Ih,{},e)},Gu=Sd.VectorTileFeature=w_;function Ad(t,e,n,s){const u=[],p=0===s?(m,v,E,C,R,N)=>{m.push(new Qe(N,E+(N-v)/(C-v)*(R-E)))}:(m,v,E,C,R,N)=>{m.push(new Qe(v+(N-E)/(R-E)*(C-v),N))};for(const m of t){const v=[];for(const E of m){if(E.length<=2)continue;const C=[];for(let H=0;H<E.length-1;H++){const K=E[H].x,J=E[H].y,se=E[H+1].x,De=E[H+1].y,We=0===s?K:J,gt=0===s?se:De;We<e?gt>e&&p(C,K,J,se,De,e):We>n?gt<n&&p(C,K,J,se,De,n):C.push(E[H]),gt<e&&We>=e&&p(C,K,J,se,De,e),gt>n&&We<=n&&p(C,K,J,se,De,n)}let R=E[E.length-1];const N=0===s?R.x:R.y;N>=e&&N<=n&&C.push(R),C.length&&(R=C[C.length-1],C[0].x===R.x&&C[0].y===R.y||C.push(C[0]),v.push(C))}v.length&&u.push(v)}return u}Sd.VectorTileLayer=Vp;const jp=Gu.types,Id=Math.pow(2,13);function Pd(t,e,n,s,u,p,m,v){t.emplaceBack((e<<1)+m,(n<<1)+p,(Math.floor(s*Id)<<1)+u,Math.round(v))}function $u(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class Em{constructor(){this.acc=new Qe(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Qe(e.x,e.y),this.max=new Qe(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,u=this.max;e.x<s.x?s.x=e.x:e.x>u.x&&(u.x=e.x),e.y<s.y?s.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===Li)&&e.x===n.x)!=((0===e.y||e.y===Li)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,wn(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Li!=e.x>Li&&this.addBorderIntersection(1,wn(n.y,e.y,(Li-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,wn(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Li!=e.y>Li&&this.addBorderIntersection(3,wn(n.x,e.x,(Li-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];n<s[0]&&(s[0]=n),n>s[1]&&(s[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,n.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,n.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((n,s)=>n+s.edges,0);return 0!==e?this.acc.div(e)._round():new Qe(0,0)}span(){return new Qe(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Od{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Hr,this.centroidVertexArray=new qf,this.indexArray=new Ps,this.programConfigurations=new cu(e.layers,e.zoom),this.segments=new ps,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,s,u){this.features=[],this.hasPattern=Td("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const m=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*m/(m*m+1)/Li/(1<<p.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:p,id:m,index:v,sourceLayerIndex:E}of e){const C=this.layers[0]._featureFilter.needGeometry,R=Cc(p,C);if(!this.layers[0]._featureFilter.filter(new $t(this.zoom),R,s))continue;const N={id:m,sourceLayerIndex:E,index:v,geometry:C?R.geometry:sc(p,s,u),properties:p.properties,type:p.type,patterns:{}},H=this.layoutVertexArray.length;this.hasPattern?this.features.push(Th("fill-extrusion",this.layers,N,this.zoom,n)):this.addFeature(N,N.geometry,v,s,{},n.availableImages,u),n.featureIndex.insert(p,N.geometry,v,E,this.index,H)}this.sortBorders()}addFeatures(e,n,s,u,p){for(const m of this.features){const{geometry:v}=m;this.addFeature(m,v,m.index,n,s,u,p)}this.sortBorders()}update(e,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,vm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,_u.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,ym.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,u,p,m,v){const E=[new Qe(0,0),new Qe(Li,Li)],C=v.projection,R="globe"===C.name,N=this.enableTerrain&&!R?new Em:null,H="Polygon"===jp[e.type];R&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Yr);const K=Up(n,500);for(let We=K.length-1;We>=0;We--){const gt=K[We];(0===gt.length||(J=gt[0]).every(Ze=>Ze.x<=0)||J.every(Ze=>Ze.x>=Li)||J.every(Ze=>Ze.y<=0)||J.every(Ze=>Ze.y>=Li))&&K.splice(We,1)}var J;let se;if(R)se=Mm(K,E,u);else{se=[];for(const We of K)se.push({polygon:We,bounds:E})}const De=H?this.edgeRadius:0;for(const{polygon:We,bounds:gt}of se){let Ze=0,at=0;for(const mt of We)H&&!mt[0].equals(mt[mt.length-1])&&mt.push(mt[0]),at+=H?mt.length-1:mt.length;const Ct=this.segments.prepareSegment((H?5:4)*at,this.layoutVertexArray,this.indexArray);if(H){const mt=[],an=[];Ze=Ct.vertexLength;for(const An of We){let Yn,gn;An.length&&An!==We[0]&&an.push(mt.length/2),Yn=An[1].sub(An[0])._perp()._unit();for(let Bn=1;Bn<An.length;Bn++){const Vn=An[Bn],$n=An[Bn===An.length-1?1:Bn+1];let{x:Kn,y:yn}=Vn;if(De){gn=$n.sub(Vn)._perp()._unit();const oi=Yn.add(gn)._unit(),Fi=De*Math.min(4,1/(Yn.x*oi.x+Yn.y*oi.y));Kn+=Fi*oi.x,yn+=Fi*oi.y,Yn=gn}Pd(this.layoutVertexArray,Kn,yn,0,0,1,1,0),Ct.vertexLength++,mt.push(Vn.x,Vn.y),R&&$u(this.layoutVertexExtArray,C.projectTilePoint(Kn,yn,u),C.upVector(u,Kn,yn))}}const en=lc.exports(mt,an);for(let An=0;An<en.length;An+=3)this.indexArray.emplaceBack(Ze+en[An],Ze+en[An+2],Ze+en[An+1]),Ct.primitiveLength++}for(const mt of We){N&&mt.length&&N.startRing(mt[0]);let an,en,An,Yn=mt.length>4&&Zp(mt[mt.length-2],mt[0],mt[1]),gn=De?Gp(mt[mt.length-2],mt[0],mt[1],De):0;en=mt[1].sub(mt[0])._perp()._unit();let Bn=!0;for(let Vn=1,$n=0;Vn<mt.length;Vn++){let Kn=mt[Vn-1],yn=mt[Vn];const oi=mt[Vn===mt.length-1?1:Vn+1];if(N&&H&&N.currentPolyCount.top++,C_(yn,Kn,gt)){De&&(en=oi.sub(yn)._perp()._unit(),Bn=!Bn);continue}N&&N.append(yn,Kn);const Fi=yn.sub(Kn)._perp(),ui=Fi.x/(Math.abs(Fi.x)+Math.abs(Fi.y)),ai=Fi.y>0?1:0,si=Kn.dist(yn);if($n+si>32768&&($n=0),De){An=oi.sub(yn)._perp()._unit();let hr=$p(Kn,yn,oi,Hp(en,An),De);isNaN(hr)&&(hr=0);const Ui=yn.sub(Kn)._unit();Kn=Kn.add(Ui.mult(gn))._round(),yn=yn.add(Ui.mult(-hr))._round(),gn=hr,en=An}const zi=Ct.vertexLength,_r=mt.length>4&&Zp(Kn,yn,oi);let dr=Cm($n,Yn,Bn);if(Pd(this.layoutVertexArray,Kn.x,Kn.y,ui,ai,0,0,dr),Pd(this.layoutVertexArray,Kn.x,Kn.y,ui,ai,0,1,dr),$n+=si,dr=Cm($n,_r,!Bn),Yn=_r,Pd(this.layoutVertexArray,yn.x,yn.y,ui,ai,0,0,dr),Pd(this.layoutVertexArray,yn.x,yn.y,ui,ai,0,1,dr),Ct.vertexLength+=4,this.indexArray.emplaceBack(zi+0,zi+1,zi+2),this.indexArray.emplaceBack(zi+1,zi+3,zi+2),Ct.primitiveLength+=2,De){const hr=Ze+(1===Vn?mt.length-2:Vn-2),Ui=1===Vn?Ze:hr+1;if(this.indexArray.emplaceBack(zi+1,hr,zi+3),this.indexArray.emplaceBack(hr,Ui,zi+3),Ct.primitiveLength+=2,void 0===an&&(an=zi),!C_(oi,mt[Vn],gt)){const Nr=Vn===mt.length-1?an:Ct.vertexLength;this.indexArray.emplaceBack(zi+2,zi+3,Nr),this.indexArray.emplaceBack(zi+3,Nr+1,Nr),this.indexArray.emplaceBack(zi+3,Ui,Nr+1),Ct.primitiveLength+=3}Bn=!Bn}if(R){const hr=this.layoutVertexExtArray,Ui=C.projectTilePoint(Kn.x,Kn.y,u),Nr=C.projectTilePoint(yn.x,yn.y,u),$i=C.upVector(u,Kn.x,Kn.y),yr=C.upVector(u,yn.x,yn.y);$u(hr,Ui,$i),$u(hr,Ui,$i),$u(hr,Nr,yr),$u(hr,Nr,yr)}}H&&(Ze+=mt.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const We=N.borders,gt=this.featuresOnBorder.push(N)-1;for(let Ze=0;Ze<4;Ze++)We[Ze][0]!==Number.MAX_VALUE&&this.borders[Ze].push(gt)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,m,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,s)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,n,s=!0){let u,p;if(e)if(0!==e.y){const v=n.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(v.x/10)),p=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(v.y/10))}else u=Math.ceil(7*(e.x+450)),p=0;else u=0,p=+s;let m=s?this.centroidVertexArray.length:n.vertexArrayOffset;for(const v of n.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*v.edges+v.top);for(let E=0;E<v.top;E++)this.centroidVertexArray.emplace(m++,u,p);for(let E=0;E<2*v.edges;E++)this.centroidVertexArray.emplace(m++,0,p),this.centroidVertexArray.emplace(m++,u,p)}}}function Hp(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function Gp(t,e,n,s){const u=e.sub(t)._perp()._unit(),p=n.sub(e)._perp()._unit();return $p(t,e,n,Hp(u,p),s)}function $p(t,e,n,s,u){const p=Math.sqrt(1-s*s);return Math.min(t.dist(e)/3,e.dist(n)/3,u*p/s)}function C_(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function Zp(t,e,n){if(t.x<0||t.x>=Li||e.x<0||e.x>=Li||n.x<0||n.x>=Li)return!1;const s=n.sub(e),u=s.perp(),p=t.sub(e);return(s.x*p.x+s.y*p.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(p.x*p.x+p.y*p.y))>-.866&&u.x*p.x+u.y*p.y<0}function Cm(t,e,n){const s=e?2|t:-3&t;return n?1|s:-2&s}function Wp(){const t=Math.PI/32,e=Math.tan(t),n=fd;return n*Math.sqrt(1+2*e*e)-n}function Mm(t,e,n){const s=1<<n.z,u=Tl(n.x/s),p=Tl((n.x+1)/s),m=Ws(n.y/s),v=Ws((n.y+1)/s);return function(E,C,R,N,H=0,K){const J=[];if(!E.length||!R||!N)return J;const se=(mt,an)=>{for(const en of mt)J.push({polygon:en,bounds:an})},De=Math.ceil(Math.log2(R)),We=Math.ceil(Math.log2(N)),gt=De-We,Ze=[];for(let mt=0;mt<Math.abs(gt);mt++)Ze.push(gt>0?0:1);for(let mt=0;mt<Math.min(De,We);mt++)Ze.push(0),Ze.push(1);let at=E;if(at=Ad(at,C[0].y-H,C[1].y+H,1),at=Ad(at,C[0].x-H,C[1].x+H,0),!at.length)return J;const Ct=[];for(Ze.length?Ct.push({polygons:at,bounds:C,depth:0}):se(at,C);Ct.length;){const mt=Ct.pop(),an=mt.depth,en=Ze[an],An=mt.bounds[0],Yn=mt.bounds[1],gn=0===en?An.x:An.y,Bn=0===en?Yn.x:Yn.y,Vn=K?K(en,gn,Bn):.5*(gn+Bn),$n=Ad(mt.polygons,gn-H,Vn+H,en),Kn=Ad(mt.polygons,Vn-H,Bn+H,en);if($n.length){const yn=[An,new Qe(0===en?Vn:Yn.x,1===en?Vn:Yn.y)];Ze.length>an+1?Ct.push({polygons:$n,bounds:yn,depth:an+1}):se($n,yn)}if(Kn.length){const yn=[new Qe(0===en?Vn:An.x,1===en?Vn:An.y),Yn];Ze.length>an+1?Ct.push({polygons:Kn,bounds:yn,depth:an+1}):se(Kn,yn)}}return J}(t,e,Math.ceil((p-u)/11.25),Math.ceil((m-v)/11.25),1,(E,C,R)=>{if(0===E)return.5*(C+R);{const N=Ws((n.y+C/Li)/s);return($l(.5*(Ws((n.y+R/Li)/s)+N))*s-n.y)*Li}})}pi(Od,"FillExtrusionBucket",{omit:["layers","features"]}),pi(Em,"PartMetadata");const M_=new ki({"fill-extrusion-edge-radius":new qt(_n["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Wl={paint:new ki({"fill-extrusion-opacity":new qt(_n["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new dn(_n["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qt(_n["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qt(_n["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dn(_n["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new dn(_n["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new dn(_n["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qt(_n["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new qt(_n["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new qt(_n["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:M_};function Dm(t,e,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class Rd{constructor(e,n,s){this.z=e,this.x=n,this.y=s,this.key=kd(0,e,e,n,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const s=(m=this.y,v=this.z,E=Dm(256*(p=this.x),256*(m=Math.pow(2,v)-m-1),v),C=Dm(256*(p+1),256*(m+1),v),E[0]+","+E[1]+","+C[0]+","+C[1]),u=function(p,m,v){let E,C="";for(let R=p;R>0;R--)E=1<<R-1,C+=(m&E?1:0)+(v&E?2:0);return C}(this.z,this.x,this.y);var p,m,v,E,C;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Tm{constructor(e,n){this.wrap=e,this.canonical=n,this.key=kd(e,n.z,n.z,n.x,n.y)}}class va{constructor(e,n,s,u,p){this.overscaledZ=e,this.wrap=n,this.canonical=new Rd(s,+u,+p),this.key=0===n&&e===s?this.canonical.key:kd(n,e,s,u,p)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new va(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new va(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return kd(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return kd(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new va(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,u=2*this.canonical.y;return[new va(n,this.wrap,n,s,u),new va(n,this.wrap,n,s+1,u),new va(n,this.wrap,n,s,u+1),new va(n,this.wrap,n,s+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new va(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new va(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Tm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function kd(t,e,n,s,u){const p=1<<Math.min(n,22);let m=p*(u%p)+s%p;return t&&n<22&&(m+=p*p*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*m+n)+(e-n)}pi(Rd,"CanonicalTileID"),pi(va,"OverscaledTileID",{omit:["projMatrix"]});class Zu extends Qe{constructor(e,n,s){super(e,n),this.z=s}}function Wu(t,e){return t.x*e.x+t.y*e.y}function Sm(t,e){if(1===t.length){let n=0;const s=e[n++];let u;for(;!u||s.equals(u);)if(u=e[n++],!u)return 1/0;for(;n<e.length;n++){const p=e[n],m=t[0],v=u.sub(s),E=p.sub(s),C=m.sub(s),R=Wu(v,v),N=Wu(v,E),H=Wu(E,E),K=Wu(C,v),J=Wu(C,E),se=R*H-N*N,De=(H*K-N*J)/se,We=(R*J-N*K)/se,gt=s.z*(1-De-We)+u.z*De+p.z*We;if(isFinite(gt))return gt}return 1/0}{let n=1/0;for(const s of e)n=Math.min(n,s.z);return n}}function Am(t,e,n,s,u,p,m,v){const E=m*u.getElevationAt(t,e,!0,!0),C=0!==p[0],R=C?0===p[1]?m*(p[0]/7-450):m*function(N,H,K){const J=Math.floor(H[0]/8),se=Math.floor(H[1]/8),De=10*(H[0]-8*J),We=10*(H[1]-8*se),gt=N.getElevationAt(J,se,!0,!0),Ze=N.getMeterToDEM(K),at=Math.floor(.5*(De*Ze-1)),Ct=Math.floor(.5*(We*Ze-1)),mt=N.tileCoordToPixel(J,se),an=2*at+1,en=2*Ct+1,An=(Fi=an,ui=en,[(Kn=N).getElevationAtPixel(yn=mt.x-at,oi=mt.y-Ct,!0),Kn.getElevationAtPixel(yn+ui,oi,!0),Kn.getElevationAtPixel(yn,oi+ui,!0),Kn.getElevationAtPixel(yn+Fi,oi+ui,!0)]),Yn=Math.abs(An[0]-An[1]),gn=Math.abs(An[2]-An[3]),Bn=Math.abs(An[0]-An[2])+Math.abs(An[1]-An[3]),Vn=Math.min(.25,.5*Ze*(Yn+gn)/an),$n=Math.min(.25,.5*Ze*Bn/en);var Kn,yn,oi,Fi,ui;return gt+Math.max(Vn*De,$n*We)}(u,p,v):E;return{base:E+(0===n)?-1:n,top:C?Math.max(R+s,E+n+2):E+s}}const D_=gi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:gr}=D_,Im=gi([{name:"a_packed",components:4,type:"Float32"}]),{members:Pm}=Im,Om=Gu.types,T_=Math.cos(Math.PI/180*37.5);class Oh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new La,this.layoutVertexArray2=new na,this.indexArray=new Ps,this.programConfigurations=new cu(e.layers,e.zoom),this.segments=new ps,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,u){this.hasPattern=Td("line",this.layers,n);const p=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:R,id:N,index:H,sourceLayerIndex:K}of e){const J=this.layers[0]._featureFilter.needGeometry,se=Cc(R,J);if(!this.layers[0]._featureFilter.filter(new $t(this.zoom),se,s))continue;const De=p?p.evaluate(se,{},s):void 0,We={id:N,properties:R.properties,type:R.type,sourceLayerIndex:K,index:H,geometry:J?se.geometry:sc(R,s,u),patterns:{},sortKey:De};m.push(We)}p&&m.sort((R,N)=>R.sortKey-N.sortKey);const{lineAtlas:v,featureIndex:E}=n,C=this.addConstantDashes(v);for(const R of m){const{geometry:N,index:H,sourceLayerIndex:K}=R;if(C&&this.addFeatureDashes(R,v),this.hasPattern){const J=Th("line",this.layers,R,this.zoom,n);this.patternFeatures.push(J)}else this.addFeature(R,N,H,s,v.positions,n.availableImages);E.insert(e[H].feature,N,H,K,this.index)}}addConstantDashes(e){let n=!1;for(const s of this.layers){const u=s.paint.get("line-dasharray").value,p=s.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==p.kind)n=!0;else{const m=p.value,v=u.value;if(!v)continue;e.addDash(v,m)}}return n}addFeatureDashes(e,n){const s=this.zoom;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if("constant"===p.kind&&"constant"===m.kind)continue;let v,E;if("constant"===p.kind){if(v=p.value,!v)continue}else v=p.evaluate({zoom:s},e);E="constant"===m.kind?m.value:m.evaluate({zoom:s},e),n.addDash(v,E),e.patterns[u.id]=n.getKey(v,E)}}update(e,n,s,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,u)}addFeatures(e,n,s,u,p){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,n,s,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Pm)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gr),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,s,u,p,m){const v=this.layers[0].layout,E=v.get("line-join").evaluate(e,{}),C=v.get("line-cap").evaluate(e,{}),R=v.get("line-miter-limit"),N=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const H of n)this.addLine(H,e,E,C,R,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,p,m,u)}addLine(e,n,s,u,p,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let We=0;We<e.length-1;We++)this.totalDistance+=e[We].dist(e[We+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v="Polygon"===Om[n.type];let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let C=0;for(;C<E-1&&e[C].equals(e[C+1]);)C++;if(E<(v?3:2))return;"bevel"===s&&(p=1.05);const R=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let H,K,J,se,De;this.e1=this.e2=-1,v&&(H=e[E-2],De=e[C].sub(H)._unit()._perp());for(let We=C;We<E;We++){if(J=We===E-1?v?e[C+1]:void 0:e[We+1],J&&e[We].equals(J))continue;De&&(se=De),H&&(K=H),H=e[We],De=J?J.sub(H)._unit()._perp():se,se=se||De;let gt=se.add(De);0===gt.x&&0===gt.y||gt._unit();const Ze=se.x*De.x+se.y*De.y,at=gt.x*De.x+gt.y*De.y,Ct=0!==at?1/at:1/0,mt=2*Math.sqrt(2-2*at),an=at<T_&&K&&J,en=se.x*De.y-se.y*De.x>0;if(an&&We>C){const gn=H.dist(K);if(gn>2*R){const Bn=H.sub(H.sub(K)._mult(R/gn)._round());this.updateDistance(K,Bn),this.addCurrentVertex(Bn,se,0,0,N),K=Bn}}const An=K&&J;let Yn=An?s:v?"butt":u;if(An&&"round"===Yn&&(Ct<m?Yn="miter":Ct<=2&&(Yn="fakeround")),"miter"===Yn&&Ct>p&&(Yn="bevel"),"bevel"===Yn&&(Ct>2&&(Yn="flipbevel"),Ct<p&&(Yn="miter")),K&&this.updateDistance(K,H),"miter"===Yn)gt._mult(Ct),this.addCurrentVertex(H,gt,0,0,N);else if("flipbevel"===Yn){if(Ct>100)gt=De.mult(-1);else{const gn=Ct*se.add(De).mag()/se.sub(De).mag();gt._perp()._mult(gn*(en?-1:1))}this.addCurrentVertex(H,gt,0,0,N),this.addCurrentVertex(H,gt.mult(-1),0,0,N)}else if("bevel"===Yn||"fakeround"===Yn){const gn=-Math.sqrt(Ct*Ct-1),Bn=en?gn:0,Vn=en?0:gn;if(K&&this.addCurrentVertex(H,se,Bn,Vn,N),"fakeround"===Yn){const $n=Math.round(180*mt/Math.PI/20);for(let Kn=1;Kn<$n;Kn++){let yn=Kn/$n;if(.5!==yn){const Fi=yn-.5;yn+=yn*Fi*(yn-1)*((1.0904+Ze*(Ze*(3.55645-1.43519*Ze)-3.2452))*Fi*Fi+(.848013+Ze*(.215638*Ze-1.06021)))}const oi=De.sub(se)._mult(yn)._add(se)._unit()._mult(en?-1:1);this.addHalfVertex(H,oi.x,oi.y,!1,en,0,N)}}J&&this.addCurrentVertex(H,De,-Bn,-Vn,N)}else if("butt"===Yn)this.addCurrentVertex(H,gt,0,0,N);else if("square"===Yn){const gn=K?1:-1;K||this.addCurrentVertex(H,gt,gn,gn,N),this.addCurrentVertex(H,gt,0,0,N),K&&this.addCurrentVertex(H,gt,gn,gn,N)}else"round"===Yn&&(K&&(this.addCurrentVertex(H,se,0,0,N),this.addCurrentVertex(H,se,1,1,N,!0)),J&&(this.addCurrentVertex(H,De,-1,-1,N,!0),this.addCurrentVertex(H,De,0,0,N)));if(an&&We<E-1){const gn=H.dist(J);if(gn>2*R){const Bn=H.add(J.sub(H)._mult(R/gn)._round());this.updateDistance(H,Bn),this.addCurrentVertex(Bn,De,0,0,N),H=Bn}}}}addCurrentVertex(e,n,s,u,p,m=!1){const v=n.y*u-n.x,E=-n.y-n.x*u;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,m,!1,s,p),this.addHalfVertex(e,v,E,m,!0,-u,p)}addHalfVertex({x:e,y:n},s,u,p,m,v,E){this.layoutVertexArray.emplaceBack((e<<1)+(p?1:0),(n<<1)+(m?1:0),Math.round(63*s)+128,Math.round(63*u)+128,1+(0===v?0:v<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),E.primitiveLength++),m?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}pi(Oh,"LineBucket",{omit:["layers","patternFeatures"]});const Rm=new ki({"line-cap":new dn(_n.layout_line["line-cap"]),"line-join":new dn(_n.layout_line["line-join"]),"line-miter-limit":new qt(_n.layout_line["line-miter-limit"]),"line-round-limit":new qt(_n.layout_line["line-round-limit"]),"line-sort-key":new dn(_n.layout_line["line-sort-key"])});var km={paint:new ki({"line-opacity":new dn(_n.paint_line["line-opacity"]),"line-color":new dn(_n.paint_line["line-color"]),"line-translate":new qt(_n.paint_line["line-translate"]),"line-translate-anchor":new qt(_n.paint_line["line-translate-anchor"]),"line-width":new dn(_n.paint_line["line-width"]),"line-gap-width":new dn(_n.paint_line["line-gap-width"]),"line-offset":new dn(_n.paint_line["line-offset"]),"line-blur":new dn(_n.paint_line["line-blur"]),"line-dasharray":new dn(_n.paint_line["line-dasharray"]),"line-pattern":new dn(_n.paint_line["line-pattern"]),"line-gradient":new Ei(_n.paint_line["line-gradient"]),"line-trim-offset":new qt(_n.paint_line["line-trim-offset"])}),layout:Rm};const qp=new class extends dn{possiblyEvaluate(t,e){return e=new $t(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,s){return e=Xt({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,s)}}(km.paint.properties["line-width"].specification);function Fm(t,e){return e>0?e+2*t:t}qp.useIntegerZoom=!0;const S_=gi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xy=gi([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Lm=gi([{name:"a_projected_pos",components:4,type:"Float32"}],4);gi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Bm=gi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),yu=gi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);gi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Nm=gi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Yp=gi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);gi([{name:"triangle",components:3,type:"Uint16"}]),gi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),gi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),gi([{type:"Float32",name:"offsetX"}]),gi([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const hc=128;function zm(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new $t(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:u}=n;let p=0;for(;p<s.length&&s[p]<=t;)p++;p=Math.max(0,p-1);let m=p;for(;m<s.length&&s[m]<t+1;)m++;m=Math.min(s.length-1,m);const v=s[p],E=s[m];return"composite"===n.kind?{kind:"composite",minZoom:v,maxZoom:E,interpolationType:u}:{kind:"camera",minZoom:v,maxZoom:E,minSize:n.evaluate(new $t(v)),maxSize:n.evaluate(new $t(E)),interpolationType:u}}}function Kp(t,{uSize:e,uSizeT:n},{lowerSize:s,upperSize:u}){return"source"===t.kind?s/hc:"composite"===t.kind?wn(s/hc,u/hc,n):e}function Fd(t,e){let n=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){const{interpolationType:u,minZoom:p,maxZoom:m}=t,v=u?Ke(js.interpolationFactor(u,e,p,m),0,1):0;"camera"===t.kind?s=wn(t.minSize,t.maxSize,v):n=v}return{uSizeT:n,uSize:s}}var A_=Object.freeze({__proto__:null,getSizeData:zm,evaluateSizeForFeature:Kp,evaluateSizeForZoom:Fd,SIZE_PACK_FACTOR:hc});function Um(t,e,n){return t.sections.forEach(s=>{s.text=function(u,p,m){const v=p.layout.get("text-transform").evaluate(m,{});return"uppercase"===v?u=u.toLocaleUpperCase():"lowercase"===v&&(u=u.toLocaleLowerCase()),rn.applyArabicShaping&&(u=rn.applyArabicShaping(u)),u}(s.text,e,n)}),t}const Rh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function I_(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function qu(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var Ld=ao,Xp=function(t,e,n,s,u){var p,m,v=8*u-s-1,E=(1<<v)-1,C=E>>1,R=-7,N=n?u-1:0,H=n?-1:1,K=t[e+N];for(N+=H,p=K&(1<<-R)-1,K>>=-R,R+=v;R>0;p=256*p+t[e+N],N+=H,R-=8);for(m=p&(1<<-R)-1,p>>=-R,R+=s;R>0;m=256*m+t[e+N],N+=H,R-=8);if(0===p)p=1-C;else{if(p===E)return m?NaN:1/0*(K?-1:1);m+=Math.pow(2,s),p-=C}return(K?-1:1)*m*Math.pow(2,p-s)},Bd=function(t,e,n,s,u,p){var m,v,E,C=8*p-u-1,R=(1<<C)-1,N=R>>1,H=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,K=s?0:p-1,J=s?1:-1,se=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,m=R):(m=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-m))<1&&(m--,E*=2),(e+=m+N>=1?H/E:H*Math.pow(2,1-N))*E>=2&&(m++,E/=2),m+N>=R?(v=0,m=R):m+N>=1?(v=(e*E-1)*Math.pow(2,u),m+=N):(v=e*Math.pow(2,N-1)*Math.pow(2,u),m=0));u>=8;t[n+K]=255&v,K+=J,v/=256,u-=8);for(m=m<<u|v,C+=u;C>0;t[n+K]=255&m,K+=J,m/=256,C-=8);t[n+K-J]|=128*se};function ao(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ao.Varint=0,ao.Fixed64=1,ao.Bytes=2,ao.Fixed32=5;var kh=4294967296,Vm=1/kh,jm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ic(t){return t.type===ao.Bytes?t.readVarint()+t.pos:t.pos+1}function Hm(t,e,n){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(s);for(var u=n.pos-1;u>=t;u--)n.buf[u+s]=n.buf[u]}function Gm(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function P_(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function $m(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function Zm(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function Qp(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function Qy(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function Jp(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function O_(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function Jy(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Pc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function vu(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function ef(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Fh(t,e,n){e.glyphs=[],1===t&&n.readMessage(ql,e)}function ql(t,e,n){if(3===t){const{id:s,bitmap:u,width:p,height:m,left:v,top:E,advance:C}=n.readMessage(Wm,{});e.glyphs.push({id:s,bitmap:new Sc({width:p+6,height:m+6},u),metrics:{width:p,height:m,left:v,top:E,advance:C}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function Wm(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function tf(t){let e=0,n=0;for(const m of t)e+=m.w*m.h,n=Math.max(n,m.w);t.sort((m,v)=>v.h-m.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let u=0,p=0;for(const m of t)for(let v=s.length-1;v>=0;v--){const E=s[v];if(!(m.w>E.w||m.h>E.h)){if(m.x=E.x,m.y=E.y,p=Math.max(p,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===E.w&&m.h===E.h){const C=s.pop();v<s.length&&(s[v]=C)}else m.h===E.h?(E.x+=m.w,E.w-=m.w):m.w===E.w?(E.y+=m.h,E.h-=m.h):(s.push({x:E.x+m.w,y:E.y,w:E.w-m.w,h:m.h}),E.y+=m.h,E.h-=m.h);break}}return{w:u,h:p,fill:e/(u*p)||0}}ao.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var s=this.readVarint(),u=s>>3,p=this.pos;this.type=7&s,t(u,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Pc(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=ef(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Pc(this.buf,this.pos)+Pc(this.buf,this.pos+4)*kh;return this.pos+=8,t},readSFixed64:function(){var t=Pc(this.buf,this.pos)+ef(this.buf,this.pos+4)*kh;return this.pos+=8,t},readFloat:function(){var t=Xp(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Xp(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,s=this.buf;return e=127&(n=s[this.pos++]),n<128?e:(e|=(127&(n=s[this.pos++]))<<7,n<128?e:(e|=(127&(n=s[this.pos++]))<<14,n<128?e:(e|=(127&(n=s[this.pos++]))<<21,n<128?e:function(u,p,m){var v,E,C=m.buf;if(v=(112&(E=C[m.pos++]))>>4,E<128||(v|=(127&(E=C[m.pos++]))<<3,E<128)||(v|=(127&(E=C[m.pos++]))<<10,E<128)||(v|=(127&(E=C[m.pos++]))<<17,E<128)||(v|=(127&(E=C[m.pos++]))<<24,E<128)||(v|=(1&(E=C[m.pos++]))<<31,E<128))return function Yu(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(u,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&jm?jm.decode(this.buf.subarray(e,t)):function(n,s,u){for(var p="",m=s;m<u;){var v,E,C,R=n[m],N=null,H=R>239?4:R>223?3:R>191?2:1;if(m+H>u)break;1===H?R<128&&(N=R):2===H?128==(192&(v=n[m+1]))&&(N=(31&R)<<6|63&v)<=127&&(N=null):3===H?(E=n[m+2],128==(192&(v=n[m+1]))&&128==(192&E)&&((N=(15&R)<<12|(63&v)<<6|63&E)<=2047||N>=55296&&N<=57343)&&(N=null)):4===H&&(E=n[m+2],C=n[m+3],128==(192&(v=n[m+1]))&&128==(192&E)&&128==(192&C)&&((N=(15&R)<<18|(63&v)<<12|(63&E)<<6|63&C)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,H=1):N>65535&&(N-=65536,p+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),p+=String.fromCharCode(N),m+=H}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ao.Bytes)return t.push(this.readVarint(e));var n=Ic(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ao.Bytes)return t.push(this.readSVarint());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ao.Bytes)return t.push(this.readBoolean());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ao.Bytes)return t.push(this.readFloat());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ao.Bytes)return t.push(this.readDouble());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ao.Bytes)return t.push(this.readFixed32());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ao.Bytes)return t.push(this.readSFixed32());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ao.Bytes)return t.push(this.readFixed64());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ao.Bytes)return t.push(this.readSFixed64());var e=Ic(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===ao.Varint)for(;this.buf[this.pos++]>127;);else if(e===ao.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ao.Fixed32)this.pos+=4;else{if(e!==ao.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),vu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),vu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),vu(this.buf,-1&t,this.pos),vu(this.buf,Math.floor(t*Vm),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),vu(this.buf,-1&t,this.pos),vu(this.buf,Math.floor(t*Vm),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var s,u,p,v;if(e>=0?(s=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),p=s,(v=n).buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7),function(p,m){var v=(7&p)<<4;m.buf[m.pos++]|=v|((p>>>=3)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p|((p>>>=7)?128:0),p&&(m.buf[m.pos++]=127&p)))))}(u,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,u,p){for(var m,v,E=0;E<u.length;E++){if((m=u.charCodeAt(E))>55295&&m<57344){if(!v){m>56319||E+1===u.length?(s[p++]=239,s[p++]=191,s[p++]=189):v=m;continue}if(m<56320){s[p++]=239,s[p++]=191,s[p++]=189,v=m;continue}m=v-55296<<10|m-56320|65536,v=null}else v&&(s[p++]=239,s[p++]=191,s[p++]=189,v=null);m<128?s[p++]=m:(m<2048?s[p++]=m>>6|192:(m<65536?s[p++]=m>>12|224:(s[p++]=m>>18|240,s[p++]=m>>12&63|128),s[p++]=m>>6&63|128),s[p++]=63&m|128)}return p}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&Hm(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Bd(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Bd(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var s=this.pos-n;s>=128&&Hm(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,n){this.writeTag(t,ao.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Gm,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,P_,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,Qp,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,$m,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,Zm,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Qy,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Jp,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,O_,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Jy,e)},writeBytesField:function(t,e){this.writeTag(t,ao.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ao.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ao.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ao.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ao.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ao.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ao.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ao.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ao.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ao.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Nd{constructor(e,{pixelRatio:n,version:s,stretchX:u,stretchY:p,content:m}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=u,this.stretchY=p,this.content=m,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class pc{constructor(e,n){const s={},u={};this.haveRenderCallbacks=[];const p=[];this.addImages(e,s,p),this.addImages(n,u,p);const{w:m,h:v}=tf(p),E=new Na({width:m||1,height:v||1});for(const C in e){const R=e[C],N=s[C].paddedRect;Na.copy(R.data,E,{x:0,y:0},{x:N.x+1,y:N.y+1},R.data)}for(const C in n){const R=n[C],N=u[C].paddedRect,H=N.x+1,K=N.y+1,J=R.data.width,se=R.data.height;Na.copy(R.data,E,{x:0,y:0},{x:H,y:K},R.data),Na.copy(R.data,E,{x:0,y:se-1},{x:H,y:K-1},{width:J,height:1}),Na.copy(R.data,E,{x:0,y:0},{x:H,y:K+se},{width:J,height:1}),Na.copy(R.data,E,{x:J-1,y:0},{x:H-1,y:K},{width:1,height:se}),Na.copy(R.data,E,{x:0,y:0},{x:H+J,y:K},{width:1,height:se})}this.image=E,this.iconPositions=s,this.patternPositions=u}addImages(e,n,s){for(const u in e){const p=e[u],m={x:0,y:0,w:p.data.width+2,h:p.data.height+2};s.push(m),n[u]=new Nd(m,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)}patchUpdatedImage(e,n,s){if(!e||!n||e.version===n.version)return;e.version=n.version;const[u,p]=e.tl;s.update(n.data,void 0,{x:u,y:p})}}pi(Nd,"ImagePosition"),pi(pc,"ImageAtlas");const za={horizontal:1,vertical:2,horizontalOnly:3};class Ku{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const s=new Ku;return s.scale=e||1,s.fontStack=n,s}static forImage(e){const n=new Ku;return n.imageName=e,n}}class Zc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const s=new Zc;for(let u=0;u<e.sections.length;u++){const p=e.sections[u];p.image?s.addImageSection(p):s.addTextSection(p,n)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,s){let u="";for(let p=0;p<n.length;p++){const m=n.charCodeAt(p+1)||null,v=n.charCodeAt(p-1)||null;u+=!s&&(m&&Z(m)&&!Rh[n[p+1]]||v&&Z(v)&&!Rh[n[p-1]])||!Rh[n[p]]?n[p]:Rh[n[p]]}return u}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&zd[this.text.charCodeAt(s)];s++)e++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&zd[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const s=new Zc;return s.text=this.text.substring(e,n),s.sectionIndex=this.sectionIndex.slice(e,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push(Ku.forText(e.scale,e.fontStack||n));const s=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(s)}addImageSection(e){const n=e.image?e.image.name:"";if(0===n.length)return void Xe("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(Ku.forImage(n)),this.sectionIndex.push(this.sections.length-1)):Xe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function qm(t,e,n,s,u,p,m,v,E,C,R,N,H,K,J){const se=Zc.fromFeature(t,u);N===za.vertical&&se.verticalizePunctuation(H);let De=[];const We=function(mt,an,en,An,Yn,gn){if(!mt)return[];const Bn=[],Vn=function(oi,Fi,ui,ai,si,zi){let _r=0;for(let dr=0;dr<oi.length();dr++){const hr=oi.getSection(dr);_r+=Ud(oi.getCharCode(dr),hr,ai,si,Fi,zi)}return _r/Math.max(1,Math.ceil(_r/ui))}(mt,an,en,An,Yn,gn),$n=mt.text.indexOf("\u200b")>=0;let Kn=0;for(let oi=0;oi<mt.length();oi++){const Fi=mt.getSection(oi),ui=mt.getCharCode(oi);if(zd[ui]||(Kn+=Ud(ui,Fi,An,Yn,an,gn)),oi<mt.length()-1){const ai=!((yn=ui)<11904||!(Y(yn)||V(yn)||c(yn)||ta(yn)||Sn(yn)||wl(yn)||me(yn)||O(yn)||fi(yn)||rr(yn)||bt(yn)||x(yn)||k(yn)||Ru(yn)||jc(yn)||et(yn)||I(yn)||i(yn)||Vr(yn)||Si(yn)));(ev[ui]||ai||Fi.imageName)&&Bn.push(Lh(oi+1,Kn,Vn,Bn,nf(ui,mt.getCharCode(oi+1),ai&&$n),!1))}}var yn;return Bh(Lh(mt.length(),Kn,Vn,Bn,0,!0))}(se,C,p,e,s,K),{processBidirectionalText:gt,processStyledBidirectionalText:Ze}=rn;if(gt&&1===se.sections.length){const mt=gt(se.toString(),We);for(const an of mt){const en=new Zc;en.text=an,en.sections=se.sections;for(let An=0;An<an.length;An++)en.sectionIndex.push(0);De.push(en)}}else if(Ze){const mt=Ze(se.text,se.sectionIndex,We);for(const an of mt){const en=new Zc;en.text=an[0],en.sectionIndex=an[1],en.sections=se.sections,De.push(en)}}else De=function(mt,an){const en=[],An=mt.text;let Yn=0;for(const gn of an)en.push(mt.substring(Yn,gn)),Yn=gn;return Yn<An.length&&en.push(mt.substring(Yn,An.length)),en}(se,We);const at=[],Ct={positionedLines:at,text:se.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(mt,an,en,An,Yn,gn,Bn,Vn,$n,Kn,yn,oi){let Fi=0,ui=0,ai=0;const si="right"===Vn?1:"left"===Vn?0:.5;let zi=!1;for(const $i of Yn){const yr=$i.getSections();for(const Kr of yr){if(Kr.imageName)continue;const lo=an[Kr.fontStack];if(lo&&(zi=void 0!==lo.ascender&&void 0!==lo.descender,!zi))break}if(!zi)break}let _r=0;for(const $i of Yn){$i.trim();const yr=$i.getMaxScale(),Kr=24*(yr-1),lo={positionedGlyphs:[],lineOffset:0};mt.positionedLines[_r]=lo;const co=lo.positionedGlyphs;let uo=0;if(!$i.length()){ui+=gn,++_r;continue}let To=0,Ro=0;for(let Er=0;Er<$i.length();Er++){const ts=$i.getSection(Er),Ko=$i.getSectionIndex(Er),lr=$i.getCharCode(Er);let Rr=ts.scale,ho=null,$r=null,Lo=null,aa=24,Os=0;const Rs=!($n===za.horizontal||!yn&&!W(lr)||yn&&(zd[lr]||(dr=lr,Fa(dr)||su(dr)||ic(dr)||d(dr)||y(dr))));if(ts.imageName){const ba=An[ts.imageName];if(!ba)continue;Lo=ts.imageName,mt.iconsInText=mt.iconsInText||!0,$r=ba.paddedRect;const ms=ba.displaySize;Rr=24*Rr/oi,ho={width:ms[0],height:ms[1],left:1,top:-3,advance:Rs?ms[1]:ms[0],localGlyph:!1},Os=zi?-ho.height*Rr:24*yr-17-ms[1]*Rr,aa=ho.advance;const pl=(Rs?ms[0]:ms[1])*Rr-24*yr;pl>0&&pl>uo&&(uo=pl)}else{const ba=en[ts.fontStack];if(!ba)continue;ba[lr]&&($r=ba[lr]);const ms=an[ts.fontStack];if(!ms)continue;const pl=ms.glyphs[lr];if(!pl)continue;if(ho=pl.metrics,aa=8203!==lr?24:0,zi){const ad=void 0!==ms.ascender?Math.abs(ms.ascender):0,ld=void 0!==ms.descender?Math.abs(ms.descender):0,th=(ad+ld)*Rr;To<th&&(To=th,Ro=(ad-ld)/2*Rr),Os=-ad*Rr}else Os=24*(yr-Rr)-17}Rs?(mt.verticalizable=!0,co.push({glyph:lr,imageName:Lo,x:Fi,y:ui+Os,vertical:Rs,scale:Rr,localGlyph:ho.localGlyph,fontStack:ts.fontStack,sectionIndex:Ko,metrics:ho,rect:$r}),Fi+=aa*Rr+Kn):(co.push({glyph:lr,imageName:Lo,x:Fi,y:ui+Os,vertical:Rs,scale:Rr,localGlyph:ho.localGlyph,fontStack:ts.fontStack,sectionIndex:Ko,metrics:ho,rect:$r}),Fi+=ho.advance*Rr+Kn)}0!==co.length&&(ai=Math.max(Fi-Kn,ai),zi?Km(co,si,uo,Ro,gn*yr/2):Km(co,si,uo,0,gn/2)),Fi=0;const fs=gn*yr+uo;lo.lineOffset=Math.max(uo,Kr),ui+=fs,++_r}var dr;const hr=ui,{horizontalAlign:Ui,verticalAlign:Nr}=Ym(Bn);(function($i,yr,Kr,lo,co,uo){const To=(yr-Kr)*co,Ro=-uo*lo;for(const fs of $i)for(const Er of fs.positionedGlyphs)Er.x+=To,Er.y+=Ro})(mt.positionedLines,si,Ui,Nr,ai,hr),mt.top+=-Nr*hr,mt.bottom=mt.top+hr,mt.left+=-Ui*ai,mt.right=mt.left+ai,mt.hasBaseline=zi}(Ct,e,n,s,De,m,v,E,N,C,H,J),!function(mt){for(const an of mt)if(0!==an.positionedGlyphs.length)return!1;return!0}(at)&&Ct}const zd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ev={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ud(t,e,n,s,u,p){if(e.imageName){const m=s[e.imageName];return m?m.displaySize[0]*e.scale*24/p+u:0}{const m=n[e.fontStack],v=m&&m.glyphs[t];return v?v.metrics.advance*e.scale+u:0}}function Vd(t,e,n,s){const u=Math.pow(t-e,2);return s?t<e?u/2:2*u:u+Math.abs(n)*n}function nf(t,e,n){let s=0;return 10===t&&(s-=1e4),n&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function Lh(t,e,n,s,u,p){let m=null,v=Vd(e,n,u,p);for(const E of s){const C=Vd(e-E.x,n,u,p)+E.badness;C<=v&&(m=E,v=C)}return{index:t,x:e,priorBreak:m,badness:v}}function Bh(t){return t?Bh(t.priorBreak).concat(t.index):[]}function Ym(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function Km(t,e,n,s,u){if(!(e||n||s||u))return;const p=t.length-1,m=t[p],v=(m.x+m.metrics.advance*m.scale)*e;for(let E=0;E<=p;E++)t[E].x-=v,t[E].y+=n+s+u}function R_(t,e,n){const{horizontalAlign:s,verticalAlign:u}=Ym(n),p=e[0]-t.displaySize[0]*s,m=e[1]-t.displaySize[1]*u;return{image:t,top:m,bottom:m+t.displaySize[1],left:p,right:p+t.displaySize[0]}}function Xm(t,e,n,s,u,p){const m=t.image;let v;if(m.content){const De=m.content,We=m.pixelRatio||1;v=[De[0]/We,De[1]/We,m.displaySize[0]-De[2]/We,m.displaySize[1]-De[3]/We]}const E=e.left*p,C=e.right*p;let R,N,H,K;"width"===n||"both"===n?(K=u[0]+E-s[3],N=u[0]+C+s[1]):(K=u[0]+(E+C-m.displaySize[0])/2,N=K+m.displaySize[0]);const J=e.top*p,se=e.bottom*p;return"height"===n||"both"===n?(R=u[1]+J-s[0],H=u[1]+se+s[2]):(R=u[1]+(J+se-m.displaySize[1])/2,H=R+m.displaySize[1]),{image:m,top:R,right:N,bottom:H,left:K,collisionPadding:v}}class Oc extends Qe{constructor(e,n,s,u,p){super(e,n),this.angle=u,this.z=s,void 0!==p&&(this.segment=p)}clone(){return new Oc(this.x,this.y,this.z,this.angle,this.segment)}}function rf(t,e,n,s,u){if(void 0===e.segment)return!0;let p=e,m=e.segment+1,v=0;for(;v>-n/2;){if(m--,m<0)return!1;v-=t[m].dist(p),p=t[m]}v+=t[m].dist(t[m+1]),m++;const E=[];let C=0;for(;v<n/2;){const R=t[m],N=t[m+1];if(!N)return!1;let H=t[m-1].angleTo(R)-R.angleTo(N);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:v,angleDelta:H}),C+=H;v-E[0].distance>s;)C-=E.shift().angleDelta;if(C>u)return!1;m++,v+=R.dist(N)}return!0}function k_(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Qm(t,e,n){return t?.6*e*n:0}function F_(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Jm(t,e,n,s,u,p){const m=Qm(n,u,p),v=F_(n,s)*p;let E=0;const C=k_(t)/2;for(let R=0;R<t.length-1;R++){const N=t[R],H=t[R+1],K=N.dist(H);if(E+K>C){const J=(C-E)/K,se=wn(N.x,H.x,J),De=wn(N.y,H.y,J),We=new Oc(se,De,0,H.angleTo(N),R);return!m||rf(t,We,v,m,e)?We:void 0}E+=K}}function eg(t,e,n,s,u,p,m,v,E){const C=Qm(s,p,m),R=F_(s,u),N=R*m,H=0===t[0].x||t[0].x===E||0===t[0].y||t[0].y===E;return e-N<e/4&&(e=N+e/4),tg(t,H?e/2*v%e:(R/2+2*p)*m*v%e,e,C,n,N,H,!1,E)}function tg(t,e,n,s,u,p,m,v,E){const C=p/2,R=k_(t);let N=0,H=e-n,K=[];for(let J=0;J<t.length-1;J++){const se=t[J],De=t[J+1],We=se.dist(De),gt=De.angleTo(se);for(;H+n<N+We;){H+=n;const Ze=(H-N)/We,at=wn(se.x,De.x,Ze),Ct=wn(se.y,De.y,Ze);if(at>=0&&at<E&&Ct>=0&&Ct<E&&H-C>=0&&H+C<=R){const mt=new Oc(at,Ct,0,gt,J);mt._round(),s&&!rf(t,mt,p,s,u)||K.push(mt)}}N+=We}return v||K.length||m||(K=tg(t,N/2,n,s,u,p,m,!0,E)),K}function Nh(t,e,n,s,u){const p=[];for(let m=0;m<t.length;m++){const v=t[m];let E;for(let C=0;C<v.length-1;C++){let R=v[C],N=v[C+1];R.x<e&&N.x<e||(R.x<e?R=new Qe(e,R.y+(e-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x<e&&(N=new Qe(e,R.y+(e-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y<n&&N.y<n||(R.y<n?R=new Qe(R.x+(n-R.y)/(N.y-R.y)*(N.x-R.x),n)._round():N.y<n&&(N=new Qe(R.x+(n-R.y)/(N.y-R.y)*(N.x-R.x),n)._round()),R.x>=s&&N.x>=s||(R.x>=s?R=new Qe(s,R.y+(s-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x>=s&&(N=new Qe(s,R.y+(s-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y>=u&&N.y>=u||(R.y>=u?R=new Qe(R.x+(u-R.y)/(N.y-R.y)*(N.x-R.x),u)._round():N.y>=u&&(N=new Qe(R.x+(u-R.y)/(N.y-R.y)*(N.x-R.x),u)._round()),E&&R.equals(E[E.length-1])||(E=[R],p.push(E)),E.push(N)))))}}return p}pi(Oc,"Anchor");const zh=1e20;function L_(t,e,n,s,u,p,m,v,E){for(let C=e;C<e+s;C++)B_(t,n*p+C,p,u,m,v,E);for(let C=n;C<n+u;C++)B_(t,C*p+e,1,s,m,v,E)}function B_(t,e,n,s,u,p,m){p[0]=0,m[0]=-zh,m[1]=zh,u[0]=t[e];for(let v=1,E=0,C=0;v<s;v++){u[v]=t[e+v*n];const R=v*v;do{const N=p[E];C=(u[v]-u[N]+R-N*N)/(v-N)/2}while(C<=m[E]&&--E>-1);E++,p[E]=v,m[E]=C,m[E+1]=zh}for(let v=0,E=0;v<s;v++){for(;m[E+1]<v;)E++;const C=p[E],R=v-C;t[e+v*n]=u[C]+R*R}}const ng={none:0,ideographs:1,all:2};class jd{constructor(e,n,s){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const s=[];for(const u in e)for(const p of e[u])s.push({stack:u,id:p});_t(s,({stack:u,id:p},m)=>{let v=this.entries[u];v||(v=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=v.glyphs[p];if(void 0!==E)return void m(null,{stack:u,id:p,glyph:E});if(E=this._tinySDF(v,u,p),E)return v.glyphs[p]=E,void m(null,{stack:u,id:p,glyph:E});const C=Math.floor(p/256);if(256*C>65535)return void m(new Error("glyphs > 65535 not supported"));if(v.ranges[C])return void m(null,{stack:u,id:p,glyph:E});let R=v.requests[C];R||(R=v.requests[C]=[],jd.loadGlyphRange(u,C,this.url,this.requestManager,(N,H)=>{if(H){v.ascender=H.ascender,v.descender=H.descender;for(const K in H.glyphs)this._doesCharSupportLocalGlyph(+K)||(v.glyphs[+K]=H.glyphs[+K]);v.ranges[C]=!0}for(const K of R)K(N,H);delete v.requests[C]})),R.push((N,H)=>{N?m(N):H&&m(null,{stack:u,id:p,glyph:H.glyphs[p]||null})})},(u,p)=>{if(u)n(u);else if(p){const m={};for(const{stack:v,id:E,glyph:C}of p)void 0===m[v]&&(m[v]={}),void 0===m[v].glyphs&&(m[v].glyphs={}),m[v].glyphs[E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},m[v].ascender=this.entries[v].ascender,m[v].descender=this.entries[v].descender;n(null,m)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==ng.none&&(this.localGlyphMode===ng.all?!!this.localFontFamily:!!this.localFontFamily&&(rr(e)||ws(e)||k(e)||I(e)||O(e)))}_tinySDF(e,n,s){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(s))return;let p=e.tinySDF;if(!p){let se="400";/bold/i.test(n)?se="900":/medium/i.test(n)?se="500":/light/i.test(n)&&(se="200"),p=e.tinySDF=new jd.TinySDF({fontFamily:u,fontWeight:se,fontSize:48,buffer:6,radius:16}),p.fontWeight=se}if(this.localGlyphs[p.fontWeight][s])return this.localGlyphs[p.fontWeight][s];const m=String.fromCharCode(s),{data:v,width:E,height:C,glyphWidth:R,glyphHeight:N,glyphLeft:H,glyphTop:K,glyphAdvance:J}=p.draw(m);return this.localGlyphs[p.fontWeight][s]={id:s,bitmap:new Sc({width:E,height:C},v),metrics:{width:R/2,height:N/2,left:H/2,top:K/2-27,advance:J/2,localGlyph:!0}}}}function N_(t,e,n,s){const u=[],p=t.image,m=p.pixelRatio,v=p.paddedRect.w-2,E=p.paddedRect.h-2,C=t.right-t.left,R=t.bottom-t.top,N=p.stretchX||[[0,v]],H=p.stretchY||[[0,E]],K=(gn,Bn)=>gn+Bn[1]-Bn[0],J=N.reduce(K,0),se=H.reduce(K,0),De=v-J,We=E-se;let gt=0,Ze=J,at=0,Ct=se,mt=0,an=De,en=0,An=We;if(p.content&&s){const gn=p.content;gt=sf(N,0,gn[0]),at=sf(H,0,gn[1]),Ze=sf(N,gn[0],gn[2]),Ct=sf(H,gn[1],gn[3]),mt=gn[0]-gt,en=gn[1]-at,an=gn[2]-gn[0]-Ze,An=gn[3]-gn[1]-Ct}const Yn=(gn,Bn,Vn,$n)=>{const Kn=af(gn.stretch-gt,Ze,C,t.left),yn=lf(gn.fixed-mt,an,gn.stretch,J),oi=af(Bn.stretch-at,Ct,R,t.top),Fi=lf(Bn.fixed-en,An,Bn.stretch,se),ui=af(Vn.stretch-gt,Ze,C,t.left),ai=lf(Vn.fixed-mt,an,Vn.stretch,J),si=af($n.stretch-at,Ct,R,t.top),zi=lf($n.fixed-en,An,$n.stretch,se),_r=new Qe(Kn,oi),dr=new Qe(ui,oi),hr=new Qe(ui,si),Ui=new Qe(Kn,si),Nr=new Qe(yn/m,Fi/m),$i=new Qe(ai/m,zi/m),yr=e*Math.PI/180;if(yr){const co=Math.sin(yr),uo=Math.cos(yr),To=[uo,-co,co,uo];_r._matMult(To),dr._matMult(To),Ui._matMult(To),hr._matMult(To)}const Kr=gn.stretch+gn.fixed,lo=Bn.stretch+Bn.fixed;return{tl:_r,tr:dr,bl:Ui,br:hr,tex:{x:p.paddedRect.x+1+Kr,y:p.paddedRect.y+1+lo,w:Vn.stretch+Vn.fixed-Kr,h:$n.stretch+$n.fixed-lo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Nr,pixelOffsetBR:$i,minFontScaleX:an/m/C,minFontScaleY:An/m/R,isSDF:n}};if(s&&(p.stretchX||p.stretchY)){const gn=z_(N,De,J),Bn=z_(H,We,se);for(let Vn=0;Vn<gn.length-1;Vn++){const $n=gn[Vn],Kn=gn[Vn+1];for(let yn=0;yn<Bn.length-1;yn++)u.push(Yn($n,Bn[yn],Kn,Bn[yn+1]))}}else u.push(Yn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:E+1}));return u}function sf(t,e,n){let s=0;for(const u of t)s+=Math.max(e,Math.min(n,u[1]))-Math.max(e,Math.min(n,u[0]));return s}function z_(t,e,n){const s=[{fixed:-1,stretch:0}];for(const[u,p]of t){const m=s[s.length-1];s.push({fixed:u-m.stretch,stretch:m.stretch}),s.push({fixed:u-m.stretch,stretch:m.stretch+(p-u)})}return s.push({fixed:e+1,stretch:n}),s}function af(t,e,n,s){return t/e*n+s}function lf(t,e,n,s){return t-e*n/s}function Wc(t,e,n,s){const u=e+t.positionedLines[s].lineOffset;return 0===s?n+u/2:n+(u+(e+t.positionedLines[s-1].lineOffset))/2}jd.loadGlyphRange=function(t,e,n,s,u){const p=256*e,m=p+255,v=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${p}-${m}`),te.Glyphs);ni(v,(E,C)=>{if(E)u(E);else if(C){const R={},N=new Ld(C).readFields(Fh,{});for(const H of N.glyphs)R[H.id]=H;u(null,{glyphs:R,ascender:N.ascender,descender:N.descender})}})},jd.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:s=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:m="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=n;const v=this.size=t+4*e,E=this._createCanvas(v),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${m} ${p} ${t}px ${u}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(v*v),this.gridInner=new Float64Array(v*v),this.f=new Float64Array(v),this.z=new Float64Array(v+1),this.v=new Uint16Array(v)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:s,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(t),m=Math.ceil(n),v=Math.min(this.size-this.buffer,Math.ceil(p-u)),E=Math.min(this.size-this.buffer,m+Math.ceil(s)),C=v+2*this.buffer,R=E+2*this.buffer,N=Math.max(C*R,0),H=new Uint8ClampedArray(N),K={data:H,width:C,height:R,glyphWidth:v,glyphHeight:E,glyphTop:m,glyphLeft:0,glyphAdvance:e};if(0===v||0===E)return K;const{ctx:J,buffer:se,gridInner:De,gridOuter:We}=this;J.clearRect(se,se,v,E),J.fillText(t,se,se+m);const gt=J.getImageData(se,se,v,E);We.fill(zh,0,N),De.fill(0,0,N);for(let Ze=0;Ze<E;Ze++)for(let at=0;at<v;at++){const Ct=gt.data[4*(Ze*v+at)+3]/255;if(0===Ct)continue;const mt=(Ze+se)*C+at+se;if(1===Ct)We[mt]=0,De[mt]=zh;else{const an=.5-Ct;We[mt]=an>0?an*an:0,De[mt]=an<0?an*an:0}}L_(We,0,0,C,R,C,this.f,this.v,this.z),L_(De,se,se,v,E,C,this.f,this.v,this.z);for(let Ze=0;Ze<N;Ze++){const at=Math.sqrt(We[Ze])-Math.sqrt(De[Ze]);H[Ze]=Math.round(255-255*(at/this.radius+this.cutoff))}return K}};class cf{constructor(e=[],n=U_){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:s}=this,u=n[e];for(;e>0;){const p=e-1>>1,m=n[p];if(s(u,m)>=0)break;n[e]=m,e=p}n[e]=u}_down(e){const{data:n,compare:s}=this,u=this.length>>1,p=n[e];for(;e<u;){let m=1+(e<<1),v=n[m];const E=m+1;if(E<this.length&&s(n[E],v)<0&&(m=E,v=n[E]),s(v,p)>=0)break;n[e]=v,e=m}n[e]=p}}function U_(t,e){return t<e?-1:t>e?1:0}function ig(t,e=1,n=!1){let s=1/0,u=1/0,p=-1/0,m=-1/0;const v=t[0];for(let K=0;K<v.length;K++){const J=v[K];(!K||J.x<s)&&(s=J.x),(!K||J.y<u)&&(u=J.y),(!K||J.x>p)&&(p=J.x),(!K||J.y>m)&&(m=J.y)}const E=Math.min(p-s,m-u);let C=E/2;const R=new cf([],uf);if(0===E)return new Qe(s,u);for(let K=s;K<p;K+=E)for(let J=u;J<m;J+=E)R.push(new xu(K+C,J+C,C,t));let N=function(K){let J=0,se=0,De=0;const We=K[0];for(let gt=0,Ze=We.length,at=Ze-1;gt<Ze;at=gt++){const Ct=We[gt],mt=We[at],an=Ct.x*mt.y-mt.x*Ct.y;se+=(Ct.x+mt.x)*an,De+=(Ct.y+mt.y)*an,J+=3*an}return new xu(se/J,De/J,0,K)}(t),H=R.length;for(;R.length;){const K=R.pop();(K.d>N.d||!N.d)&&(N=K,n&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,H)),K.max-N.d<=e||(C=K.h/2,R.push(new xu(K.p.x-C,K.p.y-C,C,t)),R.push(new xu(K.p.x+C,K.p.y-C,C,t)),R.push(new xu(K.p.x-C,K.p.y+C,C,t)),R.push(new xu(K.p.x+C,K.p.y+C,C,t)),H+=4)}return n&&(console.log(`num probes: ${H}`),console.log(`best distance: ${N.d}`)),N.p}function uf(t,e){return e.max-t.max}function xu(t,e,n,s){this.p=new Qe(t,e),this.h=n,this.d=function(u,p){let m=!1,v=1/0;for(let E=0;E<p.length;E++){const C=p[E];for(let R=0,N=C.length,H=N-1;R<N;H=R++){const K=C[R],J=C[H];K.y>u.y!=J.y>u.y&&u.x<(J.x-K.x)*(u.y-K.y)/(J.y-K.y)+K.x&&(m=!m),v=Math.min(v,Sp(u,K,J))}}return(m?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const Hd=Number.POSITIVE_INFINITY,V_=Math.sqrt(2);function Rc(t,[e,n]){let s=0,u=0;if(n===Hd){e<0&&(e=0);const p=e/V_;switch(t){case"top-right":case"top-left":u=p-7;break;case"bottom-right":case"bottom-left":u=7-p;break;case"bottom":u=7-e;break;case"top":u=e-7}switch(t){case"top-right":case"bottom-right":s=-p;break;case"top-left":case"bottom-left":s=p;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":u=n-7;break;case"bottom-right":case"bottom-left":case"bottom":u=7-n}switch(t){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,u]}function rg(t,e,n,s,u,p,m,v,E,C){t.createArrays(),t.tilePixelRatio=Li/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const R=t.layers[0].layout,N=t.layers[0]._unevaluatedLayout._values,H={};if("composite"===t.textSizeData.kind){const{minZoom:se,maxZoom:De}=t.textSizeData;H.compositeTextSizes=[N["text-size"].possiblyEvaluate(new $t(se),v),N["text-size"].possiblyEvaluate(new $t(De),v)]}if("composite"===t.iconSizeData.kind){const{minZoom:se,maxZoom:De}=t.iconSizeData;H.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new $t(se),v),N["icon-size"].possiblyEvaluate(new $t(De),v)]}H.layoutTextSize=N["text-size"].possiblyEvaluate(new $t(E+1),v),H.layoutIconSize=N["icon-size"].possiblyEvaluate(new $t(E+1),v),H.textMaxSize=N["text-size"].possiblyEvaluate(new $t(18),v);const K="map"===R.get("text-rotation-alignment")&&"point"!==R.get("symbol-placement"),J=R.get("text-size");for(const se of t.features){const De=R.get("text-font").evaluate(se,{},v).join(","),We=J.evaluate(se,{},v),gt=H.layoutTextSize.evaluate(se,{},v),Ze=(H.layoutIconSize.evaluate(se,{},v),{horizontal:{},vertical:void 0}),at=se.text;let Ct,mt=[0,0];if(at){const An=at.toString(),Yn=24*R.get("text-letter-spacing").evaluate(se,{},v),gn=24*R.get("text-line-height").evaluate(se,{},v),Bn=P(An)?Yn:0,Vn=R.get("text-anchor").evaluate(se,{},v),$n=R.get("text-variable-anchor");if(!$n){const ui=R.get("text-radial-offset").evaluate(se,{},v);mt=ui?Rc(Vn,[24*ui,Hd]):R.get("text-offset").evaluate(se,{},v).map(ai=>24*ai)}let Kn=K?"center":R.get("text-justify").evaluate(se,{},v);const yn="point"===R.get("symbol-placement"),oi=yn?24*R.get("text-max-width").evaluate(se,{},v):1/0,Fi=ui=>{t.allowVerticalPlacement&&D(An)&&(Ze.vertical=qm(at,e,n,u,De,oi,gn,Vn,ui,Bn,mt,za.vertical,!0,gt,We))};if(!K&&$n){const ui="auto"===Kn?$n.map(si=>df(si)):[Kn];let ai=!1;for(let si=0;si<ui.length;si++){const zi=ui[si];if(!Ze.horizontal[zi])if(ai)Ze.horizontal[zi]=Ze.horizontal[0];else{const _r=qm(at,e,n,u,De,oi,gn,"center",zi,Bn,mt,za.horizontal,!1,gt,We);_r&&(Ze.horizontal[zi]=_r,ai=1===_r.positionedLines.length)}}Fi("left")}else{if("auto"===Kn&&(Kn=df(Vn)),yn||R.get("text-writing-mode").indexOf("horizontal")>=0||!D(An)){const ui=qm(at,e,n,u,De,oi,gn,Vn,Kn,Bn,mt,za.horizontal,!1,gt,We);ui&&(Ze.horizontal[Kn]=ui)}Fi(yn?"left":Kn)}}let an=!1;if(se.icon&&se.icon.name){const An=s[se.icon.name];An&&(Ct=R_(u[se.icon.name],R.get("icon-offset").evaluate(se,{},v),R.get("icon-anchor").evaluate(se,{},v)),an=An.sdf,void 0===t.sdfIcons?t.sdfIcons=An.sdf:t.sdfIcons!==An.sdf&&Xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(An.pixelRatio!==t.pixelRatio||0!==R.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const en=sg(Ze.horizontal)||Ze.vertical;t.iconsInText||(t.iconsInText=!!en&&en.iconsInText),(en||Ct)&&j_(t,se,Ze,Ct,s,H,gt,0,mt,an,m,v,C)}p&&t.generateCollisionDebugBuffers(E,t.collisionBoxArray)}function df(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function j_(t,e,n,s,u,p,m,v,E,C,R,N,H){let K=p.textMaxSize.evaluate(e,{},N);void 0===K&&(K=m);const J=t.layers[0].layout,se=J.get("icon-offset").evaluate(e,{},N),De=sg(n.horizontal)||n.vertical,We="globe"===H.name,gt=m/24,Ze=t.tilePixelRatio*K/24,at=(Bn=t.overscaling,t.zoom>18&&Bn>2&&(Bn>>=1),Math.max(Li/(512*Bn),1)*J.get("symbol-spacing")),Ct=J.get("text-padding")*t.tilePixelRatio,mt=J.get("icon-padding")*t.tilePixelRatio,an=Ce(J.get("text-max-angle")),en="map"===J.get("text-rotation-alignment")&&"point"!==J.get("symbol-placement"),An="map"===J.get("icon-rotation-alignment")&&"point"!==J.get("symbol-placement"),Yn=J.get("symbol-placement"),gn=at/2;var Bn;const Vn=J.get("icon-text-fit");let $n;s&&"none"!==Vn&&(t.allowVerticalPlacement&&n.vertical&&($n=Xm(s,n.vertical,Vn,J.get("icon-text-fit-padding"),se,gt)),De&&(s=Xm(s,De,Vn,J.get("icon-text-fit-padding"),se,gt)));const Kn=(yn,oi,Fi)=>{if(oi.x<0||oi.x>=Li||oi.y<0||oi.y>=Li)return;let ui=null;if(We){const{x:ai,y:si,z:zi}=H.projectTilePoint(oi.x,oi.y,Fi);ui={anchor:new Oc(ai,si,zi,0,void 0),up:H.upVector(Fi,oi.x,oi.y)}}!function(ai,si,zi,_r,dr,hr,Ui,Nr,$i,yr,Kr,lo,co,uo,To,Ro,fs,Er,ts,Ko,lr,Rr,ho,$r,Lo){const aa=ai.addToLineVertexArray(si,_r);let Os,Rs,ba,ms,pl,ad,ld,th=0,Sf=0,Af=0,nh=0,If=-1,ip=-1;const Jl={};let rp=Ya.exports("");const _c=zi?zi.anchor:si;let ih=0,op=0;if(void 0===$i._unevaluatedLayout.getValue("text-radial-offset")?[ih,op]=$i.layout.get("text-offset").evaluate(lr,{},Lo).map(Va=>24*Va):(ih=24*$i.layout.get("text-radial-offset").evaluate(lr,{},Lo),op=Hd),ai.allowVerticalPlacement&&dr.vertical){const Va=dr.vertical;if(To)ad=qc(Va),Nr&&(ld=qc(Nr));else{const ja=$i.layout.get("text-rotate").evaluate(lr,{},Lo)+90;ba=bu(yr,_c,si,Kr,lo,co,Va,uo,ja,Ro),Nr&&(ms=bu(yr,_c,si,Kr,lo,co,Nr,Er,ja))}}if(hr){const Va=$i.layout.get("icon-rotate").evaluate(lr,{},Lo),ja="none"!==$i.layout.get("icon-text-fit"),cd=N_(hr,Va,ho,ja),Pf=Nr?N_(Nr,Va,ho,ja):void 0;Rs=bu(yr,_c,si,Kr,lo,co,hr,Er,Va),th=4*cd.length;const Tg=ai.iconSizeData;let Au=null;"source"===Tg.kind?(Au=[hc*$i.layout.get("icon-size").evaluate(lr,{},Lo)],Au[0]>kc&&Xe(`${ai.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Tg.kind&&(Au=[hc*Rr.compositeIconSizes[0].evaluate(lr,{},Lo),hc*Rr.compositeIconSizes[1].evaluate(lr,{},Lo)],(Au[0]>kc||Au[1]>kc)&&Xe(`${ai.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ai.addSymbols(ai.icon,cd,Au,Ko,ts,lr,!1,zi,si,aa.lineStartIndex,aa.lineLength,-1,$r,Lo),If=ai.icon.placedSymbolArray.length-1,Pf&&(Sf=4*Pf.length,ai.addSymbols(ai.icon,Pf,Au,Ko,ts,lr,za.vertical,zi,si,aa.lineStartIndex,aa.lineLength,-1,$r,Lo),ip=ai.icon.placedSymbolArray.length-1)}for(const Va in dr.horizontal){const ja=dr.horizontal[Va];Os||(rp=Ya.exports(ja.text),To?pl=qc(ja):Os=bu(yr,_c,si,Kr,lo,co,ja,uo,$i.layout.get("text-rotate").evaluate(lr,{},Lo),Ro));const cd=1===ja.positionedLines.length;if(Af+=og(ai,zi,si,ja,Ui,$i,To,lr,Ro,aa,dr.vertical?za.horizontal:za.horizontalOnly,cd?Object.keys(dr.horizontal):[Va],Jl,If,Rr,$r,Lo),cd)break}dr.vertical&&(nh+=og(ai,zi,si,dr.vertical,Ui,$i,To,lr,Ro,aa,za.vertical,["vertical"],Jl,ip,Rr,$r,Lo));let zc=-1;const sp=(Va,ja)=>Va?Math.max(Va,ja):ja;zc=sp(pl,zc),zc=sp(ad,zc),zc=sp(ld,zc);const Dg=zc>-1?1:0;ai.glyphOffsetArray.length>=Jc.MAX_GLYPHS&&Xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==lr.sortKey&&ai.addToSortKeyRanges(ai.symbolInstances.length,lr.sortKey),ai.symbolInstances.emplaceBack(_c.x,_c.y,_c.z,si.x,si.y,Jl.right>=0?Jl.right:-1,Jl.center>=0?Jl.center:-1,Jl.left>=0?Jl.left:-1,Jl.vertical>=0?Jl.vertical:-1,If,ip,rp,void 0!==Os?Os:ai.collisionBoxArray.length,void 0!==Os?Os+1:ai.collisionBoxArray.length,void 0!==ba?ba:ai.collisionBoxArray.length,void 0!==ba?ba+1:ai.collisionBoxArray.length,void 0!==Rs?Rs:ai.collisionBoxArray.length,void 0!==Rs?Rs+1:ai.collisionBoxArray.length,ms||ai.collisionBoxArray.length,ms?ms+1:ai.collisionBoxArray.length,Kr,Af,nh,th,Sf,Dg,0,ih,op,zc)}(t,oi,ui,yn,n,s,u,$n,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Ct,en,E,0,mt,An,se,e,p,C,R,N)};if("line"===Yn)for(const yn of Nh(e.geometry,0,0,Li,Li)){const oi=eg(yn,at,an,n.vertical||De,s,24,Ze,t.overscaling,Li);for(const Fi of oi){const ui=De;ui&&hf(t,ui.text,gn,Fi)||Kn(yn,Fi,N)}}else if("line-center"===Yn){for(const yn of e.geometry)if(yn.length>1){const oi=Jm(yn,an,n.vertical||De,s,24,Ze);oi&&Kn(yn,oi,N)}}else if("Polygon"===e.type)for(const yn of Up(e.geometry,0)){const oi=ig(yn,16);Kn(yn[0],new Oc(oi.x,oi.y,0,0,void 0),N)}else if("LineString"===e.type)for(const yn of e.geometry)Kn(yn,new Oc(yn[0].x,yn[0].y,0,0,void 0),N);else if("Point"===e.type)for(const yn of e.geometry)for(const oi of yn)Kn([oi],new Oc(oi.x,oi.y,0,0,void 0),N)}const kc=32640;function og(t,e,n,s,u,p,m,v,E,C,R,N,H,K,J,se,De){const We=function(at,Ct,mt,an,en,An,Yn,gn){const Bn=[];if(0===Ct.positionedLines.length)return Bn;const Vn=an.layout.get("text-rotate").evaluate(An,{})*Math.PI/180,$n=function(ui){const ai=ui[0],si=ui[1],zi=ai*si;return zi>0?[ai,-si]:zi<0?[-ai,si]:0===ai?[si,ai]:[si,-ai]}(mt);let Kn=Math.abs(Ct.top-Ct.bottom);for(const ui of Ct.positionedLines)Kn-=ui.lineOffset;const yn=Ct.positionedLines.length,oi=Kn/yn;let Fi=Ct.top-mt[1];for(let ui=0;ui<yn;++ui){const ai=Ct.positionedLines[ui];Fi=Wc(Ct,oi,Fi,ui);for(const si of ai.positionedGlyphs){if(!si.rect)continue;const zi=si.rect||{};let _r=4,dr=!0,hr=1,Ui=0;if(si.imageName){const $r=Yn[si.imageName];if(!$r)continue;if($r.sdf){Xe("SDF images are not supported in formatted text and will be ignored.");continue}dr=!1,hr=$r.pixelRatio,_r=1/hr}const Nr=(en||gn)&&si.vertical,$i=si.metrics.advance*si.scale/2,yr=si.metrics,Kr=si.rect;if(null===Kr)continue;gn&&Ct.verticalizable&&(Ui=si.imageName?$i-si.metrics.width*si.scale/2:0);const lo=en?[si.x+$i,si.y]:[0,0];let co=[0,0],uo=[0,0],To=!1;en||(Nr?(uo=[si.x+$i+$n[0],si.y+$n[1]-Ui],To=!0):co=[si.x+$i+mt[0],si.y+mt[1]-Ui]);const Ro=Kr.w*si.scale/(hr*(si.localGlyph?2:1)),fs=Kr.h*si.scale/(hr*(si.localGlyph?2:1));let Er,ts,Ko,lr;if(Nr){const $r=si.y-Fi,Lo=new Qe(-$i,$i-$r),aa=-Math.PI/2,Os=new Qe(...uo);Er=new Qe(-$i+co[0],co[1]),Er._rotateAround(aa,Lo)._add(Os),Er.x+=-$r+$i,Er.y-=(yr.left-_r)*si.scale;const Rs=si.imageName?yr.advance*si.scale:24*si.scale,ba=String.fromCharCode(si.glyph);I_(ba)?Er.x+=(1-_r)*si.scale:qu(ba)?Er.x+=Rs-yr.height*si.scale+(-_r-1)*si.scale:Er.x+=si.imageName||yr.width+2*_r===Kr.w&&yr.height+2*_r===Kr.h?(Rs-fs)/2:(Rs-(yr.height+2*_r)*si.scale)/2,ts=new Qe(Er.x,Er.y-Ro),Ko=new Qe(Er.x+fs,Er.y),lr=new Qe(Er.x+fs,Er.y-Ro)}else{const $r=(yr.left-_r)*si.scale-$i+co[0],Lo=(-yr.top-_r)*si.scale+co[1],aa=$r+Ro,Os=Lo+fs;Er=new Qe($r,Lo),ts=new Qe(aa,Lo),Ko=new Qe($r,Os),lr=new Qe(aa,Os)}if(Vn){let $r;$r=en?new Qe(0,0):To?new Qe($n[0],$n[1]):new Qe(mt[0],mt[1]),Er._rotateAround(Vn,$r),ts._rotateAround(Vn,$r),Ko._rotateAround(Vn,$r),lr._rotateAround(Vn,$r)}const Rr=new Qe(0,0),ho=new Qe(0,0);Bn.push({tl:Er,tr:ts,bl:Ko,br:lr,tex:zi,writingMode:Ct.writingMode,glyphOffset:lo,sectionIndex:si.sectionIndex,isSDF:dr,pixelOffsetTL:Rr,pixelOffsetBR:ho,minFontScaleX:0,minFontScaleY:0})}}return Bn}(0,s,E,p,m,v,u,t.allowVerticalPlacement),gt=t.textSizeData;let Ze=null;"source"===gt.kind?(Ze=[hc*p.layout.get("text-size").evaluate(v,{},De)],Ze[0]>kc&&Xe(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===gt.kind&&(Ze=[hc*J.compositeTextSizes[0].evaluate(v,{},De),hc*J.compositeTextSizes[1].evaluate(v,{},De)],(Ze[0]>kc||Ze[1]>kc)&&Xe(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,We,Ze,E,m,v,R,e,n,C.lineStartIndex,C.lineLength,K,se,De);for(const at of N)H[at]=t.text.placedSymbolArray.length-1;return 4*We.length}function sg(t){for(const e in t)return t[e];return null}function bu(t,e,n,s,u,p,m,v,E,C){let R=m.top,N=m.bottom,H=m.left,K=m.right;const J=m.collisionPadding;if(J&&(H-=J[0],R-=J[1],K+=J[2],N+=J[3]),E){const se=new Qe(H,R),De=new Qe(K,R),We=new Qe(H,N),gt=new Qe(K,N),Ze=Ce(E);let at=new Qe(0,0);C&&(at=new Qe(C[0],C[1])),se._rotateAround(Ze,at),De._rotateAround(Ze,at),We._rotateAround(Ze,at),gt._rotateAround(Ze,at),H=Math.min(se.x,De.x,We.x,gt.x),K=Math.max(se.x,De.x,We.x,gt.x),R=Math.min(se.y,De.y,We.y,gt.y),N=Math.max(se.y,De.y,We.y,gt.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,H,R,K,N,v,s,u,p),t.length-1}function qc(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function hf(t,e,n,s){const u=t.compareText;if(e in u){const p=u[e];for(let m=p.length-1;m>=0;m--)if(s.dist(p[m])<n)return!0}else u[e]=[];return u[e].push(s),!1}const Xu=gi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Uh}=Xu,Gd=gi([{name:"a_pos_3",components:3,type:"Int16"}]);var Qu=gi([{name:"a_pos",type:"Int16",components:2}]);const fc=Li/Math.PI/2,$d=2*Ka(1,0)*fc*Math.PI,wu=[64,32,16],el=-fc,Ol=fc,tv=[new oa([el,el,el],[Ol,Ol,Ol]),new oa([el,el,el],[0,0,Ol]),new oa([0,el,el],[Ol,0,Ol]),new oa([el,0,el],[0,Ol,Ol]),new oa([0,0,el],[Ol,Ol,Ol])];function ag(t,e,n,s=!0){const u=Qa([],t._camera.position,t.worldSize),p=[e,n,1,1];Tc(p,p,t.pixelMatrixInverse),om(p,p,1/p[3]);const m=_a([],Il([],p,u)),v=t.globeMatrix,E=[v[12],v[13],v[14]],C=Il([],E,u),R=yh(C),N=_a([],C),H=t.worldSize/(2*Math.PI),K=Ja(N,m),J=Math.asin(H/R);if(J<Math.acos(K)){if(!s)return null;const Yn=[],gn=[];Qa(Yn,m,R/K),_a(gn,Il(gn,Yn,C)),_a(m,Dc(m,C,Qa(m,gn,Math.tan(J)*R)))}const se=[];new Op(u,m).closestPointOnSphere(E,H,se);const De=_a([],Mn(v,0)),We=_a([],Mn(v,1)),gt=_a([],Mn(v,2)),Ze=Ja(De,se),at=Ja(We,se),Ct=Ja(gt,se),mt=we(Math.asin(-at/H));let an=we(Math.atan2(Ze,Ct));an=t.center.lng+function(Yn,gn){const Bn=(gn-Yn+180)%360-180;return Bn<-180?Bn+360:Bn}(t.center.lng,an);const en=Gl(an),An=Ke($l(mt),0,1);return new Sl(en,An)}class lg{constructor(e,n,s){this.a=Il([],e,s),this.b=Il([],n,s),this.center=s;const u=_a([],this.a),p=_a([],this.b);this.angle=Math.acos(Ja(u,p))}}function pf(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(s,u,p,m){const v=Math.sin(p);return s*(Math.sin((1-m)*p)/v)+u*(Math.sin(m*p)/v)}(t.a[e],t.b[e],t.angle,Ke(n,0,1))+t.center[e]}function Yl(t){if(t.z<=1)return tv[t.z+2*t.y+t.x];const e=dg(Vh(t));return oa.fromPoints(e)}function Kc(t,e,n){return Qa(t,t,1-n),fu(t,t,e,n)}function cg(t,e){const n=Cu(e.zoom);if(0===n)return Yl(t);const s=Vh(t),u=dg(s),p=Gl(s.getWest())*e.worldSize,m=Gl(s.getEast())*e.worldSize,v=$l(s.getNorth())*e.worldSize,E=$l(s.getSouth())*e.worldSize,C=[p,v,0],R=[m,v,0],N=[p,E,0],H=[m,E,0],K=Ap([],e.globeMatrix);return jo(C,C,K),jo(R,R,K),jo(N,N,K),jo(H,H,K),u[0]=Kc(u[0],N,n),u[1]=Kc(u[1],H,n),u[2]=Kc(u[2],R,n),u[3]=Kc(u[3],C,n),oa.fromPoints(u)}function tl(t,e,n){for(const s of t)jo(s,s,e),Qa(s,s,n)}function Vh({x:t,y:e,z:n}){const s=1/(1<<n),u=new Tr(Tl(t*s),Ws((e+1)*s)),p=new Tr(Tl((t+1)*s),Ws(e*s));return new oc(u,p)}function dg(t){const e=Ce(t.getNorth()),n=Ce(t.getSouth()),s=Math.cos(e),u=Math.cos(n),p=Math.sin(e),m=Math.sin(n),v=t.getWest(),E=t.getEast();return[Ju(u,m,v),Ju(u,m,E),Ju(s,p,E),Ju(s,p,v)]}function Ju(t,e,n,s=fc){return n=Ce(n),[t*Math.sin(n)*s,-e*s,t*Math.cos(n)*s]}function Eu(t,e,n){return Ju(Math.cos(Ce(t)),Math.sin(Ce(t)),e,n)}function ed(t,e,n,s){const u=1<<n.z,p=(t/Li+n.x)/u;return Eu(Ws((e/Li+n.y)/u),Tl(p),s)}function jh({min:t,max:e}){return 16383/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const hg=new Float64Array(16);function Zd(t){const e=jh(t),n=r_(hg,[e,e,e]);return yd(n,n,((s=[])[0]=-(u=t.min)[0],s[1]=-u[1],s[2]=-u[2],s));var s,u}function Hh(t){const e=(s=t.min,(n=hg)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,n);var n,s;const u=1/jh(t);return pu(e,e,[u,u,u])}function pg(t,e,n,s,u){const p=function(E){const C=Li/(2*Math.PI);return E/(2*Math.PI)/C}(n),m=[t,e,-n/(2*Math.PI)],v=Al(new Float64Array(16));return yd(v,v,m),pu(v,v,[p,p,p]),vd(v,v,Ce(-u)),Ip(v,v,Ce(-s)),v}function Cu(t){return Ne(5,6,t)}function fg(t,e){const n=Eu(e.lat,e.lng);return m=(u=vh([],function(J){const se=Eu(J._center.lat,J._center.lng);let De=mu([],xd(0,1,0),se);const We=_h([],-J.angle,se);De=jo(De,De,We),_h(We,-J._pitch,De);const gt=_a([],se);return Qa(gt,gt,J.cameraToCenterDistance/J.pixelsPerMeter*$d),jo(gt,gt,We),Dc([],se,gt)}(t),n))[0],v=u[1],E=u[2],C=(p=n)[0],R=p[1],N=p[2],K=(H=Math.sqrt(m*m+v*v+E*E)*Math.sqrt(C*C+R*R+N*N))&&Ja(u,p)/H,Math.acos(Math.min(Math.max(K,-1),1));var u,p,m,v,E,C,R,N,H,K}function ff(t,e){return fg(t,e)>Math.PI/2*1.01}const mf=Ce(85),mg=Math.cos(mf),H_=Math.sin(mf);function Kl(t,e){const n=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),p=Math.sin(n)*u/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),m=Math.sin(t._pitch)*p+u;return Math.min(1.01*m,u*(1/t._horizonShift))}function Fc(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),s=t.x*n,u=(t.x+1)*n,p=t.y*n,m=(t.y+1)*n,v=Tl(s),E=Tl(u),C=Ws(p),R=Ws(m),N=e.project(v,C),H=e.project(E,C),K=e.project(E,R),J=e.project(v,R);let se=Math.min(N.x,H.x,K.x,J.x),De=Math.min(N.y,H.y,K.y,J.y),We=Math.max(N.x,H.x,K.x,J.x),gt=Math.max(N.y,H.y,K.y,J.y);const Ze=n/16;function at(mt,an,en,An,Yn,gn){const Bn=(en+Yn)/2,Vn=(An+gn)/2,$n=e.project(Tl(Bn),Ws(Vn)),Kn=Math.max(0,se-$n.x,De-$n.y,$n.x-We,$n.y-gt);se=Math.min(se,$n.x),We=Math.max(We,$n.x),De=Math.min(De,$n.y),gt=Math.max(gt,$n.y),Kn>Ze&&(at(mt,$n,en,An,Bn,Vn),at($n,an,Bn,Vn,Yn,gn))}at(N,H,s,p,u,p),at(H,K,u,p,u,m),at(K,J,u,m,s,m),at(J,N,s,m,s,p),se-=Ze,De-=Ze,We+=Ze,gt+=Ze;const Ct=1/Math.max(We-se,gt-De);return{scale:Ct,x:se*Ct,y:De*Ct,x2:We*Ct,y2:gt*Ct,projection:e}}const G_=Al(new Float32Array(16));class Xc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new Tr(0,0)}projectTilePoint(e,n,s){return{x:e,y:n,z:0}}locationPoint(e,n,s=!0){return e._coordinatePoint(e.locationCoordinate(n),s)}pixelsPerMeter(e,n){return Ka(1,e)*n}pixelSpaceConversion(e,n,s){return 1}farthestPixelDistance(e){return Kl(e,e.pixelsPerMeter)}pointCoordinate(e,n,s,u){const p=e.horizonLineFromTop(!1),m=new Qe(n,Math.max(p,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(m,u))}pointCoordinate3D(e,n,s){const u=new Qe(n,s);if(e.elevation)return e.elevation.pointCoordinate(u);{const p=this.pointCoordinate(e,u.x,u.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const s=e.horizonLineFromTop();return n.y<s}createInversionMatrix(e,n){return G_}createTileMatrix(e,n,s){let u,p,m;const v=s.canonical,E=Al(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=Fc(v,this);u=1,p=C.x+s.wrap*C.scale,m=C.y,pu(E,E,[u/C.scale,u/C.scale,e.pixelsPerMeter/n])}else u=n/e.zoomScale(v.z),p=(v.x+Math.pow(2,v.z)*s.wrap)*u,m=v.y*u;return yd(E,E,[p,m,0]),pu(E,E,[u/Li,u/Li,1]),E}upVector(e,n,s){return[0,0,1]}upVectorScale(e,n,s){return{metersToTile:1}}}class nv extends Xc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,s]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Ce(n));this.n=(u+Math.sin(Ce(s)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:s,c:u,r0:p}=this,m=Ce(e-this.center[0]),v=Ce(n),E=Math.sqrt(u-2*s*Math.sin(v))/s;return{x:E*Math.sin(m*s),y:E*Math.cos(m*s)-p,z:0}}unproject(e,n){const{n:s,c:u,r0:p}=this,m=p+n;let v=Math.atan2(e,Math.abs(m))*Math.sign(m);m*s<0&&(v-=Math.PI*Math.sign(e)*Math.sign(m));const E=Ce(this.center[0])*s;v=He(v,-Math.PI-E,Math.PI-E);const C=Ke(we(v/s)+this.center[0],-180,180),R=Math.asin(Ke((u-(e*e+m*m)*s*s)/(2*s),-1,1)),N=Ke(we(R),-85.051129,Zl);return new Tr(C,N)}}const td=1.340264,Wd=-.081106,qd=893e-6,Yd=.003796,nd=Math.sqrt(3)/2;class $_ extends Xc{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(nd*Math.sin(n)),u=s*s,p=u*u*u;return{x:.5*(e*Math.cos(s)/(nd*(td+3*Wd*u+p*(7*qd+9*Yd*u)))/Math.PI+.5),y:1-.5*(s*(td+Wd*u+p*(qd+Yd*u))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,u=s*s,p=u*u*u;for(let R,N,H,K=0;K<12&&(N=s*(td+Wd*u+p*(qd+Yd*u))-n,H=td+3*Wd*u+p*(7*qd+9*Yd*u),R=N/H,s=Ke(s-R,-Math.PI/3,Math.PI/3),u=s*s,p=u*u*u,!(Math.abs(R)<1e-12));++K);const m=nd*e*(td+3*Wd*u+p*(7*qd+9*Yd*u))/Math.cos(s),v=Math.asin(Math.sin(s)/nd),E=Ke(180*m/Math.PI,-180,180),C=Ke(180*v/Math.PI,-85.051129,Zl);return new Tr(E,C)}}class Z_ extends Xc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const s=360*(e-.5),u=Ke(360*(.5-n),-85.051129,Zl);return new Tr(s,u)}}const Lc=Math.PI/2;function id(t){return Math.tan((Lc+t)/2)}class Gh extends Xc{constructor(e){super(e),this.center=e.center||[0,30];const[n,s]=this.parallels=e.parallels||[30,30];let u=Ce(n),p=Ce(s);this.southernCenter=u+p<0,this.southernCenter&&(u=-u,p=-p);const m=Math.cos(u),v=id(u);this.n=u===p?Math.sin(u):Math.log(m/Math.cos(p))/Math.log(id(p)/v),this.f=m*Math.pow(id(u),this.n)/this.n}project(e,n){n=Ce(n),this.southernCenter&&(n=-n),e=Ce(e-this.center[0]);const s=1e-6,{n:u,f:p}=this;p>0?n<-Lc+s&&(n=-Lc+s):n>Lc-s&&(n=Lc-s);const m=p/Math.pow(id(n),u);let v=m*Math.sin(u*e),E=p-m*Math.cos(u*e);return v=.5*(v/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:v,y:this.southernCenter?E:1-E,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:s,f:u}=this,p=u-n,m=Math.sign(p),v=Math.sign(s)*Math.sqrt(e*e+p*p);let E=Math.atan2(e,Math.abs(p))*m;p*s<0&&(E-=Math.PI*Math.sign(e)*m);const C=Ke(we(E/s)+this.center[0],-180,180),R=Ke(we(2*Math.atan(Math.pow(u/v,1/s))-Lc),-85.051129,Zl);return new Tr(C,this.southernCenter?-R:R)}}class W_ extends Xc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:Gl(e),y:$l(n),z:0}}unproject(e,n){const s=Tl(e),u=Ws(n);return new Tr(s,u)}}const $h=Ce(Zl);class iv extends Xc{project(e,n){const s=(n=Ce(n))*n,u=s*s;return{x:.5*((e=Ce(e))*(.8707-.131979*s+u*(u*(.003971*s-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+s*(.015085+u*(.028874*s-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,u=25,p=0,m=s*s;do{m=s*s;const C=m*m;p=(s*(1.007226+m*(.015085+C*(.028874*m-.044475-.005916*C)))-n)/(1.007226+m*(.045255+C*(.259866*m-.311325-.005916*11*C))),s=Ke(s-p,-$h,$h)}while(Math.abs(p)>1e-6&&--u>0);m=s*s;const v=Ke(we(e/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),E=we(s);return new Tr(v,E)}}const gf=Ce(Zl);class gg extends Xc{project(e,n){n=Ce(n),e=Ce(e);const s=Math.cos(n),u=2/Math.PI,p=Math.acos(s*Math.cos(e/2)),m=Math.sin(p)/p,v=.5*(e*u+2*s*Math.sin(e/2)/m)||0,E=.5*(n+Math.sin(n)/m)||0;return{x:.5*(v/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,n){let s=e=(2*e-.5)*Math.PI,u=n=(2*(1-n)-1)*Math.PI,p=25;const m=1e-6;let v=0,E=0;do{const C=Math.cos(u),R=Math.sin(u),N=2*R*C,H=R*R,K=C*C,J=Math.cos(s/2),se=Math.sin(s/2),De=2*J*se,We=se*se,gt=1-K*J*J,Ze=gt?1/gt:0,at=gt?Math.acos(C*J)*Math.sqrt(1/gt):0,Ct=.5*(2*at*C*se+2*s/Math.PI)-e,mt=.5*(at*R+u)-n,an=.5*Ze*(K*We+at*C*J*H)+1/Math.PI,en=Ze*(De*N/4-at*R*se),An=.125*Ze*(N*se-at*R*K*De),Yn=.5*Ze*(H*J+at*We*C)+.5,gn=en*An-Yn*an;v=(mt*en-Ct*Yn)/gn,E=(Ct*An-mt*an)/gn,s=Ke(s-v,-Math.PI,Math.PI),u=Ke(u-E,-gf,gf)}while((Math.abs(v)>m||Math.abs(E)>m)&&--p>0);return new Tr(we(s),we(u))}}class _f extends Xc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ce(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:s,cosPhi:u}=this;return{x:Ce(e)*u*s+.5,y:-Math.sin(Ce(n))/u*s+.5,z:0}}unproject(e,n){const{scale:s,cosPhi:u}=this,p=-(n-.5)/s,m=Ke(we((e-.5)/s)/u,-180,180),v=Math.asin(Ke(p*u,-1,1)),E=Ke(we(v),-85.051129,Zl);return new Tr(m,E)}}class _g extends W_{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,n,s){const u=ed(e,n,s);return jo(u,u,Zd(Yl(s))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,n){const s=Eu(n.lat,n.lng),u=_a([],s),p=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;fu(s,s,u,Ka(1,0)*Li*p);const m=Al(new Float64Array(16));return Mc(m,e.pixelMatrix,e.globeMatrix),jo(s,s,m),new Qe(s[0],s[1])}pixelsPerMeter(e,n){return Ka(1,0)*n}pixelSpaceConversion(e,n,s){const u=Ka(1,e)*n,p=wn(Ka(1,45)*n,u,s);return this.pixelsPerMeter(e,n)/p}createTileMatrix(e,n,s){const u=Hh(Yl(s.canonical));return Mc(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,n){const{center:s}=e,u=Zd(Yl(n));return Ip(u,u,Ce(s.lng)),vd(u,u,Ce(s.lat)),pu(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,n,s,u){return ag(e,n,s,!0)||new Sl(0,0)}pointCoordinate3D(e,n,s){const u=this.pointCoordinate(e,n,s,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,n){return!ag(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(u,p){const m=u.cameraToCenterDistance,v=u._centerAltitude*p,E=u._camera,C=u._camera.forward(),R=Dc([],Qa([],C,-m),[0,0,v]),N=u.worldSize/(2*Math.PI),H=[0,0,-N],K=u.width/u.height,J=Math.tan(u.fovAboveCenter),se=Qa([],E.up(),J),De=Qa([],E.right(),J*K),We=_a([],Dc([],Dc([],C,se),De)),gt=[];let Ze;if(new Op(R,We).closestPointOnSphere(H,N,gt)){const at=Dc([],gt,H),Ct=Il([],at,R);Ze=Math.cos(u.fovAboveCenter)*yh(Ct)}else{const at=Il([],R,H),Ct=Il([],H,R);_a(Ct,Ct);const mt=yh(at)-N;Ze=Math.sqrt(mt*(mt+2*N));const an=Math.acos(Ze/(N+mt))-Math.acos(Ja(C,Ct));Ze*=Math.cos(an)}return 1.01*Ze}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=Cu(e.zoom);if(s>0){const u=Kl(e,Ka(1,e.center.lat)*e.worldSize),p=e.worldSize/(2*Math.PI),m=Math.max(e.width,e.height)/e.worldSize*Math.PI;return wn(n,u+p*(1-Math.cos(m)),Math.pow(s,10))}return n}upVector(e,n,s){return ed(n,s,e,1)}upVectorScale(e){return{metersToTile:$d*jh(Yl(e))}}}function Zh(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new W_(t);case"equirectangular":return new Z_(t);case"naturalEarth":return new iv(t);case"equalEarth":return new $_(t);case"winkelTripel":return new gg(t);case"albers":return n?new _f(t):new nv(t);case"lambertConformalConic":return n?new _f(t):new Gh(t);case"globe":return new _g(t)}throw new Error(`Invalid projection name: ${t.name}`)}const Bc=Gu.types,Wh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Mu(t,e,n,s,u,p,m,v,E,C,R,N,H){const K=v?Math.min(kc,Math.round(v[0])):0,J=v?Math.min(kc,Math.round(v[1])):0;t.emplaceBack(e,n,Math.round(32*s),Math.round(32*u),p,m,(K<<1)+(E?1:0),J,16*C,16*R,256*N,256*H)}function Qc(t,e,n,s,u,p,m){t.emplaceBack(e,n,s,u,p,m)}function qh(t,e,n,s,u){t.emplaceBack(e,n,s,u),t.emplaceBack(e,n,s,u),t.emplaceBack(e,n,s,u),t.emplaceBack(e,n,s,u)}function yf(t){for(const e of t.sections)if(Pe(e.text))return!0;return!1}class Yh{constructor(e){this.layoutVertexArray=new Gr,this.indexArray=new Ps,this.programConfigurations=e,this.segments=new ps,this.dynamicLayoutVertexArray=new na,this.opacityVertexArray=new Vo,this.placedSymbolArray=new jf,this.globeExtVertexArray=new wr}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,n,s,u){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,S_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Lm.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Wh,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Xy.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}pi(Yh,"SymbolBuffers");class vf{constructor(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new ps,this.collisionVertexArray=new wc,this.collisionVertexArrayExt=new El}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Bm.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,yu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}pi(vf,"CollisionBuffers");class Jc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(m=>m.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Al([]),this.placementViewportMatrix=Al([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zm(this.zoom,n["text-size"]),this.iconSizeData=zm(this.zoom,n["icon-size"]);const s=this.layers[0].layout,u=s.get("symbol-sort-key"),p=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==p&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===p||"auto"===p&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(m=>za[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Yh(new cu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Yh(new cu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new $f,this.lineVertexArray=new pp,this.symbolInstances=new Gf}calculateGlyphDependencies(e,n,s,u,p){for(let m=0;m<e.length;m++)if(n[e.charCodeAt(m)]=!0,u&&p){const v=Rh[e.charAt(m)];v&&(n[v.charCodeAt(0)]=!0)}}populate(e,n,s,u){const p=this.layers[0],m=p.layout,v="globe"===this.projection.name,E=m.get("text-font"),C=m.get("text-field"),R=m.get("icon-image"),N=("constant"!==C.value.kind||C.value.value instanceof Qr&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),H="constant"!==R.value.kind||!!R.value.value||Object.keys(R.parameters).length>0,K=m.get("symbol-sort-key");if(this.features=[],!N&&!H)return;const J=n.iconDependencies,se=n.glyphDependencies,De=n.availableImages,We=new $t(this.zoom);for(const{feature:gt,id:Ze,index:at,sourceLayerIndex:Ct}of e){const mt=p._featureFilter.needGeometry,an=Cc(gt,mt);if(!p._featureFilter.filter(We,an,s))continue;if(mt||(an.geometry=sc(gt,s,u)),v&&1!==gt.type&&s.z<=5){const gn=an.geometry,Bn=.98078528056,Vn=($n,Kn)=>Ja(ed($n.x,$n.y,s,1),ed(Kn.x,Kn.y,s,1))<Bn;for(let $n=0;$n<gn.length;$n++)gn[$n]=Qg(gn[$n],Vn)}let en,An;if(N){const gn=p.getValueAndResolveTokens("text-field",an,s,De),Bn=Qr.factory(gn);yf(Bn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Ut()||this.hasRTLText&&rn.isParsed())&&(en=Um(Bn,p,an))}if(H){const gn=p.getValueAndResolveTokens("icon-image",an,s,De);An=gn instanceof mo?gn:mo.fromString(gn)}if(!en&&!An)continue;const Yn=this.sortFeaturesByKey?K.evaluate(an,{},s):void 0;if(this.features.push({id:Ze,text:en,icon:An,index:at,sourceLayerIndex:Ct,geometry:an.geometry,properties:gt.properties,type:Bc[gt.type],sortKey:Yn}),An&&(J[An.name]=!0),en){const gn=E.evaluate(an,{},s).join(","),Bn="map"===m.get("text-rotation-alignment")&&"point"!==m.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(za.vertical)>=0;for(const Vn of en.sections)if(Vn.image)J[Vn.image.name]=!0;else{const $n=D(en.toString()),Kn=Vn.fontStack||gn,yn=se[Kn]=se[Kn]||{};this.calculateGlyphDependencies(Vn.text,yn,Bn,this.allowVerticalPlacement,$n)}}}"line"===m.get("symbol-placement")&&(this.features=function(gt){const Ze={},at={},Ct=[];let mt=0;function an(gn){Ct.push(gt[gn]),mt++}function en(gn,Bn,Vn){const $n=at[gn];return delete at[gn],at[Bn]=$n,Ct[$n].geometry[0].pop(),Ct[$n].geometry[0]=Ct[$n].geometry[0].concat(Vn[0]),$n}function An(gn,Bn,Vn){const $n=Ze[Bn];return delete Ze[Bn],Ze[gn]=$n,Ct[$n].geometry[0].shift(),Ct[$n].geometry[0]=Vn[0].concat(Ct[$n].geometry[0]),$n}function Yn(gn,Bn,Vn){const $n=Vn?Bn[0][Bn[0].length-1]:Bn[0][0];return`${gn}:${$n.x}:${$n.y}`}for(let gn=0;gn<gt.length;gn++){const Bn=gt[gn],Vn=Bn.geometry,$n=Bn.text?Bn.text.toString():null;if(!$n){an(gn);continue}const Kn=Yn($n,Vn),yn=Yn($n,Vn,!0);if(Kn in at&&yn in Ze&&at[Kn]!==Ze[yn]){const oi=An(Kn,yn,Vn),Fi=en(Kn,yn,Ct[oi].geometry);delete Ze[Kn],delete at[yn],at[Yn($n,Ct[Fi].geometry,!0)]=Fi,Ct[oi].geometry=null}else Kn in at?en(Kn,yn,Vn):yn in Ze?An(Kn,yn,Vn):(an(gn),Ze[Kn]=mt-1,at[yn]=mt-1)}return Ct.filter(gn=>gn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((gt,Ze)=>gt.sortKey-Ze.sortKey)}update(e,n,s,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,s,u),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,s,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Zh(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:p}of n)this.lineVertexArray.emplaceBack(u,p);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,n,s,u,p,m,v,E,C,R,N,H,K,J){const se=e.indexArray,De=e.layoutVertexArray,We=e.globeExtVertexArray,gt=e.segments.prepareSegment(4*n.length,De,se,this.canOverlap?m.sortKey:void 0),Ze=this.glyphOffsetArray.length,at=gt.vertexLength,Ct=this.allowVerticalPlacement&&v===za.vertical?Math.PI/2:0,mt=m.text&&m.text.sections;for(let en=0;en<n.length;en++){const{tl:An,tr:Yn,bl:gn,br:Bn,tex:Vn,pixelOffsetTL:$n,pixelOffsetBR:Kn,minFontScaleX:yn,minFontScaleY:oi,glyphOffset:Fi,isSDF:ui,sectionIndex:ai}=n[en],si=gt.vertexLength,zi=Fi[1];if(Mu(De,C.x,C.y,An.x,zi+An.y,Vn.x,Vn.y,s,ui,$n.x,$n.y,yn,oi),Mu(De,C.x,C.y,Yn.x,zi+Yn.y,Vn.x+Vn.w,Vn.y,s,ui,Kn.x,$n.y,yn,oi),Mu(De,C.x,C.y,gn.x,zi+gn.y,Vn.x,Vn.y+Vn.h,s,ui,$n.x,Kn.y,yn,oi),Mu(De,C.x,C.y,Bn.x,zi+Bn.y,Vn.x+Vn.w,Vn.y+Vn.h,s,ui,Kn.x,Kn.y,yn,oi),E){const{x:_r,y:dr,z:hr}=E.anchor,[Ui,Nr,$i]=E.up;Qc(We,_r,dr,hr,Ui,Nr,$i),Qc(We,_r,dr,hr,Ui,Nr,$i),Qc(We,_r,dr,hr,Ui,Nr,$i),Qc(We,_r,dr,hr,Ui,Nr,$i),qh(e.dynamicLayoutVertexArray,_r,dr,hr,Ct)}else qh(e.dynamicLayoutVertexArray,C.x,C.y,C.z,Ct);se.emplaceBack(si,si+1,si+2),se.emplaceBack(si+1,si+2,si+3),gt.vertexLength+=4,gt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Fi[0]),en!==n.length-1&&ai===n[en+1].sectionIndex||e.programConfigurations.populatePaintArrays(De.length,m,m.index,{},K,J,mt&&mt[ai])}const an=E?E.anchor:C;e.placedSymbolArray.emplaceBack(an.x,an.y,an.z,C.x,C.y,Ze,this.glyphOffsetArray.length-Ze,at,R,N,C.segment,s?s[0]:0,s?s[1]:0,u[0],u[1],v,0,!1,0,H,0)}_commitLayoutVertex(e,n,s,u,p,m,v){e.emplaceBack(n,s,u,p,m,Math.round(v.x),Math.round(v.y))}_addCollisionDebugVertices(e,n,s,u,p,m,v){const E=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),C=E.vertexLength,R=v.tileAnchorX,N=v.tileAnchorY;for(let K=0;K<4;K++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,u,p,m,R,N,new Qe(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,p,m,R,N,new Qe(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,u,p,m,R,N,new Qe(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,u,p,m,R,N,new Qe(e.x1,e.y2)),E.vertexLength+=4;const H=s.indexArray;H.emplaceBack(C,C+1),H.emplaceBack(C+1,C+2),H.emplaceBack(C+2,C+3),H.emplaceBack(C+3,C),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,s,u,p,m){for(let v=u;v<p;v++){const E=s.get(v),C=this.getSymbolInstanceTextSize(e,m,n,v);this._addCollisionDebugVertices(E,C,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(e,n,s,u,p,m){for(let v=u;v<p;v++){const E=s.get(v),C=this.getSymbolInstanceIconSize(e,n,m.placedIconSymbolIndex);this._addCollisionDebugVertices(E,C,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,m)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vf(po,Nm.members,Ml),this.iconCollisionBox=new vf(po,Nm.members,Ml);const s=Fd(this.iconSizeData,e),u=Fd(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(s,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(s,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(e,n,s,u){const p=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:u),m=Kp(this.textSizeData,e,p)/24;return this.tilePixelRatio*m}getSymbolInstanceIconSize(e,n,s){const u=this.icon.placedSymbolArray.get(s),p=Kp(this.iconSizeData,e,u);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(e,n,s){e.emplaceBack(n,-s,-s),e.emplaceBack(n,s,-s),e.emplaceBack(n,s,s),e.emplaceBack(n,-s,s)}_updateTextDebugCollisionBoxes(e,n,s,u,p,m){for(let v=u;v<p;v++){const E=s.get(v),C=this.getSymbolInstanceTextSize(e,m,n,v);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,E.padding)}}_updateIconDebugCollisionBoxes(e,n,s,u,p,m){for(let v=u;v<p;v++){const E=s.get(v),C=this.getSymbolInstanceIconSize(e,n,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,E.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Fd(this.iconSizeData,e),u=Fd(this.textSizeData,e);for(let p=0;p<this.symbolInstances.length;p++){const m=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(u,e,n,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,e,n,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(s,e,n,m.iconBoxStartIndex,m.iconBoxEndIndex,m.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,n,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,s,u,p,m,v,E,C){const R={};if(n<s){const{x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at,featureIndex:Ct}=e.get(n);R.textBox={x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at},R.textFeatureIndex=Ct}if(u<p){const{x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at,featureIndex:Ct}=e.get(u);R.verticalTextBox={x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at},R.verticalTextFeatureIndex=Ct}if(m<v){const{x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at,featureIndex:Ct}=e.get(m);R.iconBox={x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at},R.iconFeatureIndex=Ct}if(E<C){const{x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at,featureIndex:Ct}=e.get(E);R.verticalIconBox={x1:N,y1:H,x2:K,y2:J,padding:se,projectedAnchorX:De,projectedAnchorY:We,projectedAnchorZ:gt,tileAnchorX:Ze,tileAnchorY:at},R.verticalIconFeatureIndex=Ct}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const s=e.placedSymbolArray.get(n),u=s.vertexStartIndex+4*s.numGlyphs;for(let p=s.vertexStartIndex;p<u;p+=4)e.indexArray.emplaceBack(p,p+1,p+2),e.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const n=Math.sin(e),s=Math.cos(e),u=[],p=[],m=[];for(let v=0;v<this.symbolInstances.length;++v){m.push(v);const E=this.symbolInstances.get(v);u.push(0|Math.round(n*E.tileAnchorX+s*E.tileAnchorY)),p.push(E.featureIndex)}return m.sort((v,E)=>u[v]-u[E]||p[E]-p[v]),m}addToSortKeyRanges(e,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:v,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:C}=s;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),p>=0&&p!==u&&this.addIndicesForPlacedSymbol(this.text,p),m>=0&&m!==p&&m!==u&&this.addIndicesForPlacedSymbol(this.text,m),v>=0&&this.addIndicesForPlacedSymbol(this.text,v),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}pi(Jc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Jc.MAX_GLYPHS=65535,Jc.addDynamicAttributes=qh;const Kd=new ki({"symbol-placement":new qt(_n.layout_symbol["symbol-placement"]),"symbol-spacing":new qt(_n.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qt(_n.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new dn(_n.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qt(_n.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qt(_n.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new qt(_n.layout_symbol["icon-ignore-placement"]),"icon-optional":new qt(_n.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qt(_n.layout_symbol["icon-rotation-alignment"]),"icon-size":new dn(_n.layout_symbol["icon-size"]),"icon-text-fit":new qt(_n.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qt(_n.layout_symbol["icon-text-fit-padding"]),"icon-image":new dn(_n.layout_symbol["icon-image"]),"icon-rotate":new dn(_n.layout_symbol["icon-rotate"]),"icon-padding":new qt(_n.layout_symbol["icon-padding"]),"icon-keep-upright":new qt(_n.layout_symbol["icon-keep-upright"]),"icon-offset":new dn(_n.layout_symbol["icon-offset"]),"icon-anchor":new dn(_n.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qt(_n.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qt(_n.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qt(_n.layout_symbol["text-rotation-alignment"]),"text-field":new dn(_n.layout_symbol["text-field"]),"text-font":new dn(_n.layout_symbol["text-font"]),"text-size":new dn(_n.layout_symbol["text-size"]),"text-max-width":new dn(_n.layout_symbol["text-max-width"]),"text-line-height":new dn(_n.layout_symbol["text-line-height"]),"text-letter-spacing":new dn(_n.layout_symbol["text-letter-spacing"]),"text-justify":new dn(_n.layout_symbol["text-justify"]),"text-radial-offset":new dn(_n.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qt(_n.layout_symbol["text-variable-anchor"]),"text-anchor":new dn(_n.layout_symbol["text-anchor"]),"text-max-angle":new qt(_n.layout_symbol["text-max-angle"]),"text-writing-mode":new qt(_n.layout_symbol["text-writing-mode"]),"text-rotate":new dn(_n.layout_symbol["text-rotate"]),"text-padding":new qt(_n.layout_symbol["text-padding"]),"text-keep-upright":new qt(_n.layout_symbol["text-keep-upright"]),"text-transform":new dn(_n.layout_symbol["text-transform"]),"text-offset":new dn(_n.layout_symbol["text-offset"]),"text-allow-overlap":new qt(_n.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new qt(_n.layout_symbol["text-ignore-placement"]),"text-optional":new qt(_n.layout_symbol["text-optional"])});var xf={paint:new ki({"icon-opacity":new dn(_n.paint_symbol["icon-opacity"]),"icon-color":new dn(_n.paint_symbol["icon-color"]),"icon-halo-color":new dn(_n.paint_symbol["icon-halo-color"]),"icon-halo-width":new dn(_n.paint_symbol["icon-halo-width"]),"icon-halo-blur":new dn(_n.paint_symbol["icon-halo-blur"]),"icon-translate":new qt(_n.paint_symbol["icon-translate"]),"icon-translate-anchor":new qt(_n.paint_symbol["icon-translate-anchor"]),"text-opacity":new dn(_n.paint_symbol["text-opacity"]),"text-color":new dn(_n.paint_symbol["text-color"],{runtimeType:hi,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new dn(_n.paint_symbol["text-halo-color"]),"text-halo-width":new dn(_n.paint_symbol["text-halo-width"]),"text-halo-blur":new dn(_n.paint_symbol["text-halo-blur"]),"text-translate":new qt(_n.paint_symbol["text-translate"]),"text-translate-anchor":new qt(_n.paint_symbol["text-translate-anchor"])}),layout:Kd};class q_{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:hn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}pi(q_,"FormatSectionOverride",{omit:["defaultValue"]});class Kh extends Hl{constructor(e){super(e,xf)}recalculate(e,n){super.recalculate(e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const u=[];for(const p of s)u.indexOf(p)<0&&u.push(p);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,s,u){const p=this.layout.get(e).evaluate(n,{},s,u),m=this._unevaluatedLayout._values[e];return m.isDataDriven()||sn(m.value)||!p?p:(v=n.properties,p.replace(/{([^{}]+)}/g,(C,R)=>R in v?String(v[R]):""));var v}createBucket(e){return new Jc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of xf.paint.overridableProperties){if(!Kh.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),s=new q_(n),u=new Ot(s,n.property.specification);let p=null;p="constant"===n.value.kind||"source"===n.value.kind?new di("source",u):new Mi("composite",u,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new Un(n.property,p,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&Kh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const s=e.get("text-field"),u=xf.paint.properties[n];let p=!1;const m=v=>{for(const E of v)if(u.overrides&&u.overrides.hasOverride(E))return void(p=!0)};if("constant"===s.value.kind&&s.value.value instanceof Qr)m(s.value.value.sections);else if("source"===s.value.kind){const v=C=>{p||(C instanceof da&&Jr(C.value)===vr?m(C.value.sections):C instanceof Ls?m(C.sections):C.eachChild(v))},E=s.value;E._styleExpression&&v(E._styleExpression.expression)}return p}getProgramConfiguration(e){return new Do(this,e)}}var rv={paint:new ki({"background-color":new qt(_n.paint_background["background-color"]),"background-pattern":new qt(_n.paint_background["background-pattern"]),"background-opacity":new qt(_n.paint_background["background-opacity"])})},Y_={paint:new ki({"raster-opacity":new qt(_n.paint_raster["raster-opacity"]),"raster-hue-rotate":new qt(_n.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qt(_n.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qt(_n.paint_raster["raster-brightness-max"]),"raster-saturation":new qt(_n.paint_raster["raster-saturation"]),"raster-contrast":new qt(_n.paint_raster["raster-contrast"]),"raster-resampling":new qt(_n.paint_raster["raster-resampling"]),"raster-fade-duration":new qt(_n.paint_raster["raster-fade-duration"])})};class K_ extends Hl{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var X_={paint:new ki({"sky-type":new qt(_n.paint_sky["sky-type"]),"sky-atmosphere-sun":new qt(_n.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new qt(_n.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new qt(_n.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new qt(_n.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ei(_n.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new qt(_n.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new qt(_n.paint_sky["sky-atmosphere-color"]),"sky-opacity":new qt(_n.paint_sky["sky-opacity"])})};function Xh(t,e,n){const s=[0,0,1],u=lm([]);return Pp(u,u,n?-Ce(t)+Math.PI:Ce(t)),cm(u,u,-Ce(e)),rm(s,s,u),_a(s,s)}const bf={circle:class extends Hl{constructor(t){super(t,Wy)}createBucket(t){return new mh(t)}queryRadius(t){const e=t;return ac("circle-radius",this,e)+ac("circle-stroke-width",this,e)+gh(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,s,u,p,m,v){const E=Nu(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return bh(t,s,p,m,v,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,C)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Do(this,t)}},heatmap:class extends Hl{createBucket(t){return new dm(t)}constructor(t){super(t,u_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return ac("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,s,u,p,m,v){const E=this.paint.get("heatmap-radius").evaluate(e,n);return bh(t,s,p,m,v,!0,!0,new Qe(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Do(this,t)}},hillshade:class extends Hl{constructor(t){super(t,d_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Hl{constructor(t){super(t,x_)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Do(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Hu(t)}queryRadius(){return gh(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,s,u,p){return!t.queryGeometry.isAboveHorizon&&Jf(hu(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Hl{constructor(t){super(t,Wl)}createBucket(t){return new Od(t)}queryRadius(){return gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Do(this,t)}queryIntersectsFeature(t,e,n,s,u,p,m,v,E){const C=Nu(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(e,n),N=this.paint.get("fill-extrusion-base").evaluate(e,n),H=[0,0],K=v&&p.elevation,J=p.elevation?p.elevation.exaggeration():1,se=t.tile.getBucket(this);if(K&&se instanceof Od){const at=se.centroidVertexArray,Ct=E+1;Ct<at.length&&(H[0]=at.geta_centroid_pos0(Ct),H[1]=at.geta_centroid_pos1(Ct))}if(0===H[0]&&1===H[1])return!1;"globe"===p.projection.name&&(s=Mm([s],[new Qe(0,0),new Qe(Li,Li)],t.tileID.canonical).map(at=>at.polygon).flat());const De=K?v:null,[We,gt]=(Ct=s,mt=N,an=R,en=C,An=m,Yn=De,gn=H,Bn=J,Vn=p.center.lat,"globe"===(at=p).projection.name?function(Kn,yn,oi,Fi,ui,ai,si,zi,_r,dr,hr){const Ui=[],Nr=[],$i=Kn.projection.upVectorScale(hr,Kn.center.lat,Kn.worldSize).metersToTile,yr=[0,0,0,1],Kr=[0,0,0,1],lo=(uo,To,Ro,fs)=>{uo[0]=To,uo[1]=Ro,uo[2]=fs,uo[3]=1},co=Wp();oi>0&&(oi+=co),Fi+=co;for(const uo of yn){const To=[],Ro=[];for(const fs of uo){const Er=fs.x+ui.x,ts=fs.y+ui.y,Ko=Kn.projection.projectTilePoint(Er,ts,hr),lr=Kn.projection.upVector(hr,fs.x,fs.y);let Rr=oi,ho=Fi;if(si){const $r=Am(Er,ts,oi,Fi,si,zi,_r,dr);Rr+=$r.base,ho+=$r.top}0!==oi?lo(yr,Ko.x+lr[0]*$i*Rr,Ko.y+lr[1]*$i*Rr,Ko.z+lr[2]*$i*Rr):lo(yr,Ko.x,Ko.y,Ko.z),lo(Kr,Ko.x+lr[0]*$i*ho,Ko.y+lr[1]*$i*ho,Ko.z+lr[2]*$i*ho),jo(yr,yr,ai),jo(Kr,Kr,ai),To.push(new Zu(yr[0],yr[1],yr[2])),Ro.push(new Zu(Kr[0],Kr[1],Kr[2]))}Ui.push(To),Nr.push(Ro)}return[Ui,Nr]}(at,Ct,mt,an,en,An,Yn,gn,Bn,Vn,t.tileID.canonical):Yn?function(Kn,yn,oi,Fi,ui,ai,si,zi,_r){const dr=[],hr=[],Ui=[0,0,0,1];for(const Nr of Kn){const $i=[],yr=[];for(const Kr of Nr){const lo=Kr.x+Fi.x,co=Kr.y+Fi.y,uo=Am(lo,co,yn,oi,ai,si,zi,_r);Ui[0]=lo,Ui[1]=co,Ui[2]=uo.base,Ui[3]=1,Tc(Ui,Ui,ui),Ui[3]=Math.max(Ui[3],1e-5);const To=new Zu(Ui[0]/Ui[3],Ui[1]/Ui[3],Ui[2]/Ui[3]);Ui[0]=lo,Ui[1]=co,Ui[2]=uo.top,Ui[3]=1,Tc(Ui,Ui,ui),Ui[3]=Math.max(Ui[3],1e-5);const Ro=new Zu(Ui[0]/Ui[3],Ui[1]/Ui[3],Ui[2]/Ui[3]);$i.push(To),yr.push(Ro)}dr.push($i),hr.push(yr)}return[dr,hr]}(Ct,mt,an,en,An,Yn,gn,Bn,Vn):function(Kn,yn,oi,Fi,ui){const ai=[],si=[],zi=ui[8]*yn,_r=ui[9]*yn,dr=ui[10]*yn,hr=ui[11]*yn,Ui=ui[8]*oi,Nr=ui[9]*oi,$i=ui[10]*oi,yr=ui[11]*oi;for(const Kr of Kn){const lo=[],co=[];for(const uo of Kr){const To=uo.x+Fi.x,Ro=uo.y+Fi.y,fs=ui[0]*To+ui[4]*Ro+ui[12],Er=ui[1]*To+ui[5]*Ro+ui[13],ts=ui[2]*To+ui[6]*Ro+ui[14],Ko=ui[3]*To+ui[7]*Ro+ui[15],lr=fs+zi,Rr=Er+_r,ho=ts+dr,$r=Math.max(Ko+hr,1e-5),Lo=fs+Ui,aa=Er+Nr,Os=ts+$i,Rs=Math.max(Ko+yr,1e-5);lo.push(new Zu(lr/$r,Rr/$r,ho/$r)),co.push(new Zu(Lo/Rs,aa/Rs,Os/Rs))}ai.push(lo),si.push(co)}return[ai,si]}(Ct,mt,an,en,An)),Ze=t.queryGeometry;var at,Ct,mt,an,en,An,Yn,gn,Bn,Vn;return function(at,Ct,mt){let an=1/0;Jf(mt,Ct)&&(an=Sm(mt,Ct[0]));for(let en=0;en<Ct.length;en++){const An=Ct[en],Yn=at[en];for(let gn=0;gn<An.length-1;gn++){const Bn=An[gn],Vn=[Bn,An[gn+1],Yn[gn+1],Yn[gn],Bn];du(mt,Vn)&&(an=Math.min(an,Sm(mt,Vn)))}}return an!==1/0&&an}(We,gt,Ze.isPointQuery()?Ze.screenBounds:Ze.screenGeometry)}},line:class extends Hl{constructor(t){super(t,km),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ls,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=qp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Oh(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Do(this,t)}queryRadius(t){const e=t,n=Fm(ac("line-width",this,e),ac("line-gap-width",this,e)),s=ac("line-offset",this,e);return n/2+Math.abs(s)+gh(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,s,u,p){if(t.queryGeometry.isAboveHorizon)return!1;const m=hu(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,t.pixelToTileUnitsFactor),v=t.pixelToTileUnitsFactor/2*Fm(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),E=this.paint.get("line-offset").evaluate(e,n);return E&&(s=function(C,R){const N=[],H=new Qe(0,0);for(let K=0;K<C.length;K++){const J=C[K],se=[];for(let De=0;De<J.length;De++){const We=J[De-1],gt=J[De],Ze=J[De+1],at=0===De?H:gt.sub(We)._unit()._perp(),Ct=De===J.length-1?H:Ze.sub(gt)._unit()._perp(),mt=at._add(Ct)._unit();mt._mult(1/(mt.x*Ct.x+mt.y*Ct.y)),se.push(mt._mult(R)._add(gt))}N.push(se)}return N}(s,E*t.pixelToTileUnitsFactor)),function(C,R,N){for(let H=0;H<R.length;H++){const K=R[H];if(C.length>=3)for(let J=0;J<K.length;J++)if($c(C,K[J]))return!0;if(e_(C,K,N))return!0}return!1}(m,s,v)}isTileClipped(){return!0}},symbol:Kh,background:class extends Hl{constructor(t){super(t,rv)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Hl{constructor(t){super(t,Y_)}getProgramIds(){return["raster"]}},sky:class extends Hl{constructor(t){super(t,X_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=kp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),u=!s,p=t.style.light,m=p.properties.get("position");return u&&"viewport"===p.properties.get("anchor")&&Xe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?Xh(m.azimuthal,90-m.polar,e):Xh(s[0],90-s[1],e)}const n=this.paint.get("sky-gradient-center");return Xh(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class Xd{constructor(e,n,s,u){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,u)}update(e,n,s){const{width:u,height:p}=e,{context:m}=this,{gl:v}=m,{HTMLImageElement:E,HTMLCanvasElement:C,HTMLVideoElement:R,ImageData:N,ImageBitmap:H}=de;if(v.bindTexture(v.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!n||!1!==n.premultiply)),s||this.size&&this.size[0]===u&&this.size[1]===p){const{x:K,y:J}=s||{x:0,y:0};e instanceof E||e instanceof C||e instanceof R||e instanceof N||H&&e instanceof H?v.texSubImage2D(v.TEXTURE_2D,0,K,J,v.RGBA,v.UNSIGNED_BYTE,e):v.texSubImage2D(v.TEXTURE_2D,0,K,J,u,p,v.RGBA,v.UNSIGNED_BYTE,e.data)}else this.size=[u,p],e instanceof E||e instanceof C||e instanceof R||e instanceof N||H&&e instanceof H?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,e):v.texImage2D(v.TEXTURE_2D,0,this.format,u,p,0,this.format,v.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(e,n){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class wf{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Q_{constructor(){this.tasks={},this.taskQueue=[],Jn(["process"],this),this.invoker=new wf(this.process),this.nextId=0}add(e,n){const s=this.nextId++,u=function({type:p,isSymbolTile:m,zoom:v}){return v=v||0,"message"===p?0:"maybePrepare"!==p||m?"parseTile"!==p||m?"parseTile"===p&&m?300-v:"maybePrepare"===p&&m?400-v:500:200-v:100-v}(n);if(0===u){Se();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:n,priority:u,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){Se();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let u=0;u<this.taskQueue.length;u++){const p=this.tasks[this.taskQueue[u]];p.priority<n&&(n=p.priority,e=u)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class yg{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const J_=["tile","layer","source","sourceLayer","state"];class vg{constructor(e,n,s,u,p){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=s,this._y=u,this.properties=e.properties,this.id=p}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const n of J_)void 0!==this[n]&&(e[n]=this[n]);return e}}const Xl=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,s=0,u=0,p=0,m=0,v=0;for(1&e?u=p=m=32:n=s=v=32;(e>>=1)>1;){const C=n+u>>1,R=s+p>>1;1&e?(u=n,p=s,n=m,s=v):(n=u,s=p,u=m,p=v),m=C,v=R}const E=4*t;Xl[E+0]=n,Xl[E+1]=s,Xl[E+2]=u,Xl[E+3]=p}const xa=new Uint16Array(2178),Du=new Uint8Array(1089),eu=new Uint16Array(1089);function xg(t){return 0===t?-.03125:32===t?.03125:0}var bg=gi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Qh={type:2,extent:Li,loadGeometry:()=>[[new Qe(0,0),new Qe(8193,0),new Qe(8193,8193),new Qe(0,8193),new Qe(0,0)]]};class Ef{constructor(e,n,s,u,p){this.tileID=e,this.uid=vi(),this.uses=0,this.tileSize=n,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<Gn.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Fc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const m={};if(!p)return m;for(const v of u){const E=v.layerIds.map(C=>p.getLayer(C)).filter(Boolean);if(0!==E.length){v.layers=E,v.stateDependentLayerIds&&(v.stateDependentLayers=v.stateDependentLayerIds.map(C=>E.filter(R=>R.id===C)[0]));for(const C of E)m[C.id]=v}}return m}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Jc){if(this.hasSymbolBuckets=!0,!s)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof Jc&&p.hasRTLText){this.hasRTLText=!0,rn.isLoading()||rn.isLoaded()||"deferred"!==Ut()||ln();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new hp}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const u=this.buckets[s];u.uploadPending()&&u.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xd(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xd(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Xd(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,s,u,p,m,v,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:v,transform:m,params:p,tileTransform:this.tileTransform},e,n,s):{}}querySourceFeatures(e,n){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const u=s.loadVTLayers(),p=n?n.sourceLayer:"",m=u._geojsonTileLayer||u[p];if(!m)return;const v=es(n&&n.filter),{z:E,x:C,y:R}=this.tileID.canonical,N={z:E,x:C,y:R};for(let H=0;H<m.length;H++){const K=m.feature(H);if(v.needGeometry){const De=Cc(K,!0);if(!v.filter(new $t(this.tileID.overscaledZ),De,this.tileID.canonical))continue}else if(!v.filter(new $t(this.tileID.overscaledZ),K))continue;const J=s.getId(K,p),se=new vg(K,E,C,R,J);se.tile=N,e.push(se)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const s=St(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let u=!1;if(this.expirationTime>s)u=!1;else if(n)if(this.expirationTime<n)u=!0;else{const p=this.expirationTime-n;p?this.expirationTime=s+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!n)return;const s=this.latestFeatureIndex.loadVTLayers(),u=n.style.listImages();for(const p in this.buckets){if(!n.style.hasLayer(p))continue;const m=this.buckets[p],v=m.layers[0].sourceLayer||"_geojsonTileLayer",E=s[v],C=e[v];if(!E||!C||0===Object.keys(C).length)continue;if(m.update(C,E,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),m instanceof Oh||m instanceof Hu){const N=n.style._getSourceCache(m.layers[0].source);n._terrain&&n._terrain.enabled&&N&&m.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(N.id,this.tileID)}const R=n&&n.style&&n.style.getLayer(p);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(m)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Gn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Gn.now()+e}setTexture(e,n){const s=n.context,u=s.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Xd(s,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),s.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax))}setDependencies(e,n){const s={};for(const u of n)s[u]=!0;this.dependencies[e]=s}hasDependency(e,n){for(const s of e){const u=this.dependencies[s];if(u)for(const p of n)if(u[p])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||"mercator"===n.name||this._tileDebugBuffer)return;const s=sc(Qh,this.tileID.canonical,this.tileTransform)[0],u=new Pr,p=new pd;for(let m=0;m<s.length;m++){const{x:v,y:E}=s[m];u.emplaceBack(v,E),p.emplaceBack(m)}p.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(p),this._tileDebugBuffer=e.createVertexBuffer(u,Qu.members),this._tileDebugSegments=ps.simpleSegment(0,0,u.length,p.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||"mercator"===n.name)return;const s=sc(Qh,this.tileID.canonical,this.tileTransform)[0];let u,p;if(this.isRaster){const m=function(v,E){const C=Fc(v,E),R=Math.pow(2,v.z);for(let De=0;De<33;De++)for(let We=0;We<33;We++){const gt=Tl((v.x+(We+xg(We))/32)/R),Ze=Ws((v.y+(De+xg(De))/32)/R),at=E.project(gt,Ze),Ct=33*De+We;xa[2*Ct+0]=Math.round((at.x*C.scale-C.x)*Li),xa[2*Ct+1]=Math.round((at.y*C.scale-C.y)*Li)}Du.fill(0),eu.fill(0);for(let De=2045;De>=0;De--){const We=4*De,gt=Xl[We+0],Ze=Xl[We+1],at=Xl[We+2],Ct=Xl[We+3],mt=gt+at>>1,an=Ze+Ct>>1,en=mt+an-Ze,An=an+gt-mt,Yn=33*Ze+gt,gn=33*Ct+at,Bn=33*an+mt,Vn=Math.hypot((xa[2*Yn+0]+xa[2*gn+0])/2-xa[2*Bn+0],(xa[2*Yn+1]+xa[2*gn+1])/2-xa[2*Bn+1])>=16;if(Du[Bn]=Du[Bn]||(Vn?1:0),De<1022){const $n=33*(Ze+An>>1)+(gt+en>>1),Kn=33*(Ct+An>>1)+(at+en>>1);Du[Bn]=Du[Bn]||Du[$n]||Du[Kn]}}const N=new Hr,H=new Ps;let K=0;function J(De,We){const gt=33*We+De;return 0===eu[gt]&&(N.emplaceBack(xa[2*gt+0],xa[2*gt+1],De*Li/32,We*Li/32),eu[gt]=++K),eu[gt]-1}function se(De,We,gt,Ze,at,Ct){const mt=De+gt>>1,an=We+Ze>>1;if(Math.abs(De-at)+Math.abs(We-Ct)>1&&Du[33*an+mt])se(at,Ct,De,We,mt,an),se(gt,Ze,at,Ct,mt,an);else{const en=J(De,We),An=J(gt,Ze),Yn=J(at,Ct);H.emplaceBack(en,An,Yn)}}return se(0,0,32,32,32,0),se(32,32,0,0,0,32),{vertices:N,indices:H}}(this.tileID.canonical,n);u=m.vertices,p=m.indices}else{u=new Hr,p=new Ps;for(const{x:v,y:E}of s)u.emplaceBack(v,E,0,0);const m=lc.exports(u.int16,void 0,4);for(let v=0;v<m.length;v+=3)p.emplaceBack(m[v],m[v+1],m[v+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,bg.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(p),this._tileBoundsSegments=ps.simpleSegment(0,0,u.length,p.length)}_makeGlobeTileDebugBuffers(e,n){const s=n.projection;if(!s||"globe"!==s.name||n.freezeTileCoverage)return;const u=this.tileID.canonical,p=Zd(cg(u,n)),m=Cu(n.zoom);let v;m>0&&(v=Ap(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,n,p,v,m),this._makeGlobeTileDebugTextBuffer(e,u,n,p,v,m)}_globePoint(e,n,s,u,p,m,v){let E=ed(e,n,s);if(m){const C=1<<s.z,R=Gl(u.center.lng),N=$l(u.center.lat),H=(s.x+.5)/C-R;let K=0;H>.5?K=-1:H<-.5&&(K=1);let J=(e/Li+s.x)/C+K,se=(n/Li+s.y)/C;J=(J-R)*u._pixelsPerMercatorPixel+R,se=(se-N)*u._pixelsPerMercatorPixel+N;const De=[J*u.worldSize,se*u.worldSize,0];jo(De,De,m),E=Kc(E,De,v)}return jo(E,E,p)}_makeGlobeTileDebugBorderBuffer(e,n,s,u,p,m){const v=new Pr,E=new pd,C=new so,R=(H,K,J,se,De)=>{const We=(J-H)/(De-1),gt=(se-K)/(De-1),Ze=v.length;for(let at=0;at<De;at++){const Ct=H+at*We,mt=K+at*gt;v.emplaceBack(Ct,mt);const an=this._globePoint(Ct,mt,n,s,u,p,m);C.emplaceBack(an[0],an[1],an[2]),E.emplaceBack(Ze+at)}},N=Li;R(0,0,N,0,16),R(N,0,N,N,16),R(N,N,0,N,16),R(0,N,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(v,Qu.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(C,Gd.members),this._tileDebugSegments=ps.simpleSegment(0,0,v.length,E.length)}_makeGlobeTileDebugTextBuffer(e,n,s,u,p,m){const v=new Pr,E=new Ps,C=new so,R=25;E.reserve(32),v.reserve(R),C.reserve(R);const N=(H,K)=>R*H+K;for(let H=0;H<R;H++){const K=2048*H;for(let J=0;J<R;J++){const se=2048*J;v.emplaceBack(se,K);const De=this._globePoint(se,K,n,s,u,p,m);C.emplaceBack(De[0],De[1],De[2])}}for(let H=0;H<4;H++)for(let K=0;K<4;K++){const J=N(H,K),se=N(H,K+1),De=N(H+1,K),We=N(H+1,K+1);E.emplaceBack(J,se,De),E.emplaceBack(De,se,We)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(E),this._tileDebugTextBuffer=e.createVertexBuffer(v,Qu.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(C,Gd.members),this._tileDebugTextSegments=ps.simpleSegment(0,0,R,32)}}class gc{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,s){const u=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Xt(this.stateChanges[e][u],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const p in this.state[e][u])s[p]||(this.deletedStates[e][u][p]=null)}else for(const p in s)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][p]&&delete this.deletedStates[e][u][p]}removeFeatureState(e,n,s){if(null===this.deletedStates[e])return;const u=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==n)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][s]=null);else if(void 0!==n)if(this.stateChanges[e]&&this.stateChanges[e][u])for(s in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][s]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,n){const s=String(n),u=Xt({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const p=this.deletedStates[e][n];if(null===p)return{};for(const m in p)delete u[m]}return u}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const s={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Xt(this.state[u][m],this.stateChanges[u][m]),p[m]=this.state[u][m];s[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(null===this.deletedStates[u])for(const m in this.state[u])p[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(null===this.deletedStates[u][m])this.state[u][m]={};else for(const v of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][v];p[m]=this.state[u][m]}s[u]=s[u]||{},Xt(s[u],p)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const u in e)e[u].setFeatureState(s,n)}}class rd{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const s=this.toIdx(e,n);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function sa(t,e,n,s){let u=0,p=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(s[m])<1e-15){if(n[m]<t[m]||n[m]>e[m])return null}else{const v=1/s[m];let E=(t[m]-n[m])*v,C=(e[m]-n[m])*v;if(E>C){const R=E;E=C,C=R}if(E>u&&(u=E),C<p&&(p=C),u>p)return null}return u}function tu(t,e,n,s,u,p,m,v,E,C,R){const N=s-t,H=u-e,K=p-n,J=m-t,se=v-e,De=E-n,We=R[1]*De-R[2]*se,gt=R[2]*J-R[0]*De,Ze=R[0]*se-R[1]*J,at=N*We+H*gt+K*Ze;if(Math.abs(at)<1e-15)return null;const Ct=1/at,mt=C[0]-t,an=C[1]-e,en=C[2]-n,An=(mt*We+an*gt+en*Ze)*Ct;if(An<0||An>1)return null;const Yn=an*K-en*H,gn=en*N-mt*K,Bn=mt*H-an*N,Vn=(R[0]*Yn+R[1]*gn+R[2]*Bn)*Ct;return Vn<0||An+Vn>1?null:(J*Yn+se*gn+De*Bn)*Ct}function Qd(t,e,n){return(t-e)/(n-e)}function dl(t,e,n,s,u,p,m,v,E){const C=1<<n,R=p-s,N=m-u,H=(t+1)/C*R+s,K=(e+0)/C*N+u,J=(e+1)/C*N+u;v[0]=(t+0)/C*R+s,v[1]=K,E[0]=H,E[1]=J}class Jh{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(p){const m=Math.ceil(Math.log2(p.dim/8)),v=[];let E=Math.ceil(Math.pow(2,m));const C=1/E,R=(K,J,se,De,We)=>{const gt=De?1:0,Ze=(K+1)*se-gt,at=J*se,Ct=(J+1)*se-gt;We[0]=K*se,We[1]=at,We[2]=Ze,We[3]=Ct};let N=new rd(E);const H=[];for(let K=0;K<E*E;K++){R(K%E,Math.floor(K/E),C,!1,H);const J=hl(H[0],H[1],p),se=hl(H[2],H[1],p),De=hl(H[2],H[3],p),We=hl(H[0],H[3],p);N.minimums.push(Math.min(J,se,De,We)),N.maximums.push(Math.max(J,se,De,We)),N.leaves.push(1)}for(v.push(N),E/=2;E>=1;E/=2){const K=v[v.length-1];N=new rd(E);for(let J=0;J<E*E;J++){R(J%E,Math.floor(J/E),2,!0,H);const se=K.getElevation(H[0],H[1]),De=K.getElevation(H[2],H[1]),We=K.getElevation(H[2],H[3]),gt=K.getElevation(H[0],H[3]),Ze=K.isLeaf(H[0],H[1]),at=K.isLeaf(H[2],H[1]),Ct=K.isLeaf(H[2],H[3]),mt=K.isLeaf(H[0],H[3]),an=Math.min(se.min,De.min,We.min,gt.min),en=Math.max(se.max,De.max,We.max,gt.max),An=Ze&&at&&Ct&&mt;N.maximums.push(en),N.minimums.push(an),N.leaves.push(en-an<=5&&An?1:0)}v.push(N)}return v}(this.dem),s=n.length-1,u=n[s];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(n,0,0,s,0)}raycastRoot(e,n,s,u,p,m,v=1){return sa([e,n,-100],[s,u,this.maximums[0]*v],p,m)}raycast(e,n,s,u,p,m,v=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,n,s,u,p,m,v);if(null==E)return null;const C=[],R=[],N=[],H=[],K=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:J,t:se,nodex:De,nodey:We,depth:gt}=K.pop();if(this.leaves[J]){dl(De,We,gt,e,n,s,u,N,H);const at=1<<gt,Ct=(De+0)/at,mt=(De+1)/at,an=(We+0)/at,en=(We+1)/at,An=hl(Ct,an,this.dem)*v,Yn=hl(mt,an,this.dem)*v,gn=hl(mt,en,this.dem)*v,Bn=hl(Ct,en,this.dem)*v,Vn=tu(N[0],N[1],An,H[0],N[1],Yn,H[0],H[1],gn,p,m),$n=tu(H[0],H[1],gn,N[0],H[1],Bn,N[0],N[1],An,p,m),Kn=Math.min(null!==Vn?Vn:Number.MAX_VALUE,null!==$n?$n:Number.MAX_VALUE);if(Kn!==Number.MAX_VALUE)return Kn;{const yn=fu([],p,m,se);if(Tu(An,Yn,Bn,gn,Qd(yn[0],N[0],H[0]),Qd(yn[1],N[1],H[1]))>=yn[2])return se}continue}let Ze=0;for(let at=0;at<this._siblingOffset.length;at++){dl((De<<1)+this._siblingOffset[at][0],(We<<1)+this._siblingOffset[at][1],gt+1,e,n,s,u,N,H),N[2]=-100,H[2]=this.maximums[this.childOffsets[J]+at]*v;const Ct=sa(N,H,p,m);if(null!=Ct){const mt=Ct;C[at]=mt;let an=!1;for(let en=0;en<Ze&&!an;en++)mt>=C[R[en]]&&(R.splice(en,0,at),an=!0);an||(R[Ze]=at),Ze++}}for(let at=0;at<Ze;at++){const Ct=R[at];K.push({idx:this.childOffsets[J]+Ct,t:C[Ct],nodex:(De<<1)+this._siblingOffset[Ct][0],nodey:(We<<1)+this._siblingOffset[Ct][1],depth:gt+1})}}return null}_addNode(e,n,s){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,s,u,p){if(1===e[u].isLeaf(n,s))return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const m=u-1,v=e[m];let E=0,C=0;for(let R=0;R<this._siblingOffset.length;R++){const N=2*n+this._siblingOffset[R][0],H=2*s+this._siblingOffset[R][1],K=v.getElevation(N,H),J=v.isLeaf(N,H),se=this._addNode(K.min,K.max,J);J&&(E|=1<<R),C||(C=se)}for(let R=0;R<this._siblingOffset.length;R++)E&1<<R||this._construct(e,2*n+this._siblingOffset[R][0],2*s+this._siblingOffset[R][1],m,C+R)}}function Tu(t,e,n,s,u,p){return wn(wn(t,n,p),wn(e,s,p),u)}function hl(t,e,n){const s=n.dim,u=Ke(t*s-.5,0,s-1),p=Ke(e*s-.5,0,s-1),m=Math.floor(u),v=Math.floor(p),E=Math.min(m+1,s-1),C=Math.min(v+1,s-1);return Tu(n.get(m,v),n.get(E,v),n.get(m,C),n.get(E,C),u-m,p-v)}const Su={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Nc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,s,u=!1,p=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return Xe(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const m=this.dim=n.height-2,v=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=s||"mapbox",this.borderReady=u,!u){for(let E=0;E<m;E++)v[this._idx(-1,E)]=v[this._idx(0,E)],v[this._idx(m,E)]=v[this._idx(m-1,E)],v[this._idx(E,-1)]=v[this._idx(E,0)],v[this._idx(E,m)]=v[this._idx(E,m-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(m,-1)]=v[this._idx(m-1,0)],v[this._idx(-1,m)]=v[this._idx(0,m-1)],v[this._idx(m,m)]=v[this._idx(m-1,m-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Jh(this)}get(e,n,s=!1){s&&(e=Ke(e,-1,this.dim),n=Ke(n,-1,this.dim));const u=4*this._idx(e,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return Su[e]}get unpackVector(){return Su[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,s){return(256*e*256+256*n+s)/10-1e4}_unpackTerrarium(e,n,s){return 256*e+n+s/256-32768}static pack(e,n){const s=[0,0,0,0],u=Nc.getUnpackVector(n);let p=Math.floor((e+u[3])/u[2]);return s[2]=p%256,p=Math.floor(p/256),s[1]=p%256,p=Math.floor(p/256),s[0]=p,s}getPixels(){return new Na({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=n*this.dim,p=n*this.dim+this.dim,m=s*this.dim,v=s*this.dim+this.dim;switch(n){case-1:u=p-1;break;case 1:p=u+1}switch(s){case-1:m=v-1;break;case 1:v=m+1}const E=-n*this.dim,C=-s*this.dim;for(let R=m;R<v;R++)for(let N=u;N<p;N++){const H=4*this._idx(N,R),K=4*this._idx(N+E,R+C);this.pixels[H+0]=e.pixels[K+0],this.pixels[H+1]=e.pixels[K+1],this.pixels[H+2]=e.pixels[K+2],this.pixels[H+3]=e.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}pi(Nc,"DEMData"),pi(Jh,"DemMinMaxQuadTree",{omit:["dem"]});class od{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,s){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const p={value:n,timeout:void 0};if(void 0!==s&&(p.timeout=setTimeout(()=>{this.remove(e,p)},s)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const s=e.wrapped().key,u=void 0===n?0:this.data[s].indexOf(n),p=this.data[s][u];return this.data[s].splice(u,1),p.timeout&&clearTimeout(p.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(p.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const s in this.data)for(const u of this.data[s])e(u.value)||n.push(u);for(const s of n)this.remove(s.value.tileID,s)}}class Ql{constructor(e,n,s){this.func=e,this.mask=n,this.range=s}}Ql.ReadOnly=!1,Ql.ReadWrite=!0,Ql.disabled=new Ql(519,Ql.ReadOnly,[0,1]);class iu{constructor(e,n,s,u,p,m){this.test=e,this.ref=n,this.mask=s,this.fail=u,this.depthFail=p,this.pass=m}}iu.disabled=new iu({func:519,mask:0},0,0,7680,7680,7680);class Ua{constructor(e,n,s){this.blendFunction=e,this.blendColor=n,this.mask=s}}Ua.Replace=[1,0],Ua.disabled=new Ua(Ua.Replace,kr.transparent,[!1,!1,!1,!1]),Ua.unblended=new Ua(Ua.Replace,kr.transparent,[!0,!0,!0,!0]),Ua.alphaBlended=new Ua([1,771],kr.transparent,[!0,!0,!0,!0]);class kl{constructor(e,n,s){this.enable=e,this.mode=n,this.frontFace=s}}kl.disabled=new kl(!1,1029,2305),kl.backCCW=new kl(!0,1029,2305),kl.backCW=new kl(!0,1029,2304),kl.frontCW=new kl(!0,1028,2304),kl.frontCCW=new kl(!0,1028,2305);class ru extends Cr{constructor(e,n,s){super(),this.id=e,this._onlySymbols=s,n.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new od(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new gc,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const s=this._tiles[n];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return Dn(this._tiles).map(e=>e.tileID).sort(Cf).map(e=>e.key)}getRenderableIds(e){const n=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&n.push(this._tiles[s]);return e?n.sort((s,u)=>{const p=s.tileID,m=u.tileID,v=new Qe(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),E=new Qe(m.canonical.x,m.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-m.overscaledZ||E.y-v.y||E.x-v.x}).map(s=>s.tileID.key):n.map(s=>s.tileID).sort(Cf).map(s=>s.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=n),this._loadTile(s,this._tileLoaded.bind(this,s,e,n)))}_tileLoaded(e,n,s,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new Xr(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Gn.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new fo("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let u=0;u<n.length;u++){const p=n[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const m=this.getTileByID(p);s(e,m),s(m,e)}}function s(u,p){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=p.tileID.canonical.x-u.tileID.canonical.x;const v=p.tileID.canonical.y-u.tileID.canonical.y,E=Math.pow(2,u.tileID.canonical.z),C=p.tileID.key;0===m&&0===v||Math.abs(v)>1||(Math.abs(m)>1&&(1===Math.abs(m+E)?m+=E:1===Math.abs(m-E)&&(m-=E)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,m,v),u.neighboringTiles&&u.neighboringTiles[C]&&(u.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,s,u){for(const p in this._tiles){let m=this._tiles[p];if(u[p]||!m.hasData()||m.tileID.overscaledZ<=n||m.tileID.overscaledZ>s)continue;let v=m.tileID;for(;m&&m.tileID.overscaledZ>n+1;){const C=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[C.key],m&&m.hasData()&&(v=C)}let E=v;for(;E.overscaledZ>n;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){u[v.key]=v;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=n?s:null}for(let s=e.overscaledZ-1;s>=n;s--){const u=e.scaledTo(s),p=this._getLoadedTile(u);if(p)return p}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const s=Math.ceil(e.width/n)+1,u=Math.ceil(e.height/n)+1,p=Math.floor(s*u*5),m="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,p):p,v="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(e){const n=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,n){const s={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+n),s[p.tileID.key]=p}this._tiles=s;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,n,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let u;this.updateCacheSize(e,n),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new va(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(u=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(v=>this._source.hasTile(v)))):u=[];const p=this._updateRetainedTiles(u);if(Mf(this._source.type)&&0!==u.length){const v={},E={},C=Object.keys(p);for(const N of C){const H=p[N],K=this._tiles[N];if(!K||K.fadeEndTime&&K.fadeEndTime<=Gn.now())continue;const J=this.findLoadedParent(H,Math.max(H.overscaledZ-ru.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),v[J.tileID.key]=J.tileID),E[N]=H}const R=u[u.length-1].overscaledZ;for(const N in this._tiles){const H=this._tiles[N];if(p[N]||!H.hasData())continue;let K=H.tileID;for(;K.overscaledZ>R;){K=K.scaledTo(K.overscaledZ-1);const J=this._tiles[K.key];if(J&&J.hasData()&&E[K.key]){p[N]=H.tileID;break}}}for(const N in v)p[N]||(this._coveredTiles[N]=!0,p[N]=v[N])}for(const v in p)this._tiles[v].clearFadeHold();const m=function(v,E){const C=[];for(const R in v)R in E||C.push(R);return C}(this._tiles,p);for(const v of m){const E=this._tiles[v];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(0===e.length)return n;const s={},u=e.reduce((C,R)=>Math.min(C,R.overscaledZ),1/0),p=e[0].overscaledZ,m=Math.max(p-ru.maxOverzooming,this._source.minzoom),v=Math.max(p+ru.maxUnderzooming,this._source.minzoom),E={};for(const C of e){const R=this._addTile(C);n[C.key]=C,R.hasData()||u<this._source.maxzoom&&(E[C.key]=C)}this._retainLoadedChildren(E,u,v,n);for(const C of e){let R=this._tiles[C.key];if(R.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const H=C.children(this._source.maxzoom)[0],K=this.getTile(H);if(K&&K.hasData()){n[H.key]=H;continue}}else{const H=C.children(this._source.maxzoom);if(n[H[0].key]&&n[H[1].key]&&n[H[2].key]&&n[H[3].key])continue}let N=R.wasRequested();for(let H=C.overscaledZ-1;H>=m;--H){const K=C.scaledTo(H);if(s[K.key]||(s[K.key]=!0,R=this.getTile(K),!R&&N&&(R=this._addTile(K)),R&&(n[K.key]=K,N=R.wasRequested(),R.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let s,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){s=this._loadedParentTiles[u.key];break}n.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(s=this._getLoadedTile(p),s)break;u=p}for(const p of n)this._loadedParentTiles[p]=s}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const s=Boolean(n);if(!s){const u=this.map?this.map.painter:null;n=new Ef(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,s||this._source.fire(new fo("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=n.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&"reloading"!==n.state?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,s){const u=[],p=this.transform;if(!p)return u;const m="globe"===p.projection.name,v=Gl(p.center.lng);for(const E in this._tiles){const C=this._tiles[E];if(s&&C.clearQueryDebugViz(),C.holdingForFade())continue;let R;if(m){const N=C.tileID.canonical;if(0===N.z){const H=[Math.abs(Ke(v,...sd(N,-1))-v),Math.abs(Ke(v,...sd(N,1))-v)];R=[0,2*H.indexOf(Math.min(...H))-1]}else{const H=[Math.abs(Ke(v,...sd(N,-1))-v),Math.abs(Ke(v,...sd(N,0))-v),Math.abs(Ke(v,...sd(N,1))-v)];R=[H.indexOf(Math.min(...H))-1]}}else R=[0];for(const N of R){const H=e.containsTile(C,p,n,N);H&&u.push(H)}}return u}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of n)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Mf(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=Gn.now())return!0}return!1}setFeatureState(e,n,s){this._state.updateState(e=e||"_geojsonTileLayer",n,s)}removeFeatureState(e,n,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,s)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,s){const u=this._tiles[e];u&&u.setDependencies(n,s)}reloadTilesForDependencies(e,n){for(const s in this._tiles)this._tiles[s].hasDependency(e,n)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,n))}_preloadTiles(e,n){const s=new Map,u=Array.isArray(e)?e:[e],p=this.map.painter.terrain,m=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const v of u){const E=v.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of E)s.set(C.key,C);this.usedForTerrain&&v.updateElevation(!1)}_t(Array.from(s.values()),(v,E)=>{const C=new Ef(v,this._source.tileSize*v.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,R=>{"raster-dem"===this._source.type&&C.dem&&this._backfillDEM(C),E(R,C)})},n)}}function Cf(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Mf(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function sd(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}ru.maxOverzooming=10,ru.maxUnderzooming=3;class Jd{constructor(e,n,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=s}static create(e,n,s){const u=s||e.findDEMTileFor(n);if(!u||!u.dem)return;const p=u.dem,m=u.tileID,v=1<<n.canonical.z-m.canonical.z;return new Jd(u,u.tileSize/Li/v,[(n.canonical.x/v-m.canonical.x)*p.dim,(n.canonical.y/v-m.canonical.y)*p.dim])}tileCoordToPixel(e,n){const s=n*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),p=Math.floor(s);return new Qe(u,p)}getElevationAt(e,n,s,u){const p=e*this._scale+this._offset[0],m=n*this._scale+this._offset[1],v=Math.floor(p),E=Math.floor(m),C=this._dem;return u=!!u,s?wn(wn(C.get(v,E,u),C.get(v,E+1,u),m-E),wn(C.get(v+1,E,u),C.get(v+1,E+1,u),m-E),p-v):C.get(v,E,u)}getElevationAtPixel(e,n,s){return this._dem.get(e,n,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Ka(1,e)*this._dem.stride}}class Df{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new vl(Li,16,0),this.featureIndexArray=new Wf,this.promoteId=n}insert(e,n,s,u,p,m=0){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,u,p,m);const E=this.grid;for(let C=0;C<n.length;C++){const R=n[C],N=[1/0,1/0,-1/0,-1/0];for(let H=0;H<R.length;H++){const K=R[H];N[0]=Math.min(N[0],K.x),N[1]=Math.min(N[1],K.y),N[2]=Math.max(N[2],K.x),N[3]=Math.max(N[3],K.y)}N[0]<Li&&N[1]<Li&&N[2]>=0&&N[3]>=0&&E.insert(v,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ph(new Ld(this.rawTileData)).layers,this.sourceLayerCoder=new yg(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,s,u){this.loadVTLayers();const p=e.params||{},m=es(p.filter),v=e.tileResult,E=e.transform,C=v.bufferedTilespaceBounds,R=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(J,se,De,We)=>t_(v.bufferedTilespaceGeometry,J,se,De,We));R.sort(ey);let N=null;E.elevation&&R.length>0&&(N=Jd.create(E.elevation,this.tileID));const H={};let K;for(let J=0;J<R.length;J++){const se=R[J];if(se===K)continue;K=se;const De=this.featureIndexArray.get(se);let We=null;this.loadMatchingFeature(H,De,m,p.layers,p.availableImages,n,s,u,(gt,Ze,at,Ct=0)=>(We||(We=sc(gt,this.tileID.canonical,e.tileTransform)),Ze.queryIntersectsFeature(v,gt,at,We,this.z,e.transform,e.pixelPosMatrix,N,Ct)))}return H}loadMatchingFeature(e,n,s,u,p,m,v,E,C){const{featureIndex:R,bucketIndex:N,sourceLayerIndex:H,layoutVertexArrayOffset:K}=n,J=this.bucketLayerIDs[N];if(u&&!function(gt,Ze){for(let at=0;at<gt.length;at++)if(Ze.indexOf(gt[at])>=0)return!0;return!1}(u,J))return;const se=this.sourceLayerCoder.decode(H),De=this.vtLayers[se].feature(R);if(s.needGeometry){const gt=Cc(De,!0);if(!s.filter(new $t(this.tileID.overscaledZ),gt,this.tileID.canonical))return}else if(!s.filter(new $t(this.tileID.overscaledZ),De))return;const We=this.getId(De,se);for(let gt=0;gt<J.length;gt++){const Ze=J[gt];if(u&&u.indexOf(Ze)<0)continue;const at=m[Ze];if(!at)continue;let Ct={};void 0!==We&&E&&(Ct=E.getState(at.sourceLayer||"_geojsonTileLayer",We));const mt=Xt({},v[Ze]);mt.paint=wg(mt.paint,at.paint,De,Ct,p),mt.layout=wg(mt.layout,at.layout,De,Ct,p);const an=!C||C(De,at,Ct,K);if(!an)continue;const en=new vg(De,this.z,this.x,this.y,We);en.layer=mt;let An=e[Ze];void 0===An&&(An=e[Ze]=[]),An.push({featureIndex:R,feature:en,intersectionZ:an})}}lookupSymbolFeatures(e,n,s,u,p,m,v,E){const C={};this.loadVTLayers();const R=es(p);for(const N of e)this.loadMatchingFeature(C,{bucketIndex:s,sourceLayerIndex:u,featureIndex:N,layoutVertexArrayOffset:0},R,m,v,E,n);return C}loadFeature(e){const{featureIndex:n,sourceLayerIndex:s}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(s),p=this.vtFeatures[u];if(p[n])return p[n];const m=this.vtLayers[u].feature(n);return p[n]=m,m}hasLayer(e){for(const n of this.bucketLayerIDs)for(const s of n)if(e===s)return!0;return!1}getId(e,n){let s=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[n];null!=u&&(s=e.properties[u]),"boolean"==typeof s&&(s=Number(s))}return s}}function wg(t,e,n,s,u){return Tt(t,(p,m)=>{const v=e instanceof Qn?e.get(m):null;return v&&v.evaluate?v.evaluate(n,s,u):v})}function ey(t,e){return e-t}pi(Df,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Tf{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new Sc({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const s=this.getKey(e,n);return this.positions[s]}trim(){const e=this.width,n=this.height=Nn(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,s){const u=[];let p=e.length%2==1?-e[e.length-1]*s:0,m=e[0]*s,v=!0;u.push({left:p,right:m,isDash:v,zeroLength:0===e[0]});let E=e[0];for(let C=1;C<e.length;C++){v=!v;const R=e[C];p=E*s,E+=R,m=E*s,u.push({left:p,right:m,isDash:v,zeroLength:0===R})}return u}addRoundDash(e,n,s){const u=n/2;for(let p=-s;p<=s;p++){const m=this.width*(this.nextRow+s+p);let v=0,E=e[v];for(let C=0;C<this.width;C++){C/E.right>1&&(E=e[++v]);const R=Math.abs(C-E.left),N=Math.abs(C-E.right),H=Math.min(R,N);let K;const J=p/s*(u+1);if(E.isDash){const se=u-Math.abs(J);K=Math.sqrt(H*H+se*se)}else K=u-Math.sqrt(H*H+J*J);this.image.data[m+C]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e,n){for(let E=e.length-1;E>=0;--E){const C=e[E],R=e[E+1];C.zeroLength?e.splice(E,1):R&&R.isDash===C.isDash&&(R.left=C.left,e.splice(E,1))}const s=e[0],u=e[e.length-1];s.isDash===u.isDash&&(s.left=u.left-this.width,u.right=s.right+this.width);const p=this.width*this.nextRow;let m=0,v=e[m];for(let E=0;E<this.width;E++){E/v.right>1&&(v=e[++m]);const C=Math.abs(E-v.left),R=Math.abs(E-v.right),N=Math.min(C,R);this.image.data[p+E]=Math.max(0,Math.min(255,(v.isDash?N:-N)+n+128))}}addDash(e,n){const s=this.getKey(e,n);if(this.positions[s])return this.positions[s];const u="round"===n,p=u?7:0,m=2*p+1;if(this.nextRow+m>this.height)return Xe("LineAtlas out of space"),null;0===e.length&&e.push(1);let v=0;for(let R=0;R<e.length;R++)e[R]<0&&(Xe("Negative value is found in line dasharray, replacing values with 0"),e[R]=0),v+=e[R];if(0!==v){const R=this.width/v,N=this.getDashRanges(e,this.width,R);u?this.addRoundDash(N,R,p):this.addRegularDash(N,"square"===n?.5*R:0)}const E=this.nextRow+p;this.nextRow+=m;const C={tl:[E,p],br:[v,0]};return this.positions[s]=C,C}}pi(Tf,"LineAtlas");class Eg{constructor(e){const n={},s=[];for(const v in e){const E=e[v],C=n[v]={};for(const R in E.glyphs){const N=E.glyphs[+R];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const H=N.metrics.localGlyph?2:1,K={x:0,y:0,w:N.bitmap.width+2*H,h:N.bitmap.height+2*H};s.push(K),C[R]=K}}const{w:u,h:p}=tf(s),m=new Sc({width:u||1,height:p||1});for(const v in e){const E=e[v];for(const C in E.glyphs){const R=E.glyphs[+C];if(!R||0===R.bitmap.width||0===R.bitmap.height)continue;const N=n[v][C],H=R.metrics.localGlyph?2:1;Sc.copy(R.bitmap,m,{x:0,y:0},{x:N.x+H,y:N.y+H},R.bitmap)}}this.image=m,this.positions=n}}pi(Eg,"GlyphAtlas");class Cg{constructor(e){this.tileID=new va(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Fc(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,s,u,p){this.status="parsing",this.data=e,this.collisionBoxArray=new hp;const m=new yg(Object.keys(e.layers).sort()),v=new Df(this.tileID,this.promoteId);v.bucketLayerIDs=[];const E={},C=new Tf(256,256),R={featureIndex:v,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:s},N=n.familiesBySource[this.source];for(const Ct in N){const mt=e.layers[Ct];if(!mt)continue;let an=!1,en=!1;for(const gn of N[Ct])"symbol"===gn[0].type?an=!0:en=!0;if(!0===this.isSymbolTile&&!an||!1===this.isSymbolTile&&!en)continue;1===mt.version&&Xe(`Vector tile source "${this.source}" layer "${Ct}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const An=m.encode(Ct),Yn=[];for(let gn=0;gn<mt.length;gn++){const Bn=mt.feature(gn),Vn=v.getId(Bn,Ct);Yn.push({feature:Bn,id:Vn,index:gn,sourceLayerIndex:An})}for(const gn of N[Ct]){const Bn=gn[0];void 0!==this.isSymbolTile&&"symbol"===Bn.type!==this.isSymbolTile||Bn.minzoom&&this.zoom<Math.floor(Bn.minzoom)||Bn.maxzoom&&this.zoom>=Bn.maxzoom||"none"!==Bn.visibility&&(eh(gn,this.zoom,s),(E[Bn.id]=Bn.createBucket({index:v.bucketLayerIDs.length,layers:gn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:An,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(Yn,R,this.tileID.canonical,this.tileTransform),v.bucketLayerIDs.push(gn.map(Vn=>Vn.id)))}}let H,K,J,se;C.trim();const De={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},We=Tt(R.glyphDependencies,Ct=>Object.keys(Ct).map(Number));Object.keys(We).length?u.send("getGlyphs",{uid:this.uid,stacks:We},(Ct,mt)=>{H||(H=Ct,K=mt,at.call(this))},void 0,!1,De):K={};const gt=Object.keys(R.iconDependencies);gt.length?u.send("getImages",{icons:gt,source:this.source,tileID:this.tileID,type:"icons"},(Ct,mt)=>{H||(H=Ct,J=mt,at.call(this))},void 0,!1,De):J={};const Ze=Object.keys(R.patternDependencies);function at(){if(H)return p(H);if(K&&J&&se){const Ct=new Eg(K),mt=new pc(J,se);for(const an in E){const en=E[an];en instanceof Jc?(eh(en.layers,this.zoom,s),rg(en,K,Ct.positions,J,mt.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):en.hasPattern&&(en instanceof Oh||en instanceof Hu||en instanceof Od)&&(eh(en.layers,this.zoom,s),en.addFeatures(R,this.tileID.canonical,mt.patternPositions,s,this.tileTransform))}this.status="done",p(null,{buckets:Dn(E).filter(an=>!an.isEmpty()),featureIndex:v,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ct.image,lineAtlas:C,imageAtlas:mt,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?Ct.positions:null})}}Ze.length?u.send("getImages",{icons:Ze,source:this.source,tileID:this.tileID,type:"patterns"},(Ct,mt)=>{H||(H=Ct,se=mt,at.call(this))},void 0,!1,De):se={},at.call(this)}}function eh(t,e,n){const s=new $t(e);for(const u of t)u.recalculate(s,n)}class np{constructor(e){this.entries={},this.scheduler=e}request(e,n,s,u){const p=this.entries[e]=this.entries[e]||{callbacks:[]};if(p.result){const[m,v]=p.result;return this.scheduler?this.scheduler.add(()=>{u(m,v)},n):u(m,v),()=>{}}return p.callbacks.push(u),p.cancel||(p.cancel=s((m,v)=>{p.result=[m,v];for(const E of p.callbacks)this.scheduler?this.scheduler.add(()=>{E(m,v)},n):E(m,v);setTimeout(()=>delete this.entries[e],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(m=>m!==u),p.callbacks.length||(p.cancel(),delete this.entries[e]))}}}function Mg(t,e,n){const s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{const p=ni(t.request,(m,v,E,C)=>{m?u(m):v&&u(null,{vectorTile:n?void 0:new Ph(new Ld(v)),rawData:v,cacheControl:E,expires:C})});return()=>{p.cancel(),u()}},e)}a.ARRAY_TYPE=Xa,a.AUTH_ERR_MSG=Pt,a.Aabb=oa,a.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},Jn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Se()?t:de,this.scheduler=new Q_}send(t,e,n,s,u=!1,p){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=p,this.callbacks[m]=n);const v=li(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:t,hasCallback:!!n,targetMapId:s,mustQueue:u,sourceMapId:this.mapId,data:bl(e,v)},v),{cancel:()=>{n&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[n];delete this.cancelCallbacks[n],s&&s.cancel()}else if(e.mustQueue||Se()){const s=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),s&&s.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(hs(e.error)):n(null,hs(e.data)))}else{const n=li(this.globalScope)?void 0:[],s=e.hasCallback?(p,m)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:p?bl(p):null,data:bl(m,n)},n)}:p=>{},u=hs(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,s);else if(this.parent.getWorkerSource){const p=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,p[0],u.source)[p[1]](u,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=Rd,a.Color=kr,a.ColorMode=Ua,a.CullFaceMode=kl,a.DEMData=Nc,a.DataConstantProperty=qt,a.DedupedRequest=np,a.DepthMode=Ql,a.EXTENT=Li,a.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,s=1<<n,u=Math.floor(t.x),p=Math.floor((t.x-u)*s),m=Math.floor(t.y*s),v=this.findDEMTileFor(new va(n,u,n,p,m));return!(!v||!v.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||t.y<0||t.y>1)return e;const u=s.getSource().maxzoom,p=1<<u,m=Math.floor(t.x),v=t.x-m,E=new va(u,m,u,Math.floor(v*p),Math.floor(t.y*p)),C=this.findDEMTileFor(E);if(!C||!C.dem)return e;const R=C.dem,N=1<<C.tileID.canonical.z,H=(v*N-C.tileID.canonical.x)*R.dim,K=(t.y*N-C.tileID.canonical.y)*R.dim,J=Math.floor(H),se=Math.floor(K);return(n?this.exaggeration():1)*wn(wn(R.get(J,se),R.get(J,se+1),K-se),wn(R.get(J+1,se),R.get(J+1,se+1),K-se),H-J)}getAtTileOffset(t,e,n){const s=1<<t.canonical.z;return this.getAtPointOrZero(new Sl(t.wrap+(t.canonical.x+e/Li)/s,(t.canonical.y+n/Li)/s))}getAtTileOffsetFunc(t,e,n,s){return u=>{const p=this.getAtTileOffset(t,u.x,u.y),m=s.upVector(t.canonical,u.x,u.y);return Qa(m,m,p*s.upVectorScale(t.canonical,e,n).metersToTile),m}}getForTilePoints(t,e,n,s){if(this.isUsingMockSource())return!1;const u=Jd.create(this,t,s);return!!u&&(e.forEach(p=>{p[2]=this.exaggeration()*u.getElevationAt(p[0],p[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,s=e.tileID,u=1<<t.canonical.z-s.canonical.z;let p=t.canonical.x/u-s.canonical.x,m=t.canonical.y/u-s.canonical.y,v=0;for(let E=0;E<t.canonical.z-s.canonical.z&&!n.leaves[v];E++){p*=2,m*=2;const C=2*Math.floor(m)+Math.floor(p);v=n.childOffsets[v]+C,p%=1,m%=1}return{min:this.exaggeration()*n.minimums[v],max:this.exaggeration()*n.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Xr,a.EvaluationParameters=$t,a.Event=fo,a.Evented=Cr,a.FillExtrusionBucket=Od,a.Frustum=wd,a.FrustumCorners=ra,a.GLOBE_METERS_TO_ECEF=$d,a.GLOBE_RADIUS=fc,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_createGrid(t){const e=new Pr,n=new Ps,s=65;for(let u=0;u<s;u++)for(let p=0;p<s;p++)e.emplaceBack(p,u);this._gridSegments=[];for(let u=0,p=0;u<wu.length;u++){const m=wu[u];for(let E=0;E<m;E++)for(let C=0;C<64;C++){const R=E*s+C;n.emplaceBack(R+1,R,R+s),n.emplaceBack(R+s,R+s+1,R+1)}const v=64*m*2;this._gridSegments.push(ps.simpleSegment(0,p,(m+1)*s,v)),p+=v}this._gridBuffer=t.createVertexBuffer(e,Qu.members),this._gridIndexBuffer=t.createIndexBuffer(n,!0)}_createPoles(t){const e=new Ps;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new au,s=new au;this._poleSegments=[];for(let u=0,p=0;u<5;u++){const m=360/(1<<u);n.emplaceBack(0,-fc,0,.5,0),s.emplaceBack(0,-fc,0,.5,1);for(let v=0;v<=64;v++){const E=v/64,C=wn(0,m,E),[R,N,H]=Ju(mg,H_,C,fc);n.emplaceBack(R,N,H,E,0),s.emplaceBack(R,N,H,E,1)}this._poleSegments.push(ps.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,Uh,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(s,Uh,!1)}getGridBuffers(t){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[t]]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const n=new Ml,s=64,u=s+1;this._wireframeSegments=[];for(let p=0,m=0;p<wu.length;p++){const v=wu[p];for(let C=0;C<v;C++)for(let R=0;R<s;R++){const N=C*u+R;n.emplaceBack(N,N+1),n.emplaceBack(N,N+u),n.emplaceBack(N,N+u+1)}const E=v*s*3;this._wireframeSegments.push(ps.simpleSegment(0,m,(v+1)*u,E)),m+=E}this._wireframeIndexBuffer=t.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=jd,a.ImagePosition=Nd,a.LivePerformanceUtils=he,a.LngLat=Tr,a.LngLatBounds=oc,a.LocalGlyphMode=ng,a.MAX_MERCATOR_LATITUDE=Zl,a.MercatorCoordinate=Sl,a.ONE_EM=24,a.OverscaledTileID=va,a.PerformanceMarkers=_e,a.Properties=ki,a.RGBAImage=Na,a.Ray=Op,a.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!lt(t))return t;const n=Yt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!lt(t))return t;const n=Yt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,s){if(!lt(t))return t;const u=Yt(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),n&&u.params.push(`language=${n}`),s&&u.params.push(`worldview=${s}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,s){const u=Yt(t);return lt(t)?(u.path=`/styles/v1${u.path}/sprite${e}${n}`,this._makeAPIURL(u,this._customAccessToken||s)):(u.path+=`${e}${n}`,bn(u))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!lt(t))return t;const s=Yt(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==s.authority&&512===n?"@2x":""}${ke.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${Le.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${Le.TILE_URL_VERSION}${s.path}`);const u=this._customAccessToken||function(p){for(const m of p){const v=m.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(s.params)||Le.ACCESS_TOKEN;return Le.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,u)}canonicalizeTileURL(t,e){const n=Yt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let s="mapbox://";n.path.match(/^\/raster\/v1\//)?s+=`raster/${n.path.replace(`/${Le.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${n.path.replace(`/${Le.TILE_URL_VERSION}/`,"")}`;let u=n.params;return e&&(u=u.filter(p=>!p.match(/^access_token=/))),u.length&&(s+=`?${u.join("&")}`),s}canonicalizeTileset(t,e){const n=!!e&&lt(e),s=[];for(const u of t.tiles||[])nn(u)?s.push(this.canonicalizeTileURL(u,n)):s.push(u);return s}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Yt(Le.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if("/"!==s.path&&(t.path=`${s.path}${t.path}`),!Le.REQUIRE_ACCESS_TOKEN)return bn(t);if(e=e||Le.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(u=>-1===u.indexOf("access_token")),t.params.push(`access_token=${e||""}`),bn(t)}},a.ResourceType=te,a.SegmentVector=ps,a.SourceCache=ru,a.StencilMode=iu,a.StructArrayLayout1ui2=pd,a.StructArrayLayout2f1f2i16=Es,a.StructArrayLayout2i4=Pr,a.StructArrayLayout2ui4=Ml,a.StructArrayLayout3f12=El,a.StructArrayLayout3ui6=Ps,a.StructArrayLayout4i8=Hr,a.StructArrayLayout5f20=au,a.Texture=Xd,a.Tile=Ef,a.Transitionable=Pn,a.Uniform1f=_p,a.Uniform1i=class extends jl{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},a.Uniform2f=class extends jl{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},a.Uniform3f=class extends jl{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},a.Uniform4f=$g,a.UniformColor=yp,a.UniformMatrix2f=class extends jl{constructor(t){super(t),this.current=qg}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<4;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},a.UniformMatrix3f=class extends jl{constructor(t){super(t),this.current=Wg}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<9;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},a.UniformMatrix4f=class extends jl{constructor(t){super(t),this.current=Zg}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let s=1;s<16;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},a.UnwrappedTileID=Tm,a.ValidationError=In,a.VectorTileFeature=Gu,a.VectorTileWorkerSource=class extends Cr{constructor(t,e,n,s,u){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=u||Mg,this.loading={},this.loaded={},this.deduped=new np(t.scheduler),this.isSpriteLoaded=s,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,s=t&&t.request,u=s&&s.collectResourceTiming,p=this.loading[n]=new Cg(t);p.abort=this.loadVectorData(t,(m,v)=>{const E=!this.loading[n];if(delete this.loading[n],E||m||!v)return p.status="done",E||(this.loaded[n]=p),e(m);const C=v.rawData,R={};v.expires&&(R.expires=v.expires),v.cacheControl&&(R.cacheControl=v.cacheControl),p.vectorTile=v.vectorTile||new Ph(new Ld(C));const N=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(H,K)=>{if(H||!K)return e(H);const J={};if(u){const se=Tn(s);se.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(se)))}e(null,Xt({rawTileData:C.slice(0)},K,R,J))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[n]=p})}reloadTile(t,e){const n=this.loaded,s=t.uid,u=this;if(n&&n[s]){const p=n[s];p.showCollisionBoxes=t.showCollisionBoxes,p.enableTerrain=!!t.enableTerrain,p.projection=t.projection,p.tileTransform=Fc(t.tileID.canonical,t.projection);const m=(v,E)=>{const C=p.reloadCallback;C&&(delete p.reloadCallback,p.parse(p.vectorTile,u.layerIndex,this.availableImages,u.actor,C)),e(v,E)};"parsing"===p.status?p.reloadCallback=m:"done"===p.status&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(t,e){const n=t.uid,s=this.loading[n];s&&(s.abort&&s.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,s=t.uid;n&&n[s]&&delete n[s],e()}},a.WritingMode=za,a.add=Dc,a.addDynamicAttributes=qh,a.adjoint=function(t,e){var n=e[0],s=e[1],u=e[2],p=e[3],m=e[4],v=e[5],E=e[6],C=e[7],R=e[8];return t[0]=m*R-v*C,t[1]=u*C-s*R,t[2]=s*v-u*m,t[3]=v*E-p*R,t[4]=n*R-u*E,t[5]=u*p-n*v,t[6]=p*C-m*E,t[7]=s*E-n*C,t[8]=n*m-s*p,t},a.asyncAll=_t,a.bezier=Jt,a.bindAll=Jn,a.boundsAttributes=bg,a.bufferConvexPolygon=function(t,e){const n=[];for(let s=0;s<t.length;s++){const u=He(s-1,-1,t.length-1),p=He(s+1,-1,t.length-1),m=t[s],v=t[p],E=t[u].sub(m).unit(),C=v.sub(m).unit(),R=C.angleWithSep(E.x,E.y),N=E.add(C).unit().mult(-1*e/Math.sin(R/2));n.push(m.add(N))}return n},a.cacheEntryPossiblyAdded=function(t){fe++,fe>jt&&(t.getActor().send("enforceCacheSizeLimit",on),fe=0)},a.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:s}=t.point,u=pg(n,s,t.worldSize/t._pixelsPerMercatorPixel,0,0);return Mc(u,u,Hh(Yl(e)))},a.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:s,lat:u}=t._center;return pg(e,n,t.worldSize,s,u)},a.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/Ka(1,t.center.lat),s=Al(new Float64Array(16));return yd(s,s,[t.point.x,t.point.y,0]),pu(s,s,[n,n,e]),Float32Array.from(s)},a.circumferenceAtLatitude=wp,a.clamp=Ke,a.clearTileCache=function(t){if(!Bt())return;const e=de.caches.delete(ae);t&&e.catch(t).then(()=>t())},a.clipLine=Nh,a.clone=function(t){var e=new Xa(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.clone$1=Fe,a.collisionCircleLayout=Yp,a.config=Le,a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.create=function(){var t=new Xa(16);return Xa!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},a.create$1=tm,a.createExpression=zn,a.createLayout=gi,a.createStyleLayer=function(t){return"custom"===t.type?new K_(t):new bf[t.type](t)},a.cross=mu,a.degToRad=Ce,a.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},a.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.dot=Ja,a.earthRadius=fd,a.ease=Cn,a.easeCubicInOut=zt,a.ecefToLatLng=function([t,e,n]){const s=Math.hypot(t,e,n),u=Math.atan2(t,n),p=.5*Math.PI-Math.acos(-e/s);return new Tr(we(u),we(p))},a.emitValidationErrors=bc,a.endsWith=fn,a.enforceCacheSizeLimit=function(t){Je(),$e&&$e.then(e=>{e.keys().then(n=>{for(let s=0;s<n.length-t;s++)e.delete(n[s])})})},a.evaluateSizeForFeature=Kp,a.evaluateSizeForZoom=Fd,a.evaluateVariableOffset=Rc,a.evented=vt,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.exported=Gn,a.exported$1=ke,a.extend=Xt,a.extend$1=So,a.fillExtrusionHeightLift=Wp,a.filterObject=Ge,a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.fromQuat=function(t,e){var n=e[0],s=e[1],u=e[2],p=e[3],m=n+n,v=s+s,E=u+u,C=n*m,R=s*m,N=s*v,H=u*m,K=u*v,J=u*E,se=p*m,De=p*v,We=p*E;return t[0]=1-N-J,t[1]=R+We,t[2]=H-De,t[3]=0,t[4]=R-We,t[5]=1-C-J,t[6]=K+se,t[7]=0,t[8]=H+De,t[9]=K-se,t[10]=1-C-N,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e){var n=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=r_,a.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return At[e]},a.getAABBPointSquareDist=function(t,e,n){let s=0;for(let u=0;u<2;++u){const p=n?n[u]:0;t[u]>p&&(s+=(t[u]-p)*(t[u]-p)),e[u]<p&&(s+=(p-e[u])*(p-e[u]))}return s},a.getAnchorAlignment=Ym,a.getAnchorJustification=df,a.getBounds=function(t){let e=1/0,n=1/0,s=-1/0,u=-1/0;for(const p of t)e=Math.min(e,p.x),n=Math.min(n,p.y),s=Math.max(s,p.x),u=Math.max(u,p.y);return{min:new Qe(e,n),max:new Qe(s,u)}},a.getColumn=Mn,a.getGridMatrix=function(t,e,n,s){const u=e.getNorth(),p=e.getSouth(),m=e.getWest(),v=e.getEast(),E=1<<t.z,C=v-m,R=u-p,N=C/64,H=-R/wu[n],K=[0,N,0,H,0,0,u,m,0];if(t.z>0){const J=180/s;nm(K,K,[J/C+1,0,0,0,J/R+1,0,-.5*J/N,.5*J/H,1])}return K[2]=E,K[5]=t.x,K[8]=t.y,K},a.getImage=un,a.getJSON=function(t,e){return Rn(Xt(t,{type:"json"}),e)},a.getLatitudinalLod=function(t){const e=80.051129;t=Ke(t,-80.051129,e)/e*90;const n=Math.pow(Math.abs(Math.sin(Ce(t))),3);return Math.round(n*(wu.length-1))},a.getMapSessionAPI=Mt,a.getPerformanceMeasurement=Tn,a.getProjection=Zh,a.getRTLTextPluginStatus=Ut,a.getReferrer=Ht,a.getTilePoint=function(t,{x:e,y:n},s=0){return new Qe(((e-s)*t.scale-t.x)*Li,(n*t.scale-t.y)*Li)},a.getTileVec3=function(t,e,n=0){return xd(((e.x-n)*t.scale-t.x)*Li,(e.y*t.scale-t.y)*Li,dh(e.z,e.y))},a.getVideo=function(t,e){const n=de.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let s=0;s<t.length;s++){const u=de.document.createElement("source");Oi(t[s])||(n.crossOrigin="Anonymous"),u.src=t[s],n.appendChild(u)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=Al(new Float64Array(16));return Mc(n,t.pixelMatrix,t.globeMatrix),jo(e,e,n),new Qe(e[0],e[1])},a.globeDenormalizeECEF=Hh,a.globeECEFOrigin=function(t,e){const n=[0,0,0];return jo(n,n,Zd(Yl(e.canonical))),jo(n,n,t),n},a.globeNormalizeECEF=Zd,a.globePixelsToTileUnits=function(t,e){return Li/(512*Math.pow(2,t))*jh(Yl(e))},a.globePoleMatrixForTile=function(t,e,n){const s=Al(new Float64Array(16)),u=(e/(1<<t)-.5)*Math.PI*2;return Ip(s,n.globeMatrix,u),Float32Array.from(s)},a.globeTileBounds=Yl,a.globeTiltAtLngLat=fg,a.globeToMercatorTransition=Cu,a.globeUseCustomAntiAliasing=function(t,e,n){const s=Cu(n.zoom),u=t.style.map._antialias,p=!!e.extStandardDerivatives,m=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===s&&!u&&!m&&p},a.identity=Al,a.identity$1=lm,a.invert=Ap,a.isFullscreen=function(){return!!de.document.fullscreenElement||!!de.document.webkitFullscreenElement},a.isLngLatBehindGlobe=ff,a.isMapAuthenticated=function(t){return le.has(t)},a.isMapboxURL=lt,a.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!li(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=Ws,a.latLngToECEF=Eu,a.len=a_,a.length=yh,a.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},a.lngFromMercatorX=Tl,a.loadVectorTile=Mg,a.makeRequest=Rn,a.mapValue=function(t,e,n,s,u){return Ke((t-e)/(n-e)*(u-s)+s,s,u)},a.mercatorScale=Ep,a.mercatorXfromLng=Gl,a.mercatorYfromLat=$l,a.mercatorZfromAltitude=Ka,a.mul=qy,a.mul$1=s_,a.multiply=Mc,a.multiply$1=nm,a.multiply$2=xh,a.nextPowerOfTwo=Nn,a.normalize=_a,a.normalize$1=l_,a.normalize$2=sm,a.number=wn,a.ortho=function(t,e,n,s,u,p,m){var v=1/(e-n),E=1/(s-u),C=1/(p-m);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*E,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*C,t[11]=0,t[12]=(e+n)*v,t[13]=(u+s)*E,t[14]=(m+p)*C,t[15]=1,t},a.pbf=Ld,a.perspective=function(t,e,n,s,u){var p,m=1/Math.tan(e/2);return t[0]=m/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(t[10]=(u+s)*(p=1/(s-u)),t[14]=2*u*s*p):(t[10]=-1,t[14]=-2*s),t},a.pick=function(t,e){const n={};for(let s=0;s<e.length;s++){const u=e[s];u in t&&(n[u]=t[u])}return n},a.plugin=rn,a.pointGeometry=Qe,a.polesInViewport=function(t){const e=Al(new Float64Array(16));Mc(e,t.pixelMatrix,t.globeMatrix);const n=[0,el,0],s=[0,Ol,0];return jo(n,n,e),jo(s,s,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!ff(t,new Tr(t.center.lat,90)),s[0]>0&&s[0]<=t.width&&s[1]>0&&s[1]<=t.height&&!ff(t,new Tr(t.center.lat,-90))]},a.polygonContainsPoint=$c,a.polygonIntersectsBox=t_,a.polygonIntersectsPolygon=du,a.polygonizeBounds=function(t,e,n=0,s=!0){const u=new Qe(n,n),p=t.sub(u),m=e.add(u),v=[p,new Qe(m.x,p.y),m,new Qe(p.x,m.y)];return s&&v.push(p.clone()),v},a.posAttributes=Qu,a.postMapLoadEvent=Ve,a.postPerformanceEvent=Lt,a.postTurnstileEvent=oe,a.potpack=tf,a.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},a.radToDeg=we,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(t){return t({pluginStatus:je,pluginURL:ze}),vt.on("pluginStateChange",t),t},a.removeAuthState=function(t){le.delete(t)},a.renderColorRamp=kp,a.resample=hh,a.rotateX=vd,a.rotateX$1=cm,a.rotateY=Ip,a.rotateY$1=Pp,a.rotateZ=function(t,e,n){var s=Math.sin(n),u=Math.cos(n),p=e[0],m=e[1],v=e[2],E=e[3],C=e[4],R=e[5],N=e[6],H=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*u+C*s,t[1]=m*u+R*s,t[2]=v*u+N*s,t[3]=E*u+H*s,t[4]=C*u-p*s,t[5]=R*u-m*s,t[6]=N*u-v*s,t[7]=H*u-E*s,t},a.rotateZ$1=function(t,e,n){n*=.5;var s=e[0],u=e[1],p=e[2],m=e[3],v=Math.sin(n),E=Math.cos(n);return t[0]=s*E+u*v,t[1]=u*E-s*v,t[2]=p*E+m*v,t[3]=m*E-p*v,t},a.scale=pu,a.scale$1=om,a.scale$2=Qa,a.scaleAndAdd=fu,a.set=function(t,e,n,s){return t[0]=e,t[1]=n,t[2]=s,t},a.setCacheLimits=function(t,e){on=t,jt=e},a.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},a.setRTLTextPlugin=function(t,e,n=!1){if(je===Oe||je===Be||je===Te)throw new Error("setRTLTextPlugin cannot be called multiple times.");ze=Gn.resolveURL(t),je=Oe,Ae=e,Dt(),n||ln()},a.smoothstep=Ne,a.spec=_n,a.squaredLength=function(t){var e=t[0],n=t[1],s=t[2];return e*e+n*n+s*s},a.storeAuthState=function(t,e){e?le.add(t):le.delete(t)},a.sub=Il,a.subtract=vh,a.symbolSize=A_,a.tileAABB=function(t,e,n,s,u,p,m,v,E){if("globe"===E.name)return function ug(t,e,n){const s=e/t.worldSize,u=t.globeMatrix;if(n.z<=1){const en=Yl(n).getCorners();return tl(en,u,s),oa.fromPoints(en)}const p=Vh(n),m=dg(p);tl(m,u,s);const v=Number.MAX_VALUE,E=[-v,-v,-v],C=[v,v,v];if(p.contains(t.center)){for(const Yn of m)zu(C,C,Yn),Uu(E,E,Yn);E[2]=0;const en=t.point,An=[en.x*s,en.y*s,0];return zu(C,C,An),Uu(E,E,An),new oa(C,E)}const R=[u[12]*s,u[13]*s,u[14]*s],N=p.getCenter(),H=Ke(t.center.lat,-85.051129,Zl),K=Ke(N.lat,-85.051129,Zl),J=Gl(t.center.lng),se=$l(H);let De=J-Gl(N.lng);const We=se-$l(K);De>.5?De-=1:De<-.5&&(De+=1);let gt=0;Math.abs(De)>Math.abs(We)?gt=De>=0?1:3:(gt=We>=0?0:2,fu(R,R,[u[4]*s,u[5]*s,u[6]*s],-Math.sin(Ce(We>=0?p.getSouth():p.getNorth()))*fc));const Ze=m[gt],at=m[(gt+1)%4],Ct=new lg(Ze,at,R),mt=[pf(Ct,0)||Ze[0],pf(Ct,1)||Ze[1],pf(Ct,2)||Ze[2]],an=Cu(t.zoom);if(an>0){const en=function({x:Yn,y:gn,z:Bn},Vn,$n,Kn,yn){const oi=1/(1<<Bn);let Fi=Yn*oi,ui=Fi+oi,ai=gn*oi,si=ai+oi,zi=0;const _r=(Fi+ui)/2-Kn;return _r>.5?zi=-1:_r<-.5&&(zi=1),Fi=((Fi+zi)*Vn-(Kn*=Vn))*$n+Kn,ui=((ui+zi)*Vn-Kn)*$n+Kn,ai=(ai*Vn-(yn*=Vn))*$n+yn,si=(si*Vn-yn)*$n+yn,[[Fi,si,0],[ui,si,0],[ui,ai,0],[Fi,ai,0]]}(n,e,t._pixelsPerMercatorPixel,J,se);for(let Yn=0;Yn<m.length;Yn++)Kc(m[Yn],en[Yn],an);const An=Dc([],en[gt],en[(gt+1)%4]);Qa(An,An,.5),Kc(mt,An,an)}for(const en of m)zu(C,C,en),Uu(E,E,en);return C[2]=Math.min(Ze[2],at[2]),zu(C,C,mt),Uu(E,E,mt),new oa(C,E)}(t,e,new Rd(n,s,u));const C=Fc({z:n,x:s,y:u},E);return new oa([(p+C.x/C.scale)*e,e*(C.y/C.scale),m],[(p+C.x2/C.scale)*e,e*(C.y2/C.scale),v])},a.tileCornersToBounds=Vh,a.tileTransform=Fc,a.transformMat3=function(t,e,n){var s=e[0],u=e[1],p=e[2];return t[0]=s*n[0]+u*n[3]+p*n[6],t[1]=s*n[1]+u*n[4]+p*n[7],t[2]=s*n[2]+u*n[5]+p*n[8],t},a.transformMat4=jo,a.transformMat4$1=Tc,a.transformQuat=rm,a.transitionTileAABBinECEF=cg,a.translate=yd,a.transpose=function(t,e){if(t===e){var n=e[1],s=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=s,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.triggerPluginCompletionEvent=st,a.uniqueId=vi,a.updateGlobeVertexNormal=function(t,e,n,s,u){const p=5*e+2;t.float32[p+0]=n,t.float32[p+1]=s,t.float32[p+2]=u},a.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=t=>yl(oo(t)),a.validateFog=t=>yl(qr(t)),a.validateLayer=t=>yl(Js(t)),a.validateLight=t=>yl(_l(t)),a.validateSource=t=>yl(ea(t)),a.validateStyle=Ou,a.validateTerrain=t=>yl(Vl(t)),a.values=Dn,a.vectorTile=Sd,a.version=ut,a.warnOnce=Xe,a.window=de,a.wrap=He}),_(0,function(a){function de(Ee){if("number"==typeof Ee||"boolean"==typeof Ee||"string"==typeof Ee||null==Ee)return JSON.stringify(Ee);if(Array.isArray(Ee)){let oe="[";for(const Me of Ee)oe+=`${de(Me)},`;return`${oe}]`}let ee="{";for(const oe of Object.keys(Ee).sort())ee+=`${oe}:${de(Ee[oe])},`;return`${ee}}`}function ut(Ee){let ee="";for(const oe of a.refProperties)ee+=`/${de(Ee[oe])}`;return ee}class it{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,oe){for(const Ve of ee)this._layerConfigs[Ve.id]=Ve,(this._layers[Ve.id]=a.createStyleLayer(Ve)).compileFilter(),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id];for(const Ve of oe)delete this.keyCache[Ve],delete this._layerConfigs[Ve],delete this._layers[Ve];this.familiesBySource={};const Me=function(Ve,ct){const Lt={};for(let Mt=0;Mt<Ve.length;Mt++){const le=ct&&ct[Ve[Mt].id]||ut(Ve[Mt]);ct&&(ct[Ve[Mt].id]=le);let _e=Lt[le];_e||(_e=Lt[le]=[]),_e.push(Ve[Mt])}const Ft=[];for(const Mt in Lt)Ft.push(Lt[Mt]);return Ft}(a.values(this._layerConfigs),this.keyCache);for(const Ve of Me){const ct=Ve.map(he=>this._layers[he.id]),Lt=ct[0];if("none"===Lt.visibility)continue;const Ft=Lt.source||"";let Mt=this.familiesBySource[Ft];Mt||(Mt=this.familiesBySource[Ft]={});const le=Lt.sourceLayer||"_geojsonTileLayer";let _e=Mt[le];_e||(_e=Mt[le]=[]),_e.push(ct)}}}class Le{loadTile(ee,oe){const{uid:Me,encoding:Ve,rawImageData:ct,padding:Lt,buildQuadTree:Ft}=ee,Mt=a.window.ImageBitmap&&ct instanceof a.window.ImageBitmap?this.getImageData(ct,Lt):ct;oe(null,new a.DEMData(Me,Mt,Ve,Lt<1,Ft))}getImageData(ee,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ee.width,ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ee.width,this.offscreenCanvas.height=ee.height,this.offscreenCanvasContext.drawImage(ee,0,0,ee.width,ee.height);const Me=this.offscreenCanvasContext.getImageData(-oe,-oe,ee.width+2*oe,ee.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}var ke=function Ee(ee,oe){var Me,Ve=ee&&ee.type;if("FeatureCollection"===Ve)for(Me=0;Me<ee.features.length;Me++)Ee(ee.features[Me],oe);else if("GeometryCollection"===Ve)for(Me=0;Me<ee.geometries.length;Me++)Ee(ee.geometries[Me],oe);else if("Feature"===Ve)Ee(ee.geometry,oe);else if("Polygon"===Ve)rt(ee.coordinates,oe);else if("MultiPolygon"===Ve)for(Me=0;Me<ee.coordinates.length;Me++)rt(ee.coordinates[Me],oe);return ee};function rt(Ee,ee){if(0!==Ee.length){ft(Ee[0],ee);for(var oe=1;oe<Ee.length;oe++)ft(Ee[oe],!ee)}}function ft(Ee,ee){for(var oe=0,Me=0,Ve=0,ct=Ee.length,Lt=ct-1;Ve<ct;Lt=Ve++){var Ft=(Ee[Ve][0]-Ee[Lt][0])*(Ee[Lt][1]+Ee[Ve][1]),Mt=oe+Ft;Me+=Math.abs(oe)>=Math.abs(Ft)?oe-Mt+Ft:Ft-Mt+oe,oe=Mt}oe+Me>=0!=!!ee&&Ee.reverse()}const Et=a.VectorTileFeature.prototype.toGeoJSON;class dt{constructor(ee){this._feature=ee,this.extent=a.EXTENT,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(1===this._feature.type){const ee=[];for(const oe of this._feature.geometry)ee.push([new a.pointGeometry(oe[0],oe[1])]);return ee}{const ee=[];for(const oe of this._feature.geometry){const Me=[];for(const Ve of oe)Me.push(new a.pointGeometry(Ve[0],Ve[1]));ee.push(Me)}return ee}}toGeoJSON(ee,oe,Me){return Et.call(this,ee,oe,Me)}}class wt{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=ee.length,this._features=ee}feature(ee){return new dt(this._features[ee])}}var tt={exports:{}},Wt=a.pointGeometry,kt=a.vectorTile.VectorTileFeature,Qe=Hn;function Hn(Ee,ee){this.options=ee||{},this.features=Ee,this.length=Ee.length}function Ln(Ee,ee){this.id="number"==typeof Ee.id?Ee.id:void 0,this.type=Ee.type,this.rawGeometry=1===Ee.type?[Ee.geometry]:Ee.geometry,this.properties=Ee.tags,this.extent=ee||4096}Hn.prototype.feature=function(Ee){return new Ln(this.features[Ee],this.options.extent)},Ln.prototype.loadGeometry=function(){var Ee=this.rawGeometry;this.geometry=[];for(var ee=0;ee<Ee.length;ee++){for(var oe=Ee[ee],Me=[],Ve=0;Ve<oe.length;Ve++)Me.push(new Wt(oe[Ve][0],oe[Ve][1]));this.geometry.push(Me)}return this.geometry},Ln.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ee=this.geometry,ee=1/0,oe=-1/0,Me=1/0,Ve=-1/0,ct=0;ct<Ee.length;ct++)for(var Lt=Ee[ct],Ft=0;Ft<Lt.length;Ft++){var Mt=Lt[Ft];ee=Math.min(ee,Mt.x),oe=Math.max(oe,Mt.x),Me=Math.min(Me,Mt.y),Ve=Math.max(Ve,Mt.y)}return[ee,Me,oe,Ve]},Ln.prototype.toGeoJSON=kt.prototype.toGeoJSON;var Ye=a.pbf,Ce=Qe;function we(Ee){var ee=new Ye;return function(oe,Me){for(var Ve in oe.layers)Me.writeMessage(3,At,oe.layers[Ve])}(Ee,ee),ee.finish()}function At(Ee,ee){var oe;ee.writeVarintField(15,Ee.version||1),ee.writeStringField(1,Ee.name||""),ee.writeVarintField(5,Ee.extent||4096);var Me={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Ee.length;oe++)Me.feature=Ee.feature(oe),ee.writeMessage(2,zt,Me);var Ve=Me.keys;for(oe=0;oe<Ve.length;oe++)ee.writeStringField(3,Ve[oe]);var ct=Me.values;for(oe=0;oe<ct.length;oe++)ee.writeMessage(4,He,ct[oe])}function zt(Ee,ee){var oe=Ee.feature;void 0!==oe.id&&ee.writeVarintField(1,oe.id),ee.writeMessage(2,Jt,Ee),ee.writeVarintField(3,oe.type),ee.writeMessage(4,Ne,oe)}function Jt(Ee,ee){var oe=Ee.feature,Me=Ee.keys,Ve=Ee.values,ct=Ee.keycache,Lt=Ee.valuecache;for(var Ft in oe.properties){var Mt=oe.properties[Ft],le=ct[Ft];if(null!==Mt){void 0===le&&(Me.push(Ft),ct[Ft]=le=Me.length-1),ee.writeVarint(le);var _e=typeof Mt;"string"!==_e&&"boolean"!==_e&&"number"!==_e&&(Mt=JSON.stringify(Mt));var he=_e+":"+Mt,Ue=Lt[he];void 0===Ue&&(Ve.push(Mt),Lt[he]=Ue=Ve.length-1),ee.writeVarint(Ue)}}}function Cn(Ee,ee){return(ee<<3)+(7&Ee)}function Ke(Ee){return Ee<<1^Ee>>31}function Ne(Ee,ee){for(var oe=Ee.loadGeometry(),Me=Ee.type,Ve=0,ct=0,Lt=oe.length,Ft=0;Ft<Lt;Ft++){var Mt=oe[Ft],le=1;1===Me&&(le=Mt.length),ee.writeVarint(Cn(1,le));for(var _e=3===Me?Mt.length-1:Mt.length,he=0;he<_e;he++){1===he&&1!==Me&&ee.writeVarint(Cn(2,_e-1));var Ue=Mt[he].x-Ve,Zt=Mt[he].y-ct;ee.writeVarint(Ke(Ue)),ee.writeVarint(Ke(Zt)),Ve+=Ue,ct+=Zt}3===Me&&ee.writeVarint(Cn(7,1))}}function He(Ee,ee){var oe=typeof Ee;"string"===oe?ee.writeStringField(1,Ee):"boolean"===oe?ee.writeBooleanField(7,Ee):"number"===oe&&(Ee%1!=0?ee.writeDoubleField(3,Ee):Ee<0?ee.writeSVarintField(6,Ee):ee.writeVarintField(5,Ee))}function _t(Ee,ee,oe,Me,Ve,ct){if(Ve-Me<=oe)return;const Lt=Me+Ve>>1;Dn(Ee,ee,Lt,Me,Ve,ct%2),_t(Ee,ee,oe,Me,Lt-1,ct+1),_t(Ee,ee,oe,Lt+1,Ve,ct+1)}function Dn(Ee,ee,oe,Me,Ve,ct){for(;Ve>Me;){if(Ve-Me>600){const le=Ve-Me+1,_e=oe-Me+1,he=Math.log(le),Ue=.5*Math.exp(2*he/3),Zt=.5*Math.sqrt(he*Ue*(le-Ue)/le)*(_e-le/2<0?-1:1);Dn(Ee,ee,oe,Math.max(Me,Math.floor(oe-_e*Ue/le+Zt)),Math.min(Ve,Math.floor(oe+(le-_e)*Ue/le+Zt)),ct)}const Lt=ee[2*oe+ct];let Ft=Me,Mt=Ve;for(Xt(Ee,ee,Me,oe),ee[2*Ve+ct]>Lt&&Xt(Ee,ee,Me,Ve);Ft<Mt;){for(Xt(Ee,ee,Ft,Mt),Ft++,Mt--;ee[2*Ft+ct]<Lt;)Ft++;for(;ee[2*Mt+ct]>Lt;)Mt--}ee[2*Me+ct]===Lt?Xt(Ee,ee,Me,Mt):(Mt++,Xt(Ee,ee,Mt,Ve)),Mt<=oe&&(Me=Mt+1),oe<=Mt&&(Ve=Mt-1)}}function Xt(Ee,ee,oe,Me){ii(Ee,oe,Me),ii(ee,2*oe,2*Me),ii(ee,2*oe+1,2*Me+1)}function ii(Ee,ee,oe){const Me=Ee[ee];Ee[ee]=Ee[oe],Ee[oe]=Me}function vi(Ee,ee,oe,Me){const Ve=Ee-oe,ct=ee-Me;return Ve*Ve+ct*ct}tt.exports=we,tt.exports.fromVectorTileJs=we,tt.exports.fromGeojsonVt=function(Ee,ee){ee=ee||{};var oe={};for(var Me in Ee)oe[Me]=new Ce(Ee[Me].features,ee),oe[Me].name=Me,oe[Me].version=ee.version,oe[Me].extent=ee.extent;return we({layers:oe})},tt.exports.GeoJSONWrapper=Ce;const wi=Ee=>Ee[0],Nn=Ee=>Ee[1];class Bi{constructor(ee,oe=wi,Me=Nn,Ve=64,ct=Float64Array){this.nodeSize=Ve,this.points=ee;const Lt=ee.length<65536?Uint16Array:Uint32Array,Ft=this.ids=new Lt(ee.length),Mt=this.coords=new ct(2*ee.length);for(let le=0;le<ee.length;le++)Ft[le]=le,Mt[2*le]=oe(ee[le]),Mt[2*le+1]=Me(ee[le]);_t(Ft,Mt,Ve,0,Ft.length-1,0)}range(ee,oe,Me,Ve){return function(ct,Lt,Ft,Mt,le,_e,he){const Ue=[0,ct.length-1,0],Zt=[];let Tn,jn;for(;Ue.length;){const Xn=Ue.pop(),Ai=Ue.pop(),Ri=Ue.pop();if(Ai-Ri<=he){for(let qi=Ri;qi<=Ai;qi++)Tn=Lt[2*qi],jn=Lt[2*qi+1],Tn>=Ft&&Tn<=le&&jn>=Mt&&jn<=_e&&Zt.push(ct[qi]);continue}const Gn=Math.floor((Ri+Ai)/2);Tn=Lt[2*Gn],jn=Lt[2*Gn+1],Tn>=Ft&&Tn<=le&&jn>=Mt&&jn<=_e&&Zt.push(ct[Gn]);const er=(Xn+1)%2;(0===Xn?Ft<=Tn:Mt<=jn)&&(Ue.push(Ri),Ue.push(Gn-1),Ue.push(er)),(0===Xn?le>=Tn:_e>=jn)&&(Ue.push(Gn+1),Ue.push(Ai),Ue.push(er))}return Zt}(this.ids,this.coords,ee,oe,Me,Ve,this.nodeSize)}within(ee,oe,Me){return function(Ve,ct,Lt,Ft,Mt,le){const _e=[0,Ve.length-1,0],he=[],Ue=Mt*Mt;for(;_e.length;){const Zt=_e.pop(),Tn=_e.pop(),jn=_e.pop();if(Tn-jn<=le){for(let er=jn;er<=Tn;er++)vi(ct[2*er],ct[2*er+1],Lt,Ft)<=Ue&&he.push(Ve[er]);continue}const Xn=Math.floor((jn+Tn)/2),Ai=ct[2*Xn],Ri=ct[2*Xn+1];vi(Ai,Ri,Lt,Ft)<=Ue&&he.push(Ve[Xn]);const Gn=(Zt+1)%2;(0===Zt?Lt-Mt<=Ai:Ft-Mt<=Ri)&&(_e.push(jn),_e.push(Xn-1),_e.push(Gn)),(0===Zt?Lt+Mt>=Ai:Ft+Mt>=Ri)&&(_e.push(Xn+1),_e.push(Tn),_e.push(Gn))}return he}(this.ids,this.coords,ee,oe,Me,this.nodeSize)}}const Jn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ee=>Ee},fn=Math.fround||(Tt=new Float32Array(1),Ee=>(Tt[0]=+Ee,Tt[0]));var Tt;class Ge{constructor(ee){this.options=tn(Object.create(Jn),ee),this.trees=new Array(this.options.maxZoom+1)}load(ee){const{log:oe,minZoom:Me,maxZoom:Ve,nodeSize:ct}=this.options;oe&&console.time("total time");const Lt=`prepare ${ee.length} points`;oe&&console.time(Lt),this.points=ee;let Ft=[];for(let Mt=0;Mt<ee.length;Mt++)ee[Mt].geometry&&Ft.push(ht(ee[Mt],Mt));this.trees[Ve+1]=new Bi(Ft,li,Wi,ct,Float32Array),oe&&console.timeEnd(Lt);for(let Mt=Ve;Mt>=Me;Mt--){const le=+Date.now();Ft=this._cluster(Ft,Mt),this.trees[Mt]=new Bi(Ft,li,Wi,ct,Float32Array),oe&&console.log("z%d: %d clusters in %dms",Mt,Ft.length,+Date.now()-le)}return oe&&console.timeEnd("total time"),this}getClusters(ee,oe){let Me=((ee[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,ee[1]));let ct=180===ee[2]?180:((ee[2]+180)%360+360)%360-180;const Lt=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)Me=-180,ct=180;else if(Me>ct){const _e=this.getClusters([Me,Ve,180,Lt],oe),he=this.getClusters([-180,Ve,ct,Lt],oe);return _e.concat(he)}const Ft=this.trees[this._limitZoom(oe)],Mt=Ft.range(ot(Me),Se(Lt),ot(ct),Se(Ve)),le=[];for(const _e of Mt){const he=Ft.points[_e];le.push(he.numPoints?Xe(he):this.points[he.index])}return le}getChildren(ee){const oe=this._getOriginId(ee),Me=this._getOriginZoom(ee),Ve="No cluster with the specified id.",ct=this.trees[Me];if(!ct)throw new Error(Ve);const Lt=ct.points[oe];if(!Lt)throw new Error(Ve);const Ft=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Mt=ct.within(Lt.x,Lt.y,Ft),le=[];for(const _e of Mt){const he=ct.points[_e];he.parentId===ee&&le.push(he.numPoints?Xe(he):this.points[he.index])}if(0===le.length)throw new Error(Ve);return le}getLeaves(ee,oe,Me){const Ve=[];return this._appendLeaves(Ve,ee,oe=oe||10,Me=Me||0,0),Ve}getTile(ee,oe,Me){const Ve=this.trees[this._limitZoom(ee)],ct=Math.pow(2,ee),{extent:Lt,radius:Ft}=this.options,Mt=Ft/Lt,le=(Me-Mt)/ct,_e=(Me+1+Mt)/ct,he={features:[]};return this._addTileFeatures(Ve.range((oe-Mt)/ct,le,(oe+1+Mt)/ct,_e),Ve.points,oe,Me,ct,he),0===oe&&this._addTileFeatures(Ve.range(1-Mt/ct,le,1,_e),Ve.points,ct,Me,ct,he),oe===ct-1&&this._addTileFeatures(Ve.range(0,le,Mt/ct,_e),Ve.points,-1,Me,ct,he),he.features.length?he:null}getClusterExpansionZoom(ee){let oe=this._getOriginZoom(ee)-1;for(;oe<=this.options.maxZoom;){const Me=this.getChildren(ee);if(oe++,1!==Me.length)break;ee=Me[0].properties.cluster_id}return oe}_appendLeaves(ee,oe,Me,Ve,ct){const Lt=this.getChildren(oe);for(const Ft of Lt){const Mt=Ft.properties;if(Mt&&Mt.cluster?ct+Mt.point_count<=Ve?ct+=Mt.point_count:ct=this._appendLeaves(ee,Mt.cluster_id,Me,Ve,ct):ct<Ve?ct++:ee.push(Ft),ee.length===Me)break}return ct}_addTileFeatures(ee,oe,Me,Ve,ct,Lt){for(const Ft of ee){const Mt=oe[Ft],le=Mt.numPoints;let _e,he,Ue;if(le)_e=ce(Mt),he=Mt.x,Ue=Mt.y;else{const jn=this.points[Mt.index];_e=jn.properties,he=ot(jn.geometry.coordinates[0]),Ue=Se(jn.geometry.coordinates[1])}const Zt={type:1,geometry:[[Math.round(this.options.extent*(he*ct-Me)),Math.round(this.options.extent*(Ue*ct-Ve))]],tags:_e};let Tn;le?Tn=Mt.id:this.options.generateId?Tn=Mt.index:this.points[Mt.index].id&&(Tn=this.points[Mt.index].id),void 0!==Tn&&(Zt.id=Tn),Lt.features.push(Zt)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,oe){const Me=[],{radius:Ve,extent:ct,reduce:Lt,minPoints:Ft}=this.options,Mt=Ve/(ct*Math.pow(2,oe));for(let le=0;le<ee.length;le++){const _e=ee[le];if(_e.zoom<=oe)continue;_e.zoom=oe;const he=this.trees[oe+1],Ue=he.within(_e.x,_e.y,Mt),Zt=_e.numPoints||1;let Tn=Zt;for(const jn of Ue){const Xn=he.points[jn];Xn.zoom>oe&&(Tn+=Xn.numPoints||1)}if(Tn>Zt&&Tn>=Ft){let jn=_e.x*Zt,Xn=_e.y*Zt,Ai=Lt&&Zt>1?this._map(_e,!0):null;const Ri=(le<<5)+(oe+1)+this.points.length;for(const Gn of Ue){const er=he.points[Gn];if(er.zoom<=oe)continue;er.zoom=oe;const qi=er.numPoints||1;jn+=er.x*qi,Xn+=er.y*qi,er.parentId=Ri,Lt&&(Ai||(Ai=this._map(_e,!0)),Lt(Ai,this._map(er)))}_e.parentId=Ri,Me.push(Fe(jn/Tn,Xn/Tn,Ri,Tn,Ai))}else if(Me.push(_e),Tn>1)for(const jn of Ue){const Xn=he.points[jn];Xn.zoom<=oe||(Xn.zoom=oe,Me.push(Xn))}}return Me}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,oe){if(ee.numPoints)return oe?tn({},ee.properties):ee.properties;const Me=this.points[ee.index].properties,Ve=this.options.map(Me);return oe&&Ve===Me?tn({},Ve):Ve}}function Fe(Ee,ee,oe,Me,Ve){return{x:fn(Ee),y:fn(ee),zoom:1/0,id:oe,parentId:-1,numPoints:Me,properties:Ve}}function ht(Ee,ee){const[oe,Me]=Ee.geometry.coordinates;return{x:fn(ot(oe)),y:fn(Se(Me)),zoom:1/0,index:ee,parentId:-1}}function Xe(Ee){return{type:"Feature",id:Ee.id,properties:ce(Ee),geometry:{type:"Point",coordinates:[(ee=Ee.x,360*(ee-.5)),St(Ee.y)]}};var ee}function ce(Ee){const ee=Ee.numPoints,oe=ee>=1e4?`${Math.round(ee/1e3)}k`:ee>=1e3?Math.round(ee/100)/10+"k":ee;return tn(tn({},Ee.properties),{cluster:!0,cluster_id:Ee.id,point_count:ee,point_count_abbreviated:oe})}function ot(Ee){return Ee/360+.5}function Se(Ee){const ee=Math.sin(Ee*Math.PI/180),oe=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return oe<0?0:oe>1?1:oe}function St(Ee){const ee=(180-360*Ee)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function tn(Ee,ee){for(const oe in ee)Ee[oe]=ee[oe];return Ee}function li(Ee){return Ee.x}function Wi(Ee){return Ee.y}function Mn(Ee,ee,oe,Me){for(var Ve,ct=Me,Lt=oe-ee>>1,Ft=oe-ee,Mt=Ee[ee],le=Ee[ee+1],_e=Ee[oe],he=Ee[oe+1],Ue=ee+3;Ue<oe;Ue+=3){var Zt=ae(Ee[Ue],Ee[Ue+1],Mt,le,_e,he);if(Zt>ct)Ve=Ue,ct=Zt;else if(Zt===ct){var Tn=Math.abs(Ue-Lt);Tn<Ft&&(Ve=Ue,Ft=Tn)}}ct>Me&&(Ve-ee>3&&Mn(Ee,ee,Ve,Me),Ee[Ve+2]=ct,oe-Ve>3&&Mn(Ee,Ve,oe,Me))}function ae(Ee,ee,oe,Me,Ve,ct){var Lt=Ve-oe,Ft=ct-Me;if(0!==Lt||0!==Ft){var Mt=((Ee-oe)*Lt+(ee-Me)*Ft)/(Lt*Lt+Ft*Ft);Mt>1?(oe=Ve,Me=ct):Mt>0&&(oe+=Lt*Mt,Me+=Ft*Mt)}return(Lt=Ee-oe)*Lt+(Ft=ee-Me)*Ft}function $e(Ee,ee,oe,Me){var Ve={id:void 0===Ee?null:Ee,type:ee,geometry:oe,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ct){var Lt=ct.geometry,Ft=ct.type;if("Point"===Ft||"MultiPoint"===Ft||"LineString"===Ft)Rt(ct,Lt);else if("Polygon"===Ft||"MultiLineString"===Ft)for(var Mt=0;Mt<Lt.length;Mt++)Rt(ct,Lt[Mt]);else if("MultiPolygon"===Ft)for(Mt=0;Mt<Lt.length;Mt++)for(var le=0;le<Lt[Mt].length;le++)Rt(ct,Lt[Mt][le])}(Ve),Ve}function Rt(Ee,ee){for(var oe=0;oe<ee.length;oe+=3)Ee.minX=Math.min(Ee.minX,ee[oe]),Ee.minY=Math.min(Ee.minY,ee[oe+1]),Ee.maxX=Math.max(Ee.maxX,ee[oe]),Ee.maxY=Math.max(Ee.maxY,ee[oe+1])}function on(Ee,ee,oe,Me){if(ee.geometry){var Ve=ee.geometry.coordinates,ct=ee.geometry.type,Lt=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),Ft=[],Mt=ee.id;if(oe.promoteId?Mt=ee.properties[oe.promoteId]:oe.generateId&&(Mt=Me||0),"Point"===ct)jt(Ve,Ft);else if("MultiPoint"===ct)for(var le=0;le<Ve.length;le++)jt(Ve[le],Ft);else if("LineString"===ct)Bt(Ve,Ft,Lt,!1);else if("MultiLineString"===ct){if(oe.lineMetrics){for(le=0;le<Ve.length;le++)Bt(Ve[le],Ft=[],Lt,!1),Ee.push($e(Mt,"LineString",Ft,ee.properties));return}Je(Ve,Ft,Lt,!1)}else if("Polygon"===ct)Je(Ve,Ft,Lt,!0);else{if("MultiPolygon"!==ct){if("GeometryCollection"===ct){for(le=0;le<ee.geometry.geometries.length;le++)on(Ee,{id:Mt,geometry:ee.geometry.geometries[le],properties:ee.properties},oe,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(le=0;le<Ve.length;le++){var _e=[];Je(Ve[le],_e,Lt,!0),Ft.push(_e)}}Ee.push($e(Mt,ct,Ft,ee.properties))}}function jt(Ee,ee){ee.push(ge(Ee[0])),ee.push(fe(Ee[1])),ee.push(0)}function Bt(Ee,ee,oe,Me){for(var Ve,ct,Lt=0,Ft=0;Ft<Ee.length;Ft++){var Mt=ge(Ee[Ft][0]),le=fe(Ee[Ft][1]);ee.push(Mt),ee.push(le),ee.push(0),Ft>0&&(Lt+=Me?(Ve*le-Mt*ct)/2:Math.sqrt(Math.pow(Mt-Ve,2)+Math.pow(le-ct,2))),Ve=Mt,ct=le}var _e=ee.length-3;ee[2]=1,Mn(ee,0,_e,oe),ee[_e+2]=1,ee.size=Math.abs(Lt),ee.start=0,ee.end=ee.size}function Je(Ee,ee,oe,Me){for(var Ve=0;Ve<Ee.length;Ve++){var ct=[];Bt(Ee[Ve],ct,oe,Me),ee.push(ct)}}function ge(Ee){return Ee/360+.5}function fe(Ee){var ee=Math.sin(Ee*Math.PI/180),oe=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return oe<0?0:oe>1?1:oe}function te(Ee,ee,oe,Me,Ve,ct,Lt,Ft){if(Me/=ee,ct>=(oe/=ee)&&Lt<Me)return Ee;if(Lt<oe||ct>=Me)return null;for(var Mt=[],le=0;le<Ee.length;le++){var _e=Ee[le],he=_e.geometry,Ue=_e.type,Zt=0===Ve?_e.minX:_e.minY,Tn=0===Ve?_e.maxX:_e.maxY;if(Zt>=oe&&Tn<Me)Mt.push(_e);else if(!(Tn<oe||Zt>=Me)){var jn=[];if("Point"===Ue||"MultiPoint"===Ue)nt(he,jn,oe,Me,Ve);else if("LineString"===Ue)Ht(he,jn,oe,Me,Ve,!1,Ft.lineMetrics);else if("MultiLineString"===Ue)ni(he,jn,oe,Me,Ve,!1);else if("Polygon"===Ue)ni(he,jn,oe,Me,Ve,!0);else if("MultiPolygon"===Ue)for(var Xn=0;Xn<he.length;Xn++){var Ai=[];ni(he[Xn],Ai,oe,Me,Ve,!0),Ai.length&&jn.push(Ai)}if(jn.length){if(Ft.lineMetrics&&"LineString"===Ue){for(Xn=0;Xn<jn.length;Xn++)Mt.push($e(_e.id,Ue,jn[Xn],_e.tags));continue}"LineString"!==Ue&&"MultiLineString"!==Ue||(1===jn.length?(Ue="LineString",jn=jn[0]):Ue="MultiLineString"),"Point"!==Ue&&"MultiPoint"!==Ue||(Ue=3===jn.length?"Point":"MultiPoint"),Mt.push($e(_e.id,Ue,jn,_e.tags))}}}return Mt.length?Mt:null}function nt(Ee,ee,oe,Me,Ve){for(var ct=0;ct<Ee.length;ct+=3){var Lt=Ee[ct+Ve];Lt>=oe&&Lt<=Me&&(ee.push(Ee[ct]),ee.push(Ee[ct+1]),ee.push(Ee[ct+2]))}}function Ht(Ee,ee,oe,Me,Ve,ct,Lt){for(var Ft,Mt,le=Rn(Ee),_e=0===Ve?xn:Ji,he=Ee.start,Ue=0;Ue<Ee.length-3;Ue+=3){var Zt=Ee[Ue],Tn=Ee[Ue+1],jn=Ee[Ue+2],Xn=Ee[Ue+3],Ai=Ee[Ue+4],Ri=0===Ve?Zt:Tn,Gn=0===Ve?Xn:Ai,er=!1;Lt&&(Ft=Math.sqrt(Math.pow(Zt-Xn,2)+Math.pow(Tn-Ai,2))),Ri<oe?Gn>oe&&(Mt=_e(le,Zt,Tn,Xn,Ai,oe),Lt&&(le.start=he+Ft*Mt)):Ri>Me?Gn<Me&&(Mt=_e(le,Zt,Tn,Xn,Ai,Me),Lt&&(le.start=he+Ft*Mt)):Oi(le,Zt,Tn,jn),Gn<oe&&Ri>=oe&&(Mt=_e(le,Zt,Tn,Xn,Ai,oe),er=!0),Gn>Me&&Ri<=Me&&(Mt=_e(le,Zt,Tn,Xn,Ai,Me),er=!0),!ct&&er&&(Lt&&(le.end=he+Ft*Mt),ee.push(le),le=Rn(Ee)),Lt&&(he+=Ft)}var qi=Ee.length-3;Zt=Ee[qi],Tn=Ee[qi+1],jn=Ee[qi+2],(Ri=0===Ve?Zt:Tn)>=oe&&Ri<=Me&&Oi(le,Zt,Tn,jn),qi=le.length-3,ct&&qi>=3&&(le[qi]!==le[0]||le[qi+1]!==le[1])&&Oi(le,le[0],le[1],le[2]),le.length&&ee.push(le)}function Rn(Ee){var ee=[];return ee.size=Ee.size,ee.start=Ee.start,ee.end=Ee.end,ee}function ni(Ee,ee,oe,Me,Ve,ct){for(var Lt=0;Lt<Ee.length;Lt++)Ht(Ee[Lt],ee,oe,Me,Ve,ct,!1)}function Oi(Ee,ee,oe,Me){Ee.push(ee),Ee.push(oe),Ee.push(Me)}function xn(Ee,ee,oe,Me,Ve,ct){var Lt=(ct-ee)/(Me-ee);return Ee.push(ct),Ee.push(oe+(Ve-oe)*Lt),Ee.push(1),Lt}function Ji(Ee,ee,oe,Me,Ve,ct){var Lt=(ct-oe)/(Ve-oe);return Ee.push(ee+(Me-ee)*Lt),Ee.push(ct),Ee.push(1),Lt}function Hi(Ee,ee){for(var oe=[],Me=0;Me<Ee.length;Me++){var Ve,ct=Ee[Me],Lt=ct.type;if("Point"===Lt||"MultiPoint"===Lt||"LineString"===Lt)Ve=un(ct.geometry,ee);else if("MultiLineString"===Lt||"Polygon"===Lt){Ve=[];for(var Ft=0;Ft<ct.geometry.length;Ft++)Ve.push(un(ct.geometry[Ft],ee))}else if("MultiPolygon"===Lt)for(Ve=[],Ft=0;Ft<ct.geometry.length;Ft++){for(var Mt=[],le=0;le<ct.geometry[Ft].length;le++)Mt.push(un(ct.geometry[Ft][le],ee));Ve.push(Mt)}oe.push($e(ct.id,Lt,Ve,ct.tags))}return oe}function un(Ee,ee){var oe=[];oe.size=Ee.size,void 0!==Ee.start&&(oe.start=Ee.start,oe.end=Ee.end);for(var Me=0;Me<Ee.length;Me+=3)oe.push(Ee[Me]+ee,Ee[Me+1],Ee[Me+2]);return oe}function Pt(Ee,ee){if(Ee.transformed)return Ee;var oe,Me,Ve,ct=1<<Ee.z,Lt=Ee.x,Ft=Ee.y;for(oe=0;oe<Ee.features.length;oe++){var Mt=Ee.features[oe],le=Mt.geometry,_e=Mt.type;if(Mt.geometry=[],1===_e)for(Me=0;Me<le.length;Me+=2)Mt.geometry.push(lt(le[Me],le[Me+1],ee,ct,Lt,Ft));else for(Me=0;Me<le.length;Me++){var he=[];for(Ve=0;Ve<le[Me].length;Ve+=2)he.push(lt(le[Me][Ve],le[Me][Ve+1],ee,ct,Lt,Ft));Mt.geometry.push(he)}}return Ee.transformed=!0,Ee}function lt(Ee,ee,oe,Me,Ve,ct){return[Math.round(oe*(Ee*Me-Ve)),Math.round(oe*(ee*Me-ct))]}function nn(Ee,ee,oe,Me,Ve){for(var ct=ee===Ve.maxZoom?0:Ve.tolerance/((1<<ee)*Ve.extent),Lt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:Me,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ft=0;Ft<Ee.length;Ft++){Lt.numFeatures++,_i(Lt,Ee[Ft],ct,Ve);var Mt=Ee[Ft].minX,le=Ee[Ft].minY,_e=Ee[Ft].maxX,he=Ee[Ft].maxY;Mt<Lt.minX&&(Lt.minX=Mt),le<Lt.minY&&(Lt.minY=le),_e>Lt.maxX&&(Lt.maxX=_e),he>Lt.maxY&&(Lt.maxY=he)}return Lt}function _i(Ee,ee,oe,Me){var Ve=ee.geometry,ct=ee.type,Lt=[];if("Point"===ct||"MultiPoint"===ct)for(var Ft=0;Ft<Ve.length;Ft+=3)Lt.push(Ve[Ft]),Lt.push(Ve[Ft+1]),Ee.numPoints++,Ee.numSimplified++;else if("LineString"===ct)Qt(Lt,Ve,Ee,oe,!1,!1);else if("MultiLineString"===ct||"Polygon"===ct)for(Ft=0;Ft<Ve.length;Ft++)Qt(Lt,Ve[Ft],Ee,oe,"Polygon"===ct,0===Ft);else if("MultiPolygon"===ct)for(var Mt=0;Mt<Ve.length;Mt++){var le=Ve[Mt];for(Ft=0;Ft<le.length;Ft++)Qt(Lt,le[Ft],Ee,oe,!0,0===Ft)}if(Lt.length){var _e=ee.tags||null;if("LineString"===ct&&Me.lineMetrics){for(var he in _e={},ee.tags)_e[he]=ee.tags[he];_e.mapbox_clip_start=Ve.start/Ve.size,_e.mapbox_clip_end=Ve.end/Ve.size}var Ue={geometry:Lt,type:"Polygon"===ct||"MultiPolygon"===ct?3:"LineString"===ct||"MultiLineString"===ct?2:1,tags:_e};null!==ee.id&&(Ue.id=ee.id),Ee.features.push(Ue)}}function Qt(Ee,ee,oe,Me,Ve,ct){var Lt=Me*Me;if(Me>0&&ee.size<(Ve?Lt:Me))oe.numPoints+=ee.length/3;else{for(var Ft=[],Mt=0;Mt<ee.length;Mt+=3)(0===Me||ee[Mt+2]>Lt)&&(oe.numSimplified++,Ft.push(ee[Mt]),Ft.push(ee[Mt+1])),oe.numPoints++;Ve&&function(le,_e){for(var he=0,Ue=0,Zt=le.length,Tn=Zt-2;Ue<Zt;Tn=Ue,Ue+=2)he+=(le[Ue]-le[Tn])*(le[Ue+1]+le[Tn+1]);if(he>0===_e)for(Ue=0,Zt=le.length;Ue<Zt/2;Ue+=2){var jn=le[Ue],Xn=le[Ue+1];le[Ue]=le[Zt-2-Ue],le[Ue+1]=le[Zt-1-Ue],le[Zt-2-Ue]=jn,le[Zt-1-Ue]=Xn}}(Ft,ct),Ee.push(Ft)}}function xt(Ee,ee){var oe=(ee=this.options=function(Ve,ct){for(var Lt in ct)Ve[Lt]=ct[Lt];return Ve}(Object.create(this.options),ee)).debug;if(oe&&console.time("preprocess data"),ee.maxZoom<0||ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ee.promoteId&&ee.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ve,ct,Lt,Ft,Mt,le,Me=function(Ve,ct){var Lt=[];if("FeatureCollection"===Ve.type)for(var Ft=0;Ft<Ve.features.length;Ft++)on(Lt,Ve.features[Ft],ct,Ft);else on(Lt,"Feature"===Ve.type?Ve:{geometry:Ve},ct);return Lt}(Ee,ee);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ee.indexMaxZoom,ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ft=Ve=Me,Mt=te(Ve,1,-1-(Lt=(ct=ee).buffer/ct.extent),Lt,0,-1,2,ct),le=te(Ve,1,1-Lt,2+Lt,0,-1,2,ct),(Mt||le)&&(Ft=te(Ve,1,-Lt,1+Lt,0,-1,2,ct)||[],Mt&&(Ft=Hi(Mt,1).concat(Ft)),le&&(Ft=Ft.concat(Hi(le,-1)))),(Me=Ft).length&&this.splitTile(Me,0,0,0),oe&&(Me.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pt(Ee,ee,oe){return 32*((1<<Ee)*oe+ee)+Ee}function Yt(Ee,ee){const oe=Ee.tileID.canonical;if(!this._geoJSONIndex)return ee(null,null);const Me=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!Me)return ee(null,null);const Ve=new wt(Me.features);let ct=tt.exports(Ve);0===ct.byteOffset&&ct.byteLength===ct.buffer.byteLength||(ct=new Uint8Array(ct)),ee(null,{vectorTile:Ve,rawData:ct.buffer})}xt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xt.prototype.splitTile=function(Ee,ee,oe,Me,Ve,ct,Lt){for(var Ft=[Ee,ee,oe,Me],Mt=this.options,le=Mt.debug;Ft.length;){Me=Ft.pop(),oe=Ft.pop(),ee=Ft.pop(),Ee=Ft.pop();var _e=1<<ee,he=pt(ee,oe,Me),Ue=this.tiles[he];if(!Ue&&(le>1&&console.time("creation"),Ue=this.tiles[he]=nn(Ee,ee,oe,Me,Mt),this.tileCoords.push({z:ee,x:oe,y:Me}),le)){le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ee,oe,Me,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var Zt="z"+ee;this.stats[Zt]=(this.stats[Zt]||0)+1,this.total++}if(Ue.source=Ee,Ve){if(ee===Mt.maxZoom||ee===Ve)continue;var Tn=1<<Ve-ee;if(oe!==Math.floor(ct/Tn)||Me!==Math.floor(Lt/Tn))continue}else if(ee===Mt.indexMaxZoom||Ue.numPoints<=Mt.indexMaxPoints)continue;if(Ue.source=null,0!==Ee.length){le>1&&console.time("clipping");var jn,Xn,Ai,Ri,Gn,er,qi=.5*Mt.buffer/Mt.extent,fo=.5-qi,Xr=.5+qi,Cr=1+qi;jn=Xn=Ai=Ri=null,Gn=te(Ee,_e,oe-qi,oe+Xr,0,Ue.minX,Ue.maxX,Mt),er=te(Ee,_e,oe+fo,oe+Cr,0,Ue.minX,Ue.maxX,Mt),Ee=null,Gn&&(jn=te(Gn,_e,Me-qi,Me+Xr,1,Ue.minY,Ue.maxY,Mt),Xn=te(Gn,_e,Me+fo,Me+Cr,1,Ue.minY,Ue.maxY,Mt),Gn=null),er&&(Ai=te(er,_e,Me-qi,Me+Xr,1,Ue.minY,Ue.maxY,Mt),Ri=te(er,_e,Me+fo,Me+Cr,1,Ue.minY,Ue.maxY,Mt),er=null),le>1&&console.timeEnd("clipping"),Ft.push(jn||[],ee+1,2*oe,2*Me),Ft.push(Xn||[],ee+1,2*oe,2*Me+1),Ft.push(Ai||[],ee+1,2*oe+1,2*Me),Ft.push(Ri||[],ee+1,2*oe+1,2*Me+1)}}},xt.prototype.getTile=function(Ee,ee,oe){var Me=this.options,Ve=Me.extent,ct=Me.debug;if(Ee<0||Ee>24)return null;var Lt=1<<Ee,Ft=pt(Ee,ee=(ee%Lt+Lt)%Lt,oe);if(this.tiles[Ft])return Pt(this.tiles[Ft],Ve);ct>1&&console.log("drilling down to z%d-%d-%d",Ee,ee,oe);for(var Mt,le=Ee,_e=ee,he=oe;!Mt&&le>0;)le--,_e=Math.floor(_e/2),he=Math.floor(he/2),Mt=this.tiles[pt(le,_e,he)];return Mt&&Mt.source?(ct>1&&console.log("found parent tile z%d-%d-%d",le,_e,he),ct>1&&console.time("drilling down"),this.splitTile(Mt.source,le,_e,he,Ee,ee,oe),ct>1&&console.timeEnd("drilling down"),this.tiles[Ft]?Pt(this.tiles[Ft],Ve):null):null};class bn extends a.VectorTileWorkerSource{constructor(ee,oe,Me,Ve,ct){super(ee,oe,Me,Ve,Yt),ct&&(this.loadGeoJSON=ct)}loadData(ee,oe){const Me=ee&&ee.request,Ve=Me&&Me.collectResourceTiming;this.loadGeoJSON(ee,(ct,Lt)=>{if(ct||!Lt)return oe(ct);if("object"!=typeof Lt)return oe(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));{ke(Lt,!0);try{if(ee.filter){const Mt=a.createExpression(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Mt.result)throw new Error(Mt.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));const le=Lt.features.filter(_e=>Mt.value.evaluate({zoom:0},_e));Lt={type:"FeatureCollection",features:le}}this._geoJSONIndex=ee.cluster?new Ge(function({superclusterOptions:Mt,clusterProperties:le}){if(!le||!Mt)return Mt;const _e={},he={},Ue={accumulated:null,zoom:0},Zt={properties:null},Tn=Object.keys(le);for(const jn of Tn){const[Xn,Ai]=le[jn],Ri=a.createExpression(Ai),Gn=a.createExpression("string"==typeof Xn?[Xn,["accumulated"],["get",jn]]:Xn);_e[jn]=Ri.value,he[jn]=Gn.value}return Mt.map=jn=>{Zt.properties=jn;const Xn={};for(const Ai of Tn)Xn[Ai]=_e[Ai].evaluate(Ue,Zt);return Xn},Mt.reduce=(jn,Xn)=>{Zt.properties=Xn;for(const Ai of Tn)Ue.accumulated=jn[Ai],jn[Ai]=he[Ai].evaluate(Ue,Zt)},Mt}(ee)).load(Lt.features):new xt(Mt=Lt,ee.geojsonVtOptions)}catch(Mt){return oe(Mt)}this.loaded={};const Ft={};if(Ve){const Mt=a.getPerformanceMeasurement(Me);Mt&&(Ft.resourceTiming={},Ft.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Mt)))}oe(null,Ft)}var Mt})}reloadTile(ee,oe){const Me=this.loaded;return Me&&Me[ee.uid]?super.reloadTile(ee,oe):this.loadTile(ee,oe)}loadGeoJSON(ee,oe){if(ee.request)a.getJSON(ee.request,oe);else{if("string"!=typeof ee.data)return oe(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(ee.data))}catch{return oe(new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ee,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId))}catch(Me){oe(Me)}}getClusterChildren(ee,oe){try{oe(null,this._geoJSONIndex.getChildren(ee.clusterId))}catch(Me){oe(Me)}}getClusterLeaves(ee,oe){try{oe(null,this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset))}catch(Me){oe(Me)}}}class ri{constructor(ee){this.self=ee,this.actor=new a.Actor(ee,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:bn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(oe,Me)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=Me},this.self.registerRTLTextPlugin=oe=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=oe.applyArabicShaping,a.plugin.processBidirectionalText=oe.processBidirectionalText,a.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}}clearCaches(ee,oe,Me){delete this.layerIndexes[ee],delete this.availableImages[ee],delete this.workerSources[ee],delete this.demWorkerSources[ee],Me()}checkIfReady(ee,oe,Me){Me()}setReferrer(ee,oe){this.referrer=oe}spriteLoaded(ee,oe){this.isSpriteLoaded[ee]=oe;for(const Me in this.workerSources[ee]){const Ve=this.workerSources[ee][Me];for(const ct in Ve)Ve[ct]instanceof a.VectorTileWorkerSource&&(Ve[ct].isSpriteLoaded=oe,Ve[ct].fire(new a.Event("isSpriteLoaded")))}}setImages(ee,oe,Me){this.availableImages[ee]=oe;for(const Ve in this.workerSources[ee]){const ct=this.workerSources[ee][Ve];for(const Lt in ct)ct[Lt].availableImages=oe}Me()}enableTerrain(ee,oe,Me){this.terrain=oe,Me()}setProjection(ee,oe){this.projections[ee]=a.getProjection(oe)}setLayers(ee,oe,Me){this.getLayerIndex(ee).replace(oe),Me()}updateLayers(ee,oe,Me){this.getLayerIndex(ee).update(oe.layers,oe.removedIds),Me()}loadTile(ee,oe,Me){const Ve=this.enableTerrain?a.extend({enableTerrain:this.terrain},oe):oe;Ve.projection=this.projections[ee]||this.defaultProjection,this.getWorkerSource(ee,oe.type,oe.source).loadTile(Ve,Me)}loadDEMTile(ee,oe,Me){const Ve=this.enableTerrain?a.extend({buildQuadTree:this.terrain},oe):oe;this.getDEMWorkerSource(ee,oe.source).loadTile(Ve,Me)}reloadTile(ee,oe,Me){const Ve=this.enableTerrain?a.extend({enableTerrain:this.terrain},oe):oe;Ve.projection=this.projections[ee]||this.defaultProjection,this.getWorkerSource(ee,oe.type,oe.source).reloadTile(Ve,Me)}abortTile(ee,oe,Me){this.getWorkerSource(ee,oe.type,oe.source).abortTile(oe,Me)}removeTile(ee,oe,Me){this.getWorkerSource(ee,oe.type,oe.source).removeTile(oe,Me)}removeSource(ee,oe,Me){if(!this.workerSources[ee]||!this.workerSources[ee][oe.type]||!this.workerSources[ee][oe.type][oe.source])return;const Ve=this.workerSources[ee][oe.type][oe.source];delete this.workerSources[ee][oe.type][oe.source],void 0!==Ve.removeSource?Ve.removeSource(oe,Me):Me()}loadWorkerSource(ee,oe,Me){try{this.self.importScripts(oe.url),Me()}catch(Ve){Me(Ve.toString())}}syncRTLPluginState(ee,oe,Me){try{a.plugin.setState(oe);const Ve=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&null!=Ve){this.self.importScripts(Ve);const ct=a.plugin.isParsed();Me(ct?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ve}`),ct)}}catch(Ve){Me(Ve.toString())}}getAvailableImages(ee){let oe=this.availableImages[ee];return oe||(oe=[]),oe}getLayerIndex(ee){let oe=this.layerIndexes[ee];return oe||(oe=this.layerIndexes[ee]=new it),oe}getWorkerSource(ee,oe,Me){return this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][oe]||(this.workerSources[ee][oe]={}),this.workerSources[ee][oe][Me]||(this.workerSources[ee][oe][Me]=new this.workerSourceTypes[oe]({send:(ct,Lt,Ft,Mt,le,_e)=>{this.actor.send(ct,Lt,Ft,ee,le,_e)},scheduler:this.actor.scheduler},this.getLayerIndex(ee),this.getAvailableImages(ee),this.isSpriteLoaded[ee])),this.workerSources[ee][oe][Me]}getDEMWorkerSource(ee,oe){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][oe]||(this.demWorkerSources[ee][oe]=new Le),this.demWorkerSources[ee][oe]}enforceCacheSizeLimit(ee,oe){a.enforceCacheSizeLimit(oe)}getWorkerPerformanceMetrics(ee,oe,Me){Me(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ri(self)),ri}),_(0,function(a){function de(d,i){if(Array.isArray(d)){if(!Array.isArray(i)||d.length!==i.length)return!1;for(let c=0;c<d.length;c++)if(!de(d[c],i[c]))return!1;return!0}if("object"==typeof d&&null!==d&&null!==i){if("object"!=typeof i||Object.keys(d).length!==Object.keys(i).length)return!1;for(const c in d)if(!de(d[c],i[c]))return!1;return!0}return d===i}var ut=it;function it(d){return i=d,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var f,y,x=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(x);try{y=new Worker(D),f=!0}catch{f=!1}return y&&y.terminate(),URL.revokeObjectURL(D),f}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var f=document.createElement("canvas");f.width=f.height=1;var y=f.getContext("2d");if(!y)return!1;var x=y.getImageData(0,0,1,1);return x&&x.width===f.width}()||(void 0===Le[c=i&&i.failIfMajorPerformanceCaveat]&&(Le[c]=function(f){var y,D,P,F,x=(D=f,P=document.createElement("canvas"),(F=Object.create(it.webGLContextAttributes)).failIfMajorPerformanceCaveat=D,P.getContext("webgl",F)||P.getContext("experimental-webgl",F));if(!x)return!1;try{y=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!y||x.isContextLost())&&(x.shaderSource(y,"void main() {}"),x.compileShader(y),!0===x.getShaderParameter(y,x.COMPILE_STATUS))}(c)),!Le[c]||document.documentMode));var i,c}var Le={};function ke(d,i,c){const f=a.window.document.createElement(d);return void 0!==i&&(f.className=i),c&&c.appendChild(f),f}function rt(d,i,c){const f=a.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const y of Object.keys(i))f.setAttributeNS(null,y,i[y]);return c&&c.appendChild(f),f}it.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const ft=a.window.document&&a.window.document.documentElement.style,Et=ft&&void 0!==ft.userSelect?"userSelect":"WebkitUserSelect";let dt;function wt(){ft&&Et&&(dt=ft[Et],ft[Et]="none")}function tt(){ft&&Et&&(ft[Et]=dt)}function Wt(d){d.preventDefault(),d.stopPropagation(),a.window.removeEventListener("click",Wt,!0)}function kt(){a.window.addEventListener("click",Wt,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Wt,!0)},0)}function Qe(d,i){const c=d.getBoundingClientRect();return Ye(d,c,i)}function Hn(d,i){const c=d.getBoundingClientRect(),f=[];for(let y=0;y<i.length;y++)f.push(Ye(d,c,i[y]));return f}function Ln(d){return void 0!==a.window.InstallTrigger&&2===d.button&&d.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function Ye(d,i,c){const f=d.offsetWidth===i.width?1:d.offsetWidth/i.width;return new a.pointGeometry((c.clientX-i.left)*f,(c.clientY-i.top)*f)}function Ce(d,i){var c=i[0],f=i[1],y=i[2],x=i[3],D=c*x-y*f;return D?(d[0]=x*(D=1/D),d[1]=-f*D,d[2]=-y*D,d[3]=c*D,d):null}function we(d){const{userImage:i}=d;return!!(i&&i.render&&i.render())&&(d.data.replace(new Uint8Array(i.data.buffer)),!0)}class At extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:f}of this.requestors)this._notify(c,f);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let f=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),f=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),f=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),f=!1),f}_validateStretch(i,c){if(!i)return!0;let f=0;for(const y of i){if(y[0]<f||y[1]<y[0]||c<y[1])return!1;f=y[1]}return!0}_validateContent(i,c){return!(i&&(4!==i.length||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let f=!0;if(!this.isLoaded())for(const y of i)this.images[y]||(f=!1);this.isLoaded()||f?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const f={};for(const y of i){this.images[y]||this.fire(new a.Event("styleimagemissing",{id:y}));const x=this.images[y];x?f[y]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:Boolean(x.userImage&&x.userImage.render)}:a.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,f)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],f=this.getImage(i);if(!f)return null;if(c&&c.position.version===f.version)return c.position;if(c)c.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},x=new a.ImagePosition(y,f);this.patterns[i]={bin:y,position:x}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const x in this.patterns)i.push(this.patterns[x].bin);const{w:c,h:f}=a.potpack(i),y=this.atlasImage;y.resize({width:c||1,height:f||1});for(const x in this.patterns){const{bin:D}=this.patterns[x],P=D.x+1,F=D.y+1,W=this.images[x].data,Z=W.width,ie=W.height;a.RGBAImage.copy(W,y,{x:0,y:0},{x:P,y:F},{width:Z,height:ie}),a.RGBAImage.copy(W,y,{x:0,y:ie-1},{x:P,y:F-1},{width:Z,height:1}),a.RGBAImage.copy(W,y,{x:0,y:0},{x:P,y:F+ie},{width:Z,height:1}),a.RGBAImage.copy(W,y,{x:Z-1,y:0},{x:P-1,y:F},{width:1,height:ie}),a.RGBAImage.copy(W,y,{x:0,y:0},{x:P+Z,y:F},{width:1,height:ie})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const f=this.images[c];we(f)&&this.updateImage(c,f)}}}const zt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(d,i){return function([c,f,y]){const x=a.degToRad(f+90),D=a.degToRad(y);return{x:c*Math.cos(x)*Math.sin(D),y:c*Math.sin(x)*Math.sin(D),z:c*Math.cos(D),azimuthal:f,polar:y}}(d.expression.evaluate(i))}interpolate(d,i,c){return{x:a.number(d.x,i.x,c),y:a.number(d.y,i.y,c),z:a.number(d.z,i.z,c),azimuthal:a.number(d.azimuthal,i.azimuthal,c),polar:a.number(d.polar,i.polar,c)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Jt="-transition";class Cn extends a.Evented{constructor(i){super(),this._transitionable=new a.Transitionable(zt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(a.validateLight,i,c))for(const f in i){const y=i[f];a.endsWith(f,Jt)?this._transitionable.setTransition(f.slice(0,-Jt.length),y):this._transitionable.setValue(f,y)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,f){return(!f||!1!==f.validate)&&a.emitValidationErrors(this,i.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Ke=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),Ne="-transition";class He extends a.Evented{constructor(i,c){super(),this._transitionable=new a.Transitionable(Ke),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(i){for(const c in i){const f=i[c];a.endsWith(c,Ne)?this._transitionable.setTransition(c.slice(0,-Ne.length),f):this._transitionable.setValue(c,f)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function _t(d,i,c,f){const y=a.smoothstep(45,65,c),[x,D]=Dn(d,f),P=a.length(i);let F=1-Math.min(1,Math.exp((P-x)/(D-x)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*y*d.alpha}function Dn(d,i){const c=.5/Math.tan(.5*i);return[d.range[0]+c,d.range[1]+c]}const Xt=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),ii="-transition";class vi extends a.Evented{constructor(i,c){super(),this._transitionable=new a.Transitionable(Xt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const i=this._transform,c="globe"===i.projection.name,f=a.globeToMercatorTransition(i.zoom),y=this.properties.get("range"),x=[.5,3];return{range:c?[a.number(x[0],y[0],f),a.number(x[1],y[1],f)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(a.validateFog,i,c)){for(const f of Object.keys(a.spec.fog))i&&void 0===i[f]&&(i[f]=a.spec.fog[f].default);for(const f in i){const y=i[f];a.endsWith(f,ii)?this._transitionable.setTransition(f.slice(0,-ii.length),y):this._transitionable.setValue(f,y)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:a.smoothstep(45,65,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(f,y,x){const D=a.MercatorCoordinate.fromLngLat(y),P=x.elevation?x.elevation.getAtPointOrZero(D):0,F=[D.x,D.y,P];return a.transformMat4(F,F,x.mercatorFogMatrix),_t(f,F,x.pitch,x._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?Dn(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,f){return(!f||!1!==f.validate)&&a.emitValidationErrors(this,i.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class wi{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const f=this.workerPool.acquire(this.id);for(let y=0;y<f.length;y++){const x=new wi.Actor(f[y],c,this.id);x.name=`Worker ${y}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,f){a.asyncAll(this.actors,(y,x)=>{y.send(i,c,x)},f=f||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Nn(d,i,c){return i*(a.EXTENT/(d.tileSize*Math.pow(2,c-d.tileID.overscaledZ)))}wi.Actor=a.Actor;class Bi{constructor(i,c,f,y){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=f,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(i,c){let f,y;if(i instanceof a.pointGeometry||"number"==typeof i[0]){const x=a.pointGeometry.convert(i);f=[x],y=c.isPointAboveHorizon(x)}else{const x=a.pointGeometry.convert(i[0]),D=a.pointGeometry.convert(i[1]);f=[x,D],y=a.polygonizeBounds(x,D).every(P=>c.isPointAboveHorizon(P))}return new Bi(f,c.getCameraPoint(),y,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return a.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],f=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],y=a.polygonizeBounds(c,f,0,!1);return this.cameraPoint.y>f.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<f.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=f.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),a.bufferConvexPolygon(y,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],f=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],y=a.polygonizeBounds(c,f,i),x=this.cameraPoint.clone();switch(3*((x.y>c.y)+(x.y>f.y))+((x.x>c.x)+(x.x>f.x))){case 0:y[0]=x,y[4]=x.clone();break;case 1:y.splice(1,0,x);break;case 2:y[1]=x;break;case 3:y.splice(4,0,x);break;case 5:y.splice(2,0,x);break;case 6:y[3]=x;break;case 7:y.splice(3,0,x);break;case 8:y[2]=x}return y}containsTile(i,c,f,y=0){const x=i.queryPadding/c._pixelsPerMercatorPixel+1,D=f?this._bufferedCameraMercator(x,c):this._bufferedScreenMercator(x,c);let P=i.tileID.wrap+(D.unwrapped?y:0);const F=D.polygon.map(Te=>a.getTilePoint(i.tileTransform,Te,P));if(!a.polygonIntersectsBox(F,0,0,a.EXTENT,a.EXTENT))return;P=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const W=this.screenGeometryMercator.polygon.map(Te=>a.getTileVec3(i.tileTransform,Te,P)),Z=W.map(Te=>new a.pointGeometry(Te[0],Te[1])),ie=c.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),ve=a.getTileVec3(i.tileTransform,ie,P),Pe=W.map(Te=>{const Ae=a.sub(Te,Te,ve);return a.normalize(Ae,Ae),new a.Ray(ve,Ae)}),Oe=Nn(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Z,tilespaceRays:Pe,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(Be=a.getBounds(F),Be.min.x=a.clamp(Be.min.x,0,a.EXTENT),Be.min.y=a.clamp(Be.min.y,0,a.EXTENT),Be.max.x=a.clamp(Be.max.x,0,a.EXTENT),Be.max.y=a.clamp(Be.max.y,0,a.EXTENT),Be),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:Oe};var Be}_bufferedScreenMercator(i,c){const f=Tt(i);if(this._screenRaycastCache[f])return this._screenRaycastCache[f];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[f]=y,y}}_bufferedCameraMercator(i,c){const f=Tt(i);if(this._cameraRaycastCache[f])return this._cameraRaycastCache[f];{let y;return y="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[f]=y,y}}_projectAndResample(i,c){const f=function(x,D){const P=a.multiply([],D.pixelMatrix,D.globeMatrix),F=[0,-a.GLOBE_RADIUS,0,1],W=[0,a.GLOBE_RADIUS,0,1],Z=[0,0,0,1];a.transformMat4$1(F,F,P),a.transformMat4$1(W,W,P),a.transformMat4$1(Z,Z,P);const ie=new a.pointGeometry(F[0]/F[3],F[1]/F[3]),ve=new a.pointGeometry(W[0]/W[3],W[1]/W[3]),Pe=a.polygonContainsPoint(x,ie)&&F[3]<Z[3],Oe=a.polygonContainsPoint(x,ve)&&W[3]<Z[3];if(!Pe&&!Oe)return null;const Be=function(Ut,ln,rn){for(let $t=1;$t<Ut.length;$t++){const qn=fn(ln.pointCoordinate3D(Ut[$t-1]).x),Kt=fn(ln.pointCoordinate3D(Ut[$t]).x);if(rn<0){if(qn<Kt)return{idx:$t,t:-qn/(Kt-1-qn)}}else if(Kt<qn)return{idx:$t,t:(1-qn)/(Kt+1-qn)}}return null}(x,D,Pe?-1:1);if(!Be)return null;const{idx:Te,t:Ae}=Be;let je=Te>1?Jn(x.slice(0,Te),D):[],ze=Te<x.length?Jn(x.slice(Te),D):[];je=je.map(Ut=>new a.pointGeometry(fn(Ut.x),Ut.y)),ze=ze.map(Ut=>new a.pointGeometry(fn(Ut.x),Ut.y));const st=[...je];0===st.length&&st.push(ze[ze.length-1]);const Dt=a.number(st[st.length-1].y,(0===ze.length?je[0]:ze[0]).y,Ae);let vt;return vt=Pe?[new a.pointGeometry(0,Dt),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,Dt)]:[new a.pointGeometry(1,Dt),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,Dt)],st.push(...vt),0===ze.length?st.push(je[0]):st.push(...ze),{polygon:st.map(Ut=>new a.MercatorCoordinate(Ut.x,Ut.y)),unwrapped:!1}}(i,c);if(f)return f;const y=function(x,D){let P=!1,F=-1/0,W=0;for(let ie=0;ie<x.length-1;ie++)x[ie].x>F&&(F=x[ie].x,W=ie);for(let ie=0;ie<x.length-1;ie++){const ve=(W+ie)%(x.length-1),Pe=x[ve],Oe=x[ve+1];Math.abs(Pe.x-Oe.x)>.5&&(Pe.x<Oe.x?(Pe.x+=1,0===ve&&(x[x.length-1].x+=1)):(Oe.x+=1,ve+1===x.length-1&&(x[0].x+=1)),P=!0)}const Z=a.mercatorXfromLng(D.center.lng);return P&&Z<Math.abs(Z-1)&&x.forEach(ie=>{ie.x-=1}),{polygon:x,unwrapped:P}}(Jn(i,c).map(x=>new a.pointGeometry(fn(x.x),x.y)),c);return{polygon:y.polygon.map(x=>new a.MercatorCoordinate(x.x,x.y)),unwrapped:y.unwrapped}}}function Jn(d,i){return a.resample(d,c=>{const f=i.pointCoordinate3D(c);c.x=f.x,c.y=f.y},1/256)}function fn(d){return d<0?1+d%1:d%1}function Tt(d){return 100*d|0}function Ge(d,i,c,f,y){const x=function(D,P){if(D)return y(D);if(P){d.url&&P.tiles&&d.tiles&&delete d.tiles;const F=a.pick(a.extend(P,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(F.vectorLayers=P.vector_layers,F.vectorLayerIds=F.vectorLayers.map(W=>W.id)),F.tiles=i.canonicalizeTileset(F,d.url),y(null,F)}};return d.url?a.getJSON(i.transformRequest(i.normalizeSourceURL(d.url,null,c,f),a.ResourceType.Source),x):a.exported.frame(()=>x(null,d))}class Fe{constructor(i,c,f){this.bounds=a.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=f||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),f=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),y=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),x=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),D=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=f&&i.x<x&&i.y>=y&&i.y<D}}class ht{constructor(i,c,f){this.context=i;const y=i.gl;this.buffer=y.createBuffer(),this.dynamicDraw=Boolean(f),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ce{constructor(i,c,f,y){this.length=c.length,this.attributes=f,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.context=i;const x=i.gl;this.buffer=x.createBuffer(),i.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let f=0;f<this.attributes.length;f++){const y=c.attributes[this.attributes[f].name];void 0!==y&&i.enableVertexAttribArray(y)}}setVertexAttribPointers(i,c,f){for(let y=0;y<this.attributes.length;y++){const x=this.attributes[y],D=c.attributes[x.name];void 0!==D&&i.vertexAttribPointer(D,x.components,i[Xe[x.type]],!1,this.itemSize,x.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ot{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Se extends ot{getDefault(){return a.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class St extends ot{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class tn extends ot{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class li extends ot{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Wi extends ot{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Mn extends ot{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class ae extends ot{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class $e extends ot{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Rt extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class on extends ot{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class jt extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class Bt extends ot{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Je extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class ge extends ot{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class fe extends ot{getDefault(){return a.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class te extends ot{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class nt extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class Ht extends ot{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Rn extends ot{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class ni extends ot{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Oi extends ot{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class xn extends ot{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Ji extends ot{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Hi extends ot{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class un extends ot{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Pt extends ot{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class lt extends ot{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class nn extends ot{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class _i extends ot{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Qt extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class xt extends ot{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class pt extends ot{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Yt extends pt{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class bn extends pt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class ri extends bn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ee{constructor(i,c,f,y){this.context=i,this.width=c,this.height=f;const x=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Yt(i,x),y&&(this.depthAttachment=new bn(i,x))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const f=this.depthAttachment.get();f&&i.deleteRenderbuffer(f)}i.deleteFramebuffer(this.framebuffer)}}class ee{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Se(this),this.clearDepth=new St(this),this.clearStencil=new tn(this),this.colorMask=new li(this),this.depthMask=new Wi(this),this.stencilMask=new Mn(this),this.stencilFunc=new ae(this),this.stencilOp=new $e(this),this.stencilTest=new Rt(this),this.depthRange=new on(this),this.depthTest=new jt(this),this.depthFunc=new Bt(this),this.blend=new Je(this),this.blendFunc=new ge(this),this.blendColor=new fe(this),this.blendEquation=new te(this),this.cullFace=new nt(this),this.cullFaceSide=new Ht(this),this.frontFace=new Rn(this),this.program=new ni(this),this.activeTexture=new Oi(this),this.viewport=new xn(this),this.bindFramebuffer=new Ji(this),this.bindRenderbuffer=new Hi(this),this.bindTexture=new un(this),this.bindVertexBuffer=new Pt(this),this.bindElementBuffer=new lt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new nn(this),this.pixelStoreUnpack=new _i(this),this.pixelStoreUnpackPremultiplyAlpha=new Qt(this),this.pixelStoreUnpackFlipY=new xt(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new ht(this,i,c)}createVertexBuffer(i,c,f){return new ce(this,i,c,f)}createRenderbuffer(i,c,f){const y=this.gl,x=y.createRenderbuffer();return this.bindRenderbuffer.set(x),y.renderbufferStorage(y.RENDERBUFFER,i,c,f),this.bindRenderbuffer.set(null),x}createFramebuffer(i,c,f){return new Ee(this,i,c,f)}clear({color:i,depth:c,stencil:f}){const y=this.gl;let x=0;i&&(x|=y.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(x|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==f&&(x|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(x)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){de(i.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class oe extends a.Evented{constructor(i,c,f,y){super(),this.id=i,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ge(this._options,this.map._requestManager,null,null,(i,c)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new a.ErrorEvent(i)):c&&(a.extend(this,c),c.bounds&&(this.tileBounds=new Fe(c.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(c.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const f=a.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),f,this.tileSize);i.request=a.getImage(this.map._requestManager.transformRequest(y,a.ResourceType.Tile),(x,D,P,F)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):x?(i.state="errored",c(x)):D?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:P,expires:F}),i.setTexture(D,this.map.painter),i.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(i,c,f){i.setTexture(c,f)}static unloadTileData(i,c){i.texture&&c.saveTileTexture(i.texture)}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}}let Me;function Ve(d,i,c,f,y,x,D,P){const F=[d,c,y,i,f,x,1,1,1],W=[D,P,1],Z=a.adjoint([],F),[ie,ve,Pe]=a.transformMat3(W,W,a.transpose(Z,Z));return a.multiply$1(F,[ie,0,0,0,ve,0,0,0,Pe],F)}class ct extends a.Evented{constructor(i,c,f,y){super(),this.id=i,this.dispatcher=f,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=c,this._dirty=!1}load(i,c){this._loaded=c||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(f,y)=>{if(this._imageRequest=null,this._loaded=!0,f)this.fire(new a.ErrorEvent(f));else if(y){const{HTMLImageElement:x}=a.window;this.image=y instanceof x?a.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const c=i.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(f){let y=1/0,x=1/0,D=-1/0,P=-1/0;for(const ie of f)y=Math.min(y,ie.x),x=Math.min(x,ie.y),D=Math.max(D,ie.x),P=Math.max(P,ie.y);const F=Math.max(D-y,P-x),W=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),Z=Math.pow(2,W);return new a.CanonicalTileID(W,Math.floor((y+D)/2*Z),Math.floor((x+P)/2*Z))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const F in this.tiles){const W=this.tiles[F];"loaded"!==W.state&&(W.state="loaded",W.texture=this.texture)}if(this._boundsArray)return;const c=a.tileTransform(this.tileID,this.map.transform.projection),[f,y,x,D]=this.coordinates.map(F=>{const W=c.projection.project(F[0],F[1]);return a.getTilePoint(c,W)._round()});this.perspectiveTransform=function(F,W,Z,ie,ve,Pe,Oe,Be,Te,Ae){const je=Ve(0,0,F,0,0,W,F,W),ze=Ve(Z,ie,ve,Pe,Oe,Be,Te,Ae);return a.multiply$1(ze,a.adjoint(je,je),ze),[ze[6]/ze[8]*F/a.EXTENT,ze[7]/ze[8]*W/a.EXTENT]}(this.width,this.height,f.x,f.y,y.x,y.y,D.x,D.y,x.x,x.y);const P=this._boundsArray=new a.StructArrayLayout4i8;P.emplaceBack(f.x,f.y,0,0),P.emplaceBack(y.x,y.y,a.EXTENT,0),P.emplaceBack(D.x,D.y,0,a.EXTENT),P.emplaceBack(x.x,x.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(P,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,c=i.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(i)}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Lt={vector:class extends a.Evented{constructor(d,i,c,f){if(super(),this.id=d,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(i,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(d){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map._worldview;this._tileJSONRequest=Ge(this._options,this.map._requestManager,i,c,(f,y)=>{this._tileJSONRequest=null,this._loaded=!0,f?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),c&&2!==c.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new a.ErrorEvent(f))):y&&(a.extend(this,y),y.bounds&&(this.tileBounds=new Fe(y.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(y.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),d&&d(f)})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const d=this.map.style._getSourceCaches(this.id);for(const i of d)i.clearTiles()})}setSourceProperty(d){d(),this.reload()}setTiles(d){return this._options.tiles=d,this.reload(),this}setUrl(d){return this.url=d,this._options.url=d,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(d,i){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),f={request:this.map._requestManager.transformRequest(c,a.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(f.request.collectResourceTiming=this._collectResourceTiming,d.actor&&"expired"!==d.state)"loading"===d.state?d.reloadCallback=i:d.request=d.actor.send("reloadTile",f,y.bind(this));else if(d.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",f,y.bind(this),void 0,!0);else{const x=a.loadVectorTile.call({deduped:this._deduped},f,(D,P)=>{D||!P?y.call(this,D):(f.data={cacheControl:P.cacheControl,expires:P.expires,rawData:P.rawData.slice(0)},d.actor&&d.actor.send("loadTile",f,y.bind(this),void 0,!0))},!0);d.request={cancel:x}}function y(x,D){return delete d.request,d.aborted?i(null):x&&404!==x.status?i(x):(D&&D.resourceTiming&&(d.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&d.setExpiryData(D),d.loadVectorData(D,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:oe,"raster-dem":class extends oe{constructor(d,i,c,f){super(d,i,c,f),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(d,i){const c=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function f(y,x){y&&(d.state="errored",i(y)),x&&(d.dem=x,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",i(null))}d.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),function(y,x,D,P){if(delete d.request,d.aborted)d.state="unloaded",i(null);else if(y)d.state="errored",i(y);else if(x){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:D,expires:P});const F=a.window.ImageBitmap&&x instanceof a.window.ImageBitmap&&(null==Me&&(Me=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.window.createImageBitmap),Me),W=1-(x.width-a.prevPowerOfTwo(x.width))/2;W<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const Z=F?x:a.exported.getImageData(x,W),ie={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:Z,encoding:this.encoding,padding:W};d.actor&&"expired"!==d.state||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",ie,f.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const i=d.canonical,c=Math.pow(2,i.z),f=(i.x-1+c)%c,y=0===i.x?d.wrap-1:d.wrap,x=(i.x+1+c)%c,D=i.x+1===c?d.wrap+1:d.wrap,P={};return P[new a.OverscaledTileID(d.overscaledZ,y,i.z,f,i.y).key]={backfilled:!1},P[new a.OverscaledTileID(d.overscaledZ,D,i.z,x,i.y).key]={backfilled:!1},i.y>0&&(P[new a.OverscaledTileID(d.overscaledZ,y,i.z,f,i.y-1).key]={backfilled:!1},P[new a.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},P[new a.OverscaledTileID(d.overscaledZ,D,i.z,x,i.y-1).key]={backfilled:!1}),i.y+1<c&&(P[new a.OverscaledTileID(d.overscaledZ,y,i.z,f,i.y+1).key]={backfilled:!1},P[new a.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},P[new a.OverscaledTileID(d.overscaledZ,D,i.z,x,i.y+1).key]={backfilled:!1}),P}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends a.Evented{constructor(d,i,c,f){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(f),this._data=i.data,this._options=a.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const y=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*y,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*y,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*y,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},i),this}getClusterChildren(d,i){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},i),this}getClusterLeaves(d,i,c,f){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:i,offset:c},f),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=a.extend({},this.workerOptions),i=this._data;"string"==typeof i?(d.request=this.map._requestManager.transformRequest(a.exported.resolveURL(i),a.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(c,f)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new a.ErrorEvent(c));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&f&&f.resourceTiming&&f.resourceTiming[this.id]&&(y.resourceTiming=f.resourceTiming[this.id]),this.fire(new a.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,i){const c=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(c,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(f,y)=>(delete d.request,d.unloadVectorData(),d.aborted?i(null):f?i(f):(d.loadVectorData(y,this.map.painter,"reloadTile"===c),i(null))),void 0,"loadTile"===c)}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends ct{constructor(d,i,c,f){super(d,i,c,f),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const i of d.urls)this.urls.push(this.map._requestManager.transformRequest(i,a.ResourceType.Source).url);a.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new a.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const i=this.video.seekable;d<i.start(0)||d>i.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const d=this.map.painter.context,i=d.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(d,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:ct,canvas:class extends ct{constructor(d,i,c,f){super(d,i,c,f),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(y=>!Array.isArray(y)||2!==y.length||y.some(x=>"number"!=typeof x))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends a.Evented{constructor(d,i,c,f){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(f),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Fe(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:i,y:c,z:f}=d.canonical;return this._implementation.hasTile({x:i,y:c,z:f})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,i){const{x:c,y:f,z:y}=d.tileID.canonical,x=new a.window.AbortController;d.request=Promise.resolve(this._implementation.loadTile({x:c,y:f,z:y},{signal:x.signal})).then(function(D){return delete d.request,d.aborted?(d.state="unloaded",i(null)):void 0===D?(d.state="errored",i(null)):null===D?(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",i(null)):(P=D)instanceof a.window.ImageData||P instanceof a.window.HTMLCanvasElement||P instanceof a.window.ImageBitmap||P instanceof a.window.HTMLImageElement?(this.loadTileData(d,D),d.state="loaded",void i(null)):(d.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var P}.bind(this)).catch(D=>{20!==D.code&&(d.state="errored",i(D))}),d.request.cancel=()=>x.abort()}loadTileData(d,i){oe.loadTileData(d,i,this._map.painter)}unloadTileData(d){oe.unloadTileData(d,this._map.painter)}unloadTile(d,i){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:c,y:f,z:y}=d.tileID.canonical;this._implementation.unloadTile({x:c,y:f,z:y})}i()}abortTile(d,i){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ft=function(d,i,c,f){const y=new Lt[i.type](d,i,c,f);if(y.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${y.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],y),y};function Mt(d,i){const c=a.identity([]);return a.scale(c,c,[.5*d.width,.5*-d.height,1]),a.translate(c,c,[1,-1,0]),a.multiply(c,c,d.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(c)}function le(d,i,c,f,y,x,D,P=!1){const F=d.tilesIn(f,D,P);F.sort(he);const W=[];for(const ie of F)W.push({wrappedTileID:ie.tile.tileID.wrapped().key,queryResults:ie.tile.queryRenderedFeatures(i,c,d._state,ie,y,x,Mt(d.transform,ie.tile.tileID),P)});const Z=function(ie){const ve={},Pe={};for(const Oe of ie){const Be=Oe.queryResults,Te=Oe.wrappedTileID,Ae=Pe[Te]=Pe[Te]||{};for(const je in Be){const ze=Be[je],st=Ae[je]=Ae[je]||{},Dt=ve[je]=ve[je]||[];for(const vt of ze)st[vt.featureIndex]||(st[vt.featureIndex]=!0,Dt.push(vt))}}return ve}(W);for(const ie in Z)Z[ie].forEach(ve=>{const Pe=ve.feature,Oe=Pe.layer;Oe&&"background"!==Oe.type&&"sky"!==Oe.type&&(Pe.source=Oe.source,Oe["source-layer"]&&(Pe.sourceLayer=Oe["source-layer"]),Pe.state=void 0!==Pe.id?d.getFeatureState(Oe["source-layer"],Pe.id):{})});return Z}function _e(d,i){const c=d.getRenderableIds().map(x=>d.getTileByID(x)),f=[],y={};for(let x=0;x<c.length;x++){const D=c[x],P=D.tileID.canonical.key;y[P]||(y[P]=!0,D.querySourceFeatures(f,i))}return f}function he(d,i){const c=d.tileID,f=i.tileID;return c.overscaledZ-f.overscaledZ||c.canonical.y-f.canonical.y||c.wrap-f.wrap||c.canonical.x-f.canonical.x}function Ue(){return null!=ta.workerClass?new ta.workerClass:new a.window.Worker(ta.workerUrl)}const Zt="mapboxgl_preloaded_worker_pool";class Tn{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Tn.workerCount;)this.workers.push(new Ue);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Zt]}numActive(){return Object.keys(this.active).length}}let jn;function Xn(){return jn||(jn=new Tn),jn}function Ai(d,i){const c={};for(const f in d)"ref"!==f&&(c[f]=d[f]);return a.refProperties.forEach(f=>{f in i&&(c[f]=i[f])}),c}function Ri(d){d=d.slice();const i=Object.create(null);for(let c=0;c<d.length;c++)i[d[c].id]=d[c];for(let c=0;c<d.length;c++)"ref"in d[c]&&(d[c]=Ai(d[c],i[d[c].ref]));return d}Tn.workerCount=2;const Gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function er(d,i,c){c.push({command:Gn.addSource,args:[d,i[d]]})}function qi(d,i,c){i.push({command:Gn.removeSource,args:[d]}),c[d]=!0}function fo(d,i,c,f){qi(d,c,f),er(d,i,c)}function Xr(d,i,c){let f;for(f in d[c])if(d[c].hasOwnProperty(f)&&"data"!==f&&!de(d[c][f],i[c][f]))return!1;for(f in i[c])if(i[c].hasOwnProperty(f)&&"data"!==f&&!de(d[c][f],i[c][f]))return!1;return!0}function Cr(d,i,c,f,y,x){let D;for(D in i=i||{},d=d||{})d.hasOwnProperty(D)&&(de(d[D],i[D])||c.push({command:x,args:[f,D,i[D],y]}));for(D in i)i.hasOwnProperty(D)&&!d.hasOwnProperty(D)&&(de(d[D],i[D])||c.push({command:x,args:[f,D,i[D],y]}))}function _n(d){return d.id}function So(d,i){return d[i.id]=i,d}class tr{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=a.clamp(i,0,1);let c=1,f=this._distances[c];const y=i*this.paddedLength+this.padding;for(;f<y&&c<this._distances.length;)f=this._distances[++c];const x=c-1,D=this._distances[x],P=f-D,F=P>0?(y-D)/P:0;return this.points[x].mult(1-F).add(this.points[c].mult(F))}}class Ao{constructor(i,c,f){const y=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(i/f),this.yCellCount=Math.ceil(c/f);for(let D=0;D<this.xCellCount*this.yCellCount;D++)y.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,f,y,x){this._forEachCell(c,f,y,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(x)}insertCircle(i,c,f,y){this._forEachCell(c-y,f-y,c+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(f),this.circles.push(y)}_insertBoxCell(i,c,f,y,x,D){this.boxCells[x].push(D)}_insertCircleCell(i,c,f,y,x,D){this.circleCells[x].push(D)}_query(i,c,f,y,x,D){if(f<0||i>this.width||y<0||c>this.height)return!x&&[];const P=[];if(i<=0&&c<=0&&this.width<=f&&this.height<=y){if(x)return!0;for(let F=0;F<this.boxKeys.length;F++)P.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const W=this.circles[3*F],Z=this.circles[3*F+1],ie=this.circles[3*F+2];P.push({key:this.circleKeys[F],x1:W-ie,y1:Z-ie,x2:W+ie,y2:Z+ie})}return D?P.filter(D):P}return this._forEachCell(i,c,f,y,this._queryCell,P,{hitTest:x,seenUids:{box:{},circle:{}}},D),x?P.length>0:P}_queryCircle(i,c,f,y,x){const D=i-f,P=i+f,F=c-f,W=c+f;if(P<0||D>this.width||W<0||F>this.height)return!y&&[];const Z=[];return this._forEachCell(D,F,P,W,this._queryCellCircle,Z,{hitTest:y,circle:{x:i,y:c,radius:f},seenUids:{box:{},circle:{}}},x),y?Z.length>0:Z}query(i,c,f,y,x){return this._query(i,c,f,y,!1,x)}hitTest(i,c,f,y,x){return this._query(i,c,f,y,!0,x)}hitTestCircle(i,c,f,y){return this._queryCircle(i,c,f,!0,y)}_queryCell(i,c,f,y,x,D,P,F){const W=P.seenUids,Z=this.boxCells[x];if(null!==Z){const ve=this.bboxes;for(const Pe of Z)if(!W.box[Pe]){W.box[Pe]=!0;const Oe=4*Pe;if(i<=ve[Oe+2]&&c<=ve[Oe+3]&&f>=ve[Oe+0]&&y>=ve[Oe+1]&&(!F||F(this.boxKeys[Pe]))){if(P.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[Pe],x1:ve[Oe],y1:ve[Oe+1],x2:ve[Oe+2],y2:ve[Oe+3]})}}}const ie=this.circleCells[x];if(null!==ie){const ve=this.circles;for(const Pe of ie)if(!W.circle[Pe]){W.circle[Pe]=!0;const Oe=3*Pe;if(this._circleAndRectCollide(ve[Oe],ve[Oe+1],ve[Oe+2],i,c,f,y)&&(!F||F(this.circleKeys[Pe]))){if(P.hitTest)return D.push(!0),!0;{const Be=ve[Oe],Te=ve[Oe+1],Ae=ve[Oe+2];D.push({key:this.circleKeys[Pe],x1:Be-Ae,y1:Te-Ae,x2:Be+Ae,y2:Te+Ae})}}}}}_queryCellCircle(i,c,f,y,x,D,P,F){const W=P.circle,Z=P.seenUids,ie=this.boxCells[x];if(null!==ie){const Pe=this.bboxes;for(const Oe of ie)if(!Z.box[Oe]){Z.box[Oe]=!0;const Be=4*Oe;if(this._circleAndRectCollide(W.x,W.y,W.radius,Pe[Be+0],Pe[Be+1],Pe[Be+2],Pe[Be+3])&&(!F||F(this.boxKeys[Oe])))return D.push(!0),!0}}const ve=this.circleCells[x];if(null!==ve){const Pe=this.circles;for(const Oe of ve)if(!Z.circle[Oe]){Z.circle[Oe]=!0;const Be=3*Oe;if(this._circlesCollide(Pe[Be],Pe[Be+1],Pe[Be+2],W.x,W.y,W.radius)&&(!F||F(this.circleKeys[Oe])))return D.push(!0),!0}}}_forEachCell(i,c,f,y,x,D,P,F){const W=this._convertToXCellCoord(i),Z=this._convertToYCellCoord(c),ie=this._convertToXCellCoord(f),ve=this._convertToYCellCoord(y);for(let Pe=W;Pe<=ie;Pe++)for(let Oe=Z;Oe<=ve;Oe++)if(x.call(this,i,c,f,y,this.xCellCount*Oe+Pe,D,P,F))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,f,y,x,D){const P=y-i,F=x-c,W=f+D;return W*W>P*P+F*F}_circleAndRectCollide(i,c,f,y,x,D,P){const F=(D-y)/2,W=Math.abs(i-(y+F));if(W>F+f)return!1;const Z=(P-x)/2,ie=Math.abs(c-(x+Z));if(ie>Z+f)return!1;if(W<=F||ie<=Z)return!0;const ve=W-F,Pe=ie-Z;return ve*ve+Pe*Pe<=f*f}}const wa=Math.tan(85*Math.PI/180);function Yi(d,i,c,f,y,x,D){const P=a.create();if(c)if("globe"===x.name){const F=a.calculateGlobeLabelMatrix(y,i);a.multiply(P,P,F)}else{const F=Ce([],D);P[0]=F[0],P[1]=F[1],P[4]=F[2],P[5]=F[3],f||a.rotateZ(P,P,y.angle)}else a.multiply(P,y.labelPlaneMatrix,d);return P}function gs(d,i,c,f,y,x,D){const P=Yi(d,i,c,f,y,x,D);return"globe"===x.name&&c||(P[2]=P[6]=P[10]=P[14]=0),P}function kn(d,i,c,f,y,x,D){if(c){if("globe"===x.name){const P=Yi(d,i,c,f,y,x,D);return a.invert(P,P),a.multiply(P,d,P),P}{const P=a.clone(d),F=a.identity([]);return F[0]=D[0],F[1]=D[1],F[4]=D[2],F[5]=D[3],a.multiply(P,P,F),f||a.rotateZ(P,P,-y.angle),P}}return y.glCoordMatrix}function hn(d,i,c,f){const y=[d,i,c,1];c?a.transformMat4$1(y,y,f):pr(y,y,f);const x=y[3];return y[0]/=x,y[1]/=x,y[2]/=x,y}function Ie(d,i){return Math.min(.5+d/i*.5,1.5)}function Gt(d,i){const c=d[0]/d[3],f=d[1]/d[3];return c>=-i[0]&&c<=i[0]&&f>=-i[1]&&f<=i[1]}function Fn(d,i,c,f,y,x,D,P,F,W){const Z=c.transform,ie=f?d.textSizeData:d.iconSizeData,ve=a.evaluateSizeForZoom(ie,c.transform.zoom),Pe="globe"===Z.projection.name,Oe=[256/c.width*2+1,256/c.height*2+1],Be=f?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;Be.clear();let Te=null;Pe&&(Te=f?d.text.globeExtVertexArray:d.icon.globeExtVertexArray);const Ae=d.lineVertexArray,je=f?d.text.placedSymbolArray:d.icon.placedSymbolArray,ze=c.transform.width/c.transform.height;let st,Dt=!1;for(let vt=0;vt<je.length;vt++){const Ut=je.get(vt),{numGlyphs:ln,writingMode:rn}=Ut;if(rn!==a.WritingMode.vertical||Dt||st===a.WritingMode.horizontal||(Dt=!0),st=rn,(Ut.hidden||rn===a.WritingMode.vertical)&&!Dt){Br(ln,Be);continue}Dt=!1;const $t=new a.pointGeometry(Ut.tileAnchorX,Ut.tileAnchorY);let{x:qn,y:Kt,z:Pn}=Z.projection.projectTilePoint($t.x,$t.y,W.canonical);if(F){const[ki,Ci,ji]=F($t);qn+=ki,Kt+=Ci,Pn+=ji}const mn=[qn,Kt,Pn,1];if(a.transformMat4$1(mn,mn,i),!Gt(mn,Oe)){Br(ln,Be);continue}const Wn=Ie(c.transform.cameraToCenterDistance,mn[3]),pn=a.evaluateSizeForFeature(ie,ve,Ut),Un=D?pn/Wn:pn*Wn,Qn=hn(qn,Kt,Pn,y);if(Qn[3]<=0){Br(ln,Be);continue}let qt={};const dn=D?null:F,Ei=mi(Ut,Un,!1,P,i,y,x,d.glyphOffsetArray,Ae,Be,Te,Qn,$t,qt,ze,dn,Z.projection,W,D);Dt=Ei.useVertical,dn&&Ei.needsFlipping&&(qt={}),(Ei.notEnoughRoom||Dt||Ei.needsFlipping&&mi(Ut,Un,!0,P,i,y,x,d.glyphOffsetArray,Ae,Be,Te,Qn,$t,qt,ze,dn,Z.projection,W,D).notEnoughRoom)&&Br(ln,Be)}f?(d.text.dynamicLayoutVertexBuffer.updateData(Be),Te&&d.text.globeExtVertexBuffer.updateData(Te)):(d.icon.dynamicLayoutVertexBuffer.updateData(Be),Te&&d.icon.globeExtVertexBuffer.updateData(Te))}function hi(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be){const{lineStartIndex:Te,glyphStartIndex:Ae,segment:je}=P,ze=Ae+P.numGlyphs,st=Te+P.lineLength,Dt=i.getoffsetX(Ae),vt=i.getoffsetX(ze-1),Ut=to(d*Dt,c,f,y,x,D,je,Te,st,F,W,Z,ie,ve,!0,Pe,Oe,Be);if(!Ut)return null;const ln=to(d*vt,c,f,y,x,D,je,Te,st,F,W,Z,ie,ve,!0,Pe,Oe,Be);return ln?{first:Ut,last:ln}:null}function Ti(d,i,c,f){return d===a.WritingMode.horizontal&&Math.abs(f)>Math.abs(c)?{useVertical:!0}:d===a.WritingMode.vertical?f>0?{needsFlipping:!0}:null:0!==i&&(0===(y=c)||Math.abs(f/y)>wa)?1===i?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var y}function mi(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be,Te,Ae,je){const ze=i/24,st=d.lineOffsetX*ze,Dt=d.lineOffsetY*ze,{lineStartIndex:vt,glyphStartIndex:Ut,numGlyphs:ln,segment:rn,writingMode:$t,flipState:qn}=d,Kt=vt+d.lineLength,Pn=mn=>{if(Z){const[Qn,qt,dn]=mn.up,Ei=W.length;a.updateGlobeVertexNormal(Z,Ei+0,Qn,qt,dn),a.updateGlobeVertexNormal(Z,Ei+1,Qn,qt,dn),a.updateGlobeVertexNormal(Z,Ei+2,Qn,qt,dn),a.updateGlobeVertexNormal(Z,Ei+3,Qn,qt,dn)}const[Wn,pn,Un]=mn.point;a.addDynamicAttributes(W,Wn,pn,Un,mn.angle)};if(ln>1){const mn=hi(ze,P,st,Dt,c,ie,ve,d,F,x,Pe,Be,!1,Te,Ae,je);if(!mn)return{notEnoughRoom:!0};if(f&&!c){let[Wn,pn,Un]=mn.first.point,[Qn,qt,dn]=mn.last.point;[Wn,pn]=hn(Wn,pn,Un,D),[Qn,qt]=hn(Qn,qt,dn,D);const Ei=Ti($t,qn,(Qn-Wn)*Oe,qt-pn);if(d.flipState=Ei&&Ei.needsFlipping?1:2,Ei)return Ei}Pn(mn.first);for(let Wn=Ut+1;Wn<Ut+ln-1;Wn++){const pn=to(ze*P.getoffsetX(Wn),st,Dt,c,ie,ve,rn,vt,Kt,F,x,Pe,Be,!1,!1,Te,Ae,je);if(!pn)return W.length-=4*(Wn-Ut),{notEnoughRoom:!0};Pn(pn)}Pn(mn.last)}else{if(f&&!c){const Wn=hn(ve.x,ve.y,0,y),pn=vt+rn+1,Un=new a.pointGeometry(F.getx(pn),F.gety(pn)),Qn=hn(Un.x,Un.y,0,y),qt=Qn[3]>0?Qn:vr(ve,Un,Wn,1,y,void 0,Te,Ae.canonical),dn=Ti($t,qn,(qt[0]-Wn[0])*Oe,qt[1]-Wn[1]);if(d.flipState=dn&&dn.needsFlipping?1:2,dn)return dn}const mn=to(ze*P.getoffsetX(Ut),st,Dt,c,ie,ve,rn,vt,Kt,F,x,Pe,Be,!1,!1,Te,Ae,je);if(!mn)return{notEnoughRoom:!0};Pn(mn)}return{}}function Ki(d,i,c,f,y){const{x,y:D,z:P}=f.projectTilePoint(d.x,d.y,i);if(!y)return hn(x,D,P,c);const[F,W,Z]=y(d);return hn(x+F,D+W,P+Z,c)}function vr(d,i,c,f,y,x,D,P){const F=Ki(d.sub(i)._unit()._add(d),P,y,D,x);return a.sub(F,c,F),a.normalize(F,F),a.scaleAndAdd(F,c,F,f)}function to(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be,Te,Ae){const je=f?d-i:d+i;let ze=je>0?1:-1,st=0;f&&(ze*=-1,st=Math.PI),ze<0&&(st+=Math.PI);let Dt=P+D+(ze>0?0:1)|0,vt=y,Ut=y,ln=0,rn=0;const $t=Math.abs(je),qn=[],Kt=[];let Pn=x,mn=Pn;const Wn=()=>vr(mn,Pn,Ut,$t-ln+1,Z,ve,Be,Te.canonical);for(;ln+rn<=$t;){if(Dt+=ze,Dt<P||Dt>=F)return null;if(Ut=vt,mn=Pn,qn.push(Ut),Pe&&Kt.push(mn),Pn=new a.pointGeometry(W.getx(Dt),W.gety(Dt)),vt=ie[Dt],!vt){const ji=Ki(Pn,Te.canonical,Z,Be,ve);vt=ji[3]>0?ie[Dt]=ji:Wn()}ln+=rn,rn=a.distance(Ut,vt)}Oe&&ve&&(ie[Dt]&&(vt=Wn(),rn=a.distance(Ut,vt)),ie[Dt]=vt);const pn=($t-ln)/rn,Un=Pn.sub(mn)._mult(pn)._add(mn),Qn=a.sub([],vt,Ut),qt=a.scaleAndAdd([],Ut,Qn,pn);let dn=[0,0,1],Ei=Qn[0],ki=Qn[1];if(Ae&&(dn=Be.upVector(Te.canonical,Un.x,Un.y),0!==dn[0]||0!==dn[1]||1!==dn[2])){const ji=[dn[2],0,-dn[0]],or=a.cross([],dn,ji);a.normalize(ji,ji),a.normalize(or,or),Ei=a.dot(Qn,ji),ki=a.dot(Qn,or)}if(c){const ji=a.cross([],dn,Qn);a.normalize(ji,ji),a.scaleAndAdd(qt,qt,ji,c*ze)}const Ci=st+Math.atan2(ki,Ei);return qn.push(qt),Pe&&Kt.push(Un),{point:qt,angle:Ci,path:qn,tilePath:Kt,up:dn}}function Br(d,i){const c=i.length,f=c+4*d;i.resize(f),i.float32.fill(-1/0,4*c,4*f)}function pr(d,i,c){const f=i[0],y=i[1];return d[0]=c[0]*f+c[4]*y+c[12],d[1]=c[1]*f+c[5]*y+c[13],d[3]=c[3]*f+c[7]*y+c[15],d}const Zr=100;class Ds{constructor(i,c,f=new Ao(i.width+200,i.height+200,25),y=new Ao(i.width+200,i.height+200,25)){this.transform=i,this.grid=f,this.ignoredGrid=y,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Zr,this.screenBottomBoundary=i.height+Zr,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,f,y,x,D,P,F){let W=f.projectedAnchorX,Z=f.projectedAnchorY,ie=f.projectedAnchorZ;const ve=f.elevation,Pe=f.tileID,Oe=i.getProjection();if(ve&&Pe){const[vt,Ut,ln]=Oe.upVector(Pe.canonical,f.tileAnchorX,f.tileAnchorY),rn=Oe.upVectorScale(Pe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;W+=vt*ve*rn,Z+=Ut*ve*rn,ie+=ln*ve*rn}const Be=this.projectAndGetPerspectiveRatio(P,W,Z,ie,f.tileID,"globe"===Oe.name||!!ve||this.transform.pitch>0,Oe),Te=D*Be.perspectiveRatio,Ae=(f.x1*c+y.x-f.padding)*Te+Be.point.x,je=(f.y1*c+y.y-f.padding)*Te+Be.point.y,ze=(f.x2*c+y.x+f.padding)*Te+Be.point.x,st=(f.y2*c+y.y+f.padding)*Te+Be.point.y,Dt=Be.perspectiveRatio<=.55||Be.occluded;return!this.isInsideGrid(Ae,je,ze,st)||!x&&this.grid.hitTest(Ae,je,ze,st,F)||Dt?{box:[],offscreen:!1,occluded:Be.occluded}:{box:[Ae,je,ze,st],offscreen:this.isOffscreen(Ae,je,ze,st),occluded:!1}}placeCollisionCircles(i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be){const Te=[],Ae=this.transform.elevation,je=i.getProjection(),ze=Ae?Ae.getAtTileOffsetFunc(Be,this.transform.center.lat,this.transform.worldSize,je):null,st=new a.pointGeometry(f.tileAnchorX,f.tileAnchorY);let{x:Dt,y:vt,z:Ut}=je.projectTilePoint(st.x,st.y,Be.canonical);if(ze){const[Un,Qn,qt]=ze(st);Dt+=Un,vt+=Qn,Ut+=qt}const ln="globe"===je.name,rn=this.projectAndGetPerspectiveRatio(P,Dt,vt,Ut,Be,ln||!!Ae||this.transform.pitch>0,je),{perspectiveRatio:$t}=rn,qn=(ie?D/$t:D*$t)/a.ONE_EM,Kt=hn(Dt,vt,Ut,F),Pn=rn.signedDistanceFromCamera>0?hi(qn,x,f.lineOffsetX*qn,f.lineOffsetY*qn,!1,Kt,st,f,y,F,{},Ae&&!ie?ze:null,ie&&!!Ae,je,Be,ie):null;let mn=!1,Wn=!1,pn=!0;if(Pn&&!rn.occluded){const Un=.5*Pe*$t+Oe,Qn=new a.pointGeometry(-100,-100),qt=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),dn=new tr,{first:Ei,last:ki}=Pn,Ci=Ei.path.length;let ji=[];for(let gi=Ci-1;gi>=1;gi--)ji.push(Ei.path[gi]);for(let gi=1;gi<ki.path.length;gi++)ji.push(ki.path[gi]);const or=2.5*Un;W&&(ji=ji.map(([gi,jr,Pr],so)=>(ze&&!ln&&(Pr=ze(so<Ci-1?Ei.tilePath[Ci-1-so]:ki.tilePath[so-Ci+2])[2]),hn(gi,jr,Pr,W))),ji.some(gi=>gi[3]<=0)&&(ji=[]));let Pi=[];if(ji.length>0){let gi=1/0,jr=-1/0,Pr=1/0,so=-1/0;for(const Hr of ji)gi=Math.min(gi,Hr[0]),Pr=Math.min(Pr,Hr[1]),jr=Math.max(jr,Hr[0]),so=Math.max(so,Hr[1]);jr>=Qn.x&&gi<=qt.x&&so>=Qn.y&&Pr<=qt.y&&(Pi=[ji.map(Hr=>new a.pointGeometry(Hr[0],Hr[1]))],(gi<Qn.x||jr>qt.x||Pr<Qn.y||so>qt.y)&&(Pi=a.clipLine(Pi,Qn.x,Qn.y,qt.x,qt.y)))}for(const gi of Pi){dn.reset(gi,.25*Un);let jr=0;jr=dn.length<=.5*Un?1:Math.ceil(dn.paddedLength/or)+1;for(let Pr=0;Pr<jr;Pr++){const so=Pr/Math.max(jr-1,1),Hr=dn.lerp(so),La=Hr.x+Zr,na=Hr.y+Zr;Te.push(La,na,Un,0);const ia=La-Un,cl=na-Un,Yr=La+Un,Gr=na+Un;if(pn=pn&&this.isOffscreen(ia,cl,Yr,Gr),Wn=Wn||this.isInsideGrid(ia,cl,Yr,Gr),!c&&this.grid.hitTestCircle(La,na,Un,ve)&&(mn=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:mn,occluded:!1}}}}return{circles:!Z&&mn||!Wn?[]:Te,offscreen:pn,collisionDetected:mn,occluded:rn.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let f=1/0,y=1/0,x=-1/0,D=-1/0;for(const Z of i){const ie=new a.pointGeometry(Z.x+Zr,Z.y+Zr);f=Math.min(f,ie.x),y=Math.min(y,ie.y),x=Math.max(x,ie.x),D=Math.max(D,ie.y),c.push(ie)}const P=this.grid.query(f,y,x,D).concat(this.ignoredGrid.query(f,y,x,D)),F={},W={};for(const Z of P){const ie=Z.key;if(void 0===F[ie.bucketInstanceId]&&(F[ie.bucketInstanceId]={}),F[ie.bucketInstanceId][ie.featureIndex])continue;const ve=[new a.pointGeometry(Z.x1,Z.y1),new a.pointGeometry(Z.x2,Z.y1),new a.pointGeometry(Z.x2,Z.y2),new a.pointGeometry(Z.x1,Z.y2)];a.polygonIntersectsPolygon(c,ve)&&(F[ie.bucketInstanceId][ie.featureIndex]=!0,void 0===W[ie.bucketInstanceId]&&(W[ie.bucketInstanceId]=[]),W[ie.bucketInstanceId].push(ie.featureIndex))}return W}insertCollisionBox(i,c,f,y,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:y,collisionGroupID:x},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,f,y,x){const D=c?this.ignoredGrid:this.grid,P={bucketInstanceId:f,featureIndex:y,collisionGroupID:x};for(let F=0;F<i.length;F+=4)D.insertCircle(P,i[F],i[F+1],i[F+2])}projectAndGetPerspectiveRatio(i,c,f,y,x,D,P){const F=[c,f,y,1];let W=!1;if(y||this.transform.pitch>0){a.transformMat4$1(F,F,i);const ie="globe"===P.name;this.fogState&&x&&!ie&&(W=function(Pe,Oe,Be,Te,Ae,je){const ze=je.calculateFogTileMatrix(Ae),st=[Oe,Be,Te];return a.transformMat4(st,st,ze),_t(Pe,st,je.pitch,je._fov)}(this.fogState,c,f,y,x.toUnwrapped(),this.transform)>.9)}else pr(F,F,i);const Z=F[3];return{point:new a.pointGeometry((F[0]/Z+1)/2*this.transform.width+Zr,(-F[1]/Z+1)/2*this.transform.height+Zr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/Z*.5,1.5),signedDistanceFromCamera:Z,occluded:D&&F[2]>Z||W}}isOffscreen(i,c,f,y){return f<Zr||i>=this.screenRightBoundary||y<Zr||c>this.screenBottomBoundary}isInsideGrid(i,c,f,y){return f>=0&&i<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=a.identity([]);return a.translate(i,i,[-100,-100,0]),i}}function Ts(d,i,c){const f=i.createTileMatrix(d,d.worldSize,c.toUnwrapped());return a.multiply(new Float32Array(16),d.projMatrix,f)}function is(d,i,c){if(i.projection.name===c.projection.name)return d.projMatrix;const f=c.clone();return f.setProjection(i.projection),Ts(f,i.getProjection(),d)}function ks(d,i,c){return i.name===c.projection.name?d.projMatrix:Ts(c,i,d)}class Fl{constructor(i,c,f,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):y&&f?1:0,this.placed=f}isHidden(){return 0===this.opacity&&!this.placed}}class Eo{constructor(i,c,f,y,x,D=!1){this.text=new Fl(i?i.text:null,c,f,x),this.icon=new Fl(i?i.icon:null,c,y,x),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ha{constructor(i,c,f,y=!1){this.text=i,this.icon=c,this.skipFade=f,this.clipped=y}}class Ga{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class nl{constructor(i,c,f,y,x){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=x}}class Io{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:f=>f.collisionGroupID===c}}return this.collisionGroups[i]}}function kr(d,i,c,f,y){const{horizontalAlign:x,verticalAlign:D}=a.getAnchorAlignment(d),P=-(x-.5)*i,F=-(D-.5)*c,W=a.evaluateVariableOffset(d,f);return new a.pointGeometry(P+W[0]*y,F+W[1]*y)}function Fs(d,i,c,f,y){const x=new a.pointGeometry(d,i);return c&&x._rotate(f?y:-y),x}class Ea{constructor(i,c,f,y,x){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new Ds(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Io(f),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,f,y){const x=f.getBucket(c),D=f.latestFeatureIndex;if(!x||!D||c.id!==x.layerIds[0])return;const P=x.layers[0].layout,F=f.collisionBoxArray,W=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Z=f.tileSize/a.EXTENT,ie=f.tileID.toUnwrapped();this.transform.setProjection(x.projection);const ve=(Pe=f.tileID,Oe=x.getProjection(),Be=this.transform,Oe.name===this.projection?Be.calculateProjMatrix(Pe.toUnwrapped()):Ts(Be,Oe,Pe));var Pe,Oe,Be;const Te="map"===P.get("text-pitch-alignment"),Ae="map"===P.get("text-rotation-alignment");c.compileFilter();const je=c.dynamicFilter(),ze=c.dynamicFilterNeedsFeature(),st=this.transform.calculatePixelsToTileUnitsMatrix(f),Dt=gs(ve,f.tileID.canonical,Te,Ae,this.transform,x.getProjection(),st);let vt=null;if(Te){const rn=kn(ve,f.tileID.canonical,Te,Ae,this.transform,x.getProjection(),st);vt=a.multiply([],this.transform.labelPlaneMatrix,rn)}let Ut=null;je&&f.latestFeatureIndex&&(Ut={unwrappedTileID:ie,dynamicFilter:je,dynamicFilterNeedsFeature:ze,featureIndex:f.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new nl(x.bucketInstanceId,D,x.sourceLayerIndex,x.index,f.tileID);const ln={bucket:x,layout:P,posMatrix:ve,textLabelPlaneMatrix:Dt,labelToScreenMatrix:vt,clippingData:Ut,scale:W,textPixelRatio:Z,holdingForFade:f.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(y)for(const rn of x.sortKeyRanges){const{sortKey:$t,symbolInstanceStart:qn,symbolInstanceEnd:Kt}=rn;i.push({sortKey:$t,symbolInstanceStart:qn,symbolInstanceEnd:Kt,parameters:ln})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:ln})}attemptAnchorPlacement(i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be,Te,Ae,je){const{textOffset0:ze,textOffset1:st,crossTileID:Dt}=ve,vt=[ze,st],Ut=kr(i,f,y,vt,x),ln=this.collisionIndex.placeCollisionBox(Oe,x,c,Fs(Ut.x,Ut.y,D,P,this.transform.angle),ie,F,W,Z.predicate);if(Te){const rn=Oe.getSymbolInstanceIconSize(je,this.transform.zoom,ve.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Oe,rn,Te,Fs(Ut.x,Ut.y,D,P,this.transform.angle),ie,F,W,Z.predicate).box.length)return}if(ln.box.length>0){let rn;return this.prevPlacement&&this.prevPlacement.variableOffsets[Dt]&&this.prevPlacement.placements[Dt]&&this.prevPlacement.placements[Dt].text&&(rn=this.prevPlacement.variableOffsets[Dt].anchor),this.variableOffsets[Dt]={textOffset:vt,width:f,height:y,anchor:i,textScale:x,prevAnchor:rn},this.markUsedJustification(Oe,i,ve,Be),Oe.allowVerticalPlacement&&(this.markUsedOrientation(Oe,Be,ve),this.placedOrientations[Dt]=Be),{shift:Ut,placedGlyphBoxes:ln}}}placeLayerBucketPart(i,c,f,y){const{bucket:x,layout:D,posMatrix:P,textLabelPlaneMatrix:F,labelToScreenMatrix:W,clippingData:Z,textPixelRatio:ie,holdingForFade:ve,collisionBoxArray:Pe,partiallyEvaluatedTextSize:Oe,partiallyEvaluatedIconSize:Be,collisionGroup:Te}=i.parameters,Ae=D.get("text-optional"),je=D.get("icon-optional"),ze=D.get("text-allow-overlap"),st=D.get("icon-allow-overlap"),Dt="map"===D.get("text-rotation-alignment"),vt="map"===D.get("text-pitch-alignment"),Ut="none"!==D.get("icon-text-fit"),ln="viewport-y"===D.get("symbol-z-order");this.transform.setProjection(x.projection);let rn=ze&&(st||!x.hasIconData()||je),$t=st&&(ze||!x.hasTextData()||Ae);!x.collisionArrays&&Pe&&x.deserializeCollisionBoxes(Pe),f&&y&&x.updateCollisionDebugBuffers(this.transform.zoom,Pe);const qn=(Kt,Pn,mn)=>{const{crossTileID:Wn,numVerticalGlyphVertices:pn}=Kt;if(Z){const Yr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Gr=null;if(Z.dynamicFilterNeedsFeature){const wr=this.retainedQueryData[x.bucketInstanceId];Gr=Z.featureIndex.loadFeature({featureIndex:Kt.featureIndex,bucketIndex:wr.bucketIndex,sourceLayerIndex:wr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Z.dynamicFilter)(Yr,Gr,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new a.pointGeometry(Kt.tileAnchorX,Kt.tileAnchorY),this.transform.calculateDistanceTileData(Z.unwrappedTileID)))return this.placements[Wn]=new Ha(!1,!1,!1,!0),void(c[Wn]=!0)}if(c[Wn])return;if(ve)return void(this.placements[Wn]=new Ha(!1,!1,!1));let Un=!1,Qn=!1,qt=!0,dn=!1,Ei=!1,ki=null,Ci={box:null,offscreen:null,occluded:null},ji={box:null,offscreen:null,occluded:null},or=null,Pi=null,gi=null,jr=0,Pr=0,so=0;mn.textFeatureIndex?jr=mn.textFeatureIndex:Kt.useRuntimeCollisionCircles&&(jr=Kt.featureIndex),mn.verticalTextFeatureIndex&&(Pr=mn.verticalTextFeatureIndex);const Hr=Yr=>{Yr.tileID=this.retainedQueryData[x.bucketInstanceId].tileID;const Gr=this.transform.elevation;(Gr||Yr.elevation)&&(Yr.elevation=Gr?Gr.getAtTileOffset(Yr.tileID,Yr.tileAnchorX,Yr.tileAnchorY):0)},La=mn.textBox;if(La){Hr(La);const Yr=wr=>{let Vo=a.WritingMode.horizontal;if(x.allowVerticalPlacement&&!wr&&this.prevPlacement){const $s=this.prevPlacement.placedOrientations[Wn];$s&&(this.placedOrientations[Wn]=$s,Vo=$s,this.markUsedOrientation(x,Vo,Kt))}return Vo},Gr=(wr,Vo)=>{if(x.allowVerticalPlacement&&pn>0&&mn.verticalTextBox){for(const $s of x.writingModes)if($s===a.WritingMode.vertical?(Ci=Vo(),ji=Ci):Ci=wr(),Ci&&Ci.box&&Ci.box.length)break}else Ci=wr()};if(D.get("text-variable-anchor")){let wr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Wn]){const po=this.prevPlacement.variableOffsets[Wn];wr.indexOf(po.anchor)>0&&(wr=wr.filter(Es=>Es!==po.anchor),wr.unshift(po.anchor))}const Vo=(po,Es,wc)=>{const El=x.getSymbolInstanceTextSize(Oe,Kt,this.transform.zoom,Pn),Ps=(po.x2-po.x1)*El+2*po.padding,Ba=(po.y2-po.y1)*El+2*po.padding,Zs=Ut&&!st?Es:null;Zs&&Hr(Zs);let Cl={box:[],offscreen:!1,occluded:!1};const au=ze?2*wr.length:wr.length;for(let Hc=0;Hc<au;++Hc){const Ml=this.attemptAnchorPlacement(wr[Hc%wr.length],po,Ps,Ba,El,Dt,vt,ie,P,Te,Hc>=wr.length,Kt,Pn,x,wc,Zs,Oe,Be);if(Ml&&(Cl=Ml.placedGlyphBoxes,Cl&&Cl.box&&Cl.box.length)){Un=!0,ki=Ml.shift;break}}return Cl};Gr(()=>Vo(La,mn.iconBox,a.WritingMode.horizontal),()=>{const po=mn.verticalTextBox;return po&&Hr(po),x.allowVerticalPlacement&&!(Ci&&Ci.box&&Ci.box.length)&&pn>0&&po?Vo(po,mn.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ci&&(Un=Ci.box,qt=Ci.offscreen,dn=Ci.occluded);const $s=Yr(Ci&&Ci.box);if(!Un&&this.prevPlacement){const po=this.prevPlacement.variableOffsets[Wn];po&&(this.variableOffsets[Wn]=po,this.markUsedJustification(x,po.anchor,Kt,$s))}}else{const wr=(Vo,$s)=>{const po=x.getSymbolInstanceTextSize(Oe,Kt,this.transform.zoom,Pn),Es=this.collisionIndex.placeCollisionBox(x,po,Vo,new a.pointGeometry(0,0),ze,ie,P,Te.predicate);return Es&&Es.box&&Es.box.length&&(this.markUsedOrientation(x,$s,Kt),this.placedOrientations[Wn]=$s),Es};Gr(()=>wr(La,a.WritingMode.horizontal),()=>{const Vo=mn.verticalTextBox;return x.allowVerticalPlacement&&pn>0&&Vo?(Hr(Vo),wr(Vo,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Yr(Ci&&Ci.box&&Ci.box.length)}}if(or=Ci,Un=or&&or.box&&or.box.length>0,qt=or&&or.offscreen,dn=or&&or.occluded,Kt.useRuntimeCollisionCircles){const Yr=x.text.placedSymbolArray.get(Kt.centerJustifiedTextSymbolIndex>=0?Kt.centerJustifiedTextSymbolIndex:Kt.verticalPlacedTextSymbolIndex),Gr=a.evaluateSizeForFeature(x.textSizeData,Oe,Yr),wr=D.get("text-padding");Pi=this.collisionIndex.placeCollisionCircles(x,ze,Yr,x.lineVertexArray,x.glyphOffsetArray,Gr,P,F,W,f,vt,Te.predicate,Kt.collisionCircleDiameter*Gr/a.ONE_EM,wr,this.retainedQueryData[x.bucketInstanceId].tileID),Un=ze||Pi.circles.length>0&&!Pi.collisionDetected,qt=qt&&Pi.offscreen,dn=Pi.occluded}if(mn.iconFeatureIndex&&(so=mn.iconFeatureIndex),mn.iconBox){const Yr=Gr=>{Hr(Gr);const wr=Ut&&ki?Fs(ki.x,ki.y,Dt,vt,this.transform.angle):new a.pointGeometry(0,0),Vo=x.getSymbolInstanceIconSize(Be,this.transform.zoom,Kt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(x,Vo,Gr,wr,st,ie,P,Te.predicate)};ji&&ji.box&&ji.box.length&&mn.verticalIconBox?(gi=Yr(mn.verticalIconBox),Qn=gi.box.length>0):(gi=Yr(mn.iconBox),Qn=gi.box.length>0),qt=qt&&gi.offscreen,Ei=gi.occluded}const na=Ae||0===Kt.numHorizontalGlyphVertices&&0===pn,ia=je||0===Kt.numIconVertices;if(na||ia?ia?na||(Qn=Qn&&Un):Un=Qn&&Un:Qn=Un=Qn&&Un,Un&&or&&or.box&&this.collisionIndex.insertCollisionBox(or.box,D.get("text-ignore-placement"),x.bucketInstanceId,ji&&ji.box&&Pr?Pr:jr,Te.ID),Qn&&gi&&this.collisionIndex.insertCollisionBox(gi.box,D.get("icon-ignore-placement"),x.bucketInstanceId,so,Te.ID),Pi&&(Un&&this.collisionIndex.insertCollisionCircles(Pi.circles,D.get("text-ignore-placement"),x.bucketInstanceId,jr,Te.ID),f)){const Yr=x.bucketInstanceId;let Gr=this.collisionCircleArrays[Yr];void 0===Gr&&(Gr=this.collisionCircleArrays[Yr]=new Ga);for(let wr=0;wr<Pi.circles.length;wr+=4)Gr.circles.push(Pi.circles[wr+0]),Gr.circles.push(Pi.circles[wr+1]),Gr.circles.push(Pi.circles[wr+2]),Gr.circles.push(Pi.collisionDetected?1:0)}const cl="globe"!==x.projection.name;rn=rn&&(cl||!dn),$t=$t&&(cl||!Ei),this.placements[Wn]=new Ha(Un||rn,Qn||$t,qt||x.justReloaded),c[Wn]=!0};if(ln){const Kt=x.getSortedSymbolIndexes(this.transform.angle);for(let Pn=Kt.length-1;Pn>=0;--Pn){const mn=Kt[Pn];qn(x.symbolInstances.get(mn),mn,x.collisionArrays[mn])}}else for(let Kt=i.symbolInstanceStart;Kt<i.symbolInstanceEnd;Kt++)qn(x.symbolInstances.get(Kt),Kt,x.collisionArrays[Kt]);if(f&&x.bucketInstanceId in this.collisionCircleArrays){const Kt=this.collisionCircleArrays[x.bucketInstanceId];a.invert(Kt.invProjMatrix,P),Kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(i,c,f,y){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:F,crossTileID:W}=f,Z=a.getAnchorJustification(c),ie=y===a.WritingMode.vertical?F:"left"===Z?x:"center"===Z?D:"right"===Z?P:-1;x>=0&&(i.text.placedSymbolArray.get(x).crossTileID=ie>=0&&x!==ie?0:W),D>=0&&(i.text.placedSymbolArray.get(D).crossTileID=ie>=0&&D!==ie?0:W),P>=0&&(i.text.placedSymbolArray.get(P).crossTileID=ie>=0&&P!==ie?0:W),F>=0&&(i.text.placedSymbolArray.get(F).crossTileID=ie>=0&&F!==ie?0:W)}markUsedOrientation(i,c,f){const y=c===a.WritingMode.horizontal||c===a.WritingMode.horizontalOnly?c:0,x=c===a.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:W}=f,Z=i.text.placedSymbolArray;D>=0&&(Z.get(D).placedOrientation=y),P>=0&&(Z.get(P).placedOrientation=y),F>=0&&(Z.get(F).placedOrientation=y),W>=0&&(Z.get(W).placedOrientation=x)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let f=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(i):1,x=c?c.opacities:{},D=c?c.variableOffsets:{},P=c?c.placedOrientations:{};for(const F in this.placements){const W=this.placements[F],Z=x[F];Z?(this.opacities[F]=new Eo(Z,y,W.text,W.icon,null,W.clipped),f=f||W.text!==Z.text.placed||W.icon!==Z.icon.placed):(this.opacities[F]=new Eo(null,y,W.text,W.icon,W.skipFade,W.clipped),f=f||W.text||W.icon)}for(const F in x){const W=x[F];if(!this.opacities[F]){const Z=new Eo(W,y,!1,!1);Z.isHidden()||(this.opacities[F]=Z,f=f||W.text.placed||W.icon.placed)}}for(const F in D)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=D[F]);for(const F in P)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=P[F]);f?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const f={};for(const y of c){const x=y.getBucket(i);x&&y.latestFeatureIndex&&i.id===x.layerIds[0]&&this.updateBucketOpacities(x,f,y.collisionBoxArray)}}updateBucketOpacities(i,c,f){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const y=i.layers[0].layout,x=!!i.layers[0].dynamicFilter(),D=new Eo(null,0,!1,!1,!0),P=y.get("text-allow-overlap"),F=y.get("icon-allow-overlap"),W=y.get("text-variable-anchor"),Z="map"===y.get("text-rotation-alignment"),ie="map"===y.get("text-pitch-alignment"),ve="none"!==y.get("icon-text-fit"),Pe=new Eo(null,0,P&&(F||!i.hasIconData()||y.get("icon-optional")),F&&(P||!i.hasTextData()||y.get("text-optional")),!0);!i.collisionArrays&&f&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(f);const Oe=(Te,Ae,je)=>{for(let ze=0;ze<Ae/4;ze++)Te.opacityVertexArray.emplaceBack(je)};let Be=0;for(let Te=0;Te<i.symbolInstances.length;Te++){const Ae=i.symbolInstances.get(Te),{numHorizontalGlyphVertices:je,numVerticalGlyphVertices:ze,crossTileID:st,numIconVertices:Dt}=Ae;let vt=this.opacities[st];c[st]?vt=D:vt||(vt=Pe,this.opacities[st]=vt),c[st]=!0;const Ut=je>0||ze>0,ln=Dt>0,rn=this.placedOrientations[st],$t=rn===a.WritingMode.vertical,qn=rn===a.WritingMode.horizontal||rn===a.WritingMode.horizontalOnly;if(!Ut&&!ln||vt.isHidden()||Be++,Ut){const Kt=no(vt.text);Oe(i.text,je,$t?_s:Kt),Oe(i.text,ze,qn?_s:Kt);const Pn=vt.text.isHidden(),{leftJustifiedTextSymbolIndex:mn,centerJustifiedTextSymbolIndex:Wn,rightJustifiedTextSymbolIndex:pn,verticalPlacedTextSymbolIndex:Un}=Ae,Qn=i.text.placedSymbolArray,qt=Pn||$t?1:0;mn>=0&&(Qn.get(mn).hidden=qt),Wn>=0&&(Qn.get(Wn).hidden=qt),pn>=0&&(Qn.get(pn).hidden=qt),Un>=0&&(Qn.get(Un).hidden=Pn||qn?1:0);const dn=this.variableOffsets[st];dn&&this.markUsedJustification(i,dn.anchor,Ae,rn);const Ei=this.placedOrientations[st];Ei&&(this.markUsedJustification(i,"left",Ae,Ei),this.markUsedOrientation(i,Ei,Ae))}if(ln){const Kt=no(vt.icon),{placedIconSymbolIndex:Pn,verticalPlacedIconSymbolIndex:mn}=Ae,Wn=i.icon.placedSymbolArray,pn=vt.icon.isHidden()?1:0;Pn>=0&&(Oe(i.icon,Dt,$t?_s:Kt),Wn.get(Pn).hidden=pn),mn>=0&&(Oe(i.icon,Ae.numVerticalIconVertices,qn?_s:Kt),Wn.get(mn).hidden=pn)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Kt=i.collisionArrays[Te];if(Kt){let Pn=new a.pointGeometry(0,0),mn=!0;if(Kt.textBox||Kt.verticalTextBox){if(W){const pn=this.variableOffsets[st];pn?(Pn=kr(pn.anchor,pn.width,pn.height,pn.textOffset,pn.textScale),Z&&Pn._rotate(ie?this.transform.angle:-this.transform.angle)):mn=!1}x&&(mn=!vt.clipped),Kt.textBox&&Qr(i.textCollisionBox.collisionVertexArray,vt.text.placed,!mn||$t,Pn.x,Pn.y),Kt.verticalTextBox&&Qr(i.textCollisionBox.collisionVertexArray,vt.text.placed,!mn||qn,Pn.x,Pn.y)}const Wn=mn&&Boolean(!qn&&Kt.verticalIconBox);Kt.iconBox&&Qr(i.iconCollisionBox.collisionVertexArray,vt.icon.placed,Wn,ve?Pn.x:0,ve?Pn.y:0),Kt.verticalIconBox&&Qr(i.iconCollisionBox.collisionVertexArray,vt.icon.placed,!Wn,ve?Pn.x:0,ve?Pn.y:0)}}}if(i.fullyClipped=0===Be,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Te=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Te.invProjMatrix,i.placementViewportMatrix=Te.viewportMatrix,i.collisionCircleArray=Te.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const f=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*f>i}setStale(){this.stale=!0}}function Qr(d,i,c,f,y){d.emplaceBack(i?1:0,c?1:0,f||0,y||0),d.emplaceBack(i?1:0,c?1:0,f||0,y||0),d.emplaceBack(i?1:0,c?1:0,f||0,y||0),d.emplaceBack(i?1:0,c?1:0,f||0,y||0)}const mo=Math.pow(2,25),la=Math.pow(2,24),ca=Math.pow(2,17),Jr=Math.pow(2,16),ua=Math.pow(2,9),Bo=Math.pow(2,8),da=Math.pow(2,1);function no(d){if(0===d.opacity&&!d.placed)return 0;if(1===d.opacity&&d.placed)return 4294967295;const i=d.placed?1:0,c=Math.floor(127*d.opacity);return c*mo+i*la+c*ca+i*Jr+c*ua+i*Bo+c*da+i}const _s=0;class ys{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,c,f,y,x){const D=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(D,y,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((P,F)=>P.sortKey-F.sortKey));this._currentPartIndex<D.length;){const P=D[this._currentPartIndex];if(c.placeLayerBucketPart(P,this._seenCrossTileIDs,f,0===P.symbolInstanceStart),this._currentPartIndex++,x())return!0}return!1}}class Ho{constructor(i,c,f,y,x,D,P,F){this.placement=new Ea(i,x,D,P,F),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(i,c,f){const y=a.exported.now(),x=()=>{const D=a.exported.now()-y;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=c[i[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=P)&&(!D.maxzoom||D.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new ys(D)),this._inProgressLayer.continuePlacement(f[D.source],this.placement,this._showCollisionBoxes,D,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Ls=512/a.EXTENT/2;class Bs{constructor(i,c,f){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=f;for(let y=0;y<c.length;y++){const x=c.get(y),D=x.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:x.crossTileID,coord:this.getScaledCoordinates(x,i)})}}getScaledCoordinates(i,c){const f=Ls/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*a.EXTENT+i.tileAnchorX)*f),y:Math.floor((c.canonical.y*a.EXTENT+i.tileAnchorY)*f)}}findMatches(i,c,f){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let x=0;x<i.length;x++){const D=i.get(x);if(D.crossTileID)continue;const P=this.indexedSymbolInstances[D.key];if(!P)continue;const F=this.getScaledCoordinates(D,c);for(const W of P)if(Math.abs(W.coord.x-F.x)<=y&&Math.abs(W.coord.y-F.y)<=y&&!f[W.crossTileID]){f[W.crossTileID]=!0,D.crossTileID=W.crossTileID;break}}}}class Ca{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ns{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(0!==c)for(const f in this.indexes){const y=this.indexes[f],x={};for(const D in y){const P=y[D];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+c),x[P.tileID.key]=P}this.indexes[f]=x}this.lng=i}addBucket(i,c,f){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const y=this.usedCrossTileIDs[i.overscaledZ];for(const x in this.indexes){const D=this.indexes[x];if(Number(x)>i.overscaledZ)for(const P in D){const F=D[P];F.tileID.isChildOf(i)&&F.findMatches(c.symbolInstances,i,y)}else{const P=D[i.scaledTo(Number(x)).key];P&&P.findMatches(c.symbolInstances,i,y)}}for(let x=0;x<c.symbolInstances.length;x++){const D=c.symbolInstances.get(x);D.crossTileID||(D.crossTileID=f.generate(),y[D.crossTileID]=!0)}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Bs(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const f in c.indexedSymbolInstances)for(const y of c.indexedSymbolInstances[f])delete this.usedCrossTileIDs[i][y.crossTileID]}removeStaleBuckets(i){let c=!1;for(const f in this.indexes){const y=this.indexes[f];for(const x in y)i[y[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[x]),delete y[x],c=!0)}return c}}class Go{constructor(){this.layerIndexes={},this.crossTileIDs=new Ca,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,f,y){let x=this.layerIndexes[i.id];void 0===x&&(x=this.layerIndexes[i.id]=new Ns);let D=!1;const P={};"globe"!==y.name&&x.handleWrapJump(f);for(const F of c){const W=F.getBucket(i);W&&i.id===W.layerIds[0]&&(W.bucketInstanceId||(W.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(F.tileID,W,this.crossTileIDs)&&(D=!0),P[W.bucketInstanceId]=!0)}return x.removeStaleBuckets(P)&&(D=!0),D}pruneUnusedLayers(i){const c={};i.forEach(f=>{c[f]=!0});for(const f in this.layerIndexes)c[f]||delete this.layerIndexes[f]}}const Ma=(d,i)=>a.emitValidationErrors(d,i&&i.filter(c=>"source.canvas"!==c.identifier)),il=a.pick(Gn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),rs=a.pick(Gn,["setCenter","setZoom","setBearing","setPitch"]),Ss={version:8,layers:[],sources:{}},Co={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Wr extends a.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new wi(Xn(),this),this.imageManager=new At,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(i._requestManager,c.localFontFamily?a.LocalGlyphMode.all:c.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new Go,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const f=this;this._rtlTextPluginCallback=Wr.registerForPluginStateChange(y=>{f.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(x,D)=>{if(a.triggerPluginCompletionEvent(x),D&&D.every(P=>P))for(const P in f._sourceCaches){const F=f._sourceCaches[P],W=F.getSource().type;"vector"!==W&&"geojson"!==W||F.reload()}})}),this.on("data",y=>{if("source"!==y.dataType||"metadata"!==y.sourceDataType)return;const x=this.getSource(y.sourceId);if(x&&x.vectorLayerIds)for(const D in this._layers){const P=this._layers[D];P.source===x.id&&this._validateLayer(P)}})}loadURL(i,c={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const f="boolean"==typeof c.validate?c.validate:!a.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const y=this.map._requestManager.transformRequest(i,a.ResourceType.Style);this._request=a.getJSON(y,(x,D)=>{this._request=null,x?this.fire(new a.ErrorEvent(x)):D&&this._load(D,f)})}loadJSON(i,c={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(i,!1!==c.validate)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Ss,!1)}_updateLayerCount(i,c){const f=c?1:-1;i.is3D()&&(this._num3DLayers+=f),"circle"===i.type&&(this._numCircleLayers+=f),"symbol"===i.type&&(this._numSymbolLayers+=f)}_load(i,c){if(c&&Ma(this,a.validateStyle(i)))return;this._loaded=!0,this.stylesheet=a.clone$1(i),this._updateMapProjection();for(const y in i.sources)this.addSource(y,i.sources[y],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const f=Ri(this.stylesheet.layers);this._order=f.map(y=>y.id),this._layers={},this._serializedLayers={};for(let y of f)y=a.createStyleLayer(y),y.setEventedParent(this,{layer:{id:y.id}}),this._layers[y.id]=y,this._serializedLayers[y.id]=y.serialize(),this._updateLayerCount(y,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Cn(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(c,f,y){let x,D,P;const F=a.exported.devicePixelRatio>1?"@2x":"";let W=a.getJSON(f.transformRequest(f.normalizeSpriteURL(c,F,".json"),a.ResourceType.SpriteJSON),(ve,Pe)=>{W=null,P||(P=ve,x=Pe,ie())}),Z=a.getImage(f.transformRequest(f.normalizeSpriteURL(c,F,".png"),a.ResourceType.SpriteImage),(ve,Pe)=>{Z=null,P||(P=ve,D=Pe,ie())});function ie(){if(P)y(P);else if(x&&D){const ve=a.exported.getImageData(D),Pe={};for(const Oe in x){const{width:Be,height:Te,x:Ae,y:je,sdf:ze,pixelRatio:st,stretchX:Dt,stretchY:vt,content:Ut}=x[Oe],ln=new a.RGBAImage({width:Be,height:Te});a.RGBAImage.copy(ve,ln,{x:Ae,y:je},{x:0,y:0},{width:Be,height:Te}),Pe[Oe]={data:ln,pixelRatio:st,sdf:ze,stretchX:Dt,stretchY:vt,content:Ut}}y(null,Pe)}}return{cancel(){W&&(W.cancel(),W=null),Z&&(Z.cancel(),Z=null)}}}(i,this.map._requestManager,(c,f)=>{if(this._spriteRequest=null,c)this.fire(new a.ErrorEvent(c));else if(f)for(const y in f)this.imageManager.addImage(y,f[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const f=i.sourceLayer;f&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(f))&&this.fire(new a.ErrorEvent(new Error(`Source layer "${f}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const f of i){const y=this._layers[f];"custom"!==y.type&&c.push(y.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&Co[i.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(y.length||x.length)&&this._updateWorkerLayers(y,x);for(const D in this._updatedSources){const P=this._updatedSources[D];"reload"===P?this._reloadSource(D):"clear"===P&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const f={};for(const y in this._sourceCaches){const x=this._sourceCaches[y];f[y]=x.used,x.used=!1}for(const y of this._order){const x=this._layers[y];if(x.recalculate(i,this._availableImages),!x.isHidden(i.zoom)){const P=this._getLayerSourceCache(x);P&&(P.used=!0)}const D=this.map.painter;if(D){const P=x.getProgramIds();if(!P)continue;const F=x.getProgramConfiguration(i.zoom);for(const W of P)D.useProgram(W,F)}}for(const y in f){const x=this._sourceCaches[y];f[y]!==x.used&&x.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Ma(this,a.validateStyle(i)))return!1;(i=a.clone$1(i)).layers=Ri(i.layers);const c=function(y,x){if(!y)return[{command:Gn.setStyle,args:[x]}];let D=[];try{if(!de(y.version,x.version))return[{command:Gn.setStyle,args:[x]}];de(y.center,x.center)||D.push({command:Gn.setCenter,args:[x.center]}),de(y.zoom,x.zoom)||D.push({command:Gn.setZoom,args:[x.zoom]}),de(y.bearing,x.bearing)||D.push({command:Gn.setBearing,args:[x.bearing]}),de(y.pitch,x.pitch)||D.push({command:Gn.setPitch,args:[x.pitch]}),de(y.sprite,x.sprite)||D.push({command:Gn.setSprite,args:[x.sprite]}),de(y.glyphs,x.glyphs)||D.push({command:Gn.setGlyphs,args:[x.glyphs]}),de(y.transition,x.transition)||D.push({command:Gn.setTransition,args:[x.transition]}),de(y.light,x.light)||D.push({command:Gn.setLight,args:[x.light]}),de(y.fog,x.fog)||D.push({command:Gn.setFog,args:[x.fog]}),de(y.projection,x.projection)||D.push({command:Gn.setProjection,args:[x.projection]});const P={},F=[];!function(ie,ve,Pe,Oe){let Be;for(Be in ve=ve||{},ie=ie||{})ie.hasOwnProperty(Be)&&(ve.hasOwnProperty(Be)||qi(Be,Pe,Oe));for(Be in ve)ve.hasOwnProperty(Be)&&(ie.hasOwnProperty(Be)?de(ie[Be],ve[Be])||("geojson"===ie[Be].type&&"geojson"===ve[Be].type&&Xr(ie,ve,Be)?Pe.push({command:Gn.setGeoJSONSourceData,args:[Be,ve[Be].data]}):fo(Be,ve,Pe,Oe)):er(Be,ve,Pe))}(y.sources,x.sources,F,P);const W=[];y.layers&&y.layers.forEach(ie=>{ie.source&&P[ie.source]?D.push({command:Gn.removeLayer,args:[ie.id]}):W.push(ie)});let Z=y.terrain;Z&&P[Z.source]&&(D.push({command:Gn.setTerrain,args:[void 0]}),Z=void 0),D=D.concat(F),de(Z,x.terrain)||D.push({command:Gn.setTerrain,args:[x.terrain]}),function(ie,ve,Pe){ve=ve||[];const Oe=(ie=ie||[]).map(_n),Be=ve.map(_n),Te=ie.reduce(So,{}),Ae=ve.reduce(So,{}),je=Oe.slice(),ze=Object.create(null);let st,Dt,vt,Ut,ln,rn,$t;for(st=0,Dt=0;st<Oe.length;st++)vt=Oe[st],Ae.hasOwnProperty(vt)?Dt++:(Pe.push({command:Gn.removeLayer,args:[vt]}),je.splice(je.indexOf(vt,Dt),1));for(st=0,Dt=0;st<Be.length;st++)vt=Be[Be.length-1-st],je[je.length-1-st]!==vt&&(Te.hasOwnProperty(vt)?(Pe.push({command:Gn.removeLayer,args:[vt]}),je.splice(je.lastIndexOf(vt,je.length-Dt),1)):Dt++,rn=je[je.length-st],Pe.push({command:Gn.addLayer,args:[Ae[vt],rn]}),je.splice(je.length-st,0,vt),ze[vt]=!0);for(st=0;st<Be.length;st++)if(vt=Be[st],Ut=Te[vt],ln=Ae[vt],!ze[vt]&&!de(Ut,ln))if(de(Ut.source,ln.source)&&de(Ut["source-layer"],ln["source-layer"])&&de(Ut.type,ln.type)){for($t in Cr(Ut.layout,ln.layout,Pe,vt,null,Gn.setLayoutProperty),Cr(Ut.paint,ln.paint,Pe,vt,null,Gn.setPaintProperty),de(Ut.filter,ln.filter)||Pe.push({command:Gn.setFilter,args:[vt,ln.filter]}),de(Ut.minzoom,ln.minzoom)&&de(Ut.maxzoom,ln.maxzoom)||Pe.push({command:Gn.setLayerZoomRange,args:[vt,ln.minzoom,ln.maxzoom]}),Ut)Ut.hasOwnProperty($t)&&"layout"!==$t&&"paint"!==$t&&"filter"!==$t&&"metadata"!==$t&&"minzoom"!==$t&&"maxzoom"!==$t&&(0===$t.indexOf("paint.")?Cr(Ut[$t],ln[$t],Pe,vt,$t.slice(6),Gn.setPaintProperty):de(Ut[$t],ln[$t])||Pe.push({command:Gn.setLayerProperty,args:[vt,$t,ln[$t]]}));for($t in ln)ln.hasOwnProperty($t)&&!Ut.hasOwnProperty($t)&&"layout"!==$t&&"paint"!==$t&&"filter"!==$t&&"metadata"!==$t&&"minzoom"!==$t&&"maxzoom"!==$t&&(0===$t.indexOf("paint.")?Cr(Ut[$t],ln[$t],Pe,vt,$t.slice(6),Gn.setPaintProperty):de(Ut[$t],ln[$t])||Pe.push({command:Gn.setLayerProperty,args:[vt,$t,ln[$t]]}))}else Pe.push({command:Gn.removeLayer,args:[vt]}),rn=je[je.lastIndexOf(vt)+1],Pe.push({command:Gn.addLayer,args:[ln,rn]})}(W,x.layers,D)}catch(P){console.warn("Unable to compute style diff:",P),D=[{command:Gn.setStyle,args:[x]}]}return D}(this.serialize(),i).filter(y=>!(y.command in rs));if(0===c.length)return!1;const f=c.filter(y=>!(y.command in il));if(f.length>0)throw new Error(`Unimplemented: ${f.map(y=>y.command).join(", ")}.`);return c.forEach(y=>{"setTransition"!==y.command&&"setProjection"!==y.command&&this[y.command].apply(this,y.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,c){return this.getImage(i)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,c),this._afterImageUpdated(i),this)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,f={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateSource,`sources.${i}`,c,null,f))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=Ft(i,c,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:y.serialize(),sourceId:i}));const x=D=>{const P=(D?"symbol:":"other:")+i,F=this._sourceCaches[P]=new a.SourceCache(P,y,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[i]=F,F.style=this,F.onAdd(this.map)};x(!1),"vector"!==c.type&&"geojson"!==c.type||x(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(!c)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===i)return this.fire(new a.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new a.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const f=this._getSourceCaches(i);for(const y of f)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}_getSources(){const i=[];for(const c in this._otherSourceCaches){const f=this._getSourceCache(c);f&&i.push(f.getSource())}return i}addLayer(i,c,f={}){this._checkLoaded();const y=i.id;if(this.getLayer(y))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let x;if("custom"===i.type){if(Ma(this,a.validateCustomStyleLayer(i)))return;x=a.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(y,i.source),i=a.clone$1(i),i=a.extend(i,{source:y})),this._validate(a.validateLayer,`layers.${y}`,i,{arrayIndex:-1},f))return;x=a.createStyleLayer(i),this._validateLayer(x),x.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const D=c?this._order.indexOf(c):this._order.length;if(c&&-1===D)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(D,0,y),this._layerOrderChanged=!0,this._layers[y]=x;const P=this._getLayerSourceCache(x);if(this._removedLayers[y]&&x.source&&P&&"custom"!==x.type){const F=this._removedLayers[y];delete this._removedLayers[y],F.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",P.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const f=this._order.indexOf(i);this._order.splice(f,1);const y=c?this._order.indexOf(c):this._order.length;c&&-1===y?this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(y,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const f=this._order.indexOf(i);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,f){this._checkLoaded();const y=this.getLayer(i);y?y.minzoom===c&&y.maxzoom===f||(null!=c&&(y.minzoom=c),null!=f&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,f={}){this._checkLoaded();const y=this.getLayer(i);if(y){if(!de(y.filter,c))return null==c?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(a.validateFilter,`layers.${y.id}.filter`,c,{layerType:y.type},f)||(y.filter=a.clone$1(c),this._updateLayer(y)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const c=this.getLayer(i);return c&&a.clone$1(c.filter)}setLayoutProperty(i,c,f,y={}){this._checkLoaded();const x=this.getLayer(i);x?de(x.getLayoutProperty(c),f)||(x.setLayoutProperty(c,f,y),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const f=this.getLayer(i);if(f)return f.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,f,y={}){this._checkLoaded();const x=this.getLayer(i);x?de(x.getPaintProperty(c),f)||(x.setPaintProperty(c,f,y)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){const f=this.getLayer(i);return f&&f.getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const f=i.source,y=i.sourceLayer,x=this.getSource(f);if(!x)return void this.fire(new a.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const D=x.type;if("geojson"===D&&y)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===D&&!y)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const P=this._getSourceCaches(f);for(const F of P)F.setFeatureState(y,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const f=i.source,y=this.getSource(f);if(!y)return void this.fire(new a.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)));const x=y.type,D="vector"===x?i.sourceLayer:void 0;if("vector"===x&&!D)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const P=this._getSourceCaches(f);for(const F of P)F.removeFeatureState(D,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,f=i.sourceLayer,y=this.getSource(c);if(y){if("vector"!==y.type||f)return void 0===i.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(f,i.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const f=this._sourceCaches[c].getSource();i[f.id]||(i[f.id]=f.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=D=>"fill-extrusion"===this._layers[D].type,f={},y=[];for(let D=this._order.length-1;D>=0;D--){const P=this._order[D];if(c(P)){f[P]=D;for(const F of i){const W=F[P];if(W)for(const Z of W)y.push(Z)}}}y.sort((D,P)=>P.intersectionZ-D.intersectionZ);const x=[];for(let D=this._order.length-1;D>=0;D--){const P=this._order[D];if(c(P))for(let F=y.length-1;F>=0;F--){const W=y[F].feature;if(f[W.layer.id]<D)break;x.push(W),y.pop()}else for(const F of i){const W=F[P];if(W)for(const Z of W)x.push(Z.feature)}}return x}queryRenderedFeatures(i,c,f){c&&c.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const y={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of c.layers){const W=this._layers[F];if(!W)return this.fire(new a.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];y[W.source]=!0}}const x=[];c.availableImages=this._availableImages;const D=c&&c.layers?c.layers.some(F=>{const W=this.getLayer(F);return W&&W.is3D()}):this.has3DLayers(),P=Bi.createFromScreenPoints(i,f);for(const F in this._sourceCaches){const W=this._sourceCaches[F].getSource().id;c.layers&&!y[W]||x.push(le(this._sourceCaches[F],this._layers,this._serializedLayers,P,c,f,D,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(F,W,Z,ie,ve,Pe,Oe){const Be={},Te=Pe.queryRenderedSymbols(ie),Ae=[];for(const je of Object.keys(Te).map(Number))Ae.push(Oe[je]);Ae.sort(he);for(const je of Ae){const ze=je.featureIndex.lookupSymbolFeatures(Te[je.bucketInstanceId],W,je.bucketIndex,je.sourceLayerIndex,ve.filter,ve.layers,ve.availableImages,F);for(const st in ze){const Dt=Be[st]=Be[st]||[],vt=ze[st];vt.sort((Ut,ln)=>{const rn=je.featureSortOrder;if(rn){const $t=rn.indexOf(Ut.featureIndex);return rn.indexOf(ln.featureIndex)-$t}return ln.featureIndex-Ut.featureIndex});for(const Ut of vt)Dt.push(Ut)}}for(const je in Be)Be[je].forEach(ze=>{const st=ze.feature,Dt=Z(F[je]).getFeatureState(st.layer["source-layer"],st.id);st.source=st.layer.source,st.layer["source-layer"]&&(st.sourceLayer=st.layer["source-layer"]),st.state=Dt});return Be}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),P.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(i,c){c&&c.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const f=this._getSourceCaches(i);let y=[];for(const x of f)y=y.concat(_e(x,c));return y}addSourceType(i,c,f){return Wr.getSourceType(i)?f(new Error(`A source type called "${i}" already exists.`)):(Wr.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},f):f(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const D in i)if(!de(i[D],f[D])){y=!0;break}if(!y)return;const x=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,c),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===c){if("object"==typeof i.source){const f="terrain-dem-src";this.addSource(f,i.source),i=a.clone$1(i),i=a.extend(i,{source:f})}if(this._validate(a.validateTerrain,"terrain",i))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(i,c);else{const f=this.terrain,y=f.get();for(const x of Object.keys(a.spec.terrain))!i.hasOwnProperty(x)&&a.spec.terrain[x].default&&(i[x]=a.spec.terrain[x].default);for(const x in i)if(!de(i[x],y[x])){f.set(i),this.stylesheet.terrain=i;const D=this._setTransitionParameters({duration:0});f.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new vi(i,this.map.transform);this.stylesheet.fog=i;const f=this._setTransitionParameters({duration:0});c.updateTransitions(f)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,f=c.get();0===Object.keys(i).length&&c.set(i);for(const y in i)if(!de(i[y],f[y])){c.set(i),this.stylesheet.fog=i;const x=this._setTransitionParameters({duration:0});c.updateTransitions(x);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:a.exported.now(),transition:a.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(f=>this.isLayerDraped(this._layers[f])),c=this._order.filter(f=>!this.isLayerDraped(this._layers[f]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const f=this.terrain=new He(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});f.updateTransitions(y)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"symbol"===c.type&&this._updateLayer(c)}}_validate(i,c,f,y,x={}){return(!x||!1!==x.validate)&&Ma(this,i.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:f,styleSpec:a.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const f of c)f.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const f of c)f.resume(),f.reload()}_reloadSources(){for(const i of this._getSources())i.reload&&i.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,f,y,x=!1){let D=!1,P=!1;const F={};for(const W of this._order){const Z=this._layers[W];if("symbol"!==Z.type)continue;if(!F[Z.source]){const ve=this._getLayerSourceCache(Z);if(!ve)continue;F[Z.source]=ve.getRenderableIds(!0).map(Pe=>ve.getTileByID(Pe)).sort((Pe,Oe)=>Oe.tileID.overscaledZ-Pe.tileID.overscaledZ||(Pe.tileID.isLessThan(Oe.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(Z,F[Z.source],i.center.lng,i.projection);D=D||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||0===f,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),i.zoom))&&(this.pauseablePlacement=new Ho(i,this._order,x,c,f,y,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),P=!0),D&&this.pauseablePlacement.placement.setStale()),P||D)for(const W of this._order){const Z=this._layers[W];"symbol"===Z.type&&this.placement.updateLayerOpacities(Z,F[Z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,f){this.imageManager.getImages(c.icons,f),this._updateTilesForChangedImages();const y=x=>{x&&x.setDependencies(c.tileID.key,c.type,c.icons)};y(this._otherSourceCaches[c.source]),y(this._symbolSourceCaches[c.source])}getGlyphs(i,c,f){this.glyphManager.getGlyphs(c.stacks,f)}getResource(i,c,f){return a.makeRequest(c,f)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this._getSourceCaches(i);return 0===c.length?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):c.every(f=>f.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Wr.getSourceType=function(d){return Lt[d]},Wr.setSourceType=function(d,i){Lt[d]=i},Wr.registerForPluginStateChange=a.registerForPluginStateChange;var ha="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",qs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",os="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",rl="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Fr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let ml={},Fo={};const $o=[];cr(ha,$o),cr(os,$o),cr(rl,$o),cr(Fr,$o),ml=fr("",os),Fo=fr(Fr,rl);const go=fr("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),$a=ha,Ys="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var pa={background:fr("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:fr("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:fr("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:fr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:fr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:fr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:fr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:fr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:fr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:fr("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:fr("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:fr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:fr("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:fr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:fr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:fr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:fr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:fr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:fr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:fr("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:fr("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qs),skyboxGradient:fr("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",qs),skyboxCapture:fr("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:fr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:fr("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function cr(d,i){const c=d.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let f of c)if(f=f.trim(),"#"===f[0]&&f.includes("if")&&!f.includes("endif")){f=f.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=f.split(" ");for(const x of y)i.includes(x)||i.push(x)}}function fr(d,i){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},x=[...$o];return cr(d,x),cr(i,x),{fragmentSource:d=d.replace(c,(D,P,F,W,Z)=>(y[Z]=!0,"define"===P?`\n#ifndef HAS_UNIFORM_u_${Z}\nvarying ${F} ${W} ${Z};\n#else\nuniform ${F} ${W} u_${Z};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${Z}\n    ${F} ${W} ${Z} = u_${Z};\n#endif\n`)),vertexSource:i=i.replace(c,(D,P,F,W,Z)=>{const ie="float"===W?"vec2":"vec4",ve=Z.match(/color/)?"color":ie;return y[Z]?"define"===P?`\n#ifndef HAS_UNIFORM_u_${Z}\nuniform lowp float u_${Z}_t;\nattribute ${F} ${ie} a_${Z};\nvarying ${F} ${W} ${Z};\n#else\nuniform ${F} ${W} u_${Z};\n#endif\n`:"vec4"===ve?`\n#ifndef HAS_UNIFORM_u_${Z}\n    ${Z} = a_${Z};\n#else\n    ${F} ${W} ${Z} = u_${Z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Z}\n    ${Z} = unpack_mix_${ve}(a_${Z}, u_${Z}_t);\n#else\n    ${F} ${W} ${Z} = u_${Z};\n#endif\n`:"define"===P?`\n#ifndef HAS_UNIFORM_u_${Z}\nuniform lowp float u_${Z}_t;\nattribute ${F} ${ie} a_${Z};\n#else\nuniform ${F} ${W} u_${Z};\n#endif\n`:"vec4"===ve?`\n#ifndef HAS_UNIFORM_u_${Z}\n    ${F} ${W} ${Z} = a_${Z};\n#else\n    ${F} ${W} ${Z} = u_${Z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Z}\n    ${F} ${W} ${Z} = unpack_mix_${ve}(a_${Z}, u_${Z}_t);\n#else\n    ${F} ${W} ${Z} = u_${Z};\n#endif\n`}),staticAttributes:f,usedDefines:x}}class zs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,f,y,x,D,P){this.context=i;let F=this.boundPaintVertexBuffers.length!==y.length;for(let Z=0;!F&&Z<y.length;Z++)this.boundPaintVertexBuffers[Z]!==y[Z]&&(F=!0);let W=this.boundDynamicVertexBuffers.length!==P.length;for(let Z=0;!W&&Z<P.length;Z++)this.boundDynamicVertexBuffers[Z]!==P[Z]&&(W=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==f||F||W||this.boundIndexBuffer!==x||this.boundVertexOffset!==D)this.freshBind(c,f,y,x,D,P);else{i.bindVertexArrayOES.set(this.vao);for(const Z of P)Z&&Z.bind();x&&x.dynamicDraw&&x.bind()}}freshBind(i,c,f,y,x,D){let P;const F=i.numAttributes,W=this.context,Z=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),P=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=D;else{P=W.currentNumAttributes||0;for(let ie=F;ie<P;ie++)Z.disableVertexAttribArray(ie)}c.enableAttributes(Z,i),c.bind(),c.setVertexAttribPointers(Z,i,x);for(const ie of f)ie.enableAttributes(Z,i),ie.bind(),ie.setVertexAttribPointers(Z,i,x);for(const ie of D)ie&&(ie.enableAttributes(Z,i),ie.bind(),ie.setVertexAttribPointers(Z,i,x));y&&y.bind(),W.currentNumAttributes=F}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ks(d,i){const c=Math.pow(2,i.canonical.z),f=i.canonical.y;return[new a.MercatorCoordinate(0,f/c).toLngLat().lat,new a.MercatorCoordinate(0,(f+1)/c).toLngLat().lat]}function ss(d,i,c,f,y,x,D){const P=d.context,F=P.gl,W=c.fbo;if(!W)return;d.prepareDrawTile();const Z=d.useProgram("hillshade");P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,W.colorAttachment.get());const ie=((Be,Te,Ae,je)=>{const ze=Ae.paint.get("hillshade-shadow-color"),st=Ae.paint.get("hillshade-highlight-color"),Dt=Ae.paint.get("hillshade-accent-color");let vt=Ae.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ae.paint.get("hillshade-illumination-anchor")&&(vt-=Be.transform.angle);const Ut=!Be.options.moving;return{u_matrix:je||Be.transform.calculateProjMatrix(Te.tileID.toUnwrapped(),Ut),u_image:0,u_latrange:Ks(0,Te.tileID),u_light:[Ae.paint.get("hillshade-exaggeration"),vt],u_shadow:ze,u_highlight:st,u_accent:Dt}})(d,c,f,d.terrain?i.projMatrix:null);d.prepareDrawProgram(P,Z,i.toUnwrapped());const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Pe,tileBoundsSegments:Oe}=d.getTileBoundsBuffers(c);Z.draw(P,F.TRIANGLES,y,x,D,a.CullFaceMode.disabled,ie,f.id,ve,Pe,Oe)}function vs(d,i,c){if(!i.needsDEMTextureUpload)return;const f=d.context,y=f.gl;f.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||d.getTileTexture(c.stride);const x=c.getPixels();i.demTexture?i.demTexture.update(x,{premultiply:!1}):i.demTexture=new a.Texture(f,x,y.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function _o(d,i,c,f,y,x){const D=d.context,P=D.gl;if(!i.dem)return;const F=i.dem;if(D.activeTexture.set(P.TEXTURE1),vs(d,i,F),!i.demTexture)return;i.demTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE);const W=F.dim;D.activeTexture.set(P.TEXTURE0);let Z=i.fbo;if(!Z){const Oe=new a.Texture(D,{width:W,height:W,data:null},P.RGBA);Oe.bind(P.LINEAR,P.CLAMP_TO_EDGE),Z=i.fbo=D.createFramebuffer(W,W,!0),Z.colorAttachment.set(Oe.texture)}D.bindFramebuffer.set(Z.framebuffer),D.viewport.set([0,0,W,W]);const{tileBoundsBuffer:ie,tileBoundsIndexBuffer:ve,tileBoundsSegments:Pe}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(D,P.TRIANGLES,f,y,x,a.CullFaceMode.disabled,((Oe,Be)=>{const Te=Be.stride,Ae=a.create();return a.ortho(Ae,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Ae,Ae,[0,-a.EXTENT,0]),{u_matrix:Ae,u_image:1,u_dimension:[Te,Te],u_zoom:Oe.overscaledZ,u_unpack:Be.unpackVector}})(i.tileID,F),c.id,ie,ve,Pe),i.needsHillshadePrepare=!1}const Gi=d=>({u_matrix:new a.UniformMatrix4f(d),u_image0:new a.Uniform1i(d),u_skirt_height:new a.Uniform1f(d)}),Mo=(d,i)=>({u_matrix:d,u_image0:0,u_skirt_height:i}),Da=(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(f),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:x,u_image0:0,u_frustum_tl:D,u_frustum_tr:P,u_frustum_br:F,u_frustum_bl:W,u_globe_pos:Z,u_globe_radius:ie,u_viewport:ve,u_grid_matrix:Pe?Float32Array.from(Pe):new Float32Array(9)});function Ta(d,i){return null!=d&&null!=i&&!(!d.hasData()||!i.hasData())&&null!=d.demTexture&&null!=i.demTexture&&d.tileID.key!==i.tileID.key}const Us=new class{constructor(){this.operations={}}newMorphing(d,i,c,f,y){if(d in this.operations){const x=this.operations[d];x.to.tileID.key!==c.tileID.key&&(x.queued=c)}else this.operations[d]={startTime:f,phase:0,duration:y,from:i,to:c,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const i=this.operations[d];return{from:i.from,to:i.to,phase:i.phase}}update(d){for(const i in this.operations){const c=this.operations[i];for(c.phase=(d-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,d)){delete this.operations[i];break}}}_nextOp(d,i){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=i,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},as={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function As(d,i){const c=1<<d.z;return!i&&(0===d.x||d.x===c-1)||0===d.y||d.y===c-1}const Sa=d=>({u_matrix:d});function ls(d,i,c,f,y){if(y>0){const x=a.exported.now(),D=(x-d.timeAdded)/y,P=i?(x-i.timeAdded)/y:-1,F=c.getSource(),W=f.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),Z=!i||Math.abs(i.tileID.overscaledZ-W)>Math.abs(d.tileID.overscaledZ-W),ie=Z&&d.refreshedUponExpiration?1:a.clamp(Z?D:1-P,0,1);return d.refreshedUponExpiration&&D>=1&&(d.refreshedUponExpiration=!1),i?{opacity:1,mix:1-ie}:{opacity:ie,mix:0}}return{opacity:1,mix:0}}class wn extends a.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},f=new wi(Xn(),null),y=Ft("mock-dem",c,f,i.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class ar extends a.SourceCache{constructor(i){const c=Ft("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new wi(Xn(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,f){if(i.freezeTileCoverage)return;this.transform=i;const y=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,D)=>{if(x[D.key]="",!this._tiles[D.key]){const P=new a.Tile(D,this._source.tileSize*D.overscaleFactor(),i.tileZoom);P.state="loaded",this._tiles[D.key]=P}return x},{});for(const x in this._tiles)x in y||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(i){const c=this.proxyCachedFBO[i];if(void 0!==c){const f=Object.values(c);this.renderCachePool.push(...f),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Za extends a.OverscaledTileID{constructor(i,c,f){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=f}}class fa extends a.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[f,y,x]=function(F){const W=new a.StructArrayLayout4i8,Z=new a.StructArrayLayout3ui6;W.reserve(17161),Z.reserve(33800);const ve=a.EXTENT/128,Pe=a.EXTENT+ve/2,Oe=Pe+ve;for(let Te=-ve;Te<Oe;Te+=ve)for(let Ae=-ve;Ae<Oe;Ae+=ve){const je=Ae<0||Ae>Pe||Te<0||Te>Pe?24575:0,ze=a.clamp(Math.round(Ae),0,a.EXTENT),st=a.clamp(Math.round(Te),0,a.EXTENT);W.emplaceBack(ze+je,st,ze,st)}const Be=(Te,Ae)=>{const je=131*Ae+Te;Z.emplaceBack(je+1,je,je+131),Z.emplaceBack(je+131,je+131+1,je+1)};for(let Te=1;Te<129;Te++)for(let Ae=1;Ae<129;Ae++)Be(Ae,Te);return[0,129].forEach(Te=>{for(let Ae=0;Ae<130;Ae++)Be(Ae,Te),Be(Te,Ae)}),[W,Z,32768]}(),D=i.context;this.gridBuffer=D.createVertexBuffer(f,a.boundsAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(y),this.gridSegments=a.SegmentVector.simpleSegment(0,0,f.length,y.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,f.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ar(c.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,a.EXTENT,0,a.EXTENT,0,1);const P=D.gl;this._overlapStencilMode=new a.StencilMode({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new wn(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency()}update(i,c,f){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const y=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const x=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(c,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),c.updateElevation(!0,f),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&a.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,f=this.painter.transform;this._initializing&&(this._initializing=0===f._centerAltitude&&-1===this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(f.center),-1),this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map(F=>{const W=c.getTileByID(F).tileID;return W.projMatrix=f.calculateProjMatrix(W.toUnwrapped()),W});(function(F,W){const Z=W.transform.pointCoordinate(W.transform.getCameraPoint()),ie=new a.pointGeometry(Z.x,Z.y);F.sort((ve,Pe)=>{if(Pe.overscaledZ-ve.overscaledZ)return Pe.overscaledZ-ve.overscaledZ;const Oe=new a.pointGeometry(ve.canonical.x+(1<<ve.canonical.z)*ve.wrap,ve.canonical.y),Be=new a.pointGeometry(Pe.canonical.x+(1<<Pe.canonical.z)*Pe.wrap,Pe.canonical.y),Te=ie.mult(1<<ve.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(Oe)-Te.distSqr(Be)})})(y,this.painter),this._previousZoom=f.zoom;const x=this.proxyToSource||{};this.proxyToSource={},y.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const F in D){const W=D[F];if(!W.used||(W!==this.sourceCache&&this.resetTileLookupCache(W.id),this._setupProxiedCoordsForOrtho(W,i[F],x),W.usedForTerrain))continue;const Z=i[F];W.getSource().reparseOverscaled&&this._assignTerrainTiles(Z)}this.proxiedCoords[c.id]=y.map(F=>new Za(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const P={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const W=this.terrainTileForTile[F.key];if(!W)continue;const Z=W.tileID.key;Z in P||(this._visibleDemTiles.push(W),P[Z]=Z)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const f=this._findTileCoveringTileID(c,this.sourceCache);f&&(this.terrainTileForTile[c.key]=f)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const f in this.terrainTileForTile){const y=this.terrainTileForTile[f],x=y.dem;!x||y.demTexture&&!y.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),vs(this.painter,y,x))}}_prepareDemTileUniforms(i,c,f,y){if(!c||null==c.demTexture)return!1;const x=i.tileID.canonical,D=Math.pow(2,c.tileID.canonical.z-x.z),P=y||"";return f[`u_dem_tl${P}`]=[x.x*D%1,x.y*D%1],f[`u_dem_scale${P}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const f=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(i,f,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((f,y)=>{if(!y.dem)return f;const x=y.dem.tree.minimums[0];return x>0&&i++,f+x},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const f=this._getLoadedAreaMinimum(),y=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(f,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(y,{premultiply:!1}):x=this._emptyDEMTexture=new a.Texture(i,y,c.RGBA,{premultiply:!1}),x}setupElevationDraw(i,c,f){const y=this.painter.context,x=y.gl,D=(P=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(P),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var P;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let F=null,W=null,Z=1;if(f&&f.morphing&&this._useVertexMorphing){const ie=f.morphing.srcDemTile,ve=f.morphing.dstDemTile;Z=f.morphing.phase,ie&&ve&&(this._prepareDemTileUniforms(i,ie,D,"_prev")&&(W=ie),this._prepareDemTileUniforms(i,ve,D)&&(F=ve))}if(W&&F?(y.activeTexture.set(x.TEXTURE2),F.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),y.activeTexture.set(x.TEXTURE4),W.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),D.u_dem_lerp=Z):(F=this.terrainTileForTile[i.tileID.key],y.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(i,F,D)?F.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),y.activeTexture.set(x.TEXTURE3),f&&f.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),f&&f.useMeterToDem&&F){const ie=(1<<F.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=ie}if(f&&f.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=f.labelPlaneMatrixInv),c.setTerrainUniformValues(y,D),"globe"===this.painter.transform.projection.name){const ie=this.globeUniformValues(this.painter.transform,i.tileID.canonical,f&&f.useDenormalizedUpVectorScale);c.setGlobeUniformValues(y,ie)}}globeUniformValues(i,c,f){const y=i.projection;return{u_tile_tl_up:y.upVector(c,0,0),u_tile_tr_up:y.upVector(c,a.EXTENT,0),u_tile_br_up:y.upVector(c,a.EXTENT,a.EXTENT),u_tile_bl_up:y.upVector(c,0,a.EXTENT),u_tile_up_scale:f?a.GLOBE_METERS_TO_ECEF:y.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,f=this.painter.context;0!==i.length&&(f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,x,D,P,F){if("globe"===y.transform.projection.name)!function(W,Z,ie,ve,Pe){const Oe=W.context,Be=Oe.gl;let Te,Ae;const je=W.options.showTerrainWireframe?2:0,ze=W.transform,st=a.globeUseCustomAntiAliasing(W,Oe,ze),Dt=(Wn,pn)=>{if(Ae===Wn)return;const Un=[as[Wn],"PROJECTION_GLOBE_VIEW"];st&&Un.push("CUSTOM_ANTIALIASING"),pn&&Un.push(as[je]),Te=W.useProgram("globeRaster",null,Un),Ae=Wn},vt=W.colorModeForRenderPass(),Ut=new a.DepthMode(Be.LEQUAL,a.DepthMode.ReadWrite,W.depthRangeFor3D);Us.update(Pe);const ln=a.calculateGlobeMercatorMatrix(ze),rn=[a.mercatorXfromLng(ze.center.lng),a.mercatorYfromLat(ze.center.lat)],$t=je?[!1,!0]:[!1],qn=W.globeSharedBuffers,Kt=[ze.width*a.exported.devicePixelRatio,ze.height*a.exported.devicePixelRatio],Pn=Float32Array.from(ze.globeMatrix),mn={useDenormalizedUpVectorScale:!0};if($t.forEach(Wn=>{Ae=-1;const pn=Wn?Be.LINES:Be.TRIANGLES;for(const Un of ve){const Qn=ie.getTile(Un),qt=a.StencilMode.disabled,dn=Z.prevTerrainTileForTile[Un.key],Ei=Z.terrainTileForTile[Un.key];Ta(dn,Ei)&&Us.newMorphing(Un.key,dn,Ei,Pe,250),Oe.activeTexture.set(Be.TEXTURE0),Qn.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE);const ki=Us.getMorphValuesForProxy(Un.key),Ci=ki?1:0;ki&&a.extend$1(mn,{morphing:{srcDemTile:ki.from,dstDemTile:ki.to,phase:a.easeCubicInOut(ki.phase)}});const ji=a.tileCornersToBounds(Un.canonical),or=a.getLatitudinalLod(ji.getCenter().lat),Pi=a.getGridMatrix(Un.canonical,ji,or,ze.worldSize/ze._pixelsPerMercatorPixel),gi=a.globeNormalizeECEF(a.globeTileBounds(Un.canonical)),jr=Da(ze.projMatrix,Pn,ln,gi,a.globeToMercatorTransition(ze.zoom),rn,ze.frustumCorners.TL,ze.frustumCorners.TR,ze.frustumCorners.BR,ze.frustumCorners.BL,ze.globeCenterInViewSpace,ze.globeRadius,Kt,Pi);if(Dt(Ci,Wn),Z.setupElevationDraw(Qn,Te,mn),W.prepareDrawProgram(Oe,Te,Un.toUnwrapped()),qn){const[Pr,so,Hr]=Wn?qn.getWirefameBuffers(W.context,or):qn.getGridBuffers(or);Te.draw(Oe,pn,Ut,qt,vt,a.CullFaceMode.backCCW,jr,"globe_raster",Pr,so,Hr)}}}),qn){const Wn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];st&&Wn.push("CUSTOM_ANTIALIASING"),Te=W.useProgram("globeRaster",null,Wn);for(const pn of ve){const{x:Un,y:Qn,z:qt}=pn.canonical,dn=0===Qn,Ei=Qn===(1<<qt)-1,[ki,Ci,ji,or]=qn.getPoleBuffers(qt);if(or&&(dn||Ei)){const Pi=ie.getTile(pn);Oe.activeTexture.set(Be.TEXTURE0),Pi.texture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE);let gi=a.globePoleMatrixForTile(qt,Un,ze);const jr=a.globeNormalizeECEF(a.globeTileBounds(pn.canonical)),Pr=(so,Hr)=>so.draw(Oe,Be.TRIANGLES,Ut,a.StencilMode.disabled,vt,a.CullFaceMode.disabled,Da(ze.projMatrix,gi,gi,jr,0,rn,ze.frustumCorners.TL,ze.frustumCorners.TR,ze.frustumCorners.BR,ze.frustumCorners.BL,ze.globeCenterInViewSpace,ze.globeRadius,Kt),"globe_pole_raster",Hr,ji,or);Z.setupElevationDraw(Pi,Te,mn),W.prepareDrawProgram(Oe,Te,pn.toUnwrapped()),dn&&Pr(Te,ki),Ei&&(gi=a.scale(a.create(),gi,[1,-1,1]),Pr(Te,Ci))}}}}(y,x,D,P,F);else{const W=y.context,Z=W.gl;let ie,ve;const Pe=y.options.showTerrainWireframe?2:0,Oe=(ze,st)=>{if(ve===ze)return;const Dt=[as[ze]];st&&Dt.push(as[Pe]),ie=y.useProgram("terrainRaster",null,Dt),ve=ze},Be=y.colorModeForRenderPass(),Te=new a.DepthMode(Z.LEQUAL,a.DepthMode.ReadWrite,y.depthRangeFor3D);Us.update(F);const Ae=y.transform,je=6*Math.pow(1.5,22-Ae.zoom)*x.exaggeration();(Pe?[!1,!0]:[!1]).forEach(ze=>{ve=-1;const st=ze?Z.LINES:Z.TRIANGLES,[Dt,vt]=ze?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const Ut of P){const ln=D.getTile(Ut),rn=a.StencilMode.disabled,$t=x.prevTerrainTileForTile[Ut.key],qn=x.terrainTileForTile[Ut.key];Ta($t,qn)&&Us.newMorphing(Ut.key,$t,qn,F,250),W.activeTexture.set(Z.TEXTURE0),ln.texture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST);const Kt=Us.getMorphValuesForProxy(Ut.key),Pn=Kt?1:0;let mn;Kt&&(mn={morphing:{srcDemTile:Kt.from,dstDemTile:Kt.to,phase:a.easeCubicInOut(Kt.phase)}});const Wn=Mo(Ut.projMatrix,As(Ut.canonical,Ae.renderWorldCopies)?je/10:je);Oe(Pn,ze),x.setupElevationDraw(ln,ie,mn),y.prepareDrawProgram(W,ie,Ut.toUnwrapped()),ie.draw(W,st,Te,rn,Be,a.CullFaceMode.backCCW,Wn,"terrain_raster",x.gridBuffer,Dt,vt)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const c=this.painter,f=this.painter.context,y=this.proxySourceCache,x=this.proxiedCoords[y.id],D=this._drapedRenderBatches.shift(),P=[],F=c.style.order;let W=0;for(const Z of x){const ie=y.getTileByID(Z.proxyTileKey),ve=y.proxyCachedFBO[Z.key]?y.proxyCachedFBO[Z.key][i]:void 0,Pe=void 0!==ve?y.renderCache[ve]:this.pool[W++],Oe=void 0!==ve;if(ie.texture=Pe.tex,Oe&&!Pe.dirty){P.push(ie.tileID);continue}let Be;f.bindFramebuffer.set(Pe.fb.framebuffer),this.renderedToTile=!1,Pe.dirty&&(f.clear({color:a.Color.transparent,stencil:0}),Pe.dirty=!1);for(let Te=D.start;Te<=D.end;++Te){const Ae=c.style._layers[F[Te]];if(Ae.isHidden(c.transform.zoom))continue;const je=c.style._getLayerSourceCache(Ae),ze=je?this.proxyToSource[Z.key][je.id]:[Z];if(!ze)continue;const st=ze;f.viewport.set([0,0,Pe.fb.width,Pe.fb.height]),Be!==(je?je.id:null)&&(this._setupStencil(Pe,ze,Ae,je),Be=je?je.id:null),c.renderLayer(c,je,Ae,st)}this.renderedToTile?(Pe.dirty=!0,P.push(ie.tileID)):Oe||--W,5===W&&(W=0,this.renderToBackBuffer(P))}return this.renderToBackBuffer(P),this.renderingToTexture=!1,f.bindFramebuffer.set(null),f.viewport.set([0,0,c.width,c.height]),D.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(0===c)return{efficiency:100};let f,y=0,x=0,D=!1;for(let P=0;P<c;++P){const F=i._layers[i.order[P]];this._style.isLayerDraped(F)?(D&&++y,++x):D||(D=!0,f=F.id)}return 0===x?{efficiency:100}:{efficiency:100*(1-y/x),firstUndrapedLayer:f}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,c,f){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const D=x.tileID,P=1<<D.overscaledZ,{x:F,y:W}=D.canonical,Z=F/P,ie=(F+1)/P,ve=W/P,Pe=(W+1)/P;return{minx:Z,miny:ve,maxx:ie,maxy:Pe,t:x.dem.tree.raycastRoot(Z,ve,ie,Pe,i,c,f),tile:x}});y.sort((x,D)=>(null!==x.t?x.t:Number.MAX_VALUE)-(null!==D.t?D.t:Number.MAX_VALUE));for(const x of y){if(null==x.t)return null;const D=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,i,c,f);if(null!=D)return D}return null}_createFBO(){const i=this.painter.context,c=i.gl,f=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const y=new a.Texture(i,{width:f[0],height:f[1],data:null},c.RGBA);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const x=i.createFramebuffer(f[0],f[1],!1);return x.colorAttachment.set(y.texture),x.depthAttachment=new ri(i,x.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,f[0],f[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:x,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],f=c.isHidden(this.painter.transform.zoom);return"custom"!==c.type&&!f&&c.hasTransition()})}_clearRasterFadeFromRenderCache(){let i=!1;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c]._source instanceof oe){i=!0;break}if(i)for(let c=0;c<this._style.order.length;++c){const f=this._style._layers[this._style.order[c]],y=f.isHidden(this.painter.transform.zoom),x=this._style._getLayerSourceCache(f);if("raster"!==f.type||y||!x)continue;const D=f.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const F=this.proxyToSource[P.key][x.id];if(F)for(const W of F){const Z=ls(x.getTile(W),x.findLoadedParent(W,0),x,this.painter.transform,D);(1!==Z.opacity||0!==Z.mix)&&this._clearRenderCacheForTile(x.id,W)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(0===c)return;const f=[];let y,x=0,D=this._style._layers[i[x]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++x<c;)D=this._style._layers[i[x]];for(;x<c;++x){const P=this._style._layers[i[x]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?void 0===y&&(y=x):void 0!==y&&(f.push({start:y,end:x-1}),y=void 0))}void 0!==y&&f.push({start:y,end:x-1}),this._drapedRenderBatches=f}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const D=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let P=0;P<D.length;++P){const F=Object.values(D[P]);c.renderCachePool.push(...F)}}return}this._clearRasterFadeFromRenderCache();const f=this.proxyCoords,y=this._tilesDirty;for(let D=f.length-1;D>=0;D--){const P=f[D];if(c.getTileByID(P.key),void 0!==c.proxyCachedFBO[P.key]){const F=i[P.key],W=this.proxyToSource[P.key];let Z=0;for(const ie in W){const ve=W[ie],Pe=F[ie];if(!Pe||Pe.length!==ve.length||ve.some((Oe,Be)=>Oe!==Pe[Be]||y[ie]&&y[ie].hasOwnProperty(Oe.key))){Z=-1;break}++Z}for(const ie in c.proxyCachedFBO[P.key])c.renderCache[c.proxyCachedFBO[P.key][ie]].dirty=Z<0||Z!==Object.values(F).length}}const x=[...this._drapedRenderBatches];x.sort((D,P)=>P.end-P.start-(D.end-D.start));for(const D of x)for(const P of f){if(c.proxyCachedFBO[P.key])continue;let F=c.renderCachePool.pop();void 0===F&&c.renderCache.length<50&&(F=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==F&&(c.proxyCachedFBO[P.key]={},c.proxyCachedFBO[P.key][D.start]=F,c.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,f,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,D=x.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let P;if(f.isTileClipped())P=c.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,f.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(i,c){const f=this.painter,y=this.painter.context,x=y.gl;f._tileClippingMaskIDs={},y.setColorMode(a.ColorMode.disabled),y.setDepthMode(a.DepthMode.disabled);const D=f.useProgram("clippingMask");for(const P of i){const F=f._tileClippingMaskIDs[P.key]=--c;D.draw(y,x.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:x.ALWAYS,mask:0},F,255,x.KEEP,x.KEEP,x.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Sa(P.projMatrix),"$clipping",f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const f=[i.x,i.y,1,1];a.transformMat4$1(f,f,c.pixelMatrixInverse),a.scale$1(f,f,1/f[3]),f[0]/=c.worldSize,f[1]/=c.worldSize;const y=c._camera.position,x=a.mercatorZfromAltitude(1,c.center.lat),D=[y[0],y[1],y[2]/x,0],P=a.subtract([],f.slice(0,3),D);a.normalize(P,P);const F=this.raycast(D,P,this._exaggeration);return null!==F&&F?(a.scaleAndAdd(D,D,P,F),D[3]=D[2],D[2]*=x,D):null}drawDepth(){const i=this.painter,c=i.context,f=this.proxySourceCache,y=Math.ceil(i.width),x=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===x||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=c.gl,P=c.createFramebuffer(y,x,!0);c.activeTexture.set(D.TEXTURE0);const F=new a.Texture(c,{width:y,height:x,data:null},D.RGBA);F.bind(D.NEAREST,D.CLAMP_TO_EDGE),P.colorAttachment.set(F.texture);const W=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,y,x);P.depthAttachment.set(W),this._depthFBO=P,this._depthTexture=F}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,y,x]),function(D,P,F,W){if("globe"===D.transform.projection.name)return;const Z=D.context,ie=Z.gl;Z.clear({depth:1});const ve=D.useProgram("terrainDepth"),Pe=new a.DepthMode(ie.LESS,a.DepthMode.ReadWrite,D.depthRangeFor3D);for(const Oe of W){const Be=F.getTile(Oe),Te=Mo(Oe.projMatrix,0);P.setupElevationDraw(Be,ve),ve.draw(Z,ie.TRIANGLES,Pe,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,Te,"terrain_depth",P.gridBuffer,P.gridIndexBuffer,P.gridNoSkirtSegments)}}(i,this,f,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,f){if(i.getSource()instanceof ct)return this._setupProxiedCoordsForImageSource(i,c,f);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const y=this.proxiedCoords[i.id]=[],x=this.proxyCoords;for(let P=0;P<x.length;P++){const F=x[P],W=this._findTileCoveringTileID(F,i);if(W){const Z=this._createProxiedId(F,W,f[F.key]&&f[F.key][i.id]);y.push(Z),this.proxyToSource[F.key][i.id]=[Z]}}let D=!1;for(let P=0;P<c.length;P++){const F=i.getTile(c[P]);if(!F||!F.hasData())continue;const W=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==F.tileID.canonical.z){const Z=this.proxyToSource[W.tileID.key][i.id],ie=this._createProxiedId(W.tileID,F,f[W.tileID.key]&&f[W.tileID.key][i.id]);Z?Z.splice(Z.length-1,0,ie):this.proxyToSource[W.tileID.key][i.id]=[ie],y.push(ie),D=!0}}this._sourceTilesOverlap[i.id]=D}_setupProxiedCoordsForImageSource(i,c,f){if(!i.getSource().loaded())return;const y=this.proxiedCoords[i.id]=[],x=this.proxyCoords,D=i.getSource(),P=new a.pointGeometry(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),F=D.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((Z,ie)=>(Z.min.x=Math.min(Z.min.x,ie.x-P.x),Z.min.y=Math.min(Z.min.y,ie.y-P.y),Z.max.x=Math.max(Z.max.x,ie.x-P.x),Z.max.y=Math.max(Z.max.y,ie.y-P.y),Z),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(Z,ie)=>{const ve=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),Pe=Z.canonical.y/(1<<Z.canonical.z),Oe=a.EXTENT/(1<<Z.canonical.z),Be=ie.wrap+ie.canonical.x/(1<<ie.canonical.z),Te=ie.canonical.y/(1<<ie.canonical.z);return ve+Oe<Be+F.min.x||ve>Be+F.max.x||Pe+Oe<Te+F.min.y||Pe>Te+F.max.y};for(let Z=0;Z<x.length;Z++){const ie=x[Z];for(let ve=0;ve<c.length;ve++){const Pe=i.getTile(c[ve]);if(!Pe||!Pe.hasData()||W(ie,Pe.tileID))continue;const Oe=this._createProxiedId(ie,Pe,f[ie.key]&&f[ie.key][i.id]),Be=this.proxyToSource[ie.key][i.id];Be?Be.push(Oe):this.proxyToSource[ie.key][i.id]=[Oe],y.push(Oe)}}}_createProxiedId(i,c,f){let y=this.orthoMatrix;if(f){const x=f.find(D=>D.key===c.tileID.key);if(x)return x}if(c.tileID.key!==i.key){const x=i.canonical.z-c.tileID.canonical.z;let D,P,F;y=a.create();const W=c.tileID.wrap-i.wrap<<i.overscaledZ;x>0?(D=a.EXTENT>>x,P=D*((c.tileID.canonical.x<<x)-i.canonical.x+W),F=D*((c.tileID.canonical.y<<x)-i.canonical.y)):(D=a.EXTENT<<-x,P=a.EXTENT*(c.tileID.canonical.x-(i.canonical.x+W<<-x)),F=a.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-x))),a.ortho(y,0,D,0,D,0,1),a.translate(y,y,[P,F,0])}return new Za(c.tileID,i.key,y)}_findTileCoveringTileID(i,c){let f=c.getTile(i);if(f&&f.hasData())return f;const y=this._findCoveringTileCache[c.id],x=y[i.key];if(f=x?c.getTileByID(x):null,f&&f.hasData()||null===x)return f;let D=f?f.tileID:i,P=D.overscaledZ;const F=c.getSource().minzoom,W=[];if(!x){const ie=c.getSource().maxzoom;if(i.canonical.z>=ie){const ve=i.canonical.z-ie;c.getSource().reparseOverscaled?(P=Math.max(i.canonical.z+2,c.transform.tileZoom),D=new a.OverscaledTileID(P,i.wrap,ie,i.canonical.x>>ve,i.canonical.y>>ve)):0!==ve&&(P=ie,D=new a.OverscaledTileID(P,i.wrap,ie,i.canonical.x>>ve,i.canonical.y>>ve))}D.key!==i.key&&(W.push(D.key),f=c.getTile(D))}const Z=ie=>{W.forEach(ve=>{y[ve]=ie}),W.length=0};for(P-=1;P>=F&&(!f||!f.hasData());P--){f&&Z(f.tileID.key);const ie=D.calculateScaledKey(P);if(f=c.getTileByID(ie),f&&f.hasData())break;const ve=y[ie];if(null===ve)break;void 0===ve?W.push(ie):f=c.getTileByID(ve)}return Z(f?f.tileID.key:null),f&&f.hasData()?f:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let f=this._tilesDirty[i];f||(f=this._tilesDirty[i]={}),f[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let f=0;const y=new a.StructArrayLayout2ui4,x=131;for(let D=1;D<129;D++){for(let P=1;P<129;P++)f=D*x+P,y.emplaceBack(f,f+1),y.emplaceBack(f,f+x),y.emplaceBack(f+1,f+x),128===D&&y.emplaceBack(f+x,f+x+1);y.emplaceBack(f+1,f+1+x)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class zr{static cacheKey(i,c,f,y){let x=`${c}${y?y.cacheKey:""}`;for(const D of f)i.usedDefines.includes(D)&&(x+=`/${D}`);return x}constructor(i,c,f,y,x,D){const P=i.gl;this.program=P.createProgram();const F=function(Te){const Ae=[];for(let je=0;je<Te.length;je++){if(null===Te[je])continue;const ze=Te[je].split(" ");Ae.push(ze.pop())}return Ae}(f.staticAttributes),W=y?y.getBinderAttributes():[],Z=F.concat(W);let ie=y?y.defines():[];ie=ie.concat(D.map(Te=>`#define ${Te}`));const ve=ie.concat(i.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(Ys):Ys,Ys,$a,go.fragmentSource,Fo.fragmentSource,f.fragmentSource).join("\n"),Pe=ie.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",$a,go.vertexSource,Fo.vertexSource,ml.vertexSource,f.vertexSource).join("\n"),Oe=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(Oe,ve),P.compileShader(Oe),P.attachShader(this.program,Oe);const Be=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(Be,Pe),P.compileShader(Be),P.attachShader(this.program,Be),this.attributes={},this.numAttributes=Z.length;for(let Te=0;Te<this.numAttributes;Te++)Z[Te]&&(P.bindAttribLocation(this.program,Te,Z[Te]),this.attributes[Z[Te]]=Te);P.linkProgram(this.program),P.deleteShader(Be),P.deleteShader(Oe),this.fixedUniforms=x(i),this.binderUniforms=y?y.getUniforms(i):[],D.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new a.Uniform1i(Te=i),u_dem_prev:new a.Uniform1i(Te),u_dem_unpack:new a.Uniform4f(Te),u_dem_tl:new a.Uniform2f(Te),u_dem_scale:new a.Uniform1f(Te),u_dem_tl_prev:new a.Uniform2f(Te),u_dem_scale_prev:new a.Uniform1f(Te),u_dem_size:new a.Uniform1f(Te),u_dem_lerp:new a.Uniform1f(Te),u_exaggeration:new a.Uniform1f(Te),u_depth:new a.Uniform1i(Te),u_depth_size_inv:new a.Uniform2f(Te),u_meter_to_dem:new a.Uniform1f(Te),u_label_plane_matrix_inv:new a.UniformMatrix4f(Te)}),D.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new a.Uniform3f(Te),u_tile_tr_up:new a.Uniform3f(Te),u_tile_br_up:new a.Uniform3f(Te),u_tile_bl_up:new a.Uniform3f(Te),u_tile_up_scale:new a.Uniform1f(Te)}))(i)),D.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new a.UniformMatrix4f(Te),u_fog_range:new a.Uniform2f(Te),u_fog_color:new a.Uniform4f(Te),u_fog_horizon_blend:new a.Uniform1f(Te),u_fog_temporal_offset:new a.Uniform1f(Te),u_frustum_tl:new a.Uniform3f(Te),u_frustum_tr:new a.Uniform3f(Te),u_frustum_br:new a.Uniform3f(Te),u_frustum_bl:new a.Uniform3f(Te),u_globe_pos:new a.Uniform3f(Te),u_globe_radius:new a.Uniform1f(Te),u_globe_transition:new a.Uniform1f(Te),u_is_globe:new a.Uniform1i(Te),u_viewport:new a.Uniform2f(Te)}))(i))}var Te}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const f=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)f[y]&&f[y].set(this.program,y,c[y])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const f=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)f[y]&&f[y].set(this.program,y,c[y])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const f=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)f[y].set(this.program,y,c[y])}}draw(i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be){const Te=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(f),i.setStencilMode(y),i.setColorMode(x),i.setCullFace(D);for(const je of Object.keys(this.fixedUniforms))this.fixedUniforms[je].set(this.program,je,P[je]);Oe&&Oe.setUniforms(this.program,i,this.binderUniforms,ve,{zoom:Pe});const Ae={[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[c];for(const je of ie.get()){const ze=je.vaos||(je.vaos={});(ze[F]||(ze[F]=new zs)).bind(i,this,W,Oe?Oe.getPaintVertexBuffers():[],Z,je.vertexOffset,Be||[]),Te.drawElements(c,je.primitiveLength*Ae,Te.UNSIGNED_SHORT,je.primitiveOffset*Ae*2)}}}function Q(d,i){const c=Math.pow(2,i.tileID.overscaledZ),f=i.tileSize*Math.pow(2,d.transform.tileZoom)/c,y=f*(i.tileID.canonical.x+i.tileID.wrap*c),x=f*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_tile_units_to_pixels:1/Nn(i,1,d.transform.tileZoom),u_pixel_coord_upper:[y>>16,x>>16],u_pixel_coord_lower:[65535&y,65535&x]}}const q=a.create(),j=(d,i,c,f,y,x,D,P,F,W,Z)=>{const ie=i.style.light,ve=ie.properties.get("position"),Pe=[ve.x,ve.y,ve.z],Oe=a.create$1();"viewport"===ie.properties.get("anchor")&&(a.fromRotation(Oe,-i.transform.angle),a.transformMat3(Pe,Pe,Oe));const Be=ie.properties.get("color"),Te=i.transform,Ae={u_matrix:d,u_lightpos:Pe,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_vertical_gradient:+c,u_opacity:f,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:q,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:x};return"globe"===Te.projection.name&&(Ae.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Ae.u_zoom_transition=F,Ae.u_inv_rot_matrix=Z,Ae.u_merc_center=W,Ae.u_up_dir=Te.projection.upVector(new a.CanonicalTileID(0,0,0),W[0]*a.EXTENT,W[1]*a.EXTENT),Ae.u_height_lift=P),Ae},be=(d,i,c,f,y,x,D,P,F,W,Z,ie)=>{const ve=j(d,i,c,f,y,x,D,F,W,Z,ie),Pe={u_height_factor:-Math.pow(2,D.overscaledZ)/P.tileSize/8};return a.extend(ve,Q(i,P),Pe)},En=d=>({u_matrix:d}),bi=(d,i,c)=>a.extend(En(d),Q(i,c)),io=(d,i)=>({u_matrix:d,u_world:i}),Is=(d,i,c,f)=>a.extend(bi(d,i,c),{u_world:f}),xs=a.create(),Lr=(d,i,c,f,y,x)=>{const D=d.transform,P="globe"===D.projection.name;let F;if("map"===x.paint.get("circle-pitch-alignment"))if(P){const Z=a.globePixelsToTileUnits(D.zoom,i.canonical)*D._pixelsPerMercatorPixel;F=Float32Array.from([Z,0,0,Z])}else F=D.calculatePixelsToTileUnitsMatrix(c);else F=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const W={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:d.translatePosMatrix(i.projMatrix,c,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:xs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){W.u_inv_rot_matrix=f,W.u_merc_center=y,W.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],W.u_zoom_transition=a.globeToMercatorTransition(D.zoom);const Z=y[0]*a.EXTENT,ie=y[1]*a.EXTENT;W.u_up_dir=D.projection.upVector(new a.CanonicalTileID(0,0,0),Z,ie)}return W},Zo=d=>{const i=[];return"map"===d.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===d.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},Aa=(d,i,c,f)=>{const y=a.EXTENT/c.tileSize;return{u_matrix:d,u_camera_to_center_distance:i.getCameraToCenterDistance(f),u_extrude_scale:[i.pixelsToGLUnits[0]/y,i.pixelsToGLUnits[1]/y]}},Vs=(d,i,c=1)=>({u_matrix:d,u_color:i,u_overlay:0,u_overlay_scale:c}),Xs=a.create(),Ll=(d,i,c,f,y,x,D)=>{const P=d.transform,F="globe"===P.projection.name,W=F?a.globePixelsToTileUnits(P.zoom,i.canonical)*P._pixelsPerMercatorPixel:Nn(c,1,x),Z={u_matrix:i.projMatrix,u_extrude_scale:W,u_intensity:D,u_inv_rot_matrix:Xs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){Z.u_inv_rot_matrix=f,Z.u_merc_center=y,Z.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],Z.u_zoom_transition=a.globeToMercatorTransition(P.zoom);const ie=y[0]*a.EXTENT,ve=y[1]*a.EXTENT;Z.u_up_dir=P.projection.upVector(new a.CanonicalTileID(0,0,0),ie,ve)}return Z},Bl=(d,i,c,f,y,x,D)=>{const P=d.transform,F=P.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:sl(d,i,c,f),u_pixels_to_tile_units:F,u_device_pixel_ratio:x,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:Wa(c)?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:ol(i,d.transform),u_alpha_discard_threshold:0,u_trim_offset:D}},js=(d,i,c,f,y)=>{const x=d.transform;return{u_matrix:sl(d,i,c,f),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:ol(i,x),u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ol(d,i){return 1/Nn(d,1,i.tileZoom)}function sl(d,i,c,f){return d.translatePosMatrix(f||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Wa(d){const i=d.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const ec=(d,i,c,f,y,x)=>{return{u_matrix:d,u_tl_parent:i,u_scale_parent:c,u_fade_t:f.mix,u_opacity:f.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(P=y.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(D=y.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:gl(y.paint.get("raster-hue-rotate")),u_perspective_transform:x};var D,P};function gl(d){d*=Math.PI/180;const i=Math.sin(d),c=Math.cos(d);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const Nl=a.create(),Xo=(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be)=>{const Te=y.transform,Ae={u_is_size_zoom_constant:+("constant"===d||"source"===d),u_is_size_feature_constant:+("constant"===d||"camera"===d),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Te.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:Te.width/Te.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:D,u_coord_matrix:P,u_is_text:+F,u_pitch_with_map:+f,u_texsize:W,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Nl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Nl,u_up_vector:[0,-1,0]};return"globe"===Be.name&&(Ae.u_tile_id=[Z.canonical.x,Z.canonical.y,1<<Z.canonical.z],Ae.u_zoom_transition=ie,Ae.u_inv_rot_matrix=Pe,Ae.u_merc_center=ve,Ae.u_camera_forward=Te._camera.forward(),Ae.u_ecef_origin=a.globeECEFOrigin(Te.globeMatrix,Z.toUnwrapped()),Ae.u_tile_matrix=Float32Array.from(Te.globeMatrix),Ae.u_up_vector=Oe),Ae},al=(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be,Te)=>a.extend(Xo(d,i,c,f,y,x,D,P,F,W,ie,ve,Pe,Oe,Be,Te),{u_gamma_scale:f?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+Z}),Ia=(d,i,c,f,y,x,D,P,F,W,Z,ie,ve,Pe,Oe,Be)=>a.extend(al(d,i,c,f,y,x,D,P,!0,F,!0,Z,ie,ve,Pe,Oe,Be),{u_texsize_icon:W,u_texture_icon:1}),vc=(d,i,c)=>({u_matrix:d,u_opacity:i,u_color:c}),zl=(d,i,c,f,y)=>a.extend(function(x,D,P){const F=D.imageManager.getPattern(x.toString()),{width:W,height:Z}=D.imageManager.getPixelSize(),ie=Math.pow(2,P.tileID.overscaledZ),ve=P.tileSize*Math.pow(2,D.transform.tileZoom)/ie,Pe=ve*(P.tileID.canonical.x+P.tileID.wrap*ie),Oe=ve*P.tileID.canonical.y;return{u_image:0,u_pattern_tl:F.tl,u_pattern_br:F.br,u_texsize:[W,Z],u_pattern_size:F.displaySize,u_tile_units_to_pixels:1/Nn(P,1,D.transform.tileZoom),u_pixel_coord_upper:[Pe>>16,Oe>>16],u_pixel_coord_lower:[65535&Pe,65535&Oe]}}(f,c,y),{u_matrix:d,u_opacity:i}),z={fillExtrusion:d=>({u_matrix:new a.UniformMatrix4f(d),u_lightpos:new a.Uniform3f(d),u_lightintensity:new a.Uniform1f(d),u_lightcolor:new a.Uniform3f(d),u_vertical_gradient:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_edge_radius:new a.Uniform1f(d),u_ao:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_up_dir:new a.Uniform3f(d),u_height_lift:new a.Uniform1f(d)}),fillExtrusionPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_lightpos:new a.Uniform3f(d),u_lightintensity:new a.Uniform1f(d),u_lightcolor:new a.Uniform3f(d),u_vertical_gradient:new a.Uniform1f(d),u_height_factor:new a.Uniform1f(d),u_edge_radius:new a.Uniform1f(d),u_ao:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_up_dir:new a.Uniform3f(d),u_height_lift:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d)}),fill:d=>({u_matrix:new a.UniformMatrix4f(d)}),fillPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),fillOutline:d=>({u_matrix:new a.UniformMatrix4f(d),u_world:new a.Uniform2f(d)}),fillOutlinePattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_world:new a.Uniform2f(d),u_image:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),circle:d=>({u_camera_to_center_distance:new a.Uniform1f(d),u_extrude_scale:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_up_dir:new a.Uniform3f(d)}),collisionBox:d=>({u_matrix:new a.UniformMatrix4f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_extrude_scale:new a.Uniform2f(d)}),collisionCircle:d=>({u_matrix:new a.UniformMatrix4f(d),u_inv_matrix:new a.UniformMatrix4f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_viewport_size:new a.Uniform2f(d)}),debug:d=>({u_color:new a.UniformColor(d),u_matrix:new a.UniformMatrix4f(d),u_overlay:new a.Uniform1i(d),u_overlay_scale:new a.Uniform1f(d)}),clippingMask:d=>({u_matrix:new a.UniformMatrix4f(d)}),heatmap:d=>({u_extrude_scale:new a.Uniform1f(d),u_intensity:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_up_dir:new a.Uniform3f(d)}),heatmapTexture:d=>({u_image:new a.Uniform1i(d),u_color_ramp:new a.Uniform1i(d),u_opacity:new a.Uniform1f(d)}),hillshade:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_latrange:new a.Uniform2f(d),u_light:new a.Uniform2f(d),u_shadow:new a.UniformColor(d),u_highlight:new a.UniformColor(d),u_accent:new a.UniformColor(d)}),hillshadePrepare:d=>({u_matrix:new a.UniformMatrix4f(d),u_image:new a.Uniform1i(d),u_dimension:new a.Uniform2f(d),u_zoom:new a.Uniform1f(d),u_unpack:new a.Uniform4f(d)}),line:d=>({u_matrix:new a.UniformMatrix4f(d),u_pixels_to_tile_units:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_units_to_pixels:new a.Uniform2f(d),u_dash_image:new a.Uniform1i(d),u_gradient_image:new a.Uniform1i(d),u_image_height:new a.Uniform1f(d),u_texsize:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_alpha_discard_threshold:new a.Uniform1f(d),u_trim_offset:new a.Uniform2f(d)}),linePattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_texsize:new a.Uniform2f(d),u_pixels_to_tile_units:new a.UniformMatrix2f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_units_to_pixels:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d),u_alpha_discard_threshold:new a.Uniform1f(d)}),raster:d=>({u_matrix:new a.UniformMatrix4f(d),u_tl_parent:new a.Uniform2f(d),u_scale_parent:new a.Uniform1f(d),u_fade_t:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_image0:new a.Uniform1i(d),u_image1:new a.Uniform1i(d),u_brightness_low:new a.Uniform1f(d),u_brightness_high:new a.Uniform1f(d),u_saturation_factor:new a.Uniform1f(d),u_contrast_factor:new a.Uniform1f(d),u_spin_weights:new a.Uniform3f(d),u_perspective_transform:new a.Uniform2f(d)}),symbolIcon:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_camera_forward:new a.Uniform3f(d),u_tile_matrix:new a.UniformMatrix4f(d),u_up_vector:new a.Uniform3f(d),u_ecef_origin:new a.Uniform3f(d),u_texture:new a.Uniform1i(d)}),symbolSDF:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_texture:new a.Uniform1i(d),u_gamma_scale:new a.Uniform1f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_tile_id:new a.Uniform3f(d),u_zoom_transition:new a.Uniform1f(d),u_inv_rot_matrix:new a.UniformMatrix4f(d),u_merc_center:new a.Uniform2f(d),u_camera_forward:new a.Uniform3f(d),u_tile_matrix:new a.UniformMatrix4f(d),u_up_vector:new a.Uniform3f(d),u_ecef_origin:new a.Uniform3f(d),u_is_halo:new a.Uniform1i(d)}),symbolTextAndIcon:d=>({u_is_size_zoom_constant:new a.Uniform1i(d),u_is_size_feature_constant:new a.Uniform1i(d),u_size_t:new a.Uniform1f(d),u_size:new a.Uniform1f(d),u_camera_to_center_distance:new a.Uniform1f(d),u_rotate_symbol:new a.Uniform1i(d),u_aspect_ratio:new a.Uniform1f(d),u_fade_change:new a.Uniform1f(d),u_matrix:new a.UniformMatrix4f(d),u_label_plane_matrix:new a.UniformMatrix4f(d),u_coord_matrix:new a.UniformMatrix4f(d),u_is_text:new a.Uniform1i(d),u_pitch_with_map:new a.Uniform1i(d),u_texsize:new a.Uniform2f(d),u_texsize_icon:new a.Uniform2f(d),u_texture:new a.Uniform1i(d),u_texture_icon:new a.Uniform1i(d),u_gamma_scale:new a.Uniform1f(d),u_device_pixel_ratio:new a.Uniform1f(d),u_is_halo:new a.Uniform1i(d)}),background:d=>({u_matrix:new a.UniformMatrix4f(d),u_opacity:new a.Uniform1f(d),u_color:new a.UniformColor(d)}),backgroundPattern:d=>({u_matrix:new a.UniformMatrix4f(d),u_opacity:new a.Uniform1f(d),u_image:new a.Uniform1i(d),u_pattern_tl:new a.Uniform2f(d),u_pattern_br:new a.Uniform2f(d),u_texsize:new a.Uniform2f(d),u_pattern_size:new a.Uniform2f(d),u_pixel_coord_upper:new a.Uniform2f(d),u_pixel_coord_lower:new a.Uniform2f(d),u_tile_units_to_pixels:new a.Uniform1f(d)}),terrainRaster:Gi,terrainDepth:Gi,skybox:d=>({u_matrix:new a.UniformMatrix4f(d),u_sun_direction:new a.Uniform3f(d),u_cubemap:new a.Uniform1i(d),u_opacity:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d)}),skyboxGradient:d=>({u_matrix:new a.UniformMatrix4f(d),u_color_ramp:new a.Uniform1i(d),u_center_direction:new a.Uniform3f(d),u_radius:new a.Uniform1f(d),u_opacity:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d)}),skyboxCapture:d=>({u_matrix_3f:new a.UniformMatrix3f(d),u_sun_direction:new a.Uniform3f(d),u_sun_intensity:new a.Uniform1f(d),u_color_tint_r:new a.Uniform4f(d),u_color_tint_m:new a.Uniform4f(d),u_luminance:new a.Uniform1f(d)}),globeRaster:d=>({u_proj_matrix:new a.UniformMatrix4f(d),u_globe_matrix:new a.UniformMatrix4f(d),u_normalize_matrix:new a.UniformMatrix4f(d),u_merc_matrix:new a.UniformMatrix4f(d),u_zoom_transition:new a.Uniform1f(d),u_merc_center:new a.Uniform2f(d),u_image0:new a.Uniform1i(d),u_grid_matrix:new a.UniformMatrix3f(d),u_frustum_tl:new a.Uniform3f(d),u_frustum_tr:new a.Uniform3f(d),u_frustum_br:new a.Uniform3f(d),u_frustum_bl:new a.Uniform3f(d),u_globe_pos:new a.Uniform3f(d),u_globe_radius:new a.Uniform1f(d),u_viewport:new a.Uniform2f(d)}),globeAtmosphere:d=>({u_frustum_tl:new a.Uniform3f(d),u_frustum_tr:new a.Uniform3f(d),u_frustum_br:new a.Uniform3f(d),u_frustum_bl:new a.Uniform3f(d),u_horizon:new a.Uniform1f(d),u_transition:new a.Uniform1f(d),u_fadeout_range:new a.Uniform1f(d),u_color:new a.Uniform4f(d),u_high_color:new a.Uniform4f(d),u_space_color:new a.Uniform4f(d),u_star_intensity:new a.Uniform1f(d),u_star_density:new a.Uniform1f(d),u_star_size:new a.Uniform1f(d),u_temporal_offset:new a.Uniform1f(d),u_horizon_angle:new a.Uniform1f(d),u_rotation_matrix:new a.UniformMatrix4f(d)})};let re;function G(d,i,c,f,y,x,D){const P=d.context,F=P.gl,W=d.transform,Z=d.useProgram("collisionBox"),ie=[];let ve=0,Pe=0;for(let st=0;st<f.length;st++){const Dt=f[st],vt=i.getTile(Dt),Ut=vt.getBucket(c);if(!Ut)continue;const ln=is(Dt,Ut,W);let rn=ln;0===y[0]&&0===y[1]||(rn=d.translatePosMatrix(ln,vt,y,x));const $t=D?Ut.textCollisionBox:Ut.iconCollisionBox,qn=Ut.collisionCircleArray;if(qn.length>0){const Kt=a.create(),Pn=rn;a.mul(Kt,Ut.placementInvProjMatrix,W.glCoordMatrix),a.mul(Kt,Kt,Ut.placementViewportMatrix),ie.push({circleArray:qn,circleOffset:Pe,transform:Pn,invTransform:Kt,projection:Ut.getProjection()}),ve+=qn.length/4,Pe=ve}$t&&(d.terrain&&d.terrain.setupElevationDraw(vt,Z),Z.draw(P,F.LINES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,Aa(rn,W,vt,Ut.getProjection()),c.id,$t.layoutVertexBuffer,$t.indexBuffer,$t.segments,null,W.zoom,null,[$t.collisionVertexBuffer,$t.collisionVertexBufferExt]))}if(!D||!ie.length)return;const Oe=d.useProgram("collisionCircle"),Be=new a.StructArrayLayout2f1f2i16;Be.resize(4*ve),Be._trim();let Te=0;for(const st of ie)for(let Dt=0;Dt<st.circleArray.length/4;Dt++){const vt=4*Dt,Ut=st.circleArray[vt+0],ln=st.circleArray[vt+1],rn=st.circleArray[vt+2],$t=st.circleArray[vt+3];Be.emplace(Te++,Ut,ln,rn,$t,0),Be.emplace(Te++,Ut,ln,rn,$t,1),Be.emplace(Te++,Ut,ln,rn,$t,2),Be.emplace(Te++,Ut,ln,rn,$t,3)}(!re||re.length<2*ve)&&(re=function(st){const Dt=2*st,vt=new a.StructArrayLayout3ui6;vt.resize(Dt),vt._trim();for(let Ut=0;Ut<Dt;Ut++){const ln=6*Ut;vt.uint16[ln+0]=4*Ut+0,vt.uint16[ln+1]=4*Ut+1,vt.uint16[ln+2]=4*Ut+2,vt.uint16[ln+3]=4*Ut+2,vt.uint16[ln+4]=4*Ut+3,vt.uint16[ln+5]=4*Ut+0}return vt}(ve));const Ae=P.createIndexBuffer(re,!0),je=P.createVertexBuffer(Be,a.collisionCircleLayout.members,!0);for(const st of ie){const Dt={u_matrix:st.transform,u_inv_matrix:st.invTransform,u_camera_to_center_distance:(ze=W).getCameraToCenterDistance(st.projection),u_viewport_size:[ze.width,ze.height]};Oe.draw(P,F.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,d.colorModeForRenderPass(),a.CullFaceMode.disabled,Dt,c.id,je,Ae,a.SegmentVector.simpleSegment(0,2*st.circleOffset,st.circleArray.length,st.circleArray.length/2),null,W.zoom)}var ze;je.destroy(),Ae.destroy()}const ye=a.create();function yt({width:d,height:i,anchor:c,textOffset:f,textScale:y},x){const{horizontalAlign:D,verticalAlign:P}=a.getAnchorAlignment(c),F=-(D-.5)*d,W=-(P-.5)*i,Z=a.evaluateVariableOffset(c,f);return new a.pointGeometry((F/y+Z[0])*x,(W/y+Z[1])*x)}function vn(d,i,c,f,y,x,D,P,F,W,Z){const ie=d.text.placedSymbolArray,ve=d.text.dynamicLayoutVertexArray,Pe=d.icon.dynamicLayoutVertexArray,Oe={},Be=d.getProjection(),Te=ks(P,Be,x),Ae=x.elevation,je=Be.upVectorScale(P.canonical,x.center.lat,x.worldSize).metersToTile;ve.clear();for(let ze=0;ze<ie.length;ze++){const st=ie.get(ze),{tileAnchorX:Dt,tileAnchorY:vt,numGlyphs:Ut}=st,ln=d.allowVerticalPlacement&&!st.placedOrientation,rn=st.hidden||!st.crossTileID||ln?null:f[st.crossTileID];if(rn){let $t=0,qn=0,Kt=0;if(Ae){const Ei=Ae?Ae.getAtTileOffset(P,Dt,vt):0,[ki,Ci,ji]=Be.upVector(P.canonical,Dt,vt);$t=Ei*ki*je,qn=Ei*Ci*je,Kt=Ei*ji*je}let[Pn,mn,Wn,pn]=hn(st.projectedAnchorX+$t,st.projectedAnchorY+qn,st.projectedAnchorZ+Kt,c?Te:D);const Un=Ie(x.getCameraToCenterDistance(Be),pn);let Qn=y.evaluateSizeForFeature(d.textSizeData,W,st)*Un/a.ONE_EM;c&&(Qn*=d.tilePixelRatio/F);const qt=yt(rn,Qn);c?(({x:Pn,y:mn,z:Wn}=Be.projectTilePoint(Dt+qt.x,vt+qt.y,P.canonical)),[Pn,mn,Wn]=hn(Pn+$t,mn+qn,Wn+Kt,D)):(i&&qt._rotate(-x.angle),Pn+=qt.x,mn+=qt.y,Wn=0);const dn=d.allowVerticalPlacement&&st.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Ei=0;Ei<Ut;Ei++)a.addDynamicAttributes(ve,Pn,mn,Wn,dn);Z&&st.associatedIconIndex>=0&&(Oe[st.associatedIconIndex]={x:Pn,y:mn,z:Wn,angle:dn})}else Br(Ut,ve)}if(Z){Pe.clear();const ze=d.icon.placedSymbolArray;for(let st=0;st<ze.length;st++){const Dt=ze.get(st),{numGlyphs:vt}=Dt,Ut=Oe[st];if(Dt.hidden||!Ut)Br(vt,Pe);else{const{x:ln,y:rn,z:$t,angle:qn}=Ut;for(let Kt=0;Kt<vt;Kt++)a.addDynamicAttributes(Pe,ln,rn,$t,qn)}}d.icon.dynamicLayoutVertexBuffer.updateData(Pe)}d.text.dynamicLayoutVertexBuffer.updateData(ve)}function On(d,i,c){return c.iconsInText&&i?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function yi(d,i,c,f,y,x,D,P,F,W,Z,ie){const ve=d.context,Pe=ve.gl,Oe=d.transform,Be="map"===P,Te="map"===F,Ae=Be&&"point"!==c.layout.get("symbol-placement"),je=Be&&!Te&&!Ae,ze=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let st=!1;const Dt=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),vt=[a.mercatorXfromLng(Oe.center.lng),a.mercatorYfromLat(Oe.center.lat)],Ut=c.layout.get("text-variable-anchor"),ln="globe"===Oe.projection.name,rn=[],$t=[0,-1,0];let qn=$t;!ln&&!Oe.mercatorFromTransition||Be||(qn=function(Kt){const Pn=Kt._camera.getWorldToCamera(Kt.worldSize,1),mn=a.multiply([],Pn,Kt.globeMatrix);a.invert(mn,mn);const Wn=[0,0,0],pn=[0,1,0,0];return a.transformMat4$1(pn,pn,mn),Wn[0]=pn[0],Wn[1]=pn[1],Wn[2]=pn[2],a.normalize(Wn,Wn),Wn}(Oe));for(const Kt of f){const Pn=i.getTile(Kt),mn=Pn.getBucket(c);if(!mn||"mercator"===mn.projection.name&&ln)continue;const Wn=y?mn.text:mn.icon;if(!Wn||mn.fullyClipped||!Wn.segments.get().length)continue;const pn=Wn.programConfigurations.get(c.id),Un=y||mn.sdfIcons,Qn=y?mn.textSizeData:mn.iconSizeData,qt=Te||0!==Oe.pitch,dn=a.evaluateSizeForZoom(Qn,Oe.zoom);let Ei,ki,Ci,ji,or=[0,0],Pi=null;if(y){if(ki=Pn.glyphAtlasTexture,Ci=Pe.LINEAR,Ei=Pn.glyphAtlasTexture.size,mn.iconsInText){or=Pn.imageAtlasTexture.size,Pi=Pn.imageAtlasTexture;const Ba="composite"===Qn.kind||"camera"===Qn.kind;ji=qt||d.options.rotating||d.options.zooming||Ba?Pe.LINEAR:Pe.NEAREST}}else{const Ba=1!==c.layout.get("icon-size").constantOr(0)||mn.iconsNeedLinear;ki=Pn.imageAtlasTexture,Ci=Un||d.options.rotating||d.options.zooming||Ba||qt?Pe.LINEAR:Pe.NEAREST,Ei=Pn.imageAtlasTexture.size}const gi="globe"===mn.projection.name,jr=gi?qn:$t,Pr=gi?a.globeToMercatorTransition(Oe.zoom):0,so=ks(Kt,mn.getProjection(),Oe),Hr=Oe.calculatePixelsToTileUnitsMatrix(Pn),La=Yi(so,Pn.tileID.canonical,Te,Be,Oe,mn.getProjection(),Hr),na=d.terrain&&Te&&Ae?a.invert(a.create(),La):ye,ia=kn(so,Pn.tileID.canonical,Te,Be,Oe,mn.getProjection(),Hr),cl=Ut&&mn.hasTextData(),Yr="none"!==c.layout.get("icon-text-fit")&&cl&&mn.hasIconData();if(Ae){const Ba=Oe.elevation,Zs=Ba?Ba.getAtTileOffsetFunc(Kt,Oe.center.lat,Oe.worldSize,mn.getProjection()):null,Cl=gs(so,Pn.tileID.canonical,Te,Be,Oe,mn.getProjection(),Hr);Fn(mn,so,d,y,Cl,ia,Te,W,Zs,Kt)}const Gr=Ae||y&&Ut||Yr,wr=d.translatePosMatrix(so,Pn,x,D),Vo=Gr?ye:La,$s=d.translatePosMatrix(ia,Pn,x,D,!0),po=mn.getProjection().createInversionMatrix(Oe,Kt.canonical),Es=[];d.terrainRenderModeElevated()&&Te&&Es.push("PITCH_WITH_MAP_TERRAIN"),gi&&Es.push("PROJECTION_GLOBE_VIEW"),Gr&&Es.push("PROJECTED_POS_ON_VIEWPORT");const wc=Un&&0!==c.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1);let El;El=Un?mn.iconsInText?Ia(Qn.kind,dn,je,Te,d,wr,Vo,$s,Ei,or,Kt,Pr,vt,po,jr,mn.getProjection()):al(Qn.kind,dn,je,Te,d,wr,Vo,$s,y,Ei,!0,Kt,Pr,vt,po,jr,mn.getProjection()):Xo(Qn.kind,dn,je,Te,d,wr,Vo,$s,y,Ei,Kt,Pr,vt,po,jr,mn.getProjection());const Ps={program:d.useProgram(On(Un,y,mn),pn,Es),buffers:Wn,uniformValues:El,atlasTexture:ki,atlasTextureIcon:Pi,atlasInterpolation:Ci,atlasInterpolationIcon:ji,isSDF:Un,hasHalo:wc,tile:Pn,labelPlaneMatrixInv:na};if(ze&&mn.canOverlap){st=!0;const Ba=Wn.segments.get();for(const Zs of Ba)rn.push({segments:new a.SegmentVector([Zs]),sortKey:Zs.sortKey,state:Ps})}else rn.push({segments:Wn.segments,sortKey:0,state:Ps})}st&&rn.sort((Kt,Pn)=>Kt.sortKey-Pn.sortKey);for(const Kt of rn){const Pn=Kt.state;if(d.terrain&&d.terrain.setupElevationDraw(Pn.tile,Pn.program,{useDepthForOcclusion:!ln,labelPlaneMatrixInv:Pn.labelPlaneMatrixInv}),ve.activeTexture.set(Pe.TEXTURE0),Pn.atlasTexture.bind(Pn.atlasInterpolation,Pe.CLAMP_TO_EDGE),Pn.atlasTextureIcon&&(ve.activeTexture.set(Pe.TEXTURE1),Pn.atlasTextureIcon&&Pn.atlasTextureIcon.bind(Pn.atlasInterpolationIcon,Pe.CLAMP_TO_EDGE)),Pn.isSDF){const mn=Pn.uniformValues;Pn.hasHalo&&(mn.u_is_halo=1,mr(Pn.buffers,Kt.segments,c,d,Pn.program,Dt,Z,ie,mn)),mn.u_is_halo=0}mr(Pn.buffers,Kt.segments,c,d,Pn.program,Dt,Z,ie,Pn.uniformValues)}}function mr(d,i,c,f,y,x,D,P,F){const W=f.context,Z=[d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer,d.globeExtVertexBuffer];y.draw(W,W.gl.TRIANGLES,x,D,P,a.CullFaceMode.disabled,F,c.id,d.layoutVertexBuffer,d.indexBuffer,i,c.paint,f.transform.zoom,d.programConfigurations.get(c.id),Z)}function Sr(d,i,c,f,y,x,D){const P=d.context.gl,F=c.paint.get("fill-pattern"),W=F&&F.constantOr(1);let Z,ie,ve,Pe,Oe;D?(ie=W&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Z=P.LINES):(ie=W?"fillPattern":"fill",Z=P.TRIANGLES);for(const Be of f){const Te=i.getTile(Be);if(W&&!Te.patternsLoaded())continue;const Ae=Te.getBucket(c);if(!Ae)continue;d.prepareDrawTile();const je=Ae.programConfigurations.get(c.id),ze=d.useProgram(ie,je);W&&(d.context.activeTexture.set(P.TEXTURE0),Te.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),je.updatePaintBuffers());const st=F.constantOr(null);if(st&&Te.imageAtlas){const vt=Te.imageAtlas.patternPositions[st.toString()];vt&&je.setConstantPatternPositions(vt)}const Dt=d.translatePosMatrix(Be.projMatrix,Te,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(D){Pe=Ae.indexBuffer2,Oe=Ae.segments2;const vt=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];ve="fillOutlinePattern"===ie&&W?Is(Dt,d,Te,vt):io(Dt,vt)}else Pe=Ae.indexBuffer,Oe=Ae.segments,ve=W?bi(Dt,d,Te):En(Dt);d.prepareDrawProgram(d.context,ze,Be.toUnwrapped()),ze.draw(d.context,Z,y,d.stencilModeForClipping(Be),x,a.CullFaceMode.disabled,ve,c.id,Ae.layoutVertexBuffer,Pe,Oe,c.paint,d.transform.zoom,je)}}function Ar(d,i,c,f,y,x,D){const P=d.context,F=P.gl,W=d.transform,Z=c.paint.get("fill-extrusion-pattern"),ie=Z.constantOr(1),ve=c.paint.get("fill-extrusion-opacity"),Pe=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],Oe=c.layout.get("fill-extrusion-edge-radius"),Be="globe"===W.projection.name?a.fillExtrusionHeightLift():0,Te="globe"===W.projection.name,Ae=Te?a.globeToMercatorTransition(W.zoom):0,je=[a.mercatorXfromLng(W.center.lng),a.mercatorYfromLat(W.center.lat)],ze=[];Te&&(ze.push("PROJECTION_GLOBE_VIEW"),d.style.terrainSetForDrapingOnly()&&ze.push("TERRAIN")),Pe[0]>0&&ze.push("FAUX_AO");for(const st of f){const Dt=i.getTile(st),vt=Dt.getBucket(c);if(!vt||vt.projection.name!==W.projection.name)continue;const Ut=vt.programConfigurations.get(c.id),ln=d.useProgram(ie?"fillExtrusionPattern":"fillExtrusion",Ut,ze);if(d.terrain){const Wn=d.terrain;if(d.style.terrainSetForDrapingOnly())Wn.setupElevationDraw(Dt,ln,{useMeterToDem:!0});else{if(!vt.enableTerrain)continue;if(Wn.setupElevationDraw(Dt,ln,{useMeterToDem:!0}),xr(P,i,st,vt,c,Wn),!vt.centroidVertexBuffer){const pn=ln.attributes.a_centroid_pos;void 0!==pn&&F.vertexAttrib2f(pn,0,0)}}}ie&&(d.context.activeTexture.set(F.TEXTURE0),Dt.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Ut.updatePaintBuffers());const rn=Z.constantOr(null);if(rn&&Dt.imageAtlas){const Wn=Dt.imageAtlas.patternPositions[rn.toString()];Wn&&Ut.setConstantPatternPositions(Wn)}const $t=d.translatePosMatrix(st.projMatrix,Dt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),qn=W.projection.createInversionMatrix(W,st.canonical),Kt=c.paint.get("fill-extrusion-vertical-gradient"),Pn=ie?be($t,d,Kt,ve,Pe,Oe,st,Dt,Be,Ae,je,qn):j($t,d,Kt,ve,Pe,Oe,st,Be,Ae,je,qn);d.prepareDrawProgram(P,ln,st.toUnwrapped());const mn=[];d.terrain&&mn.push(vt.centroidVertexBuffer),Te&&mn.push(vt.layoutVertexExtBuffer),ln.draw(P,P.gl.TRIANGLES,y,x,D,a.CullFaceMode.backCCW,Pn,c.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,c.paint,d.transform.zoom,Ut,mn)}}function xr(d,i,c,f,y,x){const D=[Ae=>{let je=Ae.canonical.x-1,ze=Ae.wrap;return je<0&&(je=(1<<Ae.canonical.z)-1,ze--),new a.OverscaledTileID(Ae.overscaledZ,ze,Ae.canonical.z,je,Ae.canonical.y)},Ae=>{let je=Ae.canonical.x+1,ze=Ae.wrap;return je===1<<Ae.canonical.z&&(je=0,ze++),new a.OverscaledTileID(Ae.overscaledZ,ze,Ae.canonical.z,je,Ae.canonical.y)},Ae=>new a.OverscaledTileID(Ae.overscaledZ,Ae.wrap,Ae.canonical.z,Ae.canonical.x,(0===Ae.canonical.y?1<<Ae.canonical.z:Ae.canonical.y)-1),Ae=>new a.OverscaledTileID(Ae.overscaledZ,Ae.wrap,Ae.canonical.z,Ae.canonical.x,Ae.canonical.y===(1<<Ae.canonical.z)-1?0:Ae.canonical.y+1)],P=Ae=>{const je=i.getSource().minzoom,ze=Dt=>{const vt=i.getTileByID(Dt);if(vt&&vt.hasData())return vt.getBucket(y)},st=[0,-1,1];for(const Dt of st){if(Ae.overscaledZ+Dt<je)continue;const vt=ze(Ae.calculateScaledKey(Ae.overscaledZ+Dt));if(vt)return vt}},F=[0,0,0],W=(Ae,je)=>(F[0]=Math.min(Ae.min.y,je.min.y),F[1]=Math.max(Ae.max.y,je.max.y),F[2]=a.EXTENT-je.min.x>Ae.max.x?je.min.x-a.EXTENT:Ae.max.x,F),Z=(Ae,je)=>(F[0]=Math.min(Ae.min.x,je.min.x),F[1]=Math.max(Ae.max.x,je.max.x),F[2]=a.EXTENT-je.min.y>Ae.max.y?je.min.y-a.EXTENT:Ae.max.y,F),ie=[(Ae,je)=>W(Ae,je),(Ae,je)=>W(je,Ae),(Ae,je)=>Z(Ae,je),(Ae,je)=>Z(je,Ae)],ve=new a.pointGeometry(0,0);let Pe,Oe,Be;const Te=(Ae,je,ze,st,Dt)=>{const vt=[[st?ze:Ae,st?Ae:ze,0],[st?ze:je,st?je:ze,0]],Ut=Dt<0?a.EXTENT+Dt:Dt,ln=[st?Ut:(Ae+je)/2,st?(Ae+je)/2:Ut,0];return 0===ze&&Dt<0||0!==ze&&Dt>0?x.getForTilePoints(Be,[ln],!0,Oe):vt.push(ln),x.getForTilePoints(c,vt,!0,Pe),Math.max(vt[0][2],vt[1][2],ln[2])/x.exaggeration()};for(let Ae=0;Ae<4;Ae++){const je=(Ae<2?1:5)-Ae,ze=f.borders[Ae];if(0===ze.length)continue;const st=Be=D[Ae](c),Dt=P(st);if(!(Dt&&Dt instanceof a.FillExtrusionBucket&&Dt.enableTerrain)||f.borderDoneWithNeighborZ[Ae]===Dt.canonical.z&&Dt.borderDoneWithNeighborZ[je]===f.canonical.z||(Oe=x.findDEMTileFor(st),!Oe||!Oe.dem))continue;if(!Pe){const rn=x.findDEMTileFor(c);if(!rn||!rn.dem)return;Pe=rn}const vt=Dt.borders[je];let Ut=0;const ln=Dt.borderDoneWithNeighborZ[je]!==f.canonical.z;if(f.canonical.z===Dt.canonical.z){for(let rn=0;rn<ze.length;rn++){const $t=f.featuresOnBorder[ze[rn]],qn=$t.borders[Ae];let Kt;for(;Ut<vt.length&&(Kt=Dt.featuresOnBorder[vt[Ut]],!(Kt.borders[je][1]>qn[0]+3));)ln&&Dt.encodeCentroid(void 0,Kt,!1),Ut++;if(Kt&&Ut<vt.length){const Pn=Ut;let mn=0;for(;!(Kt.borders[je][0]>qn[1]-3)&&(mn++,++Ut!==vt.length);)Kt=Dt.featuresOnBorder[vt[Ut]];if(Kt=Dt.featuresOnBorder[vt[Pn]],$t.intersectsCount()>1||Kt.intersectsCount()>1||1!==mn){1!==mn&&(Ut=Pn),f.encodeCentroid(void 0,$t,!1),ln&&Dt.encodeCentroid(void 0,Kt,!1);continue}const Wn=ie[Ae]($t,Kt),pn=Ae%2?a.EXTENT-1:0;ve.x=Te(Wn[0],Math.min(a.EXTENT-1,Wn[1]),pn,Ae<2,Wn[2]),ve.y=0,f.encodeCentroid(ve,$t,!1),ln&&Dt.encodeCentroid(ve,Kt,!1)}else f.encodeCentroid(void 0,$t,!1)}f.borderDoneWithNeighborZ[Ae]=Dt.canonical.z,f.needsCentroidUpdate=!0,ln&&(Dt.borderDoneWithNeighborZ[je]=f.canonical.z,Dt.needsCentroidUpdate=!0)}else{for(const rn of ze)f.encodeCentroid(void 0,f.featuresOnBorder[rn],!1);if(ln){for(const rn of vt)Dt.encodeCentroid(void 0,Dt.featuresOnBorder[rn],!1);Dt.borderDoneWithNeighborZ[je]=f.canonical.z,Dt.needsCentroidUpdate=!0}f.borderDoneWithNeighborZ[Ae]=Dt.canonical.z,f.needsCentroidUpdate=!0}}(f.needsCentroidUpdate||!f.centroidVertexBuffer&&0!==f.centroidVertexArray.length)&&f.uploadCentroid(d)}const yo=new a.Color(1,0,0,1),Ir=new a.Color(0,1,0,1),eo=new a.Color(0,0,1,1),Wo=new a.Color(1,0,1,1),cs=new a.Color(0,1,1,1);function Qs(d,i,c){const f=d.context,y=d.transform,x=f.gl,D="globe"===y.projection.name,P=D?["PROJECTION_GLOBE_VIEW"]:null;let F=c.projMatrix;if(D&&a.globeToMercatorTransition(y.zoom)>0){const $t=a.transitionTileAABBinECEF(c.canonical,y),qn=a.globeDenormalizeECEF($t);F=a.multiply(new Float32Array(16),y.globeMatrix,qn),a.multiply(F,y.projMatrix,F)}const W=d.useProgram("debug",null,P),Z=i.getTileByID(c.key);d.terrain&&d.terrain.setupElevationDraw(Z,W);const ie=a.DepthMode.disabled,ve=a.StencilMode.disabled,Pe=d.colorModeForRenderPass();f.activeTexture.set(x.TEXTURE0),d.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),D?Z._makeGlobeTileDebugBuffers(d.context,y):Z._makeDebugTileBoundsBuffers(d.context,y.projection);const Be=Z._tileDebugBuffer||d.debugBuffer,Te=Z._tileDebugIndexBuffer||d.debugIndexBuffer,Ae=Z._tileDebugSegments||d.debugSegments;W.draw(f,x.LINE_STRIP,ie,ve,Pe,a.CullFaceMode.disabled,Vs(F,a.Color.red),"$debug",Be,Te,Ae,null,null,null,[Z._globeTileDebugBorderBuffer]);const je=Z.latestRawTileData,ze=Math.floor((je&&je.byteLength||0)/1024),st=i.getTile(c).tileSize,Dt=512/Math.min(st,512)*(c.overscaledZ/y.zoom)*.5;let vt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(vt+=` => ${c.overscaledZ}`),vt+=` ${ze}kb`,function($t,qn){$t.initDebugOverlayCanvas();const Kt=$t.debugOverlayCanvas,Pn=$t.context.gl,mn=$t.debugOverlayCanvas.getContext("2d");mn.clearRect(0,0,Kt.width,Kt.height),mn.shadowColor="white",mn.shadowBlur=2,mn.lineWidth=1.5,mn.strokeStyle="white",mn.textBaseline="top",mn.font="bold 36px Open Sans, sans-serif",mn.fillText(qn,5,5),mn.strokeText(qn,5,5),$t.debugOverlayTexture.update(Kt),$t.debugOverlayTexture.bind(Pn.LINEAR,Pn.CLAMP_TO_EDGE)}(d,vt);const Ut=Z._tileDebugTextBuffer||d.debugBuffer,ln=Z._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,rn=Z._tileDebugTextSegments||d.debugSegments;W.draw(f,x.TRIANGLES,ie,ve,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Vs(F,a.Color.transparent,Dt),"$debug",Ut,ln,rn,null,null,null,[Z._globeTileDebugTextBuffer])}function Hs(d,i,c,f){No(d,0,i+c/2,d.transform.width,c,f)}function Qo(d,i,c,f){No(d,i-c/2,0,c,d.transform.height,f)}function No(d,i,c,f,y,x){const D=d.context,P=D.gl;P.enable(P.SCISSOR_TEST),P.scissor(i*a.exported.devicePixelRatio,c*a.exported.devicePixelRatio,f*a.exported.devicePixelRatio,y*a.exported.devicePixelRatio),D.clear({color:x}),P.disable(P.SCISSOR_TEST)}const qa=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vc}=qa;function zo(d,i,c,f){d.emplaceBack(i,c,f)}class Pa{constructor(i){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,zo(this.vertexArray,-1,-1,1),zo(this.vertexArray,1,-1,1),zo(this.vertexArray,-1,1,1),zo(this.vertexArray,1,1,1),zo(this.vertexArray,-1,-1,-1),zo(this.vertexArray,1,-1,-1),zo(this.vertexArray,-1,1,-1),zo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Vc),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Oa(d,i,c,f,y,x){const D=d.gl,P=i.paint.get("sky-atmosphere-color"),F=i.paint.get("sky-atmosphere-halo-color"),W=i.paint.get("sky-atmosphere-sun-intensity"),Z={u_matrix_3f:a.fromMat4(a.create$1(),f),u_sun_direction:y,u_sun_intensity:W,u_color_tint_r:[(Oe=P).r,Oe.g,Oe.b,Oe.a],u_color_tint_m:[(Be=F).r,Be.g,Be.b,Be.a],u_luminance:5e-5};var Oe,Be;D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+x,i.skyboxTexture,0),c.draw(d,D.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,Z,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const tc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Dr{constructor(i){const c=new a.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const f=new a.StructArrayLayout3ui6;f.emplaceBack(0,1,2),f.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,tc.members),this.indexBuffer=i.createIndexBuffer(f),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ul={symbol:function(d,i,c,f,y){if("translucent"!==d.renderPass)return;const x=a.StencilMode.disabled,D=d.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(P,F,W,Z,ie,ve,Pe){const Oe=F.transform,Be="map"===ie,Te="map"===ve;for(const Ae of P){const je=Z.getTile(Ae),ze=je.getBucket(W);if(!ze||!ze.text||!ze.text.segments.get().length)continue;const st=a.evaluateSizeForZoom(ze.textSizeData,Oe.zoom),Dt=ks(Ae,ze.getProjection(),Oe),vt=Oe.calculatePixelsToTileUnitsMatrix(je),Ut=Yi(Dt,je.tileID.canonical,Te,Be,Oe,ze.getProjection(),vt),ln="none"!==W.layout.get("icon-text-fit")&&ze.hasIconData();if(st){const rn=Math.pow(2,Oe.zoom-je.tileID.overscaledZ);vn(ze,Be,Te,Pe,a.symbolSize,Oe,Ut,Ae,rn,st,ln)}}}(f,d,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y),0!==c.paint.get("icon-opacity").constantOr(1)&&yi(d,i,c,f,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),x,D),0!==c.paint.get("text-opacity").constantOr(1)&&yi(d,i,c,f,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),x,D),i.map.showCollisionBoxes&&(G(d,i,c,f,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),G(d,i,c,f,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(d,i,c,f){if("translucent"!==d.renderPass)return;const y=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),D=c.paint.get("circle-stroke-opacity"),P=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===y.constantOr(1)&&(0===x.constantOr(1)||0===D.constantOr(1)))return;const F=d.context,W=F.gl,Z=d.transform,ie=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),ve=a.StencilMode.disabled,Pe=d.colorModeForRenderPass(),Oe="globe"===Z.projection.name,Be=[a.mercatorXfromLng(Z.center.lng),a.mercatorYfromLat(Z.center.lat)],Te=[];for(let je=0;je<f.length;je++){const ze=f[je],st=i.getTile(ze),Dt=st.getBucket(c);if(!Dt||Dt.projection.name!==Z.projection.name)continue;const vt=Dt.programConfigurations.get(c.id),Ut=Zo(c);Oe&&Ut.push("PROJECTION_GLOBE_VIEW");const ln=d.useProgram("circle",vt,Ut),rn=Dt.layoutVertexBuffer,$t=Dt.globeExtVertexBuffer,qn=Dt.indexBuffer,Kt=Z.projection.createInversionMatrix(Z,ze.canonical),Pn={programConfiguration:vt,program:ln,layoutVertexBuffer:rn,globeExtVertexBuffer:$t,indexBuffer:qn,uniformValues:Lr(d,ze,st,Kt,Be,c),tile:st};if(P){const mn=Dt.segments.get();for(const Wn of mn)Te.push({segments:new a.SegmentVector([Wn]),sortKey:Wn.sortKey,state:Pn})}else Te.push({segments:Dt.segments,sortKey:0,state:Pn})}P&&Te.sort((je,ze)=>je.sortKey-ze.sortKey);const Ae={useDepthForOcclusion:!Oe};for(const je of Te){const{programConfiguration:ze,program:st,layoutVertexBuffer:Dt,globeExtVertexBuffer:vt,indexBuffer:Ut,uniformValues:ln,tile:rn}=je.state,$t=je.segments;d.terrain&&d.terrain.setupElevationDraw(rn,st,Ae),d.prepareDrawProgram(F,st,rn.tileID.toUnwrapped()),st.draw(F,W.TRIANGLES,ie,ve,Pe,a.CullFaceMode.disabled,ln,c.id,Dt,Ut,$t,c.paint,Z.zoom,ze,[vt])}},heatmap:function(d,i,c,f){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===d.renderPass){const y=d.context,x=y.gl,D=a.StencilMode.disabled,P=new a.ColorMode([x.ONE,x.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(Pe,Oe,Be,Te){const Ae=Pe.gl,je=Oe.width*Te,ze=Oe.height*Te;Pe.activeTexture.set(Ae.TEXTURE1),Pe.viewport.set([0,0,je,ze]);let st=Be.heatmapFbo;if(!st||st&&(st.width!==je||st.height!==ze)){st&&st.destroy();const Dt=Ae.createTexture();Ae.bindTexture(Ae.TEXTURE_2D,Dt),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_S,Ae.CLAMP_TO_EDGE),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_T,Ae.CLAMP_TO_EDGE),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MIN_FILTER,Ae.LINEAR),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MAG_FILTER,Ae.LINEAR),st=Be.heatmapFbo=Pe.createFramebuffer(je,ze,!1),function(vt,Ut,ln,rn,$t,qn){const Kt=vt.gl;Kt.texImage2D(Kt.TEXTURE_2D,0,Kt.RGBA,$t,qn,0,Kt.RGBA,vt.extRenderToTextureHalfFloat?vt.extTextureHalfFloat.HALF_FLOAT_OES:Kt.UNSIGNED_BYTE,null),rn.colorAttachment.set(ln)}(Pe,0,Dt,st,je,ze)}else Ae.bindTexture(Ae.TEXTURE_2D,st.colorAttachment.get()),Pe.bindFramebuffer.set(st.framebuffer)})(y,d,c,"globe"===d.transform.projection.name?.5:.25),y.clear({color:a.Color.transparent});const F=d.transform,W="globe"===F.projection.name,Z=W?["PROJECTION_GLOBE_VIEW"]:null,ie=W?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,ve=[a.mercatorXfromLng(F.center.lng),a.mercatorYfromLat(F.center.lat)];for(let Pe=0;Pe<f.length;Pe++){const Oe=f[Pe];if(i.hasRenderableParent(Oe))continue;const Be=i.getTile(Oe),Te=Be.getBucket(c);if(!Te||Te.projection.name!==F.projection.name)continue;const Ae=Te.programConfigurations.get(c.id),je=d.useProgram("heatmap",Ae,Z),{zoom:ze}=d.transform;d.terrain&&d.terrain.setupElevationDraw(Be,je),d.prepareDrawProgram(y,je,Oe.toUnwrapped());const st=F.projection.createInversionMatrix(F,Oe.canonical);je.draw(y,x.TRIANGLES,a.DepthMode.disabled,D,P,ie,Ll(d,Oe,Be,st,ve,ze,c.paint.get("heatmap-intensity")),c.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,c.paint,d.transform.zoom,Ae,W?[Te.globeExtVertexBuffer]:null)}y.viewport.set([0,0,d.width,d.height])}else"translucent"===d.renderPass&&(d.context.setColorMode(d.colorModeForRenderPass()),function(y,x){const D=y.context,P=D.gl,F=x.heatmapFbo;if(!F)return;D.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,F.colorAttachment.get()),D.activeTexture.set(P.TEXTURE1);let W=x.colorRampTexture;W||(W=x.colorRampTexture=new a.Texture(D,x.colorRamp,P.RGBA)),W.bind(P.LINEAR,P.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(D,P.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,y.colorModeForRenderPass(),a.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:x.paint.get("heatmap-opacity")},x.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,x.paint,y.transform.zoom)}(d,c))},line:function(d,i,c,f){if("translucent"!==d.renderPass)return;const y=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(0===y.constantOr(1)||0===x.constantOr(1))return;const D=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),P=d.colorModeForRenderPass(),F=d.terrain&&d.terrain.renderingToTexture?1:a.exported.devicePixelRatio,W=c.paint.get("line-dasharray"),Z=W.constantOr(1),ie=c.layout.get("line-cap"),ve=c.paint.get("line-pattern"),Pe=ve.constantOr(1),Oe=c.paint.get("line-gradient"),Be=Pe?"linePattern":"line",Te=d.context,Ae=Te.gl,je=(st=>{const Dt=[];Wa(st)&&Dt.push("RENDER_LINE_DASH"),st.paint.get("line-gradient")&&Dt.push("RENDER_LINE_GRADIENT");const vt=st.paint.get("line-trim-offset");0===vt[0]&&0===vt[1]||Dt.push("RENDER_LINE_TRIM_OFFSET");const Ut=st.paint.get("line-pattern").constantOr(1),ln=1!==st.paint.get("line-opacity").constantOr(1);return!Ut&&ln&&Dt.push("RENDER_LINE_ALPHA_DISCARD"),Dt})(c);let ze=je.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(ze=!1);for(const st of f){const Dt=i.getTile(st);if(Pe&&!Dt.patternsLoaded())continue;const vt=Dt.getBucket(c);if(!vt)continue;d.prepareDrawTile();const Ut=vt.programConfigurations.get(c.id),ln=d.useProgram(Be,Ut,je),rn=ve.constantOr(null);if(rn&&Dt.imageAtlas){const Un=Dt.imageAtlas.patternPositions[rn.toString()];Un&&Ut.setConstantPatternPositions(Un)}const $t=W.constantOr(null),qn=ie.constantOr(null);if(!Pe&&$t&&qn&&Dt.lineAtlas){const Un=Dt.lineAtlas.getDash($t,qn);Un&&Ut.setConstantPatternPositions(Un)}let[Kt,Pn]=c.paint.get("line-trim-offset");("round"===qn||"square"===qn)&&Kt!==Pn&&(0===Kt&&(Kt-=1),1===Pn&&(Pn+=1));const mn=d.terrain?st.projMatrix:null,Wn=Pe?js(d,Dt,c,mn,F):Bl(d,Dt,c,mn,vt.lineClipsArray.length,F,[Kt,Pn]);if(Oe){const Un=vt.gradients[c.id];let Qn=Un.texture;if(c.gradientVersion!==Un.version){let qt=256;if(c.stepInterpolant){const dn=i.getSource().maxzoom,Ei=st.canonical.z===dn?Math.ceil(1<<d.transform.maxZoom-st.canonical.z):1;qt=a.clamp(a.nextPowerOfTwo(vt.maxLineLength/a.EXTENT*1024*Ei),256,Te.maxTextureSize)}Un.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:qt,image:Un.gradient||void 0,clips:vt.lineClipsArray}),Un.texture?Un.texture.update(Un.gradient):Un.texture=new a.Texture(Te,Un.gradient,Ae.RGBA),Un.version=c.gradientVersion,Qn=Un.texture}Te.activeTexture.set(Ae.TEXTURE1),Qn.bind(c.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}Z&&(Te.activeTexture.set(Ae.TEXTURE0),Dt.lineAtlasTexture.bind(Ae.LINEAR,Ae.REPEAT),Ut.updatePaintBuffers()),Pe&&(Te.activeTexture.set(Ae.TEXTURE0),Dt.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Ut.updatePaintBuffers()),d.prepareDrawProgram(Te,ln,st.toUnwrapped());const pn=Un=>{ln.draw(Te,Ae.TRIANGLES,D,Un,P,a.CullFaceMode.disabled,Wn,c.id,vt.layoutVertexBuffer,vt.indexBuffer,vt.segments,c.paint,d.transform.zoom,Ut,[vt.layoutVertexBuffer2])};if(ze){const Un=d.stencilModeForClipping(st).ref;0===Un&&d.terrain&&Te.clear({stencil:0});const Qn={func:Ae.EQUAL,mask:255};Wn.u_alpha_discard_threshold=.8,pn(new a.StencilMode(Qn,Un,255,Ae.KEEP,Ae.KEEP,Ae.INVERT)),Wn.u_alpha_discard_threshold=0,pn(new a.StencilMode(Qn,Un,255,Ae.KEEP,Ae.KEEP,Ae.KEEP))}else pn(d.stencilModeForClipping(st))}ze&&(d.resetStencilClippingMasks(),d.terrain&&Te.clear({stencil:0}))},fill:function(d,i,c,f){const y=c.paint.get("fill-color"),x=c.paint.get("fill-opacity");if(0===x.constantOr(1))return;const D=d.colorModeForRenderPass(),P=c.paint.get("fill-pattern"),F=d.opaquePassEnabledForLayer()&&!P.constantOr(1)&&1===y.constantOr(a.Color.transparent).a&&1===x.constantOr(0)?"opaque":"translucent";if(d.renderPass===F){const W=d.depthModeForSublayer(1,"opaque"===d.renderPass?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);Sr(d,i,c,f,W,D,!1)}if("translucent"===d.renderPass&&c.paint.get("fill-antialias")){const W=d.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);Sr(d,i,c,f,W,D,!0)}},"fill-extrusion":function(d,i,c,f){const y=c.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===d.renderPass){const x=new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D);if(1!==y||c.paint.get("fill-extrusion-pattern").constantOr(1))Ar(d,i,c,f,x,a.StencilMode.disabled,a.ColorMode.disabled),Ar(d,i,c,f,x,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const D=d.colorModeForRenderPass();Ar(d,i,c,f,x,a.StencilMode.disabled,D)}}},hillshade:function(d,i,c,f){if("offscreen"!==d.renderPass&&"translucent"!==d.renderPass)return;const y=d.context,x=d.depthModeForSublayer(0,a.DepthMode.ReadOnly),D=d.colorModeForRenderPass(),P=d.terrain&&d.terrain.renderingToTexture,[F,W]="translucent"!==d.renderPass||P?[{},f]:d.stencilConfigForOverlap(f);for(const Z of W){const ie=i.getTile(Z);if(ie.needsHillshadePrepare&&"offscreen"===d.renderPass)_o(d,ie,c,x,a.StencilMode.disabled,D);else if("translucent"===d.renderPass){const ve=P&&d.terrain?d.terrain.stencilModeForRTTOverlap(Z):F[Z.overscaledZ];ss(d,Z,ie,c,x,ve,D)}}y.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,i,c,f,y,x){if("translucent"!==d.renderPass||0===c.paint.get("raster-opacity")||!f.length)return;const D=d.context,P=D.gl,F=i.getSource(),W=d.useProgram("raster"),Z=d.colorModeForRenderPass(),ie=d.terrain&&d.terrain.renderingToTexture,[ve,Pe]=F instanceof ct||ie?[{},f]:d.stencilConfigForOverlap(f),Oe=Pe[Pe.length-1].overscaledZ,Be=!d.options.moving;for(const Te of Pe){const Ae=ie?a.DepthMode.disabled:d.depthModeForSublayer(Te.overscaledZ-Oe,1===c.paint.get("raster-opacity")?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,P.LESS),je=Te.toUnwrapped(),ze=i.getTile(Te);if(ie&&(!ze||!ze.hasData()))continue;const st=ie?Te.projMatrix:d.transform.calculateProjMatrix(je,Be),Dt=d.terrain&&ie?d.terrain.stencilModeForRTTOverlap(Te):ve[Te.overscaledZ],vt=x?0:c.paint.get("raster-fade-duration");ze.registerFadeDuration(vt);const Ut=i.findLoadedParent(Te,0),ln=ls(ze,Ut,i,d.transform,vt);let rn,$t;d.terrain&&d.terrain.prepareDrawTile();const qn="nearest"===c.paint.get("raster-resampling")?P.NEAREST:P.LINEAR;D.activeTexture.set(P.TEXTURE0),ze.texture.bind(qn,P.CLAMP_TO_EDGE),D.activeTexture.set(P.TEXTURE1),Ut?(Ut.texture.bind(qn,P.CLAMP_TO_EDGE),rn=Math.pow(2,Ut.tileID.overscaledZ-ze.tileID.overscaledZ),$t=[ze.tileID.canonical.x*rn%1,ze.tileID.canonical.y*rn%1]):ze.texture.bind(qn,P.CLAMP_TO_EDGE);const Kt=ec(st,$t||[0,0],rn||1,ln,c,F instanceof ct?F.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(D,W,je),F instanceof ct)F.boundsBuffer&&F.boundsSegments&&W.draw(D,P.TRIANGLES,Ae,a.StencilMode.disabled,Z,a.CullFaceMode.disabled,Kt,c.id,F.boundsBuffer,d.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:Pn,tileBoundsIndexBuffer:mn,tileBoundsSegments:Wn}=d.getTileBoundsBuffers(ze);W.draw(D,P.TRIANGLES,Ae,Dt,Z,a.CullFaceMode.disabled,Kt,c.id,Pn,mn,Wn)}}d.resetStencilClippingMasks()},background:function(d,i,c,f){const y=c.paint.get("background-color"),x=c.paint.get("background-opacity");if(0===x)return;const D=d.context,P=D.gl,F=d.transform,W=F.tileSize,Z=c.paint.get("background-pattern");if(d.isPatternMissing(Z))return;const ie=!Z&&1===y.a&&1===x&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==ie)return;const ve=a.StencilMode.disabled,Pe=d.depthModeForSublayer(0,"opaque"===ie?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),Oe=d.colorModeForRenderPass(),Be=d.useProgram(Z?"backgroundPattern":"background");let Te,Ae=f;Ae||(Te=d.getBackgroundTiles(),Ae=Object.values(Te).map(je=>je.tileID)),Z&&(D.activeTexture.set(P.TEXTURE0),d.imageManager.bind(d.context));for(const je of Ae){const ze=je.toUnwrapped(),st=f?je.projMatrix:d.transform.calculateProjMatrix(ze);d.prepareDrawTile();const Dt=i?i.getTile(je):Te?Te[je.key]:new a.Tile(je,W,F.zoom,d),vt=Z?zl(st,x,d,Z,{tileID:je,tileSize:W}):vc(st,x,y);d.prepareDrawProgram(D,Be,ze);const{tileBoundsBuffer:Ut,tileBoundsIndexBuffer:ln,tileBoundsSegments:rn}=d.getTileBoundsBuffers(Dt);Be.draw(D,P.TRIANGLES,Pe,ve,Oe,a.CullFaceMode.disabled,vt,c.id,Ut,ln,rn)}},sky:function(d,i,c){const f=d.transform,y="mercator"===f.projection.name||"globe"===f.projection.name?1:a.smoothstep(7,8,f.zoom),x=c.paint.get("sky-opacity")*y;if(0===x)return;const D=d.context,P=c.paint.get("sky-type"),F=new a.DepthMode(D.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),W=d.frameCounter/1e3%1;"atmosphere"===P?"offscreen"===d.renderPass?c.needsSkyboxCapture(d)&&(function(Z,ie,ve,Pe){const Oe=Z.context,Be=Oe.gl;let Te=ie.skyboxFbo;if(!Te){Te=ie.skyboxFbo=Oe.createFramebuffer(32,32,!1),ie.skyboxGeometry=new Pa(Oe),ie.skyboxTexture=Oe.gl.createTexture(),Be.bindTexture(Be.TEXTURE_CUBE_MAP,ie.skyboxTexture),Be.texParameteri(Be.TEXTURE_CUBE_MAP,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_CUBE_MAP,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_CUBE_MAP,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_CUBE_MAP,Be.TEXTURE_MAG_FILTER,Be.LINEAR);for(let st=0;st<6;++st)Be.texImage2D(Be.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,Be.RGBA,32,32,0,Be.RGBA,Be.UNSIGNED_BYTE,null)}Oe.bindFramebuffer.set(Te.framebuffer),Oe.viewport.set([0,0,32,32]);const Ae=ie.getCenter(Z,!0),je=Z.useProgram("skyboxCapture"),ze=new Float64Array(16);a.identity(ze),a.rotateY(ze,ze,.5*-Math.PI),Oa(Oe,ie,je,ze,Ae,0),a.identity(ze),a.rotateY(ze,ze,.5*Math.PI),Oa(Oe,ie,je,ze,Ae,1),a.identity(ze),a.rotateX(ze,ze,.5*-Math.PI),Oa(Oe,ie,je,ze,Ae,2),a.identity(ze),a.rotateX(ze,ze,.5*Math.PI),Oa(Oe,ie,je,ze,Ae,3),a.identity(ze),Oa(Oe,ie,je,ze,Ae,4),a.identity(ze),a.rotateY(ze,ze,Math.PI),Oa(Oe,ie,je,ze,Ae,5),Oe.viewport.set([0,0,Z.width,Z.height])}(d,c),c.markSkyboxValid(d)):"sky"===d.renderPass&&function(Z,ie,ve,Pe,Oe){const Be=Z.context,Te=Be.gl,Ae=Z.transform,je=Z.useProgram("skybox");Be.activeTexture.set(Te.TEXTURE0),Te.bindTexture(Te.TEXTURE_CUBE_MAP,ie.skyboxTexture);const ze={u_matrix:Ae.skyboxMatrix,u_sun_direction:ie.getCenter(Z,!1),u_cubemap:0,u_opacity:Pe,u_temporal_offset:Oe};Z.prepareDrawProgram(Be,je),je.draw(Be,Te.TRIANGLES,ve,a.StencilMode.disabled,Z.colorModeForRenderPass(),a.CullFaceMode.backCW,ze,"skybox",ie.skyboxGeometry.vertexBuffer,ie.skyboxGeometry.indexBuffer,ie.skyboxGeometry.segment)}(d,c,F,x,W):"gradient"===P&&"sky"===d.renderPass&&function(Z,ie,ve,Pe,Oe){const Be=Z.context,Te=Be.gl,Ae=Z.transform,je=Z.useProgram("skyboxGradient");ie.skyboxGeometry||(ie.skyboxGeometry=new Pa(Be)),Be.activeTexture.set(Te.TEXTURE0);let ze=ie.colorRampTexture;ze||(ze=ie.colorRampTexture=new a.Texture(Be,ie.colorRamp,Te.RGBA)),ze.bind(Te.LINEAR,Te.CLAMP_TO_EDGE);const st=(Dt=Ae.skyboxMatrix,vt=ie.getCenter(Z,!1),Ut=ie.paint.get("sky-gradient-radius"),ln=Pe,rn=Oe,{u_matrix:Dt,u_color_ramp:0,u_center_direction:vt,u_radius:a.degToRad(Ut),u_opacity:ln,u_temporal_offset:rn});var Dt,vt,Ut,ln,rn;Z.prepareDrawProgram(Be,je),je.draw(Be,Te.TRIANGLES,ve,a.StencilMode.disabled,Z.colorModeForRenderPass(),a.CullFaceMode.backCW,st,"skyboxGradient",ie.skyboxGeometry.vertexBuffer,ie.skyboxGeometry.indexBuffer,ie.skyboxGeometry.segment)}(d,c,F,x,W)},debug:function(d,i,c){for(let f=0;f<c.length;f++)Qs(d,i,c[f])},custom:function(d,i,c){const f=d.context,y=c.implementation;if(d.transform.projection.unsupportedLayers&&d.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===d.renderPass){const x=y.prerender;x&&(d.setCustomLayerDefaults(),f.setColorMode(d.colorModeForRenderPass()),x.call(y,f.gl,d.transform.customLayerMatrix()),f.setDirty(),d.setBaseState())}else if("translucent"===d.renderPass){d.setCustomLayerDefaults(),f.setColorMode(d.colorModeForRenderPass()),f.setStencilMode(a.StencilMode.disabled);const x="3d"===y.renderingMode?new a.DepthMode(d.context.gl.LEQUAL,a.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,a.DepthMode.ReadOnly);f.setDepthMode(x),y.render(f.gl,d.transform.customLayerMatrix()),f.setDirty(),d.setBaseState(),f.bindFramebuffer.set(null)}}};class X{constructor(i,c){this.context=new ee(i),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Go,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const f=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(f||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new fa(this,i));const y=this._terrain;this.transform.elevation=f?y:null,y.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[f,y]=c.getFovAdjustedRange(this.transform._fov);if(f>y)return void(this.transform.fogCullDistSq=null);const x=f+.78*(y-f);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*a.exported.devicePixelRatio,this.height=c*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style.order)this.style._layers[f].resize()}setup(){const i=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const f=new a.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(a.EXTENT,0),f.emplaceBack(0,a.EXTENT),f.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=i.createVertexBuffer(f,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const y=new a.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(y,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const x=new a.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(a.EXTENT,0,a.EXTENT,0),x.emplaceBack(0,a.EXTENT,0,a.EXTENT),x.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(x,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const D=new a.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(D);const P=new a.StructArrayLayout1ui2;for(const W of[0,1,3,2,0])P.emplaceBack(W);this.debugIndexBuffer=i.createIndexBuffer(P),this.emptyTexture=new a.Texture(i,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=a.create();const F=this.context.gl;this.stencilClearMode=new a.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new Dr(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,Sa(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,f){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!f||0===f.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const F of f)if(void 0===this._tileClippingMaskIDs[F.key]){P=!0;break}if(!P)return}this.currentStencilSource=c.id;const y=this.context,x=y.gl;this.nextStencilID+f.length>256&&this.clearStencil(),y.setColorMode(a.ColorMode.disabled),y.setDepthMode(a.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of f){const F=c.getTile(P),W=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:Z,tileBoundsIndexBuffer:ie,tileBoundsSegments:ve}=this.getTileBoundsBuffers(F);D.draw(y,x.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:x.ALWAYS,mask:0},W,255,x.KEEP,x.KEEP,x.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,Sa(P.projMatrix),"$clipping",Z,ie,ve)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new a.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new a.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,f=i.sort((D,P)=>P.overscaledZ-D.overscaledZ),y=f[f.length-1].overscaledZ,x=f[0].overscaledZ-y+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const D={};for(let P=0;P<x;P++)D[P+y]=new a.StencilMode({func:c.GEQUAL,mask:255},P+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[D,f]}return[{[y]:a.StencilMode.disabled},f]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([i.CONSTANT_COLOR,i.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(i,c,f){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new a.DepthMode(f||this.context.gl.LEQUAL,c,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const f=this.style.order,y=this.style._sourceCaches;for(const F in y){const W=y[F];W.used&&W.prepare(this.context)}const x={},D={},P={};for(const F in y){const W=y[F];x[F]=W.getVisibleCoordinates(),D[F]=x[F].slice().reverse(),P[F]=W.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let F=0;F<f.length;F++)if(this.style._layers[f[F]].is3D()){this.opaquePassCutoff=F;break}if(this.terrain&&(this.terrain.updateTileBinding(P),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),a.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const F of f){const W=this.style._layers[F],Z=i._getLayerSourceCache(W);if(!W.hasOffscreenPass()||W.isHidden(this.transform.zoom))continue;const ie=Z?D[Z.id]:void 0;("custom"===W.type||W.isSky()||ie&&ie.length)&&this.renderLayer(this,Z,W,ie)}if(this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=f.length-1;this.currentLayer>=0;this.currentLayer--){const F=this.style._layers[f[this.currentLayer]],W=i._getLayerSourceCache(F);if(F.isSky())continue;const Z=W?D[W.id]:void 0;this._renderTileClippingMasks(F,W,Z),this.renderLayer(this,W,F,Z)}if(this.style.fog&&this.transform.projection.supportsFog&&function(F,W){const Z=F.context,ie=Z.gl,ve=F.transform,Pe=new a.DepthMode(ie.LEQUAL,a.DepthMode.ReadOnly,[0,1]),Oe=F.useProgram("globeAtmosphere",null,"globe"===ve.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Be=a.globeToMercatorTransition(ve.zoom),Te=W.properties.get("color").toArray01(),Ae=W.properties.get("high-color").toArray01(),je=W.properties.get("space-color").toArray01PremultipliedAlpha(),ze=a.identity$1([]);a.rotateY$1(ze,ze,-a.degToRad(ve._center.lng)),a.rotateX$1(ze,ze,a.degToRad(ve._center.lat)),a.rotateZ$1(ze,ze,ve.angle),a.rotateX$1(ze,ze,-ve._pitch);const st=a.fromQuat(new Float32Array(16),ze),Dt=a.mapValue(W.properties.get("star-intensity"),0,1,0,.25),Ut=a.mapValue(W.properties.get("horizon-blend"),0,1,5e-4,.25),ln=a.globeUseCustomAntiAliasing(F,Z,ve)&&5e-4===Ut?ve.worldSize/(2*Math.PI*1.025)-1:ve.globeRadius,rn=F.frameCounter/1e3%1,$t=a.length(ve.globeCenterInViewSpace),qn=Math.sqrt(Math.pow($t,2)-Math.pow(ln,2)),Kt=Math.acos(qn/$t),Pn={u_frustum_tl:ve.frustumCorners.TL,u_frustum_tr:ve.frustumCorners.TR,u_frustum_br:ve.frustumCorners.BR,u_frustum_bl:ve.frustumCorners.BL,u_horizon:ve.frustumCorners.horizon,u_transition:Be,u_fadeout_range:Ut,u_color:Te,u_high_color:Ae,u_space_color:je,u_star_intensity:Dt,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:rn,u_horizon_angle:Kt,u_rotation_matrix:st};F.prepareDrawProgram(Z,Oe);const mn=F.atmosphereBuffer;mn&&Oe.draw(Z,ie.TRIANGLES,Pe,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,Pn,"skybox",mn.vertexBuffer,mn.indexBuffer,mn.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<f.length;this.currentLayer++){const F=this.style._layers[f[this.currentLayer]],W=i._getLayerSourceCache(F);F.isSky()&&this.renderLayer(this,W,F,W?D[W.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<f.length;){const F=this.style._layers[f[this.currentLayer]],W=i._getLayerSourceCache(F);if(F.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(F)){if(F.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Z=W?("symbol"===F.type?P:D)[W.id]:void 0;this._renderTileClippingMasks(F,W,W?x[W.id]:void 0),this.renderLayer(this,W,F,Z),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let F=null;a.values(this.style._layers).forEach(W=>{const Z=i._getLayerSourceCache(W);Z&&!W.isHidden(this.transform.zoom)&&(!F||F.getSource().maxzoom<Z.getSource().maxzoom)&&(F=Z)}),F&&this.options.showTileBoundaries&&Ul.debug(this,F,F.getVisibleCoordinates())}this.options.showPadding&&function(F){const W=F.transform.padding;Hs(F,F.transform.height-(W.top||0),3,yo),Hs(F,W.bottom||0,3,Ir),Qo(F,W.left||0,3,eo),Qo(F,F.transform.width-(W.right||0),3,Wo);const Z=F.transform.centerPoint;var ie,ve,Pe,Oe;No(ie=F,(ve=Z.x)-1,(Pe=F.transform.height-Z.y)-10,2,20,Oe=cs),No(ie,ve-10,Pe-1,20,2,Oe)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}}renderLayer(i,c,f,y){f.isHidden(this.transform.zoom)||("background"===f.type||"sky"===f.type||"custom"===f.type||y&&y.length)&&(this.id=f.id,this.gpuTimingStart(f),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(f.type)||Ul[f.type](i,c,f,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let f=this.gpuTimers[i.id];f||(f=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),f.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,f.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),i.beginQueryEXT(i.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const f in i){const y=i[f],x=this.context.extTimerQuery,D=x.getQueryObjectEXT(y.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(y.query),c[f]=D}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let f=0;for(const y of i)f+=c.getQueryObjectEXT(y,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(y);return f}translatePosMatrix(i,c,f,y,x){if(!f[0]&&!f[1])return i;const D=x?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(D){const W=Math.sin(D),Z=Math.cos(D);f=[f[0]*Z-f[1]*W,f[0]*W+f[1]*Z]}const P=[x?f[0]:Nn(c,f[0],this.transform.zoom),x?f[1]:Nn(c,f[1],this.transform.zoom),0],F=new Float32Array(16);return a.translate(F,i,P),F}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),f=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),"globe"===this.transform.projection.name&&y.push("GLOBE"),c&&y.push("ZERO_EXAGGERATION"),f&&!i&&0!==f.getOpacity(this.transform.pitch)&&y.push("FOG"),i&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(i,c,f){this.cache=this.cache||{};const y=f||[],x=this.currentGlobalDefines().concat(y),D=zr.cacheKey(pa[i],i,x,c);return this.cache[D]||(this.cache[D]=new zr(this.context,i,pa[i],c,z[i],x)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,c,f){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const x=y.getOpacity(this.transform.pitch),D=((P,F,W,Z,ie,ve,Pe,Oe,Be,Te,Ae)=>{const je=P.transform,ze=F.properties.get("color").toArray01();ze[3]=Z;const st=P.frameCounter/1e3%1;return{u_fog_matrix:W?je.calculateFogTileMatrix(W):P.identityMat,u_fog_range:F.getFovAdjustedRange(je._fov),u_fog_color:ze,u_fog_horizon_blend:F.properties.get("horizon-blend"),u_fog_temporal_offset:st,u_frustum_tl:ie,u_frustum_tr:ve,u_frustum_br:Pe,u_frustum_bl:Oe,u_globe_pos:Be,u_globe_radius:Te,u_viewport:Ae,u_globe_transition:a.globeToMercatorTransition(je.zoom),u_is_globe:+("globe"===je.projection.name)}})(this,y,f,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);c.setFogUniformValues(i,D)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},f=this.transform.coveringTiles({tileSize:512});for(const y of f)c[y.key]=i[y.key]||new a.Tile(y,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class M{constructor(i=0,c=0,f=0,y=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=f,this.right=y}interpolate(i,c,f){return null!=c.top&&null!=i.top&&(this.top=a.number(i.top,c.top,f)),null!=c.bottom&&null!=i.bottom&&(this.bottom=a.number(i.bottom,c.bottom,f)),null!=c.left&&null!=i.left&&(this.left=a.number(i.left,c.left,f)),null!=c.right&&null!=i.right&&(this.right=a.number(i.right,c.right,f)),this}getCenter(i,c){const f=a.clamp((this.left+i-this.right)/2,0,i),y=a.clamp((this.top+c-this.bottom)/2,0,c);return new a.pointGeometry(f,y)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new M(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function S(d,i){const c=a.getColumn(d,3);a.fromQuat(d,i),a.setColumn(d,3,c)}function $(d,i){const c=a.identity$1([]);return a.rotateZ$1(c,c,-i),a.rotateX$1(c,c,-d),c}function ue(d,i){const c=[d[0],d[1],0],f=[i[0],i[1],0];if(a.length(c)>=1e-15){const D=a.normalize([],c);a.scale$2(f,D,a.dot(f,D)),i[0]=f[0],i[1]=f[1]}const y=a.cross([],i,d);if(a.len(y)<1e-15)return null;const x=Math.atan2(-y[1],y[0]);return $(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),x)}class Re{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof a.MercatorCoordinate?i:new a.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=a.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const f=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(i)):0,y=this.position,x=a.MercatorCoordinate.fromLngLat(i,f),D=[x.x-y.x,x.y-y.y,x.z-y.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=ue(D,c)}setPitchBearing(i,c){this.orientation=$(a.degToRad(i),a.degToRad(-c))}}class It{constructor(i,c){this._transform=a.identity([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new a.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=a.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&a.setColumn(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||a.identity$1([]),i&&S(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=$(i,c),S(this._transform,this._orientation)}forward(){const i=a.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=a.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=a.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const f=new Float64Array(16);return a.invert(f,this.getWorldToCamera(i,c)),f}getWorldToCameraPosition(i,c,f){const y=this.position;a.scale$2(y,y,-i);const x=new Float64Array(16);return a.fromScaling(x,[f,f,f]),a.translate(x,x,y),x[10]*=c,x}getWorldToCamera(i,c){const f=new Float64Array(16),y=new Float64Array(4),x=this.position;return a.conjugate(y,this._orientation),a.scale$2(x,x,-i),a.fromQuat(f,y),a.translate(f,f,x),f[1]*=-1,f[5]*=-1,f[9]*=-1,f[13]*=-1,f[8]*=c,f[9]*=c,f[10]*=c,f[11]*=c,f}getCameraToClipPerspective(i,c,f,y){const x=new Float64Array(16);return a.perspective(x,i,c,f,y),x}getDistanceToElevation(i,c=!1){const f=0===i?0:a.mercatorZfromAltitude(i,c?a.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(f-this.position[2])/y[2]}clone(){return new It([...this.position],[...this.orientation])}}function Ot(d,i){const c=zn(d.projection,d.zoom,d.width,d.height),f=function(x,D,P,F,W){const Z=new a.LngLat(P.lng-180*di,P.lat),ie=new a.LngLat(P.lng+180*di,P.lat),ve=x.project(Z.lng,Z.lat),Pe=x.project(ie.lng,ie.lat),Oe=-Math.atan2(Pe.y-ve.y,Pe.x-ve.x),Be=a.MercatorCoordinate.fromLngLat(P);Be.y=a.clamp(Be.y,-.999975,.999975);const Te=Be.toLngLat(),Ae=x.project(Te.lng,Te.lat),je=a.MercatorCoordinate.fromLngLat(Te);je.x+=di;const ze=je.toLngLat(),st=x.project(ze.lng,ze.lat),Dt=ur(st.x-Ae.x,st.y-Ae.y,Oe),vt=a.MercatorCoordinate.fromLngLat(Te);vt.y+=di;const Ut=vt.toLngLat(),ln=x.project(Ut.lng,Ut.lat),rn=ur(ln.x-Ae.x,ln.y-Ae.y,Oe),$t=Math.abs(Dt.x)/Math.abs(rn.y),qn=a.identity([]);a.rotateZ(qn,qn,-Oe*(1-(W?0:F)));const Kt=a.identity([]);return a.scale(Kt,Kt,[1,1-(1-$t)*F,1]),Kt[4]=-rn.x/rn.y*F,a.rotateZ(Kt,Kt,Oe),a.multiply(Kt,qn,Kt),Kt}(d.projection,0,d.center,c,i),y=sn(d);return a.scale(f,f,[y,y,1]),f}function sn(d){const i=d.projection,c=zn(d.projection,d.zoom,d.width,d.height),f=Mi(i,d.center),y=Mi(i,a.LngLat.convert(i.center));return Math.pow(2,f*c+(1-c)*y)}function zn(d,i,c,f,y=1/0){const x=d.range;if(!x)return 0;const D=Math.min(y,Math.max(c,f)),P=Math.log(D/1024)/Math.LN2;return a.smoothstep(x[0]+P,x[1]+P,i)}const di=1/4e4;function Mi(d,i){const c=a.clamp(i.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),f=new a.LngLat(i.lng-180*di,c),y=new a.LngLat(i.lng+180*di,c),x=d.project(f.lng,c),D=d.project(y.lng,c),P=a.MercatorCoordinate.fromLngLat(f),F=a.MercatorCoordinate.fromLngLat(y),W=D.x-x.x,Z=D.y-x.y,ie=F.x-P.x,ve=F.y-P.y,Pe=Math.sqrt((ie*ie+ve*ve)/(W*W+Z*Z));return Math.log(Pe)/Math.LN2}function ur(d,i,c){const f=Math.cos(c),y=Math.sin(c);return{x:d*f-i*y,y:d*y+i*f}}class Xi{constructor(i,c,f,y,x,D,P){this.tileSize=512,this._renderWorldCopies=void 0===x||x,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=y??60,this.setProjection(D),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new M,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new It,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new Xi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i,c=!1){const f=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||f)&&this._updateCameraOnTerrain(),(i||f)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const f=!de(c,this.getProjection());return f&&this._calcMatrices(),this.mercatorFromTransition=!1,f}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var f,y,x,D,P,F,W,Z,ie,ve;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(f=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f),y=this.rotationMatrix,D=this.angle,P=(x=this.rotationMatrix)[0],F=x[1],W=x[2],Z=x[3],ie=Math.sin(D),ve=Math.cos(D),y[0]=P*ve+W*ie,y[1]=F*ve+Z*ie,y[2]=P*-ie+W*ve,y[3]=F*-ie+Z*ve)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=a.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=a.degToRad(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],f=this.horizonLineFromTop();let y=0,x=0;for(let D=0;D<c.length;D++){const P=new a.pointGeometry(c[D][0]*this.width,f+c[D][1]*(this.height-f)),F=i.pointCoordinate(P);if(!F)continue;const W=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);y+=F[3]*W,x+=W}return 0===x?NaN:y/x}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),f=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(i),x=this._mercatorZfromZoom(this._maxZoom),D=Math.max(y-f,x);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let f;f=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const y=a.length(a.sub([],this._camera.position,f));return a.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!a.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const f=[i.position.x,i.position.y,i.position.z];a.exactEquals$1(f,this._camera.position)||(this._setCameraPosition(f),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new Re;return c.position=new a.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!a.length$1(i))return!1;a.normalize$1(i,i);const c=a.transformQuat([],[0,0,-1],i),f=a.transformQuat([],[0,-1,0],i);if(f[2]<0)return!1;const y=ue(c,f);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,f=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;i[2]=a.clamp(i[2],y/f,y/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,f){this._unmodified=!1,this._edgeInsets.interpolate(i,c,f),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new a.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const f=this.pointCoordinate(new a.pointGeometry(0,0)),y=this.pointCoordinate(new a.pointGeometry(this.width,0)),x=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),D=this.pointCoordinate(new a.pointGeometry(0,this.height)),P=Math.floor(Math.min(f.x,y.x,x.x,D.x)),F=Math.floor(Math.max(f.x,y.x,x.x,D.x)),W=1;for(let Z=P-W;Z<=F+W;Z++)0!==Z&&c.push(new a.UnwrappedTileID(Z,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const f=c,y=this.elevation&&!i.isTerrainDEM,x="mercator"===this.projection.name;if(void 0!==i.minzoom&&c<i.minzoom)return[];void 0!==i.maxzoom&&c>i.maxzoom&&(c=i.maxzoom);const D=this.locationCoordinate(this.center),P=this.center.lat,F=1<<c,W=[F*D.x,F*D.y,0],Z="globe"===this.projection.name,ie=!Z,ve=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,ie),Pe=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Oe=F*a.mercatorZfromAltitude(1,this.center.lat),Be=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),Te=[F*Pe.x,F*Pe.y,Be*(ie?1:Oe)],Ae=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),je=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,ze=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,st=i.isTerrainDEM?-ze:this._elevation?this._elevation.getMinElevationBelowMSL():0,Dt=this.projection.isReprojectedInTileSpace?sn(this):1,vt=pn=>{const Qn=new a.MercatorCoordinate(pn.x+25e-6,pn.y,pn.z),qt=new a.MercatorCoordinate(pn.x,pn.y+25e-6,pn.z),dn=pn.toLngLat(),Ei=Qn.toLngLat(),ki=qt.toLngLat(),Ci=this.locationCoordinate(dn),ji=this.locationCoordinate(Ei),or=this.locationCoordinate(ki),Pi=Math.hypot(ji.x-Ci.x,ji.y-Ci.y),gi=Math.hypot(or.x-Ci.x,or.y-Ci.y);return Math.sqrt(Pi*gi)*Dt/25e-6},Ut=pn=>{const Un=ze,Qn=st;return{aabb:a.tileAABB(this,F,0,0,0,pn,Qn,Un,this.projection),zoom:0,x:0,y:0,minZ:Qn,maxZ:Un,wrap:pn,fullyVisible:!1}},ln=[];let rn=[];const $t=c,qn=i.reparseOverscaled?f:c,Kt=pn=>pn*pn,Pn=Kt((Be-this._centerAltitude)*Oe),mn=pn=>{if(!this._elevation||!pn.tileID||!x)return;const Un=this._elevation.getMinMaxForTile(pn.tileID),Qn=pn.aabb;Un?(Qn.min[2]=Un.min,Qn.max[2]=Un.max,Qn.center[2]=(Qn.min[2]+Qn.max[2])/2):(pn.shouldSplit=Wn(pn),pn.shouldSplit||(Qn.min[2]=Qn.max[2]=Qn.center[2]=this._centerAltitude))},Wn=pn=>{if(pn.zoom<je)return!0;if(pn.zoom===$t)return!1;if(null!=pn.shouldSplit)return pn.shouldSplit;const Un=pn.aabb.distanceX(Te),Qn=pn.aabb.distanceY(Te);let qt=Pn,dn=1;if(Z){qt=Kt(pn.aabb.distanceZ(Te));const Ci=Math.pow(2,pn.zoom),ji=a.latFromMercatorY((pn.y+1)/Ci),or=a.latFromMercatorY(pn.y/Ci),Pi=Math.min(Math.max(P,ji),or),gi=a.circumferenceAtLatitude(Pi)/a.circumferenceAtLatitude(P);if(dn=Pi===P?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,gi/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&pn.zoom===$t-1&&gi>=.9)return!0}else if(y&&(qt=Kt(pn.aabb.distanceZ(Te)*Oe)),this.projection.isReprojectedInTileSpace&&f<=5){const Ci=Math.pow(2,pn.zoom),ji=vt(new a.MercatorCoordinate((pn.x+.5)/Ci,(pn.y+.5)/Ci));dn=ji>.85?1:ji}const Ei=Un*Un+Qn*Qn+qt;return Ei<Kt((1<<$t-pn.zoom)*Ae*dn*((Ci,ji)=>{if(ji*Kt(.707)<Ci)return 1;const or=Math.sqrt(ji/Ci);return or/(1.4144271570014144+(Math.pow(1.1,or-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(qt,Pn),Ei))};if(this.renderWorldCopies)for(let pn=1;pn<=3;pn++)ln.push(Ut(-pn)),ln.push(Ut(pn));for(ln.push(Ut(0));ln.length>0;){const pn=ln.pop(),Un=pn.x,Qn=pn.y;let qt=pn.fullyVisible;if(!qt){const dn=pn.aabb.intersects(ve);if(0===dn)continue;qt=2===dn}if(pn.zoom!==$t&&Wn(pn))for(let dn=0;dn<4;dn++){const Ei=(Un<<1)+dn%2,ki=(Qn<<1)+(dn>>1),Ci={aabb:x?pn.aabb.quadrant(dn):a.tileAABB(this,F,pn.zoom+1,Ei,ki,pn.wrap,pn.minZ,pn.maxZ,this.projection),zoom:pn.zoom+1,x:Ei,y:ki,wrap:pn.wrap,fullyVisible:qt,tileID:void 0,shouldSplit:void 0,minZ:pn.minZ,maxZ:pn.maxZ};y&&!Z&&(Ci.tileID=new a.OverscaledTileID(pn.zoom+1===$t?qn:pn.zoom+1,pn.wrap,pn.zoom+1,Ei,ki),mn(Ci)),ln.push(Ci)}else{const dn=pn.zoom===$t?qn:pn.zoom;if(i.minzoom&&i.minzoom>dn)continue;const Ei=W[0]-(.5+Un+(pn.wrap<<pn.zoom))*(1<<c-pn.zoom),ki=W[1]-.5-Qn,Ci=pn.tileID?pn.tileID:new a.OverscaledTileID(dn,pn.wrap,pn.zoom,Un,Qn);rn.push({tileID:Ci,distanceSq:Ei*Ei+ki*ki})}}if(this.fogCullDistSq){const pn=this.fogCullDistSq,Un=this.horizonLineFromTop();rn=rn.filter(Qn=>{const qt=[0,0,0,1],dn=[a.EXTENT,a.EXTENT,0,1],Ei=this.calculateFogTileMatrix(Qn.tileID.toUnwrapped());a.transformMat4$1(qt,qt,Ei),a.transformMat4$1(dn,dn,Ei);const ki=a.getAABBPointSquareDist(qt,dn);if(0===ki)return!0;let Ci=!1;const ji=this._elevation;if(ji&&ki>pn&&0!==Un){const or=this.calculateProjMatrix(Qn.tileID.toUnwrapped());let Pi;i.isTerrainDEM||(Pi=ji.getMinMaxForTile(Qn.tileID)),Pi||(Pi={min:st,max:ze});const gi=a.furthestTileCorner(this.rotation),jr=[gi[0]*a.EXTENT,gi[1]*a.EXTENT,Pi.max];a.transformMat4(jr,jr,or),Ci=(1-jr[1])*this.height*.5<Un}return ki<pn||Ci})}return rn.sort((pn,Un)=>pn.distanceSq-Un.distanceSq).map(pn=>pn.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=a.clamp(i.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),f=this.projection.project(i.lng,c);return new a.pointGeometry(f.x*this.worldSize,f.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(i,c){let f,y;const x=this.centerPoint;if("globe"===this.projection.name){const P=this.worldSize;f=(c.x-x.x)/P,y=(c.y-x.y)/P}else{const P=this.pointCoordinate(c),F=this.pointCoordinate(x);f=P.x-F.x,y=P.y-F.y}const D=this.locationCoordinate(i);this.setLocation(new a.MercatorCoordinate(D.x-f,D.y-y))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const f=c?a.mercatorZfromAltitude(c,i.lat):void 0,y=this.projection.project(i.lng,i.lat);return new a.MercatorCoordinate(y.x,y.y,f)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const f=c??this._centerAltitude,y=[i.x,i.y,0,1],x=[i.x,i.y,1,1];a.transformMat4$1(y,y,this.pixelMatrixInverse),a.transformMat4$1(x,x,this.pixelMatrixInverse);const D=x[3];a.scale$1(y,y,1/y[3]),a.scale$1(x,x,1/D);const P=y[2],F=x[2];return{p0:y,p1:x,t:P===F?0:(f-P)/(F-P)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],f=[i.x,i.y,1,1];return a.transformMat4$1(c,c,this.pixelMatrixInverse),a.transformMat4$1(f,f,this.pixelMatrixInverse),a.scale$1(c,c,1/c[3]),a.scale$1(f,f,1/f[3]),c[2]=a.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,f[2]=a.mercatorZfromAltitude(f[2],this._center.lat)*this.worldSize,a.scale$1(c,c,1/this.worldSize),a.scale$1(f,f,1/this.worldSize),new a.Ray([c[0],c[1],c[2]],a.normalize([],a.sub([],f,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:f,t:y}=i,x=a.mercatorZfromAltitude(c[2],this._center.lat),D=a.mercatorZfromAltitude(f[2],this._center.lat);return new a.MercatorCoordinate(a.number(c[0],f[0],y)/this.worldSize,a.number(c[1],f[1],y)/this.worldSize,a.number(x,D,y))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let c=this.projection.pointCoordinate3D(this,i.x,i.y);if(c)return new a.MercatorCoordinate(c[0],c[1],c[2]);let f=0,y=this.horizonLineFromTop();if(i.y>y)return this.pointCoordinate(i);const x=.02*y,D=i.clone();for(let P=0;P<10&&y-f>x;P++){D.y=a.number(f,y,.66);const F=this.projection.pointCoordinate3D(this,D.x,D.y);F?(y=D.y,c=F):f=D.y}return c?new a.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}_coordinatePoint(i,c){const f=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,y=[i.x*this.worldSize,i.y*this.worldSize,f+i.toAltitude(),1];return a.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new a.pointGeometry(y[0]/y[3],y[1]/y[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:i,left:c}=this._edgeInsets,f=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,x=this.pointCoordinate3D(new a.pointGeometry(c,i)),D=this.pointCoordinate3D(new a.pointGeometry(y,i)),P=this.pointCoordinate3D(new a.pointGeometry(y,f)),F=this.pointCoordinate3D(new a.pointGeometry(c,f));let W=Math.min(x.x,F.x),Z=Math.max(D.x,P.x),ie=Math.min(x.y,D.y),ve=Math.max(F.y,P.y);const Pe=Math.pow(2,-this.zoom)/16,Oe=(vt,Ut,ln,rn)=>{const $t=(vt+ln)/2,qn=(Ut+rn)/2,Kt=new a.pointGeometry($t,qn),Pn=this.pointCoordinate3D(Kt),mn=Math.max(0,W-Pn.x,ie-Pn.y,Pn.x-Z,Pn.y-ve);W=Math.min(W,Pn.x),Z=Math.max(Z,Pn.x),ie=Math.min(ie,Pn.y),ve=Math.max(ve,Pn.y),mn>Pe&&(Oe(vt,Ut,$t,qn),Oe($t,qn,ln,rn))};Oe(c,i,y,i),Oe(y,i,y,f),Oe(y,f,c,f),Oe(c,f,c,i);const[Be,Te]=a.polesInViewport(this),Ae=Be||Te,je=Be?90:a.latFromMercatorY(ie),ze=Ae?180:a.lngFromMercatorX(Z),st=Te?-90:a.latFromMercatorY(ve),Dt=Ae?-180:a.lngFromMercatorX(W);return new a.LngLatBounds(new a.LngLat(Dt,st),new a.LngLat(ze,je))}_getBounds(i,c){if("globe"===this.projection.name)return this._getGlobeBounds();const f=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),y=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),x=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),D=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let P=this.pointCoordinate(f,i),F=this.pointCoordinate(y,i);const W=this.pointCoordinate(x,c),Z=this.pointCoordinate(D,c),ie=(ve,Pe)=>(Pe.y-ve.y)/(Pe.x-ve.x);return P.y>1&&F.y>=0?P=new a.MercatorCoordinate((1-Z.y)/ie(Z,P)+Z.x,1):P.y<0&&F.y<=1&&(P=new a.MercatorCoordinate(-Z.y/ie(Z,P)+Z.x,0)),F.y>1&&P.y>=0?F=new a.MercatorCoordinate((1-W.y)/ie(W,F)+W.x,1):F.y<0&&P.y<=1&&(F=new a.MercatorCoordinate(-W.y/ie(W,F)+W.x,0)),(new a.LngLatBounds).extend(this.coordinateLocation(P)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(W))}_getBounds3D(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBounds(0,0);const c=i.visibleDemTiles.reduce((f,y)=>{if(y.dem){const x=y.dem.tree;f.min=Math.min(f.min,x.minimums[0]),f.max=Math.max(f.max,x.maximums[0])}return f},{min:Number.MAX_VALUE,max:0});return this._getBounds(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,f=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,f):f}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,f=this._distanceTileDataCache;if(f[c])return f[c];const y=i.canonical,x=1/this.height,D=this.cameraWorldSize,P=D/this.zoomScale(y.z),F=(y.x+Math.pow(2,y.z)*i.wrap)*P,W=y.y*P,Z=this.point;Z.x*=D/this.worldSize,Z.y*=D/this.worldSize;const ie=this.angle,ve=Math.sin(-ie),Pe=-Math.cos(-ie);return f[c]={bearing:[ve,Pe],center:[(Z.x-F)*x,(Z.y-W)*x],scale:P/a.EXTENT*x},f[c]}calculateFogTileMatrix(i){const c=i.key,f=this._fogTileMatrixCache;if(f[c])return f[c];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return a.multiply(y,this.worldToFogMatrix,y),f[c]=new Float32Array(y),f[c]}calculateProjMatrix(i,c=!1){const f=i.key,y=c?this._alignedProjMatrixCache:this._projMatrixCache;if(y[f])return y[f];const x=this.calculatePosMatrix(i,this.worldSize);return a.multiply(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,x),y[f]=new Float32Array(x),y[f]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,f=this._pixelsToTileUnitsCache;if(f[c])return f[c];const y=function(x,D){const{scale:P}=x.tileTransform,F=P*a.EXTENT/(x.tileSize*Math.pow(2,D.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return W=new Float32Array(4),ve=(Z=D.inverseAdjustmentMatrix)[1],Pe=Z[2],Oe=Z[3],Te=(ie=[F,F])[1],W[0]=Z[0]*(Be=ie[0]),W[1]=ve*Be,W[2]=Pe*Te,W[3]=Oe*Te,W;var W,Z,ie,ve,Pe,Oe,Be,Te}(i,this);return f[c]=y,f[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const c=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,f=this._computeCameraPosition(c),y=this._camera.forward(),x=a.mercatorZfromAltitude(1,this._center.lat);f[2]/=x,y[2]/=x,a.normalize(y,y);const D=i.raycast(f,y,i.exaggeration());if(D){const P=a.scaleAndAdd([],f,y,D),F=new a.MercatorCoordinate(P[0],P[1],a.mercatorZfromAltitude(P[2],a.latFromMercatorY(P[1]))),W=(F.z+a.length([F.x-f[0],F.y-f[1],F.z-f[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(W),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,f=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),x=c.getAtPointOrZero(new a.MercatorCoordinate(...y)),D=this.pixelsPerMeter/this.worldSize*x,P=this._minimumHeightOverTerrain(),F=y[2]-D;if(F<=P)if(F<0||i){const W=this.locationCoordinate(this._center,this._centerAltitude),Z=[y[0],y[1],W.z-y[2]],ie=a.length(Z);Z[2]-=(P-F)/this._pixelsPerMercatorPixel;const ve=a.length(Z);if(0===ve)return;a.scale$2(Z,Z,ie/ve*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],W.z*this._pixelsPerMercatorPixel-Z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const ve=this.center;return ve.lat=a.clamp(ve.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(ve.lng=a.clamp(ve.lng,this.minLng,this.maxLng)),this.center=ve,void(this._constraining=!1)}const c=this._unmodified,{x:f,y}=this.point;let x=0,D=f,P=y;const F=this.width/2,W=this.height/2,Z=this.worldMinY*this.scale,ie=this.worldMaxY*this.scale;if(y-W<Z&&(P=Z+W),y+W>ie&&(P=ie-W),ie-Z<this.height&&(x=Math.max(x,this.height/(ie-Z)),P=(ie+Z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ve=this.worldMinX*this.scale,Pe=this.worldMaxX*this.scale,Oe=this.worldSize/2-(ve+Pe)/2;D=(f+Oe+this.worldSize)%this.worldSize-Oe,D-F<ve&&(D=ve+F),D+F>Pe&&(D=Pe-F),Pe-ve<this.width&&(x=Math.max(x,this.width/(Pe-ve)),D=(Pe+ve)/2)}D===f&&P===y||(this.center=this.unproject(new a.pointGeometry(D,P))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const f=zn(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,f),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?c:1),x=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);x[8]=2*-i.x/this.width,x[9]=2*i.y/this.height;let D=a.mul([],x,y);if(this.projection.isReprojectedInTileSpace){const Dt=this.locationCoordinate(this.center),vt=a.identity([]);a.translate(vt,vt,[Dt.x*this.worldSize,Dt.y*this.worldSize,0]),a.multiply(vt,vt,Ot(this)),a.translate(vt,vt,[-Dt.x*this.worldSize,-Dt.y*this.worldSize,0]),a.multiply(D,D,vt),this.inverseAdjustmentMatrix=function(Ut){const ln=Ot(Ut,!0);return Ce([],[ln[0],ln[1],ln[4],ln[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],D,[this.worldSize,this.worldSize,this.worldSize/c,1]),this.projMatrix=D,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const P=a.invert([],x);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(P,this.horizonLineFromTop(),this.height);const F=new Float32Array(16);a.identity(F),a.scale(F,F,[1,-1,1]),a.rotateX(F,F,this._pitch),a.rotateZ(F,F,this.angle);const W=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Z=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-i.x/this.width,W[9]=2*(i.y+Z)/this.height,this.skyboxMatrix=a.multiply(F,W,F);const ie=this.point,ve=ie.x,Pe=ie.y,Oe=this.width%2/2,Be=this.height%2/2,Te=Math.cos(this.angle),Ae=Math.sin(this.angle),je=ve-Math.round(ve)+Te*Oe+Ae*Be,ze=Pe-Math.round(Pe)+Te*Be+Ae*Oe,st=new Float64Array(D);if(a.translate(st,st,[je>.5?je-1:je,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=st,D=a.create(),a.scale(D,D,[this.width/2,-this.height/2,1]),a.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=a.create(),a.scale(D,D,[1,-1,1]),a.translate(D,D,[-1,-1,0]),a.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=a.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Dt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Dt,Dt,y),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,f=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,x=[i,i,c];a.scale$2(x,x,y),a.scale$2(f,f,-1),a.multiply$2(f,f,x);const D=a.create();a.translate(D,D,f),a.scale(D,D,x),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,y)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,f=this._camera.forward(),y=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-f[0]*x,y.y/this.worldSize-f[1]*x,i/this.worldSize*this._centerAltitude-f[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),f=this._camera.position[2],y=i[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(x=Math.min((c-f)/y,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,i,x),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:f,bearing:y}=this._camera.getPitchBearing(),x=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),P=Math.max((i[2]-x)/Math.cos(f),D),F=this._zoomFromMercatorZ(P);a.scaleAndAdd(i,i,c,P),this._pitch=a.clamp(f,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(y,-Math.PI,Math.PI),this._setZoom(a.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){const c=D=>{const P=this.getCameraToCenterDistance(this.projection,D);return this.scaleZoom(P/(i*this.tileSize))};let f,y=c(this.zoom),x=Math.abs(y-c(y));for(;f!==x;)y=c(y),f=x,x=Math.abs(y-c(y));return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const f=Math.min(i.x,c.x),y=Math.max(i.x,c.x),x=Math.min(i.y,c.y),D=Math.max(i.y,c.y);if(x<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const P=[new a.pointGeometry(f,x),new a.pointGeometry(y,D),new a.pointGeometry(f,D),new a.pointGeometry(y,x)],F=this.renderWorldCopies?-3:0,W=this.renderWorldCopies?4:1;for(const Z of P){const ie=this.pointRayIntersection(Z);if(ie.t<0)return!0;const ve=this.rayIntersectionCoordinate(ie);if(ve.x<F||ve.y<0||ve.x>W||ve.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,c){const f=a.length(a.sub([],this._camera.position,i)),y=this._zoomFromMercatorZ(f)+c;return f-this._mercatorZfromZoom(y)}getCameraPoint(){if("globe"===this.projection.name){const i=function([c,f,y],x){const D=[c,f,y,1];a.transformMat4$1(D,D,x);const P=D[3]=Math.max(D[3],1e-6);return D[0]/=P,D[1]/=P,D[2]/=P,D}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,i))}}getCameraToCenterDistance(i,c=this.zoom){const f=zn(i,c,this.width,this.height,1024),y=i.pixelSpaceConversion(this.center.lat,this.worldSize,f);return.5/Math.tan(.5*this._fov)*this.height*y}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&a.multiply(i,i,this.globeMatrix),i}}function Vi(d,i){let c=!1,f=null;const y=()=>{f=null,c&&(d(),f=setTimeout(y,i),c=!1)};return()=>(c=!0,f||y(),f)}class In{constructor(i){this._hashName=i&&encodeURIComponent(i),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Vi(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,a.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=ir(i);if(this._hashName){const f=this._hashName;let y=!1;const x=a.window.location.hash.slice(1).split("&").map(D=>{const P=D.split("=")[0];return P===f?(y=!0,`${P}=${c}`):D}).filter(D=>D);return y||x.push(`${f}=${c}`),`#${x.join("&")}`}return`#${c}`}_getCurrentHash(){const i=a.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(f=>isNaN(f))){const f=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,i)}}function ir(d,i){const c=d.getCenter(),f=Math.round(100*d.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,y),D=Math.round(c.lng*x)/x,P=Math.round(c.lat*x)/x,F=d.getBearing(),W=d.getPitch();let Z=i?`/${D}/${P}/${f}`:`${f}/${P}/${D}`;return(F||W)&&(Z+="/"+Math.round(10*F)/10),W&&(Z+=`/${Math.round(W)}`),Z}const Mr={linearity:.3,easing:a.bezier(0,0,.3,1)},vo=a.extend({deceleration:2500,maxSpeed:1400},Mr),ko=a.extend({deceleration:20,maxSpeed:1400},Mr),ro=a.extend({deceleration:1e3,maxSpeed:360},Mr),ma=a.extend({deceleration:1e3,maxSpeed:90},Mr);class Jo{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=a.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const x=es(c.pan.mag(),f,a.extend({},vo,i||{}));y.offset=c.pan.mult(x.amount/c.pan.mag()),y.center=this._map.transform.center,Po(y,x)}if(c.zoom){const x=es(c.zoom,f,ko);y.zoom=this._map.transform.zoom+x.amount,Po(y,x)}if(c.bearing){const x=es(c.bearing,f,ro);y.bearing=this._map.transform.bearing+a.clamp(x.amount,-179,179),Po(y,x)}if(c.pitch){const x=es(c.pitch,f,ma);y.pitch=this._map.transform.pitch+x.amount,Po(y,x)}if(y.zoom||y.bearing){const x=void 0===c.pinchAround?c.around:c.pinchAround;y.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function Po(d,i){(!d.duration||d.duration<i.duration)&&(d.duration=i.duration,d.easing=i.easing)}function es(d,i,c){const{maxSpeed:f,linearity:y,deceleration:x}=c,D=a.clamp(d*y/(i/1e3),-f,f),P=Math.abs(D)/(x*y);return{easing:c.easing,duration:1e3*P,amount:D*(P/2)}}class xo extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f,y={}){const x=Qe(c.getCanvasContainer(),f),D=c.unproject(x);super(i,a.extend({point:x,lngLat:D,originalEvent:f},y)),this._defaultPrevented=!1,this.target=c}}class bs extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f){const y="touchend"===i?f.changedTouches:f.touches,x=Hn(c.getCanvasContainer(),y),D=x.map(F=>c.unproject(F)),P=x.reduce((F,W,Z,ie)=>F.add(W.div(ie.length)),new a.pointGeometry(0,0));super(i,{points:x,point:P,lngLats:D,lngLat:c.unproject(P),originalEvent:f}),this._defaultPrevented=!1}}class ll extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,f){super(i,{originalEvent:f}),this._defaultPrevented=!1}}class Ra{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new ll(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new xo(i.type,this._map,i))}mouseup(i){this._map.fire(new xo(i.type,this._map,i))}preclick(i){const c=a.extend({},i);c.type="preclick",this._map.fire(new xo(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new xo(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new xo(i.type,this._map,i))}mouseover(i){this._map.fire(new xo(i.type,this._map,i))}mouseout(i){this._map.fire(new xo(i.type,this._map,i))}touchstart(i){return this._firePreventable(new bs(i.type,this._map,i))}touchmove(i){this._map.fire(new bs(i.type,this._map,i))}touchend(i){this._map.fire(new bs(i.type,this._map,i))}touchcancel(i){this._map.fire(new bs(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ur{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new xo(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new xo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new xo(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xc{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&0===i.button&&(wt(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const f=c,y=this._startPos,x=this._lastPos;if(!y||!x||x.equals(f)||!this._box&&f.dist(y)<this._clickTolerance)return;this._lastPos=f,this._box||(this._box=ke("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const D=Math.min(y.x,f.x),P=Math.max(y.x,f.x),F=Math.min(y.y,f.y),W=Math.max(y.y,f.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${F}px)`,this._box.style.width=P-D+"px",this._box.style.height=W-F+"px")})}mouseupWindow(i,c){if(!this._active)return;const f=this._startPos,y=c;if(f&&0===i.button){if(this.reset(),kt(),f.x!==y.x||f.y!==y.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:x=>x.fitScreenCoordinates(f,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),tt(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new a.Event(i,{originalEvent:c}))}}function ka(d,i){const c={};for(let f=0;f<d.length;f++)c[d[f].identifier]=i[f];return c}class Di{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){const x=new a.pointGeometry(0,0);for(const D of y)x._add(D);return x.div(y.length)}(c),this.touches=ka(f,c)))}touchmove(i,c,f){if(this.aborted||!this.centroid)return;const y=ka(f,c);for(const x in this.touches){const D=this.touches[x],P=y[x];(!P||P.dist(D)>30)&&(this.aborted=!0)}}touchend(i,c,f){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===f.length){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Ii{constructor(i){this.singleTap=new Di(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,f){this.singleTap.touchstart(i,c,f)}touchmove(i,c,f){this.singleTap.touchmove(i,c,f)}touchend(i,c,f){const y=this.singleTap.touchend(i,c,f);if(y){const x=i.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(y)<30;if(x&&D||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Zi{constructor(){this._zoomIn=new Ii({numTouches:1,numTaps:2}),this._zoomOut=new Ii({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,f){this._zoomIn.touchstart(i,c,f),this._zoomOut.touchstart(i,c,f)}touchmove(i,c,f){this._zoomIn.touchmove(i,c,f),this._zoomOut.touchmove(i,c,f)}touchend(i,c,f){const y=this._zoomIn.touchend(i,c,f),x=this._zoomOut.touchend(i,c,f);return y?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(y)},{originalEvent:i})}):x?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(x)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const br={0:1,2:2};class oo{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const f=Ln(i);this._correctButton(i,f)&&(this._lastPoint=c,this._eventButton=f)}mousemoveWindow(i,c){const f=this._lastPoint;if(f)if(i.preventDefault(),null!=this._eventButton&&function(y,x){const D=br[x];return void 0===y.buttons||(y.buttons&D)!==D}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(f)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(f,c)}mouseupWindow(i){this._lastPoint&&Ln(i)===this._eventButton&&(this._moved&&kt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ga extends oo{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return 0===c&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class us extends oo{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const f=.8*(c.x-i.x);if(f)return this._active=!0,{bearingDelta:f}}contextmenu(i){i.preventDefault()}}class Gs extends oo{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const f=-.5*(c.y-i.y);if(f)return this._active=!0,{pitchDelta:f}}contextmenu(i){i.preventDefault()}}class Or{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(i,c,f){return this._calculateTransform(i,c,f)}touchmove(i,c,f){if(this._active&&!(f.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===f.length&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,f)}}touchend(i,c,f){this._calculateTransform(i,c,f),this._active&&f.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,f){f.length>0&&(this._active=!0);const y=ka(f,c),x=new a.pointGeometry(0,0),D=new a.pointGeometry(0,0);let P=0;for(const W in y){const Z=y[W],ie=this._touches[W];ie&&(x._add(Z),D._add(Z.sub(ie)),P++,y[W]=Z)}if(this._touches=y,P<this._minTouches||!D.mag())return;const F=D.div(P);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(P),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ke("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Js{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,f){return{}}touchstart(i,c,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,f){const y=this._firstTwoTouches;if(!y)return;i.preventDefault();const[x,D]=y,P=qo(f,c,x),F=qo(f,c,D);if(!P||!F)return;const W=this._aroundCenter?null:P.add(F).div(2);return this._move([P,F],W,i)}touchend(i,c,f){if(!this._firstTwoTouches)return;const[y,x]=this._firstTwoTouches,D=qo(f,c,y),P=qo(f,c,x);D&&P||(this._active&&kt(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function qo(d,i,c){for(let f=0;f<d.length;f++)if(d[f].identifier===c)return i[f]}function Uo(d,i){return Math.log(d/i)/Math.LN2}class ea extends Js{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const f=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Uo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Uo(this._distance,f),pinchAround:c}}}function bo(d,i){return 180*d.angleWith(i)/Math.PI}class _l extends Js{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const f=this._vector;if(this._vector=i[0].sub(i[1]),f&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:bo(this._vector,f),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,f=this._startVector;if(!f)return!1;const y=bo(i,f);return Math.abs(y)<c}}function Vl(d){return Math.abs(d.y)>Math.abs(d.x)}class qr extends Js{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Vl(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,f){const y=this._lastPoints;if(!y)return;const x=i[0].sub(y[0]),D=i[1].sub(y[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&f.touches.length<3||(this._valid=this.gestureBeginsVertically(x,D,f.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(x.y+D.y)/2*-.5})}gestureBeginsVertically(i,c,f){if(void 0!==this._valid)return this._valid;const y=i.mag()>=2,x=c.mag()>=2;if(!y&&!x)return;if(!y||!x)return null==this._firstMove&&(this._firstMove=f),f-this._firstMove<100&&void 0;const D=i.y>0==c.y>0;return Vl(i)&&Vl(c)&&D}}const Pu={panStep:100,bearingStep:15,pitchStep:10};class ds{constructor(){const i=Pu;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,f=0,y=0,x=0,D=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?f=-1:(i.preventDefault(),x=-1);break;case 39:i.shiftKey?f=1:(i.preventDefault(),x=1);break;case 38:i.shiftKey?y=1:(i.preventDefault(),D=-1);break;case 40:i.shiftKey?y=-1:(i.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:P=>{const F=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:ah,zoom:c?Math.round(F)+c*(i.shiftKey?2:1):F,bearing:P.getBearing()+f*this._bearingStep,pitch:P.getPitch()+y*this._pitchStep,offset:[-x*this._panStep,-D*this._panStep],center:P.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ah(d){return d*(2-d)}const Ou=4.000244140625;class lh{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const f=a.exported.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,0!==c&&c%Ou==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Qe(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const F="wheel"===this._type&&Math.abs(this._delta)>Ou?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==W&&(W=1/W);const Z=c(),ie=Math.pow(2,Z),ve="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):ie;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(ve*W))),"wheel"===this._type&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._delta=0}const f="number"==typeof this._targetZoom?this._targetZoom:c(),y=this._startZoom,x=this._easing;let D,P=!1;if("wheel"===this._type&&y&&x){const F=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),W=x(F);D=a.number(y,f,W),F<1?this._frameId||(this._frameId=!0):P=!0}else D=f,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:D-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=a.ease;if(this._prevEase){const f=this._prevEase,y=(a.exported.now()-f.start)/f.duration,x=f.easing(y+.01)-f.easing(y),D=.27/Math.sqrt(x*x+1e-4)*.01,P=Math.sqrt(.0729-D*D);c=a.bezier(D,P,.25,1)}return this._prevEase={start:a.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ke("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class dd{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class yl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:f.getZoom()+(i.shiftKey?-1:1),around:f.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bc{constructor(){this._tap=new Ii({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,f){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?f.length>0&&(this._swipePoint=c[0],this._swipeTouch=f[0].identifier):this._tap.touchstart(i,c,f))}touchmove(i,c,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=c[0],x=y.y-this._swipePoint.y;return this._swipePoint=y,i.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(i,c,f)}touchend(i,c,f){this._tapTime?this._swipePoint&&0===f.length&&this.reset():this._tap.touchend(i,c,f)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vl{constructor(i,c,f){this._el=i,this._mousePan=c,this._touchPan=f}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xl{constructor(i,c,f){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Oo{constructor(i,c,f,y){this._el=i,this._touchZoom=c,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const pi=d=>d.zoom||d.drag||d.pitch||d.rotate;class nc extends a.Event{}class hd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const f=a.sub([],c,i);this.radius=a.length(f[2]<0?a.div([],f,this.constants):[f[0],f[1],0])}projectRay(i){a.div(i,i,this.constants),a.normalize(i,i),a.mul$1(i,i,this.constants);const c=a.scale$2([],i,this.radius);if(c[2]>0){const f=a.scale$2([],[0,0,1],a.dot(c,[0,0,1])),y=a.scale$2([],a.normalize([],[c[0],c[1],0]),this.radius),x=a.add([],c,a.scale$2([],a.sub([],a.add([],y,f),c),2));c[0]=x[0],c[1]=x[1]}return c}}function bl(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class hs{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Jo(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new hd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),a.bindAll(["handleEvent","handleWindowEvent"],this);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[y,x,D]of this._listeners)y.addEventListener(x,y===a.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[i,c,f]of this._listeners)i.removeEventListener(c,i===a.window.document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(i){const c=this._map,f=c.getCanvasContainer();this._add("mapEvent",new Ra(c,i));const y=c.boxZoom=new xc(c,i);this._add("boxZoom",y);const x=new Zi,D=new yl;c.doubleClickZoom=new dd(D,x),this._add("tapZoom",x),this._add("clickZoom",D);const P=new bc;this._add("tapDragZoom",P);const F=c.touchPitch=new qr(c);this._add("touchPitch",F);const W=new us(i),Z=new Gs(i);c.dragRotate=new xl(i,W,Z),this._add("mouseRotate",W,["mousePitch"]),this._add("mousePitch",Z,["mouseRotate"]);const ie=new ga(i),ve=new Or(c,i);c.dragPan=new vl(f,ie,ve),this._add("mousePan",ie),this._add("touchPan",ve,["touchZoom","touchRotate"]);const Pe=new _l,Oe=new ea;c.touchZoomRotate=new Oo(f,Oe,Pe,P),this._add("touchRotate",Pe,["touchPan","touchZoom"]),this._add("touchZoom",Oe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ur(c));const Be=c.scrollZoom=new lh(c,this);this._add("scrollZoom",Be,["mousePan"]);const Te=c.keyboard=new ds;this._add("keyboard",Te);for(const Ae of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[Ae]&&c[Ae].enable(i[Ae])}_add(i,c,f){this._handlers.push({handlerName:i,handler:c,allowed:f}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!pi(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,f){for(const y in i)if(y!==f&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const f of i)this._el.contains(f.target)&&c.push(f);return c}handleEvent(i,c){this._updatingCamera=!0;const f="renderFrame"===i.type,y=f?void 0:i,x={needsRenderFrame:!1},D={},P={},F=i.touches?this._getMapTouches(i.touches):void 0,W=F?Hn(this._el,F):f?void 0:Qe(this._el,i);for(const{handlerName:ve,handler:Pe,allowed:Oe}of this._handlers){if(!Pe.isEnabled())continue;let Be;this._blockedByActive(P,Oe,ve)?Pe.reset():Pe[c||i.type]&&(Be=Pe[c||i.type](i,W,F),this.mergeHandlerResult(x,D,Be,ve,y),Be&&Be.needsRenderFrame&&this._triggerRenderFrame()),(Be||Pe.isActive())&&(P[ve]=Pe)}const Z={};for(const ve in this._previousActiveHandlers)P[ve]||(Z[ve]=y);this._previousActiveHandlers=P,(Object.keys(Z).length||bl(x))&&(this._changes.push([x,D,Z]),this._triggerRenderFrame()),(Object.keys(P).length||bl(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=x;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))}mergeHandlerResult(i,c,f,y,x){if(!f)return;a.extend(i,f);const D={handlerName:y,originalEvent:f.originalEvent||x};void 0!==f.zoomDelta&&(c.zoom=D),void 0!==f.panDelta&&(c.drag=D),void 0!==f.pitchDelta&&(c.pitch=D),void 0!==f.bearingDelta&&(c.rotate=D)}_applyChanges(){const i={},c={},f={};for(const[y,x,D]of this._changes)y.panDelta&&(i.panDelta=(i.panDelta||new a.pointGeometry(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),void 0!==y.around&&(i.around=y.around),void 0!==y.aroundCoord&&(i.aroundCoord=y.aroundCoord),void 0!==y.pinchAround&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),a.extend(c,x),a.extend(f,D);this._updateMapTransform(i,c,f),this._changes=[]}_updateMapTransform(i,c,f){const y=this._map,x=y.transform,D=je=>[je.x,je.y,je.z];if((je=>{const ze=this._eventsInProgress.drag;return ze&&!this._handlersById[ze.handlerName].isActive()})()&&!bl(i)){const je=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",je!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&y._stop(!0),!bl(i))return void this._fireEvents(c,f,!0);let{panDelta:P,zoomDelta:F,bearingDelta:W,pitchDelta:Z,around:ie,aroundCoord:ve,pinchAround:Pe}=i;x._isCameraConstrained&&(F>0&&(F=0),x._isCameraConstrained=!1),void 0!==Pe&&(ie=Pe),(je=>c.drag&&!this._eventsInProgress.drag)()&&ie&&(this._dragOrigin=D(x.pointCoordinate3D(ie)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",y._stop(!0),ie=ie||y.transform.centerPoint,W&&(x.bearing+=W),Z&&(x.pitch+=Z),x._updateCameraState();const Oe=[0,0,0];if(P)if("mercator"===x.projection.name){const je=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(ie).dir),ze=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(ie.sub(P)).dir);Oe[0]=ze[0]-je[0],Oe[1]=ze[1]-je[1]}else{const je=x.pointCoordinate(ie);if("globe"===x.projection.name){P=P.rotate(-x.angle);const ze=x._pixelsPerMercatorPixel/x.worldSize;Oe[0]=-P.x*a.mercatorScale(a.latFromMercatorY(je.y))*ze,Oe[1]=-P.y*a.mercatorScale(x.center.lat)*ze}else{const ze=x.pointCoordinate(ie.sub(P));je&&ze&&(Oe[0]=ze.x-je.x,Oe[1]=ze.y-je.y)}}const Be=x.zoom,Te=[0,0,0];if(F){const je=D(ve||x.pointCoordinate3D(ie)),ze={dir:a.normalize([],a.sub([],je,x._camera.position))};if(ze.dir[2]<0){const st=x.zoomDeltaToMovement(je,F);a.scale$2(Te,ze.dir,st)}}const Ae=a.add(Oe,Oe,Te);x._translateCameraConstrained(Ae),F&&Math.abs(x.zoom-Be)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,f,!0)}_fireEvents(i,c,f){const y=pi(this._eventsInProgress),x=pi(i),D={};for(const Z in i){const{originalEvent:ie}=i[Z];this._eventsInProgress[Z]||(D[`${Z}start`]=ie),this._eventsInProgress[Z]=i[Z]}!y&&x&&this._fireEvent("movestart",x.originalEvent);for(const Z in D)this._fireEvent(Z,D[Z]);x&&this._fireEvent("move",x.originalEvent);for(const Z in i){const{originalEvent:ie}=i[Z];this._fireEvent(Z,ie)}const P={};let F;for(const Z in this._eventsInProgress){const{handlerName:ie,originalEvent:ve}=this._eventsInProgress[Z];this._handlersById[ie].isActive()||(delete this._eventsInProgress[Z],F=c[ie]||ve,P[`${Z}end`]=F)}for(const Z in P)this._fireEvent(Z,P[Z]);const W=pi(this._eventsInProgress);if(f&&(y||x)&&!W){this._updatingCamera=!0;const Z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ie=ve=>0!==ve&&-this._bearingSnap<ve&&ve<this._bearingSnap;Z?(ie(Z.bearing||this._map.getBearing())&&(Z.bearing=0),this._map.easeTo(Z,{originalEvent:F})):(this._map.fire(new a.Event("moveend",{originalEvent:F})),ie(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new a.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new nc("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Fa="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class su extends a.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,f){return i=a.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,a.extend({offset:i},c),f)}panTo(i,c,f){return this.easeTo(a.extend({center:i},c),f)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,f){return this.easeTo(a.extend({zoom:i},c),f)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,f){return this.easeTo(a.extend({bearing:i},c),f)}resetNorth(i,c){return this.rotateTo(0,a.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=a.LngLatBounds.convert(i);const f=c&&c.bearing||0,y=c&&c.pitch||0,x=i.getNorthWest(),D=i.getSouthEast();return this._cameraForBounds(this.transform,x,D,f,y,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=a.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const f=i.padding;i.padding={top:f,bottom:f,right:f,left:f}}return i.padding=a.extend(c,i.padding),i}_minimumAABBFrustumDistance(i,c){const f=c.max[0]-c.min[0],y=c.max[1]-c.min[1];return f/y>i.aspect?f/(2*Math.tan(.5*i.fovX)*i.aspect):y/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,f,y,x,D){const P=i.clone(),F=this._extendCameraOptions(D);P.bearing=y,P.pitch=x;const W=a.LngLat.convert(c),Z=a.LngLat.convert(f),ie=.5*(W.lat+Z.lat),ve=.5*(W.lng+Z.lng),Pe=a.latLngToECEF(ie,ve),Oe=a.normalize([],Pe),Be=a.normalize([],a.cross([],Oe,[0,1,0])),Te=a.cross([],Be,Oe),Ae=[Be[0],Be[1],Be[2],0,Te[0],Te[1],Te[2],0,Oe[0],Oe[1],Oe[2],0,0,0,0,1],je=[Pe,a.latLngToECEF(W.lat,W.lng),a.latLngToECEF(Z.lat,W.lng),a.latLngToECEF(Z.lat,Z.lng),a.latLngToECEF(W.lat,Z.lng),a.latLngToECEF(ie,W.lng),a.latLngToECEF(ie,Z.lng),a.latLngToECEF(W.lat,ve),a.latLngToECEF(Z.lat,ve)];let ze=a.Aabb.fromPoints(je.map(qt=>[a.dot(Be,qt),a.dot(Te,qt),a.dot(Oe,qt)]));const st=a.transformMat4([],ze.center,Ae);0===a.squaredLength(st)&&a.set(st,0,0,1),a.normalize(st,st),a.scale$2(st,st,a.GLOBE_RADIUS),P.center=a.ecefToLatLng(st);const Dt=P.getWorldToCameraMatrix(),vt=a.invert(new Float64Array(16),Dt);ze=a.Aabb.applyTransform(ze,a.multiply([],Dt,Ae)),a.transformMat4(st,st,Dt);const Ut=.5*(ze.max[2]-ze.min[2]),ln=this._minimumAABBFrustumDistance(P,ze),rn=a.scale$2([],[0,0,1],Ut),$t=a.add(rn,st,rn),qn=ln+(0===P.pitch?0:a.distance(st,$t)),Kt=P.globeCenterInViewSpace,Pn=a.sub([],st,[Kt[0],Kt[1],Kt[2]]);a.normalize(Pn,Pn),a.scale$2(Pn,Pn,qn);const mn=a.add([],st,Pn);a.transformMat4(mn,mn,vt);const Wn=a.earthRadius/a.GLOBE_RADIUS,pn=a.length(mn),Un=a.mercatorZfromAltitude(pn*Wn-a.earthRadius,0),Qn=Math.min(P.zoomFromMercatorZAdjusted(Un),F.maxZoom);return Qn>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"mercator"}),P.zoom=Qn,this._cameraForBounds(P,c,f,y,x,D)):{center:P.center,zoom:Qn,bearing:y,pitch:x}}queryTerrainElevation(i,c){const f=this.transform.elevation;return f?(c=a.extend({},{exaggerated:!0},c),f.getAtPoint(a.MercatorCoordinate.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,f,y,x,D){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,c,f,y,x,D);const P=i.clone(),F=this._extendCameraOptions(D),W=P.padding;P.bearing=y,P.pitch=x;const Z=a.LngLat.convert(c),ie=a.LngLat.convert(f),ve=new a.LngLat(Z.lng,ie.lat),Pe=new a.LngLat(ie.lng,Z.lat),Oe=P.project(Z),Be=P.project(ie),Te=this.queryTerrainElevation(Z),Ae=this.queryTerrainElevation(ie),je=this.queryTerrainElevation(ve),ze=this.queryTerrainElevation(Pe),st=[[Oe.x,Oe.y,Math.min(Te||0,Ae||0,je||0,ze||0)],[Be.x,Be.y,Math.max(Te||0,Ae||0,je||0,ze||0)]];let Dt=a.Aabb.fromPoints(st);const vt=P.getWorldToCameraMatrix(),Ut=a.invert(new Float64Array(16),vt);Dt=a.Aabb.applyTransform(Dt,vt);const ln=a.sub([],Dt.max,Dt.min),rn=W.left||0,$t=W.right||0,qn=W.bottom||0,Kt=W.top||0,{left:Pn,right:mn,top:Wn,bottom:pn}=F.padding,Un=.5*(rn+$t),Qn=.5*(Kt+qn),qt=Math.min(P.scaleZoom(P.scale*Math.min((P.width-(rn+$t+Pn+mn))/ln[0],(P.height-(qn+Kt+pn+Wn))/ln[1])),F.maxZoom),dn=P.scale/P.zoomScale(qt);Dt=new a.Aabb([Dt.min[0]-(Pn+Un)*dn,Dt.min[1]-(pn+Qn)*dn,Dt.min[2]],[Dt.max[0]+(mn+Un)*dn,Dt.max[1]+(Wn+Qn)*dn,Dt.max[2]]);const Ei=.5*ln[2],ki=this._minimumAABBFrustumDistance(P,Dt),Ci=[0,0,1,0];a.transformMat4$1(Ci,Ci,vt),a.normalize$2(Ci,Ci);const ji=a.scale$2([],Ci,ki+Ei),or=a.add([],Dt.center,ji),Pi=("number"==typeof F.offset.x&&"number"==typeof F.offset.y?new a.pointGeometry(F.offset.x,F.offset.y):a.pointGeometry.convert(F.offset)).rotate(-a.degToRad(y));Dt.center[0]-=Pi.x*dn,Dt.center[1]+=Pi.y*dn,a.transformMat4(Dt.center,Dt.center,Ut),a.transformMat4(or,or,Ut);const gi=[Dt.center[0],Dt.center[1],or[2]*P.pixelsPerMeter];a.scale$2(gi,gi,1/P.worldSize);const jr=a.lngFromMercatorX(gi[0]),Pr=a.latFromMercatorY(gi[1]),so=Math.min(P._zoomFromMercatorZ(gi[2]),F.maxZoom),Hr=new a.LngLat(jr,Pr);return P.mercatorFromTransition&&so<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(P.setProjection({name:"globe"}),P.zoom=so,this._cameraForBounds(P,c,f,y,x,D)):{center:Hr,zoom:so,bearing:y,pitch:x}}fitBounds(i,c,f){const y=this.cameraForBounds(i,c);return this._fitInternal(y,c,f)}fitScreenCoordinates(i,c,f,y,x){const D=a.pointGeometry.convert(i),P=a.pointGeometry.convert(c),F=new a.pointGeometry(Math.min(D.x,P.x),Math.min(D.y,P.y)),W=new a.pointGeometry(Math.max(D.x,P.x),Math.max(D.y,P.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(D,P))return this;const Z=this.transform.pointLocation3D(F),ie=this.transform.pointLocation3D(W),ve=this.transform.pointLocation3D(new a.pointGeometry(F.x,W.y)),Pe=this.transform.pointLocation3D(new a.pointGeometry(W.x,F.y)),Oe=[Math.min(Z.lng,ie.lng,ve.lng,Pe.lng),Math.min(Z.lat,ie.lat,ve.lat,Pe.lat)],Be=[Math.max(Z.lng,ie.lng,ve.lng,Pe.lng),Math.max(Z.lat,ie.lat,ve.lat,Pe.lat)],Te=y&&y.pitch?y.pitch:this.getPitch(),Ae=this._cameraForBounds(this.transform,Oe,Be,f,Te,y);return this._fitInternal(Ae,y,x)}_fitInternal(i,c,f){return i?(delete(c=a.extend(i,c)).padding,c.linear?this.easeTo(c,f):this.flyTo(c,f)):this}jumpTo(i,c){this.stop();const f=i.preloadOnly?this.transform.clone():this.transform;let y=!1,x=!1,D=!1;return"zoom"in i&&f.zoom!==+i.zoom&&(y=!0,f.zoom=+i.zoom),void 0!==i.center&&(f.center=a.LngLat.convert(i.center)),"bearing"in i&&f.bearing!==+i.bearing&&(x=!0,f.bearing=+i.bearing),"pitch"in i&&f.pitch!==+i.pitch&&(D=!0,f.pitch=+i.pitch),null==i.padding||f.isPaddingEqual(i.padding)||(f.padding=i.padding),i.preloadOnly?(this._preloadTiles(f),this):(this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),y&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),x&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),D&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Fa),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const f=this.transform;if(!f.projection.supportsFreeCamera)return a.warnOnce(Fa),this;this.stop();const y=f.zoom,x=f.pitch,D=f.bearing;f.setFreeCameraOptions(i);const P=y!==f.zoom,F=x!==f.pitch,W=D!==f.bearing;return this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),P&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),W&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),F&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),(!1===(i=a.extend({offset:[0,0],duration:500,easing:a.ease},i)).animate||!i.essential&&a.exported.prefersReducedMotion)&&(i.duration=0);const f=this.transform,y=this.getZoom(),x=this.getBearing(),D=this.getPitch(),P=this.getPadding(),F="zoom"in i?+i.zoom:y,W="bearing"in i?this._normalizeBearing(i.bearing,x):x,Z="pitch"in i?+i.pitch:D,ie="padding"in i?i.padding:f.padding,ve=a.pointGeometry.convert(i.offset);let Pe,Oe,Be;if("globe"===f.projection.name){const rn=a.MercatorCoordinate.fromLngLat(f.center),$t=ve.rotate(-f.angle);rn.x+=$t.x/f.worldSize,rn.y+=$t.y/f.worldSize;const qn=rn.toLngLat(),Kt=a.LngLat.convert(i.center||qn);this._normalizeCenter(Kt),Pe=f.centerPoint.add($t),Oe=new a.pointGeometry(rn.x,rn.y).mult(f.worldSize),Be=new a.pointGeometry(a.mercatorXfromLng(Kt.lng),a.mercatorYfromLat(Kt.lat)).mult(f.worldSize).sub(Oe)}else{Pe=f.centerPoint.add(ve);const rn=f.pointLocation(Pe),$t=a.LngLat.convert(i.center||rn);this._normalizeCenter($t),Oe=f.project(rn),Be=f.project($t).sub(Oe)}const Te=f.zoomScale(F-y);let Ae,je;i.around&&(Ae=a.LngLat.convert(i.around),je=f.locationPoint(Ae));const ze=this._zooming||F!==y,st=this._rotating||x!==W,Dt=this._pitching||Z!==D,vt=!f.isPaddingEqual(ie),Ut=rn=>$t=>{if(ze&&(rn.zoom=a.number(y,F,$t)),st&&(rn.bearing=a.number(x,W,$t)),Dt&&(rn.pitch=a.number(D,Z,$t)),vt&&(rn.interpolatePadding(P,ie,$t),Pe=rn.centerPoint.add(ve)),Ae)rn.setLocationAtPoint(Ae,je);else{const qn=rn.zoomScale(rn.zoom-y),Kt=F>y?Math.min(2,Te):Math.max(.5,Te),Pn=Math.pow(Kt,1-$t),mn=rn.unproject(Oe.add(Be.mult($t*Pn)).mult(qn));rn.setLocationAtPoint(rn.renderWorldCopies?mn.wrap():mn,Pe)}return i.preloadOnly||this._fireMoveEvents(c),rn};if(i.preloadOnly){const rn=this._emulate(Ut,i.duration,f);return this._preloadTiles(rn),this}const ln={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ze,this._rotating=st,this._pitching=Dt,this._padding=vt,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,ln),this._ease(Ut(f),rn=>{f.recenterOnTerrain(),this._afterEase(c,rn)},i),this}_prepareEase(i,c,f={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||f.moving||this.fire(new a.Event("movestart",i)),this._zooming&&!f.zooming&&this.fire(new a.Event("zoomstart",i)),this._rotating&&!f.rotating&&this.fire(new a.Event("rotatestart",i)),this._pitching&&!f.pitching&&this.fire(new a.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new a.Event("move",i)),this._zooming&&this.fire(new a.Event("zoom",i)),this._rotating&&this.fire(new a.Event("rotate",i)),this._pitching&&this.fire(new a.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const f=this._zooming,y=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new a.Event("zoomend",i)),y&&this.fire(new a.Event("rotateend",i)),x&&this.fire(new a.Event("pitchend",i)),this.fire(new a.Event("moveend",i))}flyTo(i,c){if(!i.essential&&a.exported.prefersReducedMotion){const qt=a.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(qt,c)}this.stop(),i=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},i);const f=this.transform,y=this.getZoom(),x=this.getBearing(),D=this.getPitch(),P=this.getPadding(),F="zoom"in i?a.clamp(+i.zoom,f.minZoom,f.maxZoom):y,W="bearing"in i?this._normalizeBearing(i.bearing,x):x,Z="pitch"in i?+i.pitch:D,ie="padding"in i?i.padding:f.padding,ve=f.zoomScale(F-y),Pe=a.pointGeometry.convert(i.offset);let Oe=f.centerPoint.add(Pe);const Be=f.pointLocation(Oe),Te=a.LngLat.convert(i.center||Be);this._normalizeCenter(Te);const Ae=f.project(Be),je=f.project(Te).sub(Ae);let ze=i.curve;const st=Math.max(f.width,f.height),Dt=st/ve,vt=je.mag();if("minZoom"in i){const qt=a.clamp(Math.min(i.minZoom,y,F),f.minZoom,f.maxZoom),dn=st/f.zoomScale(qt-y);ze=Math.sqrt(dn/vt*2)}const Ut=ze*ze;function ln(qt){const dn=(Dt*Dt-st*st+(qt?-1:1)*Ut*Ut*vt*vt)/(2*(qt?Dt:st)*Ut*vt);return Math.log(Math.sqrt(dn*dn+1)-dn)}function rn(qt){return(Math.exp(qt)-Math.exp(-qt))/2}function $t(qt){return(Math.exp(qt)+Math.exp(-qt))/2}const qn=ln(0);let Kt=function(qt){return $t(qn)/$t(qn+ze*qt)},Pn=function(qt){return st*(($t(qn)*(rn(dn=qn+ze*qt)/$t(dn))-rn(qn))/Ut)/vt;var dn},mn=(ln(1)-qn)/ze;if(Math.abs(vt)<1e-6||!isFinite(mn)){if(Math.abs(st-Dt)<1e-6)return this.easeTo(i,c);const qt=Dt<st?-1:1;mn=Math.abs(Math.log(Dt/st))/ze,Pn=function(){return 0},Kt=function(dn){return Math.exp(qt*ze*dn)}}i.duration="duration"in i?+i.duration:1e3*mn/("screenSpeed"in i?+i.screenSpeed/ze:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Wn=x!==W,pn=Z!==D,Un=!f.isPaddingEqual(ie),Qn=qt=>dn=>{const Ei=dn*mn,ki=1/Kt(Ei);qt.zoom=1===dn?F:y+qt.scaleZoom(ki),Wn&&(qt.bearing=a.number(x,W,dn)),pn&&(qt.pitch=a.number(D,Z,dn)),Un&&(qt.interpolatePadding(P,ie,dn),Oe=qt.centerPoint.add(Pe));const Ci=1===dn?Te:qt.unproject(Ae.add(je.mult(Pn(Ei))).mult(ki));return qt.setLocationAtPoint(qt.renderWorldCopies?Ci.wrap():Ci,Oe),qt._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),qt};if(i.preloadOnly){const qt=this._emulate(Qn,i.duration,f);return this._preloadTiles(qt),this}return this._zooming=!0,this._rotating=Wn,this._pitching=pn,this._padding=Un,this._prepareEase(c,!1),this._ease(Qn(f),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const f=this._onEaseEnd;this._onEaseEnd=void 0,f.call(this,c)}if(!i){const f=this.handlers;f&&f.stop(!1)}return this}_ease(i,c,f){!1===f.animate||0===f.duration?(i(1),c()):(this._easeStart=a.exported.now(),this._easeOptions=f,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=a.wrap(i,-180,180);const f=Math.abs(i-c);return Math.abs(i-360-c)<f&&(i-=360),Math.abs(i+360-c)<f&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const f=i.lng-c.center.lng;i.lng+=f>180?-360:f<-180?360:0}_emulate(i,c,f){const y=Math.ceil(15*c/1e3),x=[],D=i(f.clone());for(let P=0;P<=y;P++){const F=D(P/y);x.push(F.clone())}return x}}class ic{constructor(i={}){this.options=i,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=ke("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ke("button","mapboxgl-ctrl-attrib-button",this._container),ke("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ke("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const f=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",f),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",f)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(i){const f=c.reduce((y,x,D)=>(x.value&&(y+=`${x.key}=${x.value}${D<c.length-1?"&":""}`),y),"?");i.href=`${a.config.FEEDBACK_URL}/${f}#${ir(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._sourceCaches;for(const y in c){const x=c[y];if(x.used){const D=x.getSource();D.attribution&&i.indexOf(D.attribution)<0&&i.push(D.attribution)}}i.sort((y,x)=>y.length-x.length),i=i.filter((y,x)=>{for(let D=x+1;D<i.length;D++)if(i[D].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const f=i.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,i.length?(this._innerContainer.innerHTML=f,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class wl{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=ke("div","mapboxgl-ctrl");const c=ke("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const c in i){const f=i[c].getSource();if(f.hasOwnProperty("mapbox_logo")&&!f.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class jc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,f=c?this._queue.concat(c):this._queue;for(const y of f)if(y.id===i)return void(y.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const f of c)if(!f.cancelled&&(f.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ru(d,i,c){if(d=new a.LngLat(d.lng,d.lat),i){const f=new a.LngLat(d.lng-360,d.lat),y=new a.LngLat(d.lng+360,d.lat),x=360*Math.ceil(Math.abs(d.lng-c.center.lng)/360),D=c.locationPoint(d).distSqr(i),P=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(f).distSqr(i)<D&&(P||Math.abs(f.lng-c.center.lng)<x)?d=f:c.locationPoint(y).distSqr(i)<D&&(P||Math.abs(y.lng-c.center.lng)<x)&&(d=y)}for(;Math.abs(d.lng-c.center.lng)>180;){const f=c.locationPoint(d);if(f.x>=0&&f.y>=0&&f.x<=c.width&&f.y<=c.height)break;d.lng>c.center.lng?d.lng-=360:d.lng+=360}return d}const O={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class k extends a.Evented{constructor(i,c){if(super(),(i instanceof a.window.HTMLElement||c)&&(i=a.extend({element:i},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=a.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=ke("div");const y=41,x=27,D=rt("svg",{display:"block",height:y*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${y}`},this._element),P=rt("radialGradient",{id:"shadowGradient"},rt("defs",{},D));rt("stop",{offset:"10%","stop-opacity":.4},P),rt("stop",{offset:"100%","stop-opacity":.05},P),rt("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),rt("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),rt("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),rt("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=a.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const f=this._element.classList;for(const y in O)f.remove(`mapboxgl-marker-anchor-${y}`);f.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=a.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,f=i.charCode||i.keyCode;"Space"!==c&&"Enter"!==c&&32!==f&&13!==f||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const f=i.unproject(c),y=i.getFreeCameraOptions();if(!y.position)return!1;const x=y.position.toLngLat();return x.distanceTo(f)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const f=i.unproject(c);let y;i._showingGlobe()&&a.isLngLatBehindGlobe(i.transform,this._lngLat)?y=0:(y=1-i._queryFogOpacity(f),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${O[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const i=this._pos,c=this._map,f=this.getPitchAlignment();if(!c||!i||"map"!==f)return"";if(!c._showingGlobe()){const F=c.getPitch();return F?`rotateX(${F}deg)`:""}const y=a.radToDeg(a.globeTiltAtLngLat(c.transform,this._lngLat)),x=i.sub(a.globeCenterToScreenPoint(c.transform)),D=Math.abs(x.x)+Math.abs(x.y);if(0===D)return"";const P=y/D;return`rotateX(${-x.y*P}deg) rotateY(${x.x*P}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let f=0;const y=this.getRotationAlignment();if("map"===y)if(c._showingGlobe()){const x=c.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=c.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);f=a.radToDeg(Math.atan2(D.y,D.x))-90}else f=-c.getBearing();else if("horizon"===y){const x=a.smoothstep(4,6,c.getZoom()),D=a.globeCenterToScreenPoint(c.transform);D.y+=x*c.transform.height;const P=i.sub(D),F=a.radToDeg(Math.atan2(P.y,P.x));f=(F>90?F-270:F+90)*(1-x)}return f+=this._rotation,f?`rotateZ(${f}deg)`:""}_update(i){a.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Ru(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===i?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=a.pointGeometry.convert(i),this._update(),this}_onMove(i){const c=this._map;if(!c)return;const f=this._pointerdownPos,y=this._positionDelta;if(f&&y){if(!this._isDragging){const x=this._clickTolerance||c._clickTolerance;if(i.point.dist(f)<x)return;this._isDragging=!0}this._pos=i.point.sub(y),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,f=this._pos;c&&f&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(f),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const I={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},V=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Y(d=new a.pointGeometry(0,0),i="bottom"){if("number"==typeof d){const c=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(i){case"top":return new a.pointGeometry(0,d);case"top-left":return new a.pointGeometry(c,c);case"top-right":return new a.pointGeometry(-c,c);case"bottom":return new a.pointGeometry(0,-d);case"bottom-left":return new a.pointGeometry(c,-c);case"bottom-right":return new a.pointGeometry(-c,-c);case"left":return new a.pointGeometry(d,0);case"right":return new a.pointGeometry(-d,0)}return new a.pointGeometry(0,0)}return d instanceof a.pointGeometry||Array.isArray(d)?a.pointGeometry.convert(d):a.pointGeometry.convert(d[i]||[0,0])}class me{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=a.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,f){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+f}}const et={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},bt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Sn={showCompass:!0,showZoom:!0,visualizePitch:!1};class fi{constructor(i,c,f=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new us({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,f&&(this.mousePitch=new Gs({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),wt()}move(i,c){const f=this.map,y=this.mouseRotate.mousemoveWindow(i,c),x=y&&y.bearingDelta;if(x&&f.setBearing(f.getBearing()+x),this.mousePitch){const D=this.mousePitch.mousemoveWindow(i,c),P=D&&D.pitchDelta;P&&f.setPitch(f.getPitch()+P)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){tt(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(a.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),Qe(this.element,i)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,Qe(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=Hn(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=Hn(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const rr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Si={maxWidth:100,unit:"metric"};function Vr(d,i,c){const f=ws(i),y=f/i,x={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[c];this._map._requestDomTask(()=>{this._container.style.width=d*y+"px",this._container.innerHTML=`${f}&nbsp;${x}`})}function ws(d){const i=Math.pow(10,`${Math.floor(d)}`.length-1);let c=d/i;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(f){const y=Math.pow(10,Math.ceil(-Math.log(f)/Math.LN10));return Math.round(f*y)/y}(c),i*c}const ta={version:a.version,supported:ut,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends su{constructor(d){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),null!=(d=a.extend({},bt,d)).minZoom&&null!=d.maxZoom&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=d.minPitch&&null!=d.maxPitch&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=d.minPitch&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=d.maxPitch&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(d.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Xi(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._language=this._parseLanguage(d.language),this._worldview=d.worldview,this._renderTaskQueue=new jc,this._domRenderTaskQueue=new jc,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},et,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._performanceMetricsCollection=d.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new me(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,"string"==typeof d.container){if(this._container=a.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new hs(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new In("string"==typeof d.hash&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,a.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new ic({customAttribution:d.customAttribution})),this._logoControl=new wl,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new a.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new a.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(d,i){if(void 0===i&&(i=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=d.onAdd(this);this._controls.push(d);const f=this._controlPositions[i];return-1!==i.indexOf("bottom")?f.insertBefore(c,f.firstChild):f.appendChild(c),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(d);return i>-1&&this._controls.splice(i,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new a.Event("movestart",d)).fire(new a.Event("move",d)),this.fire(new a.Event("resize",d)),i&&this.fire(new a.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(a.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(d){return"auto"===d?a.window.navigator.language:Array.isArray(d)?0===d.length?void 0:d.map(i=>"auto"===i?a.window.navigator.language:i):d}setLanguage(d){const i=this._parseLanguage(d);if(!this.style||i===this._language)return this;this._language=i,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(d){return this.style&&d!==this._worldview?(this._worldview=d,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(d){return this._lazyInitEmptyStyle(),d?"string"==typeof d&&(d={name:d}):d=null,this._useExplicitProjection=!!d,this._prioritizeAndUpdateProjection(d,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const d=this.transform,i=d.projection.name;let c;"globe"===i&&d.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(d.setMercatorFromTransition(),c=!0):"mercator"===i&&d.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(d.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(d,i){return this._updateProjection(d||i||{name:"mercator"})}_updateProjection(d){let i;if(i="globe"===d.name&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(d),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(d){return this.transform.locationPoint3D(a.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(a.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(d,i,c){if("mouseenter"===d||"mouseover"===d){let f=!1;const y=D=>{const P=i.filter(W=>this.getLayer(W)),F=P.length?this.queryRenderedFeatures(D.point,{layers:P}):[];F.length?f||(f=!0,c.call(this,new xo(d,this,D.originalEvent,{features:F}))):f=!1},x=()=>{f=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:x}}}if("mouseleave"===d||"mouseout"===d){let f=!1;const y=D=>{const P=i.filter(F=>this.getLayer(F));(P.length?this.queryRenderedFeatures(D.point,{layers:P}):[]).length?f=!0:f&&(f=!1,c.call(this,new xo(d,this,D.originalEvent)))},x=D=>{f&&(f=!1,c.call(this,new xo(d,this,D.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:y,mouseout:x}}}{const f=y=>{const x=i.filter(P=>this.getLayer(P)),D=x.length?this.queryRenderedFeatures(y.point,{layers:x}):[];D.length&&(y.features=D,c.call(this,y),delete y.features)};return{layers:new Set(i),listener:c,delegates:{[d]:f}}}}on(d,i,c){if(void 0===c)return super.on(d,i);Array.isArray(i)||(i=[i]);const f=this._createDelegatedListener(d,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(f);for(const y in f.delegates)this.on(y,f.delegates[y]);return this}once(d,i,c){if(void 0===c)return super.once(d,i);Array.isArray(i)||(i=[i]);const f=this._createDelegatedListener(d,i,c);for(const y in f.delegates)this.once(y,f.delegates[y]);return this}off(d,i,c){if(void 0===c)return super.off(d,i);i=new Set(Array.isArray(i)?i:[i]);const f=(x,D)=>{if(x.size!==D.size)return!1;for(const P of x)if(!D.has(P))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[d]:void 0;return y&&(x=>{for(let D=0;D<x.length;D++){const P=x[D];if(P.listener===c&&f(P.layers,i)){for(const F in P.delegates)this.off(F,P.delegates[F]);return x.splice(D,1),this}}})(y),this}queryRenderedFeatures(d,i){return this.style?(void 0!==i||void 0===d||d instanceof a.pointGeometry||Array.isArray(d)||(i=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(d,i){return this.style.querySourceFeatures(d,i)}setStyle(d,i){return!1!==(i=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(d,i))}_getUIString(d){const i=this._locale[d];if(null==i)throw new Error(`Missing UI string '${d}'`);return i}_updateStyle(d,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new Wr(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof d?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Wr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,i){if("string"==typeof d){const c=this._requestManager.normalizeStyleURL(d),f=this._requestManager.transformRequest(c,a.ResourceType.Style);a.getJSON(f,(y,x)=>{y?this.fire(new a.ErrorEvent(y)):x&&this._updateDiff(x,i)})}else"object"==typeof d&&this._updateDiff(d,i)}_updateDiff(d,i){try{this.style.setState(d)&&this._update(!0)}catch(c){a.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(d,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(d,i){return this._lazyInitEmptyStyle(),this.style.addSource(d,i),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const i in d){const c=d[i]._tiles;for(const f in c){const y=c[f];if("loaded"!==y.state&&"errored"!==y.state)return!1}}return!0}addSourceType(d,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(d,i,c)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,i,{pixelRatio:c=1,sdf:f=!1,stretchX:y,stretchY:x,content:D}={}){if(this._lazyInitEmptyStyle(),i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap){const{width:P,height:F,data:W}=a.exported.getImageData(i);this.style.addImage(d,{data:new a.RGBAImage({width:P,height:F},W),pixelRatio:c,stretchX:y,stretchY:x,content:D,sdf:f,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:F}=i,W=i;this.style.addImage(d,{data:new a.RGBAImage({width:P,height:F},new Uint8Array(W.data)),pixelRatio:c,stretchX:y,stretchY:x,content:D,sdf:f,version:0,userImage:W}),W.onAdd&&W.onAdd(this,d)}}updateImage(d,i){const c=this.style.getImage(d);if(!c)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap?a.exported.getImageData(i):i,{width:y,height:x}=f;void 0!==y&&void 0!==x?y===c.data.width&&x===c.data.height?(c.data.replace(f.data,!(i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap)),this.style.updateImage(d,c)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${x})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,i){a.getImage(this._requestManager.transformRequest(d,a.ResourceType.Image),(c,f)=>{i(c,f instanceof a.window.HTMLImageElement?a.exported.getImageData(f):f)})}listImages(){return this.style.listImages()}addLayer(d,i){return this._lazyInitEmptyStyle(),this.style.addLayer(d,i),this._update(!0)}moveLayer(d,i){return this.style.moveLayer(d,i),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,i,c){return this.style.setLayerZoomRange(d,i,c),this._update(!0)}setFilter(d,i,c={}){return this.style.setFilter(d,i,c),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,i,c,f={}){return this.style.setPaintProperty(d,i,c,f),this._update(!0)}getPaintProperty(d,i){return this.style.getPaintProperty(d,i)}setLayoutProperty(d,i,c,f={}){return this.style.setLayoutProperty(d,i,c,f),this._update(!0)}getLayoutProperty(d,i){return this.style.getLayoutProperty(d,i)}setLight(d,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(d),this.transform):0}setFeatureState(d,i){return this.style.setFeatureState(d,i),this._update()}removeFeatureState(d,i){return this.style.removeFeatureState(d,i),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,f,y,x=this._container;for(;x&&(!f||!y);){const D=a.window.getComputedStyle(x).transform;D&&"none"!==D&&(c=D.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(f=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(y=c[3])),x=x.parentElement}this._containerWidth=f?Math.abs(d/f):d,this._containerHeight=y?Math.abs(i/y):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=ke("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=ke("div","mapboxgl-canvas-container",d);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=ke("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=ke("div","mapboxgl-control-container",d),f=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{f[y]=ke("div",`mapboxgl-ctrl-${y}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,i){const c=a.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(d),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${i}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const i=this._markers.indexOf(d);-1!==i&&this._markers.splice(i,1)}_addPopup(d){this._popups.push(d)}_removePopup(d){const i=this._popups.indexOf(d);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const d=a.extend({},ut.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);i?(a.storeAuthState(i,!0),this.painter=new X(i,this.transform),this.on("data",c=>{"source"===c.dataType&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(i)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let i;const c=this.painter.context.extTimerQuery,f=a.exported.now();if(this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,F=this.transform.pitch,W=a.exported.now(),Z=new a.EvaluationParameters(P,{now:W,fadeDuration:y,pitch:F,transition:this.style.getTransition()});this.style.update(Z)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(f),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):x=this._updateAverageElevation(f),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const P=a.exported.now()-f;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const F=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new a.Event("gpu-timing-frame",{cpuTime:P,gpuTime:F})),a.window.performance.mark("frame-gpu",{startTime:f,detail:{gpuTime:F}})},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(P);this.fire(new a.Event("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const P=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(P);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:F}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(D||this._repaint)this.triggerRepaint();else{const P=!this.isMoving()&&this.loaded();if(P&&(x=this._updateAverageElevation(f,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),P&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(d){for(const i of this._markers)d&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!d||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(d,i=!1){const c=f=>(this.transform.averageElevation=f,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((i||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const f=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),x=!1;this.transform.elevation&&(x=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=d;const D=Math.abs(f-y);if(D>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(y),c(y);this._averageElevation.easeTo(y,d,300)}else if(D>1e-4)return this._averageElevation.jumpTo(y),c(y)}return!!this._averageElevation.isEasing(d)&&c(this._averageElevation.getValue(d))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===a.AUTH_ERR_MSG||401===d.status)){const i=this.painter.context.gl;a.storeAuthState(i,!1),this._logoControl instanceof wl&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const d=this._isDragging();this.painter.updateTerrain(this.style,d)}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,f=c.createFramebuffer();function y(x){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);const D=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,D),D}return c.bindFramebuffer(c.FRAMEBUFFER,f),this._canvasPixelComparison(y(d),i.canvasCopies.map(y),i.timeStamps)}_canvasPixelComparison(d,i,c){let f=c[1]-c[0];const y=d.length/4;for(let x=0;x<i.length;x++){const D=i[x];let P=0;for(let F=0;F<D.length;F+=4)D[F]===d[F]&&D[F+1]===d[F+1]&&D[F+2]===d[F+2]&&D[F+3]===d[F+3]&&(P+=1);f+=(c[x+2]-c[x+1])*(1-P/y)}return f}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=a.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(d){const i=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(i,(c,f)=>c._preloadTiles(d,f),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}_onVisibilityChange(){"hidden"===a.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(d){this._showTileAABBs!==d&&(this._showTileAABBs=d,d&&this._update())}_setCacheLimits(d,i){a.setCacheLimits(d,i)}get version(){return a.version}},NavigationControl:class{constructor(d){this.options=a.extend({},Sn,d),this._container=ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),ke("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),ke("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))}),this._compassIcon=ke("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const i=d.getZoom(),c=i===d.getMaxZoom(),f=i===d.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fi(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,i){const c=ke("button",d,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(d,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);d.setAttribute("aria-label",c),d.firstElementChild&&d.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends a.Evented{constructor(d){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},rr,d),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Vi(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(d){return this._map=d,this._container=ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(d){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,d(c)};void 0!==this._supportsGeolocation?d(this._supportsGeolocation):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(c=>i("denied"!==c.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(d){const i=this._map.getMaxBounds(),c=d.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(d),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",d)),this._finish()}}_updateCamera(d){const i=new a.LngLat(d.coords.longitude,d.coords.latitude),c=d.coords.accuracy,f=this._map.getBearing(),y=a.extend({bearing:f},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),y,{geolocateSource:!0})}_updateMarker(d){if(d){const i=new a.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map.transform,i=a.mercatorZfromAltitude(1,d._center.lat)*d.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(1===d.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===d.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=ke("button","mapboxgl-ctrl-geolocate",this._container),ke("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===d){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ke("div","mapboxgl-user-location"),this._dotElement.appendChild(ke("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ke("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new k({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ke("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new k({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:!0===d.absolute&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(d={maximumAge:6e5,timeout:0},this._noTimeout=!0):(d=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==a.window.DeviceMotionEvent&&"function"==typeof a.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&d()}).catch(console.error):d()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ic,ScaleControl:class{constructor(d){this.options=a.extend({},Si,d),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Vr.bind(this)),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const d=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,f=i._containerWidth/2-d/2,y=i.unproject([f,c]),x=i.unproject([f+d,c]),D=y.distanceTo(x);if("imperial"===this.options.unit){const P=3.2808*D;P>5280?this._setScale(d,P/5280,"mile"):this._setScale(d,P,"foot")}else"nautical"===this.options.unit?this._setScale(d,D/1852,"nautical-mile"):D>=1e3?this._setScale(d,D/1e3,"kilometer"):this._setScale(d,D,"meter")}_setScale(d,i,c){const f=ws(i),y=f/i;this._map._requestDomTask(()=>{this._container.style.width=d*y+"px",this._container.innerHTML="nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:c}).format(f):`${f}&nbsp;nm`})}onAdd(d){return this._map=d,this._language=d.getLanguage(),this._container=ke("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(d){this._language=d,this._update()}setUnit(d){this.options.unit=d,this._update()}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof a.window.HTMLElement?this._container=d.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=ke("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=ke("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ke("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(d){super(),this.options=a.extend(Object.create(I),d),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),d._addPopup(this),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),d._canvasContainer&&d._canvasContainer.classList.remove("mapboxgl-track-pointer"),d._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=a.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(a.window.document.createTextNode(d))}setHTML(d){const i=a.window.document.createDocumentFragment(),c=a.window.document.createElement("body");let f;for(c.innerHTML=d;f=c.firstChild,f;)i.appendChild(f);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=ke("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(d),this.options.closeButton){const c=this._closeButton=ke("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let i;return this._classList.delete(d)?i=!1:(this._classList.add(d),i=!0),this._updateClassList(),i}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,f=this._pos;if(!i||!c||!f)return"bottom";const y=c.offsetWidth,x=c.offsetHeight,D=f.x<y/2,P=f.x>i.transform.width-y/2;if(f.y+d<x)return D?"top-left":P?"top-right":"top";if(f.y>i.transform.height-x){if(D)return"bottom-left";if(P)return"bottom-right"}return D?"left":P?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),d.className=i.join(" ")}_update(d){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let f=this._container;if(f||(f=this._container=ke("div","mapboxgl-popup",i.getContainer()),this._tip=ke("div","mapboxgl-popup-tip",f),f.appendChild(c)),this.options.maxWidth&&f.style.maxWidth!==this.options.maxWidth&&(f.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ru(this._lngLat,this._pos,i.transform)),!this._trackPointer||d){const y=this._pos=this._trackPointer&&d?d:i.project(this._lngLat),x=Y(this.options.offset),D=this._anchor=this._getAnchor(x.y),P=Y(this.options.offset,D),F=y.add(P).round();i._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${O[D]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&i._showingGlobe()){const y=a.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(V);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._container&&(this._container.style.opacity=`${d}`),this._content&&(this._content.style.pointerEvents=d?"auto":"none")}},Marker:k,Style:Wr,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Re,Evented:a.Evented,config:a.config,prewarm:function(){Xn().acquire(Zt)},clearPrewarmedResources:function(){const d=jn;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(Zt),jn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(d){a.config.ACCESS_TOKEN=d},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(d){a.config.API_URL=d},get workerCount(){return Tn.workerCount},set workerCount(d){Tn.workerCount=d},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){a.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){a.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return ta}),w}()},1135:(ti,Vt,B)=>{"use strict";B.d(Vt,{X:()=>_});var w=B(7579);class _ extends w.x{constructor(a){super(),this._value=a}get value(){return this.getValue()}_subscribe(a){const de=super._subscribe(a);return!de.closed&&a.next(this._value),de}getValue(){const{hasError:a,thrownError:de,_value:ut}=this;if(a)throw de;return this._throwIfClosed(),ut}next(a){super.next(this._value=a)}}},9751:(ti,Vt,B)=>{"use strict";B.d(Vt,{y:()=>Le});var w=B(930),_=B(727),pe=B(8822),a=B(9635),de=B(2416),ut=B(576),it=B(2806);let Le=(()=>{class Et{constructor(wt){wt&&(this._subscribe=wt)}lift(wt){const tt=new Et;return tt.source=this,tt.operator=wt,tt}subscribe(wt,tt,Wt){const kt=function ft(Et){return Et&&Et instanceof w.Lv||function rt(Et){return Et&&(0,ut.m)(Et.next)&&(0,ut.m)(Et.error)&&(0,ut.m)(Et.complete)}(Et)&&(0,_.Nn)(Et)}(wt)?wt:new w.Hp(wt,tt,Wt);return(0,it.x)(()=>{const{operator:Qe,source:Hn}=this;kt.add(Qe?Qe.call(kt,Hn):Hn?this._subscribe(kt):this._trySubscribe(kt))}),kt}_trySubscribe(wt){try{return this._subscribe(wt)}catch(tt){wt.error(tt)}}forEach(wt,tt){return new(tt=ke(tt))((Wt,kt)=>{const Qe=new w.Hp({next:Hn=>{try{wt(Hn)}catch(Ln){kt(Ln),Qe.unsubscribe()}},error:kt,complete:Wt});this.subscribe(Qe)})}_subscribe(wt){var tt;return null===(tt=this.source)||void 0===tt?void 0:tt.subscribe(wt)}[pe.L](){return this}pipe(...wt){return(0,a.U)(wt)(this)}toPromise(wt){return new(wt=ke(wt))((tt,Wt)=>{let kt;this.subscribe(Qe=>kt=Qe,Qe=>Wt(Qe),()=>tt(kt))})}}return Et.create=dt=>new Et(dt),Et})();function ke(Et){var dt;return null!==(dt=Et??de.v.Promise)&&void 0!==dt?dt:Promise}},7579:(ti,Vt,B)=>{"use strict";B.d(Vt,{x:()=>it});var w=B(9751),_=B(727);const a=(0,B(3888).d)(ke=>function(){ke(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var de=B(8737),ut=B(2806);let it=(()=>{class ke extends w.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(ft){const Et=new Le(this,this);return Et.operator=ft,Et}_throwIfClosed(){if(this.closed)throw new a}next(ft){(0,ut.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Et of this.currentObservers)Et.next(ft)}})}error(ft){(0,ut.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=ft;const{observers:Et}=this;for(;Et.length;)Et.shift().error(ft)}})}complete(){(0,ut.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:ft}=this;for(;ft.length;)ft.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var ft;return(null===(ft=this.observers)||void 0===ft?void 0:ft.length)>0}_trySubscribe(ft){return this._throwIfClosed(),super._trySubscribe(ft)}_subscribe(ft){return this._throwIfClosed(),this._checkFinalizedStatuses(ft),this._innerSubscribe(ft)}_innerSubscribe(ft){const{hasError:Et,isStopped:dt,observers:wt}=this;return Et||dt?_.Lc:(this.currentObservers=null,wt.push(ft),new _.w0(()=>{this.currentObservers=null,(0,de.P)(wt,ft)}))}_checkFinalizedStatuses(ft){const{hasError:Et,thrownError:dt,isStopped:wt}=this;Et?ft.error(dt):wt&&ft.complete()}asObservable(){const ft=new w.y;return ft.source=this,ft}}return ke.create=(rt,ft)=>new Le(rt,ft),ke})();class Le extends it{constructor(rt,ft){super(),this.destination=rt,this.source=ft}next(rt){var ft,Et;null===(Et=null===(ft=this.destination)||void 0===ft?void 0:ft.next)||void 0===Et||Et.call(ft,rt)}error(rt){var ft,Et;null===(Et=null===(ft=this.destination)||void 0===ft?void 0:ft.error)||void 0===Et||Et.call(ft,rt)}complete(){var rt,ft;null===(ft=null===(rt=this.destination)||void 0===rt?void 0:rt.complete)||void 0===ft||ft.call(rt)}_subscribe(rt){var ft,Et;return null!==(Et=null===(ft=this.source)||void 0===ft?void 0:ft.subscribe(rt))&&void 0!==Et?Et:_.Lc}}},930:(ti,Vt,B)=>{"use strict";B.d(Vt,{Hp:()=>Wt,Lv:()=>Et});var w=B(576),_=B(727),pe=B(2416),a=B(7849),de=B(5032);const ut=ke("C",void 0,void 0);function ke(Ye,Ce,we){return{kind:Ye,value:Ce,error:we}}var rt=B(3410),ft=B(2806);class Et extends _.w0{constructor(Ce){super(),this.isStopped=!1,Ce?(this.destination=Ce,(0,_.Nn)(Ce)&&Ce.add(this)):this.destination=Ln}static create(Ce,we,At){return new Wt(Ce,we,At)}next(Ce){this.isStopped?Hn(function Le(Ye){return ke("N",Ye,void 0)}(Ce),this):this._next(Ce)}error(Ce){this.isStopped?Hn(function it(Ye){return ke("E",void 0,Ye)}(Ce),this):(this.isStopped=!0,this._error(Ce))}complete(){this.isStopped?Hn(ut,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ce){this.destination.next(Ce)}_error(Ce){try{this.destination.error(Ce)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const dt=Function.prototype.bind;function wt(Ye,Ce){return dt.call(Ye,Ce)}class tt{constructor(Ce){this.partialObserver=Ce}next(Ce){const{partialObserver:we}=this;if(we.next)try{we.next(Ce)}catch(At){kt(At)}}error(Ce){const{partialObserver:we}=this;if(we.error)try{we.error(Ce)}catch(At){kt(At)}else kt(Ce)}complete(){const{partialObserver:Ce}=this;if(Ce.complete)try{Ce.complete()}catch(we){kt(we)}}}class Wt extends Et{constructor(Ce,we,At){let zt;if(super(),(0,w.m)(Ce)||!Ce)zt={next:Ce??void 0,error:we??void 0,complete:At??void 0};else{let Jt;this&&pe.v.useDeprecatedNextContext?(Jt=Object.create(Ce),Jt.unsubscribe=()=>this.unsubscribe(),zt={next:Ce.next&&wt(Ce.next,Jt),error:Ce.error&&wt(Ce.error,Jt),complete:Ce.complete&&wt(Ce.complete,Jt)}):zt=Ce}this.destination=new tt(zt)}}function kt(Ye){pe.v.useDeprecatedSynchronousErrorHandling?(0,ft.O)(Ye):(0,a.h)(Ye)}function Hn(Ye,Ce){const{onStoppedNotification:we}=pe.v;we&&rt.z.setTimeout(()=>we(Ye,Ce))}const Ln={closed:!0,next:de.Z,error:function Qe(Ye){throw Ye},complete:de.Z}},727:(ti,Vt,B)=>{"use strict";B.d(Vt,{Lc:()=>ut,w0:()=>de,Nn:()=>it});var w=B(576);const pe=(0,B(3888).d)(ke=>function(ft){ke(this),this.message=ft?`${ft.length} errors occurred during unsubscription:\n${ft.map((Et,dt)=>`${dt+1}) ${Et.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=ft});var a=B(8737);class de{constructor(rt){this.initialTeardown=rt,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let rt;if(!this.closed){this.closed=!0;const{_parentage:ft}=this;if(ft)if(this._parentage=null,Array.isArray(ft))for(const wt of ft)wt.remove(this);else ft.remove(this);const{initialTeardown:Et}=this;if((0,w.m)(Et))try{Et()}catch(wt){rt=wt instanceof pe?wt.errors:[wt]}const{_finalizers:dt}=this;if(dt){this._finalizers=null;for(const wt of dt)try{Le(wt)}catch(tt){rt=rt??[],tt instanceof pe?rt=[...rt,...tt.errors]:rt.push(tt)}}if(rt)throw new pe(rt)}}add(rt){var ft;if(rt&&rt!==this)if(this.closed)Le(rt);else{if(rt instanceof de){if(rt.closed||rt._hasParent(this))return;rt._addParent(this)}(this._finalizers=null!==(ft=this._finalizers)&&void 0!==ft?ft:[]).push(rt)}}_hasParent(rt){const{_parentage:ft}=this;return ft===rt||Array.isArray(ft)&&ft.includes(rt)}_addParent(rt){const{_parentage:ft}=this;this._parentage=Array.isArray(ft)?(ft.push(rt),ft):ft?[ft,rt]:rt}_removeParent(rt){const{_parentage:ft}=this;ft===rt?this._parentage=null:Array.isArray(ft)&&(0,a.P)(ft,rt)}remove(rt){const{_finalizers:ft}=this;ft&&(0,a.P)(ft,rt),rt instanceof de&&rt._removeParent(this)}}de.EMPTY=(()=>{const ke=new de;return ke.closed=!0,ke})();const ut=de.EMPTY;function it(ke){return ke instanceof de||ke&&"closed"in ke&&(0,w.m)(ke.remove)&&(0,w.m)(ke.add)&&(0,w.m)(ke.unsubscribe)}function Le(ke){(0,w.m)(ke)?ke():ke.unsubscribe()}},2416:(ti,Vt,B)=>{"use strict";B.d(Vt,{v:()=>w});const w={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},9841:(ti,Vt,B)=>{"use strict";B.d(Vt,{a:()=>rt});var w=B(9751),_=B(4742),pe=B(2076),a=B(4671),de=B(3268),ut=B(3269),it=B(1810),Le=B(5403),ke=B(9672);function rt(...dt){const wt=(0,ut.yG)(dt),tt=(0,ut.jO)(dt),{args:Wt,keys:kt}=(0,_.D)(dt);if(0===Wt.length)return(0,pe.D)([],wt);const Qe=new w.y(function ft(dt,wt,tt=a.y){return Wt=>{Et(wt,()=>{const{length:kt}=dt,Qe=new Array(kt);let Hn=kt,Ln=kt;for(let Ye=0;Ye<kt;Ye++)Et(wt,()=>{const Ce=(0,pe.D)(dt[Ye],wt);let we=!1;Ce.subscribe((0,Le.x)(Wt,At=>{Qe[Ye]=At,we||(we=!0,Ln--),Ln||Wt.next(tt(Qe.slice()))},()=>{--Hn||Wt.complete()}))},Wt)},Wt)}}(Wt,wt,kt?Hn=>(0,it.n)(kt,Hn):a.y));return tt?Qe.pipe((0,de.Z)(tt)):Qe}function Et(dt,wt,tt){dt?(0,ke.f)(tt,dt,wt):wt()}},7272:(ti,Vt,B)=>{"use strict";B.d(Vt,{z:()=>de});var w=B(8189),pe=B(3269),a=B(2076);function de(...ut){return function _(){return(0,w.J)(1)}()((0,a.D)(ut,(0,pe.yG)(ut)))}},9770:(ti,Vt,B)=>{"use strict";B.d(Vt,{P:()=>pe});var w=B(9751),_=B(8421);function pe(a){return new w.y(de=>{(0,_.Xf)(a()).subscribe(de)})}},515:(ti,Vt,B)=>{"use strict";B.d(Vt,{E:()=>_});const _=new(B(9751).y)(de=>de.complete())},4128:(ti,Vt,B)=>{"use strict";B.d(Vt,{D:()=>Le});var w=B(9751),_=B(4742),pe=B(8421),a=B(3269),de=B(5403),ut=B(3268),it=B(1810);function Le(...ke){const rt=(0,a.jO)(ke),{args:ft,keys:Et}=(0,_.D)(ke),dt=new w.y(wt=>{const{length:tt}=ft;if(!tt)return void wt.complete();const Wt=new Array(tt);let kt=tt,Qe=tt;for(let Hn=0;Hn<tt;Hn++){let Ln=!1;(0,pe.Xf)(ft[Hn]).subscribe((0,de.x)(wt,Ye=>{Ln||(Ln=!0,Qe--),Wt[Hn]=Ye},()=>kt--,void 0,()=>{(!kt||!Ln)&&(Qe||wt.next(Et?(0,it.n)(Et,Wt):Wt),wt.complete())}))}});return rt?dt.pipe((0,ut.Z)(rt)):dt}},2076:(ti,Vt,B)=>{"use strict";B.d(Vt,{D:()=>At});var w=B(8421),_=B(9672),pe=B(4482),a=B(5403);function de(zt,Jt=0){return(0,pe.e)((Cn,Ke)=>{Cn.subscribe((0,a.x)(Ke,Ne=>(0,_.f)(Ke,zt,()=>Ke.next(Ne),Jt),()=>(0,_.f)(Ke,zt,()=>Ke.complete(),Jt),Ne=>(0,_.f)(Ke,zt,()=>Ke.error(Ne),Jt)))})}function ut(zt,Jt=0){return(0,pe.e)((Cn,Ke)=>{Ke.add(zt.schedule(()=>Cn.subscribe(Ke),Jt))})}var ke=B(9751),ft=B(2202),Et=B(576);function wt(zt,Jt){if(!zt)throw new Error("Iterable cannot be null");return new ke.y(Cn=>{(0,_.f)(Cn,Jt,()=>{const Ke=zt[Symbol.asyncIterator]();(0,_.f)(Cn,Jt,()=>{Ke.next().then(Ne=>{Ne.done?Cn.complete():Cn.next(Ne.value)})},0,!0)})})}var tt=B(3670),Wt=B(8239),kt=B(1144),Qe=B(6495),Hn=B(2206),Ln=B(4532),Ye=B(3260);function At(zt,Jt){return Jt?function we(zt,Jt){if(null!=zt){if((0,tt.c)(zt))return function it(zt,Jt){return(0,w.Xf)(zt).pipe(ut(Jt),de(Jt))}(zt,Jt);if((0,kt.z)(zt))return function rt(zt,Jt){return new ke.y(Cn=>{let Ke=0;return Jt.schedule(function(){Ke===zt.length?Cn.complete():(Cn.next(zt[Ke++]),Cn.closed||this.schedule())})})}(zt,Jt);if((0,Wt.t)(zt))return function Le(zt,Jt){return(0,w.Xf)(zt).pipe(ut(Jt),de(Jt))}(zt,Jt);if((0,Hn.D)(zt))return wt(zt,Jt);if((0,Qe.T)(zt))return function dt(zt,Jt){return new ke.y(Cn=>{let Ke;return(0,_.f)(Cn,Jt,()=>{Ke=zt[ft.h](),(0,_.f)(Cn,Jt,()=>{let Ne,He;try{({value:Ne,done:He}=Ke.next())}catch(_t){return void Cn.error(_t)}He?Cn.complete():Cn.next(Ne)},0,!0)}),()=>(0,Et.m)(Ke?.return)&&Ke.return()})}(zt,Jt);if((0,Ye.L)(zt))return function Ce(zt,Jt){return wt((0,Ye.Q)(zt),Jt)}(zt,Jt)}throw(0,Ln.z)(zt)}(zt,Jt):(0,w.Xf)(zt)}},4968:(ti,Vt,B)=>{"use strict";B.d(Vt,{R:()=>rt});var w=B(8421),_=B(9751),pe=B(5577),a=B(1144),de=B(576),ut=B(3268);const it=["addListener","removeListener"],Le=["addEventListener","removeEventListener"],ke=["on","off"];function rt(tt,Wt,kt,Qe){if((0,de.m)(kt)&&(Qe=kt,kt=void 0),Qe)return rt(tt,Wt,kt).pipe((0,ut.Z)(Qe));const[Hn,Ln]=function wt(tt){return(0,de.m)(tt.addEventListener)&&(0,de.m)(tt.removeEventListener)}(tt)?Le.map(Ye=>Ce=>tt[Ye](Wt,Ce,kt)):function Et(tt){return(0,de.m)(tt.addListener)&&(0,de.m)(tt.removeListener)}(tt)?it.map(ft(tt,Wt)):function dt(tt){return(0,de.m)(tt.on)&&(0,de.m)(tt.off)}(tt)?ke.map(ft(tt,Wt)):[];if(!Hn&&(0,a.z)(tt))return(0,pe.z)(Ye=>rt(Ye,Wt,kt))((0,w.Xf)(tt));if(!Hn)throw new TypeError("Invalid event target");return new _.y(Ye=>{const Ce=(...we)=>Ye.next(1<we.length?we:we[0]);return Hn(Ce),()=>Ln(Ce)})}function ft(tt,Wt){return kt=>Qe=>tt[kt](Wt,Qe)}},8421:(ti,Vt,B)=>{"use strict";B.d(Vt,{Xf:()=>dt});var w=B(655),_=B(1144),pe=B(8239),a=B(9751),de=B(3670),ut=B(2206),it=B(4532),Le=B(6495),ke=B(3260),rt=B(576),ft=B(7849),Et=B(8822);function dt(Ye){if(Ye instanceof a.y)return Ye;if(null!=Ye){if((0,de.c)(Ye))return function wt(Ye){return new a.y(Ce=>{const we=Ye[Et.L]();if((0,rt.m)(we.subscribe))return we.subscribe(Ce);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ye);if((0,_.z)(Ye))return function tt(Ye){return new a.y(Ce=>{for(let we=0;we<Ye.length&&!Ce.closed;we++)Ce.next(Ye[we]);Ce.complete()})}(Ye);if((0,pe.t)(Ye))return function Wt(Ye){return new a.y(Ce=>{Ye.then(we=>{Ce.closed||(Ce.next(we),Ce.complete())},we=>Ce.error(we)).then(null,ft.h)})}(Ye);if((0,ut.D)(Ye))return Qe(Ye);if((0,Le.T)(Ye))return function kt(Ye){return new a.y(Ce=>{for(const we of Ye)if(Ce.next(we),Ce.closed)return;Ce.complete()})}(Ye);if((0,ke.L)(Ye))return function Hn(Ye){return Qe((0,ke.Q)(Ye))}(Ye)}throw(0,it.z)(Ye)}function Qe(Ye){return new a.y(Ce=>{(function Ln(Ye,Ce){var we,At,zt,Jt;return(0,w.mG)(this,void 0,void 0,function*(){try{for(we=(0,w.KL)(Ye);!(At=yield we.next()).done;)if(Ce.next(At.value),Ce.closed)return}catch(Cn){zt={error:Cn}}finally{try{At&&!At.done&&(Jt=we.return)&&(yield Jt.call(we))}finally{if(zt)throw zt.error}}Ce.complete()})})(Ye,Ce).catch(we=>Ce.error(we))})}},6451:(ti,Vt,B)=>{"use strict";B.d(Vt,{T:()=>ut});var w=B(8189),_=B(8421),pe=B(515),a=B(3269),de=B(2076);function ut(...it){const Le=(0,a.yG)(it),ke=(0,a._6)(it,1/0),rt=it;return rt.length?1===rt.length?(0,_.Xf)(rt[0]):(0,w.J)(ke)((0,de.D)(rt,Le)):pe.E}},9646:(ti,Vt,B)=>{"use strict";B.d(Vt,{of:()=>pe});var w=B(3269),_=B(2076);function pe(...a){const de=(0,w.yG)(a);return(0,_.D)(a,de)}},2843:(ti,Vt,B)=>{"use strict";B.d(Vt,{_:()=>pe});var w=B(9751),_=B(576);function pe(a,de){const ut=(0,_.m)(a)?a:()=>a,it=Le=>Le.error(ut());return new w.y(de?Le=>de.schedule(it,0,Le):it)}},5963:(ti,Vt,B)=>{"use strict";B.d(Vt,{H:()=>de});var w=B(9751),_=B(4986),pe=B(3532);function de(ut=0,it,Le=_.P){let ke=-1;return null!=it&&((0,pe.K)(it)?Le=it:ke=it),new w.y(rt=>{let ft=function a(ut){return ut instanceof Date&&!isNaN(ut)}(ut)?+ut-Le.now():ut;ft<0&&(ft=0);let Et=0;return Le.schedule(function(){rt.closed||(rt.next(Et++),0<=ke?this.schedule(void 0,ke):rt.complete())},ft)})}},5403:(ti,Vt,B)=>{"use strict";B.d(Vt,{x:()=>_});var w=B(930);function _(a,de,ut,it,Le){return new pe(a,de,ut,it,Le)}class pe extends w.Lv{constructor(de,ut,it,Le,ke,rt){super(de),this.onFinalize=ke,this.shouldUnsubscribe=rt,this._next=ut?function(ft){try{ut(ft)}catch(Et){de.error(Et)}}:super._next,this._error=Le?function(ft){try{Le(ft)}catch(Et){de.error(Et)}finally{this.unsubscribe()}}:super._error,this._complete=it?function(){try{it()}catch(ft){de.error(ft)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var de;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ut}=this;super.unsubscribe(),!ut&&(null===(de=this.onFinalize)||void 0===de||de.call(this))}}}},262:(ti,Vt,B)=>{"use strict";B.d(Vt,{K:()=>a});var w=B(8421),_=B(5403),pe=B(4482);function a(de){return(0,pe.e)((ut,it)=>{let rt,Le=null,ke=!1;Le=ut.subscribe((0,_.x)(it,void 0,void 0,ft=>{rt=(0,w.Xf)(de(ft,a(de)(ut))),Le?(Le.unsubscribe(),Le=null,rt.subscribe(it)):ke=!0})),ke&&(Le.unsubscribe(),Le=null,rt.subscribe(it))})}},4351:(ti,Vt,B)=>{"use strict";B.d(Vt,{b:()=>pe});var w=B(5577),_=B(576);function pe(a,de){return(0,_.m)(de)?(0,w.z)(a,de,1):(0,w.z)(a,1)}},8372:(ti,Vt,B)=>{"use strict";B.d(Vt,{b:()=>a});var w=B(4986),_=B(4482),pe=B(5403);function a(de,ut=w.z){return(0,_.e)((it,Le)=>{let ke=null,rt=null,ft=null;const Et=()=>{if(ke){ke.unsubscribe(),ke=null;const wt=rt;rt=null,Le.next(wt)}};function dt(){const wt=ft+de,tt=ut.now();if(tt<wt)return ke=this.schedule(void 0,wt-tt),void Le.add(ke);Et()}it.subscribe((0,pe.x)(Le,wt=>{rt=wt,ft=ut.now(),ke||(ke=ut.schedule(dt,de),Le.add(ke))},()=>{Et(),Le.complete()},void 0,()=>{rt=ke=null}))})}},1005:(ti,Vt,B)=>{"use strict";B.d(Vt,{g:()=>Et});var w=B(4986),_=B(7272),pe=B(5698),a=B(4482),de=B(5403),ut=B(5032),Le=B(9718),ke=B(5577);function rt(dt,wt){return wt?tt=>(0,_.z)(wt.pipe((0,pe.q)(1),function it(){return(0,a.e)((dt,wt)=>{dt.subscribe((0,de.x)(wt,ut.Z))})}()),tt.pipe(rt(dt))):(0,ke.z)((tt,Wt)=>dt(tt,Wt).pipe((0,pe.q)(1),(0,Le.h)(tt)))}var ft=B(5963);function Et(dt,wt=w.z){const tt=(0,ft.H)(dt,wt);return rt(()=>tt)}},1884:(ti,Vt,B)=>{"use strict";B.d(Vt,{x:()=>a});var w=B(4671),_=B(4482),pe=B(5403);function a(ut,it=w.y){return ut=ut??de,(0,_.e)((Le,ke)=>{let rt,ft=!0;Le.subscribe((0,pe.x)(ke,Et=>{const dt=it(Et);(ft||!ut(rt,dt))&&(ft=!1,rt=dt,ke.next(Et))}))})}function de(ut,it){return ut===it}},9300:(ti,Vt,B)=>{"use strict";B.d(Vt,{h:()=>pe});var w=B(4482),_=B(5403);function pe(a,de){return(0,w.e)((ut,it)=>{let Le=0;ut.subscribe((0,_.x)(it,ke=>a.call(de,ke,Le++)&&it.next(ke)))})}},8746:(ti,Vt,B)=>{"use strict";B.d(Vt,{x:()=>_});var w=B(4482);function _(pe){return(0,w.e)((a,de)=>{try{a.subscribe(de)}finally{de.add(pe)}})}},4004:(ti,Vt,B)=>{"use strict";B.d(Vt,{U:()=>pe});var w=B(4482),_=B(5403);function pe(a,de){return(0,w.e)((ut,it)=>{let Le=0;ut.subscribe((0,_.x)(it,ke=>{it.next(a.call(de,ke,Le++))}))})}},9718:(ti,Vt,B)=>{"use strict";B.d(Vt,{h:()=>_});var w=B(4004);function _(pe){return(0,w.U)(()=>pe)}},8189:(ti,Vt,B)=>{"use strict";B.d(Vt,{J:()=>pe});var w=B(5577),_=B(4671);function pe(a=1/0){return(0,w.z)(_.y,a)}},5577:(ti,Vt,B)=>{"use strict";B.d(Vt,{z:()=>Le});var w=B(4004),_=B(8421),pe=B(4482),a=B(9672),de=B(5403),it=B(576);function Le(ke,rt,ft=1/0){return(0,it.m)(rt)?Le((Et,dt)=>(0,w.U)((wt,tt)=>rt(Et,wt,dt,tt))((0,_.Xf)(ke(Et,dt))),ft):("number"==typeof rt&&(ft=rt),(0,pe.e)((Et,dt)=>function ut(ke,rt,ft,Et,dt,wt,tt,Wt){const kt=[];let Qe=0,Hn=0,Ln=!1;const Ye=()=>{Ln&&!kt.length&&!Qe&&rt.complete()},Ce=At=>Qe<Et?we(At):kt.push(At),we=At=>{wt&&rt.next(At),Qe++;let zt=!1;(0,_.Xf)(ft(At,Hn++)).subscribe((0,de.x)(rt,Jt=>{dt?.(Jt),wt?Ce(Jt):rt.next(Jt)},()=>{zt=!0},void 0,()=>{if(zt)try{for(Qe--;kt.length&&Qe<Et;){const Jt=kt.shift();tt?(0,a.f)(rt,tt,()=>we(Jt)):we(Jt)}Ye()}catch(Jt){rt.error(Jt)}}))};return ke.subscribe((0,de.x)(rt,Ce,()=>{Ln=!0,Ye()})),()=>{Wt?.()}}(Et,dt,ke,ft)))}},3099:(ti,Vt,B)=>{"use strict";B.d(Vt,{B:()=>de});var w=B(8421),_=B(7579),pe=B(930),a=B(4482);function de(it={}){const{connector:Le=(()=>new _.x),resetOnError:ke=!0,resetOnComplete:rt=!0,resetOnRefCountZero:ft=!0}=it;return Et=>{let dt,wt,tt,Wt=0,kt=!1,Qe=!1;const Hn=()=>{wt?.unsubscribe(),wt=void 0},Ln=()=>{Hn(),dt=tt=void 0,kt=Qe=!1},Ye=()=>{const Ce=dt;Ln(),Ce?.unsubscribe()};return(0,a.e)((Ce,we)=>{Wt++,!Qe&&!kt&&Hn();const At=tt=tt??Le();we.add(()=>{Wt--,0===Wt&&!Qe&&!kt&&(wt=ut(Ye,ft))}),At.subscribe(we),!dt&&Wt>0&&(dt=new pe.Hp({next:zt=>At.next(zt),error:zt=>{Qe=!0,Hn(),wt=ut(Ln,ke,zt),At.error(zt)},complete:()=>{kt=!0,Hn(),wt=ut(Ln,rt),At.complete()}}),(0,w.Xf)(Ce).subscribe(dt))})(Et)}}function ut(it,Le,...ke){if(!0===Le)return void it();if(!1===Le)return;const rt=new pe.Hp({next:()=>{rt.unsubscribe(),it()}});return Le(...ke).subscribe(rt)}},5684:(ti,Vt,B)=>{"use strict";B.d(Vt,{T:()=>_});var w=B(9300);function _(pe){return(0,w.h)((a,de)=>pe<=de)}},8675:(ti,Vt,B)=>{"use strict";B.d(Vt,{O:()=>a});var w=B(7272),_=B(3269),pe=B(4482);function a(...de){const ut=(0,_.yG)(de);return(0,pe.e)((it,Le)=>{(ut?(0,w.z)(de,it,ut):(0,w.z)(de,it)).subscribe(Le)})}},3900:(ti,Vt,B)=>{"use strict";B.d(Vt,{w:()=>a});var w=B(8421),_=B(4482),pe=B(5403);function a(de,ut){return(0,_.e)((it,Le)=>{let ke=null,rt=0,ft=!1;const Et=()=>ft&&!ke&&Le.complete();it.subscribe((0,pe.x)(Le,dt=>{ke?.unsubscribe();let wt=0;const tt=rt++;(0,w.Xf)(de(dt,tt)).subscribe(ke=(0,pe.x)(Le,Wt=>Le.next(ut?ut(dt,Wt,tt,wt++):Wt),()=>{ke=null,Et()}))},()=>{ft=!0,Et()}))})}},5698:(ti,Vt,B)=>{"use strict";B.d(Vt,{q:()=>a});var w=B(515),_=B(4482),pe=B(5403);function a(de){return de<=0?()=>w.E:(0,_.e)((ut,it)=>{let Le=0;ut.subscribe((0,pe.x)(it,ke=>{++Le<=de&&(it.next(ke),de<=Le&&it.complete())}))})}},2722:(ti,Vt,B)=>{"use strict";B.d(Vt,{R:()=>de});var w=B(4482),_=B(5403),pe=B(8421),a=B(5032);function de(ut){return(0,w.e)((it,Le)=>{(0,pe.Xf)(ut).subscribe((0,_.x)(Le,()=>Le.complete(),a.Z)),!Le.closed&&it.subscribe(Le)})}},8505:(ti,Vt,B)=>{"use strict";B.d(Vt,{b:()=>de});var w=B(576),_=B(4482),pe=B(5403),a=B(4671);function de(ut,it,Le){const ke=(0,w.m)(ut)||it||Le?{next:ut,error:it,complete:Le}:ut;return ke?(0,_.e)((rt,ft)=>{var Et;null===(Et=ke.subscribe)||void 0===Et||Et.call(ke);let dt=!0;rt.subscribe((0,pe.x)(ft,wt=>{var tt;null===(tt=ke.next)||void 0===tt||tt.call(ke,wt),ft.next(wt)},()=>{var wt;dt=!1,null===(wt=ke.complete)||void 0===wt||wt.call(ke),ft.complete()},wt=>{var tt;dt=!1,null===(tt=ke.error)||void 0===tt||tt.call(ke,wt),ft.error(wt)},()=>{var wt,tt;dt&&(null===(wt=ke.unsubscribe)||void 0===wt||wt.call(ke)),null===(tt=ke.finalize)||void 0===tt||tt.call(ke)}))}):a.y}},4408:(ti,Vt,B)=>{"use strict";B.d(Vt,{o:()=>de});var w=B(727);class _ extends w.w0{constructor(it,Le){super()}schedule(it,Le=0){return this}}const pe={setInterval(ut,it,...Le){const{delegate:ke}=pe;return ke?.setInterval?ke.setInterval(ut,it,...Le):setInterval(ut,it,...Le)},clearInterval(ut){const{delegate:it}=pe;return(it?.clearInterval||clearInterval)(ut)},delegate:void 0};var a=B(8737);class de extends _{constructor(it,Le){super(it,Le),this.scheduler=it,this.work=Le,this.pending=!1}schedule(it,Le=0){var ke;if(this.closed)return this;this.state=it;const rt=this.id,ft=this.scheduler;return null!=rt&&(this.id=this.recycleAsyncId(ft,rt,Le)),this.pending=!0,this.delay=Le,this.id=null!==(ke=this.id)&&void 0!==ke?ke:this.requestAsyncId(ft,this.id,Le),this}requestAsyncId(it,Le,ke=0){return pe.setInterval(it.flush.bind(it,this),ke)}recycleAsyncId(it,Le,ke=0){if(null!=ke&&this.delay===ke&&!1===this.pending)return Le;null!=Le&&pe.clearInterval(Le)}execute(it,Le){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ke=this._execute(it,Le);if(ke)return ke;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(it,Le){let rt,ke=!1;try{this.work(it)}catch(ft){ke=!0,rt=ft||new Error("Scheduled action threw falsy error")}if(ke)return this.unsubscribe(),rt}unsubscribe(){if(!this.closed){const{id:it,scheduler:Le}=this,{actions:ke}=Le;this.work=this.state=this.scheduler=null,this.pending=!1,(0,a.P)(ke,this),null!=it&&(this.id=this.recycleAsyncId(Le,it,null)),this.delay=null,super.unsubscribe()}}}},640:(ti,Vt,B)=>{"use strict";B.d(Vt,{v:()=>pe});const w={now:()=>(w.delegate||Date).now(),delegate:void 0};class _{constructor(de,ut=_.now){this.schedulerActionCtor=de,this.now=ut}schedule(de,ut=0,it){return new this.schedulerActionCtor(this,de).schedule(it,ut)}}_.now=w.now;class pe extends _{constructor(de,ut=_.now){super(de,ut),this.actions=[],this._active=!1}flush(de){const{actions:ut}=this;if(this._active)return void ut.push(de);let it;this._active=!0;do{if(it=de.execute(de.state,de.delay))break}while(de=ut.shift());if(this._active=!1,it){for(;de=ut.shift();)de.unsubscribe();throw it}}}},4986:(ti,Vt,B)=>{"use strict";B.d(Vt,{P:()=>a,z:()=>pe});var w=B(4408);const pe=new(B(640).v)(w.o),a=pe},3410:(ti,Vt,B)=>{"use strict";B.d(Vt,{z:()=>w});const w={setTimeout(_,pe,...a){const{delegate:de}=w;return de?.setTimeout?de.setTimeout(_,pe,...a):setTimeout(_,pe,...a)},clearTimeout(_){const{delegate:pe}=w;return(pe?.clearTimeout||clearTimeout)(_)},delegate:void 0}},2202:(ti,Vt,B)=>{"use strict";B.d(Vt,{h:()=>_});const _=function w(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ti,Vt,B)=>{"use strict";B.d(Vt,{L:()=>w});const w="function"==typeof Symbol&&Symbol.observable||"@@observable"},3269:(ti,Vt,B)=>{"use strict";B.d(Vt,{_6:()=>ut,jO:()=>a,yG:()=>de});var w=B(576),_=B(3532);function pe(it){return it[it.length-1]}function a(it){return(0,w.m)(pe(it))?it.pop():void 0}function de(it){return(0,_.K)(pe(it))?it.pop():void 0}function ut(it,Le){return"number"==typeof pe(it)?it.pop():Le}},4742:(ti,Vt,B)=>{"use strict";B.d(Vt,{D:()=>de});const{isArray:w}=Array,{getPrototypeOf:_,prototype:pe,keys:a}=Object;function de(it){if(1===it.length){const Le=it[0];if(w(Le))return{args:Le,keys:null};if(function ut(it){return it&&"object"==typeof it&&_(it)===pe}(Le)){const ke=a(Le);return{args:ke.map(rt=>Le[rt]),keys:ke}}}return{args:it,keys:null}}},8737:(ti,Vt,B)=>{"use strict";function w(_,pe){if(_){const a=_.indexOf(pe);0<=a&&_.splice(a,1)}}B.d(Vt,{P:()=>w})},3888:(ti,Vt,B)=>{"use strict";function w(_){const a=_(de=>{Error.call(de),de.stack=(new Error).stack});return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}B.d(Vt,{d:()=>w})},1810:(ti,Vt,B)=>{"use strict";function w(_,pe){return _.reduce((a,de,ut)=>(a[de]=pe[ut],a),{})}B.d(Vt,{n:()=>w})},2806:(ti,Vt,B)=>{"use strict";B.d(Vt,{O:()=>a,x:()=>pe});var w=B(2416);let _=null;function pe(de){if(w.v.useDeprecatedSynchronousErrorHandling){const ut=!_;if(ut&&(_={errorThrown:!1,error:null}),de(),ut){const{errorThrown:it,error:Le}=_;if(_=null,it)throw Le}}else de()}function a(de){w.v.useDeprecatedSynchronousErrorHandling&&_&&(_.errorThrown=!0,_.error=de)}},9672:(ti,Vt,B)=>{"use strict";function w(_,pe,a,de=0,ut=!1){const it=pe.schedule(function(){a(),ut?_.add(this.schedule(null,de)):this.unsubscribe()},de);if(_.add(it),!ut)return it}B.d(Vt,{f:()=>w})},4671:(ti,Vt,B)=>{"use strict";function w(_){return _}B.d(Vt,{y:()=>w})},1144:(ti,Vt,B)=>{"use strict";B.d(Vt,{z:()=>w});const w=_=>_&&"number"==typeof _.length&&"function"!=typeof _},2206:(ti,Vt,B)=>{"use strict";B.d(Vt,{D:()=>_});var w=B(576);function _(pe){return Symbol.asyncIterator&&(0,w.m)(pe?.[Symbol.asyncIterator])}},576:(ti,Vt,B)=>{"use strict";function w(_){return"function"==typeof _}B.d(Vt,{m:()=>w})},3670:(ti,Vt,B)=>{"use strict";B.d(Vt,{c:()=>pe});var w=B(8822),_=B(576);function pe(a){return(0,_.m)(a[w.L])}},6495:(ti,Vt,B)=>{"use strict";B.d(Vt,{T:()=>pe});var w=B(2202),_=B(576);function pe(a){return(0,_.m)(a?.[w.h])}},8239:(ti,Vt,B)=>{"use strict";B.d(Vt,{t:()=>_});var w=B(576);function _(pe){return(0,w.m)(pe?.then)}},3260:(ti,Vt,B)=>{"use strict";B.d(Vt,{L:()=>a,Q:()=>pe});var w=B(655),_=B(576);function pe(de){return(0,w.FC)(this,arguments,function*(){const it=de.getReader();try{for(;;){const{value:Le,done:ke}=yield(0,w.qq)(it.read());if(ke)return yield(0,w.qq)(void 0);yield yield(0,w.qq)(Le)}}finally{it.releaseLock()}})}function a(de){return(0,_.m)(de?.getReader)}},3532:(ti,Vt,B)=>{"use strict";B.d(Vt,{K:()=>_});var w=B(576);function _(pe){return pe&&(0,w.m)(pe.schedule)}},4482:(ti,Vt,B)=>{"use strict";B.d(Vt,{A:()=>_,e:()=>pe});var w=B(576);function _(a){return(0,w.m)(a?.lift)}function pe(a){return de=>{if(_(de))return de.lift(function(ut){try{return a(ut,this)}catch(it){this.error(it)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(ti,Vt,B)=>{"use strict";B.d(Vt,{Z:()=>a});var w=B(4004);const{isArray:_}=Array;function a(de){return(0,w.U)(ut=>function pe(de,ut){return _(ut)?de(...ut):de(ut)}(de,ut))}},5032:(ti,Vt,B)=>{"use strict";function w(){}B.d(Vt,{Z:()=>w})},9635:(ti,Vt,B)=>{"use strict";B.d(Vt,{U:()=>pe,z:()=>_});var w=B(4671);function _(...a){return pe(a)}function pe(a){return 0===a.length?w.y:1===a.length?a[0]:function(ut){return a.reduce((it,Le)=>Le(it),ut)}}},7849:(ti,Vt,B)=>{"use strict";B.d(Vt,{h:()=>pe});var w=B(2416),_=B(3410);function pe(a){_.z.setTimeout(()=>{const{onUnhandledError:de}=w.v;if(!de)throw a;de(a)})}},4532:(ti,Vt,B)=>{"use strict";function w(_){return new TypeError(`You provided ${null!==_&&"object"==typeof _?"an invalid object":`'${_}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}B.d(Vt,{z:()=>w})},655:(ti,Vt,B)=>{"use strict";function de(Ke,Ne,He,_t){var ii,Dn=arguments.length,Xt=Dn<3?Ne:null===_t?_t=Object.getOwnPropertyDescriptor(Ne,He):_t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Xt=Reflect.decorate(Ke,Ne,He,_t);else for(var vi=Ke.length-1;vi>=0;vi--)(ii=Ke[vi])&&(Xt=(Dn<3?ii(Xt):Dn>3?ii(Ne,He,Xt):ii(Ne,He))||Xt);return Dn>3&&Xt&&Object.defineProperty(Ne,He,Xt),Xt}function ut(Ke,Ne){return function(He,_t){Ne(He,_t,Ke)}}function it(Ke,Ne){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(Ke,Ne)}function Le(Ke,Ne,He,_t){return new(He||(He=Promise))(function(Xt,ii){function vi(Bi){try{Nn(_t.next(Bi))}catch(Jn){ii(Jn)}}function wi(Bi){try{Nn(_t.throw(Bi))}catch(Jn){ii(Jn)}}function Nn(Bi){Bi.done?Xt(Bi.value):function Dn(Xt){return Xt instanceof He?Xt:new He(function(ii){ii(Xt)})}(Bi.value).then(vi,wi)}Nn((_t=_t.apply(Ke,Ne||[])).next())})}function kt(Ke){return this instanceof kt?(this.v=Ke,this):new kt(Ke)}function Qe(Ke,Ne,He){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Dn,_t=He.apply(Ke,Ne||[]),Xt=[];return Dn={},ii("next"),ii("throw"),ii("return"),Dn[Symbol.asyncIterator]=function(){return this},Dn;function ii(fn){_t[fn]&&(Dn[fn]=function(Tt){return new Promise(function(Ge,Fe){Xt.push([fn,Tt,Ge,Fe])>1||vi(fn,Tt)})})}function vi(fn,Tt){try{!function wi(fn){fn.value instanceof kt?Promise.resolve(fn.value.v).then(Nn,Bi):Jn(Xt[0][2],fn)}(_t[fn](Tt))}catch(Ge){Jn(Xt[0][3],Ge)}}function Nn(fn){vi("next",fn)}function Bi(fn){vi("throw",fn)}function Jn(fn,Tt){fn(Tt),Xt.shift(),Xt.length&&vi(Xt[0][0],Xt[0][1])}}function Ln(Ke){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var He,Ne=Ke[Symbol.asyncIterator];return Ne?Ne.call(Ke):(Ke=function Et(Ke){var Ne="function"==typeof Symbol&&Symbol.iterator,He=Ne&&Ke[Ne],_t=0;if(He)return He.call(Ke);if(Ke&&"number"==typeof Ke.length)return{next:function(){return Ke&&_t>=Ke.length&&(Ke=void 0),{value:Ke&&Ke[_t++],done:!Ke}}};throw new TypeError(Ne?"Object is not iterable.":"Symbol.iterator is not defined.")}(Ke),He={},_t("next"),_t("throw"),_t("return"),He[Symbol.asyncIterator]=function(){return this},He);function _t(Xt){He[Xt]=Ke[Xt]&&function(ii){return new Promise(function(vi,wi){!function Dn(Xt,ii,vi,wi){Promise.resolve(wi).then(function(Nn){Xt({value:Nn,done:vi})},ii)}(vi,wi,(ii=Ke[Xt](ii)).done,ii.value)})}}}B.d(Vt,{FC:()=>Qe,KL:()=>Ln,fM:()=>ut,gn:()=>de,mG:()=>Le,qq:()=>kt,w6:()=>it})},7340:(ti,Vt,B)=>{"use strict";B.d(Vt,{IO:()=>tt,LC:()=>_,SB:()=>ke,X$:()=>a,ZE:()=>Hn,ZN:()=>Qe,_j:()=>w,eR:()=>ft,jt:()=>de,k1:()=>Ln,l3:()=>pe,oB:()=>Le,pV:()=>dt,vP:()=>it});class w{}class _{}const pe="*";function a(Ye,Ce){return{type:7,name:Ye,definitions:Ce,options:{}}}function de(Ye,Ce=null){return{type:4,styles:Ce,timings:Ye}}function it(Ye,Ce=null){return{type:2,steps:Ye,options:Ce}}function Le(Ye){return{type:6,styles:Ye,offset:null}}function ke(Ye,Ce,we){return{type:0,name:Ye,styles:Ce,options:we}}function ft(Ye,Ce,we=null){return{type:1,expr:Ye,animation:Ce,options:we}}function dt(Ye=null){return{type:9,options:Ye}}function tt(Ye,Ce,we=null){return{type:11,selector:Ye,animation:Ce,options:we}}function kt(Ye){Promise.resolve().then(Ye)}class Qe{constructor(Ce=0,we=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=Ce+we}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ce=>Ce()),this._onDoneFns=[])}onStart(Ce){this._originalOnStartFns.push(Ce),this._onStartFns.push(Ce)}onDone(Ce){this._originalOnDoneFns.push(Ce),this._onDoneFns.push(Ce)}onDestroy(Ce){this._onDestroyFns.push(Ce)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){kt(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(Ce=>Ce()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(Ce=>Ce()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(Ce){this._position=this.totalTime?Ce*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(Ce){const we="start"==Ce?this._onStartFns:this._onDoneFns;we.forEach(At=>At()),we.length=0}}class Hn{constructor(Ce){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=Ce;let we=0,At=0,zt=0;const Jt=this.players.length;0==Jt?kt(()=>this._onFinish()):this.players.forEach(Cn=>{Cn.onDone(()=>{++we==Jt&&this._onFinish()}),Cn.onDestroy(()=>{++At==Jt&&this._onDestroy()}),Cn.onStart(()=>{++zt==Jt&&this._onStart()})}),this.totalTime=this.players.reduce((Cn,Ke)=>Math.max(Cn,Ke.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(Ce=>Ce()),this._onDoneFns=[])}init(){this.players.forEach(Ce=>Ce.init())}onStart(Ce){this._onStartFns.push(Ce)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(Ce=>Ce()),this._onStartFns=[])}onDone(Ce){this._onDoneFns.push(Ce)}onDestroy(Ce){this._onDestroyFns.push(Ce)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(Ce=>Ce.play())}pause(){this.players.forEach(Ce=>Ce.pause())}restart(){this.players.forEach(Ce=>Ce.restart())}finish(){this._onFinish(),this.players.forEach(Ce=>Ce.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(Ce=>Ce.destroy()),this._onDestroyFns.forEach(Ce=>Ce()),this._onDestroyFns=[])}reset(){this.players.forEach(Ce=>Ce.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(Ce){const we=Ce*this.totalTime;this.players.forEach(At=>{const zt=At.totalTime?Math.min(1,we/At.totalTime):1;At.setPosition(zt)})}getPosition(){const Ce=this.players.reduce((we,At)=>null===we||At.totalTime>we.totalTime?At:we,null);return null!=Ce?Ce.getPosition():0}beforeDestroy(){this.players.forEach(Ce=>{Ce.beforeDestroy&&Ce.beforeDestroy()})}triggerCallback(Ce){const we="start"==Ce?this._onStartFns:this._onDoneFns;we.forEach(At=>At()),we.length=0}}const Ln="!"},2687:(ti,Vt,B)=>{"use strict";B.d(Vt,{Em:()=>Xt,Kd:()=>Rn,X6:()=>Rt,ic:()=>vi,qV:()=>St,qm:()=>nn,s1:()=>Dn,tE:()=>Ji,yG:()=>on});var w=B(6895),_=B(4650),pe=B(7579),a=B(727),de=B(1135),ut=B(9646),it=B(9521),Le=B(8505),ke=B(8372),rt=B(9300),ft=B(4004),Et=B(5698),dt=B(5684),wt=B(1884),tt=B(2722),Wt=B(1281),kt=B(3353);class _t{constructor(xt){this._items=xt,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new pe.x,this._typeaheadSubscription=a.w0.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=pt=>pt.disabled,this._pressedLetters=[],this.tabOut=new pe.x,this.change=new pe.x,xt instanceof _.n_E&&xt.changes.subscribe(pt=>{if(this._activeItem){const bn=pt.toArray().indexOf(this._activeItem);bn>-1&&bn!==this._activeItemIndex&&(this._activeItemIndex=bn)}})}skipPredicate(xt){return this._skipPredicateFn=xt,this}withWrap(xt=!0){return this._wrap=xt,this}withVerticalOrientation(xt=!0){return this._vertical=xt,this}withHorizontalOrientation(xt){return this._horizontal=xt,this}withAllowedModifierKeys(xt){return this._allowedModifierKeys=xt,this}withTypeAhead(xt=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe((0,Le.b)(pt=>this._pressedLetters.push(pt)),(0,ke.b)(xt),(0,rt.h)(()=>this._pressedLetters.length>0),(0,ft.U)(()=>this._pressedLetters.join(""))).subscribe(pt=>{const Yt=this._getItemsArray();for(let bn=1;bn<Yt.length+1;bn++){const ri=(this._activeItemIndex+bn)%Yt.length,Ee=Yt[ri];if(!this._skipPredicateFn(Ee)&&0===Ee.getLabel().toUpperCase().trim().indexOf(pt)){this.setActiveItem(ri);break}}this._pressedLetters=[]}),this}withHomeAndEnd(xt=!0){return this._homeAndEnd=xt,this}setActiveItem(xt){const pt=this._activeItem;this.updateActiveItem(xt),this._activeItem!==pt&&this.change.next(this._activeItemIndex)}onKeydown(xt){const pt=xt.keyCode,bn=["altKey","ctrlKey","metaKey","shiftKey"].every(ri=>!xt[ri]||this._allowedModifierKeys.indexOf(ri)>-1);switch(pt){case it.Mf:return void this.tabOut.next();case it.JH:if(this._vertical&&bn){this.setNextItemActive();break}return;case it.LH:if(this._vertical&&bn){this.setPreviousItemActive();break}return;case it.SV:if(this._horizontal&&bn){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case it.oh:if(this._horizontal&&bn){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case it.Sd:if(this._homeAndEnd&&bn){this.setFirstItemActive();break}return;case it.uR:if(this._homeAndEnd&&bn){this.setLastItemActive();break}return;default:return void((bn||(0,it.Vb)(xt,"shiftKey"))&&(xt.key&&1===xt.key.length?this._letterKeyStream.next(xt.key.toLocaleUpperCase()):(pt>=it.A&&pt<=it.Z||pt>=it.xE&&pt<=it.aO)&&this._letterKeyStream.next(String.fromCharCode(pt))))}this._pressedLetters=[],xt.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(xt){const pt=this._getItemsArray(),Yt="number"==typeof xt?xt:pt.indexOf(xt);this._activeItem=pt[Yt]??null,this._activeItemIndex=Yt}_setActiveItemByDelta(xt){this._wrap?this._setActiveInWrapMode(xt):this._setActiveInDefaultMode(xt)}_setActiveInWrapMode(xt){const pt=this._getItemsArray();for(let Yt=1;Yt<=pt.length;Yt++){const bn=(this._activeItemIndex+xt*Yt+pt.length)%pt.length;if(!this._skipPredicateFn(pt[bn]))return void this.setActiveItem(bn)}}_setActiveInDefaultMode(xt){this._setActiveItemByIndex(this._activeItemIndex+xt,xt)}_setActiveItemByIndex(xt,pt){const Yt=this._getItemsArray();if(Yt[xt]){for(;this._skipPredicateFn(Yt[xt]);)if(!Yt[xt+=pt])return;this.setActiveItem(xt)}}_getItemsArray(){return this._items instanceof _.n_E?this._items.toArray():this._items}}class Dn extends _t{setActiveItem(xt){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(xt),this.activeItem&&this.activeItem.setActiveStyles()}}class Xt extends _t{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(xt){return this._origin=xt,this}setActiveItem(xt){super.setActiveItem(xt),this.activeItem&&this.activeItem.focus(this._origin)}}let vi=(()=>{class Qt{constructor(pt){this._platform=pt}isDisabled(pt){return pt.hasAttribute("disabled")}isVisible(pt){return function Nn(Qt){return!!(Qt.offsetWidth||Qt.offsetHeight||"function"==typeof Qt.getClientRects&&Qt.getClientRects().length)}(pt)&&"visible"===getComputedStyle(pt).visibility}isTabbable(pt){if(!this._platform.isBrowser)return!1;const Yt=function wi(Qt){try{return Qt.frameElement}catch{return null}}(function ot(Qt){return Qt.ownerDocument&&Qt.ownerDocument.defaultView||window}(pt));if(Yt&&(-1===ht(Yt)||!this.isVisible(Yt)))return!1;let bn=pt.nodeName.toLowerCase(),ri=ht(pt);return pt.hasAttribute("contenteditable")?-1!==ri:!("iframe"===bn||"object"===bn||this._platform.WEBKIT&&this._platform.IOS&&!function Xe(Qt){let xt=Qt.nodeName.toLowerCase(),pt="input"===xt&&Qt.type;return"text"===pt||"password"===pt||"select"===xt||"textarea"===xt}(pt))&&("audio"===bn?!!pt.hasAttribute("controls")&&-1!==ri:"video"===bn?-1!==ri&&(null!==ri||this._platform.FIREFOX||pt.hasAttribute("controls")):pt.tabIndex>=0)}isFocusable(pt,Yt){return function ce(Qt){return!function Jn(Qt){return function Tt(Qt){return"input"==Qt.nodeName.toLowerCase()}(Qt)&&"hidden"==Qt.type}(Qt)&&(function Bi(Qt){let xt=Qt.nodeName.toLowerCase();return"input"===xt||"select"===xt||"button"===xt||"textarea"===xt}(Qt)||function fn(Qt){return function Ge(Qt){return"a"==Qt.nodeName.toLowerCase()}(Qt)&&Qt.hasAttribute("href")}(Qt)||Qt.hasAttribute("contenteditable")||Fe(Qt))}(pt)&&!this.isDisabled(pt)&&(Yt?.ignoreVisibility||this.isVisible(pt))}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(kt.t4))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})();function Fe(Qt){if(!Qt.hasAttribute("tabindex")||void 0===Qt.tabIndex)return!1;let xt=Qt.getAttribute("tabindex");return!(!xt||isNaN(parseInt(xt,10)))}function ht(Qt){if(!Fe(Qt))return null;const xt=parseInt(Qt.getAttribute("tabindex")||"",10);return isNaN(xt)?-1:xt}class Se{constructor(xt,pt,Yt,bn,ri=!1){this._element=xt,this._checker=pt,this._ngZone=Yt,this._document=bn,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,ri||this.attachAnchors()}get enabled(){return this._enabled}set enabled(xt){this._enabled=xt,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(xt,this._startAnchor),this._toggleAnchorTabIndex(xt,this._endAnchor))}destroy(){const xt=this._startAnchor,pt=this._endAnchor;xt&&(xt.removeEventListener("focus",this.startAnchorListener),xt.remove()),pt&&(pt.removeEventListener("focus",this.endAnchorListener),pt.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(xt){return new Promise(pt=>{this._executeOnStable(()=>pt(this.focusInitialElement(xt)))})}focusFirstTabbableElementWhenReady(xt){return new Promise(pt=>{this._executeOnStable(()=>pt(this.focusFirstTabbableElement(xt)))})}focusLastTabbableElementWhenReady(xt){return new Promise(pt=>{this._executeOnStable(()=>pt(this.focusLastTabbableElement(xt)))})}_getRegionBoundary(xt){let pt=this._element.querySelectorAll(`[cdk-focus-region-${xt}], [cdkFocusRegion${xt}], [cdk-focus-${xt}]`);for(let Yt=0;Yt<pt.length;Yt++)pt[Yt].hasAttribute(`cdk-focus-${xt}`)?console.warn(`Found use of deprecated attribute 'cdk-focus-${xt}', use 'cdkFocusRegion${xt}' instead. The deprecated attribute will be removed in 8.0.0.`,pt[Yt]):pt[Yt].hasAttribute(`cdk-focus-region-${xt}`)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${xt}', use 'cdkFocusRegion${xt}' instead. The deprecated attribute will be removed in 8.0.0.`,pt[Yt]);return"start"==xt?pt.length?pt[0]:this._getFirstTabbableElement(this._element):pt.length?pt[pt.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(xt){const pt=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(pt){if(pt.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",pt),!this._checker.isFocusable(pt)){const Yt=this._getFirstTabbableElement(pt);return Yt?.focus(xt),!!Yt}return pt.focus(xt),!0}return this.focusFirstTabbableElement(xt)}focusFirstTabbableElement(xt){const pt=this._getRegionBoundary("start");return pt&&pt.focus(xt),!!pt}focusLastTabbableElement(xt){const pt=this._getRegionBoundary("end");return pt&&pt.focus(xt),!!pt}hasAttached(){return this._hasAttached}_getFirstTabbableElement(xt){if(this._checker.isFocusable(xt)&&this._checker.isTabbable(xt))return xt;const pt=xt.children;for(let Yt=0;Yt<pt.length;Yt++){const bn=pt[Yt].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(pt[Yt]):null;if(bn)return bn}return null}_getLastTabbableElement(xt){if(this._checker.isFocusable(xt)&&this._checker.isTabbable(xt))return xt;const pt=xt.children;for(let Yt=pt.length-1;Yt>=0;Yt--){const bn=pt[Yt].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(pt[Yt]):null;if(bn)return bn}return null}_createAnchor(){const xt=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,xt),xt.classList.add("cdk-visually-hidden"),xt.classList.add("cdk-focus-trap-anchor"),xt.setAttribute("aria-hidden","true"),xt}_toggleAnchorTabIndex(xt,pt){xt?pt.setAttribute("tabindex","0"):pt.removeAttribute("tabindex")}toggleAnchors(xt){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(xt,this._startAnchor),this._toggleAnchorTabIndex(xt,this._endAnchor))}_executeOnStable(xt){this._ngZone.isStable?xt():this._ngZone.onStable.pipe((0,Et.q)(1)).subscribe(xt)}}let St=(()=>{class Qt{constructor(pt,Yt,bn){this._checker=pt,this._ngZone=Yt,this._document=bn}create(pt,Yt=!1){return new Se(pt,this._checker,this._ngZone,this._document,Yt)}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(vi),_.LFG(_.R0b),_.LFG(w.K0))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})();function Rt(Qt){return 0===Qt.offsetX&&0===Qt.offsetY}function on(Qt){const xt=Qt.touches&&Qt.touches[0]||Qt.changedTouches&&Qt.changedTouches[0];return!(!xt||-1!==xt.identifier||null!=xt.radiusX&&1!==xt.radiusX||null!=xt.radiusY&&1!==xt.radiusY)}const jt=new _.OlP("cdk-input-modality-detector-options"),Bt={ignoreKeys:[it.zL,it.jx,it.b2,it.MW,it.JU]},ge=(0,kt.i$)({passive:!0,capture:!0});let fe=(()=>{class Qt{constructor(pt,Yt,bn,ri){this._platform=pt,this._mostRecentTarget=null,this._modality=new de.X(null),this._lastTouchMs=0,this._onKeydown=Ee=>{this._options?.ignoreKeys?.some(ee=>ee===Ee.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=(0,kt.sA)(Ee))},this._onMousedown=Ee=>{Date.now()-this._lastTouchMs<650||(this._modality.next(Rt(Ee)?"keyboard":"mouse"),this._mostRecentTarget=(0,kt.sA)(Ee))},this._onTouchstart=Ee=>{on(Ee)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=(0,kt.sA)(Ee))},this._options={...Bt,...ri},this.modalityDetected=this._modality.pipe((0,dt.T)(1)),this.modalityChanged=this.modalityDetected.pipe((0,wt.x)()),pt.isBrowser&&Yt.runOutsideAngular(()=>{bn.addEventListener("keydown",this._onKeydown,ge),bn.addEventListener("mousedown",this._onMousedown,ge),bn.addEventListener("touchstart",this._onTouchstart,ge)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,ge),document.removeEventListener("mousedown",this._onMousedown,ge),document.removeEventListener("touchstart",this._onTouchstart,ge))}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(kt.t4),_.LFG(_.R0b),_.LFG(w.K0),_.LFG(jt,8))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})();const te=new _.OlP("liveAnnouncerElement",{providedIn:"root",factory:function nt(){return null}}),Ht=new _.OlP("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let Rn=(()=>{class Qt{constructor(pt,Yt,bn,ri){this._ngZone=Yt,this._defaultOptions=ri,this._document=bn,this._liveElement=pt||this._createLiveElement()}announce(pt,...Yt){const bn=this._defaultOptions;let ri,Ee;return 1===Yt.length&&"number"==typeof Yt[0]?Ee=Yt[0]:[ri,Ee]=Yt,this.clear(),clearTimeout(this._previousTimeout),ri||(ri=bn&&bn.politeness?bn.politeness:"polite"),null==Ee&&bn&&(Ee=bn.duration),this._liveElement.setAttribute("aria-live",ri),this._ngZone.runOutsideAngular(()=>new Promise(ee=>{clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=pt,ee(),"number"==typeof Ee&&(this._previousTimeout=setTimeout(()=>this.clear(),Ee))},100)}))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null}_createLiveElement(){const pt="cdk-live-announcer-element",Yt=this._document.getElementsByClassName(pt),bn=this._document.createElement("div");for(let ri=0;ri<Yt.length;ri++)Yt[ri].remove();return bn.classList.add(pt),bn.classList.add("cdk-visually-hidden"),bn.setAttribute("aria-atomic","true"),bn.setAttribute("aria-live","polite"),this._document.body.appendChild(bn),bn}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(te,8),_.LFG(_.R0b),_.LFG(w.K0),_.LFG(Ht,8))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})();const Oi=new _.OlP("cdk-focus-monitor-default-options"),xn=(0,kt.i$)({passive:!0,capture:!0});let Ji=(()=>{class Qt{constructor(pt,Yt,bn,ri,Ee){this._ngZone=pt,this._platform=Yt,this._inputModalityDetector=bn,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new pe.x,this._rootNodeFocusAndBlurListener=ee=>{const oe=(0,kt.sA)(ee),Me="focus"===ee.type?this._onFocus:this._onBlur;for(let Ve=oe;Ve;Ve=Ve.parentElement)Me.call(this,ee,Ve)},this._document=ri,this._detectionMode=Ee?.detectionMode||0}monitor(pt,Yt=!1){const bn=(0,Wt.fI)(pt);if(!this._platform.isBrowser||1!==bn.nodeType)return(0,ut.of)(null);const ri=(0,kt.kV)(bn)||this._getDocument(),Ee=this._elementInfo.get(bn);if(Ee)return Yt&&(Ee.checkChildren=!0),Ee.subject;const ee={checkChildren:Yt,subject:new pe.x,rootNode:ri};return this._elementInfo.set(bn,ee),this._registerGlobalListeners(ee),ee.subject}stopMonitoring(pt){const Yt=(0,Wt.fI)(pt),bn=this._elementInfo.get(Yt);bn&&(bn.subject.complete(),this._setClasses(Yt),this._elementInfo.delete(Yt),this._removeGlobalListeners(bn))}focusVia(pt,Yt,bn){const ri=(0,Wt.fI)(pt);ri===this._getDocument().activeElement?this._getClosestElementsInfo(ri).forEach(([ee,oe])=>this._originChanged(ee,Yt,oe)):(this._setOrigin(Yt),"function"==typeof ri.focus&&ri.focus(bn))}ngOnDestroy(){this._elementInfo.forEach((pt,Yt)=>this.stopMonitoring(Yt))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(pt){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(pt)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(pt){return 1===this._detectionMode||!!pt?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(pt,Yt){pt.classList.toggle("cdk-focused",!!Yt),pt.classList.toggle("cdk-touch-focused","touch"===Yt),pt.classList.toggle("cdk-keyboard-focused","keyboard"===Yt),pt.classList.toggle("cdk-mouse-focused","mouse"===Yt),pt.classList.toggle("cdk-program-focused","program"===Yt)}_setOrigin(pt,Yt=!1){this._ngZone.runOutsideAngular(()=>{this._origin=pt,this._originFromTouchInteraction="touch"===pt&&Yt,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(pt,Yt){const bn=this._elementInfo.get(Yt),ri=(0,kt.sA)(pt);!bn||!bn.checkChildren&&Yt!==ri||this._originChanged(Yt,this._getFocusOrigin(ri),bn)}_onBlur(pt,Yt){const bn=this._elementInfo.get(Yt);!bn||bn.checkChildren&&pt.relatedTarget instanceof Node&&Yt.contains(pt.relatedTarget)||(this._setClasses(Yt),this._emitOrigin(bn.subject,null))}_emitOrigin(pt,Yt){this._ngZone.run(()=>pt.next(Yt))}_registerGlobalListeners(pt){if(!this._platform.isBrowser)return;const Yt=pt.rootNode,bn=this._rootNodeFocusListenerCount.get(Yt)||0;bn||this._ngZone.runOutsideAngular(()=>{Yt.addEventListener("focus",this._rootNodeFocusAndBlurListener,xn),Yt.addEventListener("blur",this._rootNodeFocusAndBlurListener,xn)}),this._rootNodeFocusListenerCount.set(Yt,bn+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe((0,tt.R)(this._stopInputModalityDetector)).subscribe(ri=>{this._setOrigin(ri,!0)}))}_removeGlobalListeners(pt){const Yt=pt.rootNode;if(this._rootNodeFocusListenerCount.has(Yt)){const bn=this._rootNodeFocusListenerCount.get(Yt);bn>1?this._rootNodeFocusListenerCount.set(Yt,bn-1):(Yt.removeEventListener("focus",this._rootNodeFocusAndBlurListener,xn),Yt.removeEventListener("blur",this._rootNodeFocusAndBlurListener,xn),this._rootNodeFocusListenerCount.delete(Yt))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(pt,Yt,bn){this._setClasses(pt,Yt),this._emitOrigin(bn.subject,Yt),this._lastFocusOrigin=Yt}_getClosestElementsInfo(pt){const Yt=[];return this._elementInfo.forEach((bn,ri)=>{(ri===pt||bn.checkChildren&&ri.contains(pt))&&Yt.push([ri,bn])}),Yt}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(_.R0b),_.LFG(kt.t4),_.LFG(fe),_.LFG(w.K0,8),_.LFG(Oi,8))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})();const un="cdk-high-contrast-black-on-white",Pt="cdk-high-contrast-white-on-black",lt="cdk-high-contrast-active";let nn=(()=>{class Qt{constructor(pt,Yt){this._platform=pt,this._document=Yt}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const pt=this._document.createElement("div");pt.style.backgroundColor="rgb(1,2,3)",pt.style.position="absolute",this._document.body.appendChild(pt);const Yt=this._document.defaultView||window,bn=Yt&&Yt.getComputedStyle?Yt.getComputedStyle(pt):null,ri=(bn&&bn.backgroundColor||"").replace(/ /g,"");switch(pt.remove(),ri){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const pt=this._document.body.classList;pt.remove(lt),pt.remove(un),pt.remove(Pt),this._hasCheckedHighContrastMode=!0;const Yt=this.getHighContrastMode();1===Yt?(pt.add(lt),pt.add(un)):2===Yt&&(pt.add(lt),pt.add(Pt))}}}return Qt.\u0275fac=function(pt){return new(pt||Qt)(_.LFG(kt.t4),_.LFG(w.K0))},Qt.\u0275prov=_.Yz7({token:Qt,factory:Qt.\u0275fac,providedIn:"root"}),Qt})()},445:(ti,Vt,B)=>{"use strict";B.d(Vt,{Is:()=>de,vT:()=>it});var w=B(4650),_=B(6895);const pe=new w.OlP("cdk-dir-doc",{providedIn:"root",factory:function a(){return(0,w.f3M)(_.K0)}});let de=(()=>{class Le{constructor(rt){if(this.value="ltr",this.change=new w.vpe,rt){const Et=rt.documentElement?rt.documentElement.dir:null,dt=(rt.body?rt.body.dir:null)||Et;this.value="ltr"===dt||"rtl"===dt?dt:"ltr"}}ngOnDestroy(){this.change.complete()}}return Le.\u0275fac=function(rt){return new(rt||Le)(w.LFG(pe,8))},Le.\u0275prov=w.Yz7({token:Le,factory:Le.\u0275fac,providedIn:"root"}),Le})(),it=(()=>{class Le{}return Le.\u0275fac=function(rt){return new(rt||Le)},Le.\u0275mod=w.oAB({type:Le}),Le.\u0275inj=w.cJS({}),Le})()},1281:(ti,Vt,B)=>{"use strict";B.d(Vt,{Eq:()=>de,HM:()=>ut,Ig:()=>_,du:()=>Le,fI:()=>it,su:()=>pe});var w=B(4650);function _(ke){return null!=ke&&"false"!=`${ke}`}function pe(ke,rt=0){return function a(ke){return!isNaN(parseFloat(ke))&&!isNaN(Number(ke))}(ke)?Number(ke):rt}function de(ke){return Array.isArray(ke)?ke:[ke]}function ut(ke){return null==ke?"":"string"==typeof ke?ke:`${ke}px`}function it(ke){return ke instanceof w.SBq?ke.nativeElement:ke}function Le(ke,rt=/\s+/){const ft=[];if(null!=ke){const Et=Array.isArray(ke)?ke:`${ke}`.split(rt);for(const dt of Et){const wt=`${dt}`.trim();wt&&ft.push(wt)}}return ft}},5017:(ti,Vt,B)=>{"use strict";B.d(Vt,{A8:()=>rt,Ov:()=>Le});var w=B(7579),_=B(4650);class Le{constructor(dt=!1,wt,tt=!0){this._multiple=dt,this._emitChanges=tt,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new w.x,wt&&wt.length&&(dt?wt.forEach(Wt=>this._markSelected(Wt)):this._markSelected(wt[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...dt){this._verifyValueAssignment(dt),dt.forEach(wt=>this._markSelected(wt)),this._emitChangeEvent()}deselect(...dt){this._verifyValueAssignment(dt),dt.forEach(wt=>this._unmarkSelected(wt)),this._emitChangeEvent()}toggle(dt){this.isSelected(dt)?this.deselect(dt):this.select(dt)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(dt){return this._selection.has(dt)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(dt){this._multiple&&this.selected&&this._selected.sort(dt)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(dt){this.isSelected(dt)||(this._multiple||this._unmarkAll(),this._selection.add(dt),this._emitChanges&&this._selectedToEmit.push(dt))}_unmarkSelected(dt){this.isSelected(dt)&&(this._selection.delete(dt),this._emitChanges&&this._deselectedToEmit.push(dt))}_unmarkAll(){this.isEmpty()||this._selection.forEach(dt=>this._unmarkSelected(dt))}_verifyValueAssignment(dt){}}let rt=(()=>{class Et{constructor(){this._listeners=[]}notify(wt,tt){for(let Wt of this._listeners)Wt(wt,tt)}listen(wt){return this._listeners.push(wt),()=>{this._listeners=this._listeners.filter(tt=>wt!==tt)}}ngOnDestroy(){this._listeners=[]}}return Et.\u0275fac=function(wt){return new(wt||Et)},Et.\u0275prov=_.Yz7({token:Et,factory:Et.\u0275fac,providedIn:"root"}),Et})()},9521:(ti,Vt,B)=>{"use strict";B.d(Vt,{A:()=>Jn,JH:()=>Ln,JU:()=>ut,K5:()=>de,LH:()=>Qe,L_:()=>Et,MW:()=>Ht,Mf:()=>pe,SV:()=>Hn,Sd:()=>Wt,Vb:()=>hi,Z:()=>nt,aO:()=>ii,b2:()=>Fn,hY:()=>ft,jx:()=>it,oh:()=>kt,uR:()=>tt,xE:()=>zt,zL:()=>Le});const pe=9,de=13,ut=16,it=17,Le=18,ft=27,Et=32,tt=35,Wt=36,kt=37,Qe=38,Hn=39,Ln=40,zt=48,ii=57,Jn=65,nt=90,Ht=91,Fn=224;function hi(Ti,...mi){return mi.length?mi.some(Ki=>Ti[Ki]):Ti.altKey||Ti.shiftKey||Ti.ctrlKey||Ti.metaKey}},8184:(ti,Vt,B)=>{"use strict";B.d(Vt,{U8:()=>li,X_:()=>we,Xj:()=>Dn,aV:()=>ht});var w=B(8605),_=B(6895),pe=B(4650),a=B(1281),de=B(3353),ut=B(655),it=B(445),Le=B(4080),ke=B(7579),rt=B(727),ft=B(6451),Et=B(5698),dt=B(2722);const wt=(0,de.Mq)();class tt{constructor(ae,$e){this._viewportRuler=ae,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=$e}attach(){}enable(){if(this._canBeEnabled()){const ae=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=ae.style.left||"",this._previousHTMLStyles.top=ae.style.top||"",ae.style.left=(0,a.HM)(-this._previousScrollPosition.left),ae.style.top=(0,a.HM)(-this._previousScrollPosition.top),ae.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const ae=this._document.documentElement,Rt=ae.style,on=this._document.body.style,jt=Rt.scrollBehavior||"",Bt=on.scrollBehavior||"";this._isEnabled=!1,Rt.left=this._previousHTMLStyles.left,Rt.top=this._previousHTMLStyles.top,ae.classList.remove("cdk-global-scrollblock"),wt&&(Rt.scrollBehavior=on.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),wt&&(Rt.scrollBehavior=jt,on.scrollBehavior=Bt)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const $e=this._document.body,Rt=this._viewportRuler.getViewportSize();return $e.scrollHeight>Rt.height||$e.scrollWidth>Rt.width}}class kt{constructor(ae,$e,Rt,on){this._scrollDispatcher=ae,this._ngZone=$e,this._viewportRuler=Rt,this._config=on,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(ae){this._overlayRef=ae}enable(){if(this._scrollSubscription)return;const ae=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=ae.subscribe(()=>{const $e=this._viewportRuler.getViewportScrollPosition().top;Math.abs($e-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=ae.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Qe{enable(){}disable(){}attach(){}}function Hn(Mn,ae){return ae.some($e=>Mn.bottom<$e.top||Mn.top>$e.bottom||Mn.right<$e.left||Mn.left>$e.right)}function Ln(Mn,ae){return ae.some($e=>Mn.top<$e.top||Mn.bottom>$e.bottom||Mn.left<$e.left||Mn.right>$e.right)}class Ye{constructor(ae,$e,Rt,on){this._scrollDispatcher=ae,this._viewportRuler=$e,this._ngZone=Rt,this._config=on,this._scrollSubscription=null}attach(ae){this._overlayRef=ae}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const $e=this._overlayRef.overlayElement.getBoundingClientRect(),{width:Rt,height:on}=this._viewportRuler.getViewportSize();Hn($e,[{width:Rt,height:on,bottom:on,right:Rt,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Ce=(()=>{class Mn{constructor($e,Rt,on,jt){this._scrollDispatcher=$e,this._viewportRuler=Rt,this._ngZone=on,this.noop=()=>new Qe,this.close=Bt=>new kt(this._scrollDispatcher,this._ngZone,this._viewportRuler,Bt),this.block=()=>new tt(this._viewportRuler,this._document),this.reposition=Bt=>new Ye(this._scrollDispatcher,this._viewportRuler,this._ngZone,Bt),this._document=jt}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(w.mF),pe.LFG(w.rL),pe.LFG(pe.R0b),pe.LFG(_.K0))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})();class we{constructor(ae){if(this.scrollStrategy=new Qe,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,ae){const $e=Object.keys(ae);for(const Rt of $e)void 0!==ae[Rt]&&(this[Rt]=ae[Rt])}}}class At{constructor(ae,$e,Rt,on,jt){this.offsetX=Rt,this.offsetY=on,this.panelClass=jt,this.originX=ae.originX,this.originY=ae.originY,this.overlayX=$e.overlayX,this.overlayY=$e.overlayY}}class zt{}let Jt=(()=>{let Mn=class{constructor($e,Rt){this.connectionPair=$e,this.scrollableViewProperties=Rt}};return Mn=(0,ut.gn)([(0,ut.fM)(1,(0,pe.FiY)()),(0,ut.w6)("design:paramtypes",[At,zt])],Mn),Mn})(),Ne=(()=>{class Mn{constructor($e){this._attachedOverlays=[],this._document=$e}ngOnDestroy(){this.detach()}add($e){this.remove($e),this._attachedOverlays.push($e)}remove($e){const Rt=this._attachedOverlays.indexOf($e);Rt>-1&&this._attachedOverlays.splice(Rt,1),0===this._attachedOverlays.length&&this.detach()}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(_.K0))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),He=(()=>{class Mn extends Ne{constructor($e){super($e),this._keydownListener=Rt=>{const on=this._attachedOverlays;for(let jt=on.length-1;jt>-1;jt--)if(on[jt]._keydownEvents.observers.length>0){on[jt]._keydownEvents.next(Rt);break}}}add($e){super.add($e),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(_.K0))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),_t=(()=>{class Mn extends Ne{constructor($e,Rt){super($e),this._platform=Rt,this._cursorStyleIsSet=!1,this._pointerDownListener=on=>{this._pointerDownEventTarget=(0,de.sA)(on)},this._clickListener=on=>{const jt=(0,de.sA)(on),Bt="click"===on.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:jt;this._pointerDownEventTarget=null;const Je=this._attachedOverlays.slice();for(let ge=Je.length-1;ge>-1;ge--){const fe=Je[ge];if(!(fe._outsidePointerEvents.observers.length<1)&&fe.hasAttached()){if(fe.overlayElement.contains(jt)||fe.overlayElement.contains(Bt))break;fe._outsidePointerEvents.next(on)}}}}add($e){if(super.add($e),!this._isAttached){const Rt=this._document.body;Rt.addEventListener("pointerdown",this._pointerDownListener,!0),Rt.addEventListener("click",this._clickListener,!0),Rt.addEventListener("auxclick",this._clickListener,!0),Rt.addEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=Rt.style.cursor,Rt.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const $e=this._document.body;$e.removeEventListener("pointerdown",this._pointerDownListener,!0),$e.removeEventListener("click",this._clickListener,!0),$e.removeEventListener("auxclick",this._clickListener,!0),$e.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&($e.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(_.K0),pe.LFG(de.t4))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),Dn=(()=>{class Mn{constructor($e,Rt){this._platform=Rt,this._document=$e}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const $e="cdk-overlay-container";if(this._platform.isBrowser||(0,de.Oy)()){const on=this._document.querySelectorAll(`.${$e}[platform="server"], .${$e}[platform="test"]`);for(let jt=0;jt<on.length;jt++)on[jt].remove()}const Rt=this._document.createElement("div");Rt.classList.add($e),(0,de.Oy)()?Rt.setAttribute("platform","test"):this._platform.isBrowser||Rt.setAttribute("platform","server"),this._document.body.appendChild(Rt),this._containerElement=Rt}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(_.K0),pe.LFG(de.t4))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})();class Xt{constructor(ae,$e,Rt,on,jt,Bt,Je,ge,fe){this._portalOutlet=ae,this._host=$e,this._pane=Rt,this._config=on,this._ngZone=jt,this._keyboardDispatcher=Bt,this._document=Je,this._location=ge,this._outsideClickDispatcher=fe,this._backdropElement=null,this._backdropClick=new ke.x,this._attachments=new ke.x,this._detachments=new ke.x,this._locationChanges=rt.w0.EMPTY,this._backdropClickHandler=te=>this._backdropClick.next(te),this._keydownEvents=new ke.x,this._outsidePointerEvents=new ke.x,on.scrollStrategy&&(this._scrollStrategy=on.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=on.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(ae){let $e=this._portalOutlet.attach(ae);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe((0,Et.q)(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),$e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const ae=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),ae}dispose(){const ae=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,ae&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(ae){ae!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=ae,this.hasAttached()&&(ae.attach(this),this.updatePosition()))}updateSize(ae){this._config={...this._config,...ae},this._updateElementSize()}setDirection(ae){this._config={...this._config,direction:ae},this._updateElementDirection()}addPanelClass(ae){this._pane&&this._toggleClasses(this._pane,ae,!0)}removePanelClass(ae){this._pane&&this._toggleClasses(this._pane,ae,!1)}getDirection(){const ae=this._config.direction;return ae?"string"==typeof ae?ae:ae.value:"ltr"}updateScrollStrategy(ae){ae!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=ae,this.hasAttached()&&(ae.attach(this),ae.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const ae=this._pane.style;ae.width=(0,a.HM)(this._config.width),ae.height=(0,a.HM)(this._config.height),ae.minWidth=(0,a.HM)(this._config.minWidth),ae.minHeight=(0,a.HM)(this._config.minHeight),ae.maxWidth=(0,a.HM)(this._config.maxWidth),ae.maxHeight=(0,a.HM)(this._config.maxHeight)}_togglePointerEvents(ae){this._pane.style.pointerEvents=ae?"":"none"}_attachBackdrop(){const ae="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(ae)})}):this._backdropElement.classList.add(ae)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const ae=this._backdropElement;if(!ae)return;let $e;const Rt=()=>{ae&&(ae.removeEventListener("click",this._backdropClickHandler),ae.removeEventListener("transitionend",Rt),this._disposeBackdrop(ae)),this._config.backdropClass&&this._toggleClasses(ae,this._config.backdropClass,!1),clearTimeout($e)};ae.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{ae.addEventListener("transitionend",Rt)}),ae.style.pointerEvents="none",$e=this._ngZone.runOutsideAngular(()=>setTimeout(Rt,500))}_toggleClasses(ae,$e,Rt){const on=(0,a.Eq)($e||[]).filter(jt=>!!jt);on.length&&(Rt?ae.classList.add(...on):ae.classList.remove(...on))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const ae=this._ngZone.onStable.pipe((0,dt.R)((0,ft.T)(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),ae.unsubscribe())})})}_disposeScrollStrategy(){const ae=this._scrollStrategy;ae&&(ae.disable(),ae.detach&&ae.detach())}_disposeBackdrop(ae){ae&&(ae.remove(),this._backdropElement===ae&&(this._backdropElement=null))}}const ii="cdk-overlay-connected-position-bounding-box",vi=/([A-Za-z%]+)$/;class wi{constructor(ae,$e,Rt,on,jt){this._viewportRuler=$e,this._document=Rt,this._platform=on,this._overlayContainer=jt,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new ke.x,this._resizeSubscription=rt.w0.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(ae)}get positions(){return this._preferredPositions}attach(ae){this._validatePositions(),ae.hostElement.classList.add(ii),this._overlayRef=ae,this._boundingBox=ae.hostElement,this._pane=ae.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const ae=this._originRect,$e=this._overlayRect,Rt=this._viewportRect,on=[];let jt;for(let Bt of this._preferredPositions){let Je=this._getOriginPoint(ae,Bt),ge=this._getOverlayPoint(Je,$e,Bt),fe=this._getOverlayFit(ge,$e,Rt,Bt);if(fe.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(Bt,Je);this._canFitWithFlexibleDimensions(fe,ge,Rt)?on.push({position:Bt,origin:Je,overlayRect:$e,boundingBoxRect:this._calculateBoundingBoxRect(Je,Bt)}):(!jt||jt.overlayFit.visibleArea<fe.visibleArea)&&(jt={overlayFit:fe,overlayPoint:ge,originPoint:Je,position:Bt,overlayRect:$e})}if(on.length){let Bt=null,Je=-1;for(const ge of on){const fe=ge.boundingBoxRect.width*ge.boundingBoxRect.height*(ge.position.weight||1);fe>Je&&(Je=fe,Bt=ge)}return this._isPushed=!1,void this._applyPosition(Bt.position,Bt.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(jt.position,jt.originPoint);this._applyPosition(jt.position,jt.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Nn(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(ii),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const ae=this._lastPosition||this._preferredPositions[0],$e=this._getOriginPoint(this._originRect,ae);this._applyPosition(ae,$e)}}withScrollableContainers(ae){return this._scrollables=ae,this}withPositions(ae){return this._preferredPositions=ae,-1===ae.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(ae){return this._viewportMargin=ae,this}withFlexibleDimensions(ae=!0){return this._hasFlexibleDimensions=ae,this}withGrowAfterOpen(ae=!0){return this._growAfterOpen=ae,this}withPush(ae=!0){return this._canPush=ae,this}withLockedPosition(ae=!0){return this._positionLocked=ae,this}setOrigin(ae){return this._origin=ae,this}withDefaultOffsetX(ae){return this._offsetX=ae,this}withDefaultOffsetY(ae){return this._offsetY=ae,this}withTransformOriginOn(ae){return this._transformOriginSelector=ae,this}_getOriginPoint(ae,$e){let Rt,on;if("center"==$e.originX)Rt=ae.left+ae.width/2;else{const jt=this._isRtl()?ae.right:ae.left,Bt=this._isRtl()?ae.left:ae.right;Rt="start"==$e.originX?jt:Bt}return on="center"==$e.originY?ae.top+ae.height/2:"top"==$e.originY?ae.top:ae.bottom,{x:Rt,y:on}}_getOverlayPoint(ae,$e,Rt){let on,jt;return on="center"==Rt.overlayX?-$e.width/2:"start"===Rt.overlayX?this._isRtl()?-$e.width:0:this._isRtl()?0:-$e.width,jt="center"==Rt.overlayY?-$e.height/2:"top"==Rt.overlayY?0:-$e.height,{x:ae.x+on,y:ae.y+jt}}_getOverlayFit(ae,$e,Rt,on){const jt=Jn($e);let{x:Bt,y:Je}=ae,ge=this._getOffset(on,"x"),fe=this._getOffset(on,"y");ge&&(Bt+=ge),fe&&(Je+=fe);let Ht=0-Je,Rn=Je+jt.height-Rt.height,ni=this._subtractOverflows(jt.width,0-Bt,Bt+jt.width-Rt.width),Oi=this._subtractOverflows(jt.height,Ht,Rn),xn=ni*Oi;return{visibleArea:xn,isCompletelyWithinViewport:jt.width*jt.height===xn,fitsInViewportVertically:Oi===jt.height,fitsInViewportHorizontally:ni==jt.width}}_canFitWithFlexibleDimensions(ae,$e,Rt){if(this._hasFlexibleDimensions){const on=Rt.bottom-$e.y,jt=Rt.right-$e.x,Bt=Bi(this._overlayRef.getConfig().minHeight),Je=Bi(this._overlayRef.getConfig().minWidth),fe=ae.fitsInViewportHorizontally||null!=Je&&Je<=jt;return(ae.fitsInViewportVertically||null!=Bt&&Bt<=on)&&fe}return!1}_pushOverlayOnScreen(ae,$e,Rt){if(this._previousPushAmount&&this._positionLocked)return{x:ae.x+this._previousPushAmount.x,y:ae.y+this._previousPushAmount.y};const on=Jn($e),jt=this._viewportRect,Bt=Math.max(ae.x+on.width-jt.width,0),Je=Math.max(ae.y+on.height-jt.height,0),ge=Math.max(jt.top-Rt.top-ae.y,0),fe=Math.max(jt.left-Rt.left-ae.x,0);let te=0,nt=0;return te=on.width<=jt.width?fe||-Bt:ae.x<this._viewportMargin?jt.left-Rt.left-ae.x:0,nt=on.height<=jt.height?ge||-Je:ae.y<this._viewportMargin?jt.top-Rt.top-ae.y:0,this._previousPushAmount={x:te,y:nt},{x:ae.x+te,y:ae.y+nt}}_applyPosition(ae,$e){if(this._setTransformOrigin(ae),this._setOverlayElementStyles($e,ae),this._setBoundingBoxStyles($e,ae),ae.panelClass&&this._addPanelClasses(ae.panelClass),this._lastPosition=ae,this._positionChanges.observers.length){const Rt=this._getScrollVisibility(),on=new Jt(ae,Rt);this._positionChanges.next(on)}this._isInitialRender=!1}_setTransformOrigin(ae){if(!this._transformOriginSelector)return;const $e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let Rt,on=ae.overlayY;Rt="center"===ae.overlayX?"center":this._isRtl()?"start"===ae.overlayX?"right":"left":"start"===ae.overlayX?"left":"right";for(let jt=0;jt<$e.length;jt++)$e[jt].style.transformOrigin=`${Rt} ${on}`}_calculateBoundingBoxRect(ae,$e){const Rt=this._viewportRect,on=this._isRtl();let jt,Bt,Je,te,nt,Ht;if("top"===$e.overlayY)Bt=ae.y,jt=Rt.height-Bt+this._viewportMargin;else if("bottom"===$e.overlayY)Je=Rt.height-ae.y+2*this._viewportMargin,jt=Rt.height-Je+this._viewportMargin;else{const Rn=Math.min(Rt.bottom-ae.y+Rt.top,ae.y),ni=this._lastBoundingBoxSize.height;jt=2*Rn,Bt=ae.y-Rn,jt>ni&&!this._isInitialRender&&!this._growAfterOpen&&(Bt=ae.y-ni/2)}if("end"===$e.overlayX&&!on||"start"===$e.overlayX&&on)Ht=Rt.width-ae.x+this._viewportMargin,te=ae.x-this._viewportMargin;else if("start"===$e.overlayX&&!on||"end"===$e.overlayX&&on)nt=ae.x,te=Rt.right-ae.x;else{const Rn=Math.min(Rt.right-ae.x+Rt.left,ae.x),ni=this._lastBoundingBoxSize.width;te=2*Rn,nt=ae.x-Rn,te>ni&&!this._isInitialRender&&!this._growAfterOpen&&(nt=ae.x-ni/2)}return{top:Bt,left:nt,bottom:Je,right:Ht,width:te,height:jt}}_setBoundingBoxStyles(ae,$e){const Rt=this._calculateBoundingBoxRect(ae,$e);!this._isInitialRender&&!this._growAfterOpen&&(Rt.height=Math.min(Rt.height,this._lastBoundingBoxSize.height),Rt.width=Math.min(Rt.width,this._lastBoundingBoxSize.width));const on={};if(this._hasExactPosition())on.top=on.left="0",on.bottom=on.right=on.maxHeight=on.maxWidth="",on.width=on.height="100%";else{const jt=this._overlayRef.getConfig().maxHeight,Bt=this._overlayRef.getConfig().maxWidth;on.height=(0,a.HM)(Rt.height),on.top=(0,a.HM)(Rt.top),on.bottom=(0,a.HM)(Rt.bottom),on.width=(0,a.HM)(Rt.width),on.left=(0,a.HM)(Rt.left),on.right=(0,a.HM)(Rt.right),on.alignItems="center"===$e.overlayX?"center":"end"===$e.overlayX?"flex-end":"flex-start",on.justifyContent="center"===$e.overlayY?"center":"bottom"===$e.overlayY?"flex-end":"flex-start",jt&&(on.maxHeight=(0,a.HM)(jt)),Bt&&(on.maxWidth=(0,a.HM)(Bt))}this._lastBoundingBoxSize=Rt,Nn(this._boundingBox.style,on)}_resetBoundingBoxStyles(){Nn(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Nn(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(ae,$e){const Rt={},on=this._hasExactPosition(),jt=this._hasFlexibleDimensions,Bt=this._overlayRef.getConfig();if(on){const te=this._viewportRuler.getViewportScrollPosition();Nn(Rt,this._getExactOverlayY($e,ae,te)),Nn(Rt,this._getExactOverlayX($e,ae,te))}else Rt.position="static";let Je="",ge=this._getOffset($e,"x"),fe=this._getOffset($e,"y");ge&&(Je+=`translateX(${ge}px) `),fe&&(Je+=`translateY(${fe}px)`),Rt.transform=Je.trim(),Bt.maxHeight&&(on?Rt.maxHeight=(0,a.HM)(Bt.maxHeight):jt&&(Rt.maxHeight="")),Bt.maxWidth&&(on?Rt.maxWidth=(0,a.HM)(Bt.maxWidth):jt&&(Rt.maxWidth="")),Nn(this._pane.style,Rt)}_getExactOverlayY(ae,$e,Rt){let on={top:"",bottom:""},jt=this._getOverlayPoint($e,this._overlayRect,ae);this._isPushed&&(jt=this._pushOverlayOnScreen(jt,this._overlayRect,Rt));let Bt=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return jt.y-=Bt,"bottom"===ae.overlayY?on.bottom=this._document.documentElement.clientHeight-(jt.y+this._overlayRect.height)+"px":on.top=(0,a.HM)(jt.y),on}_getExactOverlayX(ae,$e,Rt){let Bt,on={left:"",right:""},jt=this._getOverlayPoint($e,this._overlayRect,ae);return this._isPushed&&(jt=this._pushOverlayOnScreen(jt,this._overlayRect,Rt)),Bt=this._isRtl()?"end"===ae.overlayX?"left":"right":"end"===ae.overlayX?"right":"left","right"===Bt?on.right=this._document.documentElement.clientWidth-(jt.x+this._overlayRect.width)+"px":on.left=(0,a.HM)(jt.x),on}_getScrollVisibility(){const ae=this._getOriginRect(),$e=this._pane.getBoundingClientRect(),Rt=this._scrollables.map(on=>on.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ln(ae,Rt),isOriginOutsideView:Hn(ae,Rt),isOverlayClipped:Ln($e,Rt),isOverlayOutsideView:Hn($e,Rt)}}_subtractOverflows(ae,...$e){return $e.reduce((Rt,on)=>Rt-Math.max(on,0),ae)}_getNarrowedViewportRect(){const ae=this._document.documentElement.clientWidth,$e=this._document.documentElement.clientHeight,Rt=this._viewportRuler.getViewportScrollPosition();return{top:Rt.top+this._viewportMargin,left:Rt.left+this._viewportMargin,right:Rt.left+ae-this._viewportMargin,bottom:Rt.top+$e-this._viewportMargin,width:ae-2*this._viewportMargin,height:$e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(ae,$e){return"x"===$e?ae.offsetX??this._offsetX:ae.offsetY??this._offsetY}_validatePositions(){}_addPanelClasses(ae){this._pane&&(0,a.Eq)(ae).forEach($e=>{""!==$e&&-1===this._appliedPanelClasses.indexOf($e)&&(this._appliedPanelClasses.push($e),this._pane.classList.add($e))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(ae=>{this._pane.classList.remove(ae)}),this._appliedPanelClasses=[])}_getOriginRect(){const ae=this._origin;if(ae instanceof pe.SBq)return ae.nativeElement.getBoundingClientRect();if(ae instanceof Element)return ae.getBoundingClientRect();const $e=ae.width||0,Rt=ae.height||0;return{top:ae.y,bottom:ae.y+Rt,left:ae.x,right:ae.x+$e,height:Rt,width:$e}}}function Nn(Mn,ae){for(let $e in ae)ae.hasOwnProperty($e)&&(Mn[$e]=ae[$e]);return Mn}function Bi(Mn){if("number"!=typeof Mn&&null!=Mn){const[ae,$e]=Mn.split(vi);return $e&&"px"!==$e?null:parseFloat(ae)}return Mn||null}function Jn(Mn){return{top:Math.floor(Mn.top),right:Math.floor(Mn.right),bottom:Math.floor(Mn.bottom),left:Math.floor(Mn.left),width:Math.floor(Mn.width),height:Math.floor(Mn.height)}}const fn="cdk-global-overlay-wrapper";class Tt{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(ae){const $e=ae.getConfig();this._overlayRef=ae,this._width&&!$e.width&&ae.updateSize({width:this._width}),this._height&&!$e.height&&ae.updateSize({height:this._height}),ae.hostElement.classList.add(fn),this._isDisposed=!1}top(ae=""){return this._bottomOffset="",this._topOffset=ae,this._alignItems="flex-start",this}left(ae=""){return this._rightOffset="",this._leftOffset=ae,this._justifyContent="flex-start",this}bottom(ae=""){return this._topOffset="",this._bottomOffset=ae,this._alignItems="flex-end",this}right(ae=""){return this._leftOffset="",this._rightOffset=ae,this._justifyContent="flex-end",this}width(ae=""){return this._overlayRef?this._overlayRef.updateSize({width:ae}):this._width=ae,this}height(ae=""){return this._overlayRef?this._overlayRef.updateSize({height:ae}):this._height=ae,this}centerHorizontally(ae=""){return this.left(ae),this._justifyContent="center",this}centerVertically(ae=""){return this.top(ae),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const ae=this._overlayRef.overlayElement.style,$e=this._overlayRef.hostElement.style,Rt=this._overlayRef.getConfig(),{width:on,height:jt,maxWidth:Bt,maxHeight:Je}=Rt,ge=!("100%"!==on&&"100vw"!==on||Bt&&"100%"!==Bt&&"100vw"!==Bt),fe=!("100%"!==jt&&"100vh"!==jt||Je&&"100%"!==Je&&"100vh"!==Je);ae.position=this._cssPosition,ae.marginLeft=ge?"0":this._leftOffset,ae.marginTop=fe?"0":this._topOffset,ae.marginBottom=this._bottomOffset,ae.marginRight=this._rightOffset,ge?$e.justifyContent="flex-start":"center"===this._justifyContent?$e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?$e.justifyContent="flex-end":"flex-end"===this._justifyContent&&($e.justifyContent="flex-start"):$e.justifyContent=this._justifyContent,$e.alignItems=fe?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const ae=this._overlayRef.overlayElement.style,$e=this._overlayRef.hostElement,Rt=$e.style;$e.classList.remove(fn),Rt.justifyContent=Rt.alignItems=ae.marginTop=ae.marginBottom=ae.marginLeft=ae.marginRight=ae.position="",this._overlayRef=null,this._isDisposed=!0}}let Ge=(()=>{class Mn{constructor($e,Rt,on,jt){this._viewportRuler=$e,this._document=Rt,this._platform=on,this._overlayContainer=jt}global(){return new Tt}flexibleConnectedTo($e){return new wi($e,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(w.rL),pe.LFG(_.K0),pe.LFG(de.t4),pe.LFG(Dn))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac,providedIn:"root"}),Mn})(),Fe=0,ht=(()=>{class Mn{constructor($e,Rt,on,jt,Bt,Je,ge,fe,te,nt,Ht){this.scrollStrategies=$e,this._overlayContainer=Rt,this._componentFactoryResolver=on,this._positionBuilder=jt,this._keyboardDispatcher=Bt,this._injector=Je,this._ngZone=ge,this._document=fe,this._directionality=te,this._location=nt,this._outsideClickDispatcher=Ht}create($e){const Rt=this._createHostElement(),on=this._createPaneElement(Rt),jt=this._createPortalOutlet(on),Bt=new we($e);return Bt.direction=Bt.direction||this._directionality.value,new Xt(jt,Rt,on,Bt,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement($e){const Rt=this._document.createElement("div");return Rt.id="cdk-overlay-"+Fe++,Rt.classList.add("cdk-overlay-pane"),$e.appendChild(Rt),Rt}_createHostElement(){const $e=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild($e),$e}_createPortalOutlet($e){return this._appRef||(this._appRef=this._injector.get(pe.z2F)),new Le.u0($e,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return Mn.\u0275fac=function($e){return new($e||Mn)(pe.LFG(Ce),pe.LFG(Dn),pe.LFG(pe._Vd),pe.LFG(Ge),pe.LFG(He),pe.LFG(pe.zs3),pe.LFG(pe.R0b),pe.LFG(_.K0),pe.LFG(it.Is),pe.LFG(_.Ye),pe.LFG(_t))},Mn.\u0275prov=pe.Yz7({token:Mn,factory:Mn.\u0275fac}),Mn})();const tn={provide:new pe.OlP("cdk-connected-overlay-scroll-strategy"),deps:[ht],useFactory:function St(Mn){return()=>Mn.scrollStrategies.reposition()}};let li=(()=>{class Mn{}return Mn.\u0275fac=function($e){return new($e||Mn)},Mn.\u0275mod=pe.oAB({type:Mn}),Mn.\u0275inj=pe.cJS({providers:[ht,tn],imports:[[it.vT,Le.eL,w.Cl],w.Cl]}),Mn})()},3353:(ti,Vt,B)=>{"use strict";B.d(Vt,{Mq:()=>wt,Oy:()=>Ce,_i:()=>tt,ht:()=>Hn,i$:()=>ft,kV:()=>Qe,qK:()=>Le,sA:()=>Ln,t4:()=>a,ud:()=>de});var w=B(4650),_=B(6895);let pe;try{pe=typeof Intl<"u"&&Intl.v8BreakIterator}catch{pe=!1}let ut,a=(()=>{class we{constructor(zt){this._platformId=zt,this.isBrowser=this._platformId?(0,_.NF)(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!pe)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return we.\u0275fac=function(zt){return new(zt||we)(w.LFG(w.Lbi))},we.\u0275prov=w.Yz7({token:we,factory:we.\u0275fac,providedIn:"root"}),we})(),de=(()=>{class we{}return we.\u0275fac=function(zt){return new(zt||we)},we.\u0275mod=w.oAB({type:we}),we.\u0275inj=w.cJS({}),we})();const it=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Le(){if(ut)return ut;if("object"!=typeof document||!document)return ut=new Set(it),ut;let we=document.createElement("input");return ut=new Set(it.filter(At=>(we.setAttribute("type",At),we.type===At))),ut}let ke,Et,dt,Wt,Ye;function ft(we){return function rt(){if(null==ke&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>ke=!0}))}finally{ke=ke||!1}return ke}()?we:!!we.capture}function wt(){if(null==dt){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return dt=!1,dt;if("scrollBehavior"in document.documentElement.style)dt=!0;else{const we=Element.prototype.scrollTo;dt=!!we&&!/\{\s*\[native code\]\s*\}/.test(we.toString())}}return dt}function tt(){if("object"!=typeof document||!document)return 0;if(null==Et){const we=document.createElement("div"),At=we.style;we.dir="rtl",At.width="1px",At.overflow="auto",At.visibility="hidden",At.pointerEvents="none",At.position="absolute";const zt=document.createElement("div"),Jt=zt.style;Jt.width="2px",Jt.height="1px",we.appendChild(zt),document.body.appendChild(we),Et=0,0===we.scrollLeft&&(we.scrollLeft=1,Et=0===we.scrollLeft?1:2),we.remove()}return Et}function Qe(we){if(function kt(){if(null==Wt){const we=typeof document<"u"?document.head:null;Wt=!(!we||!we.createShadowRoot&&!we.attachShadow)}return Wt}()){const At=we.getRootNode?we.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&At instanceof ShadowRoot)return At}return null}function Hn(){let we=typeof document<"u"&&document?document.activeElement:null;for(;we&&we.shadowRoot;){const At=we.shadowRoot.activeElement;if(At===we)break;we=At}return we}function Ln(we){return we.composedPath?we.composedPath()[0]:we.target}function Ce(){return typeof Ye.__karma__<"u"&&!!Ye.__karma__||typeof Ye.jasmine<"u"&&!!Ye.jasmine||typeof Ye.jest<"u"&&!!Ye.jest||typeof Ye.Mocha<"u"&&!!Ye.Mocha}Ye=typeof global<"u"?global:typeof window<"u"?window:{}},4080:(ti,Vt,B)=>{"use strict";B.d(Vt,{C5:()=>rt,Pl:()=>Hn,UE:()=>ft,eL:()=>Ye,en:()=>dt,u0:()=>tt});var w=B(4650),_=B(6895);class ke{attach(At){return this._attachedHost=At,At.attach(this)}detach(){let At=this._attachedHost;null!=At&&(this._attachedHost=null,At.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(At){this._attachedHost=At}}class rt extends ke{constructor(At,zt,Jt,Cn){super(),this.component=At,this.viewContainerRef=zt,this.injector=Jt,this.componentFactoryResolver=Cn}}class ft extends ke{constructor(At,zt,Jt){super(),this.templateRef=At,this.viewContainerRef=zt,this.context=Jt}get origin(){return this.templateRef.elementRef}attach(At,zt=this.context){return this.context=zt,super.attach(At)}detach(){return this.context=void 0,super.detach()}}class Et extends ke{constructor(At){super(),this.element=At instanceof w.SBq?At.nativeElement:At}}class dt{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(At){return At instanceof rt?(this._attachedPortal=At,this.attachComponentPortal(At)):At instanceof ft?(this._attachedPortal=At,this.attachTemplatePortal(At)):this.attachDomPortal&&At instanceof Et?(this._attachedPortal=At,this.attachDomPortal(At)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(At){this._disposeFn=At}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class tt extends dt{constructor(At,zt,Jt,Cn,Ke){super(),this.outletElement=At,this._componentFactoryResolver=zt,this._appRef=Jt,this._defaultInjector=Cn,this.attachDomPortal=Ne=>{const He=Ne.element,_t=this._document.createComment("dom-portal");He.parentNode.insertBefore(_t,He),this.outletElement.appendChild(He),this._attachedPortal=Ne,super.setDisposeFn(()=>{_t.parentNode&&_t.parentNode.replaceChild(He,_t)})},this._document=Ke}attachComponentPortal(At){const Jt=(At.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(At.component);let Cn;return At.viewContainerRef?(Cn=At.viewContainerRef.createComponent(Jt,At.viewContainerRef.length,At.injector||At.viewContainerRef.injector),this.setDisposeFn(()=>Cn.destroy())):(Cn=Jt.create(At.injector||this._defaultInjector),this._appRef.attachView(Cn.hostView),this.setDisposeFn(()=>{this._appRef.detachView(Cn.hostView),Cn.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(Cn)),this._attachedPortal=At,Cn}attachTemplatePortal(At){let zt=At.viewContainerRef,Jt=zt.createEmbeddedView(At.templateRef,At.context);return Jt.rootNodes.forEach(Cn=>this.outletElement.appendChild(Cn)),Jt.detectChanges(),this.setDisposeFn(()=>{let Cn=zt.indexOf(Jt);-1!==Cn&&zt.remove(Cn)}),this._attachedPortal=At,Jt}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(At){return At.hostView.rootNodes[0]}}let Hn=(()=>{class we extends dt{constructor(zt,Jt,Cn){super(),this._componentFactoryResolver=zt,this._viewContainerRef=Jt,this._isInitialized=!1,this.attached=new w.vpe,this.attachDomPortal=Ke=>{const Ne=Ke.element,He=this._document.createComment("dom-portal");Ke.setAttachedHost(this),Ne.parentNode.insertBefore(He,Ne),this._getRootNode().appendChild(Ne),this._attachedPortal=Ke,super.setDisposeFn(()=>{He.parentNode&&He.parentNode.replaceChild(Ne,He)})},this._document=Cn}get portal(){return this._attachedPortal}set portal(zt){this.hasAttached()&&!zt&&!this._isInitialized||(this.hasAttached()&&super.detach(),zt&&super.attach(zt),this._attachedPortal=zt)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(zt){zt.setAttachedHost(this);const Jt=null!=zt.viewContainerRef?zt.viewContainerRef:this._viewContainerRef,Ke=(zt.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(zt.component),Ne=Jt.createComponent(Ke,Jt.length,zt.injector||Jt.injector);return Jt!==this._viewContainerRef&&this._getRootNode().appendChild(Ne.hostView.rootNodes[0]),super.setDisposeFn(()=>Ne.destroy()),this._attachedPortal=zt,this._attachedRef=Ne,this.attached.emit(Ne),Ne}attachTemplatePortal(zt){zt.setAttachedHost(this);const Jt=this._viewContainerRef.createEmbeddedView(zt.templateRef,zt.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=zt,this._attachedRef=Jt,this.attached.emit(Jt),Jt}_getRootNode(){const zt=this._viewContainerRef.element.nativeElement;return zt.nodeType===zt.ELEMENT_NODE?zt:zt.parentNode}}return we.\u0275fac=function(zt){return new(zt||we)(w.Y36(w._Vd),w.Y36(w.s_b),w.Y36(_.K0))},we.\u0275dir=w.lG2({type:we,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[w.qOj]}),we})(),Ye=(()=>{class we{}return we.\u0275fac=function(zt){return new(zt||we)},we.\u0275mod=w.oAB({type:we}),we.\u0275inj=w.cJS({}),we})()},8605:(ti,Vt,B)=>{"use strict";B.d(Vt,{PQ:()=>Se,ZD:()=>Rt,mF:()=>ot,Cl:()=>on,rL:()=>tn});var w=B(1281),_=B(4650),pe=B(7579),a=B(9646),de=B(9751),ut=B(4968),it=B(4408),Le=B(727);const ke={schedule(jt){let Bt=requestAnimationFrame,Je=cancelAnimationFrame;const{delegate:ge}=ke;ge&&(Bt=ge.requestAnimationFrame,Je=ge.cancelAnimationFrame);const fe=Bt(te=>{Je=void 0,jt(te)});return new Le.w0(()=>Je?.(fe))},requestAnimationFrame(...jt){const{delegate:Bt}=ke;return(Bt?.requestAnimationFrame||requestAnimationFrame)(...jt)},cancelAnimationFrame(...jt){const{delegate:Bt}=ke;return(Bt?.cancelAnimationFrame||cancelAnimationFrame)(...jt)},delegate:void 0};var ft=B(640);new class Et extends ft.v{flush(Bt){this._active=!0;const Je=this._scheduled;this._scheduled=void 0;const{actions:ge}=this;let fe;Bt=Bt||ge.shift();do{if(fe=Bt.execute(Bt.state,Bt.delay))break}while((Bt=ge[0])&&Bt.id===Je&&ge.shift());if(this._active=!1,fe){for(;(Bt=ge[0])&&Bt.id===Je&&ge.shift();)Bt.unsubscribe();throw fe}}}(class rt extends it.o{constructor(Bt,Je){super(Bt,Je),this.scheduler=Bt,this.work=Je}requestAsyncId(Bt,Je,ge=0){return null!==ge&&ge>0?super.requestAsyncId(Bt,Je,ge):(Bt.actions.push(this),Bt._scheduled||(Bt._scheduled=ke.requestAnimationFrame(()=>Bt.flush(void 0))))}recycleAsyncId(Bt,Je,ge=0){var fe;if(null!=ge?ge>0:this.delay>0)return super.recycleAsyncId(Bt,Je,ge);const{actions:te}=Bt;null!=Je&&(null===(fe=te[te.length-1])||void 0===fe?void 0:fe.id)!==Je&&(ke.cancelAnimationFrame(Je),Bt._scheduled=void 0)}});let Wt,tt=1;const kt={};function Qe(jt){return jt in kt&&(delete kt[jt],!0)}const Hn={setImmediate(jt){const Bt=tt++;return kt[Bt]=!0,Wt||(Wt=Promise.resolve()),Wt.then(()=>Qe(Bt)&&jt()),Bt},clearImmediate(jt){Qe(jt)}},{setImmediate:Ye,clearImmediate:Ce}=Hn,we={setImmediate(...jt){const{delegate:Bt}=we;return(Bt?.setImmediate||Ye)(...jt)},clearImmediate(jt){const{delegate:Bt}=we;return(Bt?.clearImmediate||Ce)(jt)},delegate:void 0};new class zt extends ft.v{flush(Bt){this._active=!0;const Je=this._scheduled;this._scheduled=void 0;const{actions:ge}=this;let fe;Bt=Bt||ge.shift();do{if(fe=Bt.execute(Bt.state,Bt.delay))break}while((Bt=ge[0])&&Bt.id===Je&&ge.shift());if(this._active=!1,fe){for(;(Bt=ge[0])&&Bt.id===Je&&ge.shift();)Bt.unsubscribe();throw fe}}}(class At extends it.o{constructor(Bt,Je){super(Bt,Je),this.scheduler=Bt,this.work=Je}requestAsyncId(Bt,Je,ge=0){return null!==ge&&ge>0?super.requestAsyncId(Bt,Je,ge):(Bt.actions.push(this),Bt._scheduled||(Bt._scheduled=we.setImmediate(Bt.flush.bind(Bt,void 0))))}recycleAsyncId(Bt,Je,ge=0){var fe;if(null!=ge?ge>0:this.delay>0)return super.recycleAsyncId(Bt,Je,ge);const{actions:te}=Bt;null!=Je&&(null===(fe=te[te.length-1])||void 0===fe?void 0:fe.id)!==Je&&(we.clearImmediate(Je),Bt._scheduled=void 0)}});var Ke=B(4986),Ne=B(4482),He=B(8421),_t=B(5403),Xt=B(5963);function ii(jt,Bt=Ke.z){return function Dn(jt){return(0,Ne.e)((Bt,Je)=>{let ge=!1,fe=null,te=null,nt=!1;const Ht=()=>{if(te?.unsubscribe(),te=null,ge){ge=!1;const ni=fe;fe=null,Je.next(ni)}nt&&Je.complete()},Rn=()=>{te=null,nt&&Je.complete()};Bt.subscribe((0,_t.x)(Je,ni=>{ge=!0,fe=ni,te||(0,He.Xf)(jt(ni)).subscribe(te=(0,_t.x)(Je,Ht,Rn))},()=>{nt=!0,(!ge||!te||te.closed)&&Je.complete()}))})}(()=>(0,Xt.H)(jt,Bt))}var vi=B(9300),wi=B(2722),Nn=B(3353),Bi=B(6895),Jn=B(445);let ot=(()=>{class jt{constructor(Je,ge,fe){this._ngZone=Je,this._platform=ge,this._scrolled=new pe.x,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=fe}register(Je){this.scrollContainers.has(Je)||this.scrollContainers.set(Je,Je.elementScrolled().subscribe(()=>this._scrolled.next(Je)))}deregister(Je){const ge=this.scrollContainers.get(Je);ge&&(ge.unsubscribe(),this.scrollContainers.delete(Je))}scrolled(Je=20){return this._platform.isBrowser?new de.y(ge=>{this._globalSubscription||this._addGlobalListener();const fe=Je>0?this._scrolled.pipe(ii(Je)).subscribe(ge):this._scrolled.subscribe(ge);return this._scrolledCount++,()=>{fe.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):(0,a.of)()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((Je,ge)=>this.deregister(ge)),this._scrolled.complete()}ancestorScrolled(Je,ge){const fe=this.getAncestorScrollContainers(Je);return this.scrolled(ge).pipe((0,vi.h)(te=>!te||fe.indexOf(te)>-1))}getAncestorScrollContainers(Je){const ge=[];return this.scrollContainers.forEach((fe,te)=>{this._scrollableContainsElement(te,Je)&&ge.push(te)}),ge}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(Je,ge){let fe=(0,w.fI)(ge),te=Je.getElementRef().nativeElement;do{if(fe==te)return!0}while(fe=fe.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{const Je=this._getWindow();return(0,ut.R)(Je.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return jt.\u0275fac=function(Je){return new(Je||jt)(_.LFG(_.R0b),_.LFG(Nn.t4),_.LFG(Bi.K0,8))},jt.\u0275prov=_.Yz7({token:jt,factory:jt.\u0275fac,providedIn:"root"}),jt})(),Se=(()=>{class jt{constructor(Je,ge,fe,te){this.elementRef=Je,this.scrollDispatcher=ge,this.ngZone=fe,this.dir=te,this._destroyed=new pe.x,this._elementScrolled=new de.y(nt=>this.ngZone.runOutsideAngular(()=>(0,ut.R)(this.elementRef.nativeElement,"scroll").pipe((0,wi.R)(this._destroyed)).subscribe(nt)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(Je){const ge=this.elementRef.nativeElement,fe=this.dir&&"rtl"==this.dir.value;null==Je.left&&(Je.left=fe?Je.end:Je.start),null==Je.right&&(Je.right=fe?Je.start:Je.end),null!=Je.bottom&&(Je.top=ge.scrollHeight-ge.clientHeight-Je.bottom),fe&&0!=(0,Nn._i)()?(null!=Je.left&&(Je.right=ge.scrollWidth-ge.clientWidth-Je.left),2==(0,Nn._i)()?Je.left=Je.right:1==(0,Nn._i)()&&(Je.left=Je.right?-Je.right:Je.right)):null!=Je.right&&(Je.left=ge.scrollWidth-ge.clientWidth-Je.right),this._applyScrollToOptions(Je)}_applyScrollToOptions(Je){const ge=this.elementRef.nativeElement;(0,Nn.Mq)()?ge.scrollTo(Je):(null!=Je.top&&(ge.scrollTop=Je.top),null!=Je.left&&(ge.scrollLeft=Je.left))}measureScrollOffset(Je){const ge="left",te=this.elementRef.nativeElement;if("top"==Je)return te.scrollTop;if("bottom"==Je)return te.scrollHeight-te.clientHeight-te.scrollTop;const nt=this.dir&&"rtl"==this.dir.value;return"start"==Je?Je=nt?"right":ge:"end"==Je&&(Je=nt?ge:"right"),nt&&2==(0,Nn._i)()?Je==ge?te.scrollWidth-te.clientWidth-te.scrollLeft:te.scrollLeft:nt&&1==(0,Nn._i)()?Je==ge?te.scrollLeft+te.scrollWidth-te.clientWidth:-te.scrollLeft:Je==ge?te.scrollLeft:te.scrollWidth-te.clientWidth-te.scrollLeft}}return jt.\u0275fac=function(Je){return new(Je||jt)(_.Y36(_.SBq),_.Y36(ot),_.Y36(_.R0b),_.Y36(Jn.Is,8))},jt.\u0275dir=_.lG2({type:jt,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),jt})(),tn=(()=>{class jt{constructor(Je,ge,fe){this._platform=Je,this._change=new pe.x,this._changeListener=te=>{this._change.next(te)},this._document=fe,ge.runOutsideAngular(()=>{if(Je.isBrowser){const te=this._getWindow();te.addEventListener("resize",this._changeListener),te.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const Je=this._getWindow();Je.removeEventListener("resize",this._changeListener),Je.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const Je={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),Je}getViewportRect(){const Je=this.getViewportScrollPosition(),{width:ge,height:fe}=this.getViewportSize();return{top:Je.top,left:Je.left,bottom:Je.top+fe,right:Je.left+ge,height:fe,width:ge}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const Je=this._document,ge=this._getWindow(),fe=Je.documentElement,te=fe.getBoundingClientRect();return{top:-te.top||Je.body.scrollTop||ge.scrollY||fe.scrollTop||0,left:-te.left||Je.body.scrollLeft||ge.scrollX||fe.scrollLeft||0}}change(Je=20){return Je>0?this._change.pipe(ii(Je)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const Je=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:Je.innerWidth,height:Je.innerHeight}:{width:0,height:0}}}return jt.\u0275fac=function(Je){return new(Je||jt)(_.LFG(Nn.t4),_.LFG(_.R0b),_.LFG(Bi.K0,8))},jt.\u0275prov=_.Yz7({token:jt,factory:jt.\u0275fac,providedIn:"root"}),jt})(),Rt=(()=>{class jt{}return jt.\u0275fac=function(Je){return new(Je||jt)},jt.\u0275mod=_.oAB({type:jt}),jt.\u0275inj=_.cJS({}),jt})(),on=(()=>{class jt{}return jt.\u0275fac=function(Je){return new(Je||jt)},jt.\u0275mod=_.oAB({type:jt}),jt.\u0275inj=_.cJS({imports:[[Jn.vT,Nn.ud,Rt],Jn.vT,Rt]}),jt})()},6895:(ti,Vt,B)=>{"use strict";B.d(Vt,{Do:()=>Ln,EM:()=>ml,HT:()=>de,JF:()=>Ys,K0:()=>it,Mx:()=>wa,NF:()=>ha,O5:()=>Ti,RF:()=>to,S$:()=>kt,V_:()=>rt,Ye:()=>Ye,b0:()=>Hn,bD:()=>rs,ez:()=>il,mk:()=>Yi,n9:()=>Br,q:()=>pe,rS:()=>Qr,sg:()=>Gt,w_:()=>ut});var w=B(4650);let _=null;function pe(){return _}function de(z){_||(_=z)}class ut{}const it=new w.OlP("DocumentToken");let Le=(()=>{class z{historyGo(G){throw new Error("Not implemented")}}return z.\u0275fac=function(G){return new(G||z)},z.\u0275prov=w.Yz7({token:z,factory:function(){return function ke(){return(0,w.LFG)(ft)}()},providedIn:"platform"}),z})();const rt=new w.OlP("Location Initialized");let ft=(()=>{class z extends Le{constructor(G){super(),this._doc=G,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return pe().getBaseHref(this._doc)}onPopState(G){const ye=pe().getGlobalEventTarget(this._doc,"window");return ye.addEventListener("popstate",G,!1),()=>ye.removeEventListener("popstate",G)}onHashChange(G){const ye=pe().getGlobalEventTarget(this._doc,"window");return ye.addEventListener("hashchange",G,!1),()=>ye.removeEventListener("hashchange",G)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(G){this.location.pathname=G}pushState(G,ye,yt){Et()?this._history.pushState(G,ye,yt):this.location.hash=yt}replaceState(G,ye,yt){Et()?this._history.replaceState(G,ye,yt):this.location.hash=yt}forward(){this._history.forward()}back(){this._history.back()}historyGo(G=0){this._history.go(G)}getState(){return this._history.state}}return z.\u0275fac=function(G){return new(G||z)(w.LFG(it))},z.\u0275prov=w.Yz7({token:z,factory:function(){return function dt(){return new ft((0,w.LFG)(it))}()},providedIn:"platform"}),z})();function Et(){return!!window.history.pushState}function wt(z,re){if(0==z.length)return re;if(0==re.length)return z;let G=0;return z.endsWith("/")&&G++,re.startsWith("/")&&G++,2==G?z+re.substring(1):1==G?z+re:z+"/"+re}function tt(z){const re=z.match(/#|\?|$/),G=re&&re.index||z.length;return z.slice(0,G-("/"===z[G-1]?1:0))+z.slice(G)}function Wt(z){return z&&"?"!==z[0]?"?"+z:z}let kt=(()=>{class z{historyGo(G){throw new Error("Not implemented")}}return z.\u0275fac=function(G){return new(G||z)},z.\u0275prov=w.Yz7({token:z,factory:function(){return(0,w.f3M)(Hn)},providedIn:"root"}),z})();const Qe=new w.OlP("appBaseHref");let Hn=(()=>{class z extends kt{constructor(G,ye){super(),this._platformLocation=G,this._removeListenerFns=[],this._baseHref=ye??this._platformLocation.getBaseHrefFromDOM()??(0,w.f3M)(it).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(G){this._removeListenerFns.push(this._platformLocation.onPopState(G),this._platformLocation.onHashChange(G))}getBaseHref(){return this._baseHref}prepareExternalUrl(G){return wt(this._baseHref,G)}path(G=!1){const ye=this._platformLocation.pathname+Wt(this._platformLocation.search),yt=this._platformLocation.hash;return yt&&G?`${ye}${yt}`:ye}pushState(G,ye,yt,vn){const On=this.prepareExternalUrl(yt+Wt(vn));this._platformLocation.pushState(G,ye,On)}replaceState(G,ye,yt,vn){const On=this.prepareExternalUrl(yt+Wt(vn));this._platformLocation.replaceState(G,ye,On)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(G=0){this._platformLocation.historyGo?.(G)}}return z.\u0275fac=function(G){return new(G||z)(w.LFG(Le),w.LFG(Qe,8))},z.\u0275prov=w.Yz7({token:z,factory:z.\u0275fac,providedIn:"root"}),z})(),Ln=(()=>{class z extends kt{constructor(G,ye){super(),this._platformLocation=G,this._baseHref="",this._removeListenerFns=[],null!=ye&&(this._baseHref=ye)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(G){this._removeListenerFns.push(this._platformLocation.onPopState(G),this._platformLocation.onHashChange(G))}getBaseHref(){return this._baseHref}path(G=!1){let ye=this._platformLocation.hash;return null==ye&&(ye="#"),ye.length>0?ye.substring(1):ye}prepareExternalUrl(G){const ye=wt(this._baseHref,G);return ye.length>0?"#"+ye:ye}pushState(G,ye,yt,vn){let On=this.prepareExternalUrl(yt+Wt(vn));0==On.length&&(On=this._platformLocation.pathname),this._platformLocation.pushState(G,ye,On)}replaceState(G,ye,yt,vn){let On=this.prepareExternalUrl(yt+Wt(vn));0==On.length&&(On=this._platformLocation.pathname),this._platformLocation.replaceState(G,ye,On)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(G=0){this._platformLocation.historyGo?.(G)}}return z.\u0275fac=function(G){return new(G||z)(w.LFG(Le),w.LFG(Qe,8))},z.\u0275prov=w.Yz7({token:z,factory:z.\u0275fac}),z})(),Ye=(()=>{class z{constructor(G){this._subject=new w.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=G;const ye=this._locationStrategy.getBaseHref();this._baseHref=tt(At(ye)),this._locationStrategy.onPopState(yt=>{this._subject.emit({url:this.path(!0),pop:!0,state:yt.state,type:yt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(G=!1){return this.normalize(this._locationStrategy.path(G))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(G,ye=""){return this.path()==this.normalize(G+Wt(ye))}normalize(G){return z.stripTrailingSlash(function we(z,re){return z&&re.startsWith(z)?re.substring(z.length):re}(this._baseHref,At(G)))}prepareExternalUrl(G){return G&&"/"!==G[0]&&(G="/"+G),this._locationStrategy.prepareExternalUrl(G)}go(G,ye="",yt=null){this._locationStrategy.pushState(yt,"",G,ye),this._notifyUrlChangeListeners(this.prepareExternalUrl(G+Wt(ye)),yt)}replaceState(G,ye="",yt=null){this._locationStrategy.replaceState(yt,"",G,ye),this._notifyUrlChangeListeners(this.prepareExternalUrl(G+Wt(ye)),yt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(G=0){this._locationStrategy.historyGo?.(G)}onUrlChange(G){return this._urlChangeListeners.push(G),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(ye=>{this._notifyUrlChangeListeners(ye.url,ye.state)})),()=>{const ye=this._urlChangeListeners.indexOf(G);this._urlChangeListeners.splice(ye,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(G="",ye){this._urlChangeListeners.forEach(yt=>yt(G,ye))}subscribe(G,ye,yt){return this._subject.subscribe({next:G,error:ye,complete:yt})}}return z.normalizeQueryParams=Wt,z.joinWithSlash=wt,z.stripTrailingSlash=tt,z.\u0275fac=function(G){return new(G||z)(w.LFG(kt))},z.\u0275prov=w.Yz7({token:z,factory:function(){return function Ce(){return new Ye((0,w.LFG)(kt))}()},providedIn:"root"}),z})();function At(z){return z.replace(/\/index.html$/,"")}function wa(z,re){re=encodeURIComponent(re);for(const G of z.split(";")){const ye=G.indexOf("="),[yt,vn]=-1==ye?[G,""]:[G.slice(0,ye),G.slice(ye+1)];if(yt.trim()===re)return decodeURIComponent(vn)}return null}let Yi=(()=>{class z{constructor(G,ye,yt,vn){this._iterableDiffers=G,this._keyValueDiffers=ye,this._ngEl=yt,this._renderer=vn,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(G){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof G?G.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(G){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof G?G.split(/\s+/):G,this._rawClass&&((0,w.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const G=this._iterableDiffer.diff(this._rawClass);G&&this._applyIterableChanges(G)}else if(this._keyValueDiffer){const G=this._keyValueDiffer.diff(this._rawClass);G&&this._applyKeyValueChanges(G)}}_applyKeyValueChanges(G){G.forEachAddedItem(ye=>this._toggleClass(ye.key,ye.currentValue)),G.forEachChangedItem(ye=>this._toggleClass(ye.key,ye.currentValue)),G.forEachRemovedItem(ye=>{ye.previousValue&&this._toggleClass(ye.key,!1)})}_applyIterableChanges(G){G.forEachAddedItem(ye=>{if("string"!=typeof ye.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,w.AaK)(ye.item)}`);this._toggleClass(ye.item,!0)}),G.forEachRemovedItem(ye=>this._toggleClass(ye.item,!1))}_applyClasses(G){G&&(Array.isArray(G)||G instanceof Set?G.forEach(ye=>this._toggleClass(ye,!0)):Object.keys(G).forEach(ye=>this._toggleClass(ye,!!G[ye])))}_removeClasses(G){G&&(Array.isArray(G)||G instanceof Set?G.forEach(ye=>this._toggleClass(ye,!1)):Object.keys(G).forEach(ye=>this._toggleClass(ye,!1)))}_toggleClass(G,ye){(G=G.trim())&&G.split(/\s+/g).forEach(yt=>{ye?this._renderer.addClass(this._ngEl.nativeElement,yt):this._renderer.removeClass(this._ngEl.nativeElement,yt)})}}return z.\u0275fac=function(G){return new(G||z)(w.Y36(w.ZZ4),w.Y36(w.aQg),w.Y36(w.SBq),w.Y36(w.Qsj))},z.\u0275dir=w.lG2({type:z,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),z})();class Ie{constructor(re,G,ye,yt){this.$implicit=re,this.ngForOf=G,this.index=ye,this.count=yt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Gt=(()=>{class z{constructor(G,ye,yt){this._viewContainer=G,this._template=ye,this._differs=yt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(G){this._ngForOf=G,this._ngForOfDirty=!0}set ngForTrackBy(G){this._trackByFn=G}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(G){G&&(this._template=G)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const G=this._ngForOf;!this._differ&&G&&(this._differ=this._differs.find(G).create(this.ngForTrackBy))}if(this._differ){const G=this._differ.diff(this._ngForOf);G&&this._applyChanges(G)}}_applyChanges(G){const ye=this._viewContainer;G.forEachOperation((yt,vn,On)=>{if(null==yt.previousIndex)ye.createEmbeddedView(this._template,new Ie(yt.item,this._ngForOf,-1,-1),null===On?void 0:On);else if(null==On)ye.remove(null===vn?void 0:vn);else if(null!==vn){const yi=ye.get(vn);ye.move(yi,On),Fn(yi,yt)}});for(let yt=0,vn=ye.length;yt<vn;yt++){const yi=ye.get(yt).context;yi.index=yt,yi.count=vn,yi.ngForOf=this._ngForOf}G.forEachIdentityChange(yt=>{Fn(ye.get(yt.currentIndex),yt)})}static ngTemplateContextGuard(G,ye){return!0}}return z.\u0275fac=function(G){return new(G||z)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(w.ZZ4))},z.\u0275dir=w.lG2({type:z,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),z})();function Fn(z,re){z.context.$implicit=re.item}let Ti=(()=>{class z{constructor(G,ye){this._viewContainer=G,this._context=new mi,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=ye}set ngIf(G){this._context.$implicit=this._context.ngIf=G,this._updateView()}set ngIfThen(G){Ki("ngIfThen",G),this._thenTemplateRef=G,this._thenViewRef=null,this._updateView()}set ngIfElse(G){Ki("ngIfElse",G),this._elseTemplateRef=G,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(G,ye){return!0}}return z.\u0275fac=function(G){return new(G||z)(w.Y36(w.s_b),w.Y36(w.Rgc))},z.\u0275dir=w.lG2({type:z,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),z})();class mi{constructor(){this.$implicit=null,this.ngIf=null}}function Ki(z,re){if(re&&!re.createEmbeddedView)throw new Error(`${z} must be a TemplateRef, but received '${(0,w.AaK)(re)}'.`)}class vr{constructor(re,G){this._viewContainerRef=re,this._templateRef=G,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(re){re&&!this._created?this.create():!re&&this._created&&this.destroy()}}let to=(()=>{class z{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(G){this._ngSwitch=G,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(G){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(G)}_matchCase(G){const ye=G==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||ye,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),ye}_updateDefaultCases(G){if(this._defaultViews&&G!==this._defaultUsed){this._defaultUsed=G;for(let ye=0;ye<this._defaultViews.length;ye++)this._defaultViews[ye].enforceState(G)}}}return z.\u0275fac=function(G){return new(G||z)},z.\u0275dir=w.lG2({type:z,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),z})(),Br=(()=>{class z{constructor(G,ye,yt){this.ngSwitch=yt,yt._addCase(),this._view=new vr(G,ye)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return z.\u0275fac=function(G){return new(G||z)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(to,9))},z.\u0275dir=w.lG2({type:z,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),z})();const Ea=/(?:[0-9A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF40\uDF42-\uDF49\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])\S*/g;let Qr=(()=>{class z{transform(G){if(null==G)return null;if("string"!=typeof G)throw function Eo(z,re){return new w.vHH(2100,!1)}();return G.replace(Ea,ye=>ye[0].toUpperCase()+ye.slice(1).toLowerCase())}}return z.\u0275fac=function(G){return new(G||z)},z.\u0275pipe=w.Yjl({name:"titlecase",type:z,pure:!0,standalone:!0}),z})(),il=(()=>{class z{}return z.\u0275fac=function(G){return new(G||z)},z.\u0275mod=w.oAB({type:z}),z.\u0275inj=w.cJS({}),z})();const rs="browser";function ha(z){return z===rs}let ml=(()=>{class z{}return z.\u0275prov=(0,w.Yz7)({token:z,providedIn:"root",factory:()=>new Fo((0,w.LFG)(it),window)}),z})();class Fo{constructor(re,G){this.document=re,this.window=G,this.offset=()=>[0,0]}setOffset(re){this.offset=Array.isArray(re)?()=>re:re}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(re){this.supportsScrolling()&&this.window.scrollTo(re[0],re[1])}scrollToAnchor(re){if(!this.supportsScrolling())return;const G=function go(z,re){const G=z.getElementById(re)||z.getElementsByName(re)[0];if(G)return G;if("function"==typeof z.createTreeWalker&&z.body&&(z.body.createShadowRoot||z.body.attachShadow)){const ye=z.createTreeWalker(z.body,NodeFilter.SHOW_ELEMENT);let yt=ye.currentNode;for(;yt;){const vn=yt.shadowRoot;if(vn){const On=vn.getElementById(re)||vn.querySelector(`[name="${re}"]`);if(On)return On}yt=ye.nextNode()}}return null}(this.document,re);G&&(this.scrollToElement(G),G.focus())}setHistoryScrollRestoration(re){if(this.supportScrollRestoration()){const G=this.window.history;G&&G.scrollRestoration&&(G.scrollRestoration=re)}}scrollToElement(re){const G=re.getBoundingClientRect(),ye=G.left+this.window.pageXOffset,yt=G.top+this.window.pageYOffset,vn=this.offset();this.window.scrollTo(ye-vn[0],yt-vn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const re=$o(this.window.history)||$o(Object.getPrototypeOf(this.window.history));return!(!re||!re.writable&&!re.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function $o(z){return Object.getOwnPropertyDescriptor(z,"scrollRestoration")}class Ys{}},529:(ti,Vt,B)=>{"use strict";B.d(Vt,{JF:()=>jt,eN:()=>Xt});var w=B(6895),_=B(4650),pe=B(9646),a=B(9751),de=B(4351),ut=B(9300),it=B(4004);class Le{}class ke{}class rt{constructor(fe){this.normalizedNames=new Map,this.lazyUpdate=null,fe?this.lazyInit="string"==typeof fe?()=>{this.headers=new Map,fe.split("\n").forEach(te=>{const nt=te.indexOf(":");if(nt>0){const Ht=te.slice(0,nt),Rn=Ht.toLowerCase(),ni=te.slice(nt+1).trim();this.maybeSetNormalizedName(Ht,Rn),this.headers.has(Rn)?this.headers.get(Rn).push(ni):this.headers.set(Rn,[ni])}})}:()=>{this.headers=new Map,Object.keys(fe).forEach(te=>{let nt=fe[te];const Ht=te.toLowerCase();"string"==typeof nt&&(nt=[nt]),nt.length>0&&(this.headers.set(Ht,nt),this.maybeSetNormalizedName(te,Ht))})}:this.headers=new Map}has(fe){return this.init(),this.headers.has(fe.toLowerCase())}get(fe){this.init();const te=this.headers.get(fe.toLowerCase());return te&&te.length>0?te[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(fe){return this.init(),this.headers.get(fe.toLowerCase())||null}append(fe,te){return this.clone({name:fe,value:te,op:"a"})}set(fe,te){return this.clone({name:fe,value:te,op:"s"})}delete(fe,te){return this.clone({name:fe,value:te,op:"d"})}maybeSetNormalizedName(fe,te){this.normalizedNames.has(te)||this.normalizedNames.set(te,fe)}init(){this.lazyInit&&(this.lazyInit instanceof rt?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(fe=>this.applyUpdate(fe)),this.lazyUpdate=null))}copyFrom(fe){fe.init(),Array.from(fe.headers.keys()).forEach(te=>{this.headers.set(te,fe.headers.get(te)),this.normalizedNames.set(te,fe.normalizedNames.get(te))})}clone(fe){const te=new rt;return te.lazyInit=this.lazyInit&&this.lazyInit instanceof rt?this.lazyInit:this,te.lazyUpdate=(this.lazyUpdate||[]).concat([fe]),te}applyUpdate(fe){const te=fe.name.toLowerCase();switch(fe.op){case"a":case"s":let nt=fe.value;if("string"==typeof nt&&(nt=[nt]),0===nt.length)return;this.maybeSetNormalizedName(fe.name,te);const Ht=("a"===fe.op?this.headers.get(te):void 0)||[];Ht.push(...nt),this.headers.set(te,Ht);break;case"d":const Rn=fe.value;if(Rn){let ni=this.headers.get(te);if(!ni)return;ni=ni.filter(Oi=>-1===Rn.indexOf(Oi)),0===ni.length?(this.headers.delete(te),this.normalizedNames.delete(te)):this.headers.set(te,ni)}else this.headers.delete(te),this.normalizedNames.delete(te)}}forEach(fe){this.init(),Array.from(this.normalizedNames.keys()).forEach(te=>fe(this.normalizedNames.get(te),this.headers.get(te)))}}class Et{encodeKey(fe){return Wt(fe)}encodeValue(fe){return Wt(fe)}decodeKey(fe){return decodeURIComponent(fe)}decodeValue(fe){return decodeURIComponent(fe)}}const wt=/%(\d[a-f0-9])/gi,tt={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Wt(ge){return encodeURIComponent(ge).replace(wt,(fe,te)=>tt[te]??fe)}function kt(ge){return`${ge}`}class Qe{constructor(fe={}){if(this.updates=null,this.cloneFrom=null,this.encoder=fe.encoder||new Et,fe.fromString){if(fe.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function dt(ge,fe){const te=new Map;return ge.length>0&&ge.replace(/^\?/,"").split("&").forEach(Ht=>{const Rn=Ht.indexOf("="),[ni,Oi]=-1==Rn?[fe.decodeKey(Ht),""]:[fe.decodeKey(Ht.slice(0,Rn)),fe.decodeValue(Ht.slice(Rn+1))],xn=te.get(ni)||[];xn.push(Oi),te.set(ni,xn)}),te}(fe.fromString,this.encoder)}else fe.fromObject?(this.map=new Map,Object.keys(fe.fromObject).forEach(te=>{const nt=fe.fromObject[te],Ht=Array.isArray(nt)?nt.map(kt):[kt(nt)];this.map.set(te,Ht)})):this.map=null}has(fe){return this.init(),this.map.has(fe)}get(fe){this.init();const te=this.map.get(fe);return te?te[0]:null}getAll(fe){return this.init(),this.map.get(fe)||null}keys(){return this.init(),Array.from(this.map.keys())}append(fe,te){return this.clone({param:fe,value:te,op:"a"})}appendAll(fe){const te=[];return Object.keys(fe).forEach(nt=>{const Ht=fe[nt];Array.isArray(Ht)?Ht.forEach(Rn=>{te.push({param:nt,value:Rn,op:"a"})}):te.push({param:nt,value:Ht,op:"a"})}),this.clone(te)}set(fe,te){return this.clone({param:fe,value:te,op:"s"})}delete(fe,te){return this.clone({param:fe,value:te,op:"d"})}toString(){return this.init(),this.keys().map(fe=>{const te=this.encoder.encodeKey(fe);return this.map.get(fe).map(nt=>te+"="+this.encoder.encodeValue(nt)).join("&")}).filter(fe=>""!==fe).join("&")}clone(fe){const te=new Qe({encoder:this.encoder});return te.cloneFrom=this.cloneFrom||this,te.updates=(this.updates||[]).concat(fe),te}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(fe=>this.map.set(fe,this.cloneFrom.map.get(fe))),this.updates.forEach(fe=>{switch(fe.op){case"a":case"s":const te=("a"===fe.op?this.map.get(fe.param):void 0)||[];te.push(kt(fe.value)),this.map.set(fe.param,te);break;case"d":if(void 0===fe.value){this.map.delete(fe.param);break}{let nt=this.map.get(fe.param)||[];const Ht=nt.indexOf(kt(fe.value));-1!==Ht&&nt.splice(Ht,1),nt.length>0?this.map.set(fe.param,nt):this.map.delete(fe.param)}}}),this.cloneFrom=this.updates=null)}}class Ln{constructor(){this.map=new Map}set(fe,te){return this.map.set(fe,te),this}get(fe){return this.map.has(fe)||this.map.set(fe,fe.defaultValue()),this.map.get(fe)}delete(fe){return this.map.delete(fe),this}has(fe){return this.map.has(fe)}keys(){return this.map.keys()}}function Ce(ge){return typeof ArrayBuffer<"u"&&ge instanceof ArrayBuffer}function we(ge){return typeof Blob<"u"&&ge instanceof Blob}function At(ge){return typeof FormData<"u"&&ge instanceof FormData}class Jt{constructor(fe,te,nt,Ht){let Rn;if(this.url=te,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=fe.toUpperCase(),function Ye(ge){switch(ge){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Ht?(this.body=void 0!==nt?nt:null,Rn=Ht):Rn=nt,Rn&&(this.reportProgress=!!Rn.reportProgress,this.withCredentials=!!Rn.withCredentials,Rn.responseType&&(this.responseType=Rn.responseType),Rn.headers&&(this.headers=Rn.headers),Rn.context&&(this.context=Rn.context),Rn.params&&(this.params=Rn.params)),this.headers||(this.headers=new rt),this.context||(this.context=new Ln),this.params){const ni=this.params.toString();if(0===ni.length)this.urlWithParams=te;else{const Oi=te.indexOf("?");this.urlWithParams=te+(-1===Oi?"?":Oi<te.length-1?"&":"")+ni}}else this.params=new Qe,this.urlWithParams=te}serializeBody(){return null===this.body?null:Ce(this.body)||we(this.body)||At(this.body)||function zt(ge){return typeof URLSearchParams<"u"&&ge instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Qe?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||At(this.body)?null:we(this.body)?this.body.type||null:Ce(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Qe?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(fe={}){const te=fe.method||this.method,nt=fe.url||this.url,Ht=fe.responseType||this.responseType,Rn=void 0!==fe.body?fe.body:this.body,ni=void 0!==fe.withCredentials?fe.withCredentials:this.withCredentials,Oi=void 0!==fe.reportProgress?fe.reportProgress:this.reportProgress;let xn=fe.headers||this.headers,Ji=fe.params||this.params;const Hi=fe.context??this.context;return void 0!==fe.setHeaders&&(xn=Object.keys(fe.setHeaders).reduce((un,Pt)=>un.set(Pt,fe.setHeaders[Pt]),xn)),fe.setParams&&(Ji=Object.keys(fe.setParams).reduce((un,Pt)=>un.set(Pt,fe.setParams[Pt]),Ji)),new Jt(te,nt,Rn,{params:Ji,headers:xn,context:Hi,reportProgress:Oi,responseType:Ht,withCredentials:ni})}}var Cn=(()=>((Cn=Cn||{})[Cn.Sent=0]="Sent",Cn[Cn.UploadProgress=1]="UploadProgress",Cn[Cn.ResponseHeader=2]="ResponseHeader",Cn[Cn.DownloadProgress=3]="DownloadProgress",Cn[Cn.Response=4]="Response",Cn[Cn.User=5]="User",Cn))();class Ke{constructor(fe,te=200,nt="OK"){this.headers=fe.headers||new rt,this.status=void 0!==fe.status?fe.status:te,this.statusText=fe.statusText||nt,this.url=fe.url||null,this.ok=this.status>=200&&this.status<300}}class Ne extends Ke{constructor(fe={}){super(fe),this.type=Cn.ResponseHeader}clone(fe={}){return new Ne({headers:fe.headers||this.headers,status:void 0!==fe.status?fe.status:this.status,statusText:fe.statusText||this.statusText,url:fe.url||this.url||void 0})}}class He extends Ke{constructor(fe={}){super(fe),this.type=Cn.Response,this.body=void 0!==fe.body?fe.body:null}clone(fe={}){return new He({body:void 0!==fe.body?fe.body:this.body,headers:fe.headers||this.headers,status:void 0!==fe.status?fe.status:this.status,statusText:fe.statusText||this.statusText,url:fe.url||this.url||void 0})}}class _t extends Ke{constructor(fe){super(fe,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${fe.url||"(unknown url)"}`:`Http failure response for ${fe.url||"(unknown url)"}: ${fe.status} ${fe.statusText}`,this.error=fe.error||null}}function Dn(ge,fe){return{body:fe,headers:ge.headers,context:ge.context,observe:ge.observe,params:ge.params,reportProgress:ge.reportProgress,responseType:ge.responseType,withCredentials:ge.withCredentials}}let Xt=(()=>{class ge{constructor(te){this.handler=te}request(te,nt,Ht={}){let Rn;if(te instanceof Jt)Rn=te;else{let xn,Ji;xn=Ht.headers instanceof rt?Ht.headers:new rt(Ht.headers),Ht.params&&(Ji=Ht.params instanceof Qe?Ht.params:new Qe({fromObject:Ht.params})),Rn=new Jt(te,nt,void 0!==Ht.body?Ht.body:null,{headers:xn,context:Ht.context,params:Ji,reportProgress:Ht.reportProgress,responseType:Ht.responseType||"json",withCredentials:Ht.withCredentials})}const ni=(0,pe.of)(Rn).pipe((0,de.b)(xn=>this.handler.handle(xn)));if(te instanceof Jt||"events"===Ht.observe)return ni;const Oi=ni.pipe((0,ut.h)(xn=>xn instanceof He));switch(Ht.observe||"body"){case"body":switch(Rn.responseType){case"arraybuffer":return Oi.pipe((0,it.U)(xn=>{if(null!==xn.body&&!(xn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return xn.body}));case"blob":return Oi.pipe((0,it.U)(xn=>{if(null!==xn.body&&!(xn.body instanceof Blob))throw new Error("Response is not a Blob.");return xn.body}));case"text":return Oi.pipe((0,it.U)(xn=>{if(null!==xn.body&&"string"!=typeof xn.body)throw new Error("Response is not a string.");return xn.body}));default:return Oi.pipe((0,it.U)(xn=>xn.body))}case"response":return Oi;default:throw new Error(`Unreachable: unhandled observe type ${Ht.observe}}`)}}delete(te,nt={}){return this.request("DELETE",te,nt)}get(te,nt={}){return this.request("GET",te,nt)}head(te,nt={}){return this.request("HEAD",te,nt)}jsonp(te,nt){return this.request("JSONP",te,{params:(new Qe).append(nt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(te,nt={}){return this.request("OPTIONS",te,nt)}patch(te,nt,Ht={}){return this.request("PATCH",te,Dn(Ht,nt))}post(te,nt,Ht={}){return this.request("POST",te,Dn(Ht,nt))}put(te,nt,Ht={}){return this.request("PUT",te,Dn(Ht,nt))}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(Le))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})();class ii{constructor(fe,te){this.next=fe,this.interceptor=te}handle(fe){return this.interceptor.intercept(fe,this.next)}}const vi=new _.OlP("HTTP_INTERCEPTORS");let wi=(()=>{class ge{intercept(te,nt){return nt.handle(te)}}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})();const ce=/^\)\]\}',?\n/;let Se=(()=>{class ge{constructor(te){this.xhrFactory=te}handle(te){if("JSONP"===te.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new a.y(nt=>{const Ht=this.xhrFactory.build();if(Ht.open(te.method,te.urlWithParams),te.withCredentials&&(Ht.withCredentials=!0),te.headers.forEach((lt,nn)=>Ht.setRequestHeader(lt,nn.join(","))),te.headers.has("Accept")||Ht.setRequestHeader("Accept","application/json, text/plain, */*"),!te.headers.has("Content-Type")){const lt=te.detectContentTypeHeader();null!==lt&&Ht.setRequestHeader("Content-Type",lt)}if(te.responseType){const lt=te.responseType.toLowerCase();Ht.responseType="json"!==lt?lt:"text"}const Rn=te.serializeBody();let ni=null;const Oi=()=>{if(null!==ni)return ni;const lt=Ht.statusText||"OK",nn=new rt(Ht.getAllResponseHeaders()),_i=function ot(ge){return"responseURL"in ge&&ge.responseURL?ge.responseURL:/^X-Request-URL:/m.test(ge.getAllResponseHeaders())?ge.getResponseHeader("X-Request-URL"):null}(Ht)||te.url;return ni=new Ne({headers:nn,status:Ht.status,statusText:lt,url:_i}),ni},xn=()=>{let{headers:lt,status:nn,statusText:_i,url:Qt}=Oi(),xt=null;204!==nn&&(xt=typeof Ht.response>"u"?Ht.responseText:Ht.response),0===nn&&(nn=xt?200:0);let pt=nn>=200&&nn<300;if("json"===te.responseType&&"string"==typeof xt){const Yt=xt;xt=xt.replace(ce,"");try{xt=""!==xt?JSON.parse(xt):null}catch(bn){xt=Yt,pt&&(pt=!1,xt={error:bn,text:xt})}}pt?(nt.next(new He({body:xt,headers:lt,status:nn,statusText:_i,url:Qt||void 0})),nt.complete()):nt.error(new _t({error:xt,headers:lt,status:nn,statusText:_i,url:Qt||void 0}))},Ji=lt=>{const{url:nn}=Oi(),_i=new _t({error:lt,status:Ht.status||0,statusText:Ht.statusText||"Unknown Error",url:nn||void 0});nt.error(_i)};let Hi=!1;const un=lt=>{Hi||(nt.next(Oi()),Hi=!0);let nn={type:Cn.DownloadProgress,loaded:lt.loaded};lt.lengthComputable&&(nn.total=lt.total),"text"===te.responseType&&!!Ht.responseText&&(nn.partialText=Ht.responseText),nt.next(nn)},Pt=lt=>{let nn={type:Cn.UploadProgress,loaded:lt.loaded};lt.lengthComputable&&(nn.total=lt.total),nt.next(nn)};return Ht.addEventListener("load",xn),Ht.addEventListener("error",Ji),Ht.addEventListener("timeout",Ji),Ht.addEventListener("abort",Ji),te.reportProgress&&(Ht.addEventListener("progress",un),null!==Rn&&Ht.upload&&Ht.upload.addEventListener("progress",Pt)),Ht.send(Rn),nt.next({type:Cn.Sent}),()=>{Ht.removeEventListener("error",Ji),Ht.removeEventListener("abort",Ji),Ht.removeEventListener("load",xn),Ht.removeEventListener("timeout",Ji),te.reportProgress&&(Ht.removeEventListener("progress",un),null!==Rn&&Ht.upload&&Ht.upload.removeEventListener("progress",Pt)),Ht.readyState!==Ht.DONE&&Ht.abort()}})}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(w.JF))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})();const St=new _.OlP("XSRF_COOKIE_NAME"),tn=new _.OlP("XSRF_HEADER_NAME");class li{}let Wi=(()=>{class ge{constructor(te,nt,Ht){this.doc=te,this.platform=nt,this.cookieName=Ht,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const te=this.doc.cookie||"";return te!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,w.Mx)(te,this.cookieName),this.lastCookieString=te),this.lastToken}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(w.K0),_.LFG(_.Lbi),_.LFG(St))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})(),Mn=(()=>{class ge{constructor(te,nt){this.tokenService=te,this.headerName=nt}intercept(te,nt){const Ht=te.url.toLowerCase();if("GET"===te.method||"HEAD"===te.method||Ht.startsWith("http://")||Ht.startsWith("https://"))return nt.handle(te);const Rn=this.tokenService.getToken();return null!==Rn&&!te.headers.has(this.headerName)&&(te=te.clone({headers:te.headers.set(this.headerName,Rn)})),nt.handle(te)}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(li),_.LFG(tn))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})(),ae=(()=>{class ge{constructor(te,nt){this.backend=te,this.injector=nt,this.chain=null}handle(te){if(null===this.chain){const nt=this.injector.get(vi,[]);this.chain=nt.reduceRight((Ht,Rn)=>new ii(Ht,Rn),this.backend)}return this.chain.handle(te)}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(ke),_.LFG(_.zs3))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac}),ge})(),on=(()=>{class ge{static disable(){return{ngModule:ge,providers:[{provide:Mn,useClass:wi}]}}static withOptions(te={}){return{ngModule:ge,providers:[te.cookieName?{provide:St,useValue:te.cookieName}:[],te.headerName?{provide:tn,useValue:te.headerName}:[]]}}}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275mod=_.oAB({type:ge}),ge.\u0275inj=_.cJS({providers:[Mn,{provide:vi,useExisting:Mn,multi:!0},{provide:li,useClass:Wi},{provide:St,useValue:"XSRF-TOKEN"},{provide:tn,useValue:"X-XSRF-TOKEN"}]}),ge})(),jt=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275mod=_.oAB({type:ge}),ge.\u0275inj=_.cJS({providers:[Xt,{provide:Le,useClass:ae},Se,{provide:ke,useExisting:Se}],imports:[on.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),ge})()},4650:(ti,Vt,B)=>{"use strict";B.d(Vt,{$8M:()=>Gs,$Z:()=>vu,AFp:()=>U0,ALo:()=>o0,AaK:()=>Le,AsE:()=>ih,BQk:()=>p,CHM:()=>Za,CRH:()=>g0,CZH:()=>Bg,CqO:()=>R,D6c:()=>S1,EJc:()=>jw,EiD:()=>rc,EpF:()=>v,F$t:()=>Ze,F4k:()=>C,FYo:()=>_d,FiY:()=>vt,G48:()=>u1,Gf:()=>f0,GfV:()=>Al,Gpc:()=>ft,Hsn:()=>at,Ikx:()=>ty,JOm:()=>cc,JVY:()=>Vf,KtG:()=>fa,L6k:()=>jf,LAX:()=>Gf,LFG:()=>Pe,LSH:()=>xp,Lbi:()=>Nw,Lck:()=>kb,MAs:()=>Cg,MGl:()=>mt,MMx:()=>dy,NdJ:()=>N,O4$:()=>yi,OlP:()=>qr,Oqu:()=>rp,PXZ:()=>r1,Q6J:()=>eh,QGY:()=>E,QP$:()=>Lt,QbO:()=>zw,Qsj:()=>Xa,R0b:()=>yc,RDi:()=>ia,Rgc:()=>zf,SBq:()=>Nu,Sil:()=>Gw,Suo:()=>m0,TTD:()=>Ls,TgZ:()=>t,Udp:()=>Ro,VKq:()=>Qv,W1O:()=>x0,WFA:()=>H,X6Q:()=>c1,XFs:()=>ae,Xpm:()=>Qt,Xts:()=>oc,Y36:()=>Pc,YKP:()=>Hv,YNc:()=>Tf,Yjl:()=>oe,Yz7:()=>Tt,Z0I:()=>Xe,ZZ4:()=>Fy,_Bn:()=>jv,_UZ:()=>n,_Vd:()=>ac,_c5:()=>D1,_uU:()=>Jl,aQg:()=>Ly,c2e:()=>Uw,cJS:()=>Fe,cg1:()=>iy,d8E:()=>ny,dDg:()=>Jw,dqk:()=>Ht,eBb:()=>Hf,eFA:()=>J0,ekj:()=>fs,eoX:()=>K0,f3M:()=>Be,g9A:()=>j0,h0i:()=>cp,hGG:()=>T1,hij:()=>_c,iGM:()=>p0,ifc:()=>nt,ip1:()=>z0,jDz:()=>$v,kL8:()=>fv,lG2:()=>ee,lcZ:()=>s0,lqb:()=>uu,lri:()=>q0,mCW:()=>ch,n5z:()=>br,n_E:()=>Og,oAB:()=>bn,oxw:()=>We,pB0:()=>$f,q3G:()=>Do,qLn:()=>mu,qOj:()=>bf,qZA:()=>e,qzn:()=>lu,rWj:()=>Y0,s9C:()=>Ct,sBO:()=>d1,sIi:()=>eu,s_b:()=>kg,soG:()=>Ng,tb:()=>H0,tp0:()=>ln,uIk:()=>Jh,vHH:()=>tt,vpe:()=>ou,wAp:()=>nr,xi3:()=>a0,xp6:()=>Im,ynx:()=>u,z2F:()=>zg,z3N:()=>Dl,zSh:()=>hh,zs3:()=>yu});var w=B(7579),_=B(727),pe=B(9751),a=B(6451),de=B(3099);function ut(r){for(let o in r)if(r[o]===ut)return o;throw Error("Could not find renamed property on target object.")}function it(r,o){for(const l in o)o.hasOwnProperty(l)&&!r.hasOwnProperty(l)&&(r[l]=o[l])}function Le(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(Le).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const l=o.indexOf("\n");return-1===l?o:o.substring(0,l)}function ke(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const rt=ut({__forward_ref__:ut});function ft(r){return r.__forward_ref__=ft,r.toString=function(){return Le(this())},r}function Et(r){return dt(r)?r():r}function dt(r){return"function"==typeof r&&r.hasOwnProperty(rt)&&r.__forward_ref__===ft}class tt extends Error{constructor(o,l){super(function Wt(r,o){return`NG0${Math.abs(r)}${o?": "+o.trim():""}`}(o,l)),this.code=o}}function kt(r){return"string"==typeof r?r:null==r?"":String(r)}function Ce(r,o){throw new tt(-201,!1)}function wi(r,o){null==r&&function Nn(r,o,l,h){throw new Error(`ASSERTION ERROR: ${r}`+(null==h?"":` [Expected=> ${l} ${h} ${o} <=Actual]`))}(o,r,null,"!=")}function Tt(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Fe(r){return{providers:r.providers||[],imports:r.imports||[]}}function ht(r){return ce(r,tn)||ce(r,Wi)}function Xe(r){return null!==ht(r)}function ce(r,o){return r.hasOwnProperty(o)?r[o]:null}function St(r){return r&&(r.hasOwnProperty(li)||r.hasOwnProperty(Mn))?r[li]:null}const tn=ut({\u0275prov:ut}),li=ut({\u0275inj:ut}),Wi=ut({ngInjectableDef:ut}),Mn=ut({ngInjectorDef:ut});var ae=(()=>((ae=ae||{})[ae.Default=0]="Default",ae[ae.Host=1]="Host",ae[ae.Self=2]="Self",ae[ae.SkipSelf=4]="SkipSelf",ae[ae.Optional=8]="Optional",ae))();let $e;function on(r){const o=$e;return $e=r,o}function jt(r,o,l){const h=ht(r);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:l&ae.Optional?null:void 0!==o?o:void Ce(Le(r))}function Je(r){return{toString:r}.toString()}var ge=(()=>((ge=ge||{})[ge.OnPush=0]="OnPush",ge[ge.Default=1]="Default",ge))(),nt=(()=>{return(r=nt||(nt={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",nt;var r})();const Ht=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Oi={},xn=[],Ji=ut({\u0275cmp:ut}),Hi=ut({\u0275dir:ut}),un=ut({\u0275pipe:ut}),Pt=ut({\u0275mod:ut}),lt=ut({\u0275fac:ut}),nn=ut({__NG_ELEMENT_ID__:ut});let _i=0;function Qt(r){return Je(()=>{const l=!0===r.standalone,h={},g={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:h,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===ge.OnPush,directiveDefs:null,pipeDefs:null,standalone:l,dependencies:l&&r.dependencies||null,getStandaloneInjector:null,selectors:r.selectors||xn,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||nt.Emulated,id:"c"+_i++,styles:r.styles||xn,_:null,setInput:null,schemas:r.schemas||null,tView:null},b=r.dependencies,T=r.features;return g.inputs=Ee(r.inputs,h),g.outputs=Ee(r.outputs),T&&T.forEach(L=>L(g)),g.directiveDefs=b?()=>("function"==typeof b?b():b).map(pt).filter(Yt):null,g.pipeDefs=b?()=>("function"==typeof b?b():b).map(ct).filter(Yt):null,g})}function pt(r){return Me(r)||Ve(r)}function Yt(r){return null!==r}function bn(r){return Je(()=>({type:r.type,bootstrap:r.bootstrap||xn,declarations:r.declarations||xn,imports:r.imports||xn,exports:r.exports||xn,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function Ee(r,o){if(null==r)return Oi;const l={};for(const h in r)if(r.hasOwnProperty(h)){let g=r[h],b=g;Array.isArray(g)&&(b=g[1],g=g[0]),l[g]=h,o&&(o[g]=b)}return l}const ee=Qt;function oe(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Me(r){return r[Ji]||null}function Ve(r){return r[Hi]||null}function ct(r){return r[un]||null}function Lt(r){const o=Me(r)||Ve(r)||ct(r);return null!==o&&o.standalone}function Ft(r,o){const l=r[Pt]||null;if(!l&&!0===o)throw new Error(`Type ${Le(r)} does not have '\u0275mod' property.`);return l}function Ki(r){return Array.isArray(r)&&"object"==typeof r[1]}function vr(r){return Array.isArray(r)&&!0===r[1]}function to(r){return 0!=(8&r.flags)}function Br(r){return 2==(2&r.flags)}function pr(r){return 1==(1&r.flags)}function Zr(r){return null!==r.template}function Ds(r){return 0!=(256&r[2])}function ys(r,o){return r.hasOwnProperty(lt)?r[lt]:null}class Ho{constructor(o,l,h){this.previousValue=o,this.currentValue=l,this.firstChange=h}isFirstChange(){return this.firstChange}}function Ls(){return Bs}function Bs(r){return r.type.prototype.ngOnChanges&&(r.setInput=Ns),Ca}function Ca(){const r=Ma(this),o=r?.current;if(o){const l=r.previous;if(l===Oi)r.previous=o;else for(let h in o)l[h]=o[h];r.current=null,this.ngOnChanges(o)}}function Ns(r,o,l,h){const g=Ma(r)||function il(r,o){return r[Go]=o}(r,{previous:Oi,current:null}),b=g.current||(g.current={}),T=g.previous,L=this.declaredInputs[l],U=T[L];b[L]=new Ho(U&&U.currentValue,o,T===Oi),r[h]=o}Ls.ngInherit=!0;const Go="__ngSimpleChanges__";function Ma(r){return r[Go]||null}function Fr(r){for(;Array.isArray(r);)r=r[0];return r}function $o(r,o){return Fr(o[r])}function go(r,o){return Fr(o[r.index])}function Ys(r,o){return r.data[o]}function pa(r,o){return r[o]}function cr(r,o){const l=o[r];return Ki(l)?l:l[0]}function zs(r){return 64==(64&r[2])}function ss(r,o){return null==o?null:r[o]}function vs(r){r[18]=0}function _o(r,o){r[5]+=o;let l=r,h=r[3];for(;null!==h&&(1===o&&1===l[5]||-1===o&&0===l[5]);)h[5]+=o,l=h,h=h[3]}const Gi={lFrame:vc(null),bindingsEnabled:!0};function As(){return Gi.bindingsEnabled}function wn(){return Gi.lFrame.lView}function ar(){return Gi.lFrame.tView}function Za(r){return Gi.lFrame.contextLView=r,r[8]}function fa(r){return Gi.lFrame.contextLView=null,r}function zr(){let r=Q();for(;null!==r&&64===r.type;)r=r.parent;return r}function Q(){return Gi.lFrame.currentTNode}function j(r,o){const l=Gi.lFrame;l.currentTNode=r,l.isParent=o}function be(){return Gi.lFrame.isParent}function En(){Gi.lFrame.isParent=!1}function Lr(){const r=Gi.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function Vs(){return Gi.lFrame.bindingIndex++}function Xs(r){const o=Gi.lFrame,l=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,l}function js(r,o){const l=Gi.lFrame;l.bindingIndex=l.bindingRootIndex=r,sl(o)}function sl(r){Gi.lFrame.currentDirectiveIndex=r}function Wa(r){const o=Gi.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}function ec(){return Gi.lFrame.currentQueryIndex}function gl(r){Gi.lFrame.currentQueryIndex=r}function Nl(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function Xo(r,o,l){if(l&ae.SkipSelf){let g=o,b=r;for(;!(g=g.parent,null!==g||l&ae.Host||(g=Nl(b),null===g||(b=b[15],10&g.type))););if(null===g)return!1;o=g,r=b}const h=Gi.lFrame=Ia();return h.currentTNode=o,h.lView=r,!0}function al(r){const o=Ia(),l=r[1];Gi.lFrame=o,o.currentTNode=l.firstChild,o.lView=r,o.tView=l,o.contextLView=r,o.bindingIndex=l.bindingStartIndex,o.inI18n=!1}function Ia(){const r=Gi.lFrame,o=null===r?null:r.child;return null===o?vc(r):o}function vc(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function zl(){const r=Gi.lFrame;return Gi.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const z=zl;function re(){const r=zl();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function yt(){return Gi.lFrame.selectedIndex}function vn(r){Gi.lFrame.selectedIndex=r}function On(){const r=Gi.lFrame;return Ys(r.tView,r.selectedIndex)}function yi(){Gi.lFrame.currentNamespace="svg"}function Ir(r,o){for(let l=o.directiveStart,h=o.directiveEnd;l<h;l++){const b=r.data[l].type.prototype,{ngAfterContentInit:T,ngAfterContentChecked:L,ngAfterViewInit:U,ngAfterViewChecked:ne,ngOnDestroy:xe}=b;T&&(r.contentHooks||(r.contentHooks=[])).push(-l,T),L&&((r.contentHooks||(r.contentHooks=[])).push(l,L),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(l,L)),U&&(r.viewHooks||(r.viewHooks=[])).push(-l,U),ne&&((r.viewHooks||(r.viewHooks=[])).push(l,ne),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(l,ne)),null!=xe&&(r.destroyHooks||(r.destroyHooks=[])).push(l,xe)}}function eo(r,o,l){Qs(r,o,3,l)}function Wo(r,o,l,h){(3&r[2])===l&&Qs(r,o,l,h)}function cs(r,o){let l=r[2];(3&l)===o&&(l&=2047,l+=1,r[2]=l)}function Qs(r,o,l,h){const b=h??-1,T=o.length-1;let L=0;for(let U=void 0!==h?65535&r[18]:0;U<T;U++)if("number"==typeof o[U+1]){if(L=o[U],null!=h&&L>=h)break}else o[U]<0&&(r[18]+=65536),(L<b||-1==b)&&(Hs(r,l,o,U),r[18]=(4294901760&r[18])+U+2),U++}function Hs(r,o,l,h){const g=l[h]<0,b=l[h+1],L=r[g?-l[h]:l[h]];if(g){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{b.call(L)}finally{}}}else try{b.call(L)}finally{}}class No{constructor(o,l,h){this.factory=o,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=h}}function X(r,o,l){let h=0;for(;h<l.length;){const g=l[h];if("number"==typeof g){if(0!==g)break;h++;const b=l[h++],T=l[h++],L=l[h++];r.setAttribute(o,T,L,b)}else{const b=g,T=l[++h];S(b)?r.setProperty(o,b,T):r.setAttribute(o,b,T),h++}}return h}function M(r){return 3===r||4===r||6===r}function S(r){return 64===r.charCodeAt(0)}function $(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let l=-1;for(let h=0;h<o.length;h++){const g=o[h];"number"==typeof g?l=g:0===l||ue(r,l,g,null,-1===l||2===l?o[++h]:null)}}return r}function ue(r,o,l,h,g){let b=0,T=r.length;if(-1===o)T=-1;else for(;b<r.length;){const L=r[b++];if("number"==typeof L){if(L===o){T=-1;break}if(L>o){T=b-1;break}}}for(;b<r.length;){const L=r[b];if("number"==typeof L)break;if(L===l){if(null===h)return void(null!==g&&(r[b+1]=g));if(h===r[b+1])return void(r[b+2]=g)}b++,null!==h&&b++,null!==g&&b++}-1!==T&&(r.splice(T,0,o),b=T+1),r.splice(b++,0,l),null!==h&&r.splice(b++,0,h),null!==g&&r.splice(b++,0,g)}function Re(r){return-1!==r}function It(r){return 32767&r}function sn(r,o){let l=function Ot(r){return r>>16}(r),h=o;for(;l>0;)h=h[15],l--;return h}let zn=!0;function di(r){const o=zn;return zn=r,o}let Vi=0;const In={};function Mr(r,o){const l=ko(r,o);if(-1!==l)return l;const h=o[1];h.firstCreatePass&&(r.injectorIndex=o.length,vo(h.data,r),vo(o,null),vo(h.blueprint,null));const g=ro(r,o),b=r.injectorIndex;if(Re(g)){const T=It(g),L=sn(g,o),U=L[1].data;for(let ne=0;ne<8;ne++)o[b+ne]=L[T+ne]|U[T+ne]}return o[b+8]=g,b}function vo(r,o){r.push(0,0,0,0,0,0,0,0,o)}function ko(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function ro(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let l=0,h=null,g=o;for(;null!==g;){if(h=us(g),null===h)return-1;if(l++,g=g[15],-1!==h.injectorIndex)return h.injectorIndex|l<<16}return-1}function ma(r,o,l){!function ir(r,o,l){let h;"string"==typeof l?h=l.charCodeAt(0)||0:l.hasOwnProperty(nn)&&(h=l[nn]),null==h&&(h=l[nn]=Vi++);const g=255&h;o.data[r+(g>>5)]|=1<<g}(r,o,l)}function Po(r,o,l){if(l&ae.Optional||void 0!==r)return r;Ce()}function es(r,o,l,h){if(l&ae.Optional&&void 0===h&&(h=null),0==(l&(ae.Self|ae.Host))){const g=r[9],b=on(void 0);try{return g?g.get(o,h,l&ae.Optional):jt(o,h,l&ae.Optional)}finally{on(b)}}return Po(h,0,l)}function xo(r,o,l,h=ae.Default,g){if(null!==r){if(1024&o[2]){const T=function ga(r,o,l,h,g){let b=r,T=o;for(;null!==b&&null!==T&&1024&T[2]&&!(256&T[2]);){const L=bs(b,T,l,h|ae.Self,In);if(L!==In)return L;let U=b.parent;if(!U){const ne=T[21];if(ne){const xe=ne.get(l,In,h);if(xe!==In)return xe}U=us(T),T=T[15]}b=U}return g}(r,o,l,h,In);if(T!==In)return T}const b=bs(r,o,l,h,In);if(b!==In)return b}return es(o,l,h,g)}function bs(r,o,l,h,g){const b=function xc(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(nn)?r[nn]:void 0;return"number"==typeof o?o>=0?255&o:Zi:o}(l);if("function"==typeof b){if(!Xo(o,r,h))return h&ae.Host?Po(g,0,h):es(o,l,h,g);try{const T=b(h);if(null!=T||h&ae.Optional)return T;Ce()}finally{z()}}else if("number"==typeof b){let T=null,L=ko(r,o),U=-1,ne=h&ae.Host?o[16][6]:null;for((-1===L||h&ae.SkipSelf)&&(U=-1===L?ro(r,o):o[L+8],-1!==U&&Di(h,!1)?(T=o[1],L=It(U),o=sn(U,o)):L=-1);-1!==L;){const xe=o[1];if(ka(b,L,xe.data)){const qe=ll(L,o,l,T,h,ne);if(qe!==In)return qe}U=o[L+8],-1!==U&&Di(h,o[1].data[L+8]===ne)&&ka(b,L,o)?(T=xe,L=It(U),o=sn(U,o)):L=-1}}return g}function ll(r,o,l,h,g,b){const T=o[1],L=T.data[r+8],xe=Ra(L,T,l,null==h?Br(L)&&zn:h!=T&&0!=(3&L.type),g&ae.Host&&b===L);return null!==xe?Ur(o,T,xe,L):In}function Ra(r,o,l,h,g){const b=r.providerIndexes,T=o.data,L=1048575&b,U=r.directiveStart,xe=b>>20,Nt=g?L+xe:r.directiveEnd;for(let cn=h?L:L+xe;cn<Nt;cn++){const Zn=T[cn];if(cn<U&&l===Zn||cn>=U&&Zn.type===l)return cn}if(g){const cn=T[U];if(cn&&Zr(cn)&&cn.type===l)return U}return null}function Ur(r,o,l,h){let g=r[l];const b=o.data;if(function qa(r){return r instanceof No}(g)){const T=g;T.resolving&&function Hn(r,o){const l=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new tt(-200,`Circular dependency in DI detected for ${r}${l}`)}(function Qe(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():kt(r)}(b[l]));const L=di(T.canSeeViewProviders);T.resolving=!0;const U=T.injectImpl?on(T.injectImpl):null;Xo(r,h,ae.Default);try{g=r[l]=T.factory(void 0,b,r,h),o.firstCreatePass&&l>=h.directiveStart&&function yo(r,o,l){const{ngOnChanges:h,ngOnInit:g,ngDoCheck:b}=o.type.prototype;if(h){const T=Bs(o);(l.preOrderHooks||(l.preOrderHooks=[])).push(r,T),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,T)}g&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-r,g),b&&((l.preOrderHooks||(l.preOrderHooks=[])).push(r,b),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,b))}(l,b[l],o)}finally{null!==U&&on(U),di(L),T.resolving=!1,z()}}return g}function ka(r,o,l){return!!(l[o+(r>>5)]&1<<r)}function Di(r,o){return!(r&ae.Self||r&ae.Host&&o)}class Ii{constructor(o,l){this._tNode=o,this._lView=l}get(o,l,h){return xo(this._tNode,this._lView,o,h,l)}}function Zi(){return new Ii(zr(),wn())}function br(r){return Je(()=>{const o=r.prototype.constructor,l=o[lt]||oo(o),h=Object.prototype;let g=Object.getPrototypeOf(r.prototype).constructor;for(;g&&g!==h;){const b=g[lt]||oo(g);if(b&&b!==l)return b;g=Object.getPrototypeOf(g)}return b=>new b})}function oo(r){return dt(r)?()=>{const o=oo(Et(r));return o&&o()}:ys(r)}function us(r){const o=r[1],l=o.type;return 2===l?o.declTNode:1===l?r[6]:null}function Gs(r){return function Jo(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const l=r.attrs;if(l){const h=l.length;let g=0;for(;g<h;){const b=l[g];if(M(b))break;if(0===b)g+=2;else if("number"==typeof b)for(g++;g<h&&"string"==typeof l[g];)g++;else{if(b===o)return l[g+1];g+=2}}}return null}(zr(),r)}const Js="__parameters__";function bo(r,o,l){return Je(()=>{const h=function ea(r){return function(...l){if(r){const h=r(...l);for(const g in h)this[g]=h[g]}}}(o);function g(...b){if(this instanceof g)return h.apply(this,b),this;const T=new g(...b);return L.annotation=T,L;function L(U,ne,xe){const qe=U.hasOwnProperty(Js)?U[Js]:Object.defineProperty(U,Js,{value:[]})[Js];for(;qe.length<=xe;)qe.push(null);return(qe[xe]=qe[xe]||[]).push(T),U}}return l&&(g.prototype=Object.create(l.prototype)),g.prototype.ngMetadataName=r,g.annotationCls=g,g})}class qr{constructor(o,l){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=Tt({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function hs(r,o){void 0===o&&(o=r);for(let l=0;l<r.length;l++){let h=r[l];Array.isArray(h)?(o===r&&(o=r.slice(0,l)),hs(h,o)):o!==r&&o.push(h)}return o}function Fa(r,o){r.forEach(l=>Array.isArray(l)?Fa(l,o):o(l))}function su(r,o,l){o>=r.length?r.push(l):r.splice(o,0,l)}function ic(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function wl(r,o){const l=[];for(let h=0;h<r;h++)l.push(o);return l}function Y(r,o,l){let h=et(r,o);return h>=0?r[1|h]=l:(h=~h,function O(r,o,l,h){let g=r.length;if(g==o)r.push(l,h);else if(1===g)r.push(h,r[0]),r[0]=l;else{for(g--,r.push(r[g-1],r[g]);g>o;)r[g]=r[g-2],g--;r[o]=l,r[o+1]=h}}(r,h,o,l)),h}function me(r,o){const l=et(r,o);if(l>=0)return r[1|l]}function et(r,o){return function Sn(r,o,l){let h=0,g=r.length>>l;for(;g!==h;){const b=h+(g-h>>1),T=r[b<<l];if(o===T)return b<<l;T>o?g=b:h=b+1}return~(g<<l)}(r,o,1)}const f={},y="__NG_DI_FLAG__",x="ngTempTokenPath",P=/\n/gm,W="__source";let Z;function ie(r){const o=Z;return Z=r,o}function ve(r,o=ae.Default){if(void 0===Z)throw new tt(-203,!1);return null===Z?jt(r,void 0,o):Z.get(r,o&ae.Optional?null:void 0,o)}function Pe(r,o=ae.Default){return(function Rt(){return $e}()||ve)(Et(r),o)}function Be(r,o=ae.Default){return"number"!=typeof o&&(o=0|(o.optional&&8)|(o.host&&1)|(o.self&&2)|(o.skipSelf&&4)),Pe(r,o)}function Te(r){const o=[];for(let l=0;l<r.length;l++){const h=Et(r[l]);if(Array.isArray(h)){if(0===h.length)throw new tt(900,!1);let g,b=ae.Default;for(let T=0;T<h.length;T++){const L=h[T],U=je(L);"number"==typeof U?-1===U?g=L.token:b|=U:g=L}o.push(Pe(g,b))}else o.push(Pe(h))}return o}function Ae(r,o){return r[y]=o,r.prototype[y]=o,r}function je(r){return r[y]}const vt=Ae(bo("Optional"),8),ln=Ae(bo("SkipSelf"),4);let na,Yr;function ia(r){na=r}function wr(r){return function Gr(){if(void 0===Yr&&(Yr=null,Ht.trustedTypes))try{Yr=Ht.trustedTypes.createPolicy("angular",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return Yr}()?.createHTML(r)||r}class Zs{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Cl extends Zs{getTypeName(){return"HTML"}}class au extends Zs{getTypeName(){return"Style"}}class Hc extends Zs{getTypeName(){return"Script"}}class Ml extends Zs{getTypeName(){return"URL"}}class pd extends Zs{getTypeName(){return"ResourceURL"}}function Dl(r){return r instanceof Zs?r.changingThisBreaksApplicationSecurity:r}function lu(r,o){const l=function hp(r){return r instanceof Zs&&r.getTypeName()||null}(r);if(null!=l&&l!==o){if("ResourceURL"===l&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${l} (see https://g.co/ng/security#xss)`)}return l===o}function Vf(r){return new Cl(r)}function jf(r){return new au(r)}function Hf(r){return new Hc(r)}function Gf(r){return new Ml(r)}function $f(r){return new pd(r)}class Zf{constructor(o){this.inertDocumentHelper=o}getInertBodyElement(o){o="<body><remove></remove>"+o;try{const l=(new window.DOMParser).parseFromString(wr(o),"text/html").body;return null===l?this.inertDocumentHelper.getInertBodyElement(o):(l.removeChild(l.firstChild),l)}catch{return null}}}class Wf{constructor(o){if(this.defaultDoc=o,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const l=this.inertDocument.createElement("html");this.inertDocument.appendChild(l);const h=this.inertDocument.createElement("body");l.appendChild(h)}}getInertBodyElement(o){const l=this.inertDocument.createElement("template");if("content"in l)return l.innerHTML=wr(o),l;const h=this.inertDocument.createElement("body");return h.innerHTML=wr(o),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(h),h}stripCustomNsAttrs(o){const l=o.attributes;for(let g=l.length-1;0<g;g--){const T=l.item(g).name;("xmlns:ns1"===T||0===T.indexOf("ns1:"))&&o.removeAttribute(T)}let h=o.firstChild;for(;h;)h.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(h),h=h.nextSibling}}const Hg=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function ch(r){return(r=String(r)).match(Hg)?r:"unsafe:"+r}function Ya(r){const o={};for(const l of r.split(","))o[l]=!0;return o}function ku(...r){const o={};for(const l of r)for(const h in l)l.hasOwnProperty(h)&&(o[h]=!0);return o}const fp=Ya("area,br,col,hr,img,wbr"),mp=Ya("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Yf=Ya("rp,rt"),Fu=ku(fp,ku(mp,Ya("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ku(Yf,Ya("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ku(Yf,mp)),jl=Ya("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),yp=ku(jl,Ya("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ya("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Zg=Ya("script,style,template");class Wg{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(o){let l=o.firstChild,h=!0;for(;l;)if(l.nodeType===Node.ELEMENT_NODE?h=this.startElement(l):l.nodeType===Node.TEXT_NODE?this.chars(l.nodeValue):this.sanitizedSomething=!0,h&&l.firstChild)l=l.firstChild;else for(;l;){l.nodeType===Node.ELEMENT_NODE&&this.endElement(l);let g=this.checkClobberedElement(l,l.nextSibling);if(g){l=g;break}l=this.checkClobberedElement(l,l.parentNode)}return this.buf.join("")}startElement(o){const l=o.nodeName.toLowerCase();if(!Fu.hasOwnProperty(l))return this.sanitizedSomething=!0,!Zg.hasOwnProperty(l);this.buf.push("<"),this.buf.push(l);const h=o.attributes;for(let g=0;g<h.length;g++){const b=h.item(g),T=b.name,L=T.toLowerCase();if(!yp.hasOwnProperty(L)){this.sanitizedSomething=!0;continue}let U=b.value;jl[L]&&(U=ch(U)),this.buf.push(" ",T,'="',Lu(U),'"')}return this.buf.push(">"),!0}endElement(o){const l=o.nodeName.toLowerCase();Fu.hasOwnProperty(l)&&!fp.hasOwnProperty(l)&&(this.buf.push("</"),this.buf.push(l),this.buf.push(">"))}chars(o){this.buf.push(Lu(o))}checkClobberedElement(o,l){if(l&&(o.compareDocumentPosition(l)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${o.outerHTML}`);return l}}const qg=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,vp=/([^\#-~ |!])/g;function Lu(r){return r.replace(/&/g,"&amp;").replace(qg,function(o){return"&#"+(1024*(o.charCodeAt(0)-55296)+(o.charCodeAt(1)-56320)+65536)+";"}).replace(vp,function(o){return"&#"+o.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Ec;function rc(r,o){let l=null;try{Ec=Ec||function pp(r){const o=new Wf(r);return function qf(){try{return!!(new window.DOMParser).parseFromString(wr(""),"text/html")}catch{return!1}}()?new Zf(o):o}(r);let h=o?String(o):"";l=Ec.getInertBodyElement(h);let g=5,b=h;do{if(0===g)throw new Error("Failed to sanitize html because the input is unstable");g--,h=b,b=l.innerHTML,l=Ec.getInertBodyElement(h)}while(h!==b);return wr((new Wg).sanitizeChildren(ul(l)||l))}finally{if(l){const h=ul(l)||l;for(;h.firstChild;)h.removeChild(h.firstChild)}}}function ul(r){return"content"in r&&function Gc(r){return r.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===r.nodeName}(r)?r.content:null}var Do=(()=>((Do=Do||{})[Do.NONE=0]="NONE",Do[Do.HTML=1]="HTML",Do[Do.STYLE=2]="STYLE",Do[Do.SCRIPT=3]="SCRIPT",Do[Do.URL=4]="URL",Do[Do.RESOURCE_URL=5]="RESOURCE_URL",Do))();function xp(r){const o=function Li(){const r=wn();return r&&r[12]}();return o?o.sanitize(Do.URL,r)||"":lu(r,"URL")?Dl(r):ch(kt(r))}const oc=new qr("ENVIRONMENT_INITIALIZER"),fd=new qr("INJECTOR",-1),Tr=new qr("INJECTOR_DEF_TYPES");class bp{get(o,l=f){if(l===f){const h=new Error(`NullInjectorError: No provider for ${Le(o)}!`);throw h.name="NullInjectorError",h}return l}}function wp(...r){return{\u0275providers:Gl(0,r)}}function Gl(r,...o){const l=[],h=new Set;let g;return Fa(o,b=>{const T=b;Ka(T,l,[],h)&&(g||(g=[]),g.push(T))}),void 0!==g&&$l(g,l),l}function $l(r,o){for(let l=0;l<r.length;l++){const{providers:g}=r[l];Fa(g,b=>{o.push(b)})}}function Ka(r,o,l,h){if(!(r=Et(r)))return!1;let g=null,b=St(r);const T=!b&&Me(r);if(b||T){if(T&&!T.standalone)return!1;g=r}else{const U=r.ngModule;if(b=St(U),!b)return!1;g=U}const L=h.has(g);if(T){if(L)return!1;if(h.add(g),T.dependencies){const U="function"==typeof T.dependencies?T.dependencies():T.dependencies;for(const ne of U)Ka(ne,o,l,h)}}else{if(!b)return!1;{if(null!=b.imports&&!L){let ne;h.add(g);try{Fa(b.imports,xe=>{Ka(xe,o,l,h)&&(ne||(ne=[]),ne.push(xe))})}finally{}void 0!==ne&&$l(ne,o)}if(!L){const ne=ys(g)||(()=>new g);o.push({provide:g,useFactory:ne,deps:xn},{provide:Tr,useValue:g,multi:!0},{provide:oc,useValue:()=>Pe(g),multi:!0})}const U=b.providers;null==U||L||Fa(U,xe=>{o.push(xe)})}}return g!==r&&void 0!==r.providers}const Ws=ut({provide:String,useValue:ut});function dh(r){return null!==r&&"object"==typeof r&&Ws in r}function Sl(r){return"function"==typeof r}const hh=new qr("Set Injector scope."),Bu={},Qg={};let md;function gd(){return void 0===md&&(md=new bp),md}class uu{}class sc extends uu{constructor(o,l,h,g){super(),this.parent=l,this.source=h,this.scopes=g,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Dp(o,T=>this.processProvider(T)),this.records.set(fd,du(void 0,this)),g.has("environment")&&this.records.set(uu,du(void 0,this));const b=this.records.get(hh);null!=b&&"string"==typeof b.value&&this.scopes.add(b.value),this.injectorDefTypes=new Set(this.get(Tr.multi,xn,ae.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const l=ie(this),h=on(void 0);try{return o()}finally{ie(l),on(h)}}get(o,l=f,h=ae.Default){this.assertNotDestroyed();const g=ie(this),b=on(void 0);try{if(!(h&ae.SkipSelf)){let L=this.records.get(o);if(void 0===L){const U=function e_(r){return"function"==typeof r||"object"==typeof r&&r instanceof qr}(o)&&ht(o);L=U&&this.injectableDefInScope(U)?du(Cc(o),Bu):null,this.records.set(o,L)}if(null!=L)return this.hydrate(o,L)}return(h&ae.Self?gd():this.parent).get(o,l=h&ae.Optional&&l===f?null:l)}catch(T){if("NullInjectorError"===T.name){if((T[x]=T[x]||[]).unshift(Le(o)),g)throw T;return function ze(r,o,l,h){const g=r[x];throw o[W]&&g.unshift(o[W]),r.message=function st(r,o,l,h=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let g=Le(o);if(Array.isArray(o))g=o.map(Le).join(" -> ");else if("object"==typeof o){let b=[];for(let T in o)if(o.hasOwnProperty(T)){let L=o[T];b.push(T+":"+("string"==typeof L?JSON.stringify(L):Le(L)))}g=`{${b.join(", ")}}`}return`${l}${h?"("+h+")":""}[${g}]: ${r.replace(P,"\n  ")}`}("\n"+r.message,g,l,h),r.ngTokenPath=g,r[x]=null,r}(T,o,"R3InjectorError",this.source)}throw T}finally{on(b),ie(g)}}resolveInjectorInitializers(){const o=ie(this),l=on(void 0);try{const h=this.get(oc.multi,xn,ae.Self);for(const g of h)g()}finally{ie(o),on(l)}}toString(){const o=[],l=this.records;for(const h of l.keys())o.push(Le(h));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new tt(205,!1)}processProvider(o){let l=Sl(o=Et(o))?o:Et(o&&o.provide);const h=function fh(r){return dh(r)?du(void 0,r.useValue):du(mh(r),Bu)}(o);if(Sl(o)||!0!==o.multi)this.records.get(l);else{let g=this.records.get(l);g||(g=du(void 0,Bu,!0),g.factory=()=>Te(g.multi),this.records.set(l,g)),l=o,g.multi.push(o)}this.records.set(l,h)}hydrate(o,l){return l.value===Bu&&(l.value=Qg,l.value=l.factory()),"object"==typeof l.value&&l.value&&function Jf(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(l.value)&&this._ngOnDestroyHooks.add(l.value),l.value}injectableDefInScope(o){if(!o.providedIn)return!1;const l=Et(o.providedIn);return"string"==typeof l?"any"===l||this.scopes.has(l):this.injectorDefTypes.has(l)}}function Cc(r){const o=ht(r),l=null!==o?o.factory:ys(r);if(null!==l)return l;if(r instanceof qr)throw new tt(204,!1);if(r instanceof Function)return function ph(r){const o=r.length;if(o>0)throw wl(o,"?"),new tt(204,!1);const l=function ot(r){const o=r&&(r[tn]||r[Wi]);if(o){const l=function Se(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${l}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${l}" class.`),o}return null}(r);return null!==l?()=>l.factory(r):()=>new r}(r);throw new tt(204,!1)}function mh(r,o,l){let h;if(Sl(r)){const g=Et(r);return ys(g)||Cc(g)}if(dh(r))h=()=>Et(r.useValue);else if(function Ep(r){return!(!r||!r.useFactory)}(r))h=()=>r.useFactory(...Te(r.deps||[]));else if(function Zl(r){return!(!r||!r.useExisting)}(r))h=()=>Pe(Et(r.useExisting));else{const g=Et(r&&(r.useClass||r.provide));if(!function Jg(r){return!!r.deps}(r))return ys(g)||Cc(g);h=()=>new g(...Te(r.deps))}return h}function du(r,o,l=!1){return{factory:r,value:o,multi:l?[]:void 0}}function Mp(r){return!!r.\u0275providers}function Dp(r,o){for(const l of r)Array.isArray(l)?Dp(l,o):Mp(l)?Dp(l.\u0275providers,o):o(l)}class Sp{}class n_{resolveComponentFactory(o){throw function em(r){const o=Error(`No component factory found for ${Le(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let ac=(()=>{class r{}return r.NULL=new n_,r})();function gh(){return hu(zr(),wn())}function hu(r,o){return new Nu(go(r,o))}let Nu=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=gh,r})();function i_(r){return r instanceof Nu?r.nativeElement:r}class _d{}let Xa=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function tm(){const r=wn(),l=cr(zr().index,r);return(Ki(l)?l:r)[11]}(),r})(),nm=(()=>{class r{}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:()=>null}),r})();class Al{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Ap=new Al("14.2.11"),Mc={};function Ja(r){return r.ngOriginalError}class mu{constructor(){this._console=console}handleError(o){const l=this._findOriginalError(o);this._console.error("ERROR",o),l&&this._console.error("ORIGINAL ERROR",l)}_findOriginalError(o){let l=o&&Ja(o);for(;l&&Ja(l);)l=Ja(l);return l||null}}const Tc=new Map;let am=0;const bh="__ngContext__";function ya(r,o){Ki(o)?(r[bh]=o[20],function cm(r){Tc.set(r[20],r)}(o)):r[bh]=o}function Pl(r){return r instanceof Function?r():r}var cc=(()=>((cc=cc||{})[cc.Important=1]="Important",cc[cc.DashCase=2]="DashCase",cc))();function Lp(r,o){return undefined(r,o)}function uc(r){const o=r[3];return vr(o)?o[3]:o}function ju(r){return Ed(r[13])}function Mh(r){return Ed(r[4])}function Ed(r){for(;null!==r&&!vr(r);)r=r[4];return r}function dc(r,o,l,h,g){if(null!=h){let b,T=!1;vr(h)?b=h:Ki(h)&&(T=!0,h=h[0]);const L=Fr(h);0===r&&null!==l?null==g?vm(o,l,L):_u(o,l,L,g||null,!0):1===r&&null!==l?_u(o,l,L,g||null,!0):2===r?function Ad(r,o,l){const h=Ac(r,o);h&&function b_(r,o,l,h){r.removeChild(o,l,h)}(r,h,o,l)}(o,L,T):3===r&&o.destroyNode(L),null!=b&&function Em(r,o,l,h,g){const b=l[7];b!==Fr(l)&&dc(o,r,h,b,g);for(let L=10;L<l.length;L++){const U=l[L];Id(U[1],U,r,o,h,b)}}(o,r,b,l,g)}}function Md(r,o,l){return r.createElement(o,l)}function gm(r,o){const l=r[9],h=l.indexOf(o),g=o[3];512&o[2]&&(o[2]&=-513,_o(g,-1)),l.splice(h,1)}function Td(r,o){if(r.length<=10)return;const l=10+o,h=r[l];if(h){const g=h[17];null!==g&&g!==r&&gm(g,h),o>0&&(r[l-1][4]=h[4]);const b=ic(r,10+o);!function zp(r,o){Id(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(h[1],h);const T=b[19];null!==T&&T.detachView(b[1]),h[3]=null,h[4]=null,h[2]&=-65}return h}function Th(r,o){if(!(128&o[2])){const l=o[11];l.destroyNode&&Id(r,o,l,3,null,null),function Dd(r){let o=r[13];if(!o)return Hu(r[1],r);for(;o;){let l=null;if(Ki(o))l=o[13];else{const h=o[10];h&&(l=h)}if(!l){for(;o&&!o[4]&&o!==r;)Ki(o)&&Hu(o[1],o),o=o[3];null===o&&(o=r),Ki(o)&&Hu(o[1],o),l=o&&o[4]}o=l}}(o)}}function Hu(r,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function x_(r,o){let l;if(null!=r&&null!=(l=r.destroyHooks))for(let h=0;h<l.length;h+=2){const g=o[l[h]];if(!(g instanceof No)){const b=l[h+1];if(Array.isArray(b))for(let T=0;T<b.length;T+=2){const L=g[b[T]],U=b[T+1];try{U.call(L)}finally{}}else try{b.call(g)}finally{}}}}(r,o),function v_(r,o){const l=r.cleanup,h=o[7];let g=-1;if(null!==l)for(let b=0;b<l.length-1;b+=2)if("string"==typeof l[b]){const T=l[b+1],L="function"==typeof T?T(o):Fr(o[T]),U=h[g=l[b+2]],ne=l[b+3];"boolean"==typeof ne?L.removeEventListener(l[b],U,ne):ne>=0?h[g=ne]():h[g=-ne].unsubscribe(),b+=2}else{const T=h[g=l[b+1]];l[b].call(T)}if(null!==h){for(let b=g+1;b<h.length;b++)(0,h[b])();o[7]=null}}(r,o),1===o[1].type&&o[11].destroy();const l=o[17];if(null!==l&&vr(o[3])){l!==o[3]&&gm(l,o);const h=o[19];null!==h&&h.detachView(r)}!function l_(r){Tc.delete(r[20])}(o)}}function _m(r,o,l){return function ym(r,o,l){let h=o;for(;null!==h&&40&h.type;)h=(o=h).parent;if(null===h)return l[0];if(2&h.flags){const g=r.data[h.directiveStart].encapsulation;if(g===nt.None||g===nt.Emulated)return null}return go(h,l)}(r,o.parent,l)}function _u(r,o,l,h,g){r.insertBefore(o,l,h,g)}function vm(r,o,l){r.appendChild(o,l)}function Sd(r,o,l,h,g){null!==h?_u(r,o,l,h,g):vm(r,o,l)}function Ac(r,o){return r.parentNode(o)}function xm(r,o,l){return Vp(r,o,l)}let Vp=function bm(r,o,l){return 40&r.type?go(r,l):null};function Ah(r,o,l,h){const g=_m(r,h,o),b=o[11],L=xm(h.parent||o[6],h,o);if(null!=g)if(Array.isArray(l))for(let U=0;U<l.length;U++)Sd(b,g,l[U],L,!1);else Sd(b,g,l,L,!1)}function Ih(r,o){if(null!==o){const l=o.type;if(3&l)return go(o,r);if(4&l)return Gu(-1,r[o.index]);if(8&l){const h=o.child;if(null!==h)return Ih(r,h);{const g=r[o.index];return vr(g)?Gu(-1,g):Fr(g)}}if(32&l)return Lp(o,r)()||Fr(r[o.index]);{const h=Ph(r,o);return null!==h?Array.isArray(h)?h[0]:Ih(uc(r[16]),h):Ih(r,o.next)}}return null}function Ph(r,o){return null!==o?r[16][6].projection[o.projection]:null}function Gu(r,o){const l=10+r+1;if(l<o.length){const h=o[l],g=h[1].firstChild;if(null!==g)return Ih(h,g)}return o[7]}function jp(r,o,l,h,g,b,T){for(;null!=l;){const L=h[l.index],U=l.type;if(T&&0===o&&(L&&ya(Fr(L),h),l.flags|=4),64!=(64&l.flags))if(8&U)jp(r,o,l.child,h,g,b,!1),dc(o,r,g,L,b);else if(32&U){const ne=Lp(l,h);let xe;for(;xe=ne();)dc(o,r,g,xe,b);dc(o,r,g,L,b)}else 16&U?$u(r,o,h,l,g,b):dc(o,r,g,L,b);l=T?l.projectionNext:l.next}}function Id(r,o,l,h,g,b){jp(l,h,r.firstChild,o,g,b,!1)}function $u(r,o,l,h,g,b){const T=l[16],U=T[6].projection[h.projection];if(Array.isArray(U))for(let ne=0;ne<U.length;ne++)dc(o,r,g,U[ne],b);else jp(r,o,U,T[3],g,b,!0)}function Hp(r,o,l){r.setAttribute(o,"style",l)}function Gp(r,o,l){""===l?r.removeAttribute(o,"class"):r.setAttribute(o,"class",l)}function $p(r,o,l){let h=r.length;for(;;){const g=r.indexOf(o,l);if(-1===g)return g;if(0===g||r.charCodeAt(g-1)<=32){const b=o.length;if(g+b===h||r.charCodeAt(g+b)<=32)return g}l=g+1}}const Zp="ng-template";function Cm(r,o,l){let h=0;for(;h<r.length;){let g=r[h++];if(l&&"class"===g){if(g=r[h],-1!==$p(g.toLowerCase(),o,0))return!0}else if(1===g){for(;h<r.length&&"string"==typeof(g=r[h++]);)if(g.toLowerCase()===o)return!0;return!1}}return!1}function Wp(r){return 4===r.type&&r.value!==Zp}function Mm(r,o,l){return o===(4!==r.type||l?r.value:Zp)}function M_(r,o,l){let h=4;const g=r.attrs||[],b=function va(r){for(let o=0;o<r.length;o++)if(M(r[o]))return o;return r.length}(g);let T=!1;for(let L=0;L<o.length;L++){const U=o[L];if("number"!=typeof U){if(!T)if(4&h){if(h=2|1&h,""!==U&&!Mm(r,U,l)||""===U&&1===o.length){if(Wl(h))return!1;T=!0}}else{const ne=8&h?U:o[++L];if(8&h&&null!==r.attrs){if(!Cm(r.attrs,ne,l)){if(Wl(h))return!1;T=!0}continue}const qe=Dm(8&h?"class":U,g,Wp(r),l);if(-1===qe){if(Wl(h))return!1;T=!0;continue}if(""!==ne){let Nt;Nt=qe>b?"":g[qe+1].toLowerCase();const cn=8&h?Nt:null;if(cn&&-1!==$p(cn,ne,0)||2&h&&ne!==Nt){if(Wl(h))return!1;T=!0}}}}else{if(!T&&!Wl(h)&&!Wl(U))return!1;if(T&&Wl(U))continue;T=!1,h=U|1&h}}return Wl(h)||T}function Wl(r){return 0==(1&r)}function Dm(r,o,l,h){if(null===o)return-1;let g=0;if(h||!l){let b=!1;for(;g<o.length;){const T=o[g];if(T===r)return g;if(3===T||6===T)b=!0;else{if(1===T||2===T){let L=o[++g];for(;"string"==typeof L;)L=o[++g];continue}if(4===T)break;if(0===T){g+=4;continue}}g+=b?1:2}return-1}return function kd(r,o){let l=r.indexOf(4);if(l>-1)for(l++;l<r.length;){const h=r[l];if("number"==typeof h)return-1;if(h===o)return l;l++}return-1}(o,r)}function Rd(r,o,l=!1){for(let h=0;h<o.length;h++)if(M_(r,o[h],l))return!0;return!1}function Zu(r,o){e:for(let l=0;l<o.length;l++){const h=o[l];if(r.length===h.length){for(let g=0;g<r.length;g++)if(r[g]!==h[g])continue e;return!0}}return!1}function Wu(r,o){return r?":not("+o.trim()+")":o}function Sm(r){let o=r[0],l=1,h=2,g="",b=!1;for(;l<r.length;){let T=r[l];if("string"==typeof T)if(2&h){const L=r[++l];g+="["+T+(L.length>0?'="'+L+'"':"")+"]"}else 8&h?g+="."+T:4&h&&(g+=" "+T);else""!==g&&!Wl(T)&&(o+=Wu(b,g),g=""),h=T,b=b||!Wl(h);l++}return""!==g&&(o+=Wu(b,g)),o}const gr={};function Im(r){Pm(ar(),wn(),yt()+r,!1)}function Pm(r,o,l,h){if(!h)if(3==(3&o[2])){const b=r.preOrderCheckHooks;null!==b&&eo(o,b,l)}else{const b=r.preOrderHooks;null!==b&&Wo(o,b,0,l)}vn(l)}function Lm(r,o=null,l=null,h){const g=Bm(r,o,l,h);return g.resolveInjectorInitializers(),g}function Bm(r,o=null,l=null,h,g=new Set){const b=[l||xn,wp(r)];return h=h||("object"==typeof r?void 0:Le(r)),new sc(b,o||gd(),h||null,g)}let yu=(()=>{class r{static create(l,h){if(Array.isArray(l))return Lm({name:""},h,l,"");{const g=l.name??"";return Lm({name:g},l.parent,l.providers,g)}}}return r.THROW_IF_NOT_FOUND=f,r.NULL=new bp,r.\u0275prov=Tt({token:r,providedIn:"any",factory:()=>Pe(fd)}),r.__NG_ELEMENT_ID__=-1,r})();function Pc(r,o=ae.Default){const l=wn();return null===l?Pe(r,o):xo(zr(),l,Et(r),o)}function vu(){throw new Error("invalid")}function Fh(r,o){return r<<17|o<<2}function ql(r){return r>>17&32767}function Nd(r){return 2|r}function pc(r){return(131068&r)>>2}function za(r,o){return-131069&r|o<<2}function Zc(r){return 1|r}function kc(r,o){const l=r.contentQueries;if(null!==l)for(let h=0;h<l.length;h+=2){const g=l[h],b=l[h+1];if(-1!==b){const T=r.data[b];gl(g),T.contentQueries(2,o[b],b)}}}function bu(r,o,l,h,g,b,T,L,U,ne,xe){const qe=o.blueprint.slice();return qe[0]=g,qe[2]=76|h,(null!==xe||r&&1024&r[2])&&(qe[2]|=1024),vs(qe),qe[3]=qe[15]=r,qe[8]=l,qe[10]=T||r&&r[10],qe[11]=L||r&&r[11],qe[12]=U||r&&r[12]||null,qe[9]=ne||r&&r[9]||null,qe[6]=b,qe[20]=function lm(){return am++}(),qe[21]=xe,qe[16]=2==o.type?r[16]:qe,qe}function qc(r,o,l,h,g){let b=r.data[o];if(null===b)b=function hf(r,o,l,h,g){const b=Q(),T=be(),U=r.data[o]=function pf(r,o,l,h,g,b){return{type:l,index:h,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:g,attrs:b,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,T?b:b&&b.parent,l,o,h,g);return null===r.firstChild&&(r.firstChild=U),null!==b&&(T?null==b.child&&null!==U.parent&&(b.child=U):null===b.next&&(b.next=U)),U}(r,o,l,h,g),function Ll(){return Gi.lFrame.inI18n}()&&(b.flags|=64);else if(64&b.type){b.type=l,b.value=h,b.attrs=g;const T=function q(){const r=Gi.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();b.injectorIndex=null===T?-1:T.injectorIndex}return j(b,!0),b}function Xu(r,o,l,h){if(0===l)return-1;const g=o.length;for(let b=0;b<l;b++)o.push(h),r.blueprint.push(h),r.data.push(null);return g}function Uh(r,o,l){al(o);try{const h=r.viewQuery;null!==h&&$h(1,h,l);const g=r.template;null!==g&&Qu(r,o,g,1,l),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&kc(r,o),r.staticViewQueries&&$h(2,r.viewQuery,l);const b=r.components;null!==b&&function sg(r,o){for(let l=0;l<o.length;l++)$_(r,o[l])}(o,b)}catch(h){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),h}finally{o[2]&=-5,re()}}function Gd(r,o,l,h){const g=o[2];if(128!=(128&g)){al(o);try{vs(o),function Aa(r){return Gi.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==l&&Qu(r,o,l,2,h);const T=3==(3&g);if(T){const ne=r.preOrderCheckHooks;null!==ne&&eo(o,ne,null)}else{const ne=r.preOrderHooks;null!==ne&&Wo(o,ne,0,null),cs(o,0)}if(function qd(r){for(let o=ju(r);null!==o;o=Mh(o)){if(!o[2])continue;const l=o[9];for(let h=0;h<l.length;h++){const g=l[h],b=g[3];0==(512&g[2])&&_o(b,1),g[2]|=512}}}(o),function Wd(r){for(let o=ju(r);null!==o;o=Mh(o))for(let l=10;l<o.length;l++){const h=o[l],g=h[1];zs(h)&&Gd(g,h,g.template,h[8])}}(o),null!==r.contentQueries&&kc(r,o),T){const ne=r.contentCheckHooks;null!==ne&&eo(o,ne)}else{const ne=r.contentHooks;null!==ne&&Wo(o,ne,1),cs(o,1)}!function j_(r,o){const l=r.hostBindingOpCodes;if(null!==l)try{for(let h=0;h<l.length;h++){const g=l[h];if(g<0)vn(~g);else{const b=g,T=l[++h],L=l[++h];js(T,b),L(2,o[b])}}}finally{vn(-1)}}(r,o);const L=r.components;null!==L&&function og(r,o){for(let l=0;l<o.length;l++)Yd(r,o[l])}(o,L);const U=r.viewQuery;if(null!==U&&$h(2,U,h),T){const ne=r.viewCheckHooks;null!==ne&&eo(o,ne)}else{const ne=r.viewHooks;null!==ne&&Wo(o,ne,2),cs(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,_o(o[3],-1))}finally{re()}}}function Qu(r,o,l,h,g){const b=yt(),T=2&h;try{vn(-1),T&&o.length>22&&Pm(r,o,22,!1),l(h,g)}finally{vn(b)}}function fc(r,o,l){if(to(o)){const g=o.directiveEnd;for(let b=o.directiveStart;b<g;b++){const T=r.data[b];T.contentQueries&&T.contentQueries(1,l[b],b)}}}function $d(r,o,l){!As()||(function hg(r,o,l,h){const g=l.directiveStart,b=l.directiveEnd;r.firstCreatePass||Mr(l,o),ya(h,o);const T=l.initialInputs;for(let L=g;L<b;L++){const U=r.data[L],ne=Zr(U);ne&&H_(o,l,U);const xe=Ur(o,r,L,l);ya(xe,o),null!==T&&G_(0,L-g,xe,U,0,T),ne&&(cr(l.index,o)[8]=xe)}}(r,o,l,go(l,o)),128==(128&l.flags)&&function Zd(r,o,l){const h=l.directiveStart,g=l.directiveEnd,b=l.index,T=function ol(){return Gi.lFrame.currentDirectiveIndex}();try{vn(b);for(let L=h;L<g;L++){const U=r.data[L],ne=o[L];sl(L),(null!==U.hostBindings||0!==U.hostVars||null!==U.hostAttrs)&&Hh(U,ne)}}finally{vn(-1),sl(T)}}(r,o,l))}function Yc(r,o,l=go){const h=o.localNames;if(null!==h){let g=o.index+1;for(let b=0;b<h.length;b+=2){const T=h[b+1],L=-1===T?l(o,r):r[T];r[g++]=L}}}function wu(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=el(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function el(r,o,l,h,g,b,T,L,U,ne){const xe=22+h,qe=xe+g,Nt=function Ol(r,o){const l=[];for(let h=0;h<o;h++)l.push(h<r?null:gr);return l}(xe,qe),cn="function"==typeof ne?ne():ne;return Nt[1]={type:r,blueprint:Nt,template:l,queries:null,viewQuery:L,declTNode:o,data:Nt.slice().fill(null,xe),bindingStartIndex:xe,expandoStartIndex:qe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof b?b():b,pipeRegistry:"function"==typeof T?T():T,firstChild:null,schemas:U,consts:cn,incompleteFirstPass:!1}}function lg(r,o,l,h){const g=gf(o);null===l?g.push(h):(g.push(l),r.firstCreatePass&&gg(r).push(h,g.length-1))}function Yl(r,o,l){for(let h in r)if(r.hasOwnProperty(h)){const g=r[h];(l=null===l?{}:l).hasOwnProperty(h)?l[h].push(o,g):l[h]=[o,g]}return l}function Kc(r,o){const h=o.directiveEnd,g=r.data,b=o.attrs,T=[];let L=null,U=null;for(let ne=o.directiveStart;ne<h;ne++){const xe=g[ne],qe=xe.inputs,Nt=null===b||Wp(o)?null:Xc(qe,b);T.push(Nt),L=Yl(qe,ne,L),U=Yl(xe.outputs,ne,U)}null!==L&&(L.hasOwnProperty("class")&&(o.flags|=16),L.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=T,o.inputs=L,o.outputs=U}function tl(r,o,l,h,g,b,T,L){const U=go(o,l);let xe,ne=o.inputs;!L&&null!=ne&&(xe=ne[h])?(Zh(r,l,xe,h,g),Br(o)&&ug(l,o.index)):3&o.type&&(h=function cg(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(h),g=null!=T?T(g,o.value||"",h):g,b.setProperty(U,h,g))}function ug(r,o){const l=cr(o,r);16&l[2]||(l[2]|=32)}function Eu(r,o,l,h){let g=!1;if(As()){const b=function pg(r,o,l){const h=r.directiveRegistry;let g=null;if(h)for(let b=0;b<h.length;b++){const T=h[b];Rd(l,T.selectors,!1)&&(g||(g=[]),ma(Mr(l,o),r,T.type),Zr(T)?(Cu(r,l),g.unshift(T)):g.push(T))}return g}(r,o,l),T=null===h?null:{"":-1};if(null!==b){g=!0,mf(l,r.data.length,b.length);for(let xe=0;xe<b.length;xe++){const qe=b[xe];qe.providersResolver&&qe.providersResolver(qe)}let L=!1,U=!1,ne=Xu(r,o,b.length,null);for(let xe=0;xe<b.length;xe++){const qe=b[xe];l.mergedAttrs=$(l.mergedAttrs,qe.hostAttrs),mg(r,l,o,ne,qe),ff(ne,qe,T),null!==qe.contentQueries&&(l.flags|=8),(null!==qe.hostBindings||null!==qe.hostAttrs||0!==qe.hostVars)&&(l.flags|=128);const Nt=qe.type.prototype;!L&&(Nt.ngOnChanges||Nt.ngOnInit||Nt.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(l.index),L=!0),!U&&(Nt.ngOnChanges||Nt.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(l.index),U=!0),ne++}Kc(r,l)}T&&function fg(r,o,l){if(o){const h=r.localNames=[];for(let g=0;g<o.length;g+=2){const b=l[o[g+1]];if(null==b)throw new tt(-301,!1);h.push(o[g],b)}}}(l,h,T)}return l.mergedAttrs=$(l.mergedAttrs,l.attrs),g}function ed(r,o,l,h,g,b){const T=b.hostBindings;if(T){let L=r.hostBindingOpCodes;null===L&&(L=r.hostBindingOpCodes=[]);const U=~o.index;(function jh(r){let o=r.length;for(;o>0;){const l=r[--o];if("number"==typeof l&&l<0)return l}return 0})(L)!=U&&L.push(U),L.push(h,g,T)}}function Hh(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function Cu(r,o){o.flags|=2,(r.components||(r.components=[])).push(o.index)}function ff(r,o,l){if(l){if(o.exportAs)for(let h=0;h<o.exportAs.length;h++)l[o.exportAs[h]]=r;Zr(o)&&(l[""]=r)}}function mf(r,o,l){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+l,r.providerIndexes=o}function mg(r,o,l,h,g){r.data[h]=g;const b=g.factory||(g.factory=ys(g.type)),T=new No(b,Zr(g),Pc);r.blueprint[h]=T,l[h]=T,ed(r,o,0,h,Xu(r,l,g.hostVars,gr),g)}function H_(r,o,l){const h=go(o,r),g=wu(l),b=r[10],T=Lc(r,bu(r,g,null,l.onPush?32:16,h,o,b,b.createRenderer(h,l),null,null,null));r[o.index]=T}function Kl(r,o,l,h,g,b){const T=go(r,o);!function Fc(r,o,l,h,g,b,T){if(null==b)r.removeAttribute(o,g,l);else{const L=null==T?kt(b):T(b,h||"",g);r.setAttribute(o,g,L,l)}}(o[11],T,b,r.value,l,h,g)}function G_(r,o,l,h,g,b){const T=b[o];if(null!==T){const L=h.setInput;for(let U=0;U<T.length;){const ne=T[U++],xe=T[U++],qe=T[U++];null!==L?h.setInput(l,qe,ne,xe):l[xe]=qe}}}function Xc(r,o){let l=null,h=0;for(;h<o.length;){const g=o[h];if(0!==g)if(5!==g){if("number"==typeof g)break;r.hasOwnProperty(g)&&(null===l&&(l=[]),l.push(g,r[g],o[h+1])),h+=2}else h+=2;else h+=4}return l}function td(r,o,l,h){return new Array(r,!0,!1,o,null,0,h,l,null,null)}function Yd(r,o){const l=cr(o,r);if(zs(l)){const h=l[1];48&l[2]?Gd(h,l,h.template,l[8]):l[5]>0&&nd(l)}}function nd(r){for(let h=ju(r);null!==h;h=Mh(h))for(let g=10;g<h.length;g++){const b=h[g];if(zs(b))if(512&b[2]){const T=b[1];Gd(T,b,T.template,b[8])}else b[5]>0&&nd(b)}const l=r[1].components;if(null!==l)for(let h=0;h<l.length;h++){const g=cr(l[h],r);zs(g)&&g[5]>0&&nd(g)}}function $_(r,o){const l=cr(o,r),h=l[1];(function Z_(r,o){for(let l=o.length;l<r.blueprint.length;l++)o.push(r.blueprint[l])})(h,l),Uh(h,l,l[8])}function Lc(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function id(r){for(;r;){r[2]|=32;const o=uc(r);if(Ds(r)&&!o)return r;r=o}return null}function Gh(r,o,l,h=!0){const g=o[10];g.begin&&g.begin();try{Gd(r,o,r.template,l)}catch(T){throw h&&_g(o,T),T}finally{g.end&&g.end()}}function $h(r,o,l){gl(0),o(r,l)}function gf(r){return r[7]||(r[7]=[])}function gg(r){return r.cleanup||(r.cleanup=[])}function _f(r,o,l){return(null===r||Zr(r))&&(l=function ml(r){for(;Array.isArray(r);){if("object"==typeof r[1])return r;r=r[0]}return null}(l[o.index])),l[11]}function _g(r,o){const l=r[9],h=l?l.get(mu,null):null;h&&h.handleError(o)}function Zh(r,o,l,h,g){for(let b=0;b<l.length;){const T=l[b++],L=l[b++],U=o[T],ne=r.data[T];null!==ne.setInput?ne.setInput(U,g,h,L):U[L]=g}}function Bc(r,o,l){const h=$o(o,r);!function Np(r,o,l){r.setValue(o,l)}(r[11],h,l)}function Wh(r,o,l){let h=l?r.styles:null,g=l?r.classes:null,b=0;if(null!==o)for(let T=0;T<o.length;T++){const L=o[T];"number"==typeof L?b=L:1==b?g=ke(g,L):2==b&&(h=ke(h,L+": "+o[++T]+";"))}l?r.styles=h:r.stylesWithoutHost=h,l?r.classes=g:r.classesWithoutHost=g}function Mu(r,o,l,h,g=!1){for(;null!==l;){const b=o[l.index];if(null!==b&&h.push(Fr(b)),vr(b))for(let L=10;L<b.length;L++){const U=b[L],ne=U[1].firstChild;null!==ne&&Mu(U[1],U,ne,h)}const T=l.type;if(8&T)Mu(r,o,l.child,h);else if(32&T){const L=Lp(l,o);let U;for(;U=L();)h.push(U)}else if(16&T){const L=Ph(o,l);if(Array.isArray(L))h.push(...L);else{const U=uc(o[16]);Mu(U[1],U,L,h,!0)}}l=g?l.projectionNext:l.next}return h}class Qc{constructor(o,l){this._lView=o,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,l=o[1];return Mu(l,o,l.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(vr(o)){const l=o[8],h=l?l.indexOf(this):-1;h>-1&&(Td(o,h),ic(l,h))}this._attachedToViewContainer=!1}Th(this._lView[1],this._lView)}onDestroy(o){lg(this._lView[1],this._lView,null,o)}markForCheck(){id(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Gh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new tt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function mm(r,o){Id(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new tt(902,!1);this._appRef=o}}class qh extends Qc{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Gh(o[1],o,o[8],!1)}checkNoChanges(){}get context(){return null}}class yf extends ac{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const l=Me(o);return new Kd(l,this.ngModule)}}function Yh(r){const o=[];for(let l in r)r.hasOwnProperty(l)&&o.push({propName:r[l],templateName:l});return o}class Jc{constructor(o,l){this.injector=o,this.parentInjector=l}get(o,l,h){const g=this.injector.get(o,Mc,h);return g!==Mc||l===Mc?g:this.parentInjector.get(o,l,h)}}class Kd extends Sp{constructor(o,l){super(),this.componentDef=o,this.ngModule=l,this.componentType=o.type,this.selector=function Am(r){return r.map(Sm).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!l}get inputs(){return Yh(this.componentDef.inputs)}get outputs(){return Yh(this.componentDef.outputs)}create(o,l,h,g){let b=(g=g||this.ngModule)instanceof uu?g:g?.injector;b&&null!==this.componentDef.getStandaloneInjector&&(b=this.componentDef.getStandaloneInjector(b)||b);const T=b?new Jc(o,b):o,L=T.get(_d,null);if(null===L)throw new tt(407,!1);const U=T.get(nm,null),ne=L.createRenderer(null,this.componentDef),xe=this.componentDef.selectors[0][0]||"div",qe=h?function ag(r,o,l){return r.selectRootElement(o,l===nt.ShadowDom)}(ne,h,this.componentDef.encapsulation):Md(ne,xe,function vf(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(xe)),Nt=this.componentDef.onPush?288:272,cn=el(0,null,null,1,0,null,null,null,null,null),Zn=bu(null,cn,null,Nt,null,null,L,ne,U,T,null);let ci,xi;al(Zn);try{const Ni=function Y_(r,o,l,h,g,b){const T=l[1];l[22]=r;const U=qc(T,22,2,"#host",null),ne=U.mergedAttrs=o.hostAttrs;null!==ne&&(Wh(U,ne,!0),null!==r&&(X(g,r,ne),null!==U.classes&&Gp(g,r,U.classes),null!==U.styles&&Hp(g,r,U.styles)));const xe=h.createRenderer(r,o),qe=bu(l,wu(o),null,o.onPush?32:16,l[22],U,h,xe,b||null,null,null);return T.firstCreatePass&&(ma(Mr(U,l),T,o.type),Cu(T,U),mf(U,l.length,1)),Lc(l,qe),l[22]=qe}(qe,this.componentDef,Zn,L,ne);if(qe)if(h)X(ne,qe,["ng-version",Ap.full]);else{const{attrs:Qi,classes:ei}=function D_(r){const o=[],l=[];let h=1,g=2;for(;h<r.length;){let b=r[h];if("string"==typeof b)2===g?""!==b&&o.push(b,r[++h]):8===g&&l.push(b);else{if(!Wl(g))break;g=b}h++}return{attrs:o,classes:l}}(this.componentDef.selectors[0]);Qi&&X(ne,qe,Qi),ei&&ei.length>0&&Gp(ne,qe,ei.join(" "))}if(xi=Ys(cn,22),void 0!==l){const Qi=xi.projection=[];for(let ei=0;ei<this.ngContentSelectors.length;ei++){const sr=l[ei];Qi.push(null!=sr?Array.from(sr):null)}}ci=function K_(r,o,l,h){const g=l[1],b=function Ju(r,o,l){const h=zr();r.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),mg(r,h,o,Xu(r,o,1,null),l),Kc(r,h));const g=Ur(o,r,h.directiveStart,h);ya(g,o);const b=go(h,o);return b&&ya(b,o),g}(g,l,o);if(r[8]=l[8]=b,null!==h)for(const L of h)L(b,o);if(o.contentQueries){const L=zr();o.contentQueries(1,b,L.directiveStart)}const T=zr();return!g.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(vn(T.index),ed(l[1],T,0,T.directiveStart,T.directiveEnd,o),Hh(o,b)),b}(Ni,this.componentDef,Zn,[X_]),Uh(cn,Zn,null)}finally{re()}return new Kh(this.componentType,ci,hu(xi,Zn),Zn,xi)}}class Kh extends class Tp{}{constructor(o,l,h,g,b){super(),this.location=h,this._rootLView=g,this._tNode=b,this.instance=l,this.hostView=this.changeDetectorRef=new qh(g),this.componentType=o}setInput(o,l){const h=this._tNode.inputs;let g;if(null!==h&&(g=h[o])){const b=this._rootLView;Zh(b[1],b,g,o,l),ug(b,this._tNode.index)}}get injector(){return new Ii(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function X_(){const r=zr();Ir(wn()[1],r)}function bf(r){let o=function Xh(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),l=!0;const h=[r];for(;o;){let g;if(Zr(r))g=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new tt(903,!1);g=o.\u0275dir}if(g){if(l){h.push(g);const T=r;T.inputs=wf(r.inputs),T.declaredInputs=wf(r.declaredInputs),T.outputs=wf(r.outputs);const L=g.hostBindings;L&&J_(r,L);const U=g.viewQuery,ne=g.contentQueries;if(U&&Q_(r,U),ne&&yg(r,ne),it(r.inputs,g.inputs),it(r.declaredInputs,g.declaredInputs),it(r.outputs,g.outputs),Zr(g)&&g.data.animation){const xe=r.data;xe.animation=(xe.animation||[]).concat(g.data.animation)}}const b=g.features;if(b)for(let T=0;T<b.length;T++){const L=b[T];L&&L.ngInherit&&L(r),L===bf&&(l=!1)}}o=Object.getPrototypeOf(o)}!function Xd(r){let o=0,l=null;for(let h=r.length-1;h>=0;h--){const g=r[h];g.hostVars=o+=g.hostVars,g.hostAttrs=$(g.hostAttrs,l=$(l,g.hostAttrs))}}(h)}function wf(r){return r===Oi?{}:r===xn?[]:r}function Q_(r,o){const l=r.viewQuery;r.viewQuery=l?(h,g)=>{o(h,g),l(h,g)}:o}function yg(r,o){const l=r.contentQueries;r.contentQueries=l?(h,g,b)=>{o(h,g,b),l(h,g,b)}:o}function J_(r,o){const l=r.hostBindings;r.hostBindings=l?(h,g)=>{o(h,g),l(h,g)}:o}let Xl=null;function xa(){if(!Xl){const r=Ht.Symbol;if(r&&r.iterator)Xl=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let l=0;l<o.length;++l){const h=o[l];"entries"!==h&&"size"!==h&&Map.prototype[h]===Map.prototype.entries&&(Xl=h)}}}return Xl}function eu(r){return!!Qh(r)&&(Array.isArray(r)||!(r instanceof Map)&&xa()in r)}function Qh(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function gc(r,o,l){return r[o]=l}function sa(r,o,l){return!Object.is(r[o],l)&&(r[o]=l,!0)}function tu(r,o,l,h){const g=sa(r,o,l);return sa(r,o+1,h)||g}function Jh(r,o,l,h){const g=wn();return sa(g,Vs(),o)&&(ar(),Kl(On(),g,r,o,l,h)),Jh}function hl(r,o,l,h){return sa(r,Vs(),l)?o+kt(l)+h:gr}function Su(r,o,l,h,g,b){const L=tu(r,function Zo(){return Gi.lFrame.bindingIndex}(),l,g);return Xs(2),L?o+kt(l)+h+kt(g)+b:gr}function Tf(r,o,l,h,g,b,T,L){const U=wn(),ne=ar(),xe=r+22,qe=ne.firstCreatePass?function ey(r,o,l,h,g,b,T,L,U){const ne=o.consts,xe=qc(o,r,4,T||null,ss(ne,L));Eu(o,l,xe,ss(ne,U)),Ir(o,xe);const qe=xe.tViews=el(2,xe,h,g,b,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ne);return null!==o.queries&&(o.queries.template(o,xe),qe.queries=o.queries.embeddedTView(xe)),xe}(xe,ne,U,o,l,h,g,b,T):ne.data[xe];j(qe,!1);const Nt=U[11].createComment("");Ah(ne,U,Nt,qe),ya(Nt,U),Lc(U,U[xe]=td(Nt,U,Nt,qe)),pr(qe)&&$d(ne,U,qe),null!=T&&Yc(U,qe,L)}function Cg(r){return pa(function io(){return Gi.lFrame.contextLView}(),22+r)}function eh(r,o,l){const h=wn();return sa(h,Vs(),o)&&tl(ar(),On(),h,r,o,h[11],l,!1),eh}function np(r,o,l,h,g){const T=g?"class":"style";Zh(r,l,o.inputs[T],T,h)}function t(r,o,l,h){const g=wn(),b=ar(),T=22+r,L=g[11],U=g[T]=Md(L,o,function xr(){return Gi.lFrame.currentNamespace}()),ne=b.firstCreatePass?function Mg(r,o,l,h,g,b,T){const L=o.consts,ne=qc(o,r,2,g,ss(L,b));return Eu(o,l,ne,ss(L,T)),null!==ne.attrs&&Wh(ne,ne.attrs,!1),null!==ne.mergedAttrs&&Wh(ne,ne.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,ne),ne}(T,b,g,0,o,l,h):b.data[T];j(ne,!0);const xe=ne.mergedAttrs;null!==xe&&X(L,U,xe);const qe=ne.classes;null!==qe&&Gp(L,U,qe);const Nt=ne.styles;return null!==Nt&&Hp(L,U,Nt),64!=(64&ne.flags)&&Ah(b,g,U,ne),0===function Ta(){return Gi.lFrame.elementDepthCount}()&&ya(U,g),function Us(){Gi.lFrame.elementDepthCount++}(),pr(ne)&&($d(b,g,ne),fc(b,ne,g)),null!==h&&Yc(g,ne),t}function e(){let r=zr();be()?En():(r=r.parent,j(r,!1));const o=r;!function as(){Gi.lFrame.elementDepthCount--}();const l=ar();return l.firstCreatePass&&(Ir(l,r),to(r)&&l.queries.elementEnd(r)),null!=o.classesWithoutHost&&function Oa(r){return 0!=(16&r.flags)}(o)&&np(l,o,wn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function tc(r){return 0!=(32&r.flags)}(o)&&np(l,o,wn(),o.stylesWithoutHost,!1),e}function n(r,o,l,h){return t(r,o,l,h),e(),n}function u(r,o,l){const h=wn(),g=ar(),b=r+22,T=g.firstCreatePass?function s(r,o,l,h,g){const b=o.consts,T=ss(b,h),L=qc(o,r,8,"ng-container",T);return null!==T&&Wh(L,T,!0),Eu(o,l,L,ss(b,g)),null!==o.queries&&o.queries.elementStart(o,L),L}(b,g,h,o,l):g.data[b];j(T,!0);const L=h[b]=h[11].createComment("");return Ah(g,h,L,T),ya(L,h),pr(T)&&($d(g,h,T),fc(g,T,h)),null!=l&&Yc(h,T),u}function p(){let r=zr();const o=ar();return be()?En():(r=r.parent,j(r,!1)),o.firstCreatePass&&(Ir(o,r),to(r)&&o.queries.elementEnd(r)),p}function v(){return wn()}function E(r){return!!r&&"function"==typeof r.then}function C(r){return!!r&&"function"==typeof r.subscribe}const R=C;function N(r,o,l,h){const g=wn(),b=ar(),T=zr();return J(b,g,g[11],T,r,o,0,h),N}function H(r,o){const l=zr(),h=wn(),g=ar();return J(g,h,_f(Wa(g.data),l,h),l,r,o),H}function J(r,o,l,h,g,b,T,L){const U=pr(h),xe=r.firstCreatePass&&gg(r),qe=o[8],Nt=gf(o);let cn=!0;if(3&h.type||L){const xi=go(h,o),Ni=L?L(xi):xi,Qi=Nt.length,ei=L?wo=>L(Fr(wo[h.index])):h.index;let sr=null;if(!L&&U&&(sr=function K(r,o,l,h){const g=r.cleanup;if(null!=g)for(let b=0;b<g.length-1;b+=2){const T=g[b];if(T===l&&g[b+1]===h){const L=o[7],U=g[b+2];return L.length>U?L[U]:null}"string"==typeof T&&(b+=2)}return null}(r,o,g,h.index)),null!==sr)(sr.__ngLastListenerFn__||sr).__ngNextListenerFn__=b,sr.__ngLastListenerFn__=b,cn=!1;else{b=De(h,o,qe,b,!1);const wo=l.listen(Ni,g,b);Nt.push(b,wo),xe&&xe.push(g,ei,Qi,Qi+1)}}else b=De(h,o,qe,b,!1);const Zn=h.outputs;let ci;if(cn&&null!==Zn&&(ci=Zn[g])){const xi=ci.length;if(xi)for(let Ni=0;Ni<xi;Ni+=2){const ns=o[ci[Ni]][ci[Ni+1]].subscribe(b),sh=Nt.length;Nt.push(b,ns),xe&&xe.push(g,h.index,sh,-(sh+1))}}}function se(r,o,l,h){try{return!1!==l(h)}catch(g){return _g(r,g),!1}}function De(r,o,l,h,g){return function b(T){if(T===Function)return h;id(2&r.flags?cr(r.index,o):o);let U=se(o,0,h,T),ne=b.__ngNextListenerFn__;for(;ne;)U=se(o,0,ne,T)&&U,ne=ne.__ngNextListenerFn__;return g&&!1===U&&(T.preventDefault(),T.returnValue=!1),U}}function We(r=1){return function G(r){return(Gi.lFrame.contextLView=function ye(r,o){for(;r>0;)o=o[15],r--;return o}(r,Gi.lFrame.contextLView))[8]}(r)}function gt(r,o){let l=null;const h=function Tm(r){const o=r.attrs;if(null!=o){const l=o.indexOf(5);if(0==(1&l))return o[l+1]}return null}(r);for(let g=0;g<o.length;g++){const b=o[g];if("*"!==b){if(null===h?Rd(r,b,!0):Zu(h,b))return g}else l=g}return l}function Ze(r){const o=wn()[16][6];if(!o.projection){const h=o.projection=wl(r?r.length:1,null),g=h.slice();let b=o.child;for(;null!==b;){const T=r?gt(b,r):0;null!==T&&(g[T]?g[T].projectionNext=b:h[T]=b,g[T]=b),b=b.next}}}function at(r,o=0,l){const h=wn(),g=ar(),b=qc(g,22+r,16,null,l||null);null===b.projection&&(b.projection=o),En(),64!=(64&b.flags)&&function Pd(r,o,l){$u(o[11],0,o,l,_m(r,l,o),xm(l.parent||o[6],l,o))}(g,h,b)}function Ct(r,o,l){return mt(r,"",o,"",l),Ct}function mt(r,o,l,h,g){const b=wn(),T=hl(b,o,l,h);return T!==gr&&tl(ar(),On(),b,r,T,b[11],g,!1),mt}function Fi(r,o,l,h,g){const b=r[l+1],T=null===o;let L=h?ql(b):pc(b),U=!1;for(;0!==L&&(!1===U||T);){const xe=r[L+1];ui(r[L],o)&&(U=!0,r[L+1]=h?Zc(xe):Nd(xe)),L=h?ql(xe):pc(xe)}U&&(r[l+1]=h?Nd(b):Zc(b))}function ui(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&et(r,o)>=0}function Ro(r,o,l){return Rr(r,o,l,!1),Ro}function fs(r,o){return Rr(r,o,null,!0),fs}function Rr(r,o,l,h){const g=wn(),b=ar(),T=Xs(2);b.firstUpdatePass&&function Lo(r,o,l,h){const g=r.data;if(null===g[l+1]){const b=g[yt()],T=function $r(r,o){return o>=r.expandoStartIndex}(r,l);(function ip(r,o){return 0!=(r.flags&(o?16:32))})(b,h)&&null===o&&!T&&(o=!1),o=function aa(r,o,l,h){const g=Wa(r);let b=h?o.residualClasses:o.residualStyles;if(null===g)0===(h?o.classBindings:o.styleBindings)&&(l=pl(l=ms(null,r,o,l,h),o.attrs,h),b=null);else{const T=o.directiveStylingLast;if(-1===T||r[T]!==g)if(l=ms(g,r,o,l,h),null===b){let U=function Os(r,o,l){const h=l?o.classBindings:o.styleBindings;if(0!==pc(h))return r[ql(h)]}(r,o,h);void 0!==U&&Array.isArray(U)&&(U=ms(null,r,o,U[1],h),U=pl(U,o.attrs,h),function Rs(r,o,l,h){r[ql(l?o.classBindings:o.styleBindings)]=h}(r,o,h,U))}else b=function ba(r,o,l){let h;const g=o.directiveEnd;for(let b=1+o.directiveStylingLast;b<g;b++)h=pl(h,r[b].hostAttrs,l);return pl(h,o.attrs,l)}(r,o,h)}return void 0!==b&&(h?o.residualClasses=b:o.residualStyles=b),l}(g,b,o,h),function yn(r,o,l,h,g,b){let T=b?o.classBindings:o.styleBindings,L=ql(T),U=pc(T);r[h]=l;let xe,ne=!1;if(Array.isArray(l)){const qe=l;xe=qe[1],(null===xe||et(qe,xe)>0)&&(ne=!0)}else xe=l;if(g)if(0!==U){const Nt=ql(r[L+1]);r[h+1]=Fh(Nt,L),0!==Nt&&(r[Nt+1]=za(r[Nt+1],h)),r[L+1]=function tf(r,o){return 131071&r|o<<17}(r[L+1],h)}else r[h+1]=Fh(L,0),0!==L&&(r[L+1]=za(r[L+1],h)),L=h;else r[h+1]=Fh(U,0),0===L?L=h:r[U+1]=za(r[U+1],h),U=h;ne&&(r[h+1]=Nd(r[h+1])),Fi(r,xe,h,!0),Fi(r,xe,h,!1),function oi(r,o,l,h,g){const b=g?r.residualClasses:r.residualStyles;null!=b&&"string"==typeof o&&et(b,o)>=0&&(l[h+1]=Zc(l[h+1]))}(o,xe,r,h,b),T=Fh(L,U),b?o.classBindings=T:o.styleBindings=T}(g,b,o,l,T,h)}}(b,r,T,h),o!==gr&&sa(g,T,o)&&function Sf(r,o,l,h,g,b,T,L){if(!(3&o.type))return;const U=r.data,ne=U[L+1];nh(function Ku(r){return 1==(1&r)}(ne)?Af(U,o,l,g,pc(ne),T):void 0)||(nh(b)||function Wm(r){return 2==(2&r)}(ne)&&(b=Af(U,null,l,g,L,T)),function Od(r,o,l,h,g){if(o)g?r.addClass(l,h):r.removeClass(l,h);else{let b=-1===h.indexOf("-")?void 0:cc.DashCase;null==g?r.removeStyle(l,h,b):("string"==typeof g&&g.endsWith("!important")&&(g=g.slice(0,-10),b|=cc.Important),r.setStyle(l,h,g,b))}}(h,T,$o(yt(),l),g,b))}(b,b.data[yt()],g,g[11],r,g[T+1]=function If(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=Le(Dl(r)))),r}(o,l),h,T)}function ms(r,o,l,h,g){let b=null;const T=l.directiveEnd;let L=l.directiveStylingLast;for(-1===L?L=l.directiveStart:L++;L<T&&(b=o[L],h=pl(h,b.hostAttrs,g),b!==r);)L++;return null!==r&&(l.directiveStylingLast=L),h}function pl(r,o,l){const h=l?1:2;let g=-1;if(null!==o)for(let b=0;b<o.length;b++){const T=o[b];"number"==typeof T?g=T:g===h&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),Y(r,T,!!l||o[++b]))}return void 0===r?null:r}function Af(r,o,l,h,g,b){const T=null===o;let L;for(;g>0;){const U=r[g],ne=Array.isArray(U),xe=ne?U[1]:U,qe=null===xe;let Nt=l[g+1];Nt===gr&&(Nt=qe?xn:void 0);let cn=qe?me(Nt,h):xe===h?Nt:void 0;if(ne&&!nh(cn)&&(cn=me(U,h)),nh(cn)&&(L=cn,T))return L;const Zn=r[g+1];g=T?ql(Zn):pc(Zn)}if(null!==o){let U=b?o.residualClasses:o.residualStyles;null!=U&&(L=me(U,h))}return L}function nh(r){return void 0!==r}function Jl(r,o=""){const l=wn(),h=ar(),g=r+22,b=h.firstCreatePass?qc(h,g,1,o,null):h.data[g],T=l[g]=function Dh(r,o){return r.createText(o)}(l[11],o);Ah(h,l,T,b),j(b,!1)}function rp(r){return _c("",r,""),rp}function _c(r,o,l){const h=wn(),g=hl(h,r,o,l);return g!==gr&&Bc(h,yt(),g),_c}function ih(r,o,l,h,g){const b=wn(),T=Su(b,r,o,l,h,g);return T!==gr&&Bc(b,yt(),T),ih}function ty(r,o,l){const h=wn();return sa(h,Vs(),o)&&tl(ar(),On(),h,r,o,h[11],l,!0),ty}function ny(r,o,l){const h=wn();if(sa(h,Vs(),o)){const b=ar(),T=On();tl(b,T,h,r,o,_f(Wa(b.data),T,h),l,!0)}return ny}const rh=void 0;var Fx=["en",[["a","p"],["AM","PM"],rh],[["AM","PM"],rh,rh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],rh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],rh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",rh,"{1} 'at' {0}",rh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function kx(r){const l=Math.floor(Math.abs(r)),h=r.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===h?1:5}];let ap={};function iy(r){const o=function Lx(r){return r.toLowerCase().replace(/_/g,"-")}(r);let l=mv(o);if(l)return l;const h=o.split("-")[0];if(l=mv(h),l)return l;if("en"===h)return Fx;throw new tt(701,!1)}function fv(r){return iy(r)[nr.PluralCase]}function mv(r){return r in ap||(ap[r]=Ht.ng&&Ht.ng.common&&Ht.ng.common.locales&&Ht.ng.common.locales[r]),ap[r]}var nr=(()=>((nr=nr||{})[nr.LocaleId=0]="LocaleId",nr[nr.DayPeriodsFormat=1]="DayPeriodsFormat",nr[nr.DayPeriodsStandalone=2]="DayPeriodsStandalone",nr[nr.DaysFormat=3]="DaysFormat",nr[nr.DaysStandalone=4]="DaysStandalone",nr[nr.MonthsFormat=5]="MonthsFormat",nr[nr.MonthsStandalone=6]="MonthsStandalone",nr[nr.Eras=7]="Eras",nr[nr.FirstDayOfWeek=8]="FirstDayOfWeek",nr[nr.WeekendRange=9]="WeekendRange",nr[nr.DateFormat=10]="DateFormat",nr[nr.TimeFormat=11]="TimeFormat",nr[nr.DateTimeFormat=12]="DateTimeFormat",nr[nr.NumberSymbols=13]="NumberSymbols",nr[nr.NumberFormats=14]="NumberFormats",nr[nr.CurrencyCode=15]="CurrencyCode",nr[nr.CurrencySymbol=16]="CurrencySymbol",nr[nr.CurrencyName=17]="CurrencyName",nr[nr.Currencies=18]="Currencies",nr[nr.Directionality=19]="Directionality",nr[nr.PluralCase=20]="PluralCase",nr[nr.ExtraData=21]="ExtraData",nr))();const lp="en-US";let gv=lp;function sy(r,o,l,h,g){if(r=Et(r),Array.isArray(r))for(let b=0;b<r.length;b++)sy(r[b],o,l,h,g);else{const b=ar(),T=wn();let L=Sl(r)?r:Et(r.provide),U=mh(r);const ne=zr(),xe=1048575&ne.providerIndexes,qe=ne.directiveStart,Nt=ne.providerIndexes>>20;if(Sl(r)||!r.multi){const cn=new No(U,g,Pc),Zn=ly(L,o,g?xe:xe+Nt,qe);-1===Zn?(ma(Mr(ne,T),b,L),ay(b,r,o.length),o.push(L),ne.directiveStart++,ne.directiveEnd++,g&&(ne.providerIndexes+=1048576),l.push(cn),T.push(cn)):(l[Zn]=cn,T[Zn]=cn)}else{const cn=ly(L,o,xe+Nt,qe),Zn=ly(L,o,xe,xe+Nt),ci=cn>=0&&l[cn],xi=Zn>=0&&l[Zn];if(g&&!xi||!g&&!ci){ma(Mr(ne,T),b,L);const Ni=function Rb(r,o,l,h,g){const b=new No(r,l,Pc);return b.multi=[],b.index=o,b.componentProviders=0,Vv(b,g,h&&!l),b}(g?Ob:Pb,l.length,g,h,U);!g&&xi&&(l[Zn].providerFactory=Ni),ay(b,r,o.length,0),o.push(L),ne.directiveStart++,ne.directiveEnd++,g&&(ne.providerIndexes+=1048576),l.push(Ni),T.push(Ni)}else ay(b,r,cn>-1?cn:Zn,Vv(l[g?Zn:cn],U,!g&&h));!g&&h&&xi&&l[Zn].componentProviders++}}}function ay(r,o,l,h){const g=Sl(o),b=function Cp(r){return!!r.useClass}(o);if(g||b){const U=(b?Et(o.useClass):o).prototype.ngOnDestroy;if(U){const ne=r.destroyHooks||(r.destroyHooks=[]);if(!g&&o.multi){const xe=ne.indexOf(l);-1===xe?ne.push(l,[h,U]):ne[xe+1].push(h,U)}else ne.push(l,U)}}}function Vv(r,o,l){return l&&r.componentProviders++,r.multi.push(o)-1}function ly(r,o,l,h){for(let g=l;g<h;g++)if(o[g]===r)return g;return-1}function Pb(r,o,l,h){return cy(this.multi,[])}function Ob(r,o,l,h){const g=this.multi;let b;if(this.providerFactory){const T=this.providerFactory.componentProviders,L=Ur(l,l[1],this.providerFactory.index,h);b=L.slice(0,T),cy(g,b);for(let U=T;U<L.length;U++)b.push(L[U])}else b=[],cy(g,b);return b}function cy(r,o){for(let l=0;l<r.length;l++)o.push((0,r[l])());return o}function jv(r,o=[]){return l=>{l.providersResolver=(h,g)=>function Ib(r,o,l){const h=ar();if(h.firstCreatePass){const g=Zr(r);sy(l,h.data,h.blueprint,g,!0),sy(o,h.data,h.blueprint,g,!1)}}(h,g?g(r):r,o)}}class cp{}class Hv{}function kb(r,o){return new Gv(r,o??null)}class Gv extends cp{constructor(o,l){super(),this._parent=l,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new yf(this);const h=Ft(o);this._bootstrapComponents=Pl(h.bootstrap),this._r3Injector=Bm(o,l,[{provide:cp,useValue:this},{provide:ac,useValue:this.componentFactoryResolver}],Le(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class uy extends Hv{constructor(o){super(),this.moduleType=o}create(o){return new Gv(this.moduleType,o)}}class Fb extends cp{constructor(o,l,h){super(),this.componentFactoryResolver=new yf(this),this.instance=null;const g=new sc([...o,{provide:cp,useValue:this},{provide:ac,useValue:this.componentFactoryResolver}],l||gd(),h,new Set(["environment"]));this.injector=g,g.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function dy(r,o,l=null){return new Fb(r,o,l).injector}let Lb=(()=>{class r{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l.id)){const h=Gl(0,l.type),g=h.length>0?dy([h],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l.id,g)}return this.cachedInjectors.get(l.id)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return r.\u0275prov=Tt({token:r,providedIn:"environment",factory:()=>new r(Pe(uu))}),r})();function $v(r){r.getStandaloneInjector=o=>o.get(Lb).getOrCreateStandaloneInjector(r)}function Qv(r,o,l,h){return Jv(wn(),Lr(),r,o,l,h)}function Bf(r,o){const l=r[o];return l===gr?void 0:l}function Jv(r,o,l,h,g,b){const T=o+l;return sa(r,T,g)?gc(r,T+1,b?h.call(b,g):h(g)):Bf(r,T+1)}function o0(r,o){const l=ar();let h;const g=r+22;l.firstCreatePass?(h=function ew(r,o){if(o)for(let l=o.length-1;l>=0;l--){const h=o[l];if(r===h.name)return h}}(o,l.pipeRegistry),l.data[g]=h,h.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(g,h.onDestroy)):h=l.data[g];const b=h.factory||(h.factory=ys(h.type)),T=on(Pc);try{const L=di(!1),U=b();return di(L),function Eg(r,o,l,h){l>=r.data.length&&(r.data[l]=null,r.blueprint[l]=null),o[l]=h}(l,wn(),g,U),U}finally{on(T)}}function s0(r,o,l){const h=r+22,g=wn(),b=pa(g,h);return Nf(g,h)?Jv(g,Lr(),o,b.transform,l,b):b.transform(l)}function a0(r,o,l,h){const g=r+22,b=wn(),T=pa(b,g);return Nf(b,g)?function e0(r,o,l,h,g,b,T){const L=o+l;return tu(r,L,g,b)?gc(r,L+2,T?h.call(T,g,b):h(g,b)):Bf(r,L+2)}(b,Lr(),o,T.transform,l,h,T):T.transform(l,h)}function Nf(r,o){return r[1].data[o].pure}function py(r){return o=>{setTimeout(r,void 0,o)}}const ou=class rw extends w.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,l,h){let g=o,b=l||(()=>null),T=h;if(o&&"object"==typeof o){const U=o;g=U.next?.bind(U),b=U.error?.bind(U),T=U.complete?.bind(U)}this.__isAsync&&(b=py(b),g&&(g=py(g)),T&&(T=py(T)));const L=super.subscribe({next:g,error:b,complete:T});return o instanceof _.w0&&o.add(L),L}};function ow(){return this._results[xa()]()}class Og{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=xa(),h=Og.prototype;h[l]||(h[l]=ow)}get changes(){return this._changes||(this._changes=new ou)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,l){return this._results.reduce(o,l)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,l){const h=this;h.dirty=!1;const g=hs(o);(this._changesDetected=!function bl(r,o,l){if(r.length!==o.length)return!1;for(let h=0;h<r.length;h++){let g=r[h],b=o[h];if(l&&(g=l(g),b=l(b)),b!==g)return!1}return!0}(h._results,g,l))&&(h._results=g,h.length=g.length,h.last=g[this.length-1],h.first=g[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let zf=(()=>{class r{}return r.__NG_ELEMENT_ID__=lw,r})();const sw=zf,aw=class extends sw{constructor(o,l,h){super(),this._declarationLView=o,this._declarationTContainer=l,this.elementRef=h}createEmbeddedView(o,l){const h=this._declarationTContainer.tViews,g=bu(this._declarationLView,h,o,16,null,h.declTNode,null,null,null,null,l||null);g[17]=this._declarationLView[this._declarationTContainer.index];const T=this._declarationLView[19];return null!==T&&(g[19]=T.createEmbeddedView(h)),Uh(h,g,o),new Qc(g)}};function lw(){return Rg(zr(),wn())}function Rg(r,o){return 4&r.type?new aw(o,r,hu(r,o)):null}let kg=(()=>{class r{}return r.__NG_ELEMENT_ID__=cw,r})();function cw(){return u0(zr(),wn())}const uw=kg,l0=class extends uw{constructor(o,l,h){super(),this._lContainer=o,this._hostTNode=l,this._hostLView=h}get element(){return hu(this._hostTNode,this._hostLView)}get injector(){return new Ii(this._hostTNode,this._hostLView)}get parentInjector(){const o=ro(this._hostTNode,this._hostLView);if(Re(o)){const l=sn(o,this._hostLView),h=It(o);return new Ii(l[1].data[h+8],l)}return new Ii(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const l=c0(this._lContainer);return null!==l&&l[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,l,h){let g,b;"number"==typeof h?g=h:null!=h&&(g=h.index,b=h.injector);const T=o.createEmbeddedView(l||{},b);return this.insert(T,g),T}createComponent(o,l,h,g,b){const T=o&&!function nc(r){return"function"==typeof r}(o);let L;if(T)L=l;else{const qe=l||{};L=qe.index,h=qe.injector,g=qe.projectableNodes,b=qe.environmentInjector||qe.ngModuleRef}const U=T?o:new Kd(Me(o)),ne=h||this.parentInjector;if(!b&&null==U.ngModule){const Nt=(T?ne:this.parentInjector).get(uu,null);Nt&&(b=Nt)}const xe=U.create(ne,g,void 0,b);return this.insert(xe.hostView,L),xe}insert(o,l){const h=o._lView,g=h[1];if(function Ks(r){return vr(r[3])}(h)){const xe=this.indexOf(o);if(-1!==xe)this.detach(xe);else{const qe=h[3],Nt=new l0(qe,qe[6],qe[3]);Nt.detach(Nt.indexOf(o))}}const b=this._adjustIndex(l),T=this._lContainer;!function y_(r,o,l,h){const g=10+h,b=l.length;h>0&&(l[g-1][4]=o),h<b-10?(o[4]=l[g],su(l,10+h,o)):(l.push(o),o[4]=null),o[3]=l;const T=o[17];null!==T&&l!==T&&function Up(r,o){const l=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===l?r[9]=[o]:l.push(o)}(T,o);const L=o[19];null!==L&&L.insertView(r),o[2]|=64}(g,h,T,b);const L=Gu(b,T),U=h[11],ne=Ac(U,T[7]);return null!==ne&&function __(r,o,l,h,g,b){h[0]=g,h[6]=o,Id(r,h,l,1,g,b)}(g,T[6],U,h,ne,L),o.attachToViewContainerRef(),su(fy(T),b,o),o}move(o,l){return this.insert(o,l)}indexOf(o){const l=c0(this._lContainer);return null!==l?l.indexOf(o):-1}remove(o){const l=this._adjustIndex(o,-1),h=Td(this._lContainer,l);h&&(ic(fy(this._lContainer),l),Th(h[1],h))}detach(o){const l=this._adjustIndex(o,-1),h=Td(this._lContainer,l);return h&&null!=ic(fy(this._lContainer),l)?new Qc(h):null}_adjustIndex(o,l=0){return o??this.length+l}};function c0(r){return r[8]}function fy(r){return r[8]||(r[8]=[])}function u0(r,o){let l;const h=o[r.index];if(vr(h))l=h;else{let g;if(8&r.type)g=Fr(h);else{const b=o[11];g=b.createComment("");const T=go(r,o);_u(b,Ac(b,T),g,function E_(r,o){return r.nextSibling(o)}(b,T),!1)}o[r.index]=l=td(h,o,g,r),Lc(o,l)}return new l0(l,r,o)}class my{constructor(o){this.queryList=o,this.matches=null}clone(){return new my(this.queryList)}setDirty(){this.queryList.setDirty()}}class gy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const l=o.queries;if(null!==l){const h=null!==o.contentQueries?o.contentQueries[0]:l.length,g=[];for(let b=0;b<h;b++){const T=l.getByIndex(b);g.push(this.queries[T.indexInDeclarationView].clone())}return new gy(g)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let l=0;l<this.queries.length;l++)null!==v0(o,l).matches&&this.queries[l].setDirty()}}class d0{constructor(o,l,h=null){this.predicate=o,this.flags=l,this.read=h}}class _y{constructor(o=[]){this.queries=o}elementStart(o,l){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(o,l)}elementEnd(o){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(o)}embeddedTView(o){let l=null;for(let h=0;h<this.length;h++){const g=null!==l?l.length:0,b=this.getByIndex(h).embeddedTView(o,g);b&&(b.indexInDeclarationView=h,null!==l?l.push(b):l=[b])}return null!==l?new _y(l):null}template(o,l){for(let h=0;h<this.queries.length;h++)this.queries[h].template(o,l)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class yy{constructor(o,l=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(o,l){this.isApplyingToNode(l)&&this.matchTNode(o,l)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,l){this.elementStart(o,l)}embeddedTView(o,l){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,l),new yy(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let h=o.parent;for(;null!==h&&8&h.type&&h.index!==l;)h=h.parent;return l===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(o,l){const h=this.metadata.predicate;if(Array.isArray(h))for(let g=0;g<h.length;g++){const b=h[g];this.matchTNodeWithReadOption(o,l,pw(l,b)),this.matchTNodeWithReadOption(o,l,Ra(l,o,b,!1,!1))}else h===zf?4&l.type&&this.matchTNodeWithReadOption(o,l,-1):this.matchTNodeWithReadOption(o,l,Ra(l,o,h,!1,!1))}matchTNodeWithReadOption(o,l,h){if(null!==h){const g=this.metadata.read;if(null!==g)if(g===Nu||g===kg||g===zf&&4&l.type)this.addMatch(l.index,-2);else{const b=Ra(l,o,g,!1,!1);null!==b&&this.addMatch(l.index,b)}else this.addMatch(l.index,h)}}addMatch(o,l){null===this.matches?this.matches=[o,l]:this.matches.push(o,l)}}function pw(r,o){const l=r.localNames;if(null!==l)for(let h=0;h<l.length;h+=2)if(l[h]===o)return l[h+1];return null}function mw(r,o,l,h){return-1===l?function fw(r,o){return 11&r.type?hu(r,o):4&r.type?Rg(r,o):null}(o,r):-2===l?function gw(r,o,l){return l===Nu?hu(o,r):l===zf?Rg(o,r):l===kg?u0(o,r):void 0}(r,o,h):Ur(r,r[1],l,o)}function h0(r,o,l,h){const g=o[19].queries[h];if(null===g.matches){const b=r.data,T=l.matches,L=[];for(let U=0;U<T.length;U+=2){const ne=T[U];L.push(ne<0?null:mw(o,b[ne],T[U+1],l.metadata.read))}g.matches=L}return g.matches}function vy(r,o,l,h){const g=r.queries.getByIndex(l),b=g.matches;if(null!==b){const T=h0(r,o,g,l);for(let L=0;L<b.length;L+=2){const U=b[L];if(U>0)h.push(T[L/2]);else{const ne=b[L+1],xe=o[-U];for(let qe=10;qe<xe.length;qe++){const Nt=xe[qe];Nt[17]===Nt[3]&&vy(Nt[1],Nt,ne,h)}if(null!==xe[9]){const qe=xe[9];for(let Nt=0;Nt<qe.length;Nt++){const cn=qe[Nt];vy(cn[1],cn,ne,h)}}}}}return h}function p0(r){const o=wn(),l=ar(),h=ec();gl(h+1);const g=v0(l,h);if(r.dirty&&function fr(r){return 4==(4&r[2])}(o)===(2==(2&g.metadata.flags))){if(null===g.matches)r.reset([]);else{const b=g.crossesNgTemplate?vy(l,o,h,[]):h0(l,o,g,h);r.reset(b,i_),r.notifyOnChanges()}return!0}return!1}function f0(r,o,l){const h=ar();h.firstCreatePass&&(y0(h,new d0(r,o,l),-1),2==(2&o)&&(h.staticViewQueries=!0)),_0(h,wn(),o)}function m0(r,o,l,h){const g=ar();if(g.firstCreatePass){const b=zr();y0(g,new d0(o,l,h),b.index),function yw(r,o){const l=r.contentQueries||(r.contentQueries=[]);o!==(l.length?l[l.length-1]:-1)&&l.push(r.queries.length-1,o)}(g,r),2==(2&l)&&(g.staticContentQueries=!0)}_0(g,wn(),l)}function g0(){return function _w(r,o){return r[19].queries[o].queryList}(wn(),ec())}function _0(r,o,l){const h=new Og(4==(4&l));lg(r,o,h,h.destroy),null===o[19]&&(o[19]=new gy),o[19].queries.push(new my(h))}function y0(r,o,l){null===r.queries&&(r.queries=new _y),r.queries.track(new yy(o,l))}function v0(r,o){return r.queries.getByIndex(o)}function x0(r,o){return Rg(r,o)}function Lg(...r){}const z0=new qr("Application Initializer");let Bg=(()=>{class r{constructor(l){this.appInits=l,this.resolve=Lg,this.reject=Lg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((h,g)=>{this.resolve=h,this.reject=g})}runInitializers(){if(this.initialized)return;const l=[],h=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let g=0;g<this.appInits.length;g++){const b=this.appInits[g]();if(E(b))l.push(b);else if(R(b)){const T=new Promise((L,U)=>{b.subscribe({complete:L,error:U})});l.push(T)}}Promise.all(l).then(()=>{h()}).catch(g=>{this.reject(g)}),0===l.length&&h(),this.initialized=!0}}return r.\u0275fac=function(l){return new(l||r)(Pe(z0,8))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const U0=new qr("AppId",{providedIn:"root",factory:function V0(){return`${Cy()}${Cy()}${Cy()}`}});function Cy(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const j0=new qr("Platform Initializer"),Nw=new qr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),H0=new qr("appBootstrapListener"),zw=new qr("AnimationModuleType");let Uw=(()=>{class r{log(l){console.log(l)}warn(l){console.warn(l)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const Ng=new qr("LocaleId",{providedIn:"root",factory:()=>Be(Ng,ae.Optional|ae.SkipSelf)||function Vw(){return typeof $localize<"u"&&$localize.locale||lp}()}),jw=new qr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Hw{constructor(o,l){this.ngModuleFactory=o,this.componentFactories=l}}let Gw=(()=>{class r{compileModuleSync(l){return new uy(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const h=this.compileModuleSync(l),b=Pl(Ft(l).declarations).reduce((T,L)=>{const U=Me(L);return U&&T.push(new Kd(U)),T},[]);return new Hw(h,b)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const Ww=(()=>Promise.resolve(0))();function My(r){typeof Zone>"u"?Ww.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class yc{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ou(!1),this.onMicrotaskEmpty=new ou(!1),this.onStable=new ou(!1),this.onError=new ou(!1),typeof Zone>"u")throw new tt(908,!1);Zone.assertZonePatched();const g=this;if(g._nesting=0,g._outer=g._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const b=Zone.AsyncStackTaggingZoneSpec;g._inner=g._inner.fork(new b("Angular"))}Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!h&&l,g.shouldCoalesceRunChangeDetection=h,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function qw(){let r=Ht.requestAnimationFrame,o=Ht.cancelAnimationFrame;if(typeof Zone<"u"&&r&&o){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const h=o[Zone.__symbol__("OriginalDelegate")];h&&(o=h)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function Xw(r){const o=()=>{!function Kw(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(Ht,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,Ty(r),r.isCheckStableRunning=!0,Dy(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),Ty(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,g,b,T,L)=>{try{return Z0(r),l.invokeTask(g,b,T,L)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===b.type||r.shouldCoalesceRunChangeDetection)&&o(),W0(r)}},onInvoke:(l,h,g,b,T,L,U)=>{try{return Z0(r),l.invoke(g,b,T,L,U)}finally{r.shouldCoalesceRunChangeDetection&&o(),W0(r)}},onHasTask:(l,h,g,b)=>{l.hasTask(g,b),h===g&&("microTask"==b.change?(r._hasPendingMicrotasks=b.microTask,Ty(r),Dy(r)):"macroTask"==b.change&&(r.hasPendingMacrotasks=b.macroTask))},onHandleError:(l,h,g,b)=>(l.handleError(g,b),r.runOutsideAngular(()=>r.onError.emit(b)),!1)})}(g)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yc.isInAngularZone())throw new tt(909,!1)}static assertNotInAngularZone(){if(yc.isInAngularZone())throw new tt(909,!1)}run(o,l,h){return this._inner.run(o,l,h)}runTask(o,l,h,g){const b=this._inner,T=b.scheduleEventTask("NgZoneEvent: "+g,o,Yw,Lg,Lg);try{return b.runTask(T,l,h)}finally{b.cancelTask(T)}}runGuarded(o,l,h){return this._inner.runGuarded(o,l,h)}runOutsideAngular(o){return this._outer.run(o)}}const Yw={};function Dy(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function Ty(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function Z0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function W0(r){r._nesting--,Dy(r)}class Qw{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ou,this.onMicrotaskEmpty=new ou,this.onStable=new ou,this.onError=new ou}run(o,l,h){return o.apply(l,h)}runGuarded(o,l,h){return o.apply(l,h)}runOutsideAngular(o){return o()}runTask(o,l,h,g){return o.apply(l,h)}}const q0=new qr(""),Y0=new qr("");let Sy,Jw=(()=>{class r{constructor(l,h,g){this._ngZone=l,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Sy||(function e1(r){Sy=r}(g),g.addToWindow(h)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yc.assertNotInAngularZone(),My(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())My(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(l)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,h,g){let b=-1;h&&h>0&&(b=setTimeout(()=>{this._callbacks=this._callbacks.filter(T=>T.timeoutId!==b),l(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:l,timeoutId:b,updateCb:g})}whenStable(l,h,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,h,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,h,g){return[]}}return r.\u0275fac=function(l){return new(l||r)(Pe(yc),Pe(K0),Pe(Y0))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac}),r})(),K0=(()=>{class r{constructor(){this._applications=new Map}registerApplication(l,h){this._applications.set(l,h)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,h=!0){return Sy?.findTestabilityInTree(this,l,h)??null}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})(),ud=null;const X0=new qr("AllowMultipleToken"),Ay=new qr("PlatformDestroyListeners");class r1{constructor(o,l){this.name=o,this.token=l}}function J0(r,o,l=[]){const h=`Platform: ${o}`,g=new qr(h);return(b=[])=>{let T=Iy();if(!T||T.injector.get(X0,!1)){const L=[...l,...b,{provide:g,useValue:!0}];r?r(L):function o1(r){if(ud&&!ud.get(X0,!1))throw new tt(400,!1);ud=r;const o=r.get(tx);(function Q0(r){const o=r.get(j0,null);o&&o.forEach(l=>l())})(r)}(function ex(r=[],o){return yu.create({name:o,providers:[{provide:hh,useValue:"platform"},{provide:Ay,useValue:new Set([()=>ud=null])},...r]})}(L,h))}return function a1(r){const o=Iy();if(!o)throw new tt(401,!1);return o}()}}function Iy(){return ud?.get(tx)??null}let tx=(()=>{class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,h){const g=function ix(r,o){let l;return l="noop"===r?new Qw:("zone.js"===r?void 0:r)||new yc(o),l}(h?.ngZone,function nx(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!r||!r.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!r||!r.ngZoneRunCoalescing)||!1}}(h)),b=[{provide:yc,useValue:g}];return g.run(()=>{const T=yu.create({providers:b,parent:this.injector,name:l.moduleType.name}),L=l.create(T),U=L.injector.get(mu,null);if(!U)throw new tt(402,!1);return g.runOutsideAngular(()=>{const ne=g.onError.subscribe({next:xe=>{U.handleError(xe)}});L.onDestroy(()=>{Ug(this._modules,L),ne.unsubscribe()})}),function rx(r,o,l){try{const h=l();return E(h)?h.catch(g=>{throw o.runOutsideAngular(()=>r.handleError(g)),g}):h}catch(h){throw o.runOutsideAngular(()=>r.handleError(h)),h}}(U,g,()=>{const ne=L.injector.get(Bg);return ne.runInitializers(),ne.donePromise.then(()=>(function _v(r){wi(r,"Expected localeId to be defined"),"string"==typeof r&&(gv=r.toLowerCase().replace(/_/g,"-"))}(L.injector.get(Ng,lp)||lp),this._moduleDoBootstrap(L),L))})})}bootstrapModule(l,h=[]){const g=ox({},h);return function t1(r,o,l){const h=new uy(l);return Promise.resolve(h)}(0,0,l).then(b=>this.bootstrapModuleFactory(b,g))}_moduleDoBootstrap(l){const h=l.injector.get(zg);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(g=>h.bootstrap(g));else{if(!l.instance.ngDoBootstrap)throw new tt(403,!1);l.instance.ngDoBootstrap(h)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new tt(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const l=this._injector.get(Ay,null);l&&(l.forEach(h=>h()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(l){return new(l||r)(Pe(yu))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function ox(r,o){return Array.isArray(o)?o.reduce(ox,r):{...r,...o}}let zg=(()=>{class r{constructor(l,h,g){this._zone=l,this._injector=h,this._exceptionHandler=g,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const b=new pe.y(L=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{L.next(this._stable),L.complete()})}),T=new pe.y(L=>{let U;this._zone.runOutsideAngular(()=>{U=this._zone.onStable.subscribe(()=>{yc.assertNotInAngularZone(),My(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,L.next(!0))})})});const ne=this._zone.onUnstable.subscribe(()=>{yc.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{L.next(!1)}))});return()=>{U.unsubscribe(),ne.unsubscribe()}});this.isStable=(0,a.T)(b,T.pipe((0,de.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,h){const g=l instanceof Sp;if(!this._injector.get(Bg).done)throw!g&&Lt(l),new tt(405,false);let T;T=g?l:this._injector.get(ac).resolveComponentFactory(l),this.componentTypes.push(T.componentType);const L=function n1(r){return r.isBoundToModule}(T)?void 0:this._injector.get(cp),ne=T.create(yu.NULL,[],h||T.selector,L),xe=ne.location.nativeElement,qe=ne.injector.get(q0,null);return qe?.registerApplication(xe),ne.onDestroy(()=>{this.detachView(ne.hostView),Ug(this.components,ne),qe?.unregisterApplication(xe)}),this._loadComponent(ne),ne}tick(){if(this._runningTick)throw new tt(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const h=l;this._views.push(h),h.attachToAppRef(this)}detachView(l){const h=l;Ug(this._views,h),h.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l),this._injector.get(H0,[]).concat(this._bootstrapListeners).forEach(g=>g(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>Ug(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new tt(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return r.\u0275fac=function(l){return new(l||r)(Pe(yc),Pe(uu),Pe(mu))},r.\u0275prov=Tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Ug(r,o){const l=r.indexOf(o);l>-1&&r.splice(l,1)}let ax=!0,lx=!1;function c1(){return lx=!0,ax}function u1(){if(lx)throw new Error("Cannot enable prod mode after platform setup.");ax=!1}let d1=(()=>{class r{}return r.__NG_ELEMENT_ID__=h1,r})();function h1(r){return function p1(r,o,l){if(Br(r)&&!l){const h=cr(r.index,o);return new Qc(h,h)}return 47&r.type?new Qc(o[16],o):null}(zr(),wn(),16==(16&r))}class hx{constructor(){}supports(o){return eu(o)}create(o){return new v1(o)}}const y1=(r,o)=>o;class v1{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||y1}forEachItem(o){let l;for(l=this._itHead;null!==l;l=l._next)o(l)}forEachOperation(o){let l=this._itHead,h=this._removalsHead,g=0,b=null;for(;l||h;){const T=!h||l&&l.currentIndex<fx(h,g,b)?l:h,L=fx(T,g,b),U=T.currentIndex;if(T===h)g--,h=h._nextRemoved;else if(l=l._next,null==T.previousIndex)g++;else{b||(b=[]);const ne=L-g,xe=U-g;if(ne!=xe){for(let Nt=0;Nt<ne;Nt++){const cn=Nt<b.length?b[Nt]:b[Nt]=0,Zn=cn+Nt;xe<=Zn&&Zn<ne&&(b[Nt]=cn+1)}b[T.previousIndex]=xe-ne}}L!==U&&o(T,L,U)}}forEachPreviousItem(o){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachMovedItem(o){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}forEachIdentityChange(o){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)o(l)}diff(o){if(null==o&&(o=[]),!eu(o))throw new tt(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let g,b,T,l=this._itHead,h=!1;if(Array.isArray(o)){this.length=o.length;for(let L=0;L<this.length;L++)b=o[L],T=this._trackByFn(L,b),null!==l&&Object.is(l.trackById,T)?(h&&(l=this._verifyReinsertion(l,b,T,L)),Object.is(l.item,b)||this._addIdentityChange(l,b)):(l=this._mismatch(l,b,T,L),h=!0),l=l._next}else g=0,function bg(r,o){if(Array.isArray(r))for(let l=0;l<r.length;l++)o(r[l]);else{const l=r[xa()]();let h;for(;!(h=l.next()).done;)o(h.value)}}(o,L=>{T=this._trackByFn(g,L),null!==l&&Object.is(l.trackById,T)?(h&&(l=this._verifyReinsertion(l,L,T,g)),Object.is(l.item,L)||this._addIdentityChange(l,L)):(l=this._mismatch(l,L,T,g),h=!0),l=l._next,g++}),this.length=g;return this._truncate(l),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,l,h,g){let b;return null===o?b=this._itTail:(b=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._reinsertAfter(o,b,g)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(h,g))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._moveAfter(o,b,g)):o=this._addAfter(new x1(l,h),b,g),o}_verifyReinsertion(o,l,h,g){let b=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==b?o=this._reinsertAfter(b,o._prev,g):o.currentIndex!=g&&(o.currentIndex=g,this._addToMoves(o,g)),o}_truncate(o){for(;null!==o;){const l=o._next;this._addToRemovals(this._unlink(o)),o=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,l,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const g=o._prevRemoved,b=o._nextRemoved;return null===g?this._removalsHead=b:g._nextRemoved=b,null===b?this._removalsTail=g:b._prevRemoved=g,this._insertAfter(o,l,h),this._addToMoves(o,h),o}_moveAfter(o,l,h){return this._unlink(o),this._insertAfter(o,l,h),this._addToMoves(o,h),o}_addAfter(o,l,h){return this._insertAfter(o,l,h),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,l,h){const g=null===l?this._itHead:l._next;return o._next=g,o._prev=l,null===g?this._itTail=o:g._prev=o,null===l?this._itHead=o:l._next=o,null===this._linkedRecords&&(this._linkedRecords=new px),this._linkedRecords.put(o),o.currentIndex=h,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const l=o._prev,h=o._next;return null===l?this._itHead=h:l._next=h,null===h?this._itTail=l:h._prev=l,o}_addToMoves(o,l){return o.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new px),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,l){return o.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class x1{constructor(o,l){this.item=o,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class b1{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,l){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===l||l<=h.currentIndex)&&Object.is(h.trackById,o))return h;return null}remove(o){const l=o._prevDup,h=o._nextDup;return null===l?this._head=h:l._nextDup=h,null===h?this._tail=l:h._prevDup=l,null===this._head}}class px{constructor(){this.map=new Map}put(o){const l=o.trackById;let h=this.map.get(l);h||(h=new b1,this.map.set(l,h)),h.add(o)}get(o,l){const g=this.map.get(o);return g?g.get(o,l):null}remove(o){const l=o.trackById;return this.map.get(l).remove(o)&&this.map.delete(l),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function fx(r,o,l){const h=r.previousIndex;if(null===h)return h;let g=0;return l&&h<l.length&&(g=l[h]),h+o+g}class mx{constructor(){}supports(o){return o instanceof Map||Qh(o)}create(){return new w1}}class w1{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let l;for(l=this._mapHead;null!==l;l=l._next)o(l)}forEachPreviousItem(o){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)o(l)}forEachChangedItem(o){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}diff(o){if(o){if(!(o instanceof Map||Qh(o)))throw new tt(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(o,(h,g)=>{if(l&&l.key===g)this._maybeAddToChanges(l,h),this._appendAfter=l,l=l._next;else{const b=this._getOrCreateRecordForKey(g,h);l=this._insertBeforeOrAppend(l,b)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let h=l;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,l){if(o){const h=o._prev;return l._next=o,l._prev=h,o._prev=l,h&&(h._next=l),o===this._mapHead&&(this._mapHead=l),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(o,l){if(this._records.has(o)){const g=this._records.get(o);this._maybeAddToChanges(g,l);const b=g._prev,T=g._next;return b&&(b._next=T),T&&(T._prev=b),g._next=null,g._prev=null,g}const h=new E1(o);return this._records.set(o,h),h.currentValue=l,this._addToAdditions(h),h}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,l){Object.is(l,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=l,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,l){o instanceof Map?o.forEach(l):Object.keys(o).forEach(h=>l(o[h],h))}}class E1{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function gx(){return new Fy([new hx])}let Fy=(()=>{class r{constructor(l){this.factories=l}static create(l,h){if(null!=h){const g=h.factories.slice();l=l.concat(g)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||gx()),deps:[[r,new ln,new vt]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(null!=h)return h;throw new tt(901,!1)}}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:gx}),r})();function _x(){return new Ly([new mx])}let Ly=(()=>{class r{constructor(l){this.factories=l}static create(l,h){if(h){const g=h.factories.slice();l=l.concat(g)}return new r(l)}static extend(l){return{provide:r,useFactory:h=>r.create(l,h||_x()),deps:[[r,new ln,new vt]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(h)return h;throw new tt(901,!1)}}return r.\u0275prov=Tt({token:r,providedIn:"root",factory:_x}),r})();const D1=J0(null,"core",[]);let T1=(()=>{class r{constructor(l){}}return r.\u0275fac=function(l){return new(l||r)(Pe(zg))},r.\u0275mod=bn({type:r}),r.\u0275inj=Fe({}),r})();function S1(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}},4006:(ti,Vt,B)=>{"use strict";B.d(Vt,{EJ:()=>Ns,F:()=>hn,Fj:()=>wt,JJ:()=>ae,JL:()=>$e,JU:()=>Le,Kr:()=>Wr,On:()=>is,UX:()=>as,Wl:()=>rt,YN:()=>Go,_:()=>kr,_Y:()=>ks,a5:()=>tn,kI:()=>Ye,qu:()=>ar,sg:()=>Jr,u:()=>Ho,u5:()=>Us});var w=B(4650),_=B(6895),pe=B(2076),a=B(4128),de=B(4004);let ut=(()=>{class Q{constructor(j,be){this._renderer=j,this._elementRef=be,this.onChange=En=>{},this.onTouched=()=>{}}setProperty(j,be){this._renderer.setProperty(this._elementRef.nativeElement,j,be)}registerOnTouched(j){this.onTouched=j}registerOnChange(j){this.onChange=j}setDisabledState(j){this.setProperty("disabled",j)}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(w.Qsj),w.Y36(w.SBq))},Q.\u0275dir=w.lG2({type:Q}),Q})(),it=(()=>{class Q extends ut{}return Q.\u0275fac=function(){let q;return function(be){return(q||(q=w.n5z(Q)))(be||Q)}}(),Q.\u0275dir=w.lG2({type:Q,features:[w.qOj]}),Q})();const Le=new w.OlP("NgValueAccessor"),ke={provide:Le,useExisting:(0,w.Gpc)(()=>rt),multi:!0};let rt=(()=>{class Q extends it{writeValue(j){this.setProperty("checked",j)}}return Q.\u0275fac=function(){let q;return function(be){return(q||(q=w.n5z(Q)))(be||Q)}}(),Q.\u0275dir=w.lG2({type:Q,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(j,be){1&j&&w.NdJ("change",function(bi){return be.onChange(bi.target.checked)})("blur",function(){return be.onTouched()})},features:[w._Bn([ke]),w.qOj]}),Q})();const ft={provide:Le,useExisting:(0,w.Gpc)(()=>wt),multi:!0},dt=new w.OlP("CompositionEventMode");let wt=(()=>{class Q extends ut{constructor(j,be,En){super(j,be),this._compositionMode=En,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Et(){const Q=(0,_.q)()?(0,_.q)().getUserAgent():"";return/android (\d+)/.test(Q.toLowerCase())}())}writeValue(j){this.setProperty("value",j??"")}_handleInput(j){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(j)}_compositionStart(){this._composing=!0}_compositionEnd(j){this._composing=!1,this._compositionMode&&this.onChange(j)}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(dt,8))},Q.\u0275dir=w.lG2({type:Q,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(j,be){1&j&&w.NdJ("input",function(bi){return be._handleInput(bi.target.value)})("blur",function(){return be.onTouched()})("compositionstart",function(){return be._compositionStart()})("compositionend",function(bi){return be._compositionEnd(bi.target.value)})},features:[w._Bn([ft]),w.qOj]}),Q})();function Wt(Q){return null==Q||("string"==typeof Q||Array.isArray(Q))&&0===Q.length}function kt(Q){return null!=Q&&"number"==typeof Q.length}const Qe=new w.OlP("NgValidators"),Hn=new w.OlP("NgAsyncValidators"),Ln=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Ye{static min(q){return function Ce(Q){return q=>{if(Wt(q.value)||Wt(Q))return null;const j=parseFloat(q.value);return!isNaN(j)&&j<Q?{min:{min:Q,actual:q.value}}:null}}(q)}static max(q){return function we(Q){return q=>{if(Wt(q.value)||Wt(Q))return null;const j=parseFloat(q.value);return!isNaN(j)&&j>Q?{max:{max:Q,actual:q.value}}:null}}(q)}static required(q){return function At(Q){return Wt(Q.value)?{required:!0}:null}(q)}static requiredTrue(q){return function zt(Q){return!0===Q.value?null:{required:!0}}(q)}static email(q){return function Jt(Q){return Wt(Q.value)||Ln.test(Q.value)?null:{email:!0}}(q)}static minLength(q){return function Cn(Q){return q=>Wt(q.value)||!kt(q.value)?null:q.value.length<Q?{minlength:{requiredLength:Q,actualLength:q.value.length}}:null}(q)}static maxLength(q){return function Ke(Q){return q=>kt(q.value)&&q.value.length>Q?{maxlength:{requiredLength:Q,actualLength:q.value.length}}:null}(q)}static pattern(q){return function Ne(Q){if(!Q)return He;let q,j;return"string"==typeof Q?(j="","^"!==Q.charAt(0)&&(j+="^"),j+=Q,"$"!==Q.charAt(Q.length-1)&&(j+="$"),q=new RegExp(j)):(j=Q.toString(),q=Q),be=>{if(Wt(be.value))return null;const En=be.value;return q.test(En)?null:{pattern:{requiredPattern:j,actualValue:En}}}}(q)}static nullValidator(q){return null}static compose(q){return Nn(q)}static composeAsync(q){return Jn(q)}}function He(Q){return null}function _t(Q){return null!=Q}function Dn(Q){return(0,w.QGY)(Q)?(0,pe.D)(Q):Q}function Xt(Q){let q={};return Q.forEach(j=>{q=null!=j?{...q,...j}:q}),0===Object.keys(q).length?null:q}function ii(Q,q){return q.map(j=>j(Q))}function wi(Q){return Q.map(q=>function vi(Q){return!Q.validate}(q)?q:j=>q.validate(j))}function Nn(Q){if(!Q)return null;const q=Q.filter(_t);return 0==q.length?null:function(j){return Xt(ii(j,q))}}function Bi(Q){return null!=Q?Nn(wi(Q)):null}function Jn(Q){if(!Q)return null;const q=Q.filter(_t);return 0==q.length?null:function(j){const be=ii(j,q).map(Dn);return(0,a.D)(be).pipe((0,de.U)(Xt))}}function fn(Q){return null!=Q?Jn(wi(Q)):null}function Tt(Q,q){return null===Q?[q]:Array.isArray(Q)?[...Q,q]:[Q,q]}function Ge(Q){return Q._rawValidators}function Fe(Q){return Q._rawAsyncValidators}function ht(Q){return Q?Array.isArray(Q)?Q:[Q]:[]}function Xe(Q,q){return Array.isArray(Q)?Q.includes(q):Q===q}function ce(Q,q){const j=ht(q);return ht(Q).forEach(En=>{Xe(j,En)||j.push(En)}),j}function ot(Q,q){return ht(q).filter(j=>!Xe(Q,j))}class Se{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(q){this._rawValidators=q||[],this._composedValidatorFn=Bi(this._rawValidators)}_setAsyncValidators(q){this._rawAsyncValidators=q||[],this._composedAsyncValidatorFn=fn(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(q){this._onDestroyCallbacks.push(q)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(q=>q()),this._onDestroyCallbacks=[]}reset(q){this.control&&this.control.reset(q)}hasError(q,j){return!!this.control&&this.control.hasError(q,j)}getError(q,j){return this.control?this.control.getError(q,j):null}}class St extends Se{get formDirective(){return null}get path(){return null}}class tn extends Se{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class li{constructor(q){this._cd=q}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let ae=(()=>{class Q extends li{constructor(j){super(j)}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(tn,2))},Q.\u0275dir=w.lG2({type:Q,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(j,be){2&j&&w.ekj("ng-untouched",be.isUntouched)("ng-touched",be.isTouched)("ng-pristine",be.isPristine)("ng-dirty",be.isDirty)("ng-valid",be.isValid)("ng-invalid",be.isInvalid)("ng-pending",be.isPending)},features:[w.qOj]}),Q})(),$e=(()=>{class Q extends li{constructor(j){super(j)}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(St,10))},Q.\u0275dir=w.lG2({type:Q,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(j,be){2&j&&w.ekj("ng-untouched",be.isUntouched)("ng-touched",be.isTouched)("ng-pristine",be.isPristine)("ng-dirty",be.isDirty)("ng-valid",be.isValid)("ng-invalid",be.isInvalid)("ng-pending",be.isPending)("ng-submitted",be.isSubmitted)},features:[w.qOj]}),Q})();const lt="VALID",nn="INVALID",_i="PENDING",Qt="DISABLED";function xt(Q){return(ri(Q)?Q.validators:Q)||null}function pt(Q){return Array.isArray(Q)?Bi(Q):Q||null}function Yt(Q,q){return(ri(q)?q.asyncValidators:Q)||null}function bn(Q){return Array.isArray(Q)?fn(Q):Q||null}function ri(Q){return null!=Q&&!Array.isArray(Q)&&"object"==typeof Q}function Ee(Q,q,j){const be=Q.controls;if(!(q?Object.keys(be):be).length)throw new w.vHH(1e3,"");if(!be[j])throw new w.vHH(1001,"")}function ee(Q,q,j){Q._forEachChild((be,En)=>{if(void 0===j[En])throw new w.vHH(1002,"")})}class oe{constructor(q,j){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=q,this._rawAsyncValidators=j,this._composedValidatorFn=pt(this._rawValidators),this._composedAsyncValidatorFn=bn(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(q){this._rawValidators=this._composedValidatorFn=q}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(q){this._rawAsyncValidators=this._composedAsyncValidatorFn=q}get parent(){return this._parent}get valid(){return this.status===lt}get invalid(){return this.status===nn}get pending(){return this.status==_i}get disabled(){return this.status===Qt}get enabled(){return this.status!==Qt}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(q){this._rawValidators=q,this._composedValidatorFn=pt(q)}setAsyncValidators(q){this._rawAsyncValidators=q,this._composedAsyncValidatorFn=bn(q)}addValidators(q){this.setValidators(ce(q,this._rawValidators))}addAsyncValidators(q){this.setAsyncValidators(ce(q,this._rawAsyncValidators))}removeValidators(q){this.setValidators(ot(q,this._rawValidators))}removeAsyncValidators(q){this.setAsyncValidators(ot(q,this._rawAsyncValidators))}hasValidator(q){return Xe(this._rawValidators,q)}hasAsyncValidator(q){return Xe(this._rawAsyncValidators,q)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(q={}){this.touched=!0,this._parent&&!q.onlySelf&&this._parent.markAsTouched(q)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(q=>q.markAllAsTouched())}markAsUntouched(q={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(j=>{j.markAsUntouched({onlySelf:!0})}),this._parent&&!q.onlySelf&&this._parent._updateTouched(q)}markAsDirty(q={}){this.pristine=!1,this._parent&&!q.onlySelf&&this._parent.markAsDirty(q)}markAsPristine(q={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(j=>{j.markAsPristine({onlySelf:!0})}),this._parent&&!q.onlySelf&&this._parent._updatePristine(q)}markAsPending(q={}){this.status=_i,!1!==q.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!q.onlySelf&&this._parent.markAsPending(q)}disable(q={}){const j=this._parentMarkedDirty(q.onlySelf);this.status=Qt,this.errors=null,this._forEachChild(be=>{be.disable({...q,onlySelf:!0})}),this._updateValue(),!1!==q.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...q,skipPristineCheck:j}),this._onDisabledChange.forEach(be=>be(!0))}enable(q={}){const j=this._parentMarkedDirty(q.onlySelf);this.status=lt,this._forEachChild(be=>{be.enable({...q,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:q.emitEvent}),this._updateAncestors({...q,skipPristineCheck:j}),this._onDisabledChange.forEach(be=>be(!1))}_updateAncestors(q){this._parent&&!q.onlySelf&&(this._parent.updateValueAndValidity(q),q.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(q){this._parent=q}getRawValue(){return this.value}updateValueAndValidity(q={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===lt||this.status===_i)&&this._runAsyncValidator(q.emitEvent)),!1!==q.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!q.onlySelf&&this._parent.updateValueAndValidity(q)}_updateTreeValidity(q={emitEvent:!0}){this._forEachChild(j=>j._updateTreeValidity(q)),this.updateValueAndValidity({onlySelf:!0,emitEvent:q.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Qt:lt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(q){if(this.asyncValidator){this.status=_i,this._hasOwnPendingAsyncValidator=!0;const j=Dn(this.asyncValidator(this));this._asyncValidationSubscription=j.subscribe(be=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(be,{emitEvent:q})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(q,j={}){this.errors=q,this._updateControlsErrors(!1!==j.emitEvent)}get(q){let j=q;return null==j||(Array.isArray(j)||(j=j.split(".")),0===j.length)?null:j.reduce((be,En)=>be&&be._find(En),this)}getError(q,j){const be=j?this.get(j):this;return be&&be.errors?be.errors[q]:null}hasError(q,j){return!!this.getError(q,j)}get root(){let q=this;for(;q._parent;)q=q._parent;return q}_updateControlsErrors(q){this.status=this._calculateStatus(),q&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(q)}_initObservables(){this.valueChanges=new w.vpe,this.statusChanges=new w.vpe}_calculateStatus(){return this._allControlsDisabled()?Qt:this.errors?nn:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_i)?_i:this._anyControlsHaveStatus(nn)?nn:lt}_anyControlsHaveStatus(q){return this._anyControls(j=>j.status===q)}_anyControlsDirty(){return this._anyControls(q=>q.dirty)}_anyControlsTouched(){return this._anyControls(q=>q.touched)}_updatePristine(q={}){this.pristine=!this._anyControlsDirty(),this._parent&&!q.onlySelf&&this._parent._updatePristine(q)}_updateTouched(q={}){this.touched=this._anyControlsTouched(),this._parent&&!q.onlySelf&&this._parent._updateTouched(q)}_registerOnCollectionChange(q){this._onCollectionChange=q}_setUpdateStrategy(q){ri(q)&&null!=q.updateOn&&(this._updateOn=q.updateOn)}_parentMarkedDirty(q){return!q&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(q){return null}}class Me extends oe{constructor(q,j,be){super(xt(j),Yt(be,j)),this.controls=q,this._initObservables(),this._setUpdateStrategy(j),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(q,j){return this.controls[q]?this.controls[q]:(this.controls[q]=j,j.setParent(this),j._registerOnCollectionChange(this._onCollectionChange),j)}addControl(q,j,be={}){this.registerControl(q,j),this.updateValueAndValidity({emitEvent:be.emitEvent}),this._onCollectionChange()}removeControl(q,j={}){this.controls[q]&&this.controls[q]._registerOnCollectionChange(()=>{}),delete this.controls[q],this.updateValueAndValidity({emitEvent:j.emitEvent}),this._onCollectionChange()}setControl(q,j,be={}){this.controls[q]&&this.controls[q]._registerOnCollectionChange(()=>{}),delete this.controls[q],j&&this.registerControl(q,j),this.updateValueAndValidity({emitEvent:be.emitEvent}),this._onCollectionChange()}contains(q){return this.controls.hasOwnProperty(q)&&this.controls[q].enabled}setValue(q,j={}){ee(this,0,q),Object.keys(q).forEach(be=>{Ee(this,!0,be),this.controls[be].setValue(q[be],{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j)}patchValue(q,j={}){null!=q&&(Object.keys(q).forEach(be=>{const En=this.controls[be];En&&En.patchValue(q[be],{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j))}reset(q={},j={}){this._forEachChild((be,En)=>{be.reset(q[En],{onlySelf:!0,emitEvent:j.emitEvent})}),this._updatePristine(j),this._updateTouched(j),this.updateValueAndValidity(j)}getRawValue(){return this._reduceChildren({},(q,j,be)=>(q[be]=j.getRawValue(),q))}_syncPendingControls(){let q=this._reduceChildren(!1,(j,be)=>!!be._syncPendingControls()||j);return q&&this.updateValueAndValidity({onlySelf:!0}),q}_forEachChild(q){Object.keys(this.controls).forEach(j=>{const be=this.controls[j];be&&q(be,j)})}_setUpControls(){this._forEachChild(q=>{q.setParent(this),q._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(q){for(const[j,be]of Object.entries(this.controls))if(this.contains(j)&&q(be))return!0;return!1}_reduceValue(){return this._reduceChildren({},(j,be,En)=>((be.enabled||this.disabled)&&(j[En]=be.value),j))}_reduceChildren(q,j){let be=q;return this._forEachChild((En,bi)=>{be=j(be,En,bi)}),be}_allControlsDisabled(){for(const q of Object.keys(this.controls))if(this.controls[q].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(q){return this.controls.hasOwnProperty(q)?this.controls[q]:null}}class Lt extends Me{}function Mt(Q,q){return[...q.path,Q]}function le(Q,q){Zt(Q,q),q.valueAccessor.writeValue(Q.value),Q.disabled&&q.valueAccessor.setDisabledState?.(!0),function jn(Q,q){q.valueAccessor.registerOnChange(j=>{Q._pendingValue=j,Q._pendingChange=!0,Q._pendingDirty=!0,"change"===Q.updateOn&&Ai(Q,q)})}(Q,q),function Ri(Q,q){const j=(be,En)=>{q.valueAccessor.writeValue(be),En&&q.viewToModelUpdate(be)};Q.registerOnChange(j),q._registerOnDestroy(()=>{Q._unregisterOnChange(j)})}(Q,q),function Xn(Q,q){q.valueAccessor.registerOnTouched(()=>{Q._pendingTouched=!0,"blur"===Q.updateOn&&Q._pendingChange&&Ai(Q,q),"submit"!==Q.updateOn&&Q.markAsTouched()})}(Q,q),function Ue(Q,q){if(q.valueAccessor.setDisabledState){const j=be=>{q.valueAccessor.setDisabledState(be)};Q.registerOnDisabledChange(j),q._registerOnDestroy(()=>{Q._unregisterOnDisabledChange(j)})}}(Q,q)}function _e(Q,q,j=!0){const be=()=>{};q.valueAccessor&&(q.valueAccessor.registerOnChange(be),q.valueAccessor.registerOnTouched(be)),Tn(Q,q),Q&&(q._invokeOnDestroyCallbacks(),Q._registerOnCollectionChange(()=>{}))}function he(Q,q){Q.forEach(j=>{j.registerOnValidatorChange&&j.registerOnValidatorChange(q)})}function Zt(Q,q){const j=Ge(Q);null!==q.validator?Q.setValidators(Tt(j,q.validator)):"function"==typeof j&&Q.setValidators([j]);const be=Fe(Q);null!==q.asyncValidator?Q.setAsyncValidators(Tt(be,q.asyncValidator)):"function"==typeof be&&Q.setAsyncValidators([be]);const En=()=>Q.updateValueAndValidity();he(q._rawValidators,En),he(q._rawAsyncValidators,En)}function Tn(Q,q){let j=!1;if(null!==Q){if(null!==q.validator){const En=Ge(Q);if(Array.isArray(En)&&En.length>0){const bi=En.filter(io=>io!==q.validator);bi.length!==En.length&&(j=!0,Q.setValidators(bi))}}if(null!==q.asyncValidator){const En=Fe(Q);if(Array.isArray(En)&&En.length>0){const bi=En.filter(io=>io!==q.asyncValidator);bi.length!==En.length&&(j=!0,Q.setAsyncValidators(bi))}}}const be=()=>{};return he(q._rawValidators,be),he(q._rawAsyncValidators,be),j}function Ai(Q,q){Q._pendingDirty&&Q.markAsDirty(),Q.setValue(Q._pendingValue,{emitModelToViewChange:!1}),q.viewToModelUpdate(Q._pendingValue),Q._pendingChange=!1}function Gn(Q,q){Zt(Q,q)}function _n(Q,q){if(!Q.hasOwnProperty("model"))return!1;const j=Q.model;return!!j.isFirstChange()||!Object.is(q,j.currentValue)}function tr(Q,q){Q._syncPendingControls(),q.forEach(j=>{const be=j.control;"submit"===be.updateOn&&be._pendingChange&&(j.viewToModelUpdate(be._pendingValue),be._pendingChange=!1)})}function Ao(Q,q){if(!q)return null;let j,be,En;return Array.isArray(q),q.forEach(bi=>{bi.constructor===wt?j=bi:function So(Q){return Object.getPrototypeOf(Q.constructor)===it}(bi)?be=bi:En=bi}),En||be||j||null}const gs={provide:St,useExisting:(0,w.Gpc)(()=>hn)},kn=(()=>Promise.resolve())();let hn=(()=>{class Q extends St{constructor(j,be){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new w.vpe,this.form=new Me({},Bi(j),fn(be))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(j){kn.then(()=>{const be=this._findContainer(j.path);j.control=be.registerControl(j.name,j.control),le(j.control,j),j.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(j)})}getControl(j){return this.form.get(j.path)}removeControl(j){kn.then(()=>{const be=this._findContainer(j.path);be&&be.removeControl(j.name),this._directives.delete(j)})}addFormGroup(j){kn.then(()=>{const be=this._findContainer(j.path),En=new Me({});Gn(En,j),be.registerControl(j.name,En),En.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(j){kn.then(()=>{const be=this._findContainer(j.path);be&&be.removeControl(j.name)})}getFormGroup(j){return this.form.get(j.path)}updateModel(j,be){kn.then(()=>{this.form.get(j.path).setValue(be)})}setValue(j){this.control.setValue(j)}onSubmit(j){return this.submitted=!0,tr(this.form,this._directives),this.ngSubmit.emit(j),"dialog"===j?.target?.method}onReset(){this.resetForm()}resetForm(j){this.form.reset(j),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(j){return j.pop(),j.length?this.form.get(j):this.form}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(Qe,10),w.Y36(Hn,10))},Q.\u0275dir=w.lG2({type:Q,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(j,be){1&j&&w.NdJ("submit",function(bi){return be.onSubmit(bi)})("reset",function(){return be.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[w._Bn([gs]),w.qOj]}),Q})();function Ie(Q,q){const j=Q.indexOf(q);j>-1&&Q.splice(j,1)}function Gt(Q){return"object"==typeof Q&&null!==Q&&2===Object.keys(Q).length&&"value"in Q&&"disabled"in Q}const Fn=class extends oe{constructor(q=null,j,be){super(xt(j),Yt(be,j)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(q),this._setUpdateStrategy(j),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ri(j)&&(j.nonNullable||j.initialValueIsDefault)&&(this.defaultValue=Gt(q)?q.value:q)}setValue(q,j={}){this.value=this._pendingValue=q,this._onChange.length&&!1!==j.emitModelToViewChange&&this._onChange.forEach(be=>be(this.value,!1!==j.emitViewToModelChange)),this.updateValueAndValidity(j)}patchValue(q,j={}){this.setValue(q,j)}reset(q=this.defaultValue,j={}){this._applyFormState(q),this.markAsPristine(j),this.markAsUntouched(j),this.setValue(this.value,j),this._pendingChange=!1}_updateValue(){}_anyControls(q){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(q){this._onChange.push(q)}_unregisterOnChange(q){Ie(this._onChange,q)}registerOnDisabledChange(q){this._onDisabledChange.push(q)}_unregisterOnDisabledChange(q){Ie(this._onDisabledChange,q)}_forEachChild(q){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(q){Gt(q)?(this.value=this._pendingValue=q.value,q.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=q}},Ds={provide:tn,useExisting:(0,w.Gpc)(()=>is)},Ts=(()=>Promise.resolve())();let is=(()=>{class Q extends tn{constructor(j,be,En,bi,io){super(),this._changeDetectorRef=io,this.control=new Fn,this._registered=!1,this.update=new w.vpe,this._parent=j,this._setValidators(be),this._setAsyncValidators(En),this.valueAccessor=Ao(0,bi)}ngOnChanges(j){if(this._checkForErrors(),!this._registered||"name"in j){if(this._registered&&(this._checkName(),this.formDirective)){const be=j.name.previousValue;this.formDirective.removeControl({name:be,path:this._getPath(be)})}this._setUpControl()}"isDisabled"in j&&this._updateDisabled(j),_n(j,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(j){this.viewModel=j,this.update.emit(j)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){le(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(j){Ts.then(()=>{this.control.setValue(j,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(j){const be=j.isDisabled.currentValue,En=0!==be&&(0,w.D6c)(be);Ts.then(()=>{En&&!this.control.disabled?this.control.disable():!En&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(j){return this._parent?Mt(j,this._parent):[j]}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(St,9),w.Y36(Qe,10),w.Y36(Hn,10),w.Y36(Le,10),w.Y36(w.sBO,8))},Q.\u0275dir=w.lG2({type:Q,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[w._Bn([Ds]),w.qOj,w.TTD]}),Q})(),ks=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275dir=w.lG2({type:Q,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),Q})();const Ha={provide:Le,useExisting:(0,w.Gpc)(()=>kr),multi:!0};let nl=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=w.oAB({type:Q}),Q.\u0275inj=w.cJS({}),Q})(),Io=(()=>{class Q{constructor(){this._accessors=[]}add(j,be){this._accessors.push([j,be])}remove(j){for(let be=this._accessors.length-1;be>=0;--be)if(this._accessors[be][1]===j)return void this._accessors.splice(be,1)}select(j){this._accessors.forEach(be=>{this._isSameGroup(be,j)&&be[1]!==j&&be[1].fireUncheck(j.value)})}_isSameGroup(j,be){return!!j[0].control&&j[0]._parent===be._control._parent&&j[1].name===be.name}}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275prov=w.Yz7({token:Q,factory:Q.\u0275fac,providedIn:nl}),Q})(),kr=(()=>{class Q extends it{constructor(j,be,En,bi){super(j,be),this._registry=En,this._injector=bi,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(tn),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(j){this._state=j===this.value,this.setProperty("checked",this._state)}registerOnChange(j){this._fn=j,this.onChange=()=>{j(this.value),this._registry.select(this)}}fireUncheck(j){this.writeValue(j)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(Io),w.Y36(w.zs3))},Q.\u0275dir=w.lG2({type:Q,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(j,be){1&j&&w.NdJ("change",function(){return be.onChange()})("blur",function(){return be.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[w._Bn([Ha]),w.qOj]}),Q})();const Qr=new w.OlP("NgModelWithFormControlWarning"),ca={provide:St,useExisting:(0,w.Gpc)(()=>Jr)};let Jr=(()=>{class Q extends St{constructor(j,be){super(),this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new w.vpe,this._setValidators(j),this._setAsyncValidators(be)}ngOnChanges(j){this._checkFormPresent(),j.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Tn(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(j){const be=this.form.get(j.path);return le(be,j),be.updateValueAndValidity({emitEvent:!1}),this.directives.push(j),be}getControl(j){return this.form.get(j.path)}removeControl(j){_e(j.control||null,j,!1),function wa(Q,q){const j=Q.indexOf(q);j>-1&&Q.splice(j,1)}(this.directives,j)}addFormGroup(j){this._setUpFormContainer(j)}removeFormGroup(j){this._cleanUpFormContainer(j)}getFormGroup(j){return this.form.get(j.path)}addFormArray(j){this._setUpFormContainer(j)}removeFormArray(j){this._cleanUpFormContainer(j)}getFormArray(j){return this.form.get(j.path)}updateModel(j,be){this.form.get(j.path).setValue(be)}onSubmit(j){return this.submitted=!0,tr(this.form,this.directives),this.ngSubmit.emit(j),"dialog"===j?.target?.method}onReset(){this.resetForm()}resetForm(j){this.form.reset(j),this.submitted=!1}_updateDomValue(){this.directives.forEach(j=>{const be=j.control,En=this.form.get(j.path);be!==En&&(_e(be||null,j),(Q=>Q instanceof Fn)(En)&&(le(En,j),j.control=En))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(j){const be=this.form.get(j.path);Gn(be,j),be.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(j){if(this.form){const be=this.form.get(j.path);be&&function er(Q,q){return Tn(Q,q)}(be,j)&&be.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Zt(this.form,this),this._oldForm&&Tn(this._oldForm,this)}_checkFormPresent(){}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(Qe,10),w.Y36(Hn,10))},Q.\u0275dir=w.lG2({type:Q,selectors:[["","formGroup",""]],hostBindings:function(j,be){1&j&&w.NdJ("submit",function(bi){return be.onSubmit(bi)})("reset",function(){return be.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[w._Bn([ca]),w.qOj,w.TTD]}),Q})();const ys={provide:tn,useExisting:(0,w.Gpc)(()=>Ho)};let Ho=(()=>{class Q extends tn{constructor(j,be,En,bi,io){super(),this._ngModelWarningConfig=io,this._added=!1,this.update=new w.vpe,this._ngModelWarningSent=!1,this._parent=j,this._setValidators(be),this._setAsyncValidators(En),this.valueAccessor=Ao(0,bi)}set isDisabled(j){}ngOnChanges(j){this._added||this._setUpControl(),_n(j,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(j){this.viewModel=j,this.update.emit(j)}get path(){return Mt(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return Q._ngModelWarningSentOnce=!1,Q.\u0275fac=function(j){return new(j||Q)(w.Y36(St,13),w.Y36(Qe,10),w.Y36(Hn,10),w.Y36(Le,10),w.Y36(Qr,8))},Q.\u0275dir=w.lG2({type:Q,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[w._Bn([ys]),w.qOj,w.TTD]}),Q})();const Ls={provide:Le,useExisting:(0,w.Gpc)(()=>Ns),multi:!0};function Bs(Q,q){return null==Q?`${q}`:(q&&"object"==typeof q&&(q="Object"),`${Q}: ${q}`.slice(0,50))}let Ns=(()=>{class Q extends it{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(j){this._compareWith=j}writeValue(j){this.value=j;const En=Bs(this._getOptionId(j),j);this.setProperty("value",En)}registerOnChange(j){this.onChange=be=>{this.value=this._getOptionValue(be),j(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(j){for(const be of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(be),j))return be;return null}_getOptionValue(j){const be=function Ca(Q){return Q.split(":")[0]}(j);return this._optionMap.has(be)?this._optionMap.get(be):j}}return Q.\u0275fac=function(){let q;return function(be){return(q||(q=w.n5z(Q)))(be||Q)}}(),Q.\u0275dir=w.lG2({type:Q,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(j,be){1&j&&w.NdJ("change",function(bi){return be.onChange(bi.target.value)})("blur",function(){return be.onTouched()})},inputs:{compareWith:"compareWith"},features:[w._Bn([Ls]),w.qOj]}),Q})(),Go=(()=>{class Q{constructor(j,be,En){this._element=j,this._renderer=be,this._select=En,this._select&&(this.id=this._select._registerOption())}set ngValue(j){null!=this._select&&(this._select._optionMap.set(this.id,j),this._setElementValue(Bs(this.id,j)),this._select.writeValue(this._select.value))}set value(j){this._setElementValue(j),this._select&&this._select.writeValue(this._select.value)}_setElementValue(j){this._renderer.setProperty(this._element.nativeElement,"value",j)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(Ns,9))},Q.\u0275dir=w.lG2({type:Q,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),Q})();const Ma={provide:Le,useExisting:(0,w.Gpc)(()=>Co),multi:!0};function il(Q,q){return null==Q?`${q}`:("string"==typeof q&&(q=`'${q}'`),q&&"object"==typeof q&&(q="Object"),`${Q}: ${q}`.slice(0,50))}let Co=(()=>{class Q extends it{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(j){this._compareWith=j}writeValue(j){let be;if(this.value=j,Array.isArray(j)){const En=j.map(bi=>this._getOptionId(bi));be=(bi,io)=>{bi._setSelected(En.indexOf(io.toString())>-1)}}else be=(En,bi)=>{En._setSelected(!1)};this._optionMap.forEach(be)}registerOnChange(j){this.onChange=be=>{const En=[],bi=be.selectedOptions;if(void 0!==bi){const io=bi;for(let Is=0;Is<io.length;Is++){const Lr=this._getOptionValue(io[Is].value);En.push(Lr)}}else{const io=be.options;for(let Is=0;Is<io.length;Is++){const xs=io[Is];if(xs.selected){const Lr=this._getOptionValue(xs.value);En.push(Lr)}}}this.value=En,j(En)}}_registerOption(j){const be=(this._idCounter++).toString();return this._optionMap.set(be,j),be}_getOptionId(j){for(const be of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(be)._value,j))return be;return null}_getOptionValue(j){const be=function rs(Q){return Q.split(":")[0]}(j);return this._optionMap.has(be)?this._optionMap.get(be)._value:j}}return Q.\u0275fac=function(){let q;return function(be){return(q||(q=w.n5z(Q)))(be||Q)}}(),Q.\u0275dir=w.lG2({type:Q,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(j,be){1&j&&w.NdJ("change",function(bi){return be.onChange(bi.target)})("blur",function(){return be.onTouched()})},inputs:{compareWith:"compareWith"},features:[w._Bn([Ma]),w.qOj]}),Q})(),Wr=(()=>{class Q{constructor(j,be,En){this._element=j,this._renderer=be,this._select=En,this._select&&(this.id=this._select._registerOption(this))}set ngValue(j){null!=this._select&&(this._value=j,this._setElementValue(il(this.id,j)),this._select.writeValue(this._select.value))}set value(j){this._select?(this._value=j,this._setElementValue(il(this.id,j)),this._select.writeValue(this._select.value)):this._setElementValue(j)}_setElementValue(j){this._renderer.setProperty(this._element.nativeElement,"value",j)}_setSelected(j){this._renderer.setProperty(this._element.nativeElement,"selected",j)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return Q.\u0275fac=function(j){return new(j||Q)(w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(Co,9))},Q.\u0275dir=w.lG2({type:Q,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),Q})(),Ta=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=w.oAB({type:Q}),Q.\u0275inj=w.cJS({imports:[nl]}),Q})(),Us=(()=>{class Q{}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=w.oAB({type:Q}),Q.\u0275inj=w.cJS({imports:[Ta]}),Q})(),as=(()=>{class Q{static withConfig(j){return{ngModule:Q,providers:[{provide:Qr,useValue:j.warnOnNgModelWithFormControl}]}}}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275mod=w.oAB({type:Q}),Q.\u0275inj=w.cJS({imports:[Ta]}),Q})();class As extends oe{constructor(q,j,be){super(xt(j),Yt(be,j)),this.controls=q,this._initObservables(),this._setUpdateStrategy(j),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(q){return this.controls[this._adjustIndex(q)]}push(q,j={}){this.controls.push(q),this._registerControl(q),this.updateValueAndValidity({emitEvent:j.emitEvent}),this._onCollectionChange()}insert(q,j,be={}){this.controls.splice(q,0,j),this._registerControl(j),this.updateValueAndValidity({emitEvent:be.emitEvent})}removeAt(q,j={}){let be=this._adjustIndex(q);be<0&&(be=0),this.controls[be]&&this.controls[be]._registerOnCollectionChange(()=>{}),this.controls.splice(be,1),this.updateValueAndValidity({emitEvent:j.emitEvent})}setControl(q,j,be={}){let En=this._adjustIndex(q);En<0&&(En=0),this.controls[En]&&this.controls[En]._registerOnCollectionChange(()=>{}),this.controls.splice(En,1),j&&(this.controls.splice(En,0,j),this._registerControl(j)),this.updateValueAndValidity({emitEvent:be.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(q,j={}){ee(this,0,q),q.forEach((be,En)=>{Ee(this,!1,En),this.at(En).setValue(be,{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j)}patchValue(q,j={}){null!=q&&(q.forEach((be,En)=>{this.at(En)&&this.at(En).patchValue(be,{onlySelf:!0,emitEvent:j.emitEvent})}),this.updateValueAndValidity(j))}reset(q=[],j={}){this._forEachChild((be,En)=>{be.reset(q[En],{onlySelf:!0,emitEvent:j.emitEvent})}),this._updatePristine(j),this._updateTouched(j),this.updateValueAndValidity(j)}getRawValue(){return this.controls.map(q=>q.getRawValue())}clear(q={}){this.controls.length<1||(this._forEachChild(j=>j._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:q.emitEvent}))}_adjustIndex(q){return q<0?q+this.length:q}_syncPendingControls(){let q=this.controls.reduce((j,be)=>!!be._syncPendingControls()||j,!1);return q&&this.updateValueAndValidity({onlySelf:!0}),q}_forEachChild(q){this.controls.forEach((j,be)=>{q(j,be)})}_updateValue(){this.value=this.controls.filter(q=>q.enabled||this.disabled).map(q=>q.value)}_anyControls(q){return this.controls.some(j=>j.enabled&&q(j))}_setUpControls(){this._forEachChild(q=>this._registerControl(q))}_allControlsDisabled(){for(const q of this.controls)if(q.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(q){q.setParent(this),q._registerOnCollectionChange(this._onCollectionChange)}_find(q){return this.at(q)??null}}function wn(Q){return!!Q&&(void 0!==Q.asyncValidators||void 0!==Q.validators||void 0!==Q.updateOn)}let ar=(()=>{class Q{constructor(){this.useNonNullable=!1}get nonNullable(){const j=new Q;return j.useNonNullable=!0,j}group(j,be=null){const En=this._reduceControls(j);let bi={};return wn(be)?bi=be:null!==be&&(bi.validators=be.validator,bi.asyncValidators=be.asyncValidator),new Me(En,bi)}record(j,be=null){const En=this._reduceControls(j);return new Lt(En,be)}control(j,be,En){let bi={};return this.useNonNullable?(wn(be)?bi=be:(bi.validators=be,bi.asyncValidators=En),new Fn(j,{...bi,nonNullable:!0})):new Fn(j,be,En)}array(j,be,En){const bi=j.map(io=>this._createControl(io));return new As(bi,be,En)}_reduceControls(j){const be={};return Object.keys(j).forEach(En=>{be[En]=this._createControl(j[En])}),be}_createControl(j){return j instanceof Fn||j instanceof oe?j:Array.isArray(j)?this.control(j[0],j.length>1?j[1]:null,j.length>2?j[2]:null):this.control(j)}}return Q.\u0275fac=function(j){return new(j||Q)},Q.\u0275prov=w.Yz7({token:Q,factory:Q.\u0275fac,providedIn:as}),Q})()},7957:(ti,Vt,B)=>{"use strict";B.d(Vt,{Bb:()=>Xe,XC:()=>vi,ZL:()=>ht});var w=B(2687),_=B(1281),pe=B(3353),a=B(4650),de=B(3238),ut=B(727),it=B(7579),Le=B(9770),ke=B(6451),rt=B(9646),ft=B(4968),Et=B(6895),dt=B(8184),wt=B(8605),tt=B(445),Wt=B(9521),kt=B(4080),Qe=B(4006),Hn=B(7676),Ln=B(5698),Ye=B(3900),Ce=B(9300),we=B(4004),At=B(8505),zt=B(1005);const Jt=["panel"];function Cn(ce,ot){if(1&ce&&(a.TgZ(0,"div",0,1),a.Hsn(2),a.qZA()),2&ce){const Se=ot.id,St=a.oxw();a.Q6J("id",St.id)("ngClass",St._classList),a.uIk("aria-label",St.ariaLabel||null)("aria-labelledby",St._getPanelAriaLabelledby(Se))}}const Ke=["*"];let Ne=0;class He{constructor(ot,Se){this.source=ot,this.option=Se}}const _t=(0,de.Kr)(class{}),Dn=new a.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function Xt(){return{autoActiveFirstOption:!1}}});let ii=(()=>{class ce extends _t{constructor(Se,St,tn,li){super(),this._changeDetectorRef=Se,this._elementRef=St,this._activeOptionChanges=ut.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new a.vpe,this.opened=new a.vpe,this.closed=new a.vpe,this.optionActivated=new a.vpe,this._classList={},this.id="mat-autocomplete-"+Ne++,this.inertGroups=li?.SAFARI||!1,this._autoActiveFirstOption=!!tn.autoActiveFirstOption}get isOpen(){return this._isOpen&&this.showPanel}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(Se){this._autoActiveFirstOption=(0,_.Ig)(Se)}set classList(Se){this._classList=Se&&Se.length?(0,_.du)(Se).reduce((St,tn)=>(St[tn]=!0,St),{}):{},this._setVisibilityClasses(this._classList),this._elementRef.nativeElement.className=""}ngAfterContentInit(){this._keyManager=new w.s1(this.options).withWrap(),this._activeOptionChanges=this._keyManager.change.subscribe(Se=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[Se]||null})}),this._setVisibility()}ngOnDestroy(){this._activeOptionChanges.unsubscribe()}_setScrollTop(Se){this.panel&&(this.panel.nativeElement.scrollTop=Se)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(Se){const St=new He(this,Se);this.optionSelected.emit(St)}_getPanelAriaLabelledby(Se){return this.ariaLabel?null:this.ariaLabelledby?(Se?Se+" ":"")+this.ariaLabelledby:Se}_setVisibilityClasses(Se){Se[this._visibleClass]=this.showPanel,Se[this._hiddenClass]=!this.showPanel}}return ce.\u0275fac=function(Se){return new(Se||ce)(a.Y36(a.sBO),a.Y36(a.SBq),a.Y36(Dn),a.Y36(pe.t4))},ce.\u0275dir=a.lG2({type:ce,viewQuery:function(Se,St){if(1&Se&&(a.Gf(a.Rgc,7),a.Gf(Jt,5)),2&Se){let tn;a.iGM(tn=a.CRH())&&(St.template=tn.first),a.iGM(tn=a.CRH())&&(St.panel=tn.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[a.qOj]}),ce})(),vi=(()=>{class ce extends ii{constructor(){super(...arguments),this._visibleClass="mat-autocomplete-visible",this._hiddenClass="mat-autocomplete-hidden"}}return ce.\u0275fac=function(){let ot;return function(St){return(ot||(ot=a.n5z(ce)))(St||ce)}}(),ce.\u0275cmp=a.Xpm({type:ce,selectors:[["mat-autocomplete"]],contentQueries:function(Se,St,tn){if(1&Se&&(a.Suo(tn,de.K7,5),a.Suo(tn,de.ey,5)),2&Se){let li;a.iGM(li=a.CRH())&&(St.optionGroups=li),a.iGM(li=a.CRH())&&(St.options=li)}},hostAttrs:[1,"mat-autocomplete"],inputs:{disableRipple:"disableRipple"},exportAs:["matAutocomplete"],features:[a._Bn([{provide:de.HF,useExisting:ce}]),a.qOj],ngContentSelectors:Ke,decls:1,vars:0,consts:[["role","listbox",1,"mat-autocomplete-panel",3,"id","ngClass"],["panel",""]],template:function(Se,St){1&Se&&(a.F$t(),a.YNc(0,Cn,3,4,"ng-template"))},dependencies:[Et.mk],styles:[".mat-autocomplete-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;visibility:hidden;max-width:none;max-height:256px;position:relative;width:100%;border-bottom-left-radius:4px;border-bottom-right-radius:4px}.mat-autocomplete-panel.mat-autocomplete-visible{visibility:visible}.mat-autocomplete-panel.mat-autocomplete-hidden{visibility:hidden}.mat-autocomplete-panel-above .mat-autocomplete-panel{border-radius:0;border-top-left-radius:4px;border-top-right-radius:4px}.mat-autocomplete-panel .mat-divider-horizontal{margin-top:-1px}.cdk-high-contrast-active .mat-autocomplete-panel{outline:solid 1px}mat-autocomplete{display:none}\n"],encapsulation:2,changeDetection:0}),ce})();const Bi=new a.OlP("mat-autocomplete-scroll-strategy"),fn={provide:Bi,deps:[dt.aV],useFactory:function Jn(ce){return()=>ce.scrollStrategies.reposition()}},Tt={provide:Qe.JU,useExisting:(0,a.Gpc)(()=>ht),multi:!0};let Fe=(()=>{class ce{constructor(Se,St,tn,li,Wi,Mn,ae,$e,Rt,on,jt){this._element=Se,this._overlay=St,this._viewContainerRef=tn,this._zone=li,this._changeDetectorRef=Wi,this._dir=ae,this._formField=$e,this._document=Rt,this._viewportRuler=on,this._defaults=jt,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=ut.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new it.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,Le.P)(()=>this.autocomplete&&this.autocomplete.options?(0,ke.T)(...this.autocomplete.options.map(Bt=>Bt.onSelectionChange)):this._zone.onStable.pipe((0,Ln.q)(1),(0,Ye.w)(()=>this.optionSelections))),this._scrollStrategy=Mn}get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(Se){this._autocompleteDisabled=(0,_.Ig)(Se)}ngAfterViewInit(){const Se=this._getWindow();typeof Se<"u"&&this._zone.runOutsideAngular(()=>Se.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(Se){Se.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const Se=this._getWindow();typeof Se<"u"&&Se.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this.autocomplete.closed.emit(),this.autocomplete._isOpen=this._overlayAttached=!1,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._componentDestroyed||this._changeDetectorRef.detectChanges())}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,ke.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,Ce.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,Ce.h)(()=>this._overlayAttached)):(0,rt.of)()).pipe((0,we.U)(Se=>Se instanceof de.rN?Se:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,ke.T)((0,ft.R)(this._document,"click"),(0,ft.R)(this._document,"auxclick"),(0,ft.R)(this._document,"touchend")).pipe((0,Ce.h)(Se=>{const St=(0,pe.sA)(Se),tn=this._formField?this._formField._elementRef.nativeElement:null,li=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&St!==this._element.nativeElement&&(!tn||!tn.contains(St))&&(!li||!li.contains(St))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(St)}))}writeValue(Se){Promise.resolve(null).then(()=>this._setTriggerValue(Se))}registerOnChange(Se){this._onChange=Se}registerOnTouched(Se){this._onTouched=Se}setDisabledState(Se){this._element.nativeElement.disabled=Se}_handleKeydown(Se){const St=Se.keyCode;if(St===Wt.hY&&!(0,Wt.Vb)(Se)&&Se.preventDefault(),this.activeOption&&St===Wt.K5&&this.panelOpen)this.activeOption._selectViaInteraction(),this._resetActiveItem(),Se.preventDefault();else if(this.autocomplete){const tn=this.autocomplete._keyManager.activeItem,li=St===Wt.LH||St===Wt.JH;this.panelOpen||St===Wt.Mf?this.autocomplete._keyManager.onKeydown(Se):li&&this._canOpen()&&this.openPanel(),(li||this.autocomplete._keyManager.activeItem!==tn)&&this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0)}}_handleInput(Se){let St=Se.target,tn=St.value;"number"===St.type&&(tn=""==tn?null:parseFloat(tn)),this._previousValue!==tn&&(this._previousValue=tn,this._onChange(tn),this._canOpen()&&this._document.activeElement===Se.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_floatLabel(Se=!1){this._formField&&"auto"===this._formField.floatLabel&&(Se?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField.floatLabel="auto",this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const Se=this._zone.onStable.pipe((0,Ln.q)(1)),St=this.autocomplete.options.changes.pipe((0,At.b)(()=>this._positionStrategy.reapplyLastPosition()),(0,zt.g)(0));return(0,ke.T)(Se,St).pipe((0,Ye.w)(()=>{const tn=this.panelOpen;return this._resetActiveItem(),this.autocomplete._setVisibility(),this.panelOpen&&(this._overlayRef.updatePosition(),tn!==this.panelOpen&&this.autocomplete.opened.emit()),this.panelClosingActions}),(0,Ln.q)(1)).subscribe(tn=>this._setValueAndClose(tn))}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_setTriggerValue(Se){const tn=(this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(Se):Se)??"";this._formField?this._formField._control.value=tn:this._element.nativeElement.value=tn,this._previousValue=tn}_setValueAndClose(Se){Se&&Se.source&&(this._clearPreviousSelectedOption(Se.source),this._setTriggerValue(Se.source.value),this._onChange(Se.source.value),this._element.nativeElement.focus(),this.autocomplete._emitSelectEvent(Se.source)),this.closePanel()}_clearPreviousSelectedOption(Se){this.autocomplete.options.forEach(St=>{St!==Se&&St.selected&&St.deselect()})}_attachOverlay(){let Se=this._overlayRef;Se?(this._positionStrategy.setOrigin(this._getConnectedElement()),Se.updateSize({width:this._getPanelWidth()})):(this._portal=new kt.UE(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),Se=this._overlay.create(this._getOverlayConfig()),this._overlayRef=Se,Se.keydownEvents().subscribe(tn=>{(tn.keyCode===Wt.hY&&!(0,Wt.Vb)(tn)||tn.keyCode===Wt.LH&&(0,Wt.Vb)(tn,"altKey"))&&(this._closeKeyEventStream.next(),this._resetActiveItem(),tn.stopPropagation(),tn.preventDefault())}),this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&Se&&Se.updateSize({width:this._getPanelWidth()})})),Se&&!Se.hasAttached()&&(Se.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const St=this.panelOpen;this.autocomplete._setVisibility(),this.autocomplete._isOpen=this._overlayAttached=!0,this.panelOpen&&St!==this.panelOpen&&this.autocomplete.opened.emit()}_getOverlayConfig(){return new dt.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const Se=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(Se),this._positionStrategy=Se,Se}_setStrategyPositions(Se){const St=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],tn=this._aboveClass,li=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:tn},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:tn}];let Wi;Wi="above"===this.position?li:"below"===this.position?St:[...St,...li],Se.withPositions(Wi)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const Se=this.autocomplete;Se.autoActiveFirstOption?Se._keyManager.setFirstItemActive():Se._keyManager.setActiveItem(-1)}_canOpen(){const Se=this._element.nativeElement;return!Se.readOnly&&!Se.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(Se){const St=this.autocomplete,tn=(0,de.CB)(Se,St.options,St.optionGroups);if(0===Se&&1===tn)St._setScrollTop(0);else if(St.panel){const li=St.options.toArray()[Se];if(li){const Wi=li._getHostElement(),Mn=(0,de.jH)(Wi.offsetTop,Wi.offsetHeight,St._getScrollTop(),St.panel.nativeElement.offsetHeight);St._setScrollTop(Mn)}}}}return ce.\u0275fac=function(Se){return new(Se||ce)(a.Y36(a.SBq),a.Y36(dt.aV),a.Y36(a.s_b),a.Y36(a.R0b),a.Y36(a.sBO),a.Y36(Bi),a.Y36(tt.Is,8),a.Y36(Hn.G_,9),a.Y36(Et.K0,8),a.Y36(wt.rL),a.Y36(Dn,8))},ce.\u0275dir=a.lG2({type:ce,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[a.TTD]}),ce})(),ht=(()=>{class ce extends Fe{constructor(){super(...arguments),this._aboveClass="mat-autocomplete-panel-above"}}return ce.\u0275fac=function(){let ot;return function(St){return(ot||(ot=a.n5z(ce)))(St||ce)}}(),ce.\u0275dir=a.lG2({type:ce,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-autocomplete-trigger"],hostVars:7,hostBindings:function(Se,St){1&Se&&a.NdJ("focusin",function(){return St._handleFocus()})("blur",function(){return St._onTouched()})("input",function(li){return St._handleInput(li)})("keydown",function(li){return St._handleKeydown(li)}),2&Se&&a.uIk("autocomplete",St.autocompleteAttribute)("role",St.autocompleteDisabled?null:"combobox")("aria-autocomplete",St.autocompleteDisabled?null:"list")("aria-activedescendant",St.panelOpen&&St.activeOption?St.activeOption.id:null)("aria-expanded",St.autocompleteDisabled?null:St.panelOpen.toString())("aria-owns",St.autocompleteDisabled||!St.panelOpen||null==St.autocomplete?null:St.autocomplete.id)("aria-haspopup",!St.autocompleteDisabled)},exportAs:["matAutocompleteTrigger"],features:[a._Bn([Tt]),a.qOj]}),ce})(),Xe=(()=>{class ce{}return ce.\u0275fac=function(Se){return new(Se||ce)},ce.\u0275mod=a.oAB({type:ce}),ce.\u0275inj=a.cJS({providers:[fn],imports:[[dt.U8,de.Ng,de.BQ,Et.ez],wt.ZD,de.Ng,de.BQ]}),ce})()},4859:(ti,Vt,B)=>{"use strict";B.d(Vt,{lW:()=>rt,ot:()=>Et});var w=B(4650),_=B(3238),pe=B(2687);const a=["mat-button",""],de=["*"],Le=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],ke=(0,_.pj)((0,_.Id)((0,_.Kr)(class{constructor(dt){this._elementRef=dt}})));let rt=(()=>{class dt extends ke{constructor(tt,Wt,kt){super(tt),this._focusMonitor=Wt,this._animationMode=kt,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const Qe of Le)this._hasHostAttributes(Qe)&&this._getHostElement().classList.add(Qe);tt.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(tt,Wt){tt?this._focusMonitor.focusVia(this._getHostElement(),tt,Wt):this._getHostElement().focus(Wt)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...tt){return tt.some(Wt=>this._getHostElement().hasAttribute(Wt))}}return dt.\u0275fac=function(tt){return new(tt||dt)(w.Y36(w.SBq),w.Y36(pe.tE),w.Y36(w.QbO,8))},dt.\u0275cmp=w.Xpm({type:dt,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(tt,Wt){if(1&tt&&w.Gf(_.wG,5),2&tt){let kt;w.iGM(kt=w.CRH())&&(Wt.ripple=kt.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(tt,Wt){2&tt&&(w.uIk("disabled",Wt.disabled||null),w.ekj("_mat-animation-noopable","NoopAnimations"===Wt._animationMode)("mat-button-disabled",Wt.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[w.qOj],attrs:a,ngContentSelectors:de,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(tt,Wt){1&tt&&(w.F$t(),w.TgZ(0,"span",0),w.Hsn(1),w.qZA(),w._UZ(2,"span",1)(3,"span",2)),2&tt&&(w.xp6(2),w.ekj("mat-button-ripple-round",Wt.isRoundButton||Wt.isIconButton),w.Q6J("matRippleDisabled",Wt._isRippleDisabled())("matRippleCentered",Wt.isIconButton)("matRippleTrigger",Wt._getHostElement()))},dependencies:[_.wG],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),dt})(),Et=(()=>{class dt{}return dt.\u0275fac=function(tt){return new(tt||dt)},dt.\u0275mod=w.oAB({type:dt}),dt.\u0275inj=w.cJS({imports:[[_.si,_.BQ],_.BQ]}),dt})()},3238:(ti,Vt,B)=>{"use strict";B.d(Vt,{rD:()=>fn,K7:()=>te,HF:()=>Bt,BQ:()=>Ce,X2:()=>Tt,uc:()=>ht,ey:()=>Oi,Ng:()=>Hi,rN:()=>Rn,nP:()=>on,us:()=>jt,wG:()=>$e,si:()=>Rt,CB:()=>xn,jH:()=>Ji,pj:()=>At,Kr:()=>zt,Id:()=>we,FD:()=>Cn,sb:()=>Jt,E0:()=>Ge});var w=B(4650),_=B(2687),pe=B(445);const a=new w.GfV("13.0.0");var de=B(6895),ut=B(3353),it=B(1281),Le=B(7579),ke=B(8675),rt=B(9521);function dt(un,Pt){if(1&un&&w._UZ(0,"mat-pseudo-checkbox",4),2&un){const lt=w.oxw();w.Q6J("state",lt.selected?"checked":"unchecked")("disabled",lt.disabled)}}function wt(un,Pt){if(1&un&&(w.TgZ(0,"span",5),w._uU(1),w.qZA()),2&un){const lt=w.oxw();w.xp6(1),w.hij("(",lt.group.label,")")}}const tt=["*"],Hn=new w.GfV("13.0.0"),Ye=new w.OlP("mat-sanity-checks",{providedIn:"root",factory:function Ln(){return!0}});let Ce=(()=>{class un{constructor(lt,nn,_i){this._hasDoneGlobalChecks=!1,this._document=_i,lt._applyBodyHighContrastModeCssClasses(),this._sanityChecks=nn,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_checkIsEnabled(lt){return!(!(0,w.X6Q)()||(0,ut.Oy)())&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[lt])}_checkDoctypeIsDefined(){this._checkIsEnabled("doctype")&&!this._document.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){if(!this._checkIsEnabled("theme")||!this._document.body||"function"!=typeof getComputedStyle)return;const lt=this._document.createElement("div");lt.classList.add("mat-theme-loaded-marker"),this._document.body.appendChild(lt);const nn=getComputedStyle(lt);nn&&"none"!==nn.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),lt.remove()}_checkCdkVersionMatch(){this._checkIsEnabled("version")&&Hn.full!==a.full&&console.warn("The Angular Material version ("+Hn.full+") does not match the Angular CDK version ("+a.full+").\nPlease ensure the versions of these two packages exactly match.")}}return un.\u0275fac=function(lt){return new(lt||un)(w.LFG(_.qm),w.LFG(Ye,8),w.LFG(de.K0))},un.\u0275mod=w.oAB({type:un}),un.\u0275inj=w.cJS({imports:[[pe.vT],pe.vT]}),un})();function we(un){return class extends un{constructor(...Pt){super(...Pt),this._disabled=!1}get disabled(){return this._disabled}set disabled(Pt){this._disabled=(0,it.Ig)(Pt)}}}function At(un,Pt){return class extends un{constructor(...lt){super(...lt),this.defaultColor=Pt,this.color=Pt}get color(){return this._color}set color(lt){const nn=lt||this.defaultColor;nn!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),nn&&this._elementRef.nativeElement.classList.add(`mat-${nn}`),this._color=nn)}}}function zt(un){return class extends un{constructor(...Pt){super(...Pt),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(Pt){this._disableRipple=(0,it.Ig)(Pt)}}}function Jt(un,Pt=0){return class extends un{constructor(...lt){super(...lt),this._tabIndex=Pt,this.defaultTabIndex=Pt}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(lt){this._tabIndex=null!=lt?(0,it.su)(lt):this.defaultTabIndex}}}function Cn(un){return class extends un{constructor(...Pt){super(...Pt),this.stateChanges=new Le.x,this.errorState=!1}updateErrorState(){const Pt=this.errorState,Qt=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);Qt!==Pt&&(this.errorState=Qt,this.stateChanges.next())}}}let fn=(()=>{class un{isErrorState(lt,nn){return!!(lt&&lt.invalid&&(lt.touched||nn&&nn.submitted))}}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275prov=w.Yz7({token:un,factory:un.\u0275fac,providedIn:"root"}),un})(),Tt=(()=>{class un{}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275dir=w.lG2({type:un,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),un})();function Ge(un,Pt,lt="mat"){un.changes.pipe((0,ke.O)(un)).subscribe(({length:nn})=>{Fe(Pt,`${lt}-2-line`,!1),Fe(Pt,`${lt}-3-line`,!1),Fe(Pt,`${lt}-multi-line`,!1),2===nn||3===nn?Fe(Pt,`${lt}-${nn}-line`,!0):nn>3&&Fe(Pt,`${lt}-multi-line`,!0)})}function Fe(un,Pt,lt){un.nativeElement.classList.toggle(Pt,lt)}let ht=(()=>{class un{}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275mod=w.oAB({type:un}),un.\u0275inj=w.cJS({imports:[[Ce],Ce]}),un})();class Xe{constructor(Pt,lt,nn){this._renderer=Pt,this.element=lt,this.config=nn,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const ce={enterDuration:225,exitDuration:150},Se=(0,ut.i$)({passive:!0}),St=["mousedown","touchstart"],tn=["mouseup","mouseleave","touchend","touchcancel"];class li{constructor(Pt,lt,nn,_i){this._target=Pt,this._ngZone=lt,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,_i.isBrowser&&(this._containerElement=(0,it.fI)(nn))}fadeInRipple(Pt,lt,nn={}){const _i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),Qt={...ce,...nn.animation};nn.centered&&(Pt=_i.left+_i.width/2,lt=_i.top+_i.height/2);const xt=nn.radius||function Mn(un,Pt,lt){const nn=Math.max(Math.abs(un-lt.left),Math.abs(un-lt.right)),_i=Math.max(Math.abs(Pt-lt.top),Math.abs(Pt-lt.bottom));return Math.sqrt(nn*nn+_i*_i)}(Pt,lt,_i),pt=Pt-_i.left,Yt=lt-_i.top,bn=Qt.enterDuration,ri=document.createElement("div");ri.classList.add("mat-ripple-element"),ri.style.left=pt-xt+"px",ri.style.top=Yt-xt+"px",ri.style.height=2*xt+"px",ri.style.width=2*xt+"px",null!=nn.color&&(ri.style.backgroundColor=nn.color),ri.style.transitionDuration=`${bn}ms`,this._containerElement.appendChild(ri),function Wi(un){window.getComputedStyle(un).getPropertyValue("opacity")}(ri),ri.style.transform="scale(1)";const Ee=new Xe(this,ri,nn);return Ee.state=0,this._activeRipples.add(Ee),nn.persistent||(this._mostRecentTransientRipple=Ee),this._runTimeoutOutsideZone(()=>{const ee=Ee===this._mostRecentTransientRipple;Ee.state=1,!nn.persistent&&(!ee||!this._isPointerDown)&&Ee.fadeOut()},bn),Ee}fadeOutRipple(Pt){const lt=this._activeRipples.delete(Pt);if(Pt===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!lt)return;const nn=Pt.element,_i={...ce,...Pt.config.animation};nn.style.transitionDuration=`${_i.exitDuration}ms`,nn.style.opacity="0",Pt.state=2,this._runTimeoutOutsideZone(()=>{Pt.state=3,nn.remove()},_i.exitDuration)}fadeOutAll(){this._activeRipples.forEach(Pt=>Pt.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(Pt=>{Pt.config.persistent||Pt.fadeOut()})}setupTriggerEvents(Pt){const lt=(0,it.fI)(Pt);!lt||lt===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=lt,this._registerEvents(St))}handleEvent(Pt){"mousedown"===Pt.type?this._onMousedown(Pt):"touchstart"===Pt.type?this._onTouchStart(Pt):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(tn),this._pointerUpEventsRegistered=!0)}_onMousedown(Pt){const lt=(0,_.X6)(Pt),nn=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!lt&&!nn&&(this._isPointerDown=!0,this.fadeInRipple(Pt.clientX,Pt.clientY,this._target.rippleConfig))}_onTouchStart(Pt){if(!this._target.rippleDisabled&&!(0,_.yG)(Pt)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const lt=Pt.changedTouches;for(let nn=0;nn<lt.length;nn++)this.fadeInRipple(lt[nn].clientX,lt[nn].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(Pt=>{!Pt.config.persistent&&(1===Pt.state||Pt.config.terminateOnPointerUp&&0===Pt.state)&&Pt.fadeOut()}))}_runTimeoutOutsideZone(Pt,lt=0){this._ngZone.runOutsideAngular(()=>setTimeout(Pt,lt))}_registerEvents(Pt){this._ngZone.runOutsideAngular(()=>{Pt.forEach(lt=>{this._triggerElement.addEventListener(lt,this,Se)})})}_removeTriggerEvents(){this._triggerElement&&(St.forEach(Pt=>{this._triggerElement.removeEventListener(Pt,this,Se)}),this._pointerUpEventsRegistered&&tn.forEach(Pt=>{this._triggerElement.removeEventListener(Pt,this,Se)}))}}const ae=new w.OlP("mat-ripple-global-options");let $e=(()=>{class un{constructor(lt,nn,_i,Qt,xt){this._elementRef=lt,this._animationMode=xt,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=Qt||{},this._rippleRenderer=new li(this,nn,lt,_i)}get disabled(){return this._disabled}set disabled(lt){lt&&this.fadeOutAllNonPersistent(),this._disabled=lt,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(lt){this._trigger=lt,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(lt,nn=0,_i){return"number"==typeof lt?this._rippleRenderer.fadeInRipple(lt,nn,{...this.rippleConfig,..._i}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...lt})}}return un.\u0275fac=function(lt){return new(lt||un)(w.Y36(w.SBq),w.Y36(w.R0b),w.Y36(ut.t4),w.Y36(ae,8),w.Y36(w.QbO,8))},un.\u0275dir=w.lG2({type:un,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(lt,nn){2&lt&&w.ekj("mat-ripple-unbounded",nn.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),un})(),Rt=(()=>{class un{}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275mod=w.oAB({type:un}),un.\u0275inj=w.cJS({imports:[[Ce,ut.ud],Ce]}),un})(),on=(()=>{class un{constructor(lt){this._animationMode=lt,this.state="unchecked",this.disabled=!1}}return un.\u0275fac=function(lt){return new(lt||un)(w.Y36(w.QbO,8))},un.\u0275cmp=w.Xpm({type:un,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:8,hostBindings:function(lt,nn){2&lt&&w.ekj("mat-pseudo-checkbox-indeterminate","indeterminate"===nn.state)("mat-pseudo-checkbox-checked","checked"===nn.state)("mat-pseudo-checkbox-disabled",nn.disabled)("_mat-animation-noopable","NoopAnimations"===nn._animationMode)},inputs:{state:"state",disabled:"disabled"},decls:0,vars:0,template:function(lt,nn){},styles:['.mat-pseudo-checkbox{width:16px;height:16px;border:2px solid;border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox.mat-pseudo-checkbox-indeterminate{border-color:transparent}._mat-animation-noopable.mat-pseudo-checkbox{transition:none;animation:none}._mat-animation-noopable.mat-pseudo-checkbox::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{top:5px;left:1px;width:10px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{top:2.4px;left:1px;width:8px;height:3px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}\n'],encapsulation:2,changeDetection:0}),un})(),jt=(()=>{class un{}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275mod=w.oAB({type:un}),un.\u0275inj=w.cJS({imports:[[Ce]]}),un})();const Bt=new w.OlP("MAT_OPTION_PARENT_COMPONENT"),te=new w.OlP("MatOptgroup");let Ht=0;class Rn{constructor(Pt,lt=!1){this.source=Pt,this.isUserInput=lt}}let ni=(()=>{class un{constructor(lt,nn,_i,Qt){this._element=lt,this._changeDetectorRef=nn,this._parent=_i,this.group=Qt,this._selected=!1,this._active=!1,this._disabled=!1,this._mostRecentViewValue="",this.id="mat-option-"+Ht++,this.onSelectionChange=new w.vpe,this._stateChanges=new Le.x}get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(lt){this._disabled=(0,it.Ig)(lt)}get disableRipple(){return this._parent&&this._parent.disableRipple}get active(){return this._active}get viewValue(){return(this._getHostElement().textContent||"").trim()}select(){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}deselect(){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent())}focus(lt,nn){const _i=this._getHostElement();"function"==typeof _i.focus&&_i.focus(nn)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(lt){(lt.keyCode===rt.K5||lt.keyCode===rt.L_)&&!(0,rt.Vb)(lt)&&(this._selectViaInteraction(),lt.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getAriaSelected(){return this.selected||!this.multiple&&null}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const lt=this.viewValue;lt!==this._mostRecentViewValue&&(this._mostRecentViewValue=lt,this._stateChanges.next())}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(lt=!1){this.onSelectionChange.emit(new Rn(this,lt))}}return un.\u0275fac=function(lt){w.$Z()},un.\u0275dir=w.lG2({type:un,inputs:{value:"value",id:"id",disabled:"disabled"},outputs:{onSelectionChange:"onSelectionChange"}}),un})(),Oi=(()=>{class un extends ni{constructor(lt,nn,_i,Qt){super(lt,nn,_i,Qt)}}return un.\u0275fac=function(lt){return new(lt||un)(w.Y36(w.SBq),w.Y36(w.sBO),w.Y36(Bt,8),w.Y36(te,8))},un.\u0275cmp=w.Xpm({type:un,selectors:[["mat-option"]],hostAttrs:["role","option",1,"mat-option","mat-focus-indicator"],hostVars:12,hostBindings:function(lt,nn){1&lt&&w.NdJ("click",function(){return nn._selectViaInteraction()})("keydown",function(Qt){return nn._handleKeydown(Qt)}),2&lt&&(w.Ikx("id",nn.id),w.uIk("tabindex",nn._getTabIndex())("aria-selected",nn._getAriaSelected())("aria-disabled",nn.disabled.toString()),w.ekj("mat-selected",nn.selected)("mat-option-multiple",nn.multiple)("mat-active",nn.active)("mat-option-disabled",nn.disabled))},exportAs:["matOption"],features:[w.qOj],ngContentSelectors:tt,decls:5,vars:4,consts:[["class","mat-option-pseudo-checkbox",3,"state","disabled",4,"ngIf"],[1,"mat-option-text"],["class","cdk-visually-hidden",4,"ngIf"],["mat-ripple","",1,"mat-option-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-option-pseudo-checkbox",3,"state","disabled"],[1,"cdk-visually-hidden"]],template:function(lt,nn){1&lt&&(w.F$t(),w.YNc(0,dt,1,2,"mat-pseudo-checkbox",0),w.TgZ(1,"span",1),w.Hsn(2),w.qZA(),w.YNc(3,wt,2,1,"span",2),w._UZ(4,"div",3)),2&lt&&(w.Q6J("ngIf",nn.multiple),w.xp6(3),w.Q6J("ngIf",nn.group&&nn.group._inert),w.xp6(1),w.Q6J("matRippleTrigger",nn._getHostElement())("matRippleDisabled",nn.disabled||nn.disableRipple))},dependencies:[on,de.O5,$e],styles:[".mat-option{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative;cursor:pointer;outline:none;display:flex;flex-direction:row;max-width:100%;box-sizing:border-box;align-items:center;-webkit-tap-highlight-color:transparent}.mat-option[disabled]{cursor:default}[dir=rtl] .mat-option{text-align:right}.mat-option .mat-icon{margin-right:16px;vertical-align:middle}.mat-option .mat-icon svg{vertical-align:top}[dir=rtl] .mat-option .mat-icon{margin-left:16px;margin-right:0}.mat-option[aria-disabled=true]{-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:default}.mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:32px}[dir=rtl] .mat-optgroup .mat-option:not(.mat-option-multiple){padding-left:16px;padding-right:32px}.cdk-high-contrast-active .mat-option{margin:0 1px}.cdk-high-contrast-active .mat-option.mat-active{border:solid 1px currentColor;margin:0}.cdk-high-contrast-active .mat-option[aria-disabled=true]{opacity:.5}.mat-option-text{display:inline-block;flex-grow:1;overflow:hidden;text-overflow:ellipsis}.mat-option .mat-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-option-pseudo-checkbox{margin-right:8px}[dir=rtl] .mat-option-pseudo-checkbox{margin-left:8px;margin-right:0}\n"],encapsulation:2,changeDetection:0}),un})();function xn(un,Pt,lt){if(lt.length){let nn=Pt.toArray(),_i=lt.toArray(),Qt=0;for(let xt=0;xt<un+1;xt++)nn[xt].group&&nn[xt].group===_i[Qt]&&Qt++;return Qt}return 0}function Ji(un,Pt,lt,nn){return un<lt?un:un+Pt>lt+nn?Math.max(0,un-nn+Pt):lt}let Hi=(()=>{class un{}return un.\u0275fac=function(lt){return new(lt||un)},un.\u0275mod=w.oAB({type:un}),un.\u0275inj=w.cJS({imports:[[Rt,de.ez,Ce,jt]]}),un})()},7084:(ti,Vt,B)=>{"use strict";B.d(Vt,{pp:()=>ht,To:()=>Xe,ib:()=>Nn,yz:()=>Tt,yK:()=>Fe});var w=B(4650),_=B(5017),pe=B(1281),a=B(7579),de=B(727);let ut=0;const it=new w.OlP("CdkAccordion");let Le=(()=>{class ce{constructor(){this._stateChanges=new a.x,this._openCloseAllActions=new a.x,this.id="cdk-accordion-"+ut++,this._multi=!1}get multi(){return this._multi}set multi(Se){this._multi=(0,pe.Ig)(Se)}openAll(){this._multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(Se){this._stateChanges.next(Se)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}}return ce.\u0275fac=function(Se){return new(Se||ce)},ce.\u0275dir=w.lG2({type:ce,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:"multi"},exportAs:["cdkAccordion"],features:[w._Bn([{provide:it,useExisting:ce}]),w.TTD]}),ce})(),ke=0,rt=(()=>{class ce{constructor(Se,St,tn){this.accordion=Se,this._changeDetectorRef=St,this._expansionDispatcher=tn,this._openCloseAllSubscription=de.w0.EMPTY,this.closed=new w.vpe,this.opened=new w.vpe,this.destroyed=new w.vpe,this.expandedChange=new w.vpe,this.id="cdk-accordion-child-"+ke++,this._expanded=!1,this._disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=tn.listen((li,Wi)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===Wi&&this.id!==li&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}get expanded(){return this._expanded}set expanded(Se){Se=(0,pe.Ig)(Se),this._expanded!==Se&&(this._expanded=Se,this.expandedChange.emit(Se),Se?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}get disabled(){return this._disabled}set disabled(Se){this._disabled=(0,pe.Ig)(Se)}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(Se=>{this.disabled||(this.expanded=Se)})}}return ce.\u0275fac=function(Se){return new(Se||ce)(w.Y36(it,12),w.Y36(w.sBO),w.Y36(_.A8))},ce.\u0275dir=w.lG2({type:ce,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:"expanded",disabled:"disabled"},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[w._Bn([{provide:it,useValue:void 0}])]}),ce})(),ft=(()=>{class ce{}return ce.\u0275fac=function(Se){return new(Se||ce)},ce.\u0275mod=w.oAB({type:ce}),ce.\u0275inj=w.cJS({}),ce})();var Et=B(4080),dt=B(6895),wt=B(3238),tt=B(2687),Wt=B(1884),kt=B(8675),Qe=B(9300),Hn=B(5698),Ln=B(9521),Ye=B(515),Ce=B(6451),we=B(7340);const At=["body"];function zt(ce,ot){}const Jt=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],Cn=["mat-expansion-panel-header","*","mat-action-row"];function Ke(ce,ot){if(1&ce&&w._UZ(0,"span",2),2&ce){const Se=w.oxw();w.Q6J("@indicatorRotate",Se._getExpandedState())}}const Ne=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],He=["mat-panel-title","mat-panel-description","*"],_t=new w.OlP("MAT_ACCORDION"),Dn="225ms cubic-bezier(0.4,0.0,0.2,1)",Xt={indicatorRotate:(0,we.X$)("indicatorRotate",[(0,we.SB)("collapsed, void",(0,we.oB)({transform:"rotate(0deg)"})),(0,we.SB)("expanded",(0,we.oB)({transform:"rotate(180deg)"})),(0,we.eR)("expanded <=> collapsed, void => collapsed",(0,we.jt)(Dn))]),bodyExpansion:(0,we.X$)("bodyExpansion",[(0,we.SB)("collapsed, void",(0,we.oB)({height:"0px",visibility:"hidden"})),(0,we.SB)("expanded",(0,we.oB)({height:"*",visibility:"visible"})),(0,we.eR)("expanded <=> collapsed, void => collapsed",(0,we.jt)(Dn))])};let ii=(()=>{class ce{constructor(Se){this._template=Se}}return ce.\u0275fac=function(Se){return new(Se||ce)(w.Y36(w.Rgc))},ce.\u0275dir=w.lG2({type:ce,selectors:[["ng-template","matExpansionPanelContent",""]]}),ce})(),vi=0;const wi=new w.OlP("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let Nn=(()=>{class ce extends rt{constructor(Se,St,tn,li,Wi,Mn,ae){super(Se,St,tn),this._viewContainerRef=li,this._animationMode=Mn,this._hideToggle=!1,this.afterExpand=new w.vpe,this.afterCollapse=new w.vpe,this._inputChanges=new a.x,this._headerId="mat-expansion-panel-header-"+vi++,this._bodyAnimationDone=new a.x,this.accordion=Se,this._document=Wi,this._bodyAnimationDone.pipe((0,Wt.x)(($e,Rt)=>$e.fromState===Rt.fromState&&$e.toState===Rt.toState)).subscribe($e=>{"void"!==$e.fromState&&("expanded"===$e.toState?this.afterExpand.emit():"collapsed"===$e.toState&&this.afterCollapse.emit())}),ae&&(this.hideToggle=ae.hideToggle)}get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(Se){this._hideToggle=(0,pe.Ig)(Se)}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(Se){this._togglePosition=Se}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this.opened.pipe((0,kt.O)(null),(0,Qe.h)(()=>this.expanded&&!this._portal),(0,Hn.q)(1)).subscribe(()=>{this._portal=new Et.UE(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(Se){this._inputChanges.next(Se)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){const Se=this._document.activeElement,St=this._body.nativeElement;return Se===St||St.contains(Se)}return!1}}return ce.\u0275fac=function(Se){return new(Se||ce)(w.Y36(_t,12),w.Y36(w.sBO),w.Y36(_.A8),w.Y36(w.s_b),w.Y36(dt.K0),w.Y36(w.QbO,8),w.Y36(wi,8))},ce.\u0275cmp=w.Xpm({type:ce,selectors:[["mat-expansion-panel"]],contentQueries:function(Se,St,tn){if(1&Se&&w.Suo(tn,ii,5),2&Se){let li;w.iGM(li=w.CRH())&&(St._lazyContent=li.first)}},viewQuery:function(Se,St){if(1&Se&&w.Gf(At,5),2&Se){let tn;w.iGM(tn=w.CRH())&&(St._body=tn.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(Se,St){2&Se&&w.ekj("mat-expanded",St.expanded)("_mat-animation-noopable","NoopAnimations"===St._animationMode)("mat-expansion-panel-spacing",St._hasSpacing())},inputs:{disabled:"disabled",expanded:"expanded",hideToggle:"hideToggle",togglePosition:"togglePosition"},outputs:{opened:"opened",closed:"closed",expandedChange:"expandedChange",afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[w._Bn([{provide:_t,useValue:void 0}]),w.qOj,w.TTD],ngContentSelectors:Cn,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(Se,St){1&Se&&(w.F$t(Jt),w.Hsn(0),w.TgZ(1,"div",0,1),w.NdJ("@bodyExpansion.done",function(li){return St._bodyAnimationDone.next(li)}),w.TgZ(3,"div",2),w.Hsn(4,1),w.YNc(5,zt,0,0,"ng-template",3),w.qZA(),w.Hsn(6,2),w.qZA()),2&Se&&(w.xp6(1),w.Q6J("@bodyExpansion",St._getExpandedState())("id",St.id),w.uIk("aria-labelledby",St._headerId),w.xp6(4),w.Q6J("cdkPortalOutlet",St._portal))},dependencies:[Et.Pl],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;border-radius:4px;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:4px;border-top-left-radius:4px}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:4px;border-bottom-left-radius:4px}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px}.mat-action-row button.mat-button-base,.mat-action-row button.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row button.mat-button-base,[dir=rtl] .mat-action-row button.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[Xt.bodyExpansion]},changeDetection:0}),ce})();class Jn{}const fn=(0,wt.sb)(Jn);let Tt=(()=>{class ce extends fn{constructor(Se,St,tn,li,Wi,Mn,ae){super(),this.panel=Se,this._element=St,this._focusMonitor=tn,this._changeDetectorRef=li,this._animationMode=Mn,this._parentChangeSubscription=de.w0.EMPTY;const $e=Se.accordion?Se.accordion._stateChanges.pipe((0,Qe.h)(Rt=>!(!Rt.hideToggle&&!Rt.togglePosition))):Ye.E;this.tabIndex=parseInt(ae||"")||0,this._parentChangeSubscription=(0,Ce.T)(Se.opened,Se.closed,$e,Se._inputChanges.pipe((0,Qe.h)(Rt=>!!(Rt.hideToggle||Rt.disabled||Rt.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),Se.closed.pipe((0,Qe.h)(()=>Se._containsFocus())).subscribe(()=>tn.focusVia(St,"program")),Wi&&(this.expandedHeight=Wi.expandedHeight,this.collapsedHeight=Wi.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const Se=this._isExpanded();return Se&&this.expandedHeight?this.expandedHeight:!Se&&this.collapsedHeight?this.collapsedHeight:null}_keydown(Se){switch(Se.keyCode){case Ln.L_:case Ln.K5:(0,Ln.Vb)(Se)||(Se.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(Se))}}focus(Se,St){Se?this._focusMonitor.focusVia(this._element,Se,St):this._element.nativeElement.focus(St)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(Se=>{Se&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}}return ce.\u0275fac=function(Se){return new(Se||ce)(w.Y36(Nn,1),w.Y36(w.SBq),w.Y36(tt.tE),w.Y36(w.sBO),w.Y36(wi,8),w.Y36(w.QbO,8),w.$8M("tabindex"))},ce.\u0275cmp=w.Xpm({type:ce,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(Se,St){1&Se&&w.NdJ("click",function(){return St._toggle()})("keydown",function(li){return St._keydown(li)}),2&Se&&(w.uIk("id",St.panel._headerId)("tabindex",St.tabIndex)("aria-controls",St._getPanelId())("aria-expanded",St._isExpanded())("aria-disabled",St.panel.disabled),w.Udp("height",St._getHeaderHeight()),w.ekj("mat-expanded",St._isExpanded())("mat-expansion-toggle-indicator-after","after"===St._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===St._getTogglePosition())("_mat-animation-noopable","NoopAnimations"===St._animationMode))},inputs:{tabIndex:"tabIndex",expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight"},features:[w.qOj],ngContentSelectors:He,decls:5,vars:1,consts:[[1,"mat-content"],["class","mat-expansion-indicator",4,"ngIf"],[1,"mat-expansion-indicator"]],template:function(Se,St){1&Se&&(w.F$t(Ne),w.TgZ(0,"span",0),w.Hsn(1),w.Hsn(2,1),w.Hsn(3,2),w.qZA(),w.YNc(4,Ke,1,1,"span",1)),2&Se&&(w.xp6(4),w.Q6J("ngIf",St._showToggle()))},dependencies:[dt.O5],styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;margin-right:16px}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header-description{flex-grow:2}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle}.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-keyboard-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel .mat-expansion-panel-header.cdk-program-focused:not([aria-disabled=true])::before,.cdk-high-contrast-active .mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:hover:not([aria-disabled=true])::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;border:3px solid;border-radius:4px;content:""}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}\n'],encapsulation:2,data:{animation:[Xt.indicatorRotate]},changeDetection:0}),ce})(),Fe=(()=>{class ce{}return ce.\u0275fac=function(Se){return new(Se||ce)},ce.\u0275dir=w.lG2({type:ce,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]}),ce})(),ht=(()=>{class ce extends Le{constructor(){super(...arguments),this._ownHeaders=new w.n_E,this._hideToggle=!1,this.displayMode="default",this.togglePosition="after"}get hideToggle(){return this._hideToggle}set hideToggle(Se){this._hideToggle=(0,pe.Ig)(Se)}ngAfterContentInit(){this._headers.changes.pipe((0,kt.O)(this._headers)).subscribe(Se=>{this._ownHeaders.reset(Se.filter(St=>St.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new tt.Em(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(Se){this._keyManager.onKeydown(Se)}_handleHeaderFocus(Se){this._keyManager.updateActiveItem(Se)}ngOnDestroy(){super.ngOnDestroy(),this._ownHeaders.destroy()}}return ce.\u0275fac=function(){let ot;return function(St){return(ot||(ot=w.n5z(ce)))(St||ce)}}(),ce.\u0275dir=w.lG2({type:ce,selectors:[["mat-accordion"]],contentQueries:function(Se,St,tn){if(1&Se&&w.Suo(tn,Tt,5),2&Se){let li;w.iGM(li=w.CRH())&&(St._headers=li)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(Se,St){2&Se&&w.ekj("mat-accordion-multi",St.multi)},inputs:{multi:"multi",hideToggle:"hideToggle",displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],features:[w._Bn([{provide:_t,useExisting:ce}]),w.qOj]}),ce})(),Xe=(()=>{class ce{}return ce.\u0275fac=function(Se){return new(Se||ce)},ce.\u0275mod=w.oAB({type:ce}),ce.\u0275inj=w.cJS({imports:[[dt.ez,wt.BQ,ft,Et.eL]]}),ce})()},7676:(ti,Vt,B)=>{"use strict";B.d(Vt,{G_:()=>jt,KE:()=>Bt,Eo:()=>fn,lN:()=>Je,hX:()=>ot});var w=B(1281),_=B(4650),pe=B(9751),a=B(7579),de=B(8372);let ut=(()=>{class ge{create(te){return typeof MutationObserver>"u"?null:new MutationObserver(te)}}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge})(),it=(()=>{class ge{constructor(te){this._mutationObserverFactory=te,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((te,nt)=>this._cleanupObserver(nt))}observe(te){const nt=(0,w.fI)(te);return new pe.y(Ht=>{const ni=this._observeElement(nt).subscribe(Ht);return()=>{ni.unsubscribe(),this._unobserveElement(nt)}})}_observeElement(te){if(this._observedElements.has(te))this._observedElements.get(te).count++;else{const nt=new a.x,Ht=this._mutationObserverFactory.create(Rn=>nt.next(Rn));Ht&&Ht.observe(te,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(te,{observer:Ht,stream:nt,count:1})}return this._observedElements.get(te).stream}_unobserveElement(te){this._observedElements.has(te)&&(this._observedElements.get(te).count--,this._observedElements.get(te).count||this._cleanupObserver(te))}_cleanupObserver(te){if(this._observedElements.has(te)){const{observer:nt,stream:Ht}=this._observedElements.get(te);nt&&nt.disconnect(),Ht.complete(),this._observedElements.delete(te)}}}return ge.\u0275fac=function(te){return new(te||ge)(_.LFG(ut))},ge.\u0275prov=_.Yz7({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge})(),Le=(()=>{class ge{constructor(te,nt,Ht){this._contentObserver=te,this._elementRef=nt,this._ngZone=Ht,this.event=new _.vpe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(te){this._disabled=(0,w.Ig)(te),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(te){this._debounce=(0,w.su)(te),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const te=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?te.pipe((0,de.b)(this.debounce)):te).subscribe(this.event)})}_unsubscribe(){this._currentSubscription?.unsubscribe()}}return ge.\u0275fac=function(te){return new(te||ge)(_.Y36(it),_.Y36(_.SBq),_.Y36(_.R0b))},ge.\u0275dir=_.lG2({type:ge,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),ge})(),ke=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275mod=_.oAB({type:ge}),ge.\u0275inj=_.cJS({providers:[ut]}),ge})();var rt=B(6895),ft=B(3238),Et=B(445),dt=B(6451),wt=B(4968),tt=B(8675),Wt=B(2722),kt=B(5698),Qe=B(7340),Hn=B(3353);const Ln=["connectionContainer"],Ye=["inputContainer"],Ce=["label"];function we(ge,fe){1&ge&&(_.ynx(0),_.TgZ(1,"div",14),_._UZ(2,"div",15)(3,"div",16)(4,"div",17),_.qZA(),_.TgZ(5,"div",18),_._UZ(6,"div",15)(7,"div",16)(8,"div",17),_.qZA(),_.BQk())}function At(ge,fe){1&ge&&(_.TgZ(0,"div",19),_.Hsn(1,1),_.qZA())}function zt(ge,fe){if(1&ge&&(_.ynx(0),_.Hsn(1,2),_.TgZ(2,"span"),_._uU(3),_.qZA(),_.BQk()),2&ge){const te=_.oxw(2);_.xp6(3),_.Oqu(te._control.placeholder)}}function Jt(ge,fe){1&ge&&_.Hsn(0,3,["*ngSwitchCase","true"])}function Cn(ge,fe){1&ge&&(_.TgZ(0,"span",23),_._uU(1," *"),_.qZA())}function Ke(ge,fe){if(1&ge){const te=_.EpF();_.TgZ(0,"label",20,21),_.NdJ("cdkObserveContent",function(){_.CHM(te);const Ht=_.oxw();return _.KtG(Ht.updateOutlineGap())}),_.YNc(2,zt,4,1,"ng-container",12),_.YNc(3,Jt,1,0,"ng-content",12),_.YNc(4,Cn,2,0,"span",22),_.qZA()}if(2&ge){const te=_.oxw();_.ekj("mat-empty",te._control.empty&&!te._shouldAlwaysFloat())("mat-form-field-empty",te._control.empty&&!te._shouldAlwaysFloat())("mat-accent","accent"==te.color)("mat-warn","warn"==te.color),_.Q6J("cdkObserveContentDisabled","outline"!=te.appearance)("id",te._labelId)("ngSwitch",te._hasLabel()),_.uIk("for",te._control.id)("aria-owns",te._control.id),_.xp6(2),_.Q6J("ngSwitchCase",!1),_.xp6(1),_.Q6J("ngSwitchCase",!0),_.xp6(1),_.Q6J("ngIf",!te.hideRequiredMarker&&te._control.required&&!te._control.disabled)}}function Ne(ge,fe){1&ge&&(_.TgZ(0,"div",24),_.Hsn(1,4),_.qZA())}function He(ge,fe){if(1&ge&&(_.TgZ(0,"div",25),_._UZ(1,"span",26),_.qZA()),2&ge){const te=_.oxw();_.xp6(1),_.ekj("mat-accent","accent"==te.color)("mat-warn","warn"==te.color)}}function _t(ge,fe){if(1&ge&&(_.TgZ(0,"div"),_.Hsn(1,5),_.qZA()),2&ge){const te=_.oxw();_.Q6J("@transitionMessages",te._subscriptAnimationState)}}function Dn(ge,fe){if(1&ge&&(_.TgZ(0,"div",30),_._uU(1),_.qZA()),2&ge){const te=_.oxw(2);_.Q6J("id",te._hintLabelId),_.xp6(1),_.Oqu(te.hintLabel)}}function Xt(ge,fe){if(1&ge&&(_.TgZ(0,"div",27),_.YNc(1,Dn,2,2,"div",28),_.Hsn(2,6),_._UZ(3,"div",29),_.Hsn(4,7),_.qZA()),2&ge){const te=_.oxw();_.Q6J("@transitionMessages",te._subscriptAnimationState),_.xp6(1),_.Q6J("ngIf",te.hintLabel)}}const ii=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],vi=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],Nn=new _.OlP("MatError"),Jn={transitionMessages:(0,Qe.X$)("transitionMessages",[(0,Qe.SB)("enter",(0,Qe.oB)({opacity:1,transform:"translateY(0%)"})),(0,Qe.eR)("void => enter",[(0,Qe.oB)({opacity:0,transform:"translateY(-5px)"}),(0,Qe.jt)("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let fn=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275dir=_.lG2({type:ge}),ge})();const Xe=new _.OlP("MatHint");let ot=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275dir=_.lG2({type:ge,selectors:[["mat-label"]]}),ge})(),Se=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275dir=_.lG2({type:ge,selectors:[["mat-placeholder"]]}),ge})();const St=new _.OlP("MatPrefix"),li=new _.OlP("MatSuffix");let Mn=0;const Rt=(0,ft.pj)(class{constructor(ge){this._elementRef=ge}},"primary"),on=new _.OlP("MAT_FORM_FIELD_DEFAULT_OPTIONS"),jt=new _.OlP("MatFormField");let Bt=(()=>{class ge extends Rt{constructor(te,nt,Ht,Rn,ni,Oi,xn){super(te),this._changeDetectorRef=nt,this._dir=Ht,this._defaults=Rn,this._platform=ni,this._ngZone=Oi,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new a.x,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+Mn++,this._labelId="mat-form-field-label-"+Mn++,this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==xn,this.appearance=Rn&&Rn.appearance?Rn.appearance:"legacy",this._hideRequiredMarker=!(!Rn||null==Rn.hideRequiredMarker)&&Rn.hideRequiredMarker}get appearance(){return this._appearance}set appearance(te){const nt=this._appearance;this._appearance=te||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&nt!==te&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(te){this._hideRequiredMarker=(0,w.Ig)(te)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(te){this._hintLabel=te,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(te){te!==this._floatLabel&&(this._floatLabel=te||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(te){this._explicitFormFieldControl=te}getLabelId(){return this._hasFloatingLabel()?this._labelId:null}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const te=this._control;te.controlType&&this._elementRef.nativeElement.classList.add(`mat-form-field-type-${te.controlType}`),te.stateChanges.pipe((0,tt.O)(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),te.ngControl&&te.ngControl.valueChanges&&te.ngControl.valueChanges.pipe((0,Wt.R)(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.pipe((0,Wt.R)(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),(0,dt.T)(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe((0,tt.O)(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe((0,tt.O)(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe((0,Wt.R)(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(te){const nt=this._control?this._control.ngControl:null;return nt&&nt[te]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,(0,wt.R)(this._label.nativeElement,"transitionend").pipe((0,kt.q)(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||"auto"}_syncDescribedByIds(){if(this._control){let te=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&te.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const nt=this._hintChildren?this._hintChildren.find(Rn=>"start"===Rn.align):null,Ht=this._hintChildren?this._hintChildren.find(Rn=>"end"===Rn.align):null;nt?te.push(nt.id):this._hintLabel&&te.push(this._hintLabelId),Ht&&te.push(Ht.id)}else this._errorChildren&&te.push(...this._errorChildren.map(nt=>nt.id));this._control.setDescribedByIds(te)}}_validateControlChild(){}updateOutlineGap(){const te=this._label?this._label.nativeElement:null;if(!("outline"===this.appearance&&te&&te.children.length&&te.textContent.trim()&&this._platform.isBrowser))return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let nt=0,Ht=0;const Rn=this._connectionContainerRef.nativeElement,ni=Rn.querySelectorAll(".mat-form-field-outline-start"),Oi=Rn.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const xn=Rn.getBoundingClientRect();if(0===xn.width&&0===xn.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const Ji=this._getStartEnd(xn),Hi=te.children,un=this._getStartEnd(Hi[0].getBoundingClientRect());let Pt=0;for(let lt=0;lt<Hi.length;lt++)Pt+=Hi[lt].offsetWidth;nt=Math.abs(un-Ji)-5,Ht=Pt>0?.75*Pt+10:0}for(let xn=0;xn<ni.length;xn++)ni[xn].style.width=`${nt}px`;for(let xn=0;xn<Oi.length;xn++)Oi[xn].style.width=`${Ht}px`;this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(te){return this._dir&&"rtl"===this._dir.value?te.right:te.left}_isAttachedToDOM(){const te=this._elementRef.nativeElement;if(te.getRootNode){const nt=te.getRootNode();return nt&&nt!==te}return document.documentElement.contains(te)}}return ge.\u0275fac=function(te){return new(te||ge)(_.Y36(_.SBq),_.Y36(_.sBO),_.Y36(Et.Is,8),_.Y36(on,8),_.Y36(Hn.t4),_.Y36(_.R0b),_.Y36(_.QbO,8))},ge.\u0275cmp=_.Xpm({type:ge,selectors:[["mat-form-field"]],contentQueries:function(te,nt,Ht){if(1&te&&(_.Suo(Ht,fn,5),_.Suo(Ht,fn,7),_.Suo(Ht,ot,5),_.Suo(Ht,ot,7),_.Suo(Ht,Se,5),_.Suo(Ht,Nn,5),_.Suo(Ht,Xe,5),_.Suo(Ht,St,5),_.Suo(Ht,li,5)),2&te){let Rn;_.iGM(Rn=_.CRH())&&(nt._controlNonStatic=Rn.first),_.iGM(Rn=_.CRH())&&(nt._controlStatic=Rn.first),_.iGM(Rn=_.CRH())&&(nt._labelChildNonStatic=Rn.first),_.iGM(Rn=_.CRH())&&(nt._labelChildStatic=Rn.first),_.iGM(Rn=_.CRH())&&(nt._placeholderChild=Rn.first),_.iGM(Rn=_.CRH())&&(nt._errorChildren=Rn),_.iGM(Rn=_.CRH())&&(nt._hintChildren=Rn),_.iGM(Rn=_.CRH())&&(nt._prefixChildren=Rn),_.iGM(Rn=_.CRH())&&(nt._suffixChildren=Rn)}},viewQuery:function(te,nt){if(1&te&&(_.Gf(Ln,7),_.Gf(Ye,5),_.Gf(Ce,5)),2&te){let Ht;_.iGM(Ht=_.CRH())&&(nt._connectionContainerRef=Ht.first),_.iGM(Ht=_.CRH())&&(nt._inputContainerRef=Ht.first),_.iGM(Ht=_.CRH())&&(nt._label=Ht.first)}},hostAttrs:[1,"mat-form-field"],hostVars:40,hostBindings:function(te,nt){2&te&&_.ekj("mat-form-field-appearance-standard","standard"==nt.appearance)("mat-form-field-appearance-fill","fill"==nt.appearance)("mat-form-field-appearance-outline","outline"==nt.appearance)("mat-form-field-appearance-legacy","legacy"==nt.appearance)("mat-form-field-invalid",nt._control.errorState)("mat-form-field-can-float",nt._canLabelFloat())("mat-form-field-should-float",nt._shouldLabelFloat())("mat-form-field-has-label",nt._hasFloatingLabel())("mat-form-field-hide-placeholder",nt._hideControlPlaceholder())("mat-form-field-disabled",nt._control.disabled)("mat-form-field-autofilled",nt._control.autofilled)("mat-focused",nt._control.focused)("ng-untouched",nt._shouldForward("untouched"))("ng-touched",nt._shouldForward("touched"))("ng-pristine",nt._shouldForward("pristine"))("ng-dirty",nt._shouldForward("dirty"))("ng-valid",nt._shouldForward("valid"))("ng-invalid",nt._shouldForward("invalid"))("ng-pending",nt._shouldForward("pending"))("_mat-animation-noopable",!nt._animationsEnabled)},inputs:{color:"color",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel",floatLabel:"floatLabel"},exportAs:["matFormField"],features:[_._Bn([{provide:jt,useExisting:ge}]),_.qOj],ngContentSelectors:vi,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(te,nt){1&te&&(_.F$t(ii),_.TgZ(0,"div",0)(1,"div",1,2),_.NdJ("click",function(Rn){return nt._control.onContainerClick&&nt._control.onContainerClick(Rn)}),_.YNc(3,we,9,0,"ng-container",3),_.YNc(4,At,2,0,"div",4),_.TgZ(5,"div",5,6),_.Hsn(7),_.TgZ(8,"span",7),_.YNc(9,Ke,5,16,"label",8),_.qZA()(),_.YNc(10,Ne,2,0,"div",9),_.qZA(),_.YNc(11,He,2,4,"div",10),_.TgZ(12,"div",11),_.YNc(13,_t,2,1,"div",12),_.YNc(14,Xt,5,2,"div",13),_.qZA()()),2&te&&(_.xp6(3),_.Q6J("ngIf","outline"==nt.appearance),_.xp6(1),_.Q6J("ngIf",nt._prefixChildren.length),_.xp6(5),_.Q6J("ngIf",nt._hasFloatingLabel()),_.xp6(1),_.Q6J("ngIf",nt._suffixChildren.length),_.xp6(1),_.Q6J("ngIf","outline"!=nt.appearance),_.xp6(1),_.Q6J("ngSwitch",nt._getDisplayedMessages()),_.xp6(1),_.Q6J("ngSwitchCase","error"),_.xp6(1),_.Q6J("ngSwitchCase","hint"))},dependencies:[rt.O5,rt.RF,Le,rt.n9],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:none;transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field-hint-end{order:1}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.cdk-high-contrast-active .mat-form-field-appearance-fill.mat-focused .mat-form-field-flex{outline:dashed 3px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit;box-sizing:content-box}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element:not([type=password])::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{opacity:0}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.cdk-high-contrast-active .mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{opacity:0}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px)}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.cdk-high-contrast-active .mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick{border:3px dashed}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[Jn.transitionMessages]},changeDetection:0}),ge})(),Je=(()=>{class ge{}return ge.\u0275fac=function(te){return new(te||ge)},ge.\u0275mod=_.oAB({type:ge}),ge.\u0275inj=_.cJS({imports:[[rt.ez,ft.BQ,ke],ft.BQ]}),ge})()},782:(ti,Vt,B)=>{"use strict";B.d(Vt,{DX:()=>Et,Il:()=>zt,N6:()=>Jt});var w=B(4650),_=B(3238),pe=B(1281),a=B(445);const de=["*"];class ke{constructor(){this.columnIndex=0,this.rowIndex=0}get rowCount(){return this.rowIndex+1}get rowspan(){const Ne=Math.max(...this.tracker);return Ne>1?this.rowCount+Ne-1:this.rowCount}update(Ne,He){this.columnIndex=0,this.rowIndex=0,this.tracker=new Array(Ne),this.tracker.fill(0,0,this.tracker.length),this.positions=He.map(_t=>this._trackTile(_t))}_trackTile(Ne){const He=this._findMatchingGap(Ne.colspan);return this._markTilePosition(He,Ne),this.columnIndex=He+Ne.colspan,new rt(this.rowIndex,He)}_findMatchingGap(Ne){let He=-1,_t=-1;do{this.columnIndex+Ne>this.tracker.length?(this._nextRow(),He=this.tracker.indexOf(0,this.columnIndex),_t=this._findGapEndIndex(He)):(He=this.tracker.indexOf(0,this.columnIndex),-1!=He?(_t=this._findGapEndIndex(He),this.columnIndex=He+1):(this._nextRow(),He=this.tracker.indexOf(0,this.columnIndex),_t=this._findGapEndIndex(He)))}while(_t-He<Ne||0==_t);return Math.max(He,0)}_nextRow(){this.columnIndex=0,this.rowIndex++;for(let Ne=0;Ne<this.tracker.length;Ne++)this.tracker[Ne]=Math.max(0,this.tracker[Ne]-1)}_findGapEndIndex(Ne){for(let He=Ne+1;He<this.tracker.length;He++)if(0!=this.tracker[He])return He;return this.tracker.length}_markTilePosition(Ne,He){for(let _t=0;_t<He.colspan;_t++)this.tracker[Ne+_t]=He.rowspan}}class rt{constructor(Ne,He){this.row=Ne,this.col=He}}const ft=new w.OlP("MAT_GRID_LIST");let Et=(()=>{class Ke{constructor(He,_t){this._element=He,this._gridList=_t,this._rowspan=1,this._colspan=1}get rowspan(){return this._rowspan}set rowspan(He){this._rowspan=Math.round((0,pe.su)(He))}get colspan(){return this._colspan}set colspan(He){this._colspan=Math.round((0,pe.su)(He))}_setStyle(He,_t){this._element.nativeElement.style[He]=_t}}return Ke.\u0275fac=function(He){return new(He||Ke)(w.Y36(w.SBq),w.Y36(ft,8))},Ke.\u0275cmp=w.Xpm({type:Ke,selectors:[["mat-grid-tile"]],hostAttrs:[1,"mat-grid-tile"],hostVars:2,hostBindings:function(He,_t){2&He&&w.uIk("rowspan",_t.rowspan)("colspan",_t.colspan)},inputs:{rowspan:"rowspan",colspan:"colspan"},exportAs:["matGridTile"],ngContentSelectors:de,decls:2,vars:0,consts:[[1,"mat-grid-tile-content"]],template:function(He,_t){1&He&&(w.F$t(),w.TgZ(0,"div",0),w.Hsn(1),w.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),Ke})();const kt=/^-?\d+((\.\d+)?[A-Za-z%$]?)+$/;class Qe{constructor(){this._rows=0,this._rowspan=0}init(Ne,He,_t,Dn){this._gutterSize=we(Ne),this._rows=He.rowCount,this._rowspan=He.rowspan,this._cols=_t,this._direction=Dn}getBaseTileSize(Ne,He){return`(${Ne}% - (${this._gutterSize} * ${He}))`}getTilePosition(Ne,He){return 0===He?"0":Ce(`(${Ne} + ${this._gutterSize}) * ${He}`)}getTileSize(Ne,He){return`(${Ne} * ${He}) + (${He-1} * ${this._gutterSize})`}setStyle(Ne,He,_t){let Dn=100/this._cols,Xt=(this._cols-1)/this._cols;this.setColStyles(Ne,_t,Dn,Xt),this.setRowStyles(Ne,He,Dn,Xt)}setColStyles(Ne,He,_t,Dn){let Xt=this.getBaseTileSize(_t,Dn);Ne._setStyle("rtl"===this._direction?"right":"left",this.getTilePosition(Xt,He)),Ne._setStyle("width",Ce(this.getTileSize(Xt,Ne.colspan)))}getGutterSpan(){return`${this._gutterSize} * (${this._rowspan} - 1)`}getTileSpan(Ne){return`${this._rowspan} * ${this.getTileSize(Ne,1)}`}getComputedHeight(){return null}}class Hn extends Qe{constructor(Ne){super(),this.fixedRowHeight=Ne}init(Ne,He,_t,Dn){super.init(Ne,He,_t,Dn),this.fixedRowHeight=we(this.fixedRowHeight),kt.test(this.fixedRowHeight)}setRowStyles(Ne,He){Ne._setStyle("top",this.getTilePosition(this.fixedRowHeight,He)),Ne._setStyle("height",Ce(this.getTileSize(this.fixedRowHeight,Ne.rowspan)))}getComputedHeight(){return["height",Ce(`${this.getTileSpan(this.fixedRowHeight)} + ${this.getGutterSpan()}`)]}reset(Ne){Ne._setListStyle(["height",null]),Ne._tiles&&Ne._tiles.forEach(He=>{He._setStyle("top",null),He._setStyle("height",null)})}}class Ln extends Qe{constructor(Ne){super(),this._parseRatio(Ne)}setRowStyles(Ne,He,_t,Dn){this.baseTileHeight=this.getBaseTileSize(_t/this.rowHeightRatio,Dn),Ne._setStyle("marginTop",this.getTilePosition(this.baseTileHeight,He)),Ne._setStyle("paddingTop",Ce(this.getTileSize(this.baseTileHeight,Ne.rowspan)))}getComputedHeight(){return["paddingBottom",Ce(`${this.getTileSpan(this.baseTileHeight)} + ${this.getGutterSpan()}`)]}reset(Ne){Ne._setListStyle(["paddingBottom",null]),Ne._tiles.forEach(He=>{He._setStyle("marginTop",null),He._setStyle("paddingTop",null)})}_parseRatio(Ne){const He=Ne.split(":");this.rowHeightRatio=parseFloat(He[0])/parseFloat(He[1])}}class Ye extends Qe{setRowStyles(Ne,He){let Xt=this.getBaseTileSize(100/this._rowspan,(this._rows-1)/this._rows);Ne._setStyle("top",this.getTilePosition(Xt,He)),Ne._setStyle("height",Ce(this.getTileSize(Xt,Ne.rowspan)))}reset(Ne){Ne._tiles&&Ne._tiles.forEach(He=>{He._setStyle("top",null),He._setStyle("height",null)})}}function Ce(Ke){return`calc(${Ke})`}function we(Ke){return Ke.match(/([A-Za-z%]+)$/)?Ke:`${Ke}px`}let zt=(()=>{class Ke{constructor(He,_t){this._element=He,this._dir=_t,this._gutter="1px"}get cols(){return this._cols}set cols(He){this._cols=Math.max(1,Math.round((0,pe.su)(He)))}get gutterSize(){return this._gutter}set gutterSize(He){this._gutter=`${He??""}`}get rowHeight(){return this._rowHeight}set rowHeight(He){const _t=`${He??""}`;_t!==this._rowHeight&&(this._rowHeight=_t,this._setTileStyler(this._rowHeight))}ngOnInit(){this._checkCols(),this._checkRowHeight()}ngAfterContentChecked(){this._layoutTiles()}_checkCols(){}_checkRowHeight(){this._rowHeight||this._setTileStyler("1:1")}_setTileStyler(He){this._tileStyler&&this._tileStyler.reset(this),this._tileStyler="fit"===He?new Ye:He&&He.indexOf(":")>-1?new Ln(He):new Hn(He)}_layoutTiles(){this._tileCoordinator||(this._tileCoordinator=new ke);const He=this._tileCoordinator,_t=this._tiles.filter(Xt=>!Xt._gridList||Xt._gridList===this),Dn=this._dir?this._dir.value:"ltr";this._tileCoordinator.update(this.cols,_t),this._tileStyler.init(this.gutterSize,He,this.cols,Dn),_t.forEach((Xt,ii)=>{const vi=He.positions[ii];this._tileStyler.setStyle(Xt,vi.row,vi.col)}),this._setListStyle(this._tileStyler.getComputedHeight())}_setListStyle(He){He&&(this._element.nativeElement.style[He[0]]=He[1])}}return Ke.\u0275fac=function(He){return new(He||Ke)(w.Y36(w.SBq),w.Y36(a.Is,8))},Ke.\u0275cmp=w.Xpm({type:Ke,selectors:[["mat-grid-list"]],contentQueries:function(He,_t,Dn){if(1&He&&w.Suo(Dn,Et,5),2&He){let Xt;w.iGM(Xt=w.CRH())&&(_t._tiles=Xt)}},hostAttrs:[1,"mat-grid-list"],hostVars:1,hostBindings:function(He,_t){2&He&&w.uIk("cols",_t.cols)},inputs:{cols:"cols",gutterSize:"gutterSize",rowHeight:"rowHeight"},exportAs:["matGridList"],features:[w._Bn([{provide:ft,useExisting:Ke}])],ngContentSelectors:de,decls:2,vars:0,template:function(He,_t){1&He&&(w.F$t(),w.TgZ(0,"div"),w.Hsn(1),w.qZA())},styles:[".mat-grid-list{display:block;position:relative}.mat-grid-tile{display:block;position:absolute;overflow:hidden}.mat-grid-tile .mat-grid-tile-header,.mat-grid-tile .mat-grid-tile-footer{display:flex;align-items:center;height:48px;color:#fff;background:rgba(0,0,0,.38);overflow:hidden;padding:0 16px;position:absolute;left:0;right:0}.mat-grid-tile .mat-grid-tile-header>*,.mat-grid-tile .mat-grid-tile-footer>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-tile-header.mat-2-line,.mat-grid-tile .mat-grid-tile-footer.mat-2-line{height:68px}.mat-grid-tile .mat-grid-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden}.mat-grid-tile .mat-grid-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-grid-tile .mat-grid-list-text:empty{display:none}.mat-grid-tile .mat-grid-tile-header{top:0}.mat-grid-tile .mat-grid-tile-footer{bottom:0}.mat-grid-tile .mat-grid-avatar{padding-right:16px}[dir=rtl] .mat-grid-tile .mat-grid-avatar{padding-right:0;padding-left:16px}.mat-grid-tile .mat-grid-avatar:empty{display:none}.mat-grid-tile-content{top:0;left:0;right:0;bottom:0;position:absolute;display:flex;align-items:center;justify-content:center;height:100%;padding:0;margin:0}\n"],encapsulation:2,changeDetection:0}),Ke})(),Jt=(()=>{class Ke{}return Ke.\u0275fac=function(He){return new(He||Ke)},Ke.\u0275mod=w.oAB({type:Ke}),Ke.\u0275inj=w.cJS({imports:[[_.uc,_.BQ],_.uc,_.BQ]}),Ke})()},7392:(ti,Vt,B)=>{"use strict";B.d(Vt,{Hw:()=>Bi,Ps:()=>Jn});var w=B(4650),_=B(3238),pe=B(1281),a=B(6895),de=B(9646),ut=B(2843),it=B(4128),Le=B(727),ke=B(8505),rt=B(4004),ft=B(262),Et=B(8746),dt=B(3099),wt=B(5698),tt=B(529),Wt=B(1481);const kt=["*"];let Qe;function Ln(fn){return function Hn(){if(void 0===Qe&&(Qe=null,typeof window<"u")){const fn=window;void 0!==fn.trustedTypes&&(Qe=fn.trustedTypes.createPolicy("angular#components",{createHTML:Tt=>Tt}))}return Qe}()?.createHTML(fn)||fn}function Ye(fn){return Error(`Unable to find icon with the name "${fn}"`)}function we(fn){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${fn}".`)}function At(fn){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${fn}".`)}class zt{constructor(Tt,Ge,Fe){this.url=Tt,this.svgText=Ge,this.options=Fe}}let Jt=(()=>{class fn{constructor(Ge,Fe,ht,Xe){this._httpClient=Ge,this._sanitizer=Fe,this._errorHandler=Xe,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass="material-icons",this._document=ht}addSvgIcon(Ge,Fe,ht){return this.addSvgIconInNamespace("",Ge,Fe,ht)}addSvgIconLiteral(Ge,Fe,ht){return this.addSvgIconLiteralInNamespace("",Ge,Fe,ht)}addSvgIconInNamespace(Ge,Fe,ht,Xe){return this._addSvgIconConfig(Ge,Fe,new zt(ht,null,Xe))}addSvgIconResolver(Ge){return this._resolvers.push(Ge),this}addSvgIconLiteralInNamespace(Ge,Fe,ht,Xe){const ce=this._sanitizer.sanitize(w.q3G.HTML,ht);if(!ce)throw At(ht);const ot=Ln(ce);return this._addSvgIconConfig(Ge,Fe,new zt("",ot,Xe))}addSvgIconSet(Ge,Fe){return this.addSvgIconSetInNamespace("",Ge,Fe)}addSvgIconSetLiteral(Ge,Fe){return this.addSvgIconSetLiteralInNamespace("",Ge,Fe)}addSvgIconSetInNamespace(Ge,Fe,ht){return this._addSvgIconSetConfig(Ge,new zt(Fe,null,ht))}addSvgIconSetLiteralInNamespace(Ge,Fe,ht){const Xe=this._sanitizer.sanitize(w.q3G.HTML,Fe);if(!Xe)throw At(Fe);const ce=Ln(Xe);return this._addSvgIconSetConfig(Ge,new zt("",ce,ht))}registerFontClassAlias(Ge,Fe=Ge){return this._fontCssClassesByAlias.set(Ge,Fe),this}classNameForFontAlias(Ge){return this._fontCssClassesByAlias.get(Ge)||Ge}setDefaultFontSetClass(Ge){return this._defaultFontSetClass=Ge,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(Ge){const Fe=this._sanitizer.sanitize(w.q3G.RESOURCE_URL,Ge);if(!Fe)throw we(Ge);const ht=this._cachedIconsByUrl.get(Fe);return ht?(0,de.of)(Ne(ht)):this._loadSvgIconFromConfig(new zt(Ge,null)).pipe((0,ke.b)(Xe=>this._cachedIconsByUrl.set(Fe,Xe)),(0,rt.U)(Xe=>Ne(Xe)))}getNamedSvgIcon(Ge,Fe=""){const ht=He(Fe,Ge);let Xe=this._svgIconConfigs.get(ht);if(Xe)return this._getSvgFromConfig(Xe);if(Xe=this._getIconConfigFromResolvers(Fe,Ge),Xe)return this._svgIconConfigs.set(ht,Xe),this._getSvgFromConfig(Xe);const ce=this._iconSetConfigs.get(Fe);return ce?this._getSvgFromIconSetConfigs(Ge,ce):(0,ut._)(Ye(ht))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(Ge){return Ge.svgText?(0,de.of)(Ne(this._svgElementFromConfig(Ge))):this._loadSvgIconFromConfig(Ge).pipe((0,rt.U)(Fe=>Ne(Fe)))}_getSvgFromIconSetConfigs(Ge,Fe){const ht=this._extractIconWithNameFromAnySet(Ge,Fe);if(ht)return(0,de.of)(ht);const Xe=Fe.filter(ce=>!ce.svgText).map(ce=>this._loadSvgIconSetFromConfig(ce).pipe((0,ft.K)(ot=>{const St=`Loading icon set URL: ${this._sanitizer.sanitize(w.q3G.RESOURCE_URL,ce.url)} failed: ${ot.message}`;return this._errorHandler.handleError(new Error(St)),(0,de.of)(null)})));return(0,it.D)(Xe).pipe((0,rt.U)(()=>{const ce=this._extractIconWithNameFromAnySet(Ge,Fe);if(!ce)throw Ye(Ge);return ce}))}_extractIconWithNameFromAnySet(Ge,Fe){for(let ht=Fe.length-1;ht>=0;ht--){const Xe=Fe[ht];if(Xe.svgText&&Xe.svgText.toString().indexOf(Ge)>-1){const ce=this._svgElementFromConfig(Xe),ot=this._extractSvgIconFromSet(ce,Ge,Xe.options);if(ot)return ot}}return null}_loadSvgIconFromConfig(Ge){return this._fetchIcon(Ge).pipe((0,ke.b)(Fe=>Ge.svgText=Fe),(0,rt.U)(()=>this._svgElementFromConfig(Ge)))}_loadSvgIconSetFromConfig(Ge){return Ge.svgText?(0,de.of)(null):this._fetchIcon(Ge).pipe((0,ke.b)(Fe=>Ge.svgText=Fe))}_extractSvgIconFromSet(Ge,Fe,ht){const Xe=Ge.querySelector(`[id="${Fe}"]`);if(!Xe)return null;const ce=Xe.cloneNode(!0);if(ce.removeAttribute("id"),"svg"===ce.nodeName.toLowerCase())return this._setSvgAttributes(ce,ht);if("symbol"===ce.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(ce),ht);const ot=this._svgElementFromString(Ln("<svg></svg>"));return ot.appendChild(ce),this._setSvgAttributes(ot,ht)}_svgElementFromString(Ge){const Fe=this._document.createElement("DIV");Fe.innerHTML=Ge;const ht=Fe.querySelector("svg");if(!ht)throw Error("<svg> tag not found");return ht}_toSvgElement(Ge){const Fe=this._svgElementFromString(Ln("<svg></svg>")),ht=Ge.attributes;for(let Xe=0;Xe<ht.length;Xe++){const{name:ce,value:ot}=ht[Xe];"id"!==ce&&Fe.setAttribute(ce,ot)}for(let Xe=0;Xe<Ge.childNodes.length;Xe++)Ge.childNodes[Xe].nodeType===this._document.ELEMENT_NODE&&Fe.appendChild(Ge.childNodes[Xe].cloneNode(!0));return Fe}_setSvgAttributes(Ge,Fe){return Ge.setAttribute("fit",""),Ge.setAttribute("height","100%"),Ge.setAttribute("width","100%"),Ge.setAttribute("preserveAspectRatio","xMidYMid meet"),Ge.setAttribute("focusable","false"),Fe&&Fe.viewBox&&Ge.setAttribute("viewBox",Fe.viewBox),Ge}_fetchIcon(Ge){const{url:Fe,options:ht}=Ge,Xe=ht?.withCredentials??!1;if(!this._httpClient)throw function Ce(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==Fe)throw Error(`Cannot fetch icon from URL "${Fe}".`);const ce=this._sanitizer.sanitize(w.q3G.RESOURCE_URL,Fe);if(!ce)throw we(Fe);const ot=this._inProgressUrlFetches.get(ce);if(ot)return ot;const Se=this._httpClient.get(ce,{responseType:"text",withCredentials:Xe}).pipe((0,rt.U)(St=>Ln(St)),(0,Et.x)(()=>this._inProgressUrlFetches.delete(ce)),(0,dt.B)());return this._inProgressUrlFetches.set(ce,Se),Se}_addSvgIconConfig(Ge,Fe,ht){return this._svgIconConfigs.set(He(Ge,Fe),ht),this}_addSvgIconSetConfig(Ge,Fe){const ht=this._iconSetConfigs.get(Ge);return ht?ht.push(Fe):this._iconSetConfigs.set(Ge,[Fe]),this}_svgElementFromConfig(Ge){if(!Ge.svgElement){const Fe=this._svgElementFromString(Ge.svgText);this._setSvgAttributes(Fe,Ge.options),Ge.svgElement=Fe}return Ge.svgElement}_getIconConfigFromResolvers(Ge,Fe){for(let ht=0;ht<this._resolvers.length;ht++){const Xe=this._resolvers[ht](Fe,Ge);if(Xe)return _t(Xe)?new zt(Xe.url,null,Xe.options):new zt(Xe,null)}}}return fn.\u0275fac=function(Ge){return new(Ge||fn)(w.LFG(tt.eN,8),w.LFG(Wt.H7),w.LFG(a.K0,8),w.LFG(w.qLn))},fn.\u0275prov=w.Yz7({token:fn,factory:fn.\u0275fac,providedIn:"root"}),fn})();function Ne(fn){return fn.cloneNode(!0)}function He(fn,Tt){return fn+":"+Tt}function _t(fn){return!(!fn.url||!fn.options)}const Dn=(0,_.pj)(class{constructor(fn){this._elementRef=fn}}),Xt=new w.OlP("mat-icon-location",{providedIn:"root",factory:function ii(){const fn=(0,w.f3M)(a.K0),Tt=fn?fn.location:null;return{getPathname:()=>Tt?Tt.pathname+Tt.search:""}}}),vi=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],wi=vi.map(fn=>`[${fn}]`).join(", "),Nn=/^url\(['"]?#(.*?)['"]?\)$/;let Bi=(()=>{class fn extends Dn{constructor(Ge,Fe,ht,Xe,ce){super(Ge),this._iconRegistry=Fe,this._location=Xe,this._errorHandler=ce,this._inline=!1,this._currentIconFetch=Le.w0.EMPTY,ht||Ge.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(Ge){this._inline=(0,pe.Ig)(Ge)}get svgIcon(){return this._svgIcon}set svgIcon(Ge){Ge!==this._svgIcon&&(Ge?this._updateSvgIcon(Ge):this._svgIcon&&this._clearSvgElement(),this._svgIcon=Ge)}get fontSet(){return this._fontSet}set fontSet(Ge){const Fe=this._cleanupFontValue(Ge);Fe!==this._fontSet&&(this._fontSet=Fe,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(Ge){const Fe=this._cleanupFontValue(Ge);Fe!==this._fontIcon&&(this._fontIcon=Fe,this._updateFontIconClasses())}_splitIconName(Ge){if(!Ge)return["",""];const Fe=Ge.split(":");switch(Fe.length){case 1:return["",Fe[0]];case 2:return Fe;default:throw Error(`Invalid icon name: "${Ge}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const Ge=this._elementsWithExternalReferences;if(Ge&&Ge.size){const Fe=this._location.getPathname();Fe!==this._previousPath&&(this._previousPath=Fe,this._prependPathToReferences(Fe))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(Ge){this._clearSvgElement();const Fe=Ge.querySelectorAll("style");for(let Xe=0;Xe<Fe.length;Xe++)Fe[Xe].textContent+=" ";const ht=this._location.getPathname();this._previousPath=ht,this._cacheChildrenWithExternalReferences(Ge),this._prependPathToReferences(ht),this._elementRef.nativeElement.appendChild(Ge)}_clearSvgElement(){const Ge=this._elementRef.nativeElement;let Fe=Ge.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();Fe--;){const ht=Ge.childNodes[Fe];(1!==ht.nodeType||"svg"===ht.nodeName.toLowerCase())&&ht.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const Ge=this._elementRef.nativeElement,Fe=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();Fe!=this._previousFontSetClass&&(this._previousFontSetClass&&Ge.classList.remove(this._previousFontSetClass),Fe&&Ge.classList.add(Fe),this._previousFontSetClass=Fe),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&Ge.classList.remove(this._previousFontIconClass),this.fontIcon&&Ge.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(Ge){return"string"==typeof Ge?Ge.trim().split(" ")[0]:Ge}_prependPathToReferences(Ge){const Fe=this._elementsWithExternalReferences;Fe&&Fe.forEach((ht,Xe)=>{ht.forEach(ce=>{Xe.setAttribute(ce.name,`url('${Ge}#${ce.value}')`)})})}_cacheChildrenWithExternalReferences(Ge){const Fe=Ge.querySelectorAll(wi),ht=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let Xe=0;Xe<Fe.length;Xe++)vi.forEach(ce=>{const ot=Fe[Xe],Se=ot.getAttribute(ce),St=Se?Se.match(Nn):null;if(St){let tn=ht.get(ot);tn||(tn=[],ht.set(ot,tn)),tn.push({name:ce,value:St[1]})}})}_updateSvgIcon(Ge){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),Ge){const[Fe,ht]=this._splitIconName(Ge);Fe&&(this._svgNamespace=Fe),ht&&(this._svgName=ht),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(ht,Fe).pipe((0,wt.q)(1)).subscribe(Xe=>this._setSvgElement(Xe),Xe=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${Fe}:${ht}! ${Xe.message}`))})}}}return fn.\u0275fac=function(Ge){return new(Ge||fn)(w.Y36(w.SBq),w.Y36(Jt),w.$8M("aria-hidden"),w.Y36(Xt),w.Y36(w.qLn))},fn.\u0275cmp=w.Xpm({type:fn,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(Ge,Fe){2&Ge&&(w.uIk("data-mat-icon-type",Fe._usingFontIcon()?"font":"svg")("data-mat-icon-name",Fe._svgName||Fe.fontIcon)("data-mat-icon-namespace",Fe._svgNamespace||Fe.fontSet),w.ekj("mat-icon-inline",Fe.inline)("mat-icon-no-color","primary"!==Fe.color&&"accent"!==Fe.color&&"warn"!==Fe.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[w.qOj],ngContentSelectors:kt,decls:1,vars:0,template:function(Ge,Fe){1&Ge&&(w.F$t(),w.Hsn(0))},styles:[".mat-icon{-webkit-user-select:none;-moz-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),fn})(),Jn=(()=>{class fn{}return fn.\u0275fac=function(Ge){return new(Ge||fn)},fn.\u0275mod=w.oAB({type:fn}),fn.\u0275inj=w.cJS({imports:[[_.BQ],_.BQ]}),fn})()},4144:(ti,Vt,B)=>{"use strict";B.d(Vt,{Nt:()=>Hn,c:()=>Ln});var w=B(1281),_=B(3353),pe=B(4650),a=B(515),de=B(7579);const ut=(0,_.i$)({passive:!0});let it=(()=>{class Ye{constructor(we,At){this._platform=we,this._ngZone=At,this._monitoredElements=new Map}monitor(we){if(!this._platform.isBrowser)return a.E;const At=(0,w.fI)(we),zt=this._monitoredElements.get(At);if(zt)return zt.subject;const Jt=new de.x,Cn="cdk-text-field-autofilled",Ke=Ne=>{"cdk-text-field-autofill-start"!==Ne.animationName||At.classList.contains(Cn)?"cdk-text-field-autofill-end"===Ne.animationName&&At.classList.contains(Cn)&&(At.classList.remove(Cn),this._ngZone.run(()=>Jt.next({target:Ne.target,isAutofilled:!1}))):(At.classList.add(Cn),this._ngZone.run(()=>Jt.next({target:Ne.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{At.addEventListener("animationstart",Ke,ut),At.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(At,{subject:Jt,unlisten:()=>{At.removeEventListener("animationstart",Ke,ut)}}),Jt}stopMonitoring(we){const At=(0,w.fI)(we),zt=this._monitoredElements.get(At);zt&&(zt.unlisten(),zt.subject.complete(),At.classList.remove("cdk-text-field-autofill-monitored"),At.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(At))}ngOnDestroy(){this._monitoredElements.forEach((we,At)=>this.stopMonitoring(At))}}return Ye.\u0275fac=function(we){return new(we||Ye)(pe.LFG(_.t4),pe.LFG(pe.R0b))},Ye.\u0275prov=pe.Yz7({token:Ye,factory:Ye.\u0275fac,providedIn:"root"}),Ye})(),rt=(()=>{class Ye{}return Ye.\u0275fac=function(we){return new(we||Ye)},Ye.\u0275mod=pe.oAB({type:Ye}),Ye.\u0275inj=pe.cJS({imports:[[_.ud]]}),Ye})();var ft=B(4006),Et=B(3238),dt=B(7676);const tt=new pe.OlP("MAT_INPUT_VALUE_ACCESSOR"),Wt=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let kt=0;const Qe=(0,Et.FD)(class{constructor(Ye,Ce,we,At){this._defaultErrorStateMatcher=Ye,this._parentForm=Ce,this._parentFormGroup=we,this.ngControl=At}});let Hn=(()=>{class Ye extends Qe{constructor(we,At,zt,Jt,Cn,Ke,Ne,He,_t,Dn){super(Ke,Jt,Cn,zt),this._elementRef=we,this._platform=At,this._autofillMonitor=He,this._formField=Dn,this._uid="mat-input-"+kt++,this.focused=!1,this.stateChanges=new de.x,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(vi=>(0,_.qK)().has(vi));const Xt=this._elementRef.nativeElement,ii=Xt.nodeName.toLowerCase();this._inputValueAccessor=Ne||Xt,this._previousNativeValue=this.value,this.id=this.id,At.IOS&&_t.runOutsideAngular(()=>{we.nativeElement.addEventListener("keyup",vi=>{const wi=vi.target;!wi.value&&0===wi.selectionStart&&0===wi.selectionEnd&&(wi.setSelectionRange(1,1),wi.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===ii,this._isTextarea="textarea"===ii,this._isInFormField=!!Dn,this._isNativeSelect&&(this.controlType=Xt.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(we){this._disabled=(0,w.Ig)(we),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(we){this._id=we||this._uid}get required(){return this._required??this.ngControl?.control?.hasValidator(ft.kI.required)??!1}set required(we){this._required=(0,w.Ig)(we)}get type(){return this._type}set type(we){this._type=we||"text",this._validateType(),!this._isTextarea&&(0,_.qK)().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(we){we!==this.value&&(this._inputValueAccessor.value=we,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(we){this._readonly=(0,w.Ig)(we)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(we=>{this.autofilled=we.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(we){this._elementRef.nativeElement.focus(we)}_focusChanged(we){we!==this.focused&&(this.focused=we,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const we=this._formField?._hideControlPlaceholder?.()?null:this.placeholder;if(we!==this._previousPlaceholder){const At=this._elementRef.nativeElement;this._previousPlaceholder=we,we?At.setAttribute("placeholder",we):At.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const we=this._elementRef.nativeElement.value;this._previousNativeValue!==we&&(this._previousNativeValue=we,this.stateChanges.next())}_validateType(){Wt.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let we=this._elementRef.nativeElement.validity;return we&&we.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const we=this._elementRef.nativeElement,At=we.options[0];return this.focused||we.multiple||!this.empty||!!(we.selectedIndex>-1&&At&&At.label)}return this.focused||!this.empty}setDescribedByIds(we){we.length?this._elementRef.nativeElement.setAttribute("aria-describedby",we.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const we=this._elementRef.nativeElement;return this._isNativeSelect&&(we.multiple||we.size>1)}}return Ye.\u0275fac=function(we){return new(we||Ye)(pe.Y36(pe.SBq),pe.Y36(_.t4),pe.Y36(ft.a5,10),pe.Y36(ft.F,8),pe.Y36(ft.sg,8),pe.Y36(Et.rD),pe.Y36(tt,10),pe.Y36(it),pe.Y36(pe.R0b),pe.Y36(dt.G_,8))},Ye.\u0275dir=pe.lG2({type:Ye,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:11,hostBindings:function(we,At){1&we&&pe.NdJ("focus",function(){return At._focusChanged(!0)})("blur",function(){return At._focusChanged(!1)})("input",function(){return At._onInput()}),2&we&&(pe.Ikx("disabled",At.disabled)("required",At.required),pe.uIk("id",At.id)("data-placeholder",At.placeholder)("readonly",At.readonly&&!At._isNativeSelect||null)("aria-invalid",At.empty&&At.required?null:At.errorState)("aria-required",At.required),pe.ekj("mat-input-server",At._isServer)("mat-native-select-inline",At._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:["aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly"},exportAs:["matInput"],features:[pe._Bn([{provide:dt.Eo,useExisting:Ye}]),pe.qOj,pe.TTD]}),Ye})(),Ln=(()=>{class Ye{}return Ye.\u0275fac=function(we){return new(we||Ye)},Ye.\u0275mod=pe.oAB({type:Ye}),Ye.\u0275inj=pe.cJS({providers:[Et.rD],imports:[[rt,dt.lN,Et.BQ],rt,dt.lN]}),Ye})()},4633:(ti,Vt,B)=>{"use strict";B.d(Vt,{Tg:()=>_t,ie:()=>Bi});var w=B(6895),_=B(4650),pe=B(3238),a=B(1281),de=B(7579),ut=B(2722);B(8675),B(2687),B(5017),B(9521),B(4006);let dt=(()=>{class Jn{}return Jn.\u0275fac=function(Tt){return new(Tt||Jn)},Jn.\u0275mod=_.oAB({type:Jn}),Jn.\u0275inj=_.cJS({imports:[[pe.BQ],pe.BQ]}),Jn})();const Wt=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],kt=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],we=(0,pe.Kr)(class{}),At=new _.OlP("MatList"),zt=new _.OlP("MatNavList");let Ke=(()=>{class Jn{}return Jn.\u0275fac=function(Tt){return new(Tt||Jn)},Jn.\u0275dir=_.lG2({type:Jn,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),Jn})(),Ne=(()=>{class Jn{}return Jn.\u0275fac=function(Tt){return new(Tt||Jn)},Jn.\u0275dir=_.lG2({type:Jn,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),Jn})(),_t=(()=>{class Jn extends we{constructor(Tt,Ge,Fe,ht){super(),this._element=Tt,this._isInteractiveList=!1,this._destroyed=new de.x,this._disabled=!1,this._isInteractiveList=!!(Fe||ht&&"action-list"===ht._getListType()),this._list=Fe||ht;const Xe=this._getHostElement();"button"===Xe.nodeName.toLowerCase()&&!Xe.hasAttribute("type")&&Xe.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe((0,ut.R)(this._destroyed)).subscribe(()=>{Ge.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(Tt){this._disabled=(0,a.Ig)(Tt)}ngAfterContentInit(){(0,pe.E0)(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return Jn.\u0275fac=function(Tt){return new(Tt||Jn)(_.Y36(_.SBq),_.Y36(_.sBO),_.Y36(zt,8),_.Y36(At,8))},Jn.\u0275cmp=_.Xpm({type:Jn,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(Tt,Ge,Fe){if(1&Tt&&(_.Suo(Fe,Ke,5),_.Suo(Fe,Ne,5),_.Suo(Fe,pe.X2,5)),2&Tt){let ht;_.iGM(ht=_.CRH())&&(Ge._avatar=ht.first),_.iGM(ht=_.CRH())&&(Ge._icon=ht.first),_.iGM(ht=_.CRH())&&(Ge._lines=ht)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(Tt,Ge){2&Tt&&_.ekj("mat-list-item-disabled",Ge.disabled)("mat-list-item-avatar",Ge._avatar||Ge._icon)("mat-list-item-with-avatar",Ge._avatar||Ge._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[_.qOj],ngContentSelectors:kt,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(Tt,Ge){1&Tt&&(_.F$t(Wt),_.TgZ(0,"div",0),_._UZ(1,"div",1),_.Hsn(2),_.TgZ(3,"div",2),_.Hsn(4,1),_.qZA(),_.Hsn(5,2),_.qZA()),2&Tt&&(_.xp6(1),_.Q6J("matRippleTrigger",Ge._getHostElement())("matRippleDisabled",Ge._isRippleDisabled()))},dependencies:[pe.wG],encapsulation:2,changeDetection:0}),Jn})(),Bi=(()=>{class Jn{}return Jn.\u0275fac=function(Tt){return new(Tt||Jn)},Jn.\u0275mod=_.oAB({type:Jn}),Jn.\u0275inj=_.cJS({imports:[[pe.uc,pe.si,pe.BQ,pe.us,w.ez],pe.uc,pe.BQ,pe.us,dt]}),Jn})()},7717:(ti,Vt,B)=>{"use strict";B.d(Vt,{$g:()=>Qe,Cq:()=>Hn});var w=B(4650),_=B(6895),pe=B(3238),a=B(1281),de=B(3353);function ut(Ln,Ye){if(1&Ln&&(w.O4$(),w._UZ(0,"circle",3)),2&Ln){const Ce=w.oxw();w.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+Ce._spinnerAnimationLabel)("stroke-dashoffset",Ce._getStrokeDashOffset(),"px")("stroke-dasharray",Ce._getStrokeCircumference(),"px")("stroke-width",Ce._getCircleStrokeWidth(),"%"),w.uIk("r",Ce._getCircleRadius())}}function it(Ln,Ye){if(1&Ln&&(w.O4$(),w._UZ(0,"circle",3)),2&Ln){const Ce=w.oxw();w.Udp("stroke-dashoffset",Ce._getStrokeDashOffset(),"px")("stroke-dasharray",Ce._getStrokeCircumference(),"px")("stroke-width",Ce._getCircleStrokeWidth(),"%"),w.uIk("r",Ce._getCircleRadius())}}function Le(Ln,Ye){if(1&Ln&&(w.O4$(),w._UZ(0,"circle",3)),2&Ln){const Ce=w.oxw();w.Udp("animation-name","mat-progress-spinner-stroke-rotate-"+Ce._spinnerAnimationLabel)("stroke-dashoffset",Ce._getStrokeDashOffset(),"px")("stroke-dasharray",Ce._getStrokeCircumference(),"px")("stroke-width",Ce._getCircleStrokeWidth(),"%"),w.uIk("r",Ce._getCircleRadius())}}function ke(Ln,Ye){if(1&Ln&&(w.O4$(),w._UZ(0,"circle",3)),2&Ln){const Ce=w.oxw();w.Udp("stroke-dashoffset",Ce._getStrokeDashOffset(),"px")("stroke-dasharray",Ce._getStrokeCircumference(),"px")("stroke-width",Ce._getCircleStrokeWidth(),"%"),w.uIk("r",Ce._getCircleRadius())}}const dt=(0,pe.pj)(class{constructor(Ln){this._elementRef=Ln}},"primary"),wt=new w.OlP("mat-progress-spinner-default-options",{providedIn:"root",factory:function tt(){return{diameter:100}}});class kt extends dt{constructor(Ye,Ce,we,At,zt){super(Ye),this._document=we,this._diameter=100,this._value=0,this.mode="determinate";const Jt=kt._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),Jt.has(we.head)||Jt.set(we.head,new Set([100])),this._noopAnimations="NoopAnimations"===At&&!!zt&&!zt._forceAnimations,zt&&(zt.diameter&&(this.diameter=zt.diameter),zt.strokeWidth&&(this.strokeWidth=zt.strokeWidth))}get diameter(){return this._diameter}set diameter(Ye){this._diameter=(0,a.su)(Ye),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(Ye){this._strokeWidth=(0,a.su)(Ye)}get value(){return"determinate"===this.mode?this._value:0}set value(Ye){this._value=Math.max(0,Math.min(100,(0,a.su)(Ye)))}ngOnInit(){const Ye=this._elementRef.nativeElement;this._styleRoot=(0,de.kV)(Ye)||this._document.head,this._attachStyleNode(),Ye.classList.add("mat-progress-spinner-indeterminate-animation")}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const Ye=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${Ye} ${Ye}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_attachStyleNode(){const Ye=this._styleRoot,Ce=this._diameter,we=kt._diameters;let At=we.get(Ye);if(!At||!At.has(Ce)){const zt=this._document.createElement("style");zt.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),zt.textContent=this._getAnimationText(),Ye.appendChild(zt),At||(At=new Set,we.set(Ye,At)),At.add(Ce)}}_getAnimationText(){const Ye=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*Ye).replace(/END_VALUE/g,""+.2*Ye).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}kt._diameters=new WeakMap,kt.\u0275fac=function(Ye){return new(Ye||kt)(w.Y36(w.SBq),w.Y36(de.t4),w.Y36(_.K0,8),w.Y36(w.QbO,8),w.Y36(wt))},kt.\u0275cmp=w.Xpm({type:kt,selectors:[["mat-progress-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner"],hostVars:10,hostBindings:function(Ye,Ce){2&Ye&&(w.uIk("aria-valuemin","determinate"===Ce.mode?0:null)("aria-valuemax","determinate"===Ce.mode?100:null)("aria-valuenow","determinate"===Ce.mode?Ce.value:null)("mode",Ce.mode),w.Udp("width",Ce.diameter,"px")("height",Ce.diameter,"px"),w.ekj("_mat-animation-noopable",Ce._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[w.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(Ye,Ce){1&Ye&&(w.O4$(),w.TgZ(0,"svg",0),w.YNc(1,ut,1,9,"circle",1),w.YNc(2,it,1,7,"circle",2),w.qZA()),2&Ye&&(w.Udp("width",Ce.diameter,"px")("height",Ce.diameter,"px"),w.Q6J("ngSwitch","indeterminate"===Ce.mode),w.uIk("viewBox",Ce._getViewBox()),w.xp6(1),w.Q6J("ngSwitchCase",!0),w.xp6(1),w.Q6J("ngSwitchCase",!1))},dependencies:[_.RF,_.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let Qe=(()=>{class Ln extends kt{constructor(Ce,we,At,zt,Jt){super(Ce,we,At,zt,Jt),this.mode="indeterminate"}}return Ln.\u0275fac=function(Ce){return new(Ce||Ln)(w.Y36(w.SBq),w.Y36(de.t4),w.Y36(_.K0,8),w.Y36(w.QbO,8),w.Y36(wt))},Ln.\u0275cmp=w.Xpm({type:Ln,selectors:[["mat-spinner"]],hostAttrs:["role","progressbar","mode","indeterminate",1,"mat-spinner","mat-progress-spinner"],hostVars:6,hostBindings:function(Ce,we){2&Ce&&(w.Udp("width",we.diameter,"px")("height",we.diameter,"px"),w.ekj("_mat-animation-noopable",we._noopAnimations))},inputs:{color:"color"},features:[w.qOj],decls:3,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(Ce,we){1&Ce&&(w.O4$(),w.TgZ(0,"svg",0),w.YNc(1,Le,1,9,"circle",1),w.YNc(2,ke,1,7,"circle",2),w.qZA()),2&Ce&&(w.Udp("width",we.diameter,"px")("height",we.diameter,"px"),w.Q6J("ngSwitch","indeterminate"===we.mode),w.uIk("viewBox",we._getViewBox()),w.xp6(1),w.Q6J("ngSwitchCase",!0),w.xp6(1),w.Q6J("ngSwitchCase",!1))},dependencies:[_.RF,_.n9],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transform-origin:center;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0}),Ln})(),Hn=(()=>{class Ln{}return Ln.\u0275fac=function(Ce){return new(Ce||Ln)},Ln.\u0275mod=w.oAB({type:Ln}),Ln.\u0275inj=w.cJS({imports:[[pe.BQ,_.ez],pe.BQ]}),Ln})()},3267:(ti,Vt,B)=>{"use strict";B.d(Vt,{LW:()=>Nn,SJ:()=>Fe,jA:()=>Bi,kh:()=>Jn});var w=B(3353),_=B(8605),pe=B(6895),a=B(4650),de=B(3238),ut=B(2687),it=B(445),Le=B(1281),ke=B(9521),rt=B(7579),ft=B(4968),Et=B(6451),dt=B(9300),wt=B(4004),tt=B(9718),Wt=B(2722),kt=B(1884),Qe=B(5698),Hn=B(8675),Ln=B(8372),Ye=B(7340);const Ce=["*"];function we(ht,Xe){if(1&ht){const ce=a.EpF();a.TgZ(0,"div",2),a.NdJ("click",function(){a.CHM(ce);const Se=a.oxw();return a.KtG(Se._onBackdropClicked())}),a.qZA()}if(2&ht){const ce=a.oxw();a.ekj("mat-drawer-shown",ce._isShowingBackdrop())}}function At(ht,Xe){1&ht&&(a.TgZ(0,"mat-drawer-content"),a.Hsn(1,2),a.qZA())}const zt=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],Jt=["mat-drawer","mat-drawer-content","*"],Dn={transformDrawer:(0,Ye.X$)("transform",[(0,Ye.SB)("open, open-instant",(0,Ye.oB)({transform:"none",visibility:"visible"})),(0,Ye.SB)("void",(0,Ye.oB)({"box-shadow":"none",visibility:"hidden"})),(0,Ye.eR)("void => open-instant",(0,Ye.jt)("0ms")),(0,Ye.eR)("void <=> open, open-instant => void",(0,Ye.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},ii=new a.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function wi(){return!1}}),vi=new a.OlP("MAT_DRAWER_CONTAINER");let Nn=(()=>{class ht extends _.PQ{constructor(ce,ot,Se,St,tn){super(Se,St,tn),this._changeDetectorRef=ce,this._container=ot}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return ht.\u0275fac=function(ce){return new(ce||ht)(a.Y36(a.sBO),a.Y36((0,a.Gpc)(()=>Jn)),a.Y36(a.SBq),a.Y36(_.mF),a.Y36(a.R0b))},ht.\u0275cmp=a.Xpm({type:ht,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(ce,ot){2&ce&&a.Udp("margin-left",ot._container._contentMargins.left,"px")("margin-right",ot._container._contentMargins.right,"px")},features:[a.qOj],ngContentSelectors:Ce,decls:1,vars:0,template:function(ce,ot){1&ce&&(a.F$t(),a.Hsn(0))},encapsulation:2,changeDetection:0}),ht})(),Bi=(()=>{class ht{constructor(ce,ot,Se,St,tn,li,Wi,Mn){this._elementRef=ce,this._focusTrapFactory=ot,this._focusMonitor=Se,this._platform=St,this._ngZone=tn,this._interactivityChecker=li,this._doc=Wi,this._container=Mn,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new rt.x,this._animationEnd=new rt.x,this._animationState="void",this.openedChange=new a.vpe(!0),this._openedStream=this.openedChange.pipe((0,dt.h)(ae=>ae),(0,wt.U)(()=>{})),this.openedStart=this._animationStarted.pipe((0,dt.h)(ae=>ae.fromState!==ae.toState&&0===ae.toState.indexOf("open")),(0,tt.h)(void 0)),this._closedStream=this.openedChange.pipe((0,dt.h)(ae=>!ae),(0,wt.U)(()=>{})),this.closedStart=this._animationStarted.pipe((0,dt.h)(ae=>ae.fromState!==ae.toState&&"void"===ae.toState),(0,tt.h)(void 0)),this._destroyed=new rt.x,this.onPositionChanged=new a.vpe,this._modeChanged=new rt.x,this.openedChange.subscribe(ae=>{ae?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{(0,ft.R)(this._elementRef.nativeElement,"keydown").pipe((0,dt.h)(ae=>ae.keyCode===ke.hY&&!this.disableClose&&!(0,ke.Vb)(ae)),(0,Wt.R)(this._destroyed)).subscribe(ae=>this._ngZone.run(()=>{this.close(),ae.stopPropagation(),ae.preventDefault()}))}),this._animationEnd.pipe((0,kt.x)((ae,$e)=>ae.fromState===$e.fromState&&ae.toState===$e.toState)).subscribe(ae=>{const{fromState:$e,toState:Rt}=ae;(0===Rt.indexOf("open")&&"void"===$e||"void"===Rt&&0===$e.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(ce){(ce="end"===ce?"end":"start")!=this._position&&(this._position=ce,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(ce){this._mode=ce,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(ce){this._disableClose=(0,Le.Ig)(ce)}get autoFocus(){return this._autoFocus??("side"===this.mode?"dialog":"first-tabbable")}set autoFocus(ce){("true"===ce||"false"===ce)&&(ce=(0,Le.Ig)(ce)),this._autoFocus=ce}get opened(){return this._opened}set opened(ce){this.toggle((0,Le.Ig)(ce))}_forceFocus(ce,ot){this._interactivityChecker.isFocusable(ce)||(ce.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{ce.addEventListener("blur",()=>ce.removeAttribute("tabindex")),ce.addEventListener("mousedown",()=>ce.removeAttribute("tabindex"))})),ce.focus(ot)}_focusByCssSelector(ce,ot){let Se=this._elementRef.nativeElement.querySelector(ce);Se&&this._forceFocus(Se,ot)}_takeFocus(){if(!this._focusTrap)return;const ce=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(ot=>{!ot&&"function"==typeof this._elementRef.nativeElement.focus&&ce.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(ce){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,ce):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const ce=this._doc?.activeElement;return!!ce&&this._elementRef.nativeElement.contains(ce)}ngAfterContentInit(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(ce){return this.toggle(!0,ce)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(ce=!this.opened,ot){ce&&ot&&(this._openedVia=ot);const Se=this._setOpen(ce,!ce&&this._isFocusWithinDrawer(),this._openedVia||"program");return ce||(this._openedVia=null),Se}_setOpen(ce,ot,Se){return this._opened=ce,ce?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",ot&&this._restoreFocus(Se)),this._updateFocusTrapState(),new Promise(St=>{this.openedChange.pipe((0,Qe.q)(1)).subscribe(tn=>St(tn?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_animationStartListener(ce){this._animationStarted.next(ce)}_animationDoneListener(ce){this._animationEnd.next(ce)}}return ht.\u0275fac=function(ce){return new(ce||ht)(a.Y36(a.SBq),a.Y36(ut.qV),a.Y36(ut.tE),a.Y36(w.t4),a.Y36(a.R0b),a.Y36(ut.ic),a.Y36(pe.K0,8),a.Y36(vi,8))},ht.\u0275cmp=a.Xpm({type:ht,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(ce,ot){1&ce&&a.WFA("@transform.start",function(St){return ot._animationStartListener(St)})("@transform.done",function(St){return ot._animationDoneListener(St)}),2&ce&&(a.uIk("align",null),a.d8E("@transform",ot._animationState),a.ekj("mat-drawer-end","end"===ot.position)("mat-drawer-over","over"===ot.mode)("mat-drawer-push","push"===ot.mode)("mat-drawer-side","side"===ot.mode)("mat-drawer-opened",ot.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Ce,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(ce,ot){1&ce&&(a.F$t(),a.TgZ(0,"div",0),a.Hsn(1),a.qZA())},dependencies:[_.PQ],encapsulation:2,data:{animation:[Dn.transformDrawer]},changeDetection:0}),ht})(),Jn=(()=>{class ht{constructor(ce,ot,Se,St,tn,li=!1,Wi){this._dir=ce,this._element=ot,this._ngZone=Se,this._changeDetectorRef=St,this._animationMode=Wi,this._drawers=new a.n_E,this.backdropClick=new a.vpe,this._destroyed=new rt.x,this._doCheckSubject=new rt.x,this._contentMargins={left:null,right:null},this._contentMarginChanges=new rt.x,ce&&ce.change.pipe((0,Wt.R)(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),tn.change().pipe((0,Wt.R)(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=li}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(ce){this._autosize=(0,Le.Ig)(ce)}get hasBackdrop(){return this._backdropOverride??(!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode)}set hasBackdrop(ce){this._backdropOverride=null==ce?null:(0,Le.Ig)(ce)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe((0,Hn.O)(this._allDrawers),(0,Wt.R)(this._destroyed)).subscribe(ce=>{this._drawers.reset(ce.filter(ot=>!ot._container||ot._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,Hn.O)(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(ce=>{this._watchDrawerToggle(ce),this._watchDrawerPosition(ce),this._watchDrawerMode(ce)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe((0,Ln.b)(10),(0,Wt.R)(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(ce=>ce.open())}close(){this._drawers.forEach(ce=>ce.close())}updateContentMargins(){let ce=0,ot=0;if(this._left&&this._left.opened)if("side"==this._left.mode)ce+=this._left._getWidth();else if("push"==this._left.mode){const Se=this._left._getWidth();ce+=Se,ot-=Se}if(this._right&&this._right.opened)if("side"==this._right.mode)ot+=this._right._getWidth();else if("push"==this._right.mode){const Se=this._right._getWidth();ot+=Se,ce-=Se}ce=ce||null,ot=ot||null,(ce!==this._contentMargins.left||ot!==this._contentMargins.right)&&(this._contentMargins={left:ce,right:ot},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(ce){ce._animationStarted.pipe((0,dt.h)(ot=>ot.fromState!==ot.toState),(0,Wt.R)(this._drawers.changes)).subscribe(ot=>{"open-instant"!==ot.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==ce.mode&&ce.openedChange.pipe((0,Wt.R)(this._drawers.changes)).subscribe(()=>this._setContainerClass(ce.opened))}_watchDrawerPosition(ce){!ce||ce.onPositionChanged.pipe((0,Wt.R)(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe((0,Qe.q)(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(ce){ce&&ce._modeChanged.pipe((0,Wt.R)((0,Et.T)(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(ce){const ot=this._element.nativeElement.classList,Se="mat-drawer-container-has-open";ce?ot.add(Se):ot.remove(Se)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(ce=>{"end"==ce.position?this._end=ce:this._start=ce}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(ce=>ce&&!ce.disableClose&&this._canHaveBackdrop(ce)).forEach(ce=>ce._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(ce){return"side"!==ce.mode||!!this._backdropOverride}_isDrawerOpen(ce){return null!=ce&&ce.opened}}return ht.\u0275fac=function(ce){return new(ce||ht)(a.Y36(it.Is,8),a.Y36(a.SBq),a.Y36(a.R0b),a.Y36(a.sBO),a.Y36(_.rL),a.Y36(ii),a.Y36(a.QbO,8))},ht.\u0275cmp=a.Xpm({type:ht,selectors:[["mat-drawer-container"]],contentQueries:function(ce,ot,Se){if(1&ce&&(a.Suo(Se,Nn,5),a.Suo(Se,Bi,5)),2&ce){let St;a.iGM(St=a.CRH())&&(ot._content=St.first),a.iGM(St=a.CRH())&&(ot._allDrawers=St)}},viewQuery:function(ce,ot){if(1&ce&&a.Gf(Nn,5),2&ce){let Se;a.iGM(Se=a.CRH())&&(ot._userContent=Se.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(ce,ot){2&ce&&a.ekj("mat-drawer-container-explicit-backdrop",ot._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[a._Bn([{provide:vi,useExisting:ht}])],ngContentSelectors:Jt,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(ce,ot){1&ce&&(a.F$t(zt),a.YNc(0,we,1,2,"div",0),a.Hsn(1),a.Hsn(2,1),a.YNc(3,At,2,0,"mat-drawer-content",1)),2&ce&&(a.Q6J("ngIf",ot.hasBackdrop),a.xp6(3),a.Q6J("ngIf",!ot._content))},dependencies:[Nn,pe.O5],styles:[".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n"],encapsulation:2,changeDetection:0}),ht})(),Fe=(()=>{class ht{}return ht.\u0275fac=function(ce){return new(ce||ht)},ht.\u0275mod=a.oAB({type:ht}),ht.\u0275inj=a.cJS({imports:[[pe.ez,de.BQ,w.ud,_.ZD],_.ZD,de.BQ]}),ht})()},6046:(ti,Vt,B)=>{"use strict";B.d(Vt,{ux:()=>Ge,ZX:()=>Jn});var w=B(8184),_=B(4080),pe=B(6895),a=B(4650),de=B(3238),ut=B(4859),it=B(7579),Le=B(3353),ke=B(5698),rt=B(2722),ft=B(7340),Et=B(2687),dt=B(1281),wt=B(9841),tt=B(7272),Wt=B(9751),kt=B(5684),Qe=B(8372),Hn=B(4004),Ln=B(8675);const Ce=new Set;let we,At=(()=>{class Fe{constructor(Xe){this._platform=Xe,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):Jt}matchMedia(Xe){return(this._platform.WEBKIT||this._platform.BLINK)&&function zt(Fe){if(!Ce.has(Fe))try{we||(we=document.createElement("style"),we.setAttribute("type","text/css"),document.head.appendChild(we)),we.sheet&&(we.sheet.insertRule(`@media ${Fe} {body{ }}`,0),Ce.add(Fe))}catch(ht){console.error(ht)}}(Xe),this._matchMedia(Xe)}}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)(a.LFG(Le.t4))},Fe.\u0275prov=a.Yz7({token:Fe,factory:Fe.\u0275fac,providedIn:"root"}),Fe})();function Jt(Fe){return{matches:"all"===Fe||""===Fe,media:Fe,addListener:()=>{},removeListener:()=>{}}}let Cn=(()=>{class Fe{constructor(Xe,ce){this._mediaMatcher=Xe,this._zone=ce,this._queries=new Map,this._destroySubject=new it.x}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(Xe){return Ke((0,dt.Eq)(Xe)).some(ot=>this._registerQuery(ot).mql.matches)}observe(Xe){const ot=Ke((0,dt.Eq)(Xe)).map(St=>this._registerQuery(St).observable);let Se=(0,wt.a)(ot);return Se=(0,tt.z)(Se.pipe((0,ke.q)(1)),Se.pipe((0,kt.T)(1),(0,Qe.b)(0))),Se.pipe((0,Hn.U)(St=>{const tn={matches:!1,breakpoints:{}};return St.forEach(({matches:li,query:Wi})=>{tn.matches=tn.matches||li,tn.breakpoints[Wi]=li}),tn}))}_registerQuery(Xe){if(this._queries.has(Xe))return this._queries.get(Xe);const ce=this._mediaMatcher.matchMedia(Xe),Se={observable:new Wt.y(St=>{const tn=li=>this._zone.run(()=>St.next(li));return ce.addListener(tn),()=>{ce.removeListener(tn)}}).pipe((0,Ln.O)(ce),(0,Hn.U)(({matches:St})=>({query:Xe,matches:St})),(0,rt.R)(this._destroySubject)),mql:ce};return this._queries.set(Xe,Se),Se}}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)(a.LFG(At),a.LFG(a.R0b))},Fe.\u0275prov=a.Yz7({token:Fe,factory:Fe.\u0275fac,providedIn:"root"}),Fe})();function Ke(Fe){return Fe.map(ht=>ht.split(",")).reduce((ht,Xe)=>ht.concat(Xe)).map(ht=>ht.trim())}function He(Fe,ht){if(1&Fe){const Xe=a.EpF();a.TgZ(0,"div",1)(1,"button",2),a.NdJ("click",function(){a.CHM(Xe);const ot=a.oxw();return a.KtG(ot.action())}),a._uU(2),a.qZA()()}if(2&Fe){const Xe=a.oxw();a.xp6(2),a.Oqu(Xe.data.action)}}function _t(Fe,ht){}const Dn=new a.OlP("MatSnackBarData");class Xt{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const ii=Math.pow(2,31)-1;class vi{constructor(ht,Xe){this._overlayRef=Xe,this._afterDismissed=new it.x,this._afterOpened=new it.x,this._onAction=new it.x,this._dismissedByAction=!1,this.containerInstance=ht,this.onAction().subscribe(()=>this.dismiss()),ht._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(ht){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(ht,ii))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let wi=(()=>{class Fe{constructor(Xe,ce){this.snackBarRef=Xe,this.data=ce}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)(a.Y36(vi),a.Y36(Dn))},Fe.\u0275cmp=a.Xpm({type:Fe,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(Xe,ce){1&Xe&&(a.TgZ(0,"span"),a._uU(1),a.qZA(),a.YNc(2,He,3,1,"div",0)),2&Xe&&(a.xp6(1),a.Oqu(ce.data.message),a.xp6(1),a.Q6J("ngIf",ce.hasAction))},dependencies:[ut.lW,pe.O5],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}\n"],encapsulation:2,changeDetection:0}),Fe})();const Nn={snackBarState:(0,ft.X$)("state",[(0,ft.SB)("void, hidden",(0,ft.oB)({transform:"scale(0.8)",opacity:0})),(0,ft.SB)("visible",(0,ft.oB)({transform:"scale(1)",opacity:1})),(0,ft.eR)("* => visible",(0,ft.jt)("150ms cubic-bezier(0, 0, 0.2, 1)")),(0,ft.eR)("* => void, * => hidden",(0,ft.jt)("75ms cubic-bezier(0.4, 0.0, 1, 1)",(0,ft.oB)({opacity:0})))])};let Bi=(()=>{class Fe extends _.en{constructor(Xe,ce,ot,Se,St){super(),this._ngZone=Xe,this._elementRef=ce,this._changeDetectorRef=ot,this._platform=Se,this.snackBarConfig=St,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new it.x,this._onExit=new it.x,this._onEnter=new it.x,this._animationState="void",this.attachDomPortal=tn=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(tn)),this._live="assertive"!==St.politeness||St.announcementMessage?"off"===St.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(Xe){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(Xe)}attachTemplatePortal(Xe){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(Xe)}onAnimationEnd(Xe){const{fromState:ce,toState:ot}=Xe;if(("void"===ot&&"void"!==ce||"hidden"===ot)&&this._completeExit(),"visible"===ot){const Se=this._onEnter;this._ngZone.run(()=>{Se.next(),Se.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe((0,ke.q)(1)).subscribe(()=>{this._onExit.next(),this._onExit.complete()})}_applySnackBarClasses(){const Xe=this._elementRef.nativeElement,ce=this.snackBarConfig.panelClass;ce&&(Array.isArray(ce)?ce.forEach(ot=>Xe.classList.add(ot)):Xe.classList.add(ce)),"center"===this.snackBarConfig.horizontalPosition&&Xe.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&Xe.classList.add("mat-snack-bar-top")}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const Xe=this._elementRef.nativeElement.querySelector("[aria-hidden]"),ce=this._elementRef.nativeElement.querySelector("[aria-live]");if(Xe&&ce){let ot=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&Xe.contains(document.activeElement)&&(ot=document.activeElement),Xe.removeAttribute("aria-hidden"),ce.appendChild(Xe),ot?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)(a.Y36(a.R0b),a.Y36(a.SBq),a.Y36(a.sBO),a.Y36(Le.t4),a.Y36(Xt))},Fe.\u0275cmp=a.Xpm({type:Fe,selectors:[["snack-bar-container"]],viewQuery:function(Xe,ce){if(1&Xe&&a.Gf(_.Pl,7),2&Xe){let ot;a.iGM(ot=a.CRH())&&(ce._portalOutlet=ot.first)}},hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(Xe,ce){1&Xe&&a.WFA("@state.done",function(Se){return ce.onAnimationEnd(Se)}),2&Xe&&a.d8E("@state",ce._animationState)},features:[a.qOj],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(Xe,ce){1&Xe&&(a.TgZ(0,"div",0),a.YNc(1,_t,0,0,"ng-template",1),a.qZA(),a._UZ(2,"div")),2&Xe&&(a.xp6(2),a.uIk("aria-live",ce._live)("role",ce._role))},dependencies:[_.Pl],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[Nn.snackBarState]}}),Fe})(),Jn=(()=>{class Fe{}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)},Fe.\u0275mod=a.oAB({type:Fe}),Fe.\u0275inj=a.cJS({imports:[[w.U8,_.eL,pe.ez,ut.ot,de.BQ],de.BQ]}),Fe})();const fn=new a.OlP("mat-snack-bar-default-options",{providedIn:"root",factory:function Tt(){return new Xt}});let Ge=(()=>{class Fe{constructor(Xe,ce,ot,Se,St,tn){this._overlay=Xe,this._live=ce,this._injector=ot,this._breakpointObserver=Se,this._parentSnackBar=St,this._defaultConfig=tn,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=wi,this.snackBarContainerComponent=Bi,this.handsetCssClass="mat-snack-bar-handset"}get _openedSnackBarRef(){const Xe=this._parentSnackBar;return Xe?Xe._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(Xe){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=Xe:this._snackBarRefAtThisLevel=Xe}openFromComponent(Xe,ce){return this._attach(Xe,ce)}openFromTemplate(Xe,ce){return this._attach(Xe,ce)}open(Xe,ce="",ot){const Se={...this._defaultConfig,...ot};return Se.data={message:Xe,action:ce},Se.announcementMessage===Xe&&(Se.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,Se)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(Xe,ce){const Se=a.zs3.create({parent:ce&&ce.viewContainerRef&&ce.viewContainerRef.injector||this._injector,providers:[{provide:Xt,useValue:ce}]}),St=new _.C5(this.snackBarContainerComponent,ce.viewContainerRef,Se),tn=Xe.attach(St);return tn.instance.snackBarConfig=ce,tn.instance}_attach(Xe,ce){const ot={...new Xt,...this._defaultConfig,...ce},Se=this._createOverlay(ot),St=this._attachSnackBarContainer(Se,ot),tn=new vi(St,Se);if(Xe instanceof a.Rgc){const li=new _.UE(Xe,null,{$implicit:ot.data,snackBarRef:tn});tn.instance=St.attachTemplatePortal(li)}else{const li=this._createInjector(ot,tn),Wi=new _.C5(Xe,void 0,li),Mn=St.attachComponentPortal(Wi);tn.instance=Mn.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe((0,rt.R)(Se.detachments())).subscribe(li=>{Se.overlayElement.classList.toggle(this.handsetCssClass,li.matches)}),ot.announcementMessage&&St._onAnnounce.subscribe(()=>{this._live.announce(ot.announcementMessage,ot.politeness)}),this._animateSnackBar(tn,ot),this._openedSnackBarRef=tn,this._openedSnackBarRef}_animateSnackBar(Xe,ce){Xe.afterDismissed().subscribe(()=>{this._openedSnackBarRef==Xe&&(this._openedSnackBarRef=null),ce.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{Xe.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):Xe.containerInstance.enter(),ce.duration&&ce.duration>0&&Xe.afterOpened().subscribe(()=>Xe._dismissAfter(ce.duration))}_createOverlay(Xe){const ce=new w.X_;ce.direction=Xe.direction;let ot=this._overlay.position().global();const Se="rtl"===Xe.direction,St="left"===Xe.horizontalPosition||"start"===Xe.horizontalPosition&&!Se||"end"===Xe.horizontalPosition&&Se,tn=!St&&"center"!==Xe.horizontalPosition;return St?ot.left("0"):tn?ot.right("0"):ot.centerHorizontally(),"top"===Xe.verticalPosition?ot.top("0"):ot.bottom("0"),ce.positionStrategy=ot,this._overlay.create(ce)}_createInjector(Xe,ce){return a.zs3.create({parent:Xe&&Xe.viewContainerRef&&Xe.viewContainerRef.injector||this._injector,providers:[{provide:vi,useValue:ce},{provide:Dn,useValue:Xe.data}]})}}return Fe.\u0275fac=function(Xe){return new(Xe||Fe)(a.LFG(w.aV),a.LFG(Et.Kd),a.LFG(a.zs3),a.LFG(Cn),a.LFG(Fe,12),a.LFG(fn))},Fe.\u0275prov=a.Yz7({token:Fe,factory:Fe.\u0275fac,providedIn:Jn}),Fe})()},1481:(ti,Vt,B)=>{"use strict";B.d(Vt,{Dx:()=>ge,H7:()=>ct,b2:()=>Rt,q6:()=>Wi,se:()=>_t});var w=B(6895),_=B(4650);class pe extends w.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class a extends pe{static makeCurrent(){(0,w.HT)(new a)}onAndCancel(_e,he,Ue){return _e.addEventListener(he,Ue,!1),()=>{_e.removeEventListener(he,Ue,!1)}}dispatchEvent(_e,he){_e.dispatchEvent(he)}remove(_e){_e.parentNode&&_e.parentNode.removeChild(_e)}createElement(_e,he){return(he=he||this.getDefaultDocument()).createElement(_e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(_e){return _e.nodeType===Node.ELEMENT_NODE}isShadowRoot(_e){return _e instanceof DocumentFragment}getGlobalEventTarget(_e,he){return"window"===he?window:"document"===he?_e:"body"===he?_e.body:null}getBaseHref(_e){const he=function ut(){return de=de||document.querySelector("base"),de?de.getAttribute("href"):null}();return null==he?null:function Le(le){it=it||document.createElement("a"),it.setAttribute("href",le);const _e=it.pathname;return"/"===_e.charAt(0)?_e:`/${_e}`}(he)}resetBaseElement(){de=null}getUserAgent(){return window.navigator.userAgent}getCookie(_e){return(0,w.Mx)(document.cookie,_e)}}let it,de=null;const ke=new _.OlP("TRANSITION_ID"),ft=[{provide:_.ip1,useFactory:function rt(le,_e,he){return()=>{he.get(_.CZH).donePromise.then(()=>{const Ue=(0,w.q)(),Zt=_e.querySelectorAll(`style[ng-transition="${le}"]`);for(let Tn=0;Tn<Zt.length;Tn++)Ue.remove(Zt[Tn])})}},deps:[ke,w.K0,_.zs3],multi:!0}];let dt=(()=>{class le{build(){return new XMLHttpRequest}}return le.\u0275fac=function(he){return new(he||le)},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();const wt=new _.OlP("EventManagerPlugins");let tt=(()=>{class le{constructor(he,Ue){this._zone=Ue,this._eventNameToPlugin=new Map,he.forEach(Zt=>Zt.manager=this),this._plugins=he.slice().reverse()}addEventListener(he,Ue,Zt){return this._findPluginFor(Ue).addEventListener(he,Ue,Zt)}addGlobalEventListener(he,Ue,Zt){return this._findPluginFor(Ue).addGlobalEventListener(he,Ue,Zt)}getZone(){return this._zone}_findPluginFor(he){const Ue=this._eventNameToPlugin.get(he);if(Ue)return Ue;const Zt=this._plugins;for(let Tn=0;Tn<Zt.length;Tn++){const jn=Zt[Tn];if(jn.supports(he))return this._eventNameToPlugin.set(he,jn),jn}throw new Error(`No event manager plugin found for event ${he}`)}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(wt),_.LFG(_.R0b))},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();class Wt{constructor(_e){this._doc=_e}addGlobalEventListener(_e,he,Ue){const Zt=(0,w.q)().getGlobalEventTarget(this._doc,_e);if(!Zt)throw new Error(`Unsupported event target ${Zt} for event ${he}`);return this.addEventListener(Zt,he,Ue)}}let kt=(()=>{class le{constructor(){this._stylesSet=new Set}addStyles(he){const Ue=new Set;he.forEach(Zt=>{this._stylesSet.has(Zt)||(this._stylesSet.add(Zt),Ue.add(Zt))}),this.onStylesAdded(Ue)}onStylesAdded(he){}getAllStyles(){return Array.from(this._stylesSet)}}return le.\u0275fac=function(he){return new(he||le)},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})(),Qe=(()=>{class le extends kt{constructor(he){super(),this._doc=he,this._hostNodes=new Map,this._hostNodes.set(he.head,[])}_addStylesToHost(he,Ue,Zt){he.forEach(Tn=>{const jn=this._doc.createElement("style");jn.textContent=Tn,Zt.push(Ue.appendChild(jn))})}addHost(he){const Ue=[];this._addStylesToHost(this._stylesSet,he,Ue),this._hostNodes.set(he,Ue)}removeHost(he){const Ue=this._hostNodes.get(he);Ue&&Ue.forEach(Hn),this._hostNodes.delete(he)}onStylesAdded(he){this._hostNodes.forEach((Ue,Zt)=>{this._addStylesToHost(he,Zt,Ue)})}ngOnDestroy(){this._hostNodes.forEach(he=>he.forEach(Hn))}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(w.K0))},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();function Hn(le){(0,w.q)().remove(le)}const Ln={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ye=/%COMP%/g;function Ke(le,_e,he){for(let Ue=0;Ue<_e.length;Ue++){let Zt=_e[Ue];Array.isArray(Zt)?Ke(le,Zt,he):(Zt=Zt.replace(Ye,le),he.push(Zt))}return he}function Ne(le){return _e=>{if("__ngUnwrap__"===_e)return le;!1===le(_e)&&(_e.preventDefault(),_e.returnValue=!1)}}let _t=(()=>{class le{constructor(he,Ue,Zt){this.eventManager=he,this.sharedStylesHost=Ue,this.appId=Zt,this.rendererByCompId=new Map,this.defaultRenderer=new Dn(he)}createRenderer(he,Ue){if(!he||!Ue)return this.defaultRenderer;switch(Ue.encapsulation){case _.ifc.Emulated:{let Zt=this.rendererByCompId.get(Ue.id);return Zt||(Zt=new wi(this.eventManager,this.sharedStylesHost,Ue,this.appId),this.rendererByCompId.set(Ue.id,Zt)),Zt.applyToHost(he),Zt}case 1:case _.ifc.ShadowDom:return new Nn(this.eventManager,this.sharedStylesHost,he,Ue);default:if(!this.rendererByCompId.has(Ue.id)){const Zt=Ke(Ue.id,Ue.styles,[]);this.sharedStylesHost.addStyles(Zt),this.rendererByCompId.set(Ue.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(tt),_.LFG(Qe),_.LFG(_.AFp))},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();class Dn{constructor(_e){this.eventManager=_e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(_e,he){return he?document.createElementNS(Ln[he]||he,_e):document.createElement(_e)}createComment(_e){return document.createComment(_e)}createText(_e){return document.createTextNode(_e)}appendChild(_e,he){(vi(_e)?_e.content:_e).appendChild(he)}insertBefore(_e,he,Ue){_e&&(vi(_e)?_e.content:_e).insertBefore(he,Ue)}removeChild(_e,he){_e&&_e.removeChild(he)}selectRootElement(_e,he){let Ue="string"==typeof _e?document.querySelector(_e):_e;if(!Ue)throw new Error(`The selector "${_e}" did not match any elements`);return he||(Ue.textContent=""),Ue}parentNode(_e){return _e.parentNode}nextSibling(_e){return _e.nextSibling}setAttribute(_e,he,Ue,Zt){if(Zt){he=Zt+":"+he;const Tn=Ln[Zt];Tn?_e.setAttributeNS(Tn,he,Ue):_e.setAttribute(he,Ue)}else _e.setAttribute(he,Ue)}removeAttribute(_e,he,Ue){if(Ue){const Zt=Ln[Ue];Zt?_e.removeAttributeNS(Zt,he):_e.removeAttribute(`${Ue}:${he}`)}else _e.removeAttribute(he)}addClass(_e,he){_e.classList.add(he)}removeClass(_e,he){_e.classList.remove(he)}setStyle(_e,he,Ue,Zt){Zt&(_.JOm.DashCase|_.JOm.Important)?_e.style.setProperty(he,Ue,Zt&_.JOm.Important?"important":""):_e.style[he]=Ue}removeStyle(_e,he,Ue){Ue&_.JOm.DashCase?_e.style.removeProperty(he):_e.style[he]=""}setProperty(_e,he,Ue){_e[he]=Ue}setValue(_e,he){_e.nodeValue=he}listen(_e,he,Ue){return"string"==typeof _e?this.eventManager.addGlobalEventListener(_e,he,Ne(Ue)):this.eventManager.addEventListener(_e,he,Ne(Ue))}}function vi(le){return"TEMPLATE"===le.tagName&&void 0!==le.content}class wi extends Dn{constructor(_e,he,Ue,Zt){super(_e),this.component=Ue;const Tn=Ke(Zt+"-"+Ue.id,Ue.styles,[]);he.addStyles(Tn),this.contentAttr=function Jt(le){return"_ngcontent-%COMP%".replace(Ye,le)}(Zt+"-"+Ue.id),this.hostAttr=function Cn(le){return"_nghost-%COMP%".replace(Ye,le)}(Zt+"-"+Ue.id)}applyToHost(_e){super.setAttribute(_e,this.hostAttr,"")}createElement(_e,he){const Ue=super.createElement(_e,he);return super.setAttribute(Ue,this.contentAttr,""),Ue}}class Nn extends Dn{constructor(_e,he,Ue,Zt){super(_e),this.sharedStylesHost=he,this.hostEl=Ue,this.shadowRoot=Ue.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Tn=Ke(Zt.id,Zt.styles,[]);for(let jn=0;jn<Tn.length;jn++){const Xn=document.createElement("style");Xn.textContent=Tn[jn],this.shadowRoot.appendChild(Xn)}}nodeOrShadowRoot(_e){return _e===this.hostEl?this.shadowRoot:_e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(_e,he){return super.appendChild(this.nodeOrShadowRoot(_e),he)}insertBefore(_e,he,Ue){return super.insertBefore(this.nodeOrShadowRoot(_e),he,Ue)}removeChild(_e,he){return super.removeChild(this.nodeOrShadowRoot(_e),he)}parentNode(_e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(_e)))}}let Bi=(()=>{class le extends Wt{constructor(he){super(he)}supports(he){return!0}addEventListener(he,Ue,Zt){return he.addEventListener(Ue,Zt,!1),()=>this.removeEventListener(he,Ue,Zt)}removeEventListener(he,Ue,Zt){return he.removeEventListener(Ue,Zt)}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(w.K0))},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();const Jn=["alt","control","meta","shift"],fn={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Tt={alt:le=>le.altKey,control:le=>le.ctrlKey,meta:le=>le.metaKey,shift:le=>le.shiftKey};let Ge=(()=>{class le extends Wt{constructor(he){super(he)}supports(he){return null!=le.parseEventName(he)}addEventListener(he,Ue,Zt){const Tn=le.parseEventName(Ue),jn=le.eventCallback(Tn.fullKey,Zt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,w.q)().onAndCancel(he,Tn.domEventName,jn))}static parseEventName(he){const Ue=he.toLowerCase().split("."),Zt=Ue.shift();if(0===Ue.length||"keydown"!==Zt&&"keyup"!==Zt)return null;const Tn=le._normalizeKey(Ue.pop());let jn="",Xn=Ue.indexOf("code");if(Xn>-1&&(Ue.splice(Xn,1),jn="code."),Jn.forEach(Ri=>{const Gn=Ue.indexOf(Ri);Gn>-1&&(Ue.splice(Gn,1),jn+=Ri+".")}),jn+=Tn,0!=Ue.length||0===Tn.length)return null;const Ai={};return Ai.domEventName=Zt,Ai.fullKey=jn,Ai}static matchEventFullKeyCode(he,Ue){let Zt=fn[he.key]||he.key,Tn="";return Ue.indexOf("code.")>-1&&(Zt=he.code,Tn="code."),!(null==Zt||!Zt)&&(Zt=Zt.toLowerCase()," "===Zt?Zt="space":"."===Zt&&(Zt="dot"),Jn.forEach(jn=>{jn!==Zt&&(0,Tt[jn])(he)&&(Tn+=jn+".")}),Tn+=Zt,Tn===Ue)}static eventCallback(he,Ue,Zt){return Tn=>{le.matchEventFullKeyCode(Tn,he)&&Zt.runGuarded(()=>Ue(Tn))}}static _normalizeKey(he){return"esc"===he?"escape":he}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(w.K0))},le.\u0275prov=_.Yz7({token:le,factory:le.\u0275fac}),le})();const Wi=(0,_.eFA)(_._c5,"browser",[{provide:_.Lbi,useValue:w.bD},{provide:_.g9A,useValue:function Se(){a.makeCurrent()},multi:!0},{provide:w.K0,useFactory:function tn(){return(0,_.RDi)(document),document},deps:[]}]),Mn=new _.OlP(""),ae=[{provide:_.rWj,useClass:class Et{addToWindow(_e){_.dqk.getAngularTestability=(Ue,Zt=!0)=>{const Tn=_e.findTestabilityInTree(Ue,Zt);if(null==Tn)throw new Error("Could not find testability for element.");return Tn},_.dqk.getAllAngularTestabilities=()=>_e.getAllTestabilities(),_.dqk.getAllAngularRootElements=()=>_e.getAllRootElements(),_.dqk.frameworkStabilizers||(_.dqk.frameworkStabilizers=[]),_.dqk.frameworkStabilizers.push(Ue=>{const Zt=_.dqk.getAllAngularTestabilities();let Tn=Zt.length,jn=!1;const Xn=function(Ai){jn=jn||Ai,Tn--,0==Tn&&Ue(jn)};Zt.forEach(function(Ai){Ai.whenStable(Xn)})})}findTestabilityInTree(_e,he,Ue){return null==he?null:_e.getTestability(he)??(Ue?(0,w.q)().isShadowRoot(he)?this.findTestabilityInTree(_e,he.host,!0):this.findTestabilityInTree(_e,he.parentElement,!0):null)}},deps:[]},{provide:_.lri,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]},{provide:_.dDg,useClass:_.dDg,deps:[_.R0b,_.eoX,_.rWj]}],$e=[{provide:_.zSh,useValue:"root"},{provide:_.qLn,useFactory:function St(){return new _.qLn},deps:[]},{provide:wt,useClass:Bi,multi:!0,deps:[w.K0,_.R0b,_.Lbi]},{provide:wt,useClass:Ge,multi:!0,deps:[w.K0]},{provide:_t,useClass:_t,deps:[tt,Qe,_.AFp]},{provide:_.FYo,useExisting:_t},{provide:kt,useExisting:Qe},{provide:Qe,useClass:Qe,deps:[w.K0]},{provide:tt,useClass:tt,deps:[wt,_.R0b]},{provide:w.JF,useClass:dt,deps:[]},[]];let Rt=(()=>{class le{constructor(he){}static withServerTransition(he){return{ngModule:le,providers:[{provide:_.AFp,useValue:he.appId},{provide:ke,useExisting:_.AFp},ft]}}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(Mn,12))},le.\u0275mod=_.oAB({type:le}),le.\u0275inj=_.cJS({providers:[...$e,...ae],imports:[w.ez,_.hGG]}),le})(),ge=(()=>{class le{constructor(he){this._doc=he}getTitle(){return this._doc.title}setTitle(he){this._doc.title=he||""}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(w.K0))},le.\u0275prov=_.Yz7({token:le,factory:function(he){let Ue=null;return Ue=he?new he:function Je(){return new ge((0,_.LFG)(w.K0))}(),Ue},providedIn:"root"}),le})();typeof window<"u"&&window;let ct=(()=>{class le{}return le.\u0275fac=function(he){return new(he||le)},le.\u0275prov=_.Yz7({token:le,factory:function(he){let Ue=null;return Ue=he?new(he||le):_.LFG(Ft),Ue},providedIn:"root"}),le})(),Ft=(()=>{class le extends ct{constructor(he){super(),this._doc=he}sanitize(he,Ue){if(null==Ue)return null;switch(he){case _.q3G.NONE:return Ue;case _.q3G.HTML:return(0,_.qzn)(Ue,"HTML")?(0,_.z3N)(Ue):(0,_.EiD)(this._doc,String(Ue)).toString();case _.q3G.STYLE:return(0,_.qzn)(Ue,"Style")?(0,_.z3N)(Ue):Ue;case _.q3G.SCRIPT:if((0,_.qzn)(Ue,"Script"))return(0,_.z3N)(Ue);throw new Error("unsafe value used in a script context");case _.q3G.URL:return(0,_.qzn)(Ue,"URL")?(0,_.z3N)(Ue):(0,_.mCW)(String(Ue));case _.q3G.RESOURCE_URL:if((0,_.qzn)(Ue,"ResourceURL"))return(0,_.z3N)(Ue);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${he} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(he){return(0,_.JVY)(he)}bypassSecurityTrustStyle(he){return(0,_.L6k)(he)}bypassSecurityTrustScript(he){return(0,_.eBb)(he)}bypassSecurityTrustUrl(he){return(0,_.LAX)(he)}bypassSecurityTrustResourceUrl(he){return(0,_.pB0)(he)}}return le.\u0275fac=function(he){return new(he||le)(_.LFG(w.K0))},le.\u0275prov=_.Yz7({token:le,factory:function(he){let Ue=null;return Ue=he?new he:function Lt(le){return new Ft(le.get(w.K0))}(_.LFG(_.zs3)),Ue},providedIn:"root"}),le})()},9197:(ti,Vt,B)=>{"use strict";B.d(Vt,{gz:()=>Bo,F0:()=>Ur,rH:()=>Di,Od:()=>Zi,yS:()=>Ii,Bz:()=>hd,lC:()=>Fr});var w=B(4650),_=B(2076),pe=B(9646),a=B(1135);const ut=(0,B(3888).d)(O=>function(){O(this),this.name="EmptyError",this.message="no elements in sequence"});var it=B(9841),Le=B(7272),ke=B(9770),rt=B(9635),ft=B(2843),Et=B(9751),dt=B(515),wt=B(727),tt=B(4482),Wt=B(5403);function kt(){return(0,tt.e)((O,k)=>{let I=null;O._refCount++;const V=(0,Wt.x)(k,void 0,void 0,void 0,()=>{if(!O||O._refCount<=0||0<--O._refCount)return void(I=null);const Y=O._connection,me=I;I=null,Y&&(!me||Y===me)&&Y.unsubscribe(),k.unsubscribe()});O.subscribe(V),V.closed||(I=O.connect())})}class Qe extends Et.y{constructor(k,I){super(),this.source=k,this.subjectFactory=I,this._subject=null,this._refCount=0,this._connection=null,(0,tt.A)(k)&&(this.lift=k.lift)}_subscribe(k){return this.getSubject().subscribe(k)}getSubject(){const k=this._subject;return(!k||k.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:k}=this;this._subject=this._connection=null,k?.unsubscribe()}connect(){let k=this._connection;if(!k){k=this._connection=new wt.w0;const I=this.getSubject();k.add(this.source.subscribe((0,Wt.x)(I,void 0,()=>{this._teardown(),I.complete()},V=>{this._teardown(),I.error(V)},()=>this._teardown()))),k.closed&&(this._connection=null,k=wt.w0.EMPTY)}return k}refCount(){return kt()(this)}}var Hn=B(7579),Ln=B(6895),Ye=B(4004),Ce=B(3900),we=B(5698),At=B(8675),zt=B(9300),Jt=B(5577);function Cn(O){return(0,tt.e)((k,I)=>{let V=!1;k.subscribe((0,Wt.x)(I,Y=>{V=!0,I.next(Y)},()=>{V||I.next(O),I.complete()}))})}function Ke(O=Ne){return(0,tt.e)((k,I)=>{let V=!1;k.subscribe((0,Wt.x)(I,Y=>{V=!0,I.next(Y)},()=>V?I.complete():I.error(O())))})}function Ne(){return new ut}var He=B(4671);function _t(O,k){const I=arguments.length>=2;return V=>V.pipe(O?(0,zt.h)((Y,me)=>O(Y,me,V)):He.y,(0,we.q)(1),I?Cn(k):Ke(()=>new ut))}var Dn=B(4351),Xt=B(8505),ii=B(262);function vi(O,k,I,V,Y){return(me,et)=>{let bt=I,Sn=k,fi=0;me.subscribe((0,Wt.x)(et,rr=>{const Si=fi++;Sn=bt?O(Sn,rr,Si):(bt=!0,rr),V&&et.next(Sn)},Y&&(()=>{bt&&et.next(Sn),et.complete()})))}}function wi(O,k){return(0,tt.e)(vi(O,k,arguments.length>=2,!0))}function Nn(O){return O<=0?()=>dt.E:(0,tt.e)((k,I)=>{let V=[];k.subscribe((0,Wt.x)(I,Y=>{V.push(Y),O<V.length&&V.shift()},()=>{for(const Y of V)I.next(Y);I.complete()},void 0,()=>{V=null}))})}function Bi(O,k){const I=arguments.length>=2;return V=>V.pipe(O?(0,zt.h)((Y,me)=>O(Y,me,V)):He.y,Nn(1),I?Cn(k):Ke(()=>new ut))}var fn=B(9718),Tt=B(8746),Ge=B(8189),Fe=B(1481);const ht="primary",Xe=Symbol("RouteTitle");class ce{constructor(k){this.params=k||{}}has(k){return Object.prototype.hasOwnProperty.call(this.params,k)}get(k){if(this.has(k)){const I=this.params[k];return Array.isArray(I)?I[0]:I}return null}getAll(k){if(this.has(k)){const I=this.params[k];return Array.isArray(I)?I:[I]}return[]}get keys(){return Object.keys(this.params)}}function ot(O){return new ce(O)}function Se(O,k,I){const V=I.path.split("/");if(V.length>O.length||"full"===I.pathMatch&&(k.hasChildren()||V.length<O.length))return null;const Y={};for(let me=0;me<V.length;me++){const et=V[me],bt=O[me];if(et.startsWith(":"))Y[et.substring(1)]=bt;else if(et!==bt.path)return null}return{consumed:O.slice(0,V.length),posParams:Y}}function tn(O,k){const I=O?Object.keys(O):void 0,V=k?Object.keys(k):void 0;if(!I||!V||I.length!=V.length)return!1;let Y;for(let me=0;me<I.length;me++)if(Y=I[me],!li(O[Y],k[Y]))return!1;return!0}function li(O,k){if(Array.isArray(O)&&Array.isArray(k)){if(O.length!==k.length)return!1;const I=[...O].sort(),V=[...k].sort();return I.every((Y,me)=>V[me]===Y)}return O===k}function Wi(O){return Array.prototype.concat.apply([],O)}function Mn(O){return O.length>0?O[O.length-1]:null}function $e(O,k){for(const I in O)O.hasOwnProperty(I)&&k(O[I],I)}function Rt(O){return(0,w.CqO)(O)?O:(0,w.QGY)(O)?(0,_.D)(Promise.resolve(O)):(0,pe.of)(O)}const Bt={exact:function te(O,k,I){if(!un(O.segments,k.segments)||!ni(O.segments,k.segments,I)||O.numberOfChildren!==k.numberOfChildren)return!1;for(const V in k.children)if(!O.children[V]||!te(O.children[V],k.children[V],I))return!1;return!0},subset:Ht},Je={exact:function fe(O,k){return tn(O,k)},subset:function nt(O,k){return Object.keys(k).length<=Object.keys(O).length&&Object.keys(k).every(I=>li(O[I],k[I]))},ignored:()=>!0};function ge(O,k,I){return Bt[I.paths](O.root,k.root,I.matrixParams)&&Je[I.queryParams](O.queryParams,k.queryParams)&&!("exact"===I.fragment&&O.fragment!==k.fragment)}function Ht(O,k,I){return Rn(O,k,k.segments,I)}function Rn(O,k,I,V){if(O.segments.length>I.length){const Y=O.segments.slice(0,I.length);return!(!un(Y,I)||k.hasChildren()||!ni(Y,I,V))}if(O.segments.length===I.length){if(!un(O.segments,I)||!ni(O.segments,I,V))return!1;for(const Y in k.children)if(!O.children[Y]||!Ht(O.children[Y],k.children[Y],V))return!1;return!0}{const Y=I.slice(0,O.segments.length),me=I.slice(O.segments.length);return!!(un(O.segments,Y)&&ni(O.segments,Y,V)&&O.children[ht])&&Rn(O.children[ht],k,me,V)}}function ni(O,k,I){return k.every((V,Y)=>Je[I](O[Y].parameters,V.parameters))}class Oi{constructor(k,I,V){this.root=k,this.queryParams=I,this.fragment=V}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ot(this.queryParams)),this._queryParamMap}toString(){return _i.serialize(this)}}class xn{constructor(k,I){this.segments=k,this.children=I,this.parent=null,$e(I,(V,Y)=>V.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Qt(this)}}class Ji{constructor(k,I){this.path=k,this.parameters=I}get parameterMap(){return this._parameterMap||(this._parameterMap=ot(this.parameters)),this._parameterMap}toString(){return oe(this)}}function un(O,k){return O.length===k.length&&O.every((I,V)=>I.path===k[V].path)}let lt=(()=>{class O{}return O.\u0275fac=function(I){return new(I||O)},O.\u0275prov=w.Yz7({token:O,factory:function(){return new nn},providedIn:"root"}),O})();class nn{parse(k){const I=new he(k);return new Oi(I.parseRootSegment(),I.parseQueryParams(),I.parseFragment())}serialize(k){const I=`/${xt(k.root,!0)}`,V=function Ve(O){const k=Object.keys(O).map(I=>{const V=O[I];return Array.isArray(V)?V.map(Y=>`${Yt(I)}=${Yt(Y)}`).join("&"):`${Yt(I)}=${Yt(V)}`}).filter(I=>!!I);return k.length?`?${k.join("&")}`:""}(k.queryParams);return`${I}${V}${"string"==typeof k.fragment?`#${function bn(O){return encodeURI(O)}(k.fragment)}`:""}`}}const _i=new nn;function Qt(O){return O.segments.map(k=>oe(k)).join("/")}function xt(O,k){if(!O.hasChildren())return Qt(O);if(k){const I=O.children[ht]?xt(O.children[ht],!1):"",V=[];return $e(O.children,(Y,me)=>{me!==ht&&V.push(`${me}:${xt(Y,!1)}`)}),V.length>0?`${I}(${V.join("//")})`:I}{const I=function Pt(O,k){let I=[];return $e(O.children,(V,Y)=>{Y===ht&&(I=I.concat(k(V,Y)))}),$e(O.children,(V,Y)=>{Y!==ht&&(I=I.concat(k(V,Y)))}),I}(O,(V,Y)=>Y===ht?[xt(O.children[ht],!1)]:[`${Y}:${xt(V,!1)}`]);return 1===Object.keys(O.children).length&&null!=O.children[ht]?`${Qt(O)}/${I[0]}`:`${Qt(O)}/(${I.join("//")})`}}function pt(O){return encodeURIComponent(O).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Yt(O){return pt(O).replace(/%3B/gi,";")}function ri(O){return pt(O).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ee(O){return decodeURIComponent(O)}function ee(O){return Ee(O.replace(/\+/g,"%20"))}function oe(O){return`${ri(O.path)}${function Me(O){return Object.keys(O).map(k=>`;${ri(k)}=${ri(O[k])}`).join("")}(O.parameters)}`}const ct=/^[^\/()?;=#]+/;function Lt(O){const k=O.match(ct);return k?k[0]:""}const Ft=/^[^=?&#]+/,le=/^[^&#]+/;class he{constructor(k){this.url=k,this.remaining=k}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new xn([],{}):new xn([],this.parseChildren())}parseQueryParams(){const k={};if(this.consumeOptional("?"))do{this.parseQueryParam(k)}while(this.consumeOptional("&"));return k}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const k=[];for(this.peekStartsWith("(")||k.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),k.push(this.parseSegment());let I={};this.peekStartsWith("/(")&&(this.capture("/"),I=this.parseParens(!0));let V={};return this.peekStartsWith("(")&&(V=this.parseParens(!1)),(k.length>0||Object.keys(I).length>0)&&(V[ht]=new xn(k,I)),V}parseSegment(){const k=Lt(this.remaining);if(""===k&&this.peekStartsWith(";"))throw new w.vHH(4009,!1);return this.capture(k),new Ji(Ee(k),this.parseMatrixParams())}parseMatrixParams(){const k={};for(;this.consumeOptional(";");)this.parseParam(k);return k}parseParam(k){const I=Lt(this.remaining);if(!I)return;this.capture(I);let V="";if(this.consumeOptional("=")){const Y=Lt(this.remaining);Y&&(V=Y,this.capture(V))}k[Ee(I)]=Ee(V)}parseQueryParam(k){const I=function Mt(O){const k=O.match(Ft);return k?k[0]:""}(this.remaining);if(!I)return;this.capture(I);let V="";if(this.consumeOptional("=")){const et=function _e(O){const k=O.match(le);return k?k[0]:""}(this.remaining);et&&(V=et,this.capture(V))}const Y=ee(I),me=ee(V);if(k.hasOwnProperty(Y)){let et=k[Y];Array.isArray(et)||(et=[et],k[Y]=et),et.push(me)}else k[Y]=me}parseParens(k){const I={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const V=Lt(this.remaining),Y=this.remaining[V.length];if("/"!==Y&&")"!==Y&&";"!==Y)throw new w.vHH(4010,!1);let me;V.indexOf(":")>-1?(me=V.slice(0,V.indexOf(":")),this.capture(me),this.capture(":")):k&&(me=ht);const et=this.parseChildren();I[me]=1===Object.keys(et).length?et[ht]:new xn([],et),this.consumeOptional("//")}return I}peekStartsWith(k){return this.remaining.startsWith(k)}consumeOptional(k){return!!this.peekStartsWith(k)&&(this.remaining=this.remaining.substring(k.length),!0)}capture(k){if(!this.consumeOptional(k))throw new w.vHH(4011,!1)}}function Ue(O){return O.segments.length>0?new xn([],{[ht]:O}):O}function Zt(O){const k={};for(const V of Object.keys(O.children)){const me=Zt(O.children[V]);(me.segments.length>0||me.hasChildren())&&(k[V]=me)}return function Tn(O){if(1===O.numberOfChildren&&O.children[ht]){const k=O.children[ht];return new xn(O.segments.concat(k.segments),k.children)}return O}(new xn(O.segments,k))}function jn(O){return O instanceof Oi}function er(O,k,I,V,Y){if(0===I.length)return Xr(k.root,k.root,k.root,V,Y);const me=function So(O){if("string"==typeof O[0]&&1===O.length&&"/"===O[0])return new _n(!0,0,O);let k=0,I=!1;const V=O.reduce((Y,me,et)=>{if("object"==typeof me&&null!=me){if(me.outlets){const bt={};return $e(me.outlets,(Sn,fi)=>{bt[fi]="string"==typeof Sn?Sn.split("/"):Sn}),[...Y,{outlets:bt}]}if(me.segmentPath)return[...Y,me.segmentPath]}return"string"!=typeof me?[...Y,me]:0===et?(me.split("/").forEach((bt,Sn)=>{0==Sn&&"."===bt||(0==Sn&&""===bt?I=!0:".."===bt?k++:""!=bt&&Y.push(bt))}),Y):[...Y,me]},[]);return new _n(I,k,V)}(I);return me.toRoot()?Xr(k.root,k.root,new xn([],{}),V,Y):function et(Sn){const fi=function wa(O,k,I,V){if(O.isAbsolute)return new tr(k.root,!0,0);if(-1===V)return new tr(I,I===k.root,0);return function Yi(O,k,I){let V=O,Y=k,me=I;for(;me>Y;){if(me-=Y,V=V.parent,!V)throw new w.vHH(4005,!1);Y=V.segments.length}return new tr(V,!1,Y-me)}(I,V+(qi(O.commands[0])?0:1),O.numberOfDoubleDots)}(me,k,O.snapshot?._urlSegment,Sn),rr=fi.processChildren?hn(fi.segmentGroup,fi.index,me.commands):kn(fi.segmentGroup,fi.index,me.commands);return Xr(k.root,fi.segmentGroup,rr,V,Y)}(O.snapshot?._lastPathIndex)}function qi(O){return"object"==typeof O&&null!=O&&!O.outlets&&!O.segmentPath}function fo(O){return"object"==typeof O&&null!=O&&O.outlets}function Xr(O,k,I,V,Y){let et,me={};V&&$e(V,(Sn,fi)=>{me[fi]=Array.isArray(Sn)?Sn.map(rr=>`${rr}`):`${Sn}`}),et=O===k?I:Cr(O,k,I);const bt=Ue(Zt(et));return new Oi(bt,me,Y)}function Cr(O,k,I){const V={};return $e(O.children,(Y,me)=>{V[me]=Y===k?I:Cr(Y,k,I)}),new xn(O.segments,V)}class _n{constructor(k,I,V){if(this.isAbsolute=k,this.numberOfDoubleDots=I,this.commands=V,k&&V.length>0&&qi(V[0]))throw new w.vHH(4003,!1);const Y=V.find(fo);if(Y&&Y!==Mn(V))throw new w.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class tr{constructor(k,I,V){this.segmentGroup=k,this.processChildren=I,this.index=V}}function kn(O,k,I){if(O||(O=new xn([],{})),0===O.segments.length&&O.hasChildren())return hn(O,k,I);const V=function Ie(O,k,I){let V=0,Y=k;const me={match:!1,pathIndex:0,commandIndex:0};for(;Y<O.segments.length;){if(V>=I.length)return me;const et=O.segments[Y],bt=I[V];if(fo(bt))break;const Sn=`${bt}`,fi=V<I.length-1?I[V+1]:null;if(Y>0&&void 0===Sn)break;if(Sn&&fi&&"object"==typeof fi&&void 0===fi.outlets){if(!Ti(Sn,fi,et))return me;V+=2}else{if(!Ti(Sn,{},et))return me;V++}Y++}return{match:!0,pathIndex:Y,commandIndex:V}}(O,k,I),Y=I.slice(V.commandIndex);if(V.match&&V.pathIndex<O.segments.length){const me=new xn(O.segments.slice(0,V.pathIndex),{});return me.children[ht]=new xn(O.segments.slice(V.pathIndex),O.children),hn(me,0,Y)}return V.match&&0===Y.length?new xn(O.segments,{}):V.match&&!O.hasChildren()?Gt(O,k,I):V.match?hn(O,0,Y):Gt(O,k,I)}function hn(O,k,I){if(0===I.length)return new xn(O.segments,{});{const V=function gs(O){return fo(O[0])?O[0].outlets:{[ht]:O}}(I),Y={};return $e(V,(me,et)=>{"string"==typeof me&&(me=[me]),null!==me&&(Y[et]=kn(O.children[et],k,me))}),$e(O.children,(me,et)=>{void 0===V[et]&&(Y[et]=me)}),new xn(O.segments,Y)}}function Gt(O,k,I){const V=O.segments.slice(0,k);let Y=0;for(;Y<I.length;){const me=I[Y];if(fo(me)){const Sn=Fn(me.outlets);return new xn(V,Sn)}if(0===Y&&qi(I[0])){V.push(new Ji(O.segments[k].path,hi(I[0]))),Y++;continue}const et=fo(me)?me.outlets[ht]:`${me}`,bt=Y<I.length-1?I[Y+1]:null;et&&bt&&qi(bt)?(V.push(new Ji(et,hi(bt))),Y+=2):(V.push(new Ji(et,{})),Y++)}return new xn(V,{})}function Fn(O){const k={};return $e(O,(I,V)=>{"string"==typeof I&&(I=[I]),null!==I&&(k[V]=Gt(new xn([],{}),0,I))}),k}function hi(O){const k={};return $e(O,(I,V)=>k[V]=`${I}`),k}function Ti(O,k,I){return O==I.path&&tn(k,I.parameters)}class mi{constructor(k,I){this.id=k,this.url=I}}class Ki extends mi{constructor(k,I,V="imperative",Y=null){super(k,I),this.type=0,this.navigationTrigger=V,this.restoredState=Y}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class vr extends mi{constructor(k,I,V){super(k,I),this.urlAfterRedirects=V,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class to extends mi{constructor(k,I,V,Y){super(k,I),this.reason=V,this.code=Y,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Br extends mi{constructor(k,I,V,Y){super(k,I),this.error=V,this.target=Y,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class pr extends mi{constructor(k,I,V,Y){super(k,I),this.urlAfterRedirects=V,this.state=Y,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zr extends mi{constructor(k,I,V,Y){super(k,I),this.urlAfterRedirects=V,this.state=Y,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ds extends mi{constructor(k,I,V,Y,me){super(k,I),this.urlAfterRedirects=V,this.state=Y,this.shouldActivate=me,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Ts extends mi{constructor(k,I,V,Y){super(k,I),this.urlAfterRedirects=V,this.state=Y,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class is extends mi{constructor(k,I,V,Y){super(k,I),this.urlAfterRedirects=V,this.state=Y,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ks{constructor(k){this.route=k,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Fl{constructor(k){this.route=k,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Eo{constructor(k){this.snapshot=k,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ha{constructor(k){this.snapshot=k,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ga{constructor(k){this.snapshot=k,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nl{constructor(k){this.snapshot=k,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Io{constructor(k,I,V){this.routerEvent=k,this.position=I,this.anchor=V,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Fs{constructor(k){this._root=k}get root(){return this._root.value}parent(k){const I=this.pathFromRoot(k);return I.length>1?I[I.length-2]:null}children(k){const I=Ea(k,this._root);return I?I.children.map(V=>V.value):[]}firstChild(k){const I=Ea(k,this._root);return I&&I.children.length>0?I.children[0].value:null}siblings(k){const I=Qr(k,this._root);return I.length<2?[]:I[I.length-2].children.map(Y=>Y.value).filter(Y=>Y!==k)}pathFromRoot(k){return Qr(k,this._root).map(I=>I.value)}}function Ea(O,k){if(O===k.value)return k;for(const I of k.children){const V=Ea(O,I);if(V)return V}return null}function Qr(O,k){if(O===k.value)return[k];for(const I of k.children){const V=Qr(O,I);if(V.length)return V.unshift(k),V}return[]}class mo{constructor(k,I){this.value=k,this.children=I}toString(){return`TreeNode(${this.value})`}}function la(O){const k={};return O&&O.children.forEach(I=>k[I.value.outlet]=I),k}class ca extends Fs{constructor(k,I){super(k),this.snapshot=I,Ho(this,k)}toString(){return this.snapshot.toString()}}function Jr(O,k){const I=function ua(O,k){const et=new _s([],{},{},"",{},ht,k,null,O.root,-1,{});return new ys("",new mo(et,[]))}(O,k),V=new a.X([new Ji("",{})]),Y=new a.X({}),me=new a.X({}),et=new a.X({}),bt=new a.X(""),Sn=new Bo(V,Y,et,bt,me,ht,k,I.root);return Sn.snapshot=I.root,new ca(new mo(Sn,[]),I)}class Bo{constructor(k,I,V,Y,me,et,bt,Sn){this.url=k,this.params=I,this.queryParams=V,this.fragment=Y,this.data=me,this.outlet=et,this.component=bt,this.title=this.data?.pipe((0,Ye.U)(fi=>fi[Xe]))??(0,pe.of)(void 0),this._futureSnapshot=Sn}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Ye.U)(k=>ot(k)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Ye.U)(k=>ot(k)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function da(O,k="emptyOnly"){const I=O.pathFromRoot;let V=0;if("always"!==k)for(V=I.length-1;V>=1;){const Y=I[V],me=I[V-1];if(Y.routeConfig&&""===Y.routeConfig.path)V--;else{if(me.component)break;V--}}return function no(O){return O.reduce((k,I)=>({params:{...k.params,...I.params},data:{...k.data,...I.data},resolve:{...I.data,...k.resolve,...I.routeConfig?.data,...I._resolvedData}}),{params:{},data:{},resolve:{}})}(I.slice(V))}class _s{constructor(k,I,V,Y,me,et,bt,Sn,fi,rr,Si,Vr){this.url=k,this.params=I,this.queryParams=V,this.fragment=Y,this.data=me,this.outlet=et,this.component=bt,this.title=this.data?.[Xe],this.routeConfig=Sn,this._urlSegment=fi,this._lastPathIndex=rr,this._correctedLastPathIndex=Vr??rr,this._resolve=Si}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ot(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ot(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(V=>V.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ys extends Fs{constructor(k,I){super(I),this.url=k,Ho(this,I)}toString(){return Ls(this._root)}}function Ho(O,k){k.value._routerState=O,k.children.forEach(I=>Ho(O,I))}function Ls(O){const k=O.children.length>0?` { ${O.children.map(Ls).join(", ")} } `:"";return`${O.value}${k}`}function Bs(O){if(O.snapshot){const k=O.snapshot,I=O._futureSnapshot;O.snapshot=I,tn(k.queryParams,I.queryParams)||O.queryParams.next(I.queryParams),k.fragment!==I.fragment&&O.fragment.next(I.fragment),tn(k.params,I.params)||O.params.next(I.params),function St(O,k){if(O.length!==k.length)return!1;for(let I=0;I<O.length;++I)if(!tn(O[I],k[I]))return!1;return!0}(k.url,I.url)||O.url.next(I.url),tn(k.data,I.data)||O.data.next(I.data)}else O.snapshot=O._futureSnapshot,O.data.next(O._futureSnapshot.data)}function Ca(O,k){const I=tn(O.params,k.params)&&function Hi(O,k){return un(O,k)&&O.every((I,V)=>tn(I.parameters,k[V].parameters))}(O.url,k.url);return I&&!(!O.parent!=!k.parent)&&(!O.parent||Ca(O.parent,k.parent))}function Go(O,k,I){if(I&&O.shouldReuseRoute(k.value,I.value.snapshot)){const V=I.value;V._futureSnapshot=k.value;const Y=function Ma(O,k,I){return k.children.map(V=>{for(const Y of I.children)if(O.shouldReuseRoute(V.value,Y.value.snapshot))return Go(O,V,Y);return Go(O,V)})}(O,k,I);return new mo(V,Y)}{if(O.shouldAttach(k.value)){const me=O.retrieve(k.value);if(null!==me){const et=me.route;return et.value._futureSnapshot=k.value,et.children=k.children.map(bt=>Go(O,bt)),et}}const V=function il(O){return new Bo(new a.X(O.url),new a.X(O.params),new a.X(O.queryParams),new a.X(O.fragment),new a.X(O.data),O.outlet,O.component,O)}(k.value),Y=k.children.map(me=>Go(O,me));return new mo(V,Y)}}const rs="ngNavigationCancelingError";function Ss(O,k){const{redirectTo:I,navigationBehaviorOptions:V}=jn(k)?{redirectTo:k,navigationBehaviorOptions:void 0}:k,Y=Co(!1,0,k);return Y.url=I,Y.navigationBehaviorOptions=V,Y}function Co(O,k,I){const V=new Error("NavigationCancelingError: "+(O||""));return V[rs]=!0,V.cancellationCode=k,I&&(V.url=I),V}function Wr(O){return ha(O)&&jn(O.url)}function ha(O){return O&&O[rs]}class qs{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new os,this.attachRef=null}}let os=(()=>{class O{constructor(){this.contexts=new Map}onChildOutletCreated(I,V){const Y=this.getOrCreateContext(I);Y.outlet=V,this.contexts.set(I,Y)}onChildOutletDestroyed(I){const V=this.getContext(I);V&&(V.outlet=null,V.attachRef=null)}onOutletDeactivated(){const I=this.contexts;return this.contexts=new Map,I}onOutletReAttached(I){this.contexts=I}getOrCreateContext(I){let V=this.getContext(I);return V||(V=new qs,this.contexts.set(I,V)),V}getContext(I){return this.contexts.get(I)||null}}return O.\u0275fac=function(I){return new(I||O)},O.\u0275prov=w.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();const rl=!1;let Fr=(()=>{class O{constructor(I,V,Y,me,et){this.parentContexts=I,this.location=V,this.changeDetector=me,this.environmentInjector=et,this.activated=null,this._activatedRoute=null,this.activateEvents=new w.vpe,this.deactivateEvents=new w.vpe,this.attachEvents=new w.vpe,this.detachEvents=new w.vpe,this.name=Y||ht,I.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const I=this.parentContexts.getContext(this.name);I&&I.route&&(I.attachRef?this.attach(I.attachRef,I.route):this.activateWith(I.route,I.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new w.vHH(4012,rl);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new w.vHH(4012,rl);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new w.vHH(4012,rl);this.location.detach();const I=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(I.instance),I}attach(I,V){this.activated=I,this._activatedRoute=V,this.location.insert(I.hostView),this.attachEvents.emit(I.instance)}deactivate(){if(this.activated){const I=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(I)}}activateWith(I,V){if(this.isActivated)throw new w.vHH(4013,rl);this._activatedRoute=I;const Y=this.location,et=I._futureSnapshot.component,bt=this.parentContexts.getOrCreateContext(this.name).children,Sn=new ml(I,bt,Y.injector);if(V&&function Fo(O){return!!O.resolveComponentFactory}(V)){const fi=V.resolveComponentFactory(et);this.activated=Y.createComponent(fi,Y.length,Sn)}else this.activated=Y.createComponent(et,{index:Y.length,injector:Sn,environmentInjector:V??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return O.\u0275fac=function(I){return new(I||O)(w.Y36(os),w.Y36(w.s_b),w.$8M("name"),w.Y36(w.sBO),w.Y36(w.lqb))},O.\u0275dir=w.lG2({type:O,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),O})();class ml{constructor(k,I,V){this.route=k,this.childContexts=I,this.parent=V}get(k,I){return k===Bo?this.route:k===os?this.childContexts:this.parent.get(k,I)}}let $o=(()=>{class O{}return O.\u0275fac=function(I){return new(I||O)},O.\u0275cmp=w.Xpm({type:O,selectors:[["ng-component"]],standalone:!0,features:[w.jDz],decls:1,vars:0,template:function(I,V){1&I&&w._UZ(0,"router-outlet")},dependencies:[Fr],encapsulation:2}),O})();function go(O,k){return O.providers&&!O._injector&&(O._injector=(0,w.MMx)(O.providers,k,`Route: ${O.path}`)),O._injector??k}function vs(O){const k=O.children&&O.children.map(vs),I=k?{...O,children:k}:{...O};return!I.component&&!I.loadComponent&&(k||I.loadChildren)&&I.outlet&&I.outlet!==ht&&(I.component=$o),I}function _o(O){return O.outlet||ht}function Gi(O,k){const I=O.filter(V=>_o(V)===k);return I.push(...O.filter(V=>_o(V)!==k)),I}function Mo(O){if(!O)return null;if(O.routeConfig?._injector)return O.routeConfig._injector;for(let k=O.parent;k;k=k.parent){const I=k.routeConfig;if(I?._loadedInjector)return I._loadedInjector;if(I?._injector)return I._injector}return null}class Ta{constructor(k,I,V,Y){this.routeReuseStrategy=k,this.futureState=I,this.currState=V,this.forwardEvent=Y}activate(k){const I=this.futureState._root,V=this.currState?this.currState._root:null;this.deactivateChildRoutes(I,V,k),Bs(this.futureState.root),this.activateChildRoutes(I,V,k)}deactivateChildRoutes(k,I,V){const Y=la(I);k.children.forEach(me=>{const et=me.value.outlet;this.deactivateRoutes(me,Y[et],V),delete Y[et]}),$e(Y,(me,et)=>{this.deactivateRouteAndItsChildren(me,V)})}deactivateRoutes(k,I,V){const Y=k.value,me=I?I.value:null;if(Y===me)if(Y.component){const et=V.getContext(Y.outlet);et&&this.deactivateChildRoutes(k,I,et.children)}else this.deactivateChildRoutes(k,I,V);else me&&this.deactivateRouteAndItsChildren(I,V)}deactivateRouteAndItsChildren(k,I){k.value.component&&this.routeReuseStrategy.shouldDetach(k.value.snapshot)?this.detachAndStoreRouteSubtree(k,I):this.deactivateRouteAndOutlet(k,I)}detachAndStoreRouteSubtree(k,I){const V=I.getContext(k.value.outlet),Y=V&&k.value.component?V.children:I,me=la(k);for(const et of Object.keys(me))this.deactivateRouteAndItsChildren(me[et],Y);if(V&&V.outlet){const et=V.outlet.detach(),bt=V.children.onOutletDeactivated();this.routeReuseStrategy.store(k.value.snapshot,{componentRef:et,route:k,contexts:bt})}}deactivateRouteAndOutlet(k,I){const V=I.getContext(k.value.outlet),Y=V&&k.value.component?V.children:I,me=la(k);for(const et of Object.keys(me))this.deactivateRouteAndItsChildren(me[et],Y);V&&V.outlet&&(V.outlet.deactivate(),V.children.onOutletDeactivated(),V.attachRef=null,V.resolver=null,V.route=null)}activateChildRoutes(k,I,V){const Y=la(I);k.children.forEach(me=>{this.activateRoutes(me,Y[me.value.outlet],V),this.forwardEvent(new nl(me.value.snapshot))}),k.children.length&&this.forwardEvent(new Ha(k.value.snapshot))}activateRoutes(k,I,V){const Y=k.value,me=I?I.value:null;if(Bs(Y),Y===me)if(Y.component){const et=V.getOrCreateContext(Y.outlet);this.activateChildRoutes(k,I,et.children)}else this.activateChildRoutes(k,I,V);else if(Y.component){const et=V.getOrCreateContext(Y.outlet);if(this.routeReuseStrategy.shouldAttach(Y.snapshot)){const bt=this.routeReuseStrategy.retrieve(Y.snapshot);this.routeReuseStrategy.store(Y.snapshot,null),et.children.onOutletReAttached(bt.contexts),et.attachRef=bt.componentRef,et.route=bt.route.value,et.outlet&&et.outlet.attach(bt.componentRef,bt.route.value),Bs(bt.route.value),this.activateChildRoutes(k,null,et.children)}else{const bt=Mo(Y.snapshot),Sn=bt?.get(w._Vd)??null;et.attachRef=null,et.route=Y,et.resolver=Sn,et.injector=bt,et.outlet&&et.outlet.activateWith(Y,et.injector),this.activateChildRoutes(k,null,et.children)}}else this.activateChildRoutes(k,null,V)}}class Us{constructor(k){this.path=k,this.route=this.path[this.path.length-1]}}class as{constructor(k,I){this.component=k,this.route=I}}function As(O,k,I){const V=O._root;return wn(V,k?k._root:null,I,[V.value])}function ls(O,k){const I=Symbol(),V=k.get(O,I);return V===I?"function"!=typeof O||(0,w.Z0I)(O)?k.get(O):O:V}function wn(O,k,I,V,Y={canDeactivateChecks:[],canActivateChecks:[]}){const me=la(k);return O.children.forEach(et=>{(function ar(O,k,I,V,Y={canDeactivateChecks:[],canActivateChecks:[]}){const me=O.value,et=k?k.value:null,bt=I?I.getContext(O.value.outlet):null;if(et&&me.routeConfig===et.routeConfig){const Sn=function Za(O,k,I){if("function"==typeof I)return I(O,k);switch(I){case"pathParamsChange":return!un(O.url,k.url);case"pathParamsOrQueryParamsChange":return!un(O.url,k.url)||!tn(O.queryParams,k.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ca(O,k)||!tn(O.queryParams,k.queryParams);default:return!Ca(O,k)}}(et,me,me.routeConfig.runGuardsAndResolvers);Sn?Y.canActivateChecks.push(new Us(V)):(me.data=et.data,me._resolvedData=et._resolvedData),wn(O,k,me.component?bt?bt.children:null:I,V,Y),Sn&&bt&&bt.outlet&&bt.outlet.isActivated&&Y.canDeactivateChecks.push(new as(bt.outlet.component,et))}else et&&fa(k,bt,Y),Y.canActivateChecks.push(new Us(V)),wn(O,null,me.component?bt?bt.children:null:I,V,Y)})(et,me[et.value.outlet],I,V.concat([et.value]),Y),delete me[et.value.outlet]}),$e(me,(et,bt)=>fa(et,I.getContext(bt),Y)),Y}function fa(O,k,I){const V=la(O),Y=O.value;$e(V,(me,et)=>{fa(me,Y.component?k?k.children.getContext(et):null:k,I)}),I.canDeactivateChecks.push(new as(Y.component&&k&&k.outlet&&k.outlet.isActivated?k.outlet.component:null,Y))}function zr(O){return"function"==typeof O}function xs(O){return O instanceof ut||"EmptyError"===O?.name}const Lr=Symbol("INITIAL_VALUE");function Zo(){return(0,Ce.w)(O=>(0,it.a)(O.map(k=>k.pipe((0,we.q)(1),(0,At.O)(Lr)))).pipe((0,Ye.U)(k=>{for(const I of k)if(!0!==I){if(I===Lr)return Lr;if(!1===I||I instanceof Oi)return I}return!0}),(0,zt.h)(k=>k!==Lr),(0,we.q)(1)))}function ec(O){return(0,rt.z)((0,Xt.b)(k=>{if(jn(k))throw Ss(0,k)}),(0,Ye.U)(k=>!0===k))}const Nl={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Xo(O,k,I,V,Y){const me=al(O,k,I);return me.matched?function gl(O,k,I,V){const Y=k.canMatch;if(!Y||0===Y.length)return(0,pe.of)(!0);const me=Y.map(et=>{const bt=ls(et,O);return Rt(function bi(O){return O&&zr(O.canMatch)}(bt)?bt.canMatch(k,I):O.runInContext(()=>bt(k,I)))});return(0,pe.of)(me).pipe(Zo(),ec())}(V=go(k,V),k,I).pipe((0,Ye.U)(et=>!0===et?me:{...Nl})):(0,pe.of)(me)}function al(O,k,I){if(""===k.path)return"full"===k.pathMatch&&(O.hasChildren()||I.length>0)?{...Nl}:{matched:!0,consumedSegments:[],remainingSegments:I,parameters:{},positionalParamSegments:{}};const Y=(k.matcher||Se)(I,O,k);if(!Y)return{...Nl};const me={};$e(Y.posParams,(bt,Sn)=>{me[Sn]=bt.path});const et=Y.consumed.length>0?{...me,...Y.consumed[Y.consumed.length-1].parameters}:me;return{matched:!0,consumedSegments:Y.consumed,remainingSegments:I.slice(Y.consumed.length),parameters:et,positionalParamSegments:Y.posParams??{}}}function Ia(O,k,I,V,Y="corrected"){if(I.length>0&&function z(O,k,I){return I.some(V=>G(O,k,V)&&_o(V)!==ht)}(O,I,V)){const et=new xn(k,function zl(O,k,I,V){const Y={};Y[ht]=V,V._sourceSegment=O,V._segmentIndexShift=k.length;for(const me of I)if(""===me.path&&_o(me)!==ht){const et=new xn([],{});et._sourceSegment=O,et._segmentIndexShift=k.length,Y[_o(me)]=et}return Y}(O,k,V,new xn(I,O.children)));return et._sourceSegment=O,et._segmentIndexShift=k.length,{segmentGroup:et,slicedSegments:[]}}if(0===I.length&&function re(O,k,I){return I.some(V=>G(O,k,V))}(O,I,V)){const et=new xn(O.segments,function vc(O,k,I,V,Y,me){const et={};for(const bt of V)if(G(O,I,bt)&&!Y[_o(bt)]){const Sn=new xn([],{});Sn._sourceSegment=O,Sn._segmentIndexShift="legacy"===me?O.segments.length:k.length,et[_o(bt)]=Sn}return{...Y,...et}}(O,k,I,V,O.children,Y));return et._sourceSegment=O,et._segmentIndexShift=k.length,{segmentGroup:et,slicedSegments:I}}const me=new xn(O.segments,O.children);return me._sourceSegment=O,me._segmentIndexShift=k.length,{segmentGroup:me,slicedSegments:I}}function G(O,k,I){return(!(O.hasChildren()||k.length>0)||"full"!==I.pathMatch)&&""===I.path}function ye(O,k,I,V){return!!(_o(O)===V||V!==ht&&G(k,I,O))&&("**"===O.path||al(k,O,I).matched)}function yt(O,k,I){return 0===k.length&&!O.children[I]}const vn=!1;class On{constructor(k){this.segmentGroup=k||null}}class yi{constructor(k){this.urlTree=k}}function mr(O){return(0,ft._)(new On(O))}function Sr(O){return(0,ft._)(new yi(O))}class Ir{constructor(k,I,V,Y,me){this.injector=k,this.configLoader=I,this.urlSerializer=V,this.urlTree=Y,this.config=me,this.allowRedirects=!0}apply(){const k=Ia(this.urlTree.root,[],[],this.config).segmentGroup,I=new xn(k.segments,k.children);return this.expandSegmentGroup(this.injector,this.config,I,ht).pipe((0,Ye.U)(me=>this.createUrlTree(Zt(me),this.urlTree.queryParams,this.urlTree.fragment))).pipe((0,ii.K)(me=>{if(me instanceof yi)return this.allowRedirects=!1,this.match(me.urlTree);throw me instanceof On?this.noMatchError(me):me}))}match(k){return this.expandSegmentGroup(this.injector,this.config,k.root,ht).pipe((0,Ye.U)(Y=>this.createUrlTree(Zt(Y),k.queryParams,k.fragment))).pipe((0,ii.K)(Y=>{throw Y instanceof On?this.noMatchError(Y):Y}))}noMatchError(k){return new w.vHH(4002,vn)}createUrlTree(k,I,V){const Y=Ue(k);return new Oi(Y,I,V)}expandSegmentGroup(k,I,V,Y){return 0===V.segments.length&&V.hasChildren()?this.expandChildren(k,I,V).pipe((0,Ye.U)(me=>new xn([],me))):this.expandSegment(k,V,I,V.segments,Y,!0)}expandChildren(k,I,V){const Y=[];for(const me of Object.keys(V.children))"primary"===me?Y.unshift(me):Y.push(me);return(0,_.D)(Y).pipe((0,Dn.b)(me=>{const et=V.children[me],bt=Gi(I,me);return this.expandSegmentGroup(k,bt,et,me).pipe((0,Ye.U)(Sn=>({segment:Sn,outlet:me})))}),wi((me,et)=>(me[et.outlet]=et.segment,me),{}),Bi())}expandSegment(k,I,V,Y,me,et){return(0,_.D)(V).pipe((0,Dn.b)(bt=>this.expandSegmentAgainstRoute(k,I,V,bt,Y,me,et).pipe((0,ii.K)(fi=>{if(fi instanceof On)return(0,pe.of)(null);throw fi}))),_t(bt=>!!bt),(0,ii.K)((bt,Sn)=>{if(xs(bt))return yt(I,Y,me)?(0,pe.of)(new xn([],{})):mr(I);throw bt}))}expandSegmentAgainstRoute(k,I,V,Y,me,et,bt){return ye(Y,I,me,et)?void 0===Y.redirectTo?this.matchSegmentAgainstRoute(k,I,Y,me,et):bt&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(k,I,V,Y,me,et):mr(I):mr(I)}expandSegmentAgainstRouteUsingRedirect(k,I,V,Y,me,et){return"**"===Y.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(k,V,Y,et):this.expandRegularSegmentAgainstRouteUsingRedirect(k,I,V,Y,me,et)}expandWildCardWithParamsAgainstRouteUsingRedirect(k,I,V,Y){const me=this.applyRedirectCommands([],V.redirectTo,{});return V.redirectTo.startsWith("/")?Sr(me):this.lineralizeSegments(V,me).pipe((0,Jt.z)(et=>{const bt=new xn(et,{});return this.expandSegment(k,bt,I,et,Y,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(k,I,V,Y,me,et){const{matched:bt,consumedSegments:Sn,remainingSegments:fi,positionalParamSegments:rr}=al(I,Y,me);if(!bt)return mr(I);const Si=this.applyRedirectCommands(Sn,Y.redirectTo,rr);return Y.redirectTo.startsWith("/")?Sr(Si):this.lineralizeSegments(Y,Si).pipe((0,Jt.z)(Vr=>this.expandSegment(k,I,V,Vr.concat(fi),et,!1)))}matchSegmentAgainstRoute(k,I,V,Y,me){return"**"===V.path?(k=go(V,k),V.loadChildren?(V._loadedRoutes?(0,pe.of)({routes:V._loadedRoutes,injector:V._loadedInjector}):this.configLoader.loadChildren(k,V)).pipe((0,Ye.U)(bt=>(V._loadedRoutes=bt.routes,V._loadedInjector=bt.injector,new xn(Y,{})))):(0,pe.of)(new xn(Y,{}))):Xo(I,V,Y,k).pipe((0,Ce.w)(({matched:et,consumedSegments:bt,remainingSegments:Sn})=>et?this.getChildConfig(k=V._injector??k,V,Y).pipe((0,Jt.z)(rr=>{const Si=rr.injector??k,Vr=rr.routes,{segmentGroup:ws,slicedSegments:ta}=Ia(I,bt,Sn,Vr),d=new xn(ws.segments,ws.children);if(0===ta.length&&d.hasChildren())return this.expandChildren(Si,Vr,d).pipe((0,Ye.U)(y=>new xn(bt,y)));if(0===Vr.length&&0===ta.length)return(0,pe.of)(new xn(bt,{}));const i=_o(V)===me;return this.expandSegment(Si,d,Vr,ta,i?ht:me,!0).pipe((0,Ye.U)(f=>new xn(bt.concat(f.segments),f.children)))})):mr(I)))}getChildConfig(k,I,V){return I.children?(0,pe.of)({routes:I.children,injector:k}):I.loadChildren?void 0!==I._loadedRoutes?(0,pe.of)({routes:I._loadedRoutes,injector:I._loadedInjector}):function Wa(O,k,I,V){const Y=k.canLoad;if(void 0===Y||0===Y.length)return(0,pe.of)(!0);const me=Y.map(et=>{const bt=ls(et,O);return Rt(function q(O){return O&&zr(O.canLoad)}(bt)?bt.canLoad(k,I):O.runInContext(()=>bt(k,I)))});return(0,pe.of)(me).pipe(Zo(),ec())}(k,I,V).pipe((0,Jt.z)(Y=>Y?this.configLoader.loadChildren(k,I).pipe((0,Xt.b)(me=>{I._loadedRoutes=me.routes,I._loadedInjector=me.injector})):function xr(O){return(0,ft._)(Co(vn,3))}())):(0,pe.of)({routes:[],injector:k})}lineralizeSegments(k,I){let V=[],Y=I.root;for(;;){if(V=V.concat(Y.segments),0===Y.numberOfChildren)return(0,pe.of)(V);if(Y.numberOfChildren>1||!Y.children[ht])return(0,ft._)(new w.vHH(4e3,vn));Y=Y.children[ht]}}applyRedirectCommands(k,I,V){return this.applyRedirectCreateUrlTree(I,this.urlSerializer.parse(I),k,V)}applyRedirectCreateUrlTree(k,I,V,Y){const me=this.createSegmentGroup(k,I.root,V,Y);return new Oi(me,this.createQueryParams(I.queryParams,this.urlTree.queryParams),I.fragment)}createQueryParams(k,I){const V={};return $e(k,(Y,me)=>{if("string"==typeof Y&&Y.startsWith(":")){const bt=Y.substring(1);V[me]=I[bt]}else V[me]=Y}),V}createSegmentGroup(k,I,V,Y){const me=this.createSegments(k,I.segments,V,Y);let et={};return $e(I.children,(bt,Sn)=>{et[Sn]=this.createSegmentGroup(k,bt,V,Y)}),new xn(me,et)}createSegments(k,I,V,Y){return I.map(me=>me.path.startsWith(":")?this.findPosParam(k,me,Y):this.findOrReturn(me,V))}findPosParam(k,I,V){const Y=V[I.path.substring(1)];if(!Y)throw new w.vHH(4001,vn);return Y}findOrReturn(k,I){let V=0;for(const Y of I){if(Y.path===k.path)return I.splice(V),Y;V++}return k}}class cs{}class Qo{constructor(k,I,V,Y,me,et,bt,Sn){this.injector=k,this.rootComponentType=I,this.config=V,this.urlTree=Y,this.url=me,this.paramsInheritanceStrategy=et,this.relativeLinkResolution=bt,this.urlSerializer=Sn}recognize(){const k=Ia(this.urlTree.root,[],[],this.config.filter(I=>void 0===I.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,k,ht).pipe((0,Ye.U)(I=>{if(null===I)return null;const V=new _s([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ht,this.rootComponentType,null,this.urlTree.root,-1,{}),Y=new mo(V,I),me=new ys(this.url,Y);return this.inheritParamsAndData(me._root),me}))}inheritParamsAndData(k){const I=k.value,V=da(I,this.paramsInheritanceStrategy);I.params=Object.freeze(V.params),I.data=Object.freeze(V.data),k.children.forEach(Y=>this.inheritParamsAndData(Y))}processSegmentGroup(k,I,V,Y){return 0===V.segments.length&&V.hasChildren()?this.processChildren(k,I,V):this.processSegment(k,I,V,V.segments,Y)}processChildren(k,I,V){return(0,_.D)(Object.keys(V.children)).pipe((0,Dn.b)(Y=>{const me=V.children[Y],et=Gi(I,Y);return this.processSegmentGroup(k,et,me,Y)}),wi((Y,me)=>Y&&me?(Y.push(...me),Y):null),function Jn(O,k=!1){return(0,tt.e)((I,V)=>{let Y=0;I.subscribe((0,Wt.x)(V,me=>{const et=O(me,Y++);(et||k)&&V.next(me),!et&&V.complete()}))})}(Y=>null!==Y),Cn(null),Bi(),(0,Ye.U)(Y=>{if(null===Y)return null;const me=zo(Y);return function No(O){O.sort((k,I)=>k.value.outlet===ht?-1:I.value.outlet===ht?1:k.value.outlet.localeCompare(I.value.outlet))}(me),me}))}processSegment(k,I,V,Y,me){return(0,_.D)(I).pipe((0,Dn.b)(et=>this.processSegmentAgainstRoute(et._injector??k,et,V,Y,me)),_t(et=>!!et),(0,ii.K)(et=>{if(xs(et))return yt(V,Y,me)?(0,pe.of)([]):(0,pe.of)(null);throw et}))}processSegmentAgainstRoute(k,I,V,Y,me){if(I.redirectTo||!ye(I,V,Y,me))return(0,pe.of)(null);let et;if("**"===I.path){const bt=Y.length>0?Mn(Y).parameters:{},Sn=tc(V)+Y.length,fi=new _s(Y,bt,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Ul(I),_o(I),I.component??I._loadedComponent??null,I,Oa(V),Sn,X(I),Sn);et=(0,pe.of)({snapshot:fi,consumedSegments:[],remainingSegments:[]})}else et=Xo(V,I,Y,k).pipe((0,Ye.U)(({matched:bt,consumedSegments:Sn,remainingSegments:fi,parameters:rr})=>{if(!bt)return null;const Si=tc(V)+Sn.length;return{snapshot:new _s(Sn,rr,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Ul(I),_o(I),I.component??I._loadedComponent??null,I,Oa(V),Si,X(I),Si),consumedSegments:Sn,remainingSegments:fi}}));return et.pipe((0,Ce.w)(bt=>{if(null===bt)return(0,pe.of)(null);const{snapshot:Sn,consumedSegments:fi,remainingSegments:rr}=bt;k=I._injector??k;const Si=I._loadedInjector??k,Vr=function qa(O){return O.children?O.children:O.loadChildren?O._loadedRoutes:[]}(I),{segmentGroup:ws,slicedSegments:ta}=Ia(V,fi,rr,Vr.filter(i=>void 0===i.redirectTo),this.relativeLinkResolution);if(0===ta.length&&ws.hasChildren())return this.processChildren(Si,Vr,ws).pipe((0,Ye.U)(i=>null===i?null:[new mo(Sn,i)]));if(0===Vr.length&&0===ta.length)return(0,pe.of)([new mo(Sn,[])]);const d=_o(I)===me;return this.processSegment(Si,Vr,ws,ta,d?ht:me).pipe((0,Ye.U)(i=>null===i?null:[new mo(Sn,i)]))}))}}function Vc(O){const k=O.value.routeConfig;return k&&""===k.path&&void 0===k.redirectTo}function zo(O){const k=[],I=new Set;for(const V of O){if(!Vc(V)){k.push(V);continue}const Y=k.find(me=>V.value.routeConfig===me.value.routeConfig);void 0!==Y?(Y.children.push(...V.children),I.add(Y)):k.push(V)}for(const V of I){const Y=zo(V.children);k.push(new mo(V.value,Y))}return k.filter(V=>!I.has(V))}function Oa(O){let k=O;for(;k._sourceSegment;)k=k._sourceSegment;return k}function tc(O){let k=O,I=k._segmentIndexShift??0;for(;k._sourceSegment;)k=k._sourceSegment,I+=k._segmentIndexShift??0;return I-1}function Ul(O){return O.data||{}}function X(O){return O.resolve||{}}function Ot(O){return"string"==typeof O.title||null===O.title}function sn(O){return(0,Ce.w)(k=>{const I=O(k);return I?(0,_.D)(I).pipe((0,Ye.U)(()=>k)):(0,pe.of)(k)})}let zn=(()=>{class O{buildTitle(I){let V,Y=I.root;for(;void 0!==Y;)V=this.getResolvedTitleForRoute(Y)??V,Y=Y.children.find(me=>me.outlet===ht);return V}getResolvedTitleForRoute(I){return I.data[Xe]}}return O.\u0275fac=function(I){return new(I||O)},O.\u0275prov=w.Yz7({token:O,factory:function(){return(0,w.f3M)(di)},providedIn:"root"}),O})(),di=(()=>{class O extends zn{constructor(I){super(),this.title=I}updateTitle(I){const V=this.buildTitle(I);void 0!==V&&this.title.setTitle(V)}}return O.\u0275fac=function(I){return new(I||O)(w.LFG(Fe.Dx))},O.\u0275prov=w.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();class ur{}class Vi extends class Xi{shouldDetach(k){return!1}store(k,I){}shouldAttach(k){return!1}retrieve(k){return null}shouldReuseRoute(k,I){return k.routeConfig===I.routeConfig}}{}const ir=new w.OlP("",{providedIn:"root",factory:()=>({})}),vo=new w.OlP("ROUTES");let ko=(()=>{class O{constructor(I,V){this.injector=I,this.compiler=V,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(I){if(this.componentLoaders.get(I))return this.componentLoaders.get(I);if(I._loadedComponent)return(0,pe.of)(I._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(I);const V=Rt(I.loadComponent()).pipe((0,Xt.b)(me=>{this.onLoadEndListener&&this.onLoadEndListener(I),I._loadedComponent=me}),(0,Tt.x)(()=>{this.componentLoaders.delete(I)})),Y=new Qe(V,()=>new Hn.x).pipe(kt());return this.componentLoaders.set(I,Y),Y}loadChildren(I,V){if(this.childrenLoaders.get(V))return this.childrenLoaders.get(V);if(V._loadedRoutes)return(0,pe.of)({routes:V._loadedRoutes,injector:V._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(V);const me=this.loadModuleFactoryOrRoutes(V.loadChildren).pipe((0,Ye.U)(bt=>{this.onLoadEndListener&&this.onLoadEndListener(V);let Sn,fi,rr=!1;Array.isArray(bt)?fi=bt:(Sn=bt.create(I).injector,fi=Wi(Sn.get(vo,[],w.XFs.Self|w.XFs.Optional)));return{routes:fi.map(vs),injector:Sn}}),(0,Tt.x)(()=>{this.childrenLoaders.delete(V)})),et=new Qe(me,()=>new Hn.x).pipe(kt());return this.childrenLoaders.set(V,et),et}loadModuleFactoryOrRoutes(I){return Rt(I()).pipe((0,Jt.z)(V=>V instanceof w.YKP||Array.isArray(V)?(0,pe.of)(V):(0,_.D)(this.compiler.compileModuleAsync(V))))}}return O.\u0275fac=function(I){return new(I||O)(w.LFG(w.zs3),w.LFG(w.Sil))},O.\u0275prov=w.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();class ro{}class ma{shouldProcessUrl(k){return!0}extract(k){return k}merge(k,I){return k}}function Po(O){throw O}function es(O,k,I){return k.parse("/")}const xo={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bs={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function Ra(){const O=(0,w.f3M)(lt),k=(0,w.f3M)(os),I=(0,w.f3M)(Ln.Ye),V=(0,w.f3M)(w.zs3),Y=(0,w.f3M)(w.Sil),me=(0,w.f3M)(vo,{optional:!0})??[],et=(0,w.f3M)(ir,{optional:!0})??{},bt=(0,w.f3M)(di),Sn=(0,w.f3M)(zn,{optional:!0}),fi=(0,w.f3M)(ro,{optional:!0}),rr=(0,w.f3M)(ur,{optional:!0}),Si=new Ur(null,O,k,I,V,Y,Wi(me));return fi&&(Si.urlHandlingStrategy=fi),rr&&(Si.routeReuseStrategy=rr),Si.titleStrategy=Sn??bt,function ll(O,k){O.errorHandler&&(k.errorHandler=O.errorHandler),O.malformedUriErrorHandler&&(k.malformedUriErrorHandler=O.malformedUriErrorHandler),O.onSameUrlNavigation&&(k.onSameUrlNavigation=O.onSameUrlNavigation),O.paramsInheritanceStrategy&&(k.paramsInheritanceStrategy=O.paramsInheritanceStrategy),O.relativeLinkResolution&&(k.relativeLinkResolution=O.relativeLinkResolution),O.urlUpdateStrategy&&(k.urlUpdateStrategy=O.urlUpdateStrategy),O.canceledNavigationResolution&&(k.canceledNavigationResolution=O.canceledNavigationResolution)}(et,Si),Si}let Ur=(()=>{class O{constructor(I,V,Y,me,et,bt,Sn){this.rootComponentType=I,this.urlSerializer=V,this.rootContexts=Y,this.location=me,this.config=Sn,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Hn.x,this.errorHandler=Po,this.malformedUriErrorHandler=es,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>(0,pe.of)(void 0),this.urlHandlingStrategy=new ma,this.routeReuseStrategy=new Vi,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=et.get(ko),this.configLoader.onLoadEndListener=Vr=>this.triggerEvent(new Fl(Vr)),this.configLoader.onLoadStartListener=Vr=>this.triggerEvent(new ks(Vr)),this.ngModule=et.get(w.h0i),this.console=et.get(w.c2e);const Si=et.get(w.R0b);this.isNgZoneEnabled=Si instanceof w.R0b&&w.R0b.isInAngularZone(),this.resetConfig(Sn),this.currentUrlTree=function jt(){return new Oi(new xn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Jr(this.currentUrlTree,this.rootComponentType),this.transitions=new a.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(I){const V=this.events;return I.pipe((0,zt.h)(Y=>0!==Y.id),(0,Ye.U)(Y=>({...Y,extractedUrl:this.urlHandlingStrategy.extract(Y.rawUrl)})),(0,Ce.w)(Y=>{let me=!1,et=!1;return(0,pe.of)(Y).pipe((0,Xt.b)(bt=>{this.currentNavigation={id:bt.id,initialUrl:bt.rawUrl,extractedUrl:bt.extractedUrl,trigger:bt.source,extras:bt.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Ce.w)(bt=>{const Sn=this.browserUrlTree.toString(),fi=!this.navigated||bt.extractedUrl.toString()!==Sn||Sn!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||fi)&&this.urlHandlingStrategy.shouldProcessUrl(bt.rawUrl))return ka(bt.source)&&(this.browserUrlTree=bt.extractedUrl),(0,pe.of)(bt).pipe((0,Ce.w)(Si=>{const Vr=this.transitions.getValue();return V.next(new Ki(Si.id,this.serializeUrl(Si.extractedUrl),Si.source,Si.restoredState)),Vr!==this.transitions.getValue()?dt.E:Promise.resolve(Si)}),function eo(O,k,I,V){return(0,Ce.w)(Y=>function yo(O,k,I,V,Y){return new Ir(O,k,I,V,Y).apply()}(O,k,I,Y.extractedUrl,V).pipe((0,Ye.U)(me=>({...Y,urlAfterRedirects:me}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Xt.b)(Si=>{this.currentNavigation={...this.currentNavigation,finalUrl:Si.urlAfterRedirects},Y.urlAfterRedirects=Si.urlAfterRedirects}),function M(O,k,I,V,Y,me){return(0,Jt.z)(et=>function Hs(O,k,I,V,Y,me,et="emptyOnly",bt="legacy"){return new Qo(O,k,I,V,Y,et,bt,me).recognize().pipe((0,Ce.w)(Sn=>null===Sn?function Qs(O){return new Et.y(k=>k.error(O))}(new cs):(0,pe.of)(Sn)))}(O,k,I,et.urlAfterRedirects,V.serialize(et.urlAfterRedirects),V,Y,me).pipe((0,Ye.U)(bt=>({...et,targetSnapshot:bt}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Xt.b)(Si=>{if(Y.targetSnapshot=Si.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!Si.extras.skipLocationChange){const ws=this.urlHandlingStrategy.merge(Si.urlAfterRedirects,Si.rawUrl);this.setBrowserUrl(ws,Si)}this.browserUrlTree=Si.urlAfterRedirects}const Vr=new pr(Si.id,this.serializeUrl(Si.extractedUrl),this.serializeUrl(Si.urlAfterRedirects),Si.targetSnapshot);V.next(Vr)}));if(fi&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Vr,extractedUrl:ws,source:ta,restoredState:d,extras:i}=bt,c=new Ki(Vr,this.serializeUrl(ws),ta,d);V.next(c);const f=Jr(ws,this.rootComponentType).snapshot;return Y={...bt,targetSnapshot:f,urlAfterRedirects:ws,extras:{...i,skipLocationChange:!1,replaceUrl:!1}},(0,pe.of)(Y)}return this.rawUrlTree=bt.rawUrl,bt.resolve(null),dt.E}),(0,Xt.b)(bt=>{const Sn=new Zr(bt.id,this.serializeUrl(bt.extractedUrl),this.serializeUrl(bt.urlAfterRedirects),bt.targetSnapshot);this.triggerEvent(Sn)}),(0,Ye.U)(bt=>Y={...bt,guards:As(bt.targetSnapshot,bt.currentSnapshot,this.rootContexts)}),function Aa(O,k){return(0,Jt.z)(I=>{const{targetSnapshot:V,currentSnapshot:Y,guards:{canActivateChecks:me,canDeactivateChecks:et}}=I;return 0===et.length&&0===me.length?(0,pe.of)({...I,guardsResult:!0}):function Vs(O,k,I,V){return(0,_.D)(O).pipe((0,Jt.z)(Y=>function sl(O,k,I,V,Y){const me=k&&k.routeConfig?k.routeConfig.canDeactivate:null;if(!me||0===me.length)return(0,pe.of)(!0);const et=me.map(bt=>{const Sn=Mo(k)??Y,fi=ls(bt,Sn);return Rt(function En(O){return O&&zr(O.canDeactivate)}(fi)?fi.canDeactivate(O,k,I,V):Sn.runInContext(()=>fi(O,k,I,V))).pipe(_t())});return(0,pe.of)(et).pipe(Zo())}(Y.component,Y.route,I,k,V)),_t(Y=>!0!==Y,!0))}(et,V,Y,O).pipe((0,Jt.z)(bt=>bt&&function Q(O){return"boolean"==typeof O}(bt)?function Xs(O,k,I,V){return(0,_.D)(k).pipe((0,Dn.b)(Y=>(0,Le.z)(function Bl(O,k){return null!==O&&k&&k(new Eo(O)),(0,pe.of)(!0)}(Y.route.parent,V),function Ll(O,k){return null!==O&&k&&k(new Ga(O)),(0,pe.of)(!0)}(Y.route,V),function ol(O,k,I){const V=k[k.length-1],me=k.slice(0,k.length-1).reverse().map(et=>function Sa(O){const k=O.routeConfig?O.routeConfig.canActivateChild:null;return k&&0!==k.length?{node:O,guards:k}:null}(et)).filter(et=>null!==et).map(et=>(0,ke.P)(()=>{const bt=et.guards.map(Sn=>{const fi=Mo(et.node)??I,rr=ls(Sn,fi);return Rt(function be(O){return O&&zr(O.canActivateChild)}(rr)?rr.canActivateChild(V,O):fi.runInContext(()=>rr(V,O))).pipe(_t())});return(0,pe.of)(bt).pipe(Zo())}));return(0,pe.of)(me).pipe(Zo())}(O,Y.path,I),function js(O,k,I){const V=k.routeConfig?k.routeConfig.canActivate:null;if(!V||0===V.length)return(0,pe.of)(!0);const Y=V.map(me=>(0,ke.P)(()=>{const et=Mo(k)??I,bt=ls(me,et);return Rt(function j(O){return O&&zr(O.canActivate)}(bt)?bt.canActivate(k,O):et.runInContext(()=>bt(k,O))).pipe(_t())}));return(0,pe.of)(Y).pipe(Zo())}(O,Y.route,I))),_t(Y=>!0!==Y,!0))}(V,me,O,k):(0,pe.of)(bt)),(0,Ye.U)(bt=>({...I,guardsResult:bt})))})}(this.ngModule.injector,bt=>this.triggerEvent(bt)),(0,Xt.b)(bt=>{if(Y.guardsResult=bt.guardsResult,jn(bt.guardsResult))throw Ss(0,bt.guardsResult);const Sn=new Ds(bt.id,this.serializeUrl(bt.extractedUrl),this.serializeUrl(bt.urlAfterRedirects),bt.targetSnapshot,!!bt.guardsResult);this.triggerEvent(Sn)}),(0,zt.h)(bt=>!!bt.guardsResult||(this.restoreHistory(bt),this.cancelNavigationTransition(bt,"",3),!1)),sn(bt=>{if(bt.guards.canActivateChecks.length)return(0,pe.of)(bt).pipe((0,Xt.b)(Sn=>{const fi=new Ts(Sn.id,this.serializeUrl(Sn.extractedUrl),this.serializeUrl(Sn.urlAfterRedirects),Sn.targetSnapshot);this.triggerEvent(fi)}),(0,Ce.w)(Sn=>{let fi=!1;return(0,pe.of)(Sn).pipe(function S(O,k){return(0,Jt.z)(I=>{const{targetSnapshot:V,guards:{canActivateChecks:Y}}=I;if(!Y.length)return(0,pe.of)(I);let me=0;return(0,_.D)(Y).pipe((0,Dn.b)(et=>function $(O,k,I,V){const Y=O.routeConfig,me=O._resolve;return void 0!==Y?.title&&!Ot(Y)&&(me[Xe]=Y.title),function ue(O,k,I,V){const Y=function Re(O){return[...Object.keys(O),...Object.getOwnPropertySymbols(O)]}(O);if(0===Y.length)return(0,pe.of)({});const me={};return(0,_.D)(Y).pipe((0,Jt.z)(et=>function It(O,k,I,V){const Y=Mo(k)??V,me=ls(O,Y);return Rt(me.resolve?me.resolve(k,I):Y.runInContext(()=>me(k,I)))}(O[et],k,I,V).pipe(_t(),(0,Xt.b)(bt=>{me[et]=bt}))),Nn(1),(0,fn.h)(me),(0,ii.K)(et=>xs(et)?dt.E:(0,ft._)(et)))}(me,O,k,V).pipe((0,Ye.U)(et=>(O._resolvedData=et,O.data=da(O,I).resolve,Y&&Ot(Y)&&(O.data[Xe]=Y.title),null)))}(et.route,V,O,k)),(0,Xt.b)(()=>me++),Nn(1),(0,Jt.z)(et=>me===Y.length?(0,pe.of)(I):dt.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Xt.b)({next:()=>fi=!0,complete:()=>{fi||(this.restoreHistory(Sn),this.cancelNavigationTransition(Sn,"",2))}}))}),(0,Xt.b)(Sn=>{const fi=new is(Sn.id,this.serializeUrl(Sn.extractedUrl),this.serializeUrl(Sn.urlAfterRedirects),Sn.targetSnapshot);this.triggerEvent(fi)}))}),sn(bt=>{const Sn=fi=>{const rr=[];fi.routeConfig?.loadComponent&&!fi.routeConfig._loadedComponent&&rr.push(this.configLoader.loadComponent(fi.routeConfig).pipe((0,Xt.b)(Si=>{fi.component=Si}),(0,Ye.U)(()=>{})));for(const Si of fi.children)rr.push(...Sn(Si));return rr};return(0,it.a)(Sn(bt.targetSnapshot.root)).pipe(Cn(),(0,we.q)(1))}),sn(()=>this.afterPreactivation()),(0,Ye.U)(bt=>{const Sn=function Ns(O,k,I){const V=Go(O,k._root,I?I._root:void 0);return new ca(V,k)}(this.routeReuseStrategy,bt.targetSnapshot,bt.currentRouterState);return Y={...bt,targetRouterState:Sn}}),(0,Xt.b)(bt=>{this.currentUrlTree=bt.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(bt.urlAfterRedirects,bt.rawUrl),this.routerState=bt.targetRouterState,"deferred"===this.urlUpdateStrategy&&(bt.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,bt),this.browserUrlTree=bt.urlAfterRedirects)}),((O,k,I)=>(0,Ye.U)(V=>(new Ta(k,V.targetRouterState,V.currentRouterState,I).activate(O),V)))(this.rootContexts,this.routeReuseStrategy,bt=>this.triggerEvent(bt)),(0,Xt.b)({next(){me=!0},complete(){me=!0}}),(0,Tt.x)(()=>{me||et||this.cancelNavigationTransition(Y,"",1),this.currentNavigation?.id===Y.id&&(this.currentNavigation=null)}),(0,ii.K)(bt=>{if(et=!0,ha(bt)){Wr(bt)||(this.navigated=!0,this.restoreHistory(Y,!0));const Sn=new to(Y.id,this.serializeUrl(Y.extractedUrl),bt.message,bt.cancellationCode);if(V.next(Sn),Wr(bt)){const fi=this.urlHandlingStrategy.merge(bt.url,this.rawUrlTree),rr={skipLocationChange:Y.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ka(Y.source)};this.scheduleNavigation(fi,"imperative",null,rr,{resolve:Y.resolve,reject:Y.reject,promise:Y.promise})}else Y.resolve(!1)}else{this.restoreHistory(Y,!0);const Sn=new Br(Y.id,this.serializeUrl(Y.extractedUrl),bt,Y.targetSnapshot??void 0);V.next(Sn);try{Y.resolve(this.errorHandler(bt))}catch(fi){Y.reject(fi)}}return dt.E}))}))}resetRootComponentType(I){this.rootComponentType=I,this.routerState.root.component=this.rootComponentType}setTransition(I){this.transitions.next({...this.transitions.value,...I})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(I=>{const V="popstate"===I.type?"popstate":"hashchange";"popstate"===V&&setTimeout(()=>{const Y={replaceUrl:!0},me=I.state?.navigationId?I.state:null;if(me){const bt={...me};delete bt.navigationId,delete bt.\u0275routerPageId,0!==Object.keys(bt).length&&(Y.state=bt)}const et=this.parseUrl(I.url);this.scheduleNavigation(et,V,me,Y)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(I){this.events.next(I)}resetConfig(I){this.config=I.map(vs),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(I,V={}){const{relativeTo:Y,queryParams:me,fragment:et,queryParamsHandling:bt,preserveFragment:Sn}=V,fi=Y||this.routerState.root,rr=Sn?this.currentUrlTree.fragment:et;let Si=null;switch(bt){case"merge":Si={...this.currentUrlTree.queryParams,...me};break;case"preserve":Si=this.currentUrlTree.queryParams;break;default:Si=me||null}return null!==Si&&(Si=this.removeEmptyProps(Si)),er(fi,this.currentUrlTree,I,Si,rr??null)}navigateByUrl(I,V={skipLocationChange:!1}){const Y=jn(I)?I:this.parseUrl(I),me=this.urlHandlingStrategy.merge(Y,this.rawUrlTree);return this.scheduleNavigation(me,"imperative",null,V)}navigate(I,V={skipLocationChange:!1}){return function xc(O){for(let k=0;k<O.length;k++){if(null==O[k])throw new w.vHH(4008,false)}}(I),this.navigateByUrl(this.createUrlTree(I,V),V)}serializeUrl(I){return this.urlSerializer.serialize(I)}parseUrl(I){let V;try{V=this.urlSerializer.parse(I)}catch(Y){V=this.malformedUriErrorHandler(Y,this.urlSerializer,I)}return V}isActive(I,V){let Y;if(Y=!0===V?{...xo}:!1===V?{...bs}:V,jn(I))return ge(this.currentUrlTree,I,Y);const me=this.parseUrl(I);return ge(this.currentUrlTree,me,Y)}removeEmptyProps(I){return Object.keys(I).reduce((V,Y)=>{const me=I[Y];return null!=me&&(V[Y]=me),V},{})}processNavigations(){this.navigations.subscribe(I=>{this.navigated=!0,this.lastSuccessfulId=I.id,this.currentPageId=I.targetPageId,this.events.next(new vr(I.id,this.serializeUrl(I.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),I.resolve(!0)},I=>{this.console.warn(`Unhandled Navigation Error: ${I}`)})}scheduleNavigation(I,V,Y,me,et){if(this.disposed)return Promise.resolve(!1);let bt,Sn,fi;et?(bt=et.resolve,Sn=et.reject,fi=et.promise):fi=new Promise((Vr,ws)=>{bt=Vr,Sn=ws});const rr=++this.navigationId;let Si;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(Y=this.location.getState()),Si=Y&&Y.\u0275routerPageId?Y.\u0275routerPageId:me.replaceUrl||me.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):Si=0,this.setTransition({id:rr,targetPageId:Si,source:V,restoredState:Y,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:I,extras:me,resolve:bt,reject:Sn,promise:fi,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),fi.catch(Vr=>Promise.reject(Vr))}setBrowserUrl(I,V){const Y=this.urlSerializer.serialize(I),me={...V.extras.state,...this.generateNgRouterState(V.id,V.targetPageId)};this.location.isCurrentPathEqualTo(Y)||V.extras.replaceUrl?this.location.replaceState(Y,"",me):this.location.go(Y,"",me)}restoreHistory(I,V=!1){if("computed"===this.canceledNavigationResolution){const Y=this.currentPageId-I.targetPageId;"popstate"!==I.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===Y?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===Y&&(this.resetState(I),this.browserUrlTree=I.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(Y)}else"replace"===this.canceledNavigationResolution&&(V&&this.resetState(I),this.resetUrlToCurrentUrlTree())}resetState(I){this.routerState=I.currentRouterState,this.currentUrlTree=I.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,I.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(I,V,Y){const me=new to(I.id,this.serializeUrl(I.extractedUrl),V,Y);this.triggerEvent(me),I.resolve(!1)}generateNgRouterState(I,V){return"computed"===this.canceledNavigationResolution?{navigationId:I,\u0275routerPageId:V}:{navigationId:I}}}return O.\u0275fac=function(I){w.$Z()},O.\u0275prov=w.Yz7({token:O,factory:function(){return Ra()},providedIn:"root"}),O})();function ka(O){return"imperative"!==O}let Di=(()=>{class O{constructor(I,V,Y,me,et){this.router=I,this.route=V,this.tabIndexAttribute=Y,this.renderer=me,this.el=et,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new Hn.x,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(I){this._preserveFragment=(0,w.D6c)(I)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(I){this._skipLocationChange=(0,w.D6c)(I)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(I){this._replaceUrl=(0,w.D6c)(I)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(I){if(null!=this.tabIndexAttribute)return;const V=this.renderer,Y=this.el.nativeElement;null!==I?V.setAttribute(Y,"tabindex",I):V.removeAttribute(Y,"tabindex")}ngOnChanges(I){this.onChanges.next(this)}set routerLink(I){null!=I?(this.commands=Array.isArray(I)?I:[I],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return O.\u0275fac=function(I){return new(I||O)(w.Y36(Ur),w.Y36(Bo),w.$8M("tabindex"),w.Y36(w.Qsj),w.Y36(w.SBq))},O.\u0275dir=w.lG2({type:O,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(I,V){1&I&&w.NdJ("click",function(){return V.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[w.TTD]}),O})(),Ii=(()=>{class O{constructor(I,V,Y){this.router=I,this.route=V,this.locationStrategy=Y,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new Hn.x,this.subscription=I.events.subscribe(me=>{me instanceof vr&&this.updateTargetUrlAndHref()})}set preserveFragment(I){this._preserveFragment=(0,w.D6c)(I)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(I){this._skipLocationChange=(0,w.D6c)(I)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(I){this._replaceUrl=(0,w.D6c)(I)}get replaceUrl(){return this._replaceUrl}set routerLink(I){this.commands=null!=I?Array.isArray(I)?I:[I]:null}ngOnChanges(I){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(I,V,Y,me,et){return!!(0!==I||V||Y||me||et||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return O.\u0275fac=function(I){return new(I||O)(w.Y36(Ur),w.Y36(Bo),w.Y36(Ln.S$))},O.\u0275dir=w.lG2({type:O,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(I,V){1&I&&w.NdJ("click",function(me){return V.onClick(me.button,me.ctrlKey,me.shiftKey,me.altKey,me.metaKey)}),2&I&&w.uIk("target",V.target)("href",V.href,w.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[w.TTD]}),O})(),Zi=(()=>{class O{constructor(I,V,Y,me,et,bt){this.router=I,this.element=V,this.renderer=Y,this.cdr=me,this.link=et,this.linkWithHref=bt,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new w.vpe,this.routerEventsSubscription=I.events.subscribe(Sn=>{Sn instanceof vr&&this.update()})}ngAfterContentInit(){(0,pe.of)(this.links.changes,this.linksWithHrefs.changes,(0,pe.of)(null)).pipe((0,Ge.J)()).subscribe(I=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();const I=[...this.links.toArray(),...this.linksWithHrefs.toArray(),this.link,this.linkWithHref].filter(V=>!!V).map(V=>V.onChanges);this.linkInputChangesSubscription=(0,_.D)(I).pipe((0,Ge.J)()).subscribe(V=>{this.isActive!==this.isLinkActive(this.router)(V)&&this.update()})}set routerLinkActive(I){const V=Array.isArray(I)?I:I.split(" ");this.classes=V.filter(Y=>!!Y)}ngOnChanges(I){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(()=>{const I=this.hasActiveLinks();this.isActive!==I&&(this.isActive=I,this.cdr.markForCheck(),this.classes.forEach(V=>{I?this.renderer.addClass(this.element.nativeElement,V):this.renderer.removeClass(this.element.nativeElement,V)}),I&&void 0!==this.ariaCurrentWhenActive?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(I))})}isLinkActive(I){const V=function br(O){return!!O.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return Y=>!!Y.urlTree&&I.isActive(Y.urlTree,V)}hasActiveLinks(){const I=this.isLinkActive(this.router);return this.link&&I(this.link)||this.linkWithHref&&I(this.linkWithHref)||this.links.some(I)||this.linksWithHrefs.some(I)}}return O.\u0275fac=function(I){return new(I||O)(w.Y36(Ur),w.Y36(w.SBq),w.Y36(w.Qsj),w.Y36(w.sBO),w.Y36(Di,8),w.Y36(Ii,8))},O.\u0275dir=w.lG2({type:O,selectors:[["","routerLinkActive",""]],contentQueries:function(I,V,Y){if(1&I&&(w.Suo(Y,Di,5),w.Suo(Y,Ii,5)),2&I){let me;w.iGM(me=w.CRH())&&(V.links=me),w.iGM(me=w.CRH())&&(V.linksWithHrefs=me)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[w.TTD]}),O})();class oo{}let Gs=(()=>{class O{constructor(I,V,Y,me,et){this.router=I,this.injector=Y,this.preloadingStrategy=me,this.loader=et}setUpPreloading(){this.subscription=this.router.events.pipe((0,zt.h)(I=>I instanceof vr),(0,Dn.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(I,V){const Y=[];for(const me of V){me.providers&&!me._injector&&(me._injector=(0,w.MMx)(me.providers,I,`Route: ${me.path}`));const et=me._injector??I,bt=me._loadedInjector??et;me.loadChildren&&!me._loadedRoutes&&void 0===me.canLoad||me.loadComponent&&!me._loadedComponent?Y.push(this.preloadConfig(et,me)):(me.children||me._loadedRoutes)&&Y.push(this.processRoutes(bt,me.children??me._loadedRoutes))}return(0,_.D)(Y).pipe((0,Ge.J)())}preloadConfig(I,V){return this.preloadingStrategy.preload(V,()=>{let Y;Y=V.loadChildren&&void 0===V.canLoad?this.loader.loadChildren(I,V):(0,pe.of)(null);const me=Y.pipe((0,Jt.z)(et=>null===et?(0,pe.of)(void 0):(V._loadedRoutes=et.routes,V._loadedInjector=et.injector,this.processRoutes(et.injector??I,et.routes))));if(V.loadComponent&&!V._loadedComponent){const et=this.loader.loadComponent(V);return(0,_.D)([me,et]).pipe((0,Ge.J)())}return me})}}return O.\u0275fac=function(I){return new(I||O)(w.LFG(Ur),w.LFG(w.Sil),w.LFG(w.lqb),w.LFG(oo),w.LFG(ko))},O.\u0275prov=w.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();const Or=new w.OlP("");let Js=(()=>{class O{constructor(I,V,Y={}){this.router=I,this.viewportScroller=V,this.options=Y,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},Y.scrollPositionRestoration=Y.scrollPositionRestoration||"disabled",Y.anchorScrolling=Y.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(I=>{I instanceof Ki?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=I.navigationTrigger,this.restoredId=I.restoredState?I.restoredState.navigationId:0):I instanceof vr&&(this.lastId=I.id,this.scheduleScrollEvent(I,this.router.parseUrl(I.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(I=>{I instanceof Io&&(I.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(I.position):I.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(I.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(I,V){this.router.triggerEvent(new Io(I,"popstate"===this.lastSource?this.store[this.restoredId]:null,V))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return O.\u0275fac=function(I){w.$Z()},O.\u0275prov=w.Yz7({token:O,factory:O.\u0275fac}),O})();function bo(O,k){return{\u0275kind:O,\u0275providers:k}}function _l(O){return[{provide:vo,multi:!0,useValue:O}]}function qr(){const O=(0,w.f3M)(w.zs3);return k=>{const I=O.get(w.z2F);if(k!==I.components[0])return;const V=O.get(Ur),Y=O.get(Pu);1===O.get(ds)&&V.initialNavigation(),O.get(dd,null,w.XFs.Optional)?.setUpPreloading(),O.get(Or,null,w.XFs.Optional)?.init(),V.resetRootComponentType(I.componentTypes[0]),Y.closed||(Y.next(),Y.unsubscribe())}}const Pu=new w.OlP("",{factory:()=>new Hn.x}),ds=new w.OlP("",{providedIn:"root",factory:()=>1});const dd=new w.OlP("");function yl(O){return bo(0,[{provide:dd,useExisting:Gs},{provide:oo,useExisting:O}])}const Oo=new w.OlP("ROUTER_FORROOT_GUARD"),pi=[Ln.Ye,{provide:lt,useClass:nn},{provide:Ur,useFactory:Ra},os,{provide:Bo,useFactory:function ea(O){return O.routerState.root},deps:[Ur]},ko];function nc(){return new w.PXZ("Router",Ur)}let hd=(()=>{class O{constructor(I){}static forRoot(I,V){return{ngModule:O,providers:[pi,[],_l(I),{provide:Oo,useFactory:su,deps:[[Ur,new w.FiY,new w.tp0]]},{provide:ir,useValue:V||{}},V?.useHash?{provide:Ln.S$,useClass:Ln.Do}:{provide:Ln.S$,useClass:Ln.b0},{provide:Or,useFactory:()=>{const O=(0,w.f3M)(Ur),k=(0,w.f3M)(Ln.EM),I=(0,w.f3M)(ir);return I.scrollOffset&&k.setOffset(I.scrollOffset),new Js(O,k,I)}},V?.preloadingStrategy?yl(V.preloadingStrategy).\u0275providers:[],{provide:w.PXZ,multi:!0,useFactory:nc},V?.initialNavigation?ic(V):[],[{provide:wl,useFactory:qr},{provide:w.tb,multi:!0,useExisting:wl}]]}}static forChild(I){return{ngModule:O,providers:[_l(I)]}}}return O.\u0275fac=function(I){return new(I||O)(w.LFG(Oo,8))},O.\u0275mod=w.oAB({type:O}),O.\u0275inj=w.cJS({imports:[$o]}),O})();function su(O){return"guarded"}function ic(O){return["disabled"===O.initialNavigation?bo(3,[{provide:w.ip1,multi:!0,useFactory:()=>{const k=(0,w.f3M)(Ur);return()=>{k.setUpLocationChangeListener()}}},{provide:ds,useValue:2}]).\u0275providers:[],"enabledBlocking"===O.initialNavigation?bo(2,[{provide:ds,useValue:0},{provide:w.ip1,multi:!0,deps:[w.zs3],useFactory:k=>{const I=k.get(Ln.V_,Promise.resolve());let V=!1;return()=>I.then(()=>new Promise(me=>{const et=k.get(Ur),bt=k.get(Pu);(function Y(me){k.get(Ur).events.pipe((0,zt.h)(bt=>bt instanceof vr||bt instanceof to||bt instanceof Br),(0,Ye.U)(bt=>bt instanceof vr||bt instanceof to&&(0===bt.code||1===bt.code)&&null),(0,zt.h)(bt=>null!==bt),(0,we.q)(1)).subscribe(()=>{me()})})(()=>{me(!0),V=!0}),et.afterPreactivation=()=>(me(!0),V||bt.closed?(0,pe.of)(void 0):bt),et.initialNavigation()}))}}]).\u0275providers:[]]}const wl=new w.OlP("")}},ti=>{ti(ti.s=9895)}]);